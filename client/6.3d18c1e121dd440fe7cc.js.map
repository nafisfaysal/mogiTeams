{"version":3,"sources":["webpack:///./components/formatted_markdown_message.jsx","webpack:///./components/overlay_trigger.tsx","webpack:///./components/loading_screen.tsx","webpack:///./components/widgets/menu/menu_modals/submenu_modal/submenu_modal.tsx","webpack:///./actions/global_actions.jsx","webpack:///./utils/react_intl.ts","webpack:///./components/confirm_modal.tsx","webpack:///./components/widgets/menu/menu_items/submenu_item.tsx","webpack:///./components/widgets/menu/menu_group.tsx","webpack:///./components/widgets/menu/menu_items/menu_item_action.tsx","webpack:///./components/widgets/menu/menu_items/menu_item_external_link.tsx","webpack:///./components/widgets/menu/menu_items/menu_item_link.tsx","webpack:///./components/widgets/menu/menu_items/menu_item_toggle_modal_redux.tsx","webpack:///./components/widgets/menu/menu.tsx","webpack:///./actions/views/modals.js","webpack:///./actions/admin_actions.jsx","webpack:///./components/localized_input/localized_input.tsx","webpack:///./components/form_error.tsx","webpack:///./components/widgets/menu/menu_wrapper_animation.tsx","webpack:///./components/widgets/menu/menu_wrapper.tsx","webpack:///./actions/views/channel.js","webpack:///./components/widgets/badges/bot_badge.tsx","webpack:///./components/setting_item_max.jsx","webpack:///./components/localized_icon.tsx","webpack:///./components/widgets/users/avatar.tsx","webpack:///./components/suggestion/provider.jsx","webpack:///./components/suggestion/suggestion.jsx","webpack:///./selectors/views/settings.js","webpack:///./actions/views/settings.js","webpack:///./components/setting_item_min/setting_item_min.tsx","webpack:///./components/setting_item_min/index.ts","webpack:///./components/markdown/markdown.jsx","webpack:///./components/markdown/index.js","webpack:///./actions/channel_actions.jsx","webpack:///./components/save_button.tsx","webpack:///./components/widgets/loading/loading_spinner.tsx","webpack:///./components/widgets/loading/loading_wrapper.tsx","webpack:///./components/widgets/badges/guest_badge.tsx","webpack:///./components/widgets/icons/fa_warning_icon.tsx","webpack:///./utils/file_utils.jsx","webpack:///./plugins/pluggable/pluggable.jsx","webpack:///./plugins/pluggable/index.js","webpack:///./components/widgets/icons/globe_icon.jsx","webpack:///./components/widgets/icons/lock_icon.jsx","webpack:///./components/suggestion/suggestion_list.jsx","webpack:///./components/widgets/popover/index.tsx","webpack:///./components/profile_picture.tsx","webpack:///./selectors/views/modals.js","webpack:///./actions/views/search.js","webpack:///./utils/license_utils.jsx","webpack:///./actions/views/announcement_bar.js","webpack:///./components/announcement_bar/default_announcement_bar/announcement_bar.jsx","webpack:///./components/announcement_bar/default_announcement_bar/index.js","webpack:///./components/announcement_bar/text_dismissable_bar.jsx","webpack:///./components/announcement_bar/configuration_bar/configuration_bar.jsx","webpack:///./components/announcement_bar/configuration_bar/index.js","webpack:///./components/announcement_bar/version_bar/version_bar.jsx","webpack:///./components/announcement_bar/version_bar/index.js","webpack:///./components/announcement_bar/announcement_bar_controller.jsx","webpack:///./components/announcement_bar/index.js","webpack:///./components/permissions_gates/system_permission_gate/system_permission_gate.jsx","webpack:///./components/permissions_gates/system_permission_gate/index.js","webpack:///./components/permissions_gates/team_permission_gate/team_permission_gate.tsx","webpack:///./components/permissions_gates/team_permission_gate/index.ts","webpack:///./components/spinner_button.tsx","webpack:///./components/suggestion/suggestion_box.jsx","webpack:///./components/widgets/icons/archive_icon.jsx","webpack:///./actions/team_actions.jsx","webpack:///./components/widgets/icons/search_icon.jsx","webpack:///./actions/views/lhs.js","webpack:///./selectors/views/admin.js","webpack:///./components/widgets/team_icon/team_icon.tsx","webpack:///./components/multiselect/multiselect_list.tsx","webpack:///./components/multiselect/multiselect.tsx","webpack:///./actions/websocket_actions.jsx","webpack:///./components/quick_input.jsx","webpack:///./stores/browser_store.jsx","webpack:///./utils/team_utils.jsx","webpack:///./components/widgets/menu/menu_items/menu_item.tsx","webpack:///./components/size_aware_image.jsx","webpack:///./components/widgets/icons/fa_success_icon.jsx","webpack:///./components/widgets/icons/fa_back_icon.jsx","webpack:///./components/widgets/icons/fa_add_icon.jsx","webpack:///./components/toggle_modal_button.jsx","webpack:///./components/widgets/icons/status_away_avatar_icon.jsx","webpack:///./components/widgets/icons/status_away_icon.jsx","webpack:///./components/widgets/icons/status_dnd_avatar_icon.jsx","webpack:///./components/widgets/icons/status_dnd_icon.jsx","webpack:///./components/widgets/icons/status_offline_avatar_icon.jsx","webpack:///./components/widgets/icons/status_offline_icon.jsx","webpack:///./components/widgets/icons/status_online_avatar_icon.jsx","webpack:///./components/widgets/icons/status_online_icon.jsx","webpack:///./components/status_icon.jsx","webpack:///./components/external_image/external_image.jsx","webpack:///./components/external_image/index.js","webpack:///./actions/views/root.js","webpack:///./components/widgets/badges/badge.tsx","webpack:///./images/groups-avatar.png","webpack:///./components/widgets/icons/menu_icon.jsx","webpack:///./components/audio_video_preview.jsx","webpack:///./components/code_preview.jsx","webpack:///./components/view_image/image_preview.jsx","webpack:///./components/view_image/popover_bar/popover_bar.jsx","webpack:///./components/view_image/popover_bar/index.js","webpack:///./components/view_image/view_image.jsx","webpack:///./components/view_image/index.js","webpack:///./components/toggle_modal_button_redux/toggle_modal_button_redux.jsx","webpack:///./components/toggle_modal_button_redux/index.js","webpack:///./components/file_info_preview/file_info_preview.tsx","webpack:///./components/file_info_preview/index.ts","webpack:///./components/add_groups_to_channel_modal/add_groups_to_channel_modal.jsx","webpack:///./components/add_groups_to_channel_modal/index.js","webpack:///./components/add_groups_to_team_modal/add_groups_to_team_modal.jsx","webpack:///./components/add_groups_to_team_modal/index.js","webpack:///./components/user_settings/modal/user_settings_modal.jsx","webpack:///./components/user_settings/modal/index.js","webpack:///./selectors/local_storage.js","webpack:///./components/suggestion/generic_user_provider.jsx","webpack:///./components/widgets/settings/setting.tsx","webpack:///./dispatcher/app_dispatcher.jsx","webpack:///./actions/views/notice.js","webpack:///./components/widgets/icons/mattermost_logo.jsx","webpack:///./images/img_trans.gif","webpack:///./actions/views/profile_popover.js","webpack:///./components/suggestion/search_channel_with_permissions_provider.jsx","webpack:///./components/add_user_to_channel_modal/add_user_to_channel_modal.jsx","webpack:///./components/add_user_to_channel_modal/index.js","webpack:///./components/profile_popover/profile_popover.jsx","webpack:///./components/profile_popover/index.js","webpack:///./components/latex_block/latex_block.jsx","webpack:///./components/latex_block/index.js","webpack:///./components/markdown_image.jsx","webpack:///./components/post_emoji/post_emoji.tsx","webpack:///./components/post_emoji/index.tsx","webpack:///./utils/message_html_to_component.jsx","webpack:///./components/system_notice/notices.jsx","webpack:///./components/system_notice/system_notice.jsx","webpack:///./components/system_notice/index.js","webpack:///./client/web_websocket_client.jsx","webpack:///./client/websocket_client.jsx","webpack:///./components/local_date_time/local_date_time.tsx","webpack:///./components/local_date_time/index.ts","webpack:///./selectors/views/channel.js","webpack:///./selectors/views/websocket.js","webpack:///./components/suggestion/menu_action_provider.jsx","webpack:///./components/suggestion/generic_channel_provider.jsx","webpack:///./components/widgets/settings/text_setting.tsx","webpack:///./components/autocomplete_selector.jsx","webpack:///./utils/position_utils.tsx","webpack:///./components/loading_image_preview.tsx","webpack:///./utils/route.jsx","webpack:///./selectors/views/announcement_bar.js","webpack:///./utils/server_version.tsx","webpack:///./components/autosize_textarea.tsx","webpack:///./components/widgets/icons/fa_edit_icon.jsx","webpack:///./components/setting_picture.jsx","webpack:///./components/suggestion/modal_suggestion_list.jsx","webpack:///./components/widgets/settings/bool_setting.tsx","webpack:///./components/widgets/settings/radio_setting.tsx","webpack:///./components/interactive_dialog/dialog_element/dialog_element.jsx","webpack:///./components/interactive_dialog/dialog_element/index.js","webpack:///./components/interactive_dialog/dialog_introduction_text.jsx","webpack:///./components/interactive_dialog/interactive_dialog.jsx","webpack:///./components/interactive_dialog/index.js","webpack:///./components/user_list_row/user_list_row.jsx","webpack:///./components/user_list_row/index.js","webpack:///./components/user_list.jsx","webpack:///./components/searchable_user_list/searchable_user_list.jsx","webpack:///./components/modal_controller/modal_controller.jsx","webpack:///./components/modal_controller/index.js","webpack:///./components/at_mention/at_mention.jsx","webpack:///./components/at_mention/index.jsx","webpack:///./plugins/registry.js","webpack:///./plugins/index.js","webpack:///./components/about_build_modal/about_build_modal.jsx","webpack:///./components/about_build_modal/index.js","webpack:///./components/root/root.jsx","webpack:///./actions/views/system.js","webpack:///./components/link_tooltip/link_tooltip.tsx","webpack:///./images/icons/brokenimage.png","webpack:///./components/header_footer_template_route.jsx","webpack:///./images/filesOverlay.png","webpack:///./images/logoWhite.png","webpack:///./images/tutorialTip.gif","webpack:///./images/tutorialTipWhite.gif","webpack:///./images/appIcons.png","webpack:///./images/favicon/favicon-16x16.png","webpack:///./images/favicon/favicon-32x32.png","webpack:///./images/favicon/favicon-96x96.png","webpack:///./images/favicon/favicon-reddot-16x16.png","webpack:///./images/favicon/favicon-reddot-32x32.png","webpack:///./images/favicon/favicon-reddot-96x96.png","webpack:///./utils/a11y_controller.js","webpack:///./actions/views/posts.js","webpack:///./components/delete_post_modal/delete_post_modal.jsx","webpack:///./components/delete_post_modal/index.js","webpack:///./components/gif_picker/utils/constants.js","webpack:///./components/widgets/icons/gif_search_icon.jsx","webpack:///./components/widgets/icons/gif_search_clear_icon.jsx","webpack:///./components/gif_picker/components/SearchBar/index.jsx","webpack:///./components/widgets/icons/gif_trending_icon.jsx","webpack:///./components/widgets/icons/gif_reactions_icon.jsx","webpack:///./components/gif_picker/components/Header/index.jsx","webpack:///./components/gif_picker/components/App/index.jsx","webpack:///./components/gif_picker/components/InfiniteScroll/index.js","webpack:///./components/gif_picker/components/Categories/index.jsx","webpack:///./components/gif_picker/components/SearchItem/index.jsx","webpack:///./components/gif_picker/components/SearchGrid/SearchGrid.jsx","webpack:///./components/gif_picker/components/SearchGrid/index.js","webpack:///./components/gif_picker/components/Search/index.jsx","webpack:///./components/gif_picker/components/Trending/index.jsx","webpack:///./components/gif_picker/gif_picker.jsx","webpack:///./components/widgets/icons/emoji_icon.jsx","webpack:///./components/widgets/icons/gfycat_icon.jsx","webpack:///./components/emoji_picker/components/emoji_picker_header.jsx","webpack:///./utils/emoji_utils.jsx","webpack:///./components/emoji_picker/components/emoji_picker_category.jsx","webpack:///./components/emoji_picker/components/emoji_picker_item.jsx","webpack:///./components/emoji_picker/emoji_picker_category_section.jsx","webpack:///./components/emoji_picker/components/emoji_picker_preview.jsx","webpack:///./components/emoji_picker/emoji_picker.jsx","webpack:///./components/emoji_picker/index.js","webpack:///./components/emoji_picker/emoji_picker_tabs.jsx","webpack:///./components/emoji_picker/emoji_picker_overlay.jsx","webpack:///./utils/channel_utils.jsx","webpack:///./components/post_view/combined_system_message/last_users.jsx","webpack:///./components/post_view/combined_system_message/combined_system_message.jsx","webpack:///./components/post_view/combined_system_message/index.js","webpack:///./components/post_view/post_add_channel_member/post_add_channel_member.jsx","webpack:///./components/post_view/post_add_channel_member/index.js","webpack:///./components/post_markdown/system_message_helpers.jsx","webpack:///./components/post_markdown/post_markdown.jsx","webpack:///./components/post_markdown/index.js","webpack:///./components/suggestion/at_mention_provider/at_mention_suggestion.jsx","webpack:///./components/suggestion/at_mention_provider/at_mention_provider.jsx","webpack:///./components/suggestion/at_mention_provider/index.js","webpack:///./components/suggestion/channel_mention_provider.jsx","webpack:///./components/suggestion/command_provider.jsx","webpack:///./components/suggestion/emoticon_provider.jsx","webpack:///./components/textbox/textbox.jsx","webpack:///./components/textbox/index.js","webpack:///./components/textbox/textbox_links/textbox_links.jsx","webpack:///./components/textbox/textbox_links/index.js","webpack:///./components/edit_post_modal/edit_post_modal.jsx","webpack:///./components/edit_post_modal/index.js","webpack:///./stores/modal_store.jsx","webpack:///./components/get_link_modal.tsx","webpack:///./components/get_public_link_modal/get_public_link_modal.jsx","webpack:///./components/get_public_link_modal/index.js","webpack:///./components/leave_private_channel_modal/leave_private_channel_modal.tsx","webpack:///./components/leave_private_channel_modal/index.ts","webpack:///./components/reset_status_modal/reset_status_modal.jsx","webpack:///./components/reset_status_modal/index.js","webpack:///./components/shortcuts_modal.jsx","webpack:///./components/file_upload_overlay.tsx","webpack:///./utils/delayed_action.tsx","webpack:///./selectors/views/system.js","webpack:///./actions/command.js","webpack:///./actions/hooks.js","webpack:///./actions/views/create_comment.jsx","webpack:///./utils/paste.tsx","webpack:///./components/widgets/icons/attachment_icon.jsx","webpack:///./components/file_attachment/filename_overlay.jsx","webpack:///./components/widgets/icons/fa_remove_icon.jsx","webpack:///./components/file_preview/file_progress_preview.jsx","webpack:///./components/file_preview/file_preview.jsx","webpack:///./components/file_preview/index.js","webpack:///./actions/file_actions.jsx","webpack:///./components/file_upload/file_upload.jsx","webpack:///./utils/dragster.ts","webpack:///./components/file_upload/index.js","webpack:///./components/msg_typing/msg_typing.tsx","webpack:///./components/msg_typing/index.ts","webpack:///./components/post_deleted_modal.tsx","webpack:///./components/message_submit_error.tsx","webpack:///./components/create_comment/create_comment.jsx","webpack:///./components/create_comment/index.js","webpack:///./components/recent_date.tsx","webpack:///./components/widgets/separator/basic-separator.tsx","webpack:///./components/post_view/date_separator/date_separator.jsx","webpack:///./components/post_view/date_separator/index.js","webpack:///./components/post_view/floating_timestamp/floating_timestamp.jsx","webpack:///./components/post_view/floating_timestamp/index.js","webpack:///./components/permissions_gates/channel_permission_gate/channel_permission_gate.jsx","webpack:///./components/permissions_gates/channel_permission_gate/index.js","webpack:///./components/dot_menu/dot_menu.jsx","webpack:///./components/dot_menu/index.js","webpack:///./components/widgets/icons/download_icon.jsx","webpack:///./components/file_attachment/file_thumbnail/file_thumbnail.tsx","webpack:///./components/file_attachment/file_thumbnail/index.ts","webpack:///./components/file_attachment/file_attachment.jsx","webpack:///./components/file_attachment/index.js","webpack:///./components/single_image_view/single_image_view.jsx","webpack:///./components/single_image_view/index.js","webpack:///./components/file_attachment_list/file_attachment_list.jsx","webpack:///./components/file_attachment_list/index.js","webpack:///./components/post_profile_picture/post_profile_picture.jsx","webpack:///./components/post_profile_picture/index.jsx","webpack:///./components/post_view/failed_post_options/failed_post_options.jsx","webpack:///./components/post_view/failed_post_options/index.js","webpack:///./components/widgets/icons/flag_icon.jsx","webpack:///./components/widgets/icons/flag_icon_filled.jsx","webpack:///./components/post_view/post_flag_icon/post_flag_icon.js","webpack:///./components/post_view/post_flag_icon/index.js","webpack:///./components/post_view/post_time/post_time.jsx","webpack:///./components/post_view/post_time/index.js","webpack:///./components/post_view/post_reaction/post_reaction.jsx","webpack:///./components/post_view/post_reaction/index.js","webpack:///./components/post_view/reaction/reaction.jsx","webpack:///./components/post_view/reaction/index.js","webpack:///./components/post_view/reaction_list/reaction_list.jsx","webpack:///./components/post_view/reaction_list/index.js","webpack:///./components/post_view/show_more/show_more.jsx","webpack:///./components/post_view/show_more/index.js","webpack:///./components/post_view/message_attachments/action_button.jsx","webpack:///./components/post_view/post_context.js","webpack:///./components/post_view/message_attachments/action_menu/action_menu.jsx","webpack:///./components/post_view/message_attachments/action_menu/index.js","webpack:///./utils/markdown/link_only_renderer.tsx","webpack:///./components/post_view/message_attachments/message_attachment/message_attachment.jsx","webpack:///./components/post_view/message_attachments/message_attachment/index.js","webpack:///./components/post_view/message_attachments/message_attachment_list.jsx","webpack:///./components/post_view/post_attachment_opengraph/get_nearest_point.js","webpack:///./components/post_view/post_attachment_opengraph/post_attachment_opengraph.jsx","webpack:///./components/post_view/post_attachment_opengraph/index.js","webpack:///./components/post_view/post_image/post_image.jsx","webpack:///./components/post_view/post_image/index.js","webpack:///./utils/youtube.js","webpack:///./components/youtube_video/youtube_video.jsx","webpack:///./components/youtube_video/index.js","webpack:///./components/post_view/post_body_additional_content/post_body_additional_content.jsx","webpack:///./components/post_view/post_body_additional_content/index.js","webpack:///./components/post_view/post_message_view/post_message_view.jsx","webpack:///./components/post_view/post_message_view/index.js","webpack:///./components/message_with_additional_content.jsx","webpack:///./components/widgets/icons/info_small_icon.jsx","webpack:///./components/user_profile/user_profile.jsx","webpack:///./components/user_profile/index.js","webpack:///./components/rhs_comment/rhs_comment.jsx","webpack:///./components/rhs_comment/index.js","webpack:///./components/rhs_header_post/rhs_header_post.jsx","webpack:///./components/rhs_header_post/index.js","webpack:///./components/rhs_root_post/rhs_root_post.jsx","webpack:///./components/rhs_root_post/index.js","webpack:///./components/rhs_thread/rhs_thread.jsx","webpack:///./components/rhs_thread/index.js","webpack:///./components/rhs_card_header/rhs_card_header.jsx","webpack:///./components/rhs_card_header/index.jsx","webpack:///./components/rhs_card/rhs_card.jsx","webpack:///./components/rhs_card/index.js","webpack:///./components/widgets/icons/fa_select_icon.jsx","webpack:///./components/suggestion/search_channel_suggestion/search_channel_suggestion.jsx","webpack:///./components/suggestion/search_channel_suggestion/index.js","webpack:///./components/suggestion/search_channel_provider.jsx","webpack:///./components/suggestion/search_suggestion_list.jsx","webpack:///./components/suggestion/suggestion_date.jsx","webpack:///./components/suggestion/search_user_provider.jsx","webpack:///./components/suggestion/search_date_suggestion/search_date_suggestion.jsx","webpack:///./components/suggestion/search_date_suggestion/index.js","webpack:///./components/suggestion/search_date_provider.jsx","webpack:///./components/channel_header/components/header_icon_wrapper.js","webpack:///./components/search_hint/search_hint.tsx","webpack:///./components/widgets/icons/mentions_icon.jsx","webpack:///./components/search_bar/search_bar.jsx","webpack:///./components/search_bar/index.jsx","webpack:///./components/search_results_header/search_results_header.jsx","webpack:///./components/search_results_header/index.jsx","webpack:///./components/widgets/icons/reply_icon.jsx","webpack:///./components/common/comment_icon.tsx","webpack:///./components/search_results_item/search_results_item.jsx","webpack:///./components/search_results_item/index.js","webpack:///./components/search_hint/data_retention_hint.jsx","webpack:///./components/search_hint/flag_post_search_hint.jsx","webpack:///./components/search_hint/no_result_search_hint.jsx","webpack:///./components/search_hint/pin_post_search_hint.jsx","webpack:///./components/search_results/search_results.jsx","webpack:///./components/search_results/index.jsx","webpack:///./plugins/rhs_plugin/rhs_plugin.jsx","webpack:///./plugins/rhs_plugin/index.js","webpack:///./components/sidebar_right/sidebar_right.jsx","webpack:///./components/sidebar_right/index.js","webpack:///./components/tutorial/tutorial_tip/tutorial_tip.tsx","webpack:///./components/tutorial/tutorial_tip/index.js","webpack:///./components/tutorial/menu_tutorial_tip.jsx","webpack:///./actions/invite_actions.jsx","webpack:///./components/widgets/icons/close_icon.jsx","webpack:///./components/widgets/icons/back_icon.jsx","webpack:///./components/widgets/modals/full_screen_modal.tsx","webpack:///./components/root_portal.jsx","webpack:///./components/widgets/icons/invite_icon.jsx","webpack:///./components/widgets/icons/arrow_right_icon.jsx","webpack:///./components/invitation_modal/invitation_modal_initial_step.jsx","webpack:///./components/widgets/icons/invite_members_icon.jsx","webpack:///./components/widgets/icons/mail_icon.jsx","webpack:///./components/widgets/icons/mail_plus_icon.jsx","webpack:///./components/widgets/icons/close_circle_solid_icon.jsx","webpack:///./components/widgets/inputs/users_emails_input.jsx","webpack:///./components/widgets/icons/link_icon.jsx","webpack:///./components/invitation_modal/invitation_modal_members_step.jsx","webpack:///./components/widgets/icons/close_circle_icon.jsx","webpack:///./components/widgets/inputs/channels_input.jsx","webpack:///./components/invitation_modal/invitation_modal_guests_step.jsx","webpack:///./components/widgets/icons/alert_icon.jsx","webpack:///./components/invitation_modal/invitation_modal_confirm_step_row.jsx","webpack:///./components/invitation_modal/invitation_modal_confirm_step_table.jsx","webpack:///./components/invitation_modal/invitation_modal_confirm_step.jsx","webpack:///./components/invitation_modal/invitation_modal.jsx","webpack:///./components/invitation_modal/index.js","webpack:///./components/widgets/icons/leave_team_icon.jsx","webpack:///./components/leave_team_modal/leave_team_modal.tsx","webpack:///./components/leave_team_modal/index.ts","webpack:///./components/searchable_user_list/searchable_user_list_container.jsx","webpack:///./components/widgets/icons/fa_dropdown_icon.jsx","webpack:///./components/team_members_dropdown/team_members_dropdown.jsx","webpack:///./components/team_members_dropdown/index.js","webpack:///./components/member_list_team/member_list_team.tsx","webpack:///./components/member_list_team/index.ts","webpack:///./components/team_members_modal/team_members_modal.tsx","webpack:///./components/team_members_modal/index.ts","webpack:///./components/team_general_tab/team_general_tab.jsx","webpack:///./components/team_general_tab/index.js","webpack:///./components/setting_upload.jsx","webpack:///./components/team_import_tab.jsx","webpack:///./components/team_settings/team_settings.jsx","webpack:///./components/team_settings/index.js","webpack:///./components/team_settings_modal/team_settings_modal.jsx","webpack:///./components/team_settings_modal/index.js","webpack:///./selectors/views/marketplace.js","webpack:///./actions/marketplace.js","webpack:///./components/widgets/icons/plugin_icon.jsx","webpack:///./components/plugin_marketplace/marketplace_item/marketplace_item.js","webpack:///./components/plugin_marketplace/marketplace_item/index.js","webpack:///./components/plugin_marketplace/marketplace_list/navigation_row/navigation_button.jsx","webpack:///./components/plugin_marketplace/marketplace_list/navigation_row/navigation_row.jsx","webpack:///./components/plugin_marketplace/marketplace_list/navigation_row/index.js","webpack:///./components/plugin_marketplace/marketplace_list/marketplace_list.jsx","webpack:///./components/plugin_marketplace/marketplace_modal.js","webpack:///./components/plugin_marketplace/index.js","webpack:///./components/list_modal.jsx","webpack:///./components/team_groups_manage_modal/team_groups_manage_modal.jsx","webpack:///./components/team_groups_manage_modal/index.js","webpack:///./components/main_menu/main_menu.jsx","webpack:///./components/main_menu/index.jsx","webpack:///./components/sidebar_right_menu/sidebar_right_menu.jsx","webpack:///./components/sidebar_right_menu/index.js","webpack:///./components/user_settings/import_theme_modal.jsx","webpack:///./selectors/lhs.jsx","webpack:///./components/copy_url_context_menu/copy_url_context_menu.jsx","webpack:///./components/copy_url_context_menu/index.js","webpack:///./components/legacy_team_sidebar/components/team_button.jsx","webpack:///./components/legacy_team_sidebar/legacy_team_sidebar_controller.jsx","webpack:///./components/legacy_team_sidebar/index.js","webpack:///./components/searchable_channel_list.jsx","webpack:///./components/more_channels/more_channels.jsx","webpack:///./components/more_channels/index.js","webpack:///./components/more_direct_channels/group_message_option.tsx","webpack:///./components/more_direct_channels/more_direct_channels.tsx","webpack:///./components/more_direct_channels/index.ts","webpack:///./components/widgets/icons/draft_icon.jsx","webpack:///./components/suggestion/switch_channel_provider.jsx","webpack:///./components/suggestion/switch_team_provider.jsx","webpack:///./components/quick_switch_modal/quick_switch_modal.jsx","webpack:///./components/quick_switch_modal/index.js","webpack:///./components/new_channel_modal/new_channel_modal.jsx","webpack:///./components/new_channel_modal/index.js","webpack:///./components/change_url_modal/change_url_modal.jsx","webpack:///./components/change_url_modal/index.js","webpack:///./components/new_channel_flow/new_channel_flow.tsx","webpack:///./components/new_channel_flow/index.ts","webpack:///./components/widgets/icons/unread_below_icon.jsx","webpack:///./components/unread_channel_indicator.tsx","webpack:///./components/status_dropdown/status_dropdown.jsx","webpack:///./components/status_dropdown/index.jsx","webpack:///./components/legacy_sidebar/header/sidebar_header_dropdown_button.jsx","webpack:///./components/legacy_sidebar/header/dropdown/sidebar_header_dropdown.jsx","webpack:///./components/legacy_sidebar/header/dropdown/index.js","webpack:///./components/legacy_sidebar/header/sidebar_header.jsx","webpack:///./components/legacy_sidebar/header/index.js","webpack:///./components/widgets/icons/bot_icon.jsx","webpack:///./components/legacy_sidebar/sidebar_channel_button_or_link/sidebar_channel_button_or_link_icon.jsx","webpack:///./components/legacy_sidebar/sidebar_channel_button_or_link/sidebar_channel_button_or_link_close_button.jsx","webpack:///./components/legacy_sidebar/sidebar_channel_button_or_link/sidebar_channel_button_or_link.jsx","webpack:///./components/legacy_sidebar/sidebar_tutorial_tip.jsx","webpack:///./components/legacy_sidebar/sidebar_channel/sidebar_channel.jsx","webpack:///./components/legacy_sidebar/sidebar_channel/index.js","webpack:///./components/legacy_sidebar/channel_create.jsx","webpack:///./components/legacy_sidebar/channel_more.jsx","webpack:///./components/legacy_sidebar/channel_name.jsx","webpack:///./components/legacy_sidebar/more_public_direct_channels.jsx","webpack:///./components/legacy_sidebar/sidebar.jsx","webpack:///./components/legacy_sidebar/index.js","webpack:///./components/sidebar/add_channel_dropdown.tsx","webpack:///./components/sidebar/sidebar_header/sidebar_header.tsx","webpack:///./components/sidebar/sidebar_header/index.ts","webpack:///./components/sidebar/channel_navigator/channel_navigator.tsx","webpack:///./components/sidebar/channel_navigator/index.ts","webpack:///./actions/views/channel_sidebar.ts","webpack:///./selectors/views/channel_sidebar.ts","webpack:///./components/sidebar/channel_filter/channel_filter.tsx","webpack:///./components/sidebar/channel_filter/index.ts","webpack:///./components/sidebar/sidebar_channel/channel_mention_badge.tsx","webpack:///./components/sidebar/sidebar_channel/sidebar_channel_close.tsx","webpack:///./components/sidebar/sidebar_channel/sidebar_channel_icon/sidebar_channel_icon.tsx","webpack:///./components/sidebar/sidebar_channel/sidebar_channel_icon/index.ts","webpack:///./components/sidebar/sidebar_channel/sidebar_channel_link/sidebar_channel_link.tsx","webpack:///./components/sidebar/sidebar_channel/sidebar_channel_link/index.ts","webpack:///./components/sidebar/sidebar_channel/sidebar_base_channel/sidebar_base_channel.tsx","webpack:///./components/sidebar/sidebar_channel/sidebar_base_channel/index.ts","webpack:///./components/status_icon_new.tsx","webpack:///./components/sidebar/sidebar_channel/sidebar_direct_channel/sidebar_direct_channel.tsx","webpack:///./components/sidebar/sidebar_channel/sidebar_direct_channel/index.ts","webpack:///./components/sidebar/sidebar_channel/sidebar_group_channel/sidebar_group_channel.tsx","webpack:///./components/sidebar/sidebar_channel/sidebar_group_channel/index.ts","webpack:///./components/sidebar/sidebar_channel/sidebar_channel.tsx","webpack:///./components/sidebar/sidebar_channel/index.ts","webpack:///./components/sidebar/sidebar_category/sidebar_category.tsx","webpack:///./components/sidebar/sidebar_category/index.ts","webpack:///./components/sidebar/sidebar_category_list/sidebar_category_list.tsx","webpack:///./components/sidebar/sidebar_category_list/index.ts","webpack:///./components/sidebar/sidebar.tsx","webpack:///./components/sidebar/index.ts","webpack:///./components/permalink_view/actions.js","webpack:///./components/permalink_view/permalink_view.jsx","webpack:///./components/permalink_view/index.js","webpack:///./components/channel_header_dropdown/channel_header_dropdown.js","webpack:///./plugins/mobile_channel_header_plug/mobile_channel_header_plug.jsx","webpack:///./plugins/mobile_channel_header_plug/index.js","webpack:///./components/channel_notifications_modal/components/describe.jsx","webpack:///./components/channel_notifications_modal/components/section_title.jsx","webpack:///./components/channel_notifications_modal/components/collapse_view.jsx","webpack:///./components/channel_notifications_modal/components/extra_info.jsx","webpack:///./components/channel_notifications_modal/components/expand_view.jsx","webpack:///./components/channel_notifications_modal/components/notification_section.jsx","webpack:///./components/channel_notifications_modal/channel_notifications_modal.jsx","webpack:///./components/channel_notifications_modal/index.js","webpack:///./components/channel_invite_modal/channel_invite_modal.jsx","webpack:///./components/channel_invite_modal/index.js","webpack:///./components/channel_members_dropdown/channel_members_dropdown.jsx","webpack:///./components/channel_members_dropdown/index.js","webpack:///./components/member_list_channel/member_list_channel.tsx","webpack:///./components/member_list_channel/index.ts","webpack:///./components/channel_members_modal/channel_members_modal.tsx","webpack:///./components/channel_members_modal/index.ts","webpack:///./components/channel_info_modal/channel_info_modal.jsx","webpack:///./components/channel_info_modal/index.js","webpack:///./components/edit_channel_header_modal/edit_channel_header_modal.jsx","webpack:///./components/edit_channel_header_modal/index.js","webpack:///./components/edit_channel_purpose_modal/edit_channel_purpose_modal.jsx","webpack:///./components/edit_channel_purpose_modal/index.js","webpack:///./components/rename_channel_modal/rename_channel_modal.jsx","webpack:///./components/rename_channel_modal/index.js","webpack:///./components/convert_channel_modal/convert_channel_modal.jsx","webpack:///./components/convert_channel_modal/index.js","webpack:///./components/delete_channel_modal/delete_channel_modal.jsx","webpack:///./components/delete_channel_modal/index.js","webpack:///./components/unarchive_channel_modal/unarchive_channel_modal.jsx","webpack:///./components/unarchive_channel_modal/index.js","webpack:///./components/channel_groups_manage_modal/channel_groups_manage_modal.tsx","webpack:///./components/channel_groups_manage_modal/index.ts","webpack:///./components/channel_header_dropdown/menu_items/leave_channel/leave_channel.js","webpack:///./components/channel_header_dropdown/menu_items/leave_channel/index.js","webpack:///./components/channel_header_dropdown/menu_items/close_channel/close_channel.js","webpack:///./components/channel_header_dropdown/menu_items/close_channel/index.js","webpack:///./components/channel_header_dropdown/menu_items/close_message/close_message.js","webpack:///./components/channel_header_dropdown/menu_items/close_message/index.js","webpack:///./components/channel_header_dropdown/menu_items/toggle_mute_channel/toggle_mute_channel.js","webpack:///./components/channel_header_dropdown/menu_items/toggle_mute_channel/index.js","webpack:///./components/channel_header_dropdown/menu_items/toggle_favorite_channel/toggle_favorite_channel.js","webpack:///./components/channel_header_dropdown/menu_items/toggle_favorite_channel/index.js","webpack:///./components/channel_header_dropdown/menu_items/view_pinned_posts/view_pinned_posts.js","webpack:///./components/channel_header_dropdown/menu_items/view_pinned_posts/index.js","webpack:///./components/channel_header_dropdown/channel_header_dropdown_items.js","webpack:///./components/channel_header_dropdown/mobile_channel_header_dropdown_animation.jsx","webpack:///./components/channel_header_dropdown/mobile_channel_header_dropdown.js","webpack:///./components/channel_header_dropdown/index.js","webpack:///./components/notify_counts/notify_counts.tsx","webpack:///./components/notify_counts/index.ts","webpack:///./components/channel_header_mobile/collapse_lhs_button/collapse_lhs_button.js","webpack:///./components/channel_header_mobile/collapse_lhs_button/index.js","webpack:///./components/channel_header_mobile/collapse_rhs_button/collapse_rhs_button.js","webpack:///./components/channel_header_mobile/collapse_rhs_button/index.js","webpack:///./components/widgets/icons/info_icon.jsx","webpack:///./components/channel_header_mobile/channel_info_button/channel_info_button.js","webpack:///./components/channel_header_mobile/channel_info_button/index.js","webpack:///./components/channel_header_mobile/show_search_button/show_search_button.js","webpack:///./components/channel_header_mobile/show_search_button/index.js","webpack:///./components/channel_header_mobile/unmute_channel_button/unmute_channel_button.js","webpack:///./components/channel_header_mobile/unmute_channel_button/index.js","webpack:///./components/channel_header_mobile/channel_header_mobile.js","webpack:///./components/channel_header_mobile/index.js","webpack:///./components/channel_layout/channel_identifier_router/actions.js","webpack:///./components/widgets/icons/member_icon.jsx","webpack:///./components/widgets/icons/message_icon.jsx","webpack:///./components/popover_list_members/popover_list_members_item/popover_list_members_item.jsx","webpack:///./components/popover_list_members/popover_list_members_item/index.js","webpack:///./components/popover_list_members/popover_list_members.jsx","webpack:///./components/popover_list_members/index.js","webpack:///./components/widgets/icons/pin_icon.jsx","webpack:///./components/widgets/icons/plugin_channel_header_icon.jsx","webpack:///./plugins/channel_header_plug/channel_header_plug.jsx","webpack:///./plugins/channel_header_plug/index.js","webpack:///./components/channel_header/channel_header.js","webpack:///./components/channel_header/index.js","webpack:///./components/create_post/create_post.jsx","webpack:///./components/create_post/index.js","webpack:///./components/post_view/commented_on_files_message/commented_on_files_message.jsx","webpack:///./components/post_view/commented_on_files_message/index.js","webpack:///./components/post_view/commented_on/commented_on.jsx","webpack:///./components/post_view/commented_on/index.js","webpack:///./components/post_view/post_body/post_body.jsx","webpack:///./components/post_view/post_body/index.js","webpack:///./components/post_view/post_info/post_info.jsx","webpack:///./components/post_view/post_info/index.js","webpack:///./components/post_view/post_header/post_header.jsx","webpack:///./components/post_view/post_header/index.js","webpack:///./components/post_view/post/post.jsx","webpack:///./components/post_view/post/index.js","webpack:///./components/post_view/combined_user_activity_post/index.js","webpack:///./components/widgets/separator/notification-separator.tsx","webpack:///./components/post_view/new_message_separator/new_message_separator.jsx","webpack:///./components/post_view/channel_intro_message/channel_intro_message.jsx","webpack:///./components/post_view/channel_intro_message/index.js","webpack:///./components/post_view/post_list_row/post_list_row.jsx","webpack:///./components/post_view/post_list_row/index.js","webpack:///./components/widgets/icons/scroll_to_bottom_icon.jsx","webpack:///./components/post_view/scroll_to_bottom_arrows.jsx","webpack:///./components/toast/toast.jsx","webpack:///./components/toast_wrapper/toast_wrapper.jsx","webpack:///./components/toast_wrapper/index.jsx","webpack:///./components/post_view/post_list_virtualized/post_list_virtualized.jsx","webpack:///./components/post_view/post_list/post_list.jsx","webpack:///./components/post_view/post_list/index.js","webpack:///./components/post_view/post_view.jsx","webpack:///./components/post_view/index.js","webpack:///./components/tutorial/tutorial_intro_screens/tutorial_intro_screens.jsx","webpack:///./components/tutorial/tutorial_intro_screens/index.jsx","webpack:///./components/tutorial/tutorial_view.jsx","webpack:///./components/tutorial/index.jsx","webpack:///./components/channel_view/channel_view.jsx","webpack:///./components/deferComponentRender.jsx","webpack:///./components/channel_view/index.js","webpack:///./components/channel_layout/channel_identifier_router/channel_identifier_router.jsx","webpack:///./components/channel_layout/channel_identifier_router/index.js","webpack:///./components/channel_layout/center_channel/center_channel.tsx","webpack:///./components/channel_layout/center_channel/index.ts","webpack:///./components/favicon_title_handler/favicon_title_handler.tsx","webpack:///./components/favicon_title_handler/index.ts","webpack:///./components/channel_layout/channel_controller.jsx","webpack:///./components/needs_team/needs_team.tsx","webpack:///./components/needs_team/index.ts","webpack:///./components/permalink_redirector/actions.js","webpack:///./components/permalink_redirector/permalink_redirector.jsx","webpack:///./components/permalink_redirector/index.js","webpack:///./plugins/interactive_dialog.js","webpack:///./plugins/export.js","webpack:///./components/removed_from_channel_modal/removed_from_channel_modal.tsx","webpack:///./components/removed_from_channel_modal/index.ts","webpack:///./components/intl_provider/intl_provider.jsx","webpack:///./components/intl_provider/index.jsx","webpack:///./components/root/index.js"],"names":["CustomRenderer","marked","Renderer","constructor","disableLinks","super","this","link","href","title","text","substring","length","paragraph","FormattedMarkdownMessage","React","PureComponent","intl","intlShape","isRequired","id","PropTypes","string","defaultMessage","values","object","bool","render","origMsg","props","formatMessage","markedUpMessage","breaks","sanitize","renderer","dangerouslySetInnerHTML","__html","injectIntl","OverlayTrigger","forwardRef","ref","overlay","otherProps","OverlayWrapper","overlayProps","Provider","value","cloneElement","Consumer","defaultProps","defaultOverlayShown","trigger","displayName","LoadingScreen","Component","state","message","className","style","position","SubMenuModal","setState","show","SubMenuItems","elements","map","element","ItemSubMenu","key","subMenu","action","filter","xOffset","root","Modal","dialogClassName","onHide","onExited","enforceFocus","role","Body","onClick","openLeft","ariaLabel","Utils","toLowerCase","dispatch","store","getState","emitChannelClickEvent","channel","switchToChannel","chan","userId","getCurrentUserId","teamId","team_id","getCurrentTeamId","isRHSOpened","getIsRhsOpen","isPinnedPostsShowing","getRhsState","RHSStates","PIN","member","getMyChannelMember","getChannelStats","delete_at","penultimate","LocalStorageStore","getPreviousChannelName","name","setPenultimateChannelName","setPreviousChannelName","updateRhsState","loadProfilesForSidebar","batchActions","type","ChannelTypes","SELECT_CHANNEL","data","ActionTypes","SELECT_CHANNEL_WITH_MEMBER","fake","async","success","fail","currentUserId","otherUserId","receivedChannel","createDirectChannel","userVisitedFakeChannel","browserHistory","push","currentTeam","updateNewMessagesAtInChannel","channelId","last_viewed_at","Date","now","UPDATE_CHANNEL_LAST_VIEWED_AT","channel_id","emitCloseRightHandSide","closeRightHandSide","toggleShortcutsModal","AppDispatcher","handleViewAction","TOGGLE_SHORTCUTS_MODAL","showChannelNameUpdateModal","TOGGLE_CHANNEL_NAME_UPDATE_MODAL","showGetPublicLinkModal","fileId","TOGGLE_GET_PUBLIC_LINK_MODAL","showLeavePrivateChannelModal","TOGGLE_LEAVE_PRIVATE_CHANNEL_MODAL","showMobileSubMenuModal","submenuModalData","ModalId","ModalIdentifiers","MOBILE_SUBMENU","dialogType","dialogProps","openModal","sendEphemeralPost","parentId","timestamp","post","user_id","getCurrentChannelId","PostTypes","EPHEMERAL","create_at","update_at","root_id","parent_id","handleNewPost","sendAddToChannelEphemeralPost","user","addedUsername","addedUserId","postRootId","EPHEMERAL_ADD_TO_CHANNEL","username","lastTimeTypingSent","emitLocalUserTypingEvent","parentPostId","actionDispatch","actionGetState","config","getConfig","t","stats","getCurrentChannelStats","membersInChannel","member_count","TimeBetweenUserTypingUpdatesMilliseconds","MaxNotificationsPerChannel","EnableUserTypingMessages","WebSocketClient","userTyping","emitUserLoggedOutEvent","redirectTo","shouldSignalLogout","userAction","setWasLoggedIn","logout","then","BrowserStore","signalLogout","clear","stopPeriodicStatusUpdates","WebsocketActions","clearUserCookie","catch","toggleSideBarRightMenuAction","doDispatch","closeLhs","closeRhsMenu","emitBrowserFocus","focus","BROWSER_CHANGE_FOCUS","getTeamRedirectChannelIfIsAccesible","team","myMember","getMyTeamMember","Object","keys","teamChannels","getChannelsNameMapInTeam","fetchMyChannelsAndMembers","channelName","channelMember","getChannelByNameAndTeamName","getRedirectChannelNameForTeam","redirectUserToDefaultTeam","getCurrentUser","getTeamMemberships","loadMe","locale","getCurrentLocale","getPreviousTeamId","myTeams","getMyTeams","getTeam","selectChannel","filterAndSortTeamsByDisplayName","myTeam","intlConfigPropTypes","timeZone","formats","messages","textComponent","any","defaultLocale","defaultFormats","onError","func","intlFormatPropTypes","formatDate","formatTime","formatRelativeTime","formatNumber","formatPlural","formatHTMLMessage","shape","formatters","ConfirmModal","e","cancelButton","document","getElementById","activeElement","handleCancel","handleConfirm","checked","target","onConfirm","onCancel","componentDidMount","addEventListener","handleKeypress","componentWillUnmount","removeEventListener","shouldComponentUpdate","nextProps","nextState","componentDidUpdate","prevProps","checkbox","cancelText","showCheckbox","onChange","handleCheckboxChange","checkboxText","cancelButtonText","hideCancel","modalClass","aria-labelledby","Header","closeButton","Title","componentClass","Footer","autoFocus","confirmButtonClass","confirmButtonText","SubMenuItem","event","postId","isMobile","pathPair","entries","nativeEvent","find","path","stopPropagation","slice","composedPath","node","createRef","icon","textProp","Fragment","hasSubmenu","parentWidth","current","getBoundingClientRect","width","childOffset","isValidElement","offset","subMenuStyle","visibility","right","parseInt","String","subMenuContent","s","aria-label","onMouseEnter","onMouseLeave","hide","MenuGroup","preventDefault","children","divider","handleDividerClick","MenuItemActionImpl","extraText","buttonClass","isDangerous","data-testid","MenuItemAction","menuItem","MenuItemExternalLinkImpl","url","rel","MenuItemExternalLink","MenuItemLinkImpl","to","MenuItemLink","MenuItemToggleModalReduxImpl","modalId","accessibilityLabel","MenuItemToggleModalRedux","Menu","observer","disconnect","prevWasDivider","isAtBeginning","child","classList","contains","display","reverse","observe","attributes","childList","subtree","MutationObserver","hideUnneededDividers","rect","openUp","customStyles","styles","left","bottom","top","handleMenuClick","modalData","MODAL_OPEN","closeModal","MODAL_CLOSE","reloadConfig","error","err","AdminActions","server_error_id","adminResetMfa","UserActions","getClusterStatus","ldapTest","invalidateAllCaches","recycleDatabaseConnection","adminResetEmail","getOAuthAppInfo","clientId","bindClientFunc","clientFunc","Client4","params","allowOAuth2","responseType","redirectUri","scope","authorizeOAuthApp","emailToLdap","loginId","password","token","ldapId","ldapPassword","emailToOAuth","newType","oauthToEmail","currentService","email","follow_link","uploadBrandImage","brandImage","deleteBrandImage","uploadPublicSamlCertificate","file","uploadPrivateSamlCertificate","uploadIdpSamlCertificate","removePublicSamlCertificate","removePrivateSamlCertificate","removeIdpSamlCertificate","getStandardAnalytics","getAdvancedAnalytics","getBotPostsPerDayAnalytics","getPostsPerDayAnalytics","getUsersPerDayAnalytics","elasticsearchTest","testS3Connection","elasticsearchPurgeIndexes","setNavigationBlocked","blocked","SET_NAVIGATION_BLOCKED","deferNavigation","onNavigationConfirmed","DEFER_NAVIGATION","cancelNavigation","CANCEL_NAVIGATION","confirmNavigation","thunkDispatch","thunkGetState","callback","getOnNavigationConfirmed","CONFIRM_NAVIGATION","invalidateAllEmailInvites","TeamActions","testSmtp","registerAdminConsolePlugin","pluginId","reducer","storeDispatch","RECEIVED_ADMIN_CONSOLE_REDUCER","unregisterAdminConsolePlugin","REMOVED_ADMIN_CONSOLE_REDUCER","testSiteURL","siteURL","registerAdminConsoleCustomSetting","component","showTitle","RECEIVED_ADMIN_CONSOLE_CUSTOM_COMPONENT","options","getSamlMetadataFromIdp","samlMetadataURL","setSamlIdpCertificateFromMetadata","certData","LocalizedInput","placeholder","localizedPlaceholder","FormError","errors","iconClassName","margin","textClassName","MenuWrapperAnimation","isAppearing","nodeStyler","styler","chain","update","complete","tween","from","opacity","duration","start","set","CSSTransition","in","classNames","enter","exit","mountOnEnter","unmountOnExit","onEntering","onExiting","timeout","MenuWrapper","Constants","KeyCodes","ESCAPE","close","TAB","closeOnBlur","open","onToggle","newState","Array","isArray","Error","keyboardClose","Animation","animationComponent","toggle","checkAndSetMobileView","UPDATE_MOBILE_VIEW","goToLastViewedChannel","currentChannel","getCurrentChannel","channelsInTeam","getChannelsNameMapInCurrentTeam","channelToSwitchTo","getChannelByName","getLastViewedChannelName","switchToChannelById","getChannel","teamUrl","getCurrentRelativeTeamUrl","display_name","getUserByUsername","openDirectChannelToUserId","GM_CHANNEL","gmChannel","joinChannelById","currentTeamId","joinChannel","leaveChannel","myPreferences","getMyPreferences","getCurrentTeam","isFavoriteChannel","unfavoriteChannel","removePreviousChannelName","leaveChannelRedux","prevChannelName","prevChannel","getMyChannelMemberships","getMyChannels","c","OPEN_CHANNEL","PRIVATE_CHANNEL","selectTeam","TeamTypes","LEAVE_TEAM","autocompleteUsersInChannel","prefix","autocompleteUsers","loadUnreads","time","PostActions","atLatestMessage","atOldestmessage","INCREASE_POST_VISIBILITY","amount","order","next_post_id","RECEIVED_POSTS_FOR_CHANNEL_AT_TIME","prev_post_id","loadPostsAround","focusedPostId","Posts","POST_CHUNK_SIZE","loadLatestPosts","loadPosts","POST_INCREASE_AMOUNT","LOADING_POSTS","result","PostRequestTypes","BEFORE_ID","actions","moreToLoad","syncPostsInChannel","since","socketStatus","getSocketStatus","sinceTimeToGetPosts","lastPostsApiCallForChannel","getLastPostsApiTimeForChannel","lastDisconnectAt","scrollPostListToBottom","EventEmitter","emit","EventTypes","POST_LIST_SCROLL_TO_BOTTOM","markChannelAsReadOnFocus","isManuallyUnread","markChannelAsRead","updateToastStatus","status","UPDATE_TOAST_STATUS","BotBadge","SettingItemMax","shiftEnter","keyCode","ENTER","shiftKey","disableEnterSubmit","isKeyPressed","submit","tagName","parentElement","settingList","handleSubmit","setting","updateSection","section","focusableElements","querySelectorAll","onKeyDown","clientError","serverError","extraInfo","hintClass","infoPosition","saveButtonText","saving","disabled","inputs","widthClass","listContent","containerStyle","tabIndex","submitExtra","handleUpdateSection","oneOfType","LocalizedIcon","localizedTitle","Avatar","size","alt","src","latestPrefix","latestComplete","disableDispatches","requestStarted","handlePretextChanged","pretext","resetRequest","startNewRequest","shouldCancelDispatch","allowDividers","presentationType","Suggestion","term","matchedPretext","onMouseMove","item","isSelection","getPreviousActiveSection","views","settings","previousActiveSection","updateActiveSection","newActiveSection","UPDATE_ACTIVE_SECTION","SettingItemMin","edit","editButton","describeSection","disableOpen","getEdit","describe","connect","bindActionCreators","Markdown","enableFormatting","assign","autolinkedUrlSchemes","mentionKeys","atMentions","channelNamesMap","proxyImages","hasImageProxy","minimumHashtagLength","htmlFormattedText","TextFormatting","emojiMap","messageHtmlToComponent","isRHS","imageProps","imagesMetadata","hasPluginTooltips","postType","mentionHighlight","array","arrayOf","number","getChannelNamesMap","createSelector","channelMentions","ownProps","getAutolinkedUrlSchemes","getBool","Preferences","CATEGORY_ADVANCED_SETTINGS","getCurrentUserMentionKeys","getSiteURL","HasImageProxy","MinimumHashtagLength","getEmojiMap","getDirectChannelName","ChannelActions","trackEvent","prefDirect","category","CATEGORY_DIRECT_CHANNEL_SHOW","prefOpenTime","CATEGORY_CHANNEL_OPEN_TIME","toString","PreferenceTypes","RECEIVED_PREFERENCES","savePreferences","openGroupChannelToUserIds","userIds","getCurrentTeamUrl","loadChannelsForCurrentUser","unreads","getUnreadChannelIds","DM_CHANNEL","loadNewDMIfNeeded","loadNewGMIfNeeded","searchMoreChannels","showArchivedChannels","myMembers","autocompleteChannels","autocompleteChannelsForSearch","addUsersToChannel","requests","uId","Promise","all","SaveButton","savingMessage","btnClass","extraClasses","loading","LoadingSpinner","LoadingWrapper","GuestBadge","WarningIcon","additionalClassName","canUploadFiles","enableFileAttachments","EnableFileAttachments","enableMobileFileUpload","EnableMobileFileUpload","UserAgent","canDownloadFiles","EnableMobileFileDownload","trimFilename","filename","trimmedFilename","MAX_FILENAME_LENGTH","Math","min","getFileTypeFromMime","mimetype","mimeTypeSplitBySlash","split","mimeTypePrefix","mimeTypeSuffix","includes","getExifOrientation","view","DataView","getUint16","byteLength","marker","getUint32","little","tags","i","getOrientationStyles","orientation","transform","transformOrigin","exif2css","Pluggable","pluggableName","Children","only","components","childrenProps","componentName","getComponentName","Reflect","deleteProperty","hasOwnProperty","pluginComponents","pluggableId","content","p","PluginComponent","theme","plugins","getTheme","GlobeIcon","height","viewBox","stroke","strokeWidth","fill","fillRule","d","LockIcon","SuggestionList","$","contentRef","getContent","visibleContentHeight","clientHeight","scrollHeight","contentTop","scrollTop","contentTopPadding","css","contentBottomPadding","ReactDOM","findDOMNode","itemRefs","get","itemTop","offsetTop","itemBottomMargin","itemBottom","Map","suggestionReadOut","currentLabel","currentItem","selection","scrollToItem","isEmptyObject","generateLabel","removeLabel","announceLabel","ariaLiveRef","innerHTML","first_name","last_name","nickname","renderDivider","renderNoResults","cleared","items","lastType","terms","renderDividers","onCompleteWord","onItemHover","mainClass","location","contentClass","maxHeight","SUGGESTION_LIST_MAXHEIGHT","wrapperHeight","windowHeight","contentStyle","onMouseDown","preventClose","SizeMap","xs","sm","md","lg","Popover","placement","popoverSize","popoverStyle","onMouseOut","onMouseOver","bsStyle","bsClass","bsSize","ProfilePicture","profileSrc","profileIconClass","isEmoji","rootClose","isBusy","hideProfilePopover","hasMention","wrapperClass","isModalOpen","modals","modalState","setModalSearchTerm","SearchTypes","SET_MODAL_SEARCH","setSystemUsersSearch","SET_SYSTEM_USERS_SEARCH","isLicensePastGracePeriod","license","IsLicensed","ExpiresAt","incrementAnnouncementBarCount","TRACK_ANNOUNCEMENT_BAR","decrementAnnouncementBarCount","DISMISS_ANNOUNCEMENT_BAR","AnnouncementBar","handleClose","body","add","announcementBarCount","remove","barClass","barStyle","linkStyle","color","textColor","backgroundColor","AnnouncementBarTypes","DEVELOPER","CRITICAL","SUCCESS","showCloseButton","announcementTooltip","Tooltip","delayShow","OVERLAY_TIME_DELAY","getAnnouncementBarCount","TextDismissableBar","allowDismissal","localStorage","setItem","dismissed","onDismissal","getItem","extraProps","handleDismiss","singleline","ConfigurationAnnouncementBar","dismissNotice","AnnouncementBarMessages","LICENSE_EXPIRING","canViewSystemErrors","renewalLink","RENEWAL_LINK","totalUsers","LICENSE_EXPIRED","isLicenseExpiring","dismissedExpiringLicense","dismissExpiringLicense","ANNOUNCEMENT","date","LICENSE_PAST_GRACE","SendEmailNotifications","EnablePreviewModeBanner","emailMessage","PREVIEW_MODE","SiteURL","EnableSignUpWithGitLab","siteURLMessage","Boolean","notice","hasBeenDismissed","ConfigurationBar","VersionBar","window","reload","serverVersionOnAppLoad","serverVersion","equalServerVersions","reloadPage","entities","general","AnnouncementBarController","adminConfiguredAnnouncementBar","EnableBanner","BannerText","trim","BannerColor","BannerTextColor","AllowBannerDismissal","errorBar","latestError","dismissError","email_verified","haveISystemPermission","permission","Permissions","MANAGE_SYSTEM","getLicense","getDisplayableErrors","admin","analytics","TOTAL_USERS","dismissFirstError","bind","SystemPermissionGate","hasPermission","invert","permissions","TeamPermissionGate","haveITeamPermission","SpinnerButton","spinning","spinningText","SuggestionBox","mentionKey","insertText","test","addTextAtCaret","inputRef","input","getInput","getDOMNode","recalculateSize","delay","setTimeout","preventSuggestionListCloseFlag","container","relatedTarget","handleEmitClearSuggestions","focused","onBlur","openOnFocus","openWhenEmpty","textbox","getTextbox","selectionEnd","requiredCharacters","onFocus","composing","onComposition","selectionStart","caret","keepPretext","endsWith","termWithoutMatched","overlap","findOverlap","suffix","newValue","requestAnimationFrame","replaceAllInputOnSelect","replaceText","onItemSelected","provider","providers","handleCompleteWord","setSelectionByDelta","delta","selectionIndex","indexOf","some","hasSuggestions","UP","selectPrevious","DOWN","selectNext","completeOnTab","clearTimeout","timeoutId","nonDebouncedPretextChanged","suggestions","newComponents","newPretext","handleReceivedSuggestions","handled","handleReceivedSuggestionsAndComplete","SEARCH_TIMEOUT_MILLISECONDS","debouncedPretextChanged","blur","handleFocusIn","handleFocusOut","listenForMentionKeyClick","addListener","handleMentionKeyClick","removeListener","contextId","listComponent","dateComponent","listStyle","SuggestionListComponent","SuggestionDateComponent","setContainerRef","containerClass","aria-live","autoComplete","onInput","handleChange","onCompositionStart","handleCompositionStart","onCompositionUpdate","handleCompositionUpdate","onCompositionEnd","handleCompositionEnd","handleKeyDown","preventSuggestionListClose","setSelection","onLoseVisibility","a","b","aLower","bLower","ArchiveIcon","removeUserFromTeamAndGetStats","response","getUser","addUserToTeamFromInvite","inviteId","RECEIVED_MY_TEAM_MEMBER","msg_count","mention_count","addUserToTeam","addUsersToTeam","switchTeam","currentChannelId","viewChannel","updateTeamsOrderForUser","teamIds","teamOrderPreferences","TEAMS_ORDER","join","SearchIcon","cx","cy","r","strokeLinecap","TOGGLE_LHS","OPEN_LHS","CLOSE_LHS","getNavigationBlocked","navigationBlock","showNavigationPrompt","TeamIcon","withHover","hoverCss","teamIconUrl","imageURLForTeam","backgroundImage","replace","MultiSelectList","selected","cmdOrCtrlPressed","max","onSelect","option","isSelected","onAdd","rowSelected","label","setSelected","handleArrowPress","_","prevState","listRef","selectedRef","elemTop","elemBottom","listTop","scrollIntoView","renderOutput","aria-hidden","optionRenderer","defaultOptionRenderer","optionControls","o","selectedOption","ariaLabelRenderer","aria-atomic","onPageChange","page","perPage","onAction","MultiSelect","a11yActive","handlePageChange","maxValues","handleAdd","reactSelectRef","select","handleInputChange","currentTarget","submitImmediatelyOn","change","handleInput","removedValue","splice","handleDelete","handleEnterPress","A11yCustomEventTypes","ACTIVATE","handleA11yActivateEvent","DEACTIVATE","handleA11yDeactivateEvent","totalCount","users","numRemainingText","buttonSubmitText","num","nextButton","previousButton","noteTextContainer","optionsToDisplay","noteText","valueMap","pageStart","pageEnd","nextPage","prevPage","memberCount","memberOptions","isMulti","nullComponent","IndicatorsContainer","MultiValueLabel","paddedComponent","valueRenderer","isClearable","openMenuOnFocus","menuIsOpen","onInputChange","onInputKeyDown","placeholderText","inputValue","getOptionValue","getOptionLabel","classNamePrefix","handleOnClick","buttonSubmitLoadingText","WrappedComponent","paddingLeft","paddingRight","verticalAlign","pluginEventHandlers","initialize","WebSocket","console","log","connUrl","WebsocketURL","URL","protocol","host","WebsocketSecurePort","WebsocketPort","getUrlVersion","setEventCallback","handleEvent","setFirstConnectCallback","handleFirstConnect","setReconnectCallback","reconnect","setMissedEventCallback","setCloseCallback","pluginReconnectHandlers","registerPluginReconnectHandler","handler","unregisterPluginReconnectHandler","includeWebSocket","GeneralTypes","WEBSOCKET_SUCCESS","loadPluginsIfNecessary","forEach","teams","mostRecentId","getMostRecentPostIdInChannel","mostRecentPost","getPost","getPosts","StatusActions","websocket","checkForModifiedUsers","resetWsErrorCount","clearErrors","intervalId","startPeriodicSync","clearInterval","setInterval","stopPeriodicSync","registerPluginWebSocketEvent","unregisterPluginWebSocketEvent","events","unregisterAllPluginWebSocketEvents","failCount","logError","WEBSOCKET_PORT_ERROR","WEBSOCKET_FAILURE","incrementWsErrorCount","msg","SocketEvents","POSTED","EPHEMERAL_MESSAGE","handleNewPostEventDebounced","POST_EDITED","JSON","parse","receivedPost","getProfilesAndStatusesForPosts","broadcast","isActive","handlePostEditEvent","POST_DELETED","postDeleted","handlePostDeleteEvent","POST_UNREAD","POST_UNREAD_SUCCESS","lastViewedAt","msgCount","mentionCount","handlePostUnreadEvent","UserTypes","RECEIVED_PROFILE_NOT_IN_TEAM","REMOVE_MEMBER_FROM_TEAM","channelsPerTeam","getChannelsInTeam","channels","REMOVE_MEMBER_FROM_CHANNEL","currentUser","global","pathname","startsWith","isGuest","removeNotVisibleUsers","members","getChannelMembersInChannels","isMember","PROFILE_NO_LONGER_VISIBLE","handleLeaveTeamEvent","UPDATE_TEAM","UPDATED_TEAM","handleUpdateTeamEvent","DELETE_TEAM","deletedTeam","teamMembers","teamMember","m","newTeamId","memberTeamId","RECEIVED_TEAM_DELETED","SELECT_TEAM","globalState","redirectChannel","handleDeleteTeamEvent","ADDED_TO_TEAM","handleTeamAddedEvent","USER_ADDED","RECEIVED_PROFILE_IN_CHANNEL","getChannelAndMyMember","handleUserAddedEvent","USER_REMOVED","rhsChannelId","getSelectedChannelId","LEAVE_CHANNEL","remover_id","loadUser","REMOVED_FROM_CHANNEL","RemovedFromChannelModal","removerId","RECEIVED_PROFILE_NOT_IN_CHANNEL","VIEW_MEMBERS","handleUserRemovedEvent","USER_UPDATED","getMembersInCurrentChannel","getChannelMember","getMe","RECEIVED_PROFILE","handleUserUpdatedEvent","ROLE_ADDED","RoleTypes","RECEIVED_ROLE","handleRoleAddedEvent","ROLE_REMOVED","ROLE_DELETED","handleRoleRemovedEvent","CHANNEL_SCHEME_UPDATED","handleChannelSchemeUpdatedEvent","MEMBERROLE_UPDATED","memberData","newRoles","roles","loadRolesIfNeeded","handleUpdateMemberRoleEvent","ROLE_UPDATED","handleRoleUpdatedEvent","CHANNEL_CREATED","handleChannelCreatedEvent","CHANNEL_DELETED","viewArchivedChannels","ExperimentalViewArchivedChannels","RECEIVED_CHANNEL_DELETED","deleteAt","handleChannelDeletedEvent","CHANNEL_UNARCHIVED","RECEIVED_CHANNEL_UNARCHIVED","handleChannelUnarchivedEvent","CHANNEL_CONVERTED","RECEIVED_CHANNEL","General","handleChannelConvertedEvent","CHANNEL_UPDATED","doGetState","handleChannelUpdatedEvent","CHANNEL_MEMBER_UPDATED","RECEIVED_MY_CHANNEL_MEMBER","handleChannelMemberUpdatedEvent","DIRECT_ADDED","handleDirectAddedEvent","PREFERENCE_CHANGED","preference","addedNewDmUser","handlePreferenceChangedEvent","PREFERENCES_CHANGED","preferences","findIndex","handlePreferencesChangedEvent","PREFERENCES_DELETED","DELETED_PREFERENCES","handlePreferencesDeletedEvent","TYPING","WebsocketEvents","STOP_TYPING","getMissingProfilesByIds","getStatusForUserId","ONLINE","getStatusesByIds","handleUserTypingEvent","STATUS_CHANGED","RECEIVED_STATUSES","handleStatusChangedEvent","HELLO","setServerVersion","server_version","handleHelloEvent","REACTION_ADDED","reaction","getCustomEmojiForReaction","emoji_name","RECEIVED_REACTION","handleReactionAddedEvent","REACTION_REMOVED","REACTION_DELETED","handleReactionRemovedEvent","EMOJI_ADDED","emoji","EmojiTypes","RECEIVED_CUSTOM_EMOJI","handleAddEmoji","CHANNEL_VIEWED","handleChannelViewedEvent","PLUGIN_ENABLED","manifest","loadPlugin","handlePluginEnabled","PLUGIN_DISABLED","removePlugin","handlePluginDisabled","USER_ROLE_UPDATED","profiles","demoted","PERMISSIONS_SYSTEM_ADMIN","handleUserRoleUpdated","CONFIG_CHANGED","CLIENT_CONFIG_RECEIVED","handleConfigChanged","LICENSE_CHANGED","CLIENT_LICENSE_RECEIVED","handleLicenseChanged","PLUGIN_STATUSES_CHANGED","AdminTypes","RECEIVED_PLUGIN_STATUSES","plugin_statuses","handlePluginStatusesChangedEvent","OPEN_DIALOG","dialog","IntegrationTypes","RECEIVED_DIALOG","currentTriggerId","integrations","dialogTriggerId","trigger_id","INTERACTIVE_DIALOG","InteractiveDialog","handleOpenDialogEvent","pluginEvents","wait","queue","count","triggered","myDispatch","myGetState","posts","receivedNewPost","getThreadsForPosts","handleNewPostEvents","fromAutoResponder","getIsManualStatusForUserId","UserStatuses","handleNewPostEvent","debouncePostEvent","QuickInput","onClear","delayInputUpdate","updateInputFromProps","clearableTooltipText","clearableTooltip","inputComponent","clearable","inputElement","createElement","setInput","defaultValue","elementType","Actions","Selectors","removeItem","setGlobalItem","getGlobalItem","removeGlobalItem","isLocalStorageSupported","logoutId","StoragePrefixes","sessionStorage","LOGOUT","isSignallingLogout","signalLogin","LOGIN","isSignallingLogin","hasCheckedLocalStorage","localStorageSupported","ErrorPageTypes","LOCAL_STORAGE","hasSeenLandingPage","LANDING_PAGE_SEEN","setLandingPageSeen","landingPageSeen","getLandingPreference","siteUrl","LANDING_PREFERENCE","setLandingPreferenceToMattermostApp","LandingPreferenceTypes","MATTERMOSTAPP","setLandingPreferenceToBrowser","BROWSER","clearLandingPreference","teamsOrder","teamsOrderList","sort","localeCompare","numeric","compareTeamsByDisplayName","MenuItem","SizeAwareImage","dimensions","mounted","image","isSmallImage","naturalWidth","naturalHeight","loaded","imageWidth","onImageLoaded","onImageLoadFail","showLoader","fileInfo","ariaLabelImage","localizeMessage","onEnterKeyDown","handleSmallImageContainer","handleError","onLoad","handleLoad","placeHolder","dimensionsAvailable","maxWidth","renderImageLoaderIfNeeded","xmlns","shouldShowImg","renderImageWithContainerIfNeeded","heightTimeout","renderImageOrPlaceholder","SuccessIcon","BackIcon","AddIcon","ModalToggleButton","clickHandler","propTypes","StatusAwayAvatarIcon","clipRule","strokeLinejoin","strokeMiterlimit","StatusAwayIcon","StatusDndAvatarIcon","x","y","rx","ry","enableBackground","StatusDndIcon","StatusOfflineIcon","StatusOnlineAvatarIcon","StatusOnlineIcon","StatusIcon","button","IconComponent","StatusOfflineAvatarIcon","ExternalImage","imageMetadata","format","enableSVGs","isSVGImage","getImageSrc","shouldRenderImage","EnableSVGs","loadMeAndConfig","promises","getClientConfig","getLicenseConfig","resolvedPromises","cookie","pluginTranslationSources","registerPluginTranslationsSource","sourceFunction","immutableTranslations","getTranslations","translations","RECEIVED_TRANSLATIONS","unregisterPluginTranslationsSource","loadTranslations","en","pluginFunc","serverTranslations","Badge","module","exports","MenuIcon","version","AudioVideoPreview","video","refs","canPlayType","mime_type","canPlay","pause","currentTime","handleFileInfoChanged","source","one","handleLoadError","fileUrl","WEB_VIDEO_WIDTH","WEB_VIDEO_HEIGHT","MOBILE_VIDEO_WIDTH","MOBILE_VIDEO_HEIGHT","data-setup","controls","CodePreview","usedLanguage","SyntaxHighlighting","extension","CODE_PREVIEW_MAX_FILE_SIZE","code","lang","ajax","dataType","handleReceivedError","handleReceivedCode","nodeName","XMLSerializer","serializeToString","updateStateFromProps","UNSAFE_componentWillReceiveProps","lines","match","strlines","language","highlighted","ImagePreview","isExternalFile","previewUrl","getFileDownloadUrl","has_preview_image","getFilePreviewUrl","download","PopoverBar","publicLink","enablePublicLink","showPublicLink","data-title","onGetPublicLink","downloadLinks","downloadLinkText","downloadLinkProps","fileURL","fileIndex","total","totalFiles","PDFPreview","lazy","ViewImageModal","imageIndex","fileInfos","showImage","RIGHT","handleNext","LEFT","handlePrev","handleKeyPress","startIndex","stop","imageHeight","innerHeight","loadImage","index","FileTypes","IMAGE","has_image_preview","getFileUrl","handleImageLoaded","completedPercentage","handleImageProgress","progress","onModalDismissed","GlobalActions","showCloseBtn","onModalShown","onModalHidden","fileName","fileDownloadUrl","fileType","SVG","VIDEO","AUDIO","PDF","Suspense","fallback","supports","floor","preview","pluginFilePreviewComponents","override","leftArrow","rightArrow","closeButtonClass","onMouseEnterImage","onMouseLeaveImage","handleGetPublicLink","EnablePublicLink","FilePreview","ViewImage","ModalToggleButtonRedux","dialogName","data-toggle","FileInfoPreview","infoParts","toUpperCase","infoString","AddGroupsToChannelModal","addError","groupIDs","v","skipCommit","onAddCallback","handleHide","linkGroupSyncable","groupID","Groups","SYNCABLE_TYPE_CHANNEL","auto_add","handleResponse","loadingState","loadingGroups","setGroupsLoadingState","getGroupsNotAssociatedToChannel","searchTerm","GROUPS_PER_PAGE","searchTimeoutId","search","getAllGroupsAssociatedToChannel","renderOption","groupsAvatar","renderValue","groupsToShow","groups","excludeGroups","hasGroup","og","g","includeGroups","group","handleExit","currentChannelName","addValue","modalSearch","selectGroupsNotAssociatedToChannel","regex","RegExp","AddGroupsToTeamModal","SYNCABLE_TYPE_TEAM","getGroupsNotAssociatedToTeam","getAllGroupsAssociatedToTeam","teamName","currentTeamName","selectGroupsNotAssociatedToTeam","UserSettings","SettingsSidebar","holders","defineMessages","security","notifications","sidebar","advanced","checkEmail","confirmTitle","confirmMsg","confirmBtns","UserSettingsModal","resendStatus","sendVerificationEmail","A","requireConfirm","showConfirmModal","active_tab","active_section","modalBodyRef","closest","removeClass","customConfirmAction","afterConfirm","collapseModal","handleCollapse","tab","skipConfirm","updateTab","tabs","uiName","iconTitle","handleHidden","activeTab","activeSection","setEnforceFocus","setRequireConfirm","handleCancelConfirmation","isRequred","closeUnusedDirectMessages","CloseUnusedDirectMessages","experimentalChannelOrganization","ExperimentalChannelOrganization","sendEmailNotifications","requireEmailVerification","RequireEmailVerification","localStorageStore","getPenultimateViewedChannelName","getPenultimateChannelName","getLastViewedChannelNameByTeamName","getTeamByName","UserSuggestion","description","handleClick","handleMouseMove","baseProps","getUsersRoute","last_picture_update","is_bot","UserProvider","searchUsersFunc","resultsCallback","normalizedPretext","Setting","inputId","labelClassName","inputClassName","footer","helpText","htmlFor","PayloadSources","Flux","handleServerAction","warn","payload","SERVER_ACTION","VIEW_ACTION","DISMISS_NOTICE","MattermostLogo","background","st0","getMembershipForCurrentEntities","selectedPost","getSelectedPost","exists","getTeamMember","SearchChannelWithPermissionsSuggestion","channelIsArchived","channelSearchSorter","wrappedA","wrappedB","aIsArchived","bIsArchived","getCurrentUserLocale","aDisplayName","bDisplayName","aStartsWith","bStartsWith","sortChannelsByTypeAndDisplayName","SearchChannelWithPermissionsProvider","channelSearchFunc","makeChannelSearchFilter","channelPrefix","channelPrefixLower","searchString","haveIChannelPermission","MANAGE_PUBLIC_CHANNEL_MEMBERS","MANAGE_PRIVATE_CHANNEL_MEMBERS","getChannelsInCurrentTeam","formatChannelsAndDispatch","fetchChannels","channelsAsync","channelsFromServer","concat","allChannels","completedChannels","channelFilter","newChannel","wrappedChannel","deactivated","AddUserToChannelModal","suggestionProviders","channelSearchBox","placeCaretAtEnd","selectedChannelId","focusTextbox","submitError","checkingForMembership","isUserMemberOfChannel","addChannelMember","handleSubmitError","memberships","channelMembers","enableChannelProvider","targetUserIsMemberOfSelectedChannel","errorMsg","getFullName","help","setSearchBoxRef","didSelectChannel","maxLength","shouldDisableAddButton","onSubmit","ProfilePopover","loadingDMChannel","USER_SETTINGS","popoverProps","hideStatus","enableTimezone","isTeamAdmin","isChannelAdmin","canManageAnyChannelMembersInCurrentTeam","dataContent","fullname","bot_description","MAX_POSITION_LENGTH","timezone","userTimezone","handleEditAccountSettings","handleShowDirectChannel","isInCurrentTeam","addToChannelMessage","ADD_USER_TO_CHANNEL","roleTitle","OFFLINE","scheme_admin","areTimezonesEnabledAndSupported","LatexBlock","katex","enableLatex","katexOptions","throwOnError","displayMode","maxSize","maxExpand","html","renderToString","EnableLatex","MarkdownImage","imageIsLink","showModal","loadFailed","HEADER_CHANGE","prevSrc","onUpdated","isHeaderChangeMessage","brokenImageIcon","safeSrc","lastIndexOf","getFileExtensionFromUrl","loadingClass","handleLoadFail","hideModal","PostEmoji","emojiText","imageUrl","getEmojiImageUrl","parser","Parser","processNodeDefinitions","ProcessNodeDefinitions","processingInstructions","replaceChildren","shouldProcessNode","attribs","processNode","hrefAttrib","mentions","mentionAttrib","mentionName","disableHighlight","emojiAttrib","emojiName","images","class","parentNode","latex","processDefaultNode","parseWithInstructions","adminOnly","mattermostIcon","allowForget","InstallationDate","getTime","IssuedAt","Cluster","ServerVersion","SystemNotice","notices","dismissedNotices","isSystemAdmin","remind","getCurrentNotice","CATEGORY_SYSTEM_NOTICE","visibleMessage","hideAndRemind","hideAndForget","getCategory","makeGetCategory","getPreferenceNameMap","nameMap","Notices","WebClient","conn","connectionUrl","sequence","eventSequence","connectFailCount","eventCallback","responseCallbacks","firstConnectCallback","reconnectCallback","missedEventCallback","errorCallback","closeCallback","onopen","sendMessage","onclose","retryTime","onerror","evt","onmessage","seq_reply","seq","setErrorCallback","readyState","OPEN","responseCallback","send","stringify","CLOSED","userUpdateActiveStatus","userIsActive","manual","user_is_active","getStatuses","user_ids","supportsHourCycle","Intl","DateTimeFormat","hour","resolvedOptions","hourCycle","LocalDateTime","eventTime","useMilitaryTime","momentDate","moment","titleString","tz","minute","formattedTime","hour12","dateTime","toISOString","getUserTimezone","CATEGORY_DISPLAY_SETTINGS","USE_MILITARY_TIME","getUserCurrentTimezone","lastGetPosts","getToastStatus","toastStatus","MenuActionSuggestion","MenuActionProvider","displayAllOptions","filterOptions","filteredOptions","ChannelSuggestion","purpose","ChannelProvider","TextSetting","resizable","resize","rows","AutocompleteSelector","onSelected","suggestionRef","toggleFocus","labelContent","helpTextContent","setSuggestionRef","handleSelected","popOverOverlayPosition","targetBounds","spaceRequiredAbove","spaceRequiredBelow","LoadingImagePreview","progressView","PAGE_NOT_FOUND","mfaPaths","mfaAuthServices","checkIfMFARequired","MFA","EnableMultifactorAuthentication","EnforceMultifactorAuthentication","GuestAccountsEnforceMultifactorAuthentication","mfa_active","auth_service","announcementBar","announcementBarState","isServerVersionGreaterThanOrEqualTo","currentVersion","compareVersion","currentVersionNumber","exec","compareVersionNumber","AutosizeTextarea","reference","textarea","getComputedStyle","borderWidth","borderTopWidth","borderBottomWidth","onHeightChange","heightProps","textareaPlaceholder","placeholderAriaLabel","overflow","textOverflow","pointerEvents","whiteSpace","EditIcon","SettingPicture","removeSrc","setDefaultSrc","confirmButton","onRemove","onSetDefault","focusFirstElement","onFileChange","selectInput","click","previewBlob","createObjectURL","reader","FileReader","onload","FileUtils","orientationStyles","readAsArrayBuffer","imageContext","imageStyles","defaultImageSrc","imageElement","handleRemoveSrc","handleSetDefaultSrc","handleFileSelected","setPicture","revokeObjectURL","img","renderImg","imgRender","disableSaveButtonFocus","submitActive","fileSizeToString","maxFileSize","aria-describedby","accept","handleFileChange","loadingPicture","handleInputFile","handleSave","ModalSuggestionList","scroll","latestHeight","listElement","suggestionList","inputBounds","calculateInputRect","newInputBounds","getChildHeight","newLocation","modalBounds","getClosestParent","onModalScroll","updateModalBounds","updateInputBounds","updateLocation","modalBodyRect","zIndex","BoolSetting","RadioSetting","DialogElement","dataSource","defaultText","GenericUserProvider","GenericChannelProvider","defaultOption","subtype","errorText","optional","displayNameContent","validTypes","DialogIntroductionText","formattedMessage","gfm","elem","checkDialogElementForError","callbackId","callback_id","submission","submitting","submitInteractiveDialog","hasErrors","checkIfErrorsMatchElements","submitted","notifyOnCancel","cancelled","default","introductionText","iconUrl","submitLabel","submitText","backdrop","borderBottom","help_text","minLength","min_length","max_length","data_source","introduction_text","icon_url","submit_label","notify_on_cancel","UserListRow","buttons","Action","actionProps","actionUserProps","emailStyle","userCountID","userCountEmail","userCount","getProfilePictureUrl","UserList","RowComponentType","rowComponentType","TEST_ID_COUNT","SearchableUserList","nextDisabled","nextTimeoutId","channelListScroll","previousPage","focusOnMount","onTermChange","isSearch","startCount","endCount","usersPerPage","renderCount","focusSearchBar","userList","scrollToTop","usersToDisplay","filterRow","renderFilterRow","searchUsersPlaceholder","showTeamToggle","ModalController","modalOutput","modal","modalComponent","AtMention","overlayRef","getUserFromMentionName","usersByUsername","Overlay","hideOverlay","displayUsername","teammateNameDisplay","getTeammateNameDisplaySetting","getUsersByUsername","dispatchPluginComponentAction","generateId","RECEIVED_PLUGIN_COMPONENT","resolveReactElement","PluginRegistry","registerRootComponent","registerPopoverUserAttributesComponent","registerPopoverUserActionsComponent","registerLeftSidebarHeaderComponent","registerBottomTeamSidebarComponent","registerPostMessageAttachmentComponent","registerLinkTooltipComponent","registerChannelHeaderButtonAction","dropdownText","tooltipText","registerPostTypeComponent","RECEIVED_PLUGIN_POST_COMPONENT","registerPostCardTypeComponent","RECEIVED_PLUGIN_POST_CARD_COMPONENT","registerPostWillRenderEmbedComponent","toggleable","registerMainMenuAction","mobileIcon","registerChannelHeaderMenuAction","registerPostDropdownMenuAction","registerPostDropdownSubMenuAction","rootRegisterMenuItem","registerMenuItem","parentMenuId","innerText","innerAction","innerFilter","f","registerPostDropdownMenuComponent","registerFileUploadMethod","registerFilesWillUploadHook","hook","unregisterComponent","componentId","REMOVED_PLUGIN_COMPONENT","unregisterPostTypeComponent","REMOVED_PLUGIN_POST_COMPONENT","registerReducer","reducerRegistry","register","registerWebSocketEventHandler","unregisterWebSocketEventHandler","registerReconnectHandler","unregisterReconnectHandler","registerMessageWillBePostedHook","registerSlashCommandWillBePostedHook","registerMessageWillFormatHook","registerFilePreviewComponent","registerTranslations","getTranslationsForLocale","registerRightHandSidebarComponent","showRHSPlugin","hideRHSPlugin","toggleRHSPlugin","initializePlugins","PluginsEnabled","getPlugins","loadErr","getWebappPlugins","RECEIVED_WEBAPP_PLUGINS","regeneratorRuntime","registerPlugin","plugin","loadedPlugins","resolve","reject","oldManifest","webapp","bundle_path","REMOVED_WEBAPP_PLUGIN","bundlePath","script","registry","initializePlugin","getElementsByTagName","appendChild","uninitialize","deinitialize","removeChild","oldManifests","newManifests","newManifest","AboutBuildModal","licensee","subTitle","learnMore","BuildEnterpriseReady","Company","termsOfService","AboutLinks","TERMS_OF_SERVICE","privacyPolicy","PRIVACY_POLICY","tosPrivacyHyphen","TermsOfServiceLink","PrivacyPolicyLink","buildnumber","BuildNumber","isNaN","mmversion","doHide","appTitle","SiteName","Version","SQLDriverName","currentYear","getFullYear","BuildHash","BuildHashEnterprise","webappBuildHash","COMMIT_HASH","BuildDate","ABOUT","LazyErrorPage","LazyLoginController","LazyAdminConsole","LazyLoggedIn","LazyPasswordResetSendLink","LazyPasswordResetForm","LazySignupController","LazySignupEmail","LazyTermsOfService","LazyShouldVerifyEmail","LazyDoVerifyEmail","LazyClaimController","LazyHelpController","LazyLinkingLandingPage","LazySelectTeam","LazyAuthorize","LazyCreateTeam","LazyMfa","CreateTeam","makeAsyncComponent","ErrorPage","TermsOfService","LoginController","AdminConsole","LoggedIn","PasswordResetSendLink","PasswordResetForm","SignupController","SignupEmail","ShouldVerifyEmail","DoVerifyEmail","ClaimController","HelpController","LinkingLandingPage","SelectTeam","Authorize","Mfa","LoggedInRoute","rest","Root","isDevMode","enableDevModeFeatures","segmentKey","DIAGNOSTICS_SEGMENT_KEY","diagnosticId","diagnosticsEnabled","invoked","methods","factory","args","prototype","call","unshift","load","n","insertBefore","SNIPPET_VERSION","identify","context","ip","referrer","anonymousId","noAccounts","history","configLoaded","loadRecentlyUsedCustomEmojis","iosDownloadLink","IosAppDownloadLink","androidDownloadLink","AndroidAppDownloadLink","toResetPasswordScreen","mobileLanding","currentCategoryFocus","currentSidebarFocus","setUrl","setSystemEmojis","EmojiIndicesByAlias","originalEvent","storageArea","FastClick","attach","a11yController","A11yController","showTermsOfService","onConfigLoaded","trackLoadTime","unbind","PermalinkRedirector","NeedsTeam","INCREMENT_WS_ERROR_COUNT","RESET_WS_ERROR_COUNT","tooltipContainerStyles","flexDirection","alignItems","LinkTooltip","hideTimeout","$tooltipContainer","tooltipContainerRef","tooltipContainer","showTimeout","on","hideTooltip","popper","Popper","modifiers","preventOverflow","enabled","OVERLAY_TIME_DELAY_SMALL","createPortal","showTooltip","HeaderFooterTemplate","HFTRoute","LoggedInHFTRoute","listenerOptions","capture","modifierKeys","ctrlKey","altKey","lastInputEventIsKeyboard","isMac","tabKeyIsPressed","TILDE","regions","tildeKeyIsPressed","previousRegion","nextRegion","F6","isDesktopApp","f6KeyIsPressed","navigationInProgress","sections","upArrowKeyIsPressed","shouldReverseSections","nextSection","previousSection","downArrowKeyIsPressed","enterKeyIsPressed","SPACE","L","lKeyIsPressed","resetInterractionStates","mouseIsPressed","windowIsFocused","nextElement","updateActiveRegion","focusedElement","activeRegion","udpateCurrentFocus","updateActiveElement","regionHTMLCollection","getAllRegions","sectionHTMLCollection","modalHTMLCollection","getAllModals","popupHTMLCollection","getAllPopups","resetNavigation","KEY_DOWN","KEY_UP","handleKeyUp","CLICK","handleMouseClick","MOUSE_DOWN","handleMouseDown","MOUSE_UP","handleMouseUp","FOCUS","handleFocus","BLUR","handleWindowBlur","destroy","clearActiveRegion","clearCurrentFocus","isElementValid","modalIsOpen","popupIsOpen","domElements","sortElementsByAttributeOrder","elementIsVisible","getOrderReverseAttribute","newRegion","activeRegionIndex","setActiveRegion","setCurrentFocus","shouldLoopNavigation","getLoopNavigationAttribute","activeSectionIndex","newSection","setActiveSection","elementPath","region","pathElement","A11yClassNames","REGION","SECTION","setActiveElement","canFocusChild","UPDATE","handleActiveRegionUpdate","dispatchEvent","Event","getAllSectionsForRegion","getFocusChildAttribute","clearActiveSection","handleActiveSectionUpdate","clearActiveElement","handleActiveElementUpdate","ACTIVE","getAttribute","setAttribute","forceUpdate","a11yKeyIsPressed","FOCUSED","blurActiveElement","getElementsByClassName","elementA","elementB","elementAOrder","A11yAttributeNames","SORT_ORDER","elementBOrder","offsetParent","MODAL","POPUP","attributeValue","LOOP_NAVIGATION","ORDER_REVERSE","FOCUS_CHILD","invalidElements","editPost","selectAttachmentMenuAction","actionId","SELECT_ATTACHMENT_MENU_ACTION","DeletePostModal","permalinkPostId","deleteAndRemovePost","matchUrlForDMGM","matchPath","matchUrlForChannel","postid","channelUrl","deletePostBtn","commentWarning","commentCount","postTerm","onEntered","handleEntered","withRouter","OPEN_EMBED_PAGE","SHARE","TRENDING","REACTIONS","mattermost","GifSearchIcon","GifSearchClearIcon","mapDispatchToProps","saveSearchBarText","saveSearchScrollPosition","searchTextUpdate","getStyle","makeStyleFromTheme","centerChannelBg","changeOpacity","centerChannelColor","inputBackground","borderColor","SearchBar","searchText","searchInput","triggerSearch","onSearch","parseSearchText","searchTimeout","onCategories","isFilteredTags","inputFocused","removeExtraSpaces","tagsList","substr","filteredTags","tag","onTrending","updateSearchInputValue","searchBarText","clearSearchButton","clearSearchHandle","method","noValidate","autoCapitalize","focusInput","blurInput","gifs","categories","appProps","app","GifTrendingIcon","GifReactionsIcon","header","borderBottomColor","iconActive","iconHover","hovering","renderTabs","constants","renderTab","Icon","cursor","paddingTop","saveAppProps","App","appClassName","authenticateSdk","InfiniteScroll","el","scrollComponent","scrollEl","useWindow","pageYOffset","documentElement","isReverse","calculateTopPosition","offsetHeight","Number","threshold","detachScrollListener","loadMore","pageLoaded","attachScrollListener","setScrollPosition","hasMore","initialLoad","loader","scrollPosition","containerHeight","elementProps","defaultLoader","scrollTo","scrollListener","setDefaultLoader","requestCategoriesList","requestCategoriesListIfNeeded","Categories","gfycats","gfyId","sendImpressions","filterTagsList","gfyItem","max1mbGif","avgColor","PostUtils","cache","SearchItem","itemWidth","itemClickHandler","paddingBottom","SearchGrid","matchMedia","matches","numberOfColumns","keyword","handleItemClick","gfyid","columnsHeights","containerWidth","offsetWidth","setNumberOfColumns","scrollY","padding","resizeHandler","scrollHandler","containerClassName","resultsByTerm","moreRemaining","isEmpty","columnWidth","leftPosition","searchItems","colIndex","minHeightColumnIndex","itemHeight","maxColumnHeight","emptySearch","searchGfycat","searchIfNeededInitial","Search","searchCategory","Trending","appName","basePath","itemTapType","shareEvent","appId","enableHistory","displayText","GifPicker","gif","onGifClick","max5mbGif","PureRenderMixin","handleTrending","handleSearch","handleCategories","EmojiIcon","GfycatIcon","EmojiPickerHeader","handleEmojiPickerClose","defaultRule","aName","bName","emojiA","emojiB","thumbsDownRule","otherName","thumbsUpRule","customRules","thumbsdown","thumbsup","getEmojiName","searchedName","aliases","alias","compareEmojis","aPrefix","EmojiPickerCategory","onCategoryClick","enable","EmojiPickerItem","emojiItem","onItemOver","categoryIndex","emojiIndex","debounce","handleMouseOver","leading","trailing","onItemClick","topOfTheEmojiItem","bottomOfTheEmojiItem","containerRef","containerTop","containerBottom","itemClassName","spriteClassName","batch","handleMouseOverThrottle","imgTrans","emojiItemRef","EmojiPickerCategorySection","div","updateOffsetFrame","updateCategoryOffset","categoryName","cancelAnimationFrame","divRef","EmojiPickerPreview","previewImage","recentEmojiCategory","recent","peopleEmojiCategory","people","CATEGORIES","nature","foods","activity","places","objects","symbols","flags","custom","getEmojiFilename","EmojiPicker","allEmojis","customEmojiMap","customEmojis","categoryEmojis","recentEmojis","has","Emoji","emojiIds","currentEmoji","visible","updatedState","categoryKeys","getEmojis","renderAllCategories","customEmojisEnabled","loadingMoreEmojis","getCustomEmojis","customEmojiPage","missingPages","incrementEmojiPickerPage","lastVisibleEmoji","emojiPickerContainer","updateEmojisToShow","searchCustomEmojis","onEmojiClick","selectNextEmoji","selectPrevEmoji","getCurrentEmojiByCursor","emojis","currentEmojiLoadedCount","emojisToShow","numEmojisLoaded","lastVisibleEmojiRef","handleItemOver","onItemUnmount","divTopOffset","divHeight","handleScrollThrottle","throttle","handleScroll","loadMoreCustomEmojis","renderAllCategoriesFrame","rootComponent","difference","numToLoad","ceil","newCursor","newCategory","getCategoryByIndex","lastVisibleEmojiInNewCategory","getCategoriesByKey","getEmojisByCategory","sortEmojis","recentEmojisProps","emojisMinusRecent","emojiArray","sortEmojisHelper","emojiId","getCurrentEmojiName","getCurrentEmojiCategoryName","currentCategoryName","emojiCategories","emojiPickerCategories","handleCategoryClick","handleCategoryKeyDown","emojiSearch","emojiSearchInput","handleFilterChange","autocomplete","emojiCurrentResults","categoryComponents","emojiCurrentResultsItems","emojiPickerContainerRef","onScroll","overflowY","listHeight","onEmojiClose","EnableCustomEmoji","emojiPickerCustomPage","getRecentEmojis","EmojiPickerTabs","emojiTabVisible","pickerStyle","rightOffset","topOffset","pickerClass","enableGifPicker","Tabs","defaultActiveKey","justified","Tab","eventKey","onEnter","handleEnterEmojiTab","onExit","handleExitEmojiTab","oneOf","EmojiPickerOverlay","emojiTrigger","DEFAULT_EMOJI_PICKER_RIGHT_OFFSET","innerWidth","DEFAULT_EMOJI_PICKER_LEFT_OFFSET","getPlacement","emojiPickerPosition","animation","CENTER_SPACE_REQUIRED_ABOVE","CENTER_SPACE_REQUIRED_BELOW","canManageMembers","findNextUnreadChannelId","curChannelId","allChannelIds","unreadChannelIds","direction","curIndex","isArchivedChannel","typeMessage","POST_TYPES","ADD_TO_CHANNEL","JOIN_CHANNEL","REMOVE_FROM_CHANNEL","ADD_TO_TEAM","JOIN_TEAM","REMOVE_FROM_TEAM","LastUsers","expand","formatOptions","actor","expandedLocale","usernames","firstUser","lastIndex","lastUser","renderMessage","firstUserMessage","otherUsersMessage","numOthers","actorMessage","postTypeMessage","one_you","two","many_expanded","CombinedSystemMessage","allUserIds","allUsernames","getMissingProfilesByUsernames","currentUsername","userProfiles","reduce","acc","currentUserDisplayName","getAllUsernames","someone","loadUserProfiles","renderFormattedMessage","actorId","getUsernamesByIds","secondUser","localeHolder","messageData","removedUserIds","showJoinLeave","uniqueRemovedUserIds","arr","getProfilesByIdsAndUsernames","makeGetProfilesByIdsAndUsernames","ADVANCED_FILTER_JOIN_LEAVE","PostAddChannelMember","createAt","removePost","generateAtMentions","andSeparator","commaSeparator","idx","channelType","noGroupsUsernames","linkId","linkText","outOfChannelMessageID","outOfChannelMessageText","outOfChannelAtMentions","outOfGroupsMessageID","outOfGroupsMessageText","outOfGroupsAtMentions","outOfChannelMessage","outOfGroupsMessage","handleAddChannelMember","renderUsername","renderFormattedText","markdown","renderAddToChannelMessage","systemMessageRenderers","GUEST_JOIN_CHANNEL","ADD_GUEST_TO_CHANNEL","removedUsername","headerOptions","channel_mentions","oldHeader","old_header","newHeader","new_header","old","new","DISPLAYNAME_CHANGE","old_displayname","new_displayname","oldDisplayName","newDisplayName","CONVERT_CHANNEL","PURPOSE_CHANGE","oldPurpose","old_purpose","newPurpose","new_purpose","ME","PostMarkdown","renderedSystemMessage","isUserCanManageMembers","add_channel_member","isEphemeral","addMemberProps","post_id","not_in_channel_user_ids","not_in_groups_usernames","not_in_channel_usernames","COMBINED_USER_ACTIVITY","user_activity","renderSystemMessage","message_source","pluginHooks","mentionHighlightDisabled","metadata","MessageWillFormat","AtMentionSuggestion","youElement","isCurrentUser","AtMentionProvider","setProps","profilesInChannel","profilesNotInChannel","useChannelMentions","specialMentions","MENTION_SPECIAL","getProfileSuggestions","profile","profileSuggestions","usernameSuggestions","getSuggestionsSplitByMultiple","AUTOCOMPLETE_SPLIT_CHARACTERS","property","getSuggestionsSplitBy","filterProfile","prefixLower","suggestion","localMembers","createFromProfile","MENTION_MEMBERS","remoteMembers","remoteNonMembers","out_of_channel","MENTION_NONMEMBERS","localUserIds","orderUsers","localAndRemoteMembers","updateMatches","resultCallback","captured","XRegExp","showLoadingIndicator","MENTION_MORE_MEMBERS","ChannelMentionSuggestion","ChannelMentionProvider","lastPrefixTrimmed","lastPrefixWithNoResults","lastCompletedWord","words","wrappedChannelIds","wrappedChannels","nameWords","matched","j","wordMatched","MENTION_CHANNELS","MENTION_MORE_CHANNELS","handleChannels","withError","wrappedMoreChannels","wrapped","CommandSuggestion","hint","CommandProvider","command","getCommandsList","cmd","auto_complete","auto_complete_hint","auto_complete_desc","EMOJI_CATEGORY_SUGGESTION_BLACKLIST","EmoticonSuggestion","EmoticonProvider","partialName","emoticon","Emoticons","autocompleteCustomEmojis","findAndSuggestEmojis","formatEmojis","recentMatched","hasSystemEmoji","Textbox","handlePostError","characterLimit","errorMessage","limit","onMouseUp","onKeyUp","checkMessageLength","supportsCommands","wrapper","updateSuggestions","textboxClassName","textWrapperClass","emojiEnabled","badConnection","getInputBox","onKeyPress","handleBlur","spellCheck","createMessage","handleHeightChange","suggestionListStyle","getProfilesInChannel","makeGetProfilesInChannel","getProfilesNotInChannel","makeGetProfilesNotInChannel","withRef","TextboxLinks","updatePreview","showPreview","isMarkdownPreviewEnabled","hasText","editHeader","helpTextClass","previewMessageLink","previewLink","togglePreview","PreReleaseFeatures","PRE_RELEASE_FEATURES","isFeatureEnabled","MARKDOWN_PREVIEW","EditPostModal","editModalBody","showEmojiPicker","editbox","emojiAlias","editText","firstPiece","lastPiece","splitMessageBasedOnCaretPosition","caretPosition","newMessage","newCaretPosition","editPostEmoji","postError","isSaveDisabled","editingPost","updatedPost","errorClass","ANIMATION_TIMEOUT","hasAttachment","file_ids","addMessageIntoHistory","deletePostModalData","DELETE_POST","ctrlSend","codeBlockOnCtrlEnter","allowSending","ignoreKeyPress","postMessageOnKeyPress","lastChannelSwitchAt","handleEdit","doRefocus","refocusId","hideEditPostModal","prevShowState","getWrappedInstance","canEditPost","canDeletePost","errorBoxClass","postErrorClass","emojiPicker","emojiButtonAriaLabel","EnableEmojiPicker","getContainer","getEditPostControls","hideEmojiPicker","handleEmojiClick","handleGifClick","EnableGifPicker","toggleEmojiPicker","handleCheckForChangesHide","handleExited","keyboard","handleEditKeyPress","handleMouseUpKeyUp","setEditboxRef","maxPostSize","setTextboxLinksRef","getEditingPost","EDIT_POST","DELETE_OTHERS_POSTS","EDIT_OTHERS_POSTS","USE_CHANNEL_MENTIONS","MaxPostSize","DEFAULT_CHARACTER_LIMIT","ModalStoreClass","TOGGLE_IMPORT_THEME_MODAL","TOGGLE_DELETE_POST_MODAL","TOGGLE_GET_TEAM_INVITE_LINK_MODAL","TOGGLE_QUICK_SWITCH_MODAL","TOGGLE_CHANNEL_PURPOSE_UPDATE_MODAL","dispatchToken","handleEventPayload","ModalStore","GetLinkModal","copiedLink","textAreaRef","setSelectionRange","execCommand","copyLink","queryCommandSupported","data-copy-btn","readOnly","copyLinkConfirm","GetPublicLinkModal","removeModalListener","handleToggle","addModalListener","getFilePublicLink","LeavePrivateChannelModal","ResetStatusModal","newStatus","currentUserStatus","setStatus","pref","CATEGORY_AUTO_RESET_MANUAL_STATUS","OUT_OF_OFFICE","toTitleCase","autoResetStatus","statusIsManual","autoResetPrefNotSet","autoResetPref","userStatus","userStatusId","manualStatusTitle","manualStatusMessage","renderModalMessage","manualStatusButton","manualStatusId","manualStatusCancel","manualStatusCheckbox","allShortcuts","mainHeader","mac","navHeader","navPrev","navNext","navUnreadPrev","navUnreadNext","teamNavPrev","teamNavNext","teamNavSwitcher","navSwitcher","navDMMenu","navSettings","navMentions","navFocusCenter","navOpenCloseSidebar","msgHeader","msgInputHeader","msgEdit","msgReply","msgReprintPrev","msgReprintNext","msgCompHeader","msgCompUsername","msgCompChannel","msgCompEmoji","msgLastReaction","filesHeader","filesUpload","browserHeader","browserChannelPrev","browserChannelNext","browserFontIncrease","browserFontDecrease","browserInputHeader","browserHighlightPrev","browserHighlightNext","browserNewline","info","ShortcutsModal","getShortcuts","shortcuts","renderShortcut","shortcut","FileUploadOverlay","overlayClass","overlayType","fileOverlayImage","overlayLogoImage","DelayedAction","timer","fire","fireAfter","cancel","connectionErrorCount","system","websocketConnectionErrorCount","executeCommand","cmdLength","getUserIdFromChannelName","CATEGORY_GROUP_CHANNEL_SHOW","hasGotoLocation","goto_location","isUrlSafe","RECEIVED_DIALOG_TRIGGER_ID","runMessageWillBePostedHooks","originalPost","hooks","MessageWillBePosted","runSlashCommandWillBePostedHooks","originalMessage","originalArgs","SlashCommandWillBePosted","clearCommentDraftUploads","actionOnGlobalItemsWithPrefix","COMMENT_DRAFT","uploadsInProgress","updateCommentDraft","rootId","draft","makeOnMoveHistoryIndex","getMessageInHistory","makeGetMessageInHistoryItem","MESSAGE_TYPES","COMMENT","getPostDraft","moveHistoryIndexBack","moveHistoryIndexForward","nextMessageInHistory","submitPost","pending_post_id","hookResult","makeOnSubmit","latestPostId","isReaction","getCustomEmojisByName","EmojiMap","removeReaction","ignoreSlash","submitCommand","makeOnEditLatestPost","getCurrentUsersLatestPost","getPostIdsInChannel","postIds","getPostById","lastPost","from_webhook","SYSTEM_MESSAGE_PREFIX","isPostPendingOrFailed","makeGetCurrentUsersLatestPost","getCommentCount","makeGetCommentCountForPost","getTable","clipboardData","types","getData","table","querySelector","parseTable","getPlainText","isGitHubCodeBlock","tableClassName","columnText","column","textContent","formatMarkdownTableMessage","headerRow","shift","headers","row","spacers","formattedTable","AttachmentIcon","FilenameOverlay","canDownload","compactDisplay","handleImageClick","iconClass","filenameOverlay","RemoveIcon","FileProgressPreview","handleRemove","fileNameComponent","progressBar","percent","percentTxt","toFixed","ProgressBar","active","data-client-id","previews","imageClassName","THUMBNAIL_WIDTH","THUMBNAIL_HEIGHT","thumbnailUrl","getFileThumbnailUrl","backgroundSize","uploadsProgressPercent","uploadFile","UPLOAD_FILES_REQUEST","request","getFilesRoute","getOptions","field","handleFileUploadEnd","res","forceLogoutIfNecessary","failure","UPLOAD_FILES_FAILURE","clientIds","getLogErrorAction","file_infos","client_ids","RECEIVED_UPLOAD_FILES","UPLOAD_FILES_SUCCESS","limited","filesAbove","fileAbove","zeroBytesFiles","zeroBytesFile","pasted","FileUpload","currentRootId","onFileUpload","onUploadError","files","uploadFiles","sortedFiles","willUploadHooks","pluginFilesWillUploadHooks","h","pluginUploadFiles","uploadsRemaining","MAX_UPLOAD_FILES","fileCount","numUploads","tooLargeFiles","zeroFiles","progressEvent","onUploadProgress","end","fileUploadFail","fileUploadSuccess","onUploadStart","tooLargeFilenames","filenames","zeroFilenames","checkPluginHooksAndUploadFiles","clearFileInput","onFileUploadChange","dataTransfer","droppedFiles","webkitGetAsEntry","isDirectory","isUriDrop","containerSelector","overlaySelector","self","dragTimeout","dragsterActions","detail","isFileTransfer","leave","over","drop","handleDrop","unbindDragsterEvents","query","noop","defaults","first","second","dragenter","enterEvent","CustomEvent","dragleave","leaveEvent","dragover","overEvent","dropEvent","dragster","targetElement","eventTarget","getTarget","containsEventTarget","kind","getAsFile","getHours","getMinutes","ext","getMonth","getDate","newFile","Blob","U","postTextbox","commentTextbox","fileInput","abort","menuOpen","handleMaxUploadReached","registerDragEvents","pasteUpload","keyUpload","multiple","isMobileApp","isIosChrome","bodyAction","pluginFileUploadMethods","simulateInputClick","onTouchEnd","handleLocalFileUploaded","wrappedComponent","MaxFileSize","FileUploadMethod","FilesWillUploadHook","MsgTyping","numUsers","typingUsers","last","pop","getTypingText","getUsersTypingByChannelAndPost","makeGetUsersTypingByChannelAndPost","PostDeletedModal","MessageSubmitError","submittedMessage","errorContent","isErrorInvalidSlashCommand","renderSlashCommandError","CreateComment","createPostErrorId","messageInHistory","rootChanged","messageInHistoryChanged","showPostDeletedModal","rhsExpanded","shouldFocusMainTextbox","updatedDraft","onUpdateCommentDraft","hideNotifyAllModal","doSubmit","modifiedDraft","draftsForPost","channelMembersCount","enableConfirmNotificationsToChannel","isTimezoneEnabled","containsAtChannel","checkAllMentions","NOTIFY_ALL_MEMBERS","getChannelTimezones","channelTimezoneCount","showNotifyAllModal","shouldEnableAddButton","rootDeleted","forceFocus","lastBlurAt","withClosedCodeBlock","persist","emitTypingEvent","emitShortcutReactToLastPostFrom","Locations","RHS_ROOT","$el","parent","scrollToBottom","lastMessageReactionKeyCombo","metaKey","BACK_SLASH","commentMsgKeyPress","canEditNow","onEditLatestPost","onMoveHistoryIndexBack","onMoveHistoryIndexForward","reactToLastMessage","newFileInfos","sortFileInfos","updateCommentDraftWithRootId","handleUploadError","fileUpload","cancelUpload","handleFileUploadChange","createCommentControls","enableAddButton","keepFocus","resetCreatePostRequest","renderScrollbar","doInitialScrollToBottom","onResetHistoryIndex","pasteHandler","focusTextboxIfNecessary","selectedPostFocussedAt","readOnlyChannel","canPost","ariaLabelReplyInput","notifyAllTitle","notifyAllConfirm","notifyAllMessage","totalMembers","timezones","removePreview","uploadsInProgressText","addButtonClass","getFileCount","getFileUploadTarget","handleUploadStart","handleFileUploadComplete","handleUploadProgress","enableEmojiPicker","getCreateCommentControls","scrollbarClass","textboxRef","SUGGESTION_LIST_SPACE_RHS","data-a11y-sort-order","initialText","popoverMentionKeyClick","hidePostDeletedModal","handleNotifyAllConfirmation","getMessageInHistoryItem","createPost","getAllChannelStats","EnableConfirmNotificationsToChannel","ExperimentalTimezone","CREATE_POST","isCurrentUserSystemAdmin","ExperimentalTownSquareIsReadOnly","DEFAULT_CHANNEL","getIsRhsExpanded","getSelectedPostFocussedAt","resetHistoryIndex","makeOnUpdateCommentDraft","RecentDate","isSameDay","isToday","yesterday","setDate","isYesterday","weekday","month","day","year","formattedDate","BasicSeparator","DateSeparator","timezoneProps","instanceOf","FloatingTimestamp","isScrolling","isRhsPost","toastPresent","dateString","classes","scrolling","rhs","toastAdjustment","PostListUtils","combinedIds","ChannelPermissionGate","DotMenu","canEdit","isFlagged","unflagPost","flagPost","handleAddReactionClick","postUrl","currentTeamUrl","clipboard","navigator","writeText","hiddenInput","is_pinned","unpinPost","pinPost","markPostAsUnread","RHS_COMMENT","setEditingPost","CENTER","menuRef","buttonRect","buttonRef","totalSpace","spaceOnTop","CHANNEL_HEADER_HEIGHT","spaceOnBottom","POST_AREA_HEIGHT","editDisableAction","handleEditDisable","isReadOnly","disableCanEditPostByTime","isLicensed","postEditTimeLimit","UNSET_POST_EDIT_TIME_LIMIT","milliseconds","timeLeft","canDelete","isSystemMessage","pluginItems","pluginMenuItems","ItemAction","handleDropdownOpened","tooltip","aria-expanded","refCallback","handleCommentClick","ADD_REACTION","handleAddReactionMenuItemActivated","SEARCH","handleUnreadMenuItemActivated","handleFlagMenuItemActivated","handlePinMenuItemActivated","handleEditMenuItemActivated","handleDeleteMenuItemActivated","PostEditTimeLimit","PostDropdownMenu","shouldShowDotMenu","DownloadIcon","FileThumbnail","getFileType","thumbnail","isGIFImage","getIconClassName","FileAttachment","loadFiles","fileThumbnail","fileDetail","onAttachmentClick","SingleImageView","showPreviewModal","toggleEmbedVisibility","hasPreviewImage","previewURL","previewHeight","previewWidth","minPreviewClass","data-expanded","isEmbedVisible","imageNameClass","fileHeader","viewImageModal","fadeInClass","styleIfSvgWithDimensions","imageContainerStyle","svgClass","imageLoaded","isRhsOpen","FileAttachmentList","indexClicked","startImgIndex","minHeightPlaceholder","sortedFileInfos","postFiles","hidePreviewModal","minHeight","selectFilesForPost","makeGetFilesForPost","PostProfilePicture","fromWebhook","defaultURL","enablePostIconOverride","postProps","postIconOverrideURL","useUserIcon","override_icon_url","use_user_icon","DEFAULT_WEBHOOK_LOGO","isBot","getProfilePictureURL","getPostIconURL","overrideIconEmoji","override_icon_emoji","getStatus","EnablePostIconOverride","FailedPostOptions","retryPost","cancelPost","FlagIcon","FlagIconFilled","PostFlagIcon","flagVisible","flagIcon","handlePress","PostTime","isMobileView","localDateTime","isPermalink","PostReaction","addReaction","RHS_SPACE_REQUIRED_ABOVE","RHS_SPACE_REQUIRED_BELOW","getDotMenuRef","Reaction","ids","reactions","emojiImageUrl","currentUserReacted","sortedUsers","otherUsersCount","names","reactionVerb","otherUsers","clickTooltip","emojiNameWithSpaces","ariaLabelEmoji","canRemoveReaction","handleRemoveReaction","canAddReaction","handleAddReaction","shouldUpdatePosition","loadMissingProfiles","reactionCount","checkReactionAction","getProfilesForReactions","makeGetProfilesForReactions","me","teammateNameDisplaySetting","REMOVE_REACTION","getSortedUsers","ReactionList","addReactionButton","reactionsByName","emojiNames","addReactionTooltip","addReactionClassName","getReactionsForPost","makeGetReactionsForPost","ShowMore","isCollapsed","overflowRef","textContainer","isOverflow","checkTextOverflow","isAttachmentText","handleResize","isRHSExpanded","isRHSOpen","checkOverflow","collapsedMaxHeightStyle","collapseGradientClass","collapseShowMoreClass","attachmentTextOverflow","showIcon","showText","toggleCollapse","MESSAGE_DISPLAY","MESSAGE_DISPLAY_DEFAULT","MESSAGE_DISPLAY_COMPACT","ActionButton","handleAction","data-action-id","data-action-cookie","PostContext","createContext","handlePopupOpened","ActionMenu","default_option","menuActions","LinkOnlyRenderer","RemoveMarkdown","outHref","getScheme","output","MessageAttachment","attachment","thumb_url","handleHeightReceived","image_url","actionCookie","doPostActionWithCookie","fields","fieldTables","headerCols","bodyCols","rowPos","lastWasLong","nrTables","short","currentRelativeTeamUrl","preText","preTextClass","attachmentText","thumb","author","author_name","author_icon","author_link","title_link","handleHeightReceivedForImageUrl","footerIcon","footer_icon","footerIconMetadata","footerIconUrl","truncate","MAX_ATTACHMENT_FOOTER_LENGTH","omission","thumbMetadata","thumbUrl","handleHeightReceivedForThumbUrl","getFieldsTable","renderPostActions","useBorderStyle","borderLeftColor","handleFormattedTextClick","MessageAttachmentList","attachments","getDistanceBW2Points","point1","point2","xAttr","yAttr","sqrt","pow","DIMENSIONS_NEAREST_POINT_IMAGE","PostAttachmentOpenGraph","REMOVE_LINK_PREVIEW","patchedPost","renderImageToggle","renderLargeImage","safeImageUrl","renderSmallImage","truncateText","hasPreviewBeenRemoved","previewEnabled","enableLinkPreviews","openGraphData","secure_url","bestImage","pivotPoint","points","nearestPoint","point","getNearestPoint","getBestImageUrl","getImageMetadata","hasLargeImage","isLargeImage","removePreviewButton","handleRemovePreview","site_name","useSafeUrl","EnableLinkPreviews","getOpenGraphMetadataForUrl","LINK_PREVIEW_DISPLAY","PostImage","safeLink","ytRegex","YoutubeVideo","playing","videoId","getVideoId","hours","minutes","seconds","startSeconds","handleYoutubeTime","frameBorder","allowFullScreen","safeUrl","play","googleDeveloperKey","GoogleDeveloperKey","PostBodyAdditionalContent","embeds","embed","postWillRenderEmbedComponents","pluginPostWillRenderEmbedComponents","isYoutubeLink","prependToggle","getEmbed","isEmbedToggleable","renderToggle","renderEmbed","PostWillRenderEmbedComponent","PostMessageView","collapse","hasOverflow","renderDeletedPost","renderEditedIndicator","pluginPostTypes","aria-readonly","postTypes","MessageWithAdditionalContent","previewCollapsed","hasPlugin","messageWrapper","InfoSmallIcon","UserProfile","disablePopover","overwriteName","profileImg","imageURLForUser","setOverlaynRef","overwriteImage","getDisplayName","makeGetDisplayName","RhsComment","isLastPost","NO_WHERE","isDeletedPost","isEphemeralPost","isPostEphemeral","isAutoRespondersPost","isFailedPost","failed","boundingRectOfPostInfo","postHeaderRef","hover","dropdownOpened","isConsecutivePost","isOpened","dotMenu","currentAriaLabel","postRef","handleAlt","shortcutReactToLastPostEmittedFrom","handleShortcutReactToLastPost","isPostDeleted","botIndicator","profilePicture","failedPostOptions","userProfile","override_username","enablePostUsernameOverride","SYSTEM_MESSAGE_PROFILE_IMAGE","postClass","postReaction","pinnedBadge","fileAttachment","createRemovePostButton","postTime","renderPostTime","postInfoIcon","card","handleCardClick","getClassName","handlePostClick","setHover","unsetHover","handlePostFocus","a11yIndex","previousPost","previousPostId","consecutivePost","postFromWebhook","prevPostFromWebhook","POST_COLLAPSE_TIMEOUT","EnablePostUsernameOverride","getShortcutReactToLastPostEmittedFrom","isChannelReadOnlyById","CATEGORY_FLAGGED_POST","RhsHeaderPost","previousRhsState","showSearchResults","MENTION","showMentions","FLAG","showFlaggedPosts","showPinnedPosts","back","closeSidebarTooltip","backToResultsTooltip","expandSidebarTooltip","shrinkSidebarTooltip","handleBack","toggleRhsExpanded","RhsRootPost","isPostsFakeParentDeleted","FAKE_PARENT_DELETED","ReduxPostUtils","testStateObj","channelDisplayName","dotMenuContainer","postFlagIcon","renderView","renderThumbHorizontal","renderThumbVertical","RhsThread","openTime","windowWidth","selectPostCard","postsArray","cpost","childNodes","rhspostlist","viewPort","topRhsPostId","updateFloatingTimestamp","scrollStopAction","SCROLL_DELAY","handleScrollStop","reply_count","getPostThread","prevPostsArray","curPostsArray","socketConnectionStatus","filterPosts","postsLength","isRhsRootLastPost","lastRhsCommentPost","rootPostDay","previousPostDay","commentsLists","createComment","comPost","currentPostDay","toDateString","keyPrefix","handleCardClickPost","isFakeDeletedPost","teammate","directTeammate","autoHide","autoHideTimeout","autoHideDuration","data-a11y-focus-child","data-a11y-order-reversed","getPostsForThread","makeGetPostsForThread","COLLAPSE_DISPLAY","COLLAPSE_DISPLAY_DEFAULT","connected","LINK_PREVIEW_DISPLAY_DEFAULT","getDirectTeammate","RhsCardHeader","RshCardHeader","RhsCard","topRhsPostCreateAt","pluginPostCardTypes","avatar","getSelectedPostCard","postCardTypes","SelectIcon","SearchChannelSuggestion","itemToName","itemToTerm","SearchChannelProvider","channelNames","SearchSuggestionList","popoverRef","renderChannelDivider","SuggestionDate","itemComponent","SearchUserSuggestion","SearchUserProvider","userSearchFunc","autocompleteUsersInTeam","doAutocomplete","usernamePrefix","SearchDateSuggestion","dayString","currentDate","today","onDayClick","handleDayClick","showOutsideDays","useAutomaticTimezone","getCurrentDateForTimezone","automaticTimezone","manualTimezone","SearchDateProvider","datePrefix","dates","HeaderIconWrapper","iconComponent","buttonId","tooltipKey","toolTips","flaggedPosts","messageID","pinnedPosts","recentMentions","ariaLabelText","getTooltip","SearchHint","withTitle","MentionsIcon","updateSearchTerms","handleSearchOnSuccess","searchTerms","isMentionSearch","isFlaggedPosts","renderHintPopover","helpClass","isSideBarRight","mentionBtn","flagBtn","showMentionFlagBtns","mentionBtnClass","searchMentions","flagBtnClass","getFlagged","searchFormClass","searchForm","getSearch","handleUserFocus","handleUserBlur","isFocus","isSearchingTerm","rhsState","getIsSearchingTerm","getSearchTerms","SearchResultsHeader","ReplyIcon","CommentIcon","commentCountSpan","iconStyle","searchStyle","extraClass","SearchResultsItem","selectPost","setRhsExpanded","getChannelName","createAriaLabel","overrideUsername","disableProfilePopover","profilePic","profilePicContainer","flagContent","rhsControls","commentCountForPost","handleFocusRHSClick","replyCount","handleJumpClick","searchMatches","handleSearchItemFocus","getReplyCount","makeGetReplyCount","createAriaLabelForPost","makeCreateAriaLabelForPost","getCommentCountForPost","isPostFlagged","getDisplayNameByUser","selectPostFromRightHandSideSearch","selectPostCardFromRightHandSideSearch","DataRetentionHint","days","dataRetentionMessageRetentionDays","FlagPostSearchHint","dataRetentionEnableMessageDeletion","PinPostSearchHint","SearchResults","scrollbars","isPinnedPosts","isSearchGettingMore","getScrollHeight","getScrollTop","getClientHeight","loadMorePosts","getMorePostsForSearch","results","nextResults","shouldRenderFromPropsAndState","noResults","ctls","loadingMorePostsComponent","isSearchingFlaggedPost","isSearchingPinnedPost","sortedResults","postA","postB","isSearchAtEnd","formattedTitle","isCard","data-a11y-loop-navigation","regionTitle","DataRetentionEnableMessageDeletion","DataRetentionMessageRetentionDays","newResults","getSearchResults","currentSearch","getCurrentSearchForCurrentTeam","getSearchMatches","getSearchResultsTerms","getIsSearchingFlaggedPost","getIsSearchingPinnedPost","getIsSearchGettingMore","isEnd","PreferenceSelectors","RhsPlugin","rhsPlugins","RightHandSidebarComponent","getPluginId","RHSPlugin","SidebarRight","isOpen","previous","searchVisible","selectedPostId","selectedPostCardId","PERIOD","openAtPrevious","transitionInfo","sidebarRight","getPropertyValue","hasTransition","onFinishTransition","propertyName","determineTransition","handleShortcut","wasOpen","postRightVisible","setPrevious","postCardVisible","isPluginView","expandedClass","isExpanded","toggleSize","shrink","onShrink","openRHSSearch","getSelectedPostId","getSelectedPostCardId","PLUGIN","getPreviousRhsState","TutorialSteps","TutorialTip","currentScreen","screens","diagnosticsTag","TUTORIAL_STEP","step","FINISHED","screen","targetRef","buttonText","dots","data-screen","handleCircleClick","tutorialGifImage","tutorialGif","tutorialGifWhite","skipTutorial","getInt","MenuTutorialTip","toggleFunc","onBottom","arrow","sendMembersInvites","emails","u","sent","notSent","usersToAdd","reason","userToAdd","memberWithError","invitesWithErrors","inviteWithError","sendGuestsInvites","memberOfAll","memberOfAny","sendGuestInviteForUser","CloseIcon","FullScreenModal","currentActiveElement","onClose","appear","aria-modal","ariaLabelledBy","onGoBack","RootPortal","rootPortal","InviteIcon","ArrowRightIcon","InvitationModalInitialStep","which","goToMembers","goToGuests","onMembersKeyDown","emailInvitationsEnabled","onGuestsKeyDown","InviteMembersIcon","MailIcon","MailPlusIcon","CloseCircleSolidIcon","UsersEmailsInput","parts","getLongDisplayNameParts","fullName","loadingMessageId","loadingMessageDefault","guestBadge","isEmail","getCreateLabel","renderUserName","validAddressMessageId","validAddressMessageDefault","selectProps","noMatchMessageId","noMatchMessageDefault","NoOptionsMessage","innerProps","MultiValueRemove","customCallback","usersLoader","selectRef","loadOptions","optionsLoader","isValidNewOption","showAddEmail","empty","formatOptionLabel","defaultOptions","defaultMenuIsOpen","openMenuOnClick","loadingMessage","tabSelectsValue","LinkIcon","InvitationModalMembersStep","inviteLinkRef","textField","searchProfiles","not_in_team_id","termWithoutResults","debouncedSearchProfiles","usersAndEmails","onEdit","usersInputValue","userOrEmail","inviteUrl","onUsersInputChange","CloseCircleIcon","ChannelsInput","channelsLoader","noOptionsMessageId","noOptionsMessageDefault","noOptionsMessage","InvitationModalGuestsStep","customMessage","channelsInputValue","searchChannels","debouncedSearchChannels","myInvitableChannels","customMessageOpen","textareaRef","defaultChannels","inputPlaceholder","onUsersEmailsChange","onChannelsChange","onChannelsInputChange","openCustomMessage","closeCustomMessage","onMessageChange","sendInvites","AlertIcon","InvitationModalConfirmStepRow","invitation","getLongDisplayName","InvitationModalConfirmStepTable","invites","InvitationModalConfirmStep","invitesSentCount","invitesNotSentCount","sentCount","notSentCount","invitesType","invitesSent","invitesNotSent","onDone","onInviteMore","InviteTypes","INVITE_MEMBER","INVITE_GUEST","getInvitesCountsMessage","InvitationModal","canAddUsers","canInviteGuests","goToInitialStep","hasChanges","confirmBack","lastInviteChannels","lastInviteMesssage","prevStep","goToPrevStep","confirmModal","extraUserText","extraChannelText","lastInviteMessage","invite_id","getBackFunction","confirmClose","cancelClose","cancelBack","onMembersSubmit","invitableChannels","onGuestsSubmit","goToFirstStep","reduxSearchProfiles","getProfiles","reduxSearchChannels","guestAccountsEnabled","EnableGuestAccounts","EnableEmailInvitations","group_constrained","ADD_USER_TO_TEAM","INVITATION","LeaveTeamIcon","LeaveTeamModal","leaveTeam","toggleSideBarRightMenu","SearchableUserListContainer","handleTermChange","DropdownIcon","TeamMembersDropdown","handleDemote","updateTeamMemberSchemeRoles","getMyTeamMembers","getMyTeamUnreads","newRole","showDemoteModal","currentRoles","showMakeMember","showMakeAdmin","canRemoveFromTeam","makeDemoteModal","vallues","handleDemoteSubmit","handleDemoteCancel","handleRemoveFromTeam","handleMakeAdmin","handleMakeMember","getTeamStats","updateUserActive","MemberListTeam","loadProfilesAndTeamMembers","PROFILE_CHUNK_SIZE","getTeamMembers","loadComplete","loadStatusesForProfilesList","loadTeamMembersForProfilesList","membersLoaded","teamMembersDropdown","canManageTeamMembers","totalTeamMembers","MANAGE_TEAM_ROLES","searchProfilesInCurrentTeam","getProfilesInCurrentTeam","getCurrentTeamStats","active_member_count","getMembersInCurrentTeam","TeamMembersModal","teamDisplayName","handleInvitePeople","TEAM_MEMBERS","ACCEPTED_TEAM_IMAGE_TYPES","GeneralTab","setupInitialState","openInvite","allow_open_invite","allowed_domains","patchTeam","valid","MIN_TEAMNAME_LENGTH","MAX_TEAMNAME_LENGTH","regenerateTeamInviteId","teamIconFile","loadingIcon","setTeamIcon","removeTeamIcon","shouldFetchTeam","isInitialState","fetchTeam","off","openInviteSection","inviteSection","nameSection","descriptionSection","teamIconSection","allowedDomainsSection","defaultChecked","handleOpenInviteRadio","handleOpenInviteSubmit","canInviteTeamMembers","getTeamInviteLink","handleInviteIdSubmit","teamNameLabel","updateName","nameExtraInfo","handleNameSubmit","teamDescriptionLabel","MAX_TEAMDESCRIPTION_LENGTH","updateDescription","descriptionExtraInfo","handleDescriptionSubmit","describemsg","updateTeamIcon","handleTeamIconSubmit","handleTeamIconRemove","minMessage","last_team_icon_update","updateAllowedDomains","allowedDomainsInfo","handleAllowedDomainsSubmit","data-dismiss","INVITE_USER","TeamGeneralTab","SettingsUpload","val","uploadinput","inputnode","fileNameText","submitButtonClass","fileTypesAccepted","doFileSelect","openFileSelect","importSlack","TeamImportTab","encodeURIComponent","atob","utils","onImportSuccess","onImportFailure","uploadDocsLink","uploadExportInstructions","uploadExporterLink","importCliLink","uploadHelpText","exportInstructions","slackAdvancedExporterLink","cliLink","uploadSection","doImportSlack","messageSection","TeamSettings","TeamSettingsModal","TEAM_SETTINGS","marketplace","getInstalledPlugins","installed_version","fetchPlugins","localOnly","getFilter","getMarketplacePlugins","RECEIVED_MARKETPLACE_PLUGINS","installPlugin","INSTALLING_MARKETPLACE_PLUGIN","getPlugin","installMarketplacePlugin","INSTALLING_MARKETPLACE_PLUGIN_FAILED","INSTALLING_MARKETPLACE_PLUGIN_SUCCEEDED","filterPlugins","FILTER_MARKETPLACE_PLUGINS","PluginIcon","UpdateVersion","releaseNotesUrl","Label","UpdateDetails","installedVersion","isInstalling","onUpdate","isUpdate","semver","gt","UpdateConfirmationModal","sameMajorVersion","major","MarketplaceItem","eventName","allowDetail","isDefaultMarketplace","plugin_id","showUpdateConfirmationModal","hideUpdateConfirmationModal","closeMarketplaceModal","getItemButton","actionButton","onInstall","installing","onConfigure","pluginIcon","labels","versionLabel","iconData","pluginDetailsInner","error_text","pluginDetails","homepageUrl","item_error","downloadUrl","getInstalling","getError","IsDefaultMarketplace","PLUGIN_MARKETPLACE","NavigationButton","messageId","NavigationRow","maximumPerPage","trunc","onPreviousPageButtonClick","canShowNextButton","onNextPageButtonClick","MarketplaceList","pluginsToDisplay","isPrepackaged","download_url","homepage_url","release_notes_url","icon_data","MarketplaceTabs","AllPlugins","InstalledPlugins","installedPlugins","changeTab","MarketplaceModal","tabKey","debouncedSearch","doSearch","pluginStatuses","handleClearSearch","errorBanner","activeKey","ListModal","loadItems","numPerPage","renderRows","renderRow","paginationRange","titleText","titleBarButtonText","titleBarButtonOnClick","searchPlaceholderText","onSearchInput","onPrev","onNext","TeamGroupsManageModal","listModal","pageNumber","getGroupsAssociatedToTeam","totalGroupCount","unlinkGroupSyncable","MANAGE_TEAM_GROUPS","ADD_GROUPS_TO_TEAM","patchGroupSyncable","setTeamMemberStatus","onClickRemoveGroup","titleButtonOnClick","handleDeleteConfirmed","handleDeleteCanceled","teamID","MainMenu","teamIsGroupConstrained","isLicensedForLDAPGroups","mobile","Group","ItemToggleModalRedux","MANAGE_TEAM","REMOVE_USER_FROM_TEAM","CREATE_TEAM","ItemLink","experimentalPrimaryTeam","moreTeamsToJoin","MANAGE_SLASH_COMMANDS","MANAGE_OAUTH","MANAGE_INCOMING_WEBHOOKS","MANAGE_OUTGOING_WEBHOOKS","enableIncomingWebhooks","enableOutgoingWebhooks","enableCommands","enableOAuthServiceProvider","enablePluginMarketplace","enableCustomEmoji","canCreateOrDeleteCustomEmoji","ItemExternalLink","helpLink","reportAProblemLink","appDownloadLink","siteName","handleEmitUserLoggedOutEvent","teamType","enableUserCreation","enableEmailInvitations","AppDownloadLink","EnableCommands","EnableIncomingWebhooks","EnableOAuthServiceProvider","EnableOutgoingWebhooks","EnableUserCreation","EnableMarketplace","ExperimentalPrimaryTeam","HelpLink","ReportAProblemLink","CREATE_EMOJIS","DELETE_EMOJIS","joinableTeams","getJoinableTeamIds","LDAPGroups","SidebarRightMenu","tutorialTip","showTutorialTip","openRhsMenu","enableTutorial","EnableTutorial","tutorialStep","getIsRhsMenuOpen","MENU_POPOVER","ImportThemeModal","isInputValid","inputError","colors","sidebarBg","sidebarText","sidebarUnreadText","sidebarTextHoverBg","sidebarTextActiveBorder","sidebarTextActiveColor","sidebarHeaderBg","sidebarHeaderTextColor","onlineIndicator","mentionBg","setThemeDefaults","updateShow","charAt","handleOnHide","getIsLhsOpen","lhs","CopyUrlContextMenu","copyToClipboard","contextMenu","menuId","copy","contextMenuTrigger","holdToDisplay","TeamButton","mark","unread","isDraggable","teamIndex","teamClass","isNotCreateTeamButton","handleDisabled","handleSwitch","badge","orderIndicator","toolTip","tip","toolTipHelp","showOrder","btn","teamButton","draggableId","provided","snapshot","innerRef","draggableProps","dragHandleProps","isDragging","LegacyTeamSidebar","newPos","digits","ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE","ZERO","userTeamsOrderPreference","switchToPrevOrNextTeam","switchToTeamByNumber","destination","sourceIndex","destinationIndex","newTeamsOrder","list","itemId","pushElement","getTeams","myTeamMembers","onDragEnd","droppableId","droppableProps","SearchableChannelList","archiveIcon","shouldShowArchivedChannels","handleJoin","joiningChannel","toggleArchivedChannels","marginTop","noResultsText","channelsPerPage","channelsToDisplay","createChannelRow","channelDropdown","createChannelButton","canShowArchivedChannels","toggleArchivedChannelsOff","toggleArchivedChannelsOn","MoreChannels","bodyOnly","force","searchedChannels","getChannels","done","getRelativeChannelURL","searching","setSearchResults","morePublicChannelsModalType","CHANNELS_CHUNK_SIZE","getArchivedChannels","archivedChannels","channelsRequestStarted","serverErrorState","activeChannels","createNewChannelButton","CREATE_PUBLIC_CHANNEL","handleNewChannel","createChannelHelpText","CREATE_PRIVATE_CHANNEL","getNotArchivedOtherChannels","getOtherChannels","getArchivedOtherChannels","RequestStatus","STARTED","GroupMessageOption","MAX_SELECTABLE_VALUES","MAX_USERS_IN_GM","MoreDirectChannels","statuses","missingStatusByIds","loadingUsers","exitToChannel","addUsers","existingUserIds","pageNum","restrictDirectMessage","USERS_PER_PAGE","setUsersLoadingState","getProfilesInTeam","getUserProfiles","multiselect","resetPaging","displayEntireNameForUser","modalName","displayname","currentChannelMembers","getTotalUsersStats","loadProfilesMissingStatus","updateFromProps","profilesData","groupChannelsData","searchGroupChannels","loadProfilesForGroupChannels","note","isExistingChannel","inactive","myDirectChannels","groupChannels","renderAriaLabel","handleSubmitImmediatelyOn","filterGroupChannels","memoizeResult","filterProfilesMatchingTerm","filterDirectChannels","getProfilesInCurrentChannel","RestrictDirectMessage","searchProfilesSelector","selectProfiles","filteredGroupChannels","getChannelsWithUserProfiles","getAllChannels","getTotalUsersStatsSelector","total_users_count","sortByUsername","DraftIcon","SwitchChannelSuggestion","hasDraft","userImageUrl","dmChannelTeammate","notify_props","ConnectedSwitchChannelSuggestion","DRAFT","quickSwitchSorter","SwitchChannelProvider","getDirectAndGroupChannels","fetchUsersAndChannels","formatUnreadChannelsAndDispatch","usersAsync","usersFromServer","RECEIVED_PROFILES_LIST","userWrappedChannel","skipNotInChannel","curState","usersInChannels","getUserIdsInChannels","userSearchStrings","usersInChannel","Set","userString","ARCHIVED_CHANNEL","isGroupChannelVisible","getLastPostPerChannel","isUnreadChannel","isDirectChannelVisible","isDMVisible","makeGetChannel","getSortedUnreadChannelIds","MENTION_UNREAD_CHANNELS","SwitchTeamSuggestion","SwitchTeamProvider","teamPrefix","teamNames","QuickSwitchModal","switchBox","focusPostTextbox","switchMode","mode","selectedChannel","channelProviders","teamProviders","showTeamSwitcher","enableTeamProvider","channelShortcut","defaultChannelShortcut","teamShortcut","defaultTeamShortcut","channelsActiveClass","teamsActiveClass","data-mode","restoreFocus","setSwitchBoxRef","NewChannelModal","displayNameError","enterPressed","displayNameInput","MIN_CHANNELNAME_LENGTH","onSubmitChannel","newData","channelHeaderInput","channelPurposeInput","onDataChanged","onChangeURLPressed","onTypeSwitched","addClass","canCreatePublicChannel","canCreatePrivateChannel","enableTypeSelection","displayNameClass","publicChannelDesc","privateChannelDesc","typeOptions","handlePublicTypeSelect","handlePrivateTypeSelect","prettyTeamURL","getShortenedURL","onModalExited","MAX_CHANNELNAME_LENGTH","channelData","handleOnURLChange","ChangeURLModal","currentURL","userEdit","formattedError","urlinput","cleanUpUrlable","urlError","getURLError","onModalSubmit","urlClass","fullURL","currentTeamURL","shortURL","urlTooltip","onURLChanged","submitButtonText","getChannelTypeFromProps","NewChannelFlow","flowState","channelPurpose","channelHeader","nameModified","creator_id","extra_update_at","last_post_at","scheme_id","total_msg_count","createChannel","onCreateChannelError","newURL","showChannelModal","showChangeURLModal","changeURLTitle","changeURLSubmitButtonText","typeSwitched","urlChangeRequested","channelDataChanged","urlChangeSubmitted","urlChangeDismissed","UnreadBelowIcon","UnreadChannelIndicator","StatusDropdown","AWAY","DND","resetStatusModalData","RESET_STATUS","needsConfirm","isUserOutOfOffice","renderProfilePicture","dropdownIcon","renderDropdownIcon","setOnline","showStatusChangeConfirmation","setDnd","setAway","setOffline","SidebarHeaderDropdownButton","mainMenuToolTip","teamNameWithToolTip","data-teamid","teamDescription","SidebarHeaderDropdown","SidebarHeader","BotIcon","SidebarChannelButtonOrLinkIcon","svgErrorUrl","botIconUrl","membersCount","teammateId","teammateDeletedAt","teammateIsBot","onSvgLoad","onSvgLoadError","channelStatus","SidebarChannelButtonOrLinkCloseButton","removeTooltip","SidebarChannelButtonOrLink","displayNameRef","scrollWidth","trackChannelSelectedEvent","gmItemRef","removeAttribute","unreadMentions","unreadMsgs","showUnreadForMsgs","rowClass","displayNameToolTip","channelTooltip","removeTooltipLink","enableToolTipIfNeeded","SidebarTutorialTip","townSquareDisplayName","DEFAULT_CHANNEL_UI_NAME","offTopicDisplayName","OFFTOPIC_CHANNEL_UI_NAME","townsquare","offtopic","openLhs","SidebarChannel","isLeaving","channelTeammateId","closeHandler","showChannelAsUnread","shouldHideChannel","handleLeaveDirectChannel","EnableXToLeaveChannelsFromLHS","handleLeavePublicChannel","handleLeavePrivateChannel","linkClass","channelMuted","channelFake","channelStringified","channelTeammateUsername","channelTeammateDeletedAt","channelTeammateIsBot","channelsByName","memberIds","mark_unread","NotificationLevels","botLastIconUpdate","botUser","teammate_id","bot_last_icon_update","getBotRoute","shouldHideDefaultChannel","isChannelMuted","CHANNEL_POPOVER","OFFTOPIC_CHANNEL","ChannelCreate","ariaLabelPublic","createPublicChannel","ariaLabelPrivate","createPrivateChannel","ariaLabelDM","createDirectMessage","renderPublic","renderPrivate","createPublicDirectChannel","sectionType","renderDirect","renderCombined","ChannelMore","moreChannels","moreDirectMessages","browsePublicDirectChannels","JOIN_PUBLIC_CHANNELS","moreChannelsPublic","moreChannelsPrivate","clickableChannelHeader","ChannelName","tooltipTriggers","formattedMessageId","sectionTypeFormatMessageId","createPublicDirectChannelTooltip","MorePublicDirectChannels","handleSelect","LegacySidebar","showDirectChannelsModal","hideMoreDirectChannelsModal","showMoreDirectChannelsModal","updateUnreadIndicators","spring","scrollbar","getCurrentValue","scrollToChannel","firstUnreadChannel","lastUnreadChannel","scrollingToUnread","showTopUnread","scrollEnd","displayedChannels","getDisplayedChannels","orderedChannelIds","MathUtil","mapValueInRange","scrollToPosition","showBottomUnread","scrollAnimation","setCurrentValue","setAtRest","setEndValue","firstUnreadElement","firstUnreadPosition","lastUnreadElement","lastUnreadPosition","K","handleOpenMoreDirectChannelsModal","isSwitchingChannel","nextIndex","nextChannelId","ChannelUtils","showMorePublicChannelsModal","hideMorePublicDirectChannelsModal","showNewChannelModal","showMoreChannelsModal","newChannelModalType","QUICK_SWITCH","sectionsToHide","SidebarChannelGroups","UNREADS","FAVORITE","sec","createSidebarChannel","sectionId","showMorePublicDirectChannelsModal","showNewPublicChannelModal","showNewPrivateChannelModal","badgesActive","closedDirectChannel","animate","SpringSystem","createSpring","setOvershootClampingEnabled","onSpringUpdate","handleScrollAnimationUpdate","navigateChannelShortcut","navigateUnreadChannelShortcut","channelIdIsDisplayedForProps","setFirstAndLastUnreadChannels","deregisterSpring","removeAllListeners","channelSwitcherOption","above","below","moreDirectChannelsModal","moreChannelsModal","hideMoreChannelsModal","morePublicDirectChannelsModal","quickSwitchText","quickSwitchTextShortcutId","quickSwitchTextShortcutDefault","quickSwitchTextShortcut","openQuickSwitcher","onHandleNewChannel","hideNewChannelModal","scrollToFirstUnreadChannel","scrollToLastUnreadChannel","renderOrderedChannels","currentTeammate","sidebarPrefs","getSidebarPreferences","keepChannelIdAsUnread","getOrderedChannelIds","grouping","sorting","unreads_at_top","favorite_at_top","getBoolPreference","CATEGORY_SIDEBAR_SETTINGS","getUnreads","Sidebar","AddChannelDropdown","canCreateChannel","canJoinPublicChannel","joinPublicChannel","renderDropdownItems","ChannelNavigator","goBack","goForward","historyArrows","channelSwitchTextShortcutDefault","canGoBack","canGoForward","setCategoryCollapsed","categoryId","collapsed","CHANNEL_CATEGORY_COLLAPSED","collapseCategory","expandCategory","setUnreadFilterEnabled","SET_UNREAD_FILTER_ENABLED","isCategoryCollapsedFromStorage","storage","getItemFromStorage","isCategoryCollapsed","isUnreadFilterEnabled","getPrefix","channelSidebar","unreadFilterEnabled","makeGetCurrentlyDisplayedChannelsForTeam","getCategoriesForTeam","makeGetCategoriesForTeam","getChannelsByCategory","makeGetChannelsByCategory","getCollapsedStateForAllCategoriesByTeam","makeGetCollapsedStateForAllCategoriesByTeam","collapsedState","channelsByCategory","isUnread","flat","ChannelFilter","filterTitle","filterDescription","tooltipMessage","toggleUnreadFilter","ChannelMentionBadge","SidebarChannelClose","removeTooltipMessage","handleLeaveChannel","SidebarChannelIcon","SidebarChannelLink","labelRef","ariaLabelPrefix","isMuted","oldUnreadClass","muted","getAriaLabel","SidebarBaseChannel","enableXToLeaveChannelsFromLHS","getCloseHandler","getIcon","StatusIconNew","iconName","SidebarDirectChannel","SidebarGroupChannel","groupMemberIds","isCurrentChannel","channelElement","getRef","getChannelRef","setChannelRef","ChannelComponent","draggable","setRef","onTransitionEnd","removeAnimation","teammateUsername","SidebarCategory","categoryTitleRef","handleA11yKeyDown","CategoryTypes","DIRECT_MESSAGES","renderedChannels","renderChannel","directMessagesModalButton","hideArrow","helpLabel","handleOpenDirectMessagesModal","CUSTOM","favorites","FAVORITES","getChannelsForCategory","makeGetChannelsForCategory","SidebarCategoryList","channelRefs","delete","channelIds","getFirstUnreadChannel","getLastUnreadChannel","getDisplayedChannelIds","getFirstUnreadChannelFromChannelIdArray","renderedCategories","renderCategory","getCurrentlyDisplayedChannelsForTeam","handleNewChannelForMoreChannelsModal","renderModals","focusPost","returnTo","PERMALINK_NOT_FOUND","RECEIVED_FOCUSED_POST","getUserIdFromChannelId","PermalinkView","permalink","doPermalinkEvent","isStateValid","ChannelHeaderDropdown","ChannelHeaderDropdownItems","MobileChannelHeaderPlug","plug","fireAction","isDropdown","createList","plugs","createButton","getMyCurrentChannelMembership","MobileChannelHeaderButton","Describe","memberNotifyLevel","globalNotifyLevel","ignoreChannelMentions","DEFAULT","levelsFormattedMessageId","notifyLevel","NotificationSections","MARK_UNREAD","IGNORE_CHANNEL_MENTIONS","IgnoreChannelMentions","ON","OFF","DESKTOP","PUSH","ALL","SectionTitle","CollapseView","onExpandSection","ExtraInfo","ExpandView","onCollapseSection","NONE","server_error","NotificationSection","onUpdateSection","globalNotificationLevel","memberNotificationLevel","handleOnChange","handleCollapseSection","handleExpandSection","ChannelNotificationsModal","channelNotifyProps","resetStateFromNotifyProps","updateChannelNotifyProps","desktopNotifyLevel","desktop","handleUpdateChannelNotifyProps","markUnreadNotifyLevel","pushNotifyLevel","ignore_channel_mentions","getStateFromNotifyProps","prevChannelNotifyProps","channelMemberNotifyProps","currentUserNotifyProps","ignoreChannelMentionsDefault","sendPushNotifications","serverErrorTag","handleUpdateMarkUnreadLevel","handleSubmitMarkUnreadLevel","handleUpdateIgnoreChannelMentions","handleSubmitIgnoreChannelMentions","handleUpdateDesktopNotifyLevel","handleSubmitDesktopNotifyLevel","handleUpdatePushNotificationLevel","handleSubmitPushNotificationLevel","SendPushNotifications","ChannelInviteModal","inviteError","handleInviteError","not_in_channel_id","profilesNotInCurrentChannel","profilesNotInCurrentTeam","getProfilesNotInCurrentChannel","getProfilesNotInCurrentTeam","ChannelMembersDropdown","removing","removeChannelMember","updateChannelMemberSchemeRoles","renderRole","canChangeMemberRoles","canRemoveMember","isDefaultChannel","currentRole","canMakeUserChannelMember","canMakeUserChannelAdmin","canRemoveUserFromChannel","handleMakeChannelMember","handleMakeChannelAdmin","handleRemoveFromChannel","MANAGE_CHANNEL_ROLES","MemberListChannel","loadProfilesAndTeamMembersAndChannelMembers","getChannelMembers","in_channel_id","loadTeamMembersAndChannelMembersForProfilesList","totalChannelMembers","getUsersAndActionsToDisplay","searchProfilesInCurrentChannel","ChannelMembersModal","CHANNEL_INVITE","canManageChannelMembers","onAddNewMembersButton","headerMarkdownOptions","ChannelInfoModal","getHeaderMarkdownOptions","channelIcon","notFound","channelURL","channelPurposeElement","EditChannelHeaderModal","patchChannel","EDIT_CHANNEL_HEADER","editChannelHeaderTextbox","blurTextbox","headerTitle","handleModalKeyDown","handleEntering","renderError","EditChannelPurposeModal","unsetError","setError","channelPurposeModal","ariaLabelForTitle","getPurpose","required","lowercase","defaultError","displayNameHolder","handleHolder","RenameChannelModal","nameError","invalid","oldName","onSaveSuccess","nameClass","urlInputLabel","readOnlyHandleInput","fullUrl","shortUrl","onDisplayNameChange","onNameChange","mapStateToProps","teamInfo","ConvertChannelModal","CHANNEL_ID_LENGTH","convertChannelToPrivate","handleConvert","currentTeamDetails","DeleteChannelModal","canViewArchivedChannels","penultimateViewedChannelName","deleteChannel","UnarchiveChannelModal","unarchiveChannel","handleUnarchive","ChannelGroupsManageModal","getGroupsAssociatedToChannel","MANAGE_CHANNEL_GROUPS","schemeAdmin","setChannelMemberStatus","channelID","LeaveChannel","isDefault","isGuestUser","handleLeave","CloseChannel","isArchived","CloseMessage","MenuItemToggleMuteChannel","ToggleFavoriteChannel","isFavorite","favoriteChannel","toggleFavoriteChannel","ViewPinnedPosts","hasPinnedPosts","isReadonly","isPrivate","isGroupConstrained","channelMembersPermission","channelPropertiesPermission","MANAGE_PRIVATE_CHANNEL_PROPERTIES","MANAGE_PUBLIC_CHANNEL_PROPERTIES","channelDeletePermission","DELETE_PRIVATE_CHANNEL","DELETE_PUBLIC_CHANNEL","channelUnarchivePermission","CHANNEL_INFO","CHANNEL_NOTIFICATIONS","CREATE_DM_CHANNEL","CHANNEL_MEMBERS","ADD_GROUPS_TO_CHANNEL","EDIT_CHANNEL_PURPOSE","RENAME_CHANNEL","DELETE_CHANNEL","UNARCHIVE_CHANNEL","MobileChannelHeaderDropdownAnimation","MobileChannelHeaderDropdown","teammateStatus","dmHeaderIconStatus","getChannelTitle","getTeammateId","getTeammateStatus","getUserStatuses","userStatuses","Desktop","isCurrentChannelDefault","isCurrentChannelFavorite","isCurrentChannelMuted","isCurrentChannelReadOnly","isCurrentChannelArchived","ChannelHeader","Items","Mobile","NotifyCounts","messageCount","getUnreadsInCurrentTeam","CollapseLhsButton","toggleLhs","data-target","CollapseRhsButton","toggleRhsMenu","InfoIcon","NavbarInfoButton","headerOverlay","popoverContent","addOne","showEditChannelHeaderModal","clickHere","popover","ChannelInfoButton","ShowSearchButton","UnmuteChannelButton","ChannelHeaderMobile","closeRhs","hideSidebars","membership","USER_ID_PAIR_REGEXP","onChannelByIdentifierEnter","identifier","teamObj","moreChannelsByName","isDirectChannelIdentifier","getPathFromIdentifier","joinError","data2","getChannelError","handleChannelJoinError","goToDirectChannelByUserIds","doChannelChange","goToChannelByChannelName","goToDirectChannelByUserId","goToChannelByChannelId","groupId","markGroupChannelOpen","goToGroupChannelByGroupId","selectUserByUsername","goToDirectChannelByUsername","selectUserByEmail","getUserByEmail","goToDirectChannelByEmail","selectUser","defaultChannel","MemberIcon","MessageIcon","PopoverListMembersItem","messageIcon","showMessageIcon","botClass","PopoverListMembers","closePopover","showPopover","showChannelMembersModal","showChannelInviteModal","showTeamMembersModal","popoverTarget","loadProfilesAndStatusesInChannel","undefined","membersList","isDirectChannel","popoverButton","membersName","manageMembers","showMembersModal","countText","channelMembersModal","teamMembersModal","channelInviteModal","hideChannelMembersModal","showInviteModal","hideTeamMembersModal","hideChannelInviteModal","channelMembersTooltip","handleGetProfilesInChannel","getTargetPopover","doGetProfilesInChannel","doSortUsersByStatusAndDisplayName","sortUsersByStatusAndDisplayName","makeSortUsersByStatusAndDisplayName","PinIcon","PluginChannelHeaderIcon","CustomMenu","rootCloseEvent","onRootClose","handleRootClose","CustomToggle","activeClass","dropdownOpen","ChannelHeaderPlug","toggleDropdown","fireActionAndClose","Dropdown","bsRole","createDropdown","ChannelHeaderButton","popoverMarkdownOptions","showSearchBar","getShowSearchBar","M","toggleQuickSwitchModal","isQuickSwitcherOpen","toggleFavoriteRef","headerText","headerDescriptionRect","headerDescriptionRef","headerPopoverTextMeasurerRef","showChannelHeaderPopover","leftOffset","offsetLeft","popoverOverlayWidth","getPopoverMarkdownOptions","getCustomEmojisInText","handleQuickSwitchKeyPress","rhsOpen","gmMembers","dmUser","hasGuests","newSideBarPreference","ariaLabelChannelHeader","hasGuestsText","channelTitle","archivedIcon","isDirect","isGroup","membersMap","userDisplayName","popoverListMembers","dmHeaderTextStatus","headerTextContainer","hasMoreThanOneTeam","setPopoverOverlayWidth","editMessage","toggleFavoriteTooltip","toggleFavorite","channelMutedTooltip","muteTrigger","unmute","pinnedIconClass","mentionsIconClass","flaggedIconClass","aria-level","data-channelid","searchButtonClick","dmUserId","guest_count","getNewSidebarPreference","trimRight","str","CreatePost","onOrientationChange","abs","lastOrientation","handleEmojiClose","sendReaction","saveDraftFrame","setDraft","draftsForChannel","tokens","updateChannel","userIsOutOfOffice","currentMembersCount","currentChannelMembersCount","getStatusFromSlashCommand","isStatusSlashCommand","editChannelHeaderModalData","isDirectOrGroup","editChannelPurposeModalData","onSubmitPost","itemIndex","ctrlOrMetaKeyPressed","shortcutModalKeyCombo","FORWARD_SLASH","createPostControls","messageIsEmpty","draftMessageIsEmpty","ctrlEnterKeyCombo","upKeyOnly","shiftUpKeyCombo","ctrlKeyCombo","postMsgKeyPress","editLastPost","replyToLastPost","loadPrevMessage","loadNextMessage","currentUsersLatestPost","POST","latestReplyablePostId","replyBox","selectPostFromRightHandSideSearchByPostId","fillMessageFromHistory","noModalsAreOpen","noPopupsDropdownsAreOpen","clearDraftUploads","documentKeyHandler","setOrientationListeners","removeOrientationListeners","lastMessage","messageInHistoryItem","createTutorialTip","shouldEnableSendButton","fullWidthTextBox","ariaLabelMessageInput","postFooterClassName","centerClass","sendButtonClass","attachmentsDisabled","getCreatePostControls","getChannelView","recentPostIdInChannel","getLatestReplyablePostId","PreferencesRedux","CHANNEL_DISPLAY_MODE","CHANNEL_DISPLAY_MODE_DEFAULT","CHANNEL_DISPLAY_MODE_FULL_SCREEN","POST_POPOVER","CommentedOnFilesMessage","plusMore","selectFileInfosForPost","CommentedOn","makeUsername","webhookMessage","makeCommentedOnMessage","onCommentClick","stripMarkdown","PostBody","sendingAction","sending","parentPost","comment","failedOptions","isFirstReply","fileAttachmentHolder","messageWithAdditionalContent","mentionHighlightClass","isCommentMention","ephemeralPostClass","parentPostUser","PostInfo","showOptionsMenuWithoutHover","showDotMenu","commentIconExtraClass","commentIcon","getDotMenu","handleDotMenuOpened","isCardOpen","buildOptions","showTimeWithoutHover","selectedCard","mobileView","PostHeader","indicator","colon","Post","system_post_ids","opened","togglePostMenu","previousPostIsComment","consecutivePostByUser","isMeMessage","fromBot","fadeOutHighlight","shouldHighlight","rootUser","hasSameRoot","currentUserCss","sameUserClass","ariaHidden","highlightTimeout","PERMALINK_FADEOUT","checkIsMeMessage","from_bot","hideProfilePicture","center","removeFocus","onTouchStart","isPostCommentMention","makeIsPostCommentMention","CHANNEL_DISPLAY_MODE_CENTERED","generateCombinedPost","makeGenerateCombinedPost","combinedId","NotificationSeparator","NewMessageSeparator","separatorId","ChannelIntroMessage","creatorName","fullWidth","channelProfiles","teammateName","centeredIntro","createSetHeaderButton","createDMIntroMessage","pictures","createGMIntroMessage","teamInviteLink","setHeaderButton","createDefaultIntroMessage","channelInviteButton","createInviteChannelButton","createOffTopicIntroMessage","memberMessage","getMonthLong","creator","purposeMessage","createStandardIntroMessage","PostListRow","blockShortcutReactToLastPostForNonMessages","listId","isIdNotPost","shortcutReactToLastPostEmittedFromCenter","previousListId","PostListRowListIds","CHANNEL_INTRO_MESSAGE","LOAD_OLDER_MESSAGES_TRIGGER","LOAD_NEWER_MESSAGES_TRIGGER","loadOlderPosts","loadNewerPosts","OLDER_MESSAGES_LOADER","NEWER_MESSAGES_LOADER","ScrollToBottomIcon","ScrollToBottomArrows","atBottom","Toast","onDismiss","toastClass","showActions","toastActionClass","closeTooltip","MOBILE_SCREEN_WIDTH","onClickMessage","jumpSection","ToastWrapper","showUnreadToast","hideUnreadToast","showNewMessagesToast","hideNewMessagesToast","hideArchiveToast","showMessageHistoryToast","updateLastViewedBottomAt","atLatestPost","scrollToNewMessage","changeUrlToRemountChannelView","scrollToLatestMessages","unreadCountInChannel","unreadCount","countNewMessages","postListIds","channelMarkedAsUnread","newRecentMessagesCount","initScrollOffsetFromBottom","lastViewedBottom","latestPostTimeStamp","prevPostsCount","presentPostsCount","unreadToastProps","archiveToastProps","newMessagesToastText","archiveToastText","getNewMessageIndex","countUnreadsBelow","getAllPosts","allPosts","preparePostIdsForPostList","makePreparePostIdsForPostList","lastChannelViewTime","countCurrentChannelUnreadMessages","OVERSCAN_COUNT_BACKWARD","OVERSCAN_COUNT_FORWARD","HEIGHT_TRIGGER_FOR_MORE_POSTS","MAXIMUM_POSTS_FOR_SLICING","postListStyle","virtListStyles","PostList","START_OF_NEW_MESSAGES","dynamicListStyle","postMenuOpened","willChange","previousItemId","nextItemId","isDateLine","isStartOfNewMessages","basePaddingClass","getPreviousPostId","changeUnreadChunkTimeStamp","scrollDirection","scrollOffset","scrollUpdateWasRequested","didUserScrollForwards","offsetFromBottom","atOldestPost","checkBottom","_getRangeToRender","canLoadMorePosts","AFTER_ID","updateAtBottom","isAtBottom","visibleTopItem","topPostId","getLatestPostId","visibleStartIndex","newMessagesSeparatorIndex","channelIntroMessage","initScrollCompleted","postListRef","initRangeToRender","postIndex","getNewMessagesSeparatorIndex","maxPostsForSlicing","handleWindowResize","getSnapshotBeforeUpdate","postsAddedAtTop","channelHeaderAdded","postListNode","previousScrollTop","previousScrollHeight","postlistScrollHeight","scrollValue","newPostListIds","autoRetryEnable","latestAriaLabelFunc","renderToasts","itemCount","itemData","itemKey","overscanCountForward","overscanCountBackward","initScrollToIndex","skipResizeClass","innerListStyle","loaderId","correctScrollToBottom","onItemsRendered","scrollToFailed","isFirstLoad","markChannelAsReadAndViewed","loadingOlderPosts","loadingNewerPosts","autoRetriesCount","callLoadPosts","prevChannelId","markChannelAsViewed","getOldestPostId","extraPagesLoaded","getLatestVisiblePostId","getPostsAfter","oldestPostId","getOldestVisiblePostId","getPostsBefore","loadingMorePosts","actionsForPostList","postsOnLoad","formattedPostIds","postsInChannel","memoizedGetLatestPostId","getPostsChunkAroundPost","makeGetPostsChunkAroundPost","chunk","unreadChunkTimeStamp","getUnreadPostsChunk","getRecentPostsChunkInChannel","oldest","indicateNewMessages","latestPost","PostView","loaderForChangeOfPostsChunk","channelLoading","teamMemberships","isChannelLoading","TutorialIntroScreens","createScreenOne","createScreenTwo","createScreenThree","circles","createCircles","appDownloadImage","AppIcons","inviteModalLink","inviteText","restrictTeamInvite","supportInfo","supportEmail","createScreen","TutorialView","isRoot","townSquare","SupportEmail","ChannelView","deferredPostView","createDeferredPostView","channelView","dur1","measure","dur2","clearMarks","round","showTutorial","deactivatedChannel","onClickCloseChannel","DeferredPostView","PreRenderComponent","DeferredRenderWrapper","shouldRender","hoistStatics","deferComponentRender","getDeactivatedChannel","INTRO_SCREENS","ChannelIdentifierRouter","replaceUrlTimeout","replaceUrlIfPermalink","CenterChannel","lastReturnTo","lastChannelPath","lhsOpen","rhsMenuOpen","FaviconTitleHandler","currentSiteName","mentionTitle","unreadTitle","link16x16","link32x32","link96x96","redDotFavicon16x16","redDotFavicon32x32","redDotFavicon96x96","favicon16x16","favicon32x32","favicon96x96","lastBadgesActive","updateTitle","setBadgesActiveAndFavicon","updateFavicon","ChannelController","pathName","fetchingChannels","useLegacyLHS","platform","PreferredTeamSidebar","PreferredSidebar","LazyBackstageController","BackstageController","wakeUpInterval","lastTime","blurTime","loadProfilesForDirect","initTeam","setPreviousTeamId","finishedFetchingChannels","loadStatusesForChannelAndSidebar","teamsList","replyTextbox","mfaRequired","updateCurrentTeam","prevTeam","joinTeam","startPeriodicStatusUpdates","iNoBounce","onShortcutKeyDown","disable","renderProps","redirect","sanitizedUrl","TEAM_NOT_FOUND","previousTriggerId","subscribe","require","Redux","ReactRedux","ReactBootstrap","formatText","PDFJS","openInteractiveDialog","WebappUtils","remover","IntlProvider","setAcceptLanguage","loadTranslationsIfNecessary","localeInfo","I18n","setLocalizeFunction","handleLocaleChange","shouldShowTermsOfService","DiagnosticsEnabled","NoAccounts","DiagnosticId"],"mappings":"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","file":"6.3d18c1e121dd440fe7cc.js","sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {injectIntl} from 'react-intl';\nimport PropTypes from 'prop-types';\nimport marked from 'marked';\n\nimport {intlShape} from 'utils/react_intl';\n\nconst TARGET_BLANK_URL_PREFIX = '!';\n\nexport class CustomRenderer extends marked.Renderer {\n    constructor(disableLinks = false) {\n        super();\n        this.disableLinks = disableLinks;\n    }\n\n    link(href, title, text) {\n        if (this.disableLinks) {\n            return text;\n        }\n        if (href[0] === TARGET_BLANK_URL_PREFIX) {\n            return `<a href=\"${href.substring(1, href.length)}\" rel=\"noreferrer\" target=\"_blank\">${text}</a>`;\n        }\n        return `<a href=\"${href}\">${text}</a>`;\n    }\n\n    paragraph(text) {\n        return text;\n    }\n}\n\n/*\n* Translations component with the same API as react-intl's <FormattedMessage> component except the message string\n* accepts markdown. It supports the following non-block-level markdown:\n* - *italic*\n* - **bold**\n* - `inline code`\n* - ~~strikethrough~~\n* - [link](http://example.com/)\n* - [link in new tab](!http://example.com/)\n* - line\\nbreaks\n*\n* Note: Line breaks (\\n) in a defaultMessage parameter string must be surrounded by curly brackets {} in JSX. Example:\n* <FormattedMarkdownMessage id='my.example' defaultMessage={'first line\\nsecond line'} />\n*/\nclass FormattedMarkdownMessage extends React.PureComponent {\n    static defaultProps = {\n        disableLinks: false\n    };\n\n    static get propTypes() {\n        return {\n            intl: intlShape.isRequired,\n            id: PropTypes.string.isRequired,\n            defaultMessage: PropTypes.string.isRequired,\n            values: PropTypes.object,\n            disableLinks: PropTypes.bool,\n        };\n    }\n\n    render() {\n        const origMsg = this.props.intl.formatMessage({\n            id: this.props.id,\n            defaultMessage: this.props.defaultMessage,\n        }, this.props.values);\n\n        const markedUpMessage = marked(origMsg, {\n            breaks: true,\n            sanitize: true,\n            renderer: new CustomRenderer(this.props.disableLinks),\n        });\n\n        return (<span dangerouslySetInnerHTML={{__html: markedUpMessage}}/>);\n    }\n}\n\nexport default injectIntl(FormattedMarkdownMessage);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {OverlayTrigger as BaseOverlayTrigger, OverlayTriggerProps} from 'react-bootstrap';\nimport {IntlContext, IntlShape} from 'react-intl';\n\nexport {BaseOverlayTrigger};\n\ntype Props = OverlayTriggerProps;\n\nconst OverlayTrigger = React.forwardRef((props: Props, ref?: React.Ref<BaseOverlayTrigger>) => {\n    const {overlay, ...otherProps} = props;\n\n    // The overlay is rendered outside of the regular React context, and our version react-bootstrap can't forward\n    // that context itself, so we have to manually forward the react-intl context to this component's child.\n    const OverlayWrapper = ({intl, ...overlayProps}: {intl: IntlShape}) => (\n        <IntlContext.Provider value={intl}>\n            {React.cloneElement(overlay, overlayProps)}\n        </IntlContext.Provider>\n    );\n\n    return (\n        <IntlContext.Consumer>\n            {(intl): React.ReactNode => (\n                <BaseOverlayTrigger\n                    {...otherProps}\n                    ref={ref}\n                    overlay={\n                        <OverlayWrapper\n                            {...overlay.props}\n                            intl={intl}\n                        />\n                    }\n                />\n            )}\n        </IntlContext.Consumer>\n    );\n});\n\nOverlayTrigger.defaultProps = {\n    defaultOverlayShown: false,\n    trigger: ['hover', 'focus']\n};\nOverlayTrigger.displayName = 'OverlayTrigger';\n\nexport default OverlayTrigger;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {ReactNode} from 'react';\nimport {FormattedMessage} from 'react-intl';\n\ntype Props = {\n    position: 'absolute' | 'fixed' | 'relative' | 'static' | 'inherit';\n    style?: object;\n    message?: ReactNode;\n}\n\nexport default class LoadingScreen extends React.Component<Props> {\n    public static defaultProps: Partial<Props> = {\n        position: 'relative',\n        style: {},\n    }\n\n    public constructor(props: Props) {\n        super(props);\n        this.state = {};\n    }\n\n    public render(): JSX.Element {\n        let message: ReactNode = (\n            <FormattedMessage\n                id='loading_screen.loading'\n                defaultMessage='Loading'\n            />\n        );\n\n        if (this.props.message) {\n            message = this.props.message;\n        }\n\n        return (\n            <div\n                className='loading-screen'\n                style={{position: this.props.position, ...this.props.style}}\n            >\n                <div className='loading__content'>\n                    <h3>\n                        {message}\n                    </h3>\n                    <div className='round round-1'/>\n                    <div className='round round-2'/>\n                    <div className='round round-3'/>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\n\nimport MenuWrapper from '../../menu_wrapper';\nimport Menu from '../../menu';\nimport SubMenuItem from '../../menu_items/submenu_item';\n\nimport * as Utils from 'utils/utils.jsx';\n\nimport './submenu_modal.scss';\n\ntype Props = {\n    elements?: (React.ComponentProps<typeof SubMenuItem>)[];\n    onHide: () => void;\n}\n\ntype State = {\n    show: boolean;\n}\n\nexport default class SubMenuModal extends React.PureComponent<Props, State> {\n    public constructor(props: Props) {\n        super(props);\n        this.state = {\n            show: true,\n        };\n    }\n\n    public onHide = () => { //public because it is used on tests\n        this.setState({show: false});\n    }\n\n    public render() {\n        let SubMenuItems;\n        if (this.props.elements) {\n            SubMenuItems = this.props.elements.map((element) => {\n                return (\n                    <Menu.ItemSubMenu\n                        key={element.id}\n                        id={element.id}\n                        text={element.text}\n                        subMenu={element.subMenu}\n                        action={element.action}\n                        filter={element.filter}\n                        xOffset={0}\n                        root={false}\n                    />\n                );\n            });\n        }\n        return (\n            <Modal\n                dialogClassName={'SubMenuModal a11y__modal mobile-sub-menu'}\n                show={this.state.show}\n                onHide={this.onHide}\n                onExited={this.props.onHide}\n                enforceFocus={false}\n                id='submenuModal'\n                role='dialog'\n            >\n                <Modal.Body\n                    onClick={this.onHide}\n                >\n                    <MenuWrapper>\n                        <Menu\n                            openLeft={true}\n                            ariaLabel={Utils.localizeMessage('post_info.submenu.mobile', 'mobile submenu').toLowerCase()}\n                        >\n                            {SubMenuItems}\n                        </Menu>\n                        <div/>\n                    </MenuWrapper>\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {batchActions} from 'redux-batched-actions';\n\nimport {\n    createDirectChannel,\n    fetchMyChannelsAndMembers,\n    getChannelByNameAndTeamName,\n    getChannelStats,\n    selectChannel,\n} from 'mattermost-redux/actions/channels';\nimport {logout, loadMe} from 'mattermost-redux/actions/users';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getCurrentTeamId, getMyTeams, getTeam, getMyTeamMember, getTeamMemberships} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentUser, getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getCurrentChannelStats, getCurrentChannelId, getMyChannelMember, getRedirectChannelNameForTeam, getChannelsNameMapInTeam} from 'mattermost-redux/selectors/entities/channels';\nimport {ChannelTypes} from 'mattermost-redux/action_types';\n\nimport {browserHistory} from 'utils/browser_history';\nimport {handleNewPost} from 'actions/post_actions.jsx';\nimport {stopPeriodicStatusUpdates} from 'actions/status_actions.jsx';\nimport {loadProfilesForSidebar} from 'actions/user_actions.jsx';\nimport {closeRightHandSide, closeMenu as closeRhsMenu, updateRhsState} from 'actions/views/rhs';\nimport {clearUserCookie} from 'actions/views/cookie';\nimport {close as closeLhs} from 'actions/views/lhs';\nimport * as WebsocketActions from 'actions/websocket_actions.jsx';\nimport AppDispatcher from 'dispatcher/app_dispatcher.jsx';\nimport {getCurrentLocale} from 'selectors/i18n';\nimport {getIsRhsOpen, getRhsState} from 'selectors/rhs';\nimport BrowserStore from 'stores/browser_store.jsx';\nimport store from 'stores/redux_store.jsx';\nimport LocalStorageStore from 'stores/local_storage_store';\nimport WebSocketClient from 'client/web_websocket_client.jsx';\n\nimport {ActionTypes, Constants, PostTypes, RHSStates, ModalIdentifiers} from 'utils/constants';\nimport {filterAndSortTeamsByDisplayName} from 'utils/team_utils.jsx';\nimport * as Utils from 'utils/utils.jsx';\nimport SubMenuModal from '../components/widgets/menu/menu_modals/submenu_modal/submenu_modal';\n\nimport {openModal} from './views/modals';\n\nconst dispatch = store.dispatch;\nconst getState = store.getState;\n\nexport function emitChannelClickEvent(channel) {\n    async function userVisitedFakeChannel(chan, success, fail) {\n        const state = getState();\n        const currentUserId = getCurrentUserId(state);\n        const otherUserId = Utils.getUserIdFromChannelName(chan);\n        const {data: receivedChannel} = await createDirectChannel(currentUserId, otherUserId)(dispatch, getState);\n        if (receivedChannel) {\n            success(receivedChannel);\n        } else {\n            fail();\n        }\n    }\n    function switchToChannel(chan) {\n        const state = getState();\n        const userId = getCurrentUserId(state);\n        const teamId = chan.team_id || getCurrentTeamId(state);\n        const isRHSOpened = getIsRhsOpen(state);\n        const isPinnedPostsShowing = getRhsState(state) === RHSStates.PIN;\n        const member = getMyChannelMember(state, chan.id);\n\n        dispatch(getChannelStats(chan.id));\n\n        if (chan.delete_at === 0) {\n            const penultimate = LocalStorageStore.getPreviousChannelName(userId, teamId);\n            if (penultimate !== chan.name) {\n                LocalStorageStore.setPenultimateChannelName(userId, teamId, penultimate);\n                LocalStorageStore.setPreviousChannelName(userId, teamId, chan.name);\n            }\n        }\n\n        // When switching to a different channel if the pinned posts is showing\n        // Update the RHS state to reflect the pinned post of the selected channel\n        if (isRHSOpened && isPinnedPostsShowing) {\n            dispatch(updateRhsState(RHSStates.PIN, chan.id));\n        }\n\n        loadProfilesForSidebar();\n\n        dispatch(batchActions([{\n            type: ChannelTypes.SELECT_CHANNEL,\n            data: chan.id,\n        }, {\n            type: ActionTypes.SELECT_CHANNEL_WITH_MEMBER,\n            data: chan.id,\n            channel: chan,\n            member: member || {},\n        }]));\n    }\n\n    if (channel.fake) {\n        userVisitedFakeChannel(\n            channel,\n            (data) => {\n                switchToChannel(data);\n            },\n            () => {\n                browserHistory.push('/' + this.state.currentTeam.name);\n            }\n        );\n    } else {\n        switchToChannel(channel);\n    }\n}\n\nexport function updateNewMessagesAtInChannel(channelId, last_viewed_at = Date.now()) {\n    return {\n        type: ActionTypes.UPDATE_CHANNEL_LAST_VIEWED_AT,\n        channel_id: channelId,\n        last_viewed_at,\n    };\n}\n\nexport function emitCloseRightHandSide() {\n    dispatch(closeRightHandSide());\n}\n\nexport function toggleShortcutsModal() {\n    AppDispatcher.handleViewAction({\n        type: ActionTypes.TOGGLE_SHORTCUTS_MODAL,\n        value: true,\n    });\n}\n\nexport function showChannelPurposeUpdateModal(channel) {\n    AppDispatcher.handleViewAction({\n        type: ActionTypes.TOGGLE_CHANNEL_PURPOSE_UPDATE_MODAL,\n        value: true,\n        channel,\n    });\n}\n\nexport function showChannelNameUpdateModal(channel) {\n    AppDispatcher.handleViewAction({\n        type: ActionTypes.TOGGLE_CHANNEL_NAME_UPDATE_MODAL,\n        value: true,\n        channel,\n    });\n}\n\nexport function showGetPublicLinkModal(fileId) {\n    AppDispatcher.handleViewAction({\n        type: ActionTypes.TOGGLE_GET_PUBLIC_LINK_MODAL,\n        value: true,\n        fileId,\n    });\n}\n\nexport function showGetTeamInviteLinkModal() {\n    AppDispatcher.handleViewAction({\n        type: Constants.ActionTypes.TOGGLE_GET_TEAM_INVITE_LINK_MODAL,\n        value: true,\n    });\n}\n\nexport function showLeavePrivateChannelModal(channel) {\n    AppDispatcher.handleViewAction({\n        type: ActionTypes.TOGGLE_LEAVE_PRIVATE_CHANNEL_MODAL,\n        value: channel,\n    });\n}\n\nexport function showMobileSubMenuModal(elements) {\n    const submenuModalData = {\n        ModalId: ModalIdentifiers.MOBILE_SUBMENU,\n        dialogType: SubMenuModal,\n        dialogProps: {\n            elements,\n        },\n    };\n\n    dispatch(openModal(submenuModalData));\n}\n\nexport function sendEphemeralPost(message, channelId, parentId) {\n    const timestamp = Utils.getTimestamp();\n    const post = {\n        id: Utils.generateId(),\n        user_id: '0',\n        channel_id: channelId || getCurrentChannelId(getState()),\n        message,\n        type: PostTypes.EPHEMERAL,\n        create_at: timestamp,\n        update_at: timestamp,\n        root_id: parentId,\n        parent_id: parentId,\n        props: {},\n    };\n\n    dispatch(handleNewPost(post));\n}\n\nexport function sendAddToChannelEphemeralPost(user, addedUsername, addedUserId, channelId, postRootId = '', timestamp) {\n    const post = {\n        id: Utils.generateId(),\n        user_id: user.id,\n        channel_id: channelId || getCurrentChannelId(getState()),\n        message: '',\n        type: PostTypes.EPHEMERAL_ADD_TO_CHANNEL,\n        create_at: timestamp,\n        update_at: timestamp,\n        root_id: postRootId,\n        parent_id: postRootId,\n        props: {\n            username: user.username,\n            addedUsername,\n            addedUserId,\n        },\n    };\n\n    dispatch(handleNewPost(post));\n}\n\nlet lastTimeTypingSent = 0;\nexport function emitLocalUserTypingEvent(channelId, parentPostId) {\n    const userTyping = async (actionDispatch, actionGetState) => {\n        const state = actionGetState();\n        const config = getConfig(state);\n        const t = Date.now();\n        const stats = getCurrentChannelStats(state);\n        const membersInChannel = stats ? stats.member_count : 0;\n\n        if (((t - lastTimeTypingSent) > config.TimeBetweenUserTypingUpdatesMilliseconds) &&\n            (membersInChannel < config.MaxNotificationsPerChannel) && (config.EnableUserTypingMessages === 'true')) {\n            WebSocketClient.userTyping(channelId, parentPostId);\n            lastTimeTypingSent = t;\n        }\n\n        return {data: true};\n    };\n\n    return dispatch(userTyping);\n}\n\nexport function emitUserLoggedOutEvent(redirectTo = '/', shouldSignalLogout = true, userAction = true) {\n    // If the logout was intentional, discard knowledge about having previously been logged in.\n    // This bit is otherwise used to detect session expirations on the login page.\n    if (userAction) {\n        LocalStorageStore.setWasLoggedIn(false);\n    }\n\n    dispatch(logout()).then(() => {\n        if (shouldSignalLogout) {\n            BrowserStore.signalLogout();\n        }\n\n        BrowserStore.clear();\n        stopPeriodicStatusUpdates();\n        WebsocketActions.close();\n\n        clearUserCookie();\n\n        browserHistory.push(redirectTo);\n    }).catch(() => {\n        browserHistory.push(redirectTo);\n    });\n}\n\nexport function toggleSideBarRightMenuAction() {\n    return (doDispatch) => {\n        doDispatch(closeRightHandSide());\n        doDispatch(closeLhs());\n        doDispatch(closeRhsMenu());\n    };\n}\n\nexport function emitBrowserFocus(focus) {\n    dispatch({\n        type: ActionTypes.BROWSER_CHANGE_FOCUS,\n        focus,\n    });\n}\n\nasync function getTeamRedirectChannelIfIsAccesible(user, team) {\n    let state = getState();\n    let channel = null;\n\n    const myMember = getMyTeamMember(state, team.id);\n    if (!myMember || Object.keys(myMember).length === 0) {\n        return null;\n    }\n\n    let teamChannels = getChannelsNameMapInTeam(state, team.id);\n    if (!teamChannels || Object.keys(teamChannels).length === 0) {\n        // This should be executed in pretty limited scenarios (empty teams)\n        await dispatch(fetchMyChannelsAndMembers(team.id)); // eslint-disable-line no-await-in-loop\n        state = getState();\n        teamChannels = getChannelsNameMapInTeam(state, team.id);\n    }\n\n    let channelName = LocalStorageStore.getPreviousChannelName(user.id, team.id);\n    channel = teamChannels[channelName];\n    let channelMember = getMyChannelMember(state, channel && channel.id);\n\n    if (!channel || !channelMember) {\n        // This should be executed in pretty limited scenarios (when the last visited channel in the team has been removed)\n        await dispatch(getChannelByNameAndTeamName(team.name, channelName)); // eslint-disable-line no-await-in-loop\n        state = getState();\n        teamChannels = getChannelsNameMapInTeam(state, team.id);\n        channel = teamChannels[channelName];\n        channelMember = getMyChannelMember(state, channel && channel.id);\n    }\n\n    if (!channel || !channelMember) {\n        channelName = getRedirectChannelNameForTeam(state, team.id);\n        channel = teamChannels[channelName];\n        channelMember = getMyChannelMember(state, channel && channel.id);\n    }\n\n    if (channel && channelMember) {\n        return channel;\n    }\n    return null;\n}\n\nexport async function redirectUserToDefaultTeam() {\n    let state = getState();\n\n    // Assume we need to load the user if they don't have any team memberships loaded or the user loaded\n    let user = getCurrentUser(state);\n    const shouldLoadUser = Utils.isEmptyObject(getTeamMemberships(state)) || !user;\n\n    if (shouldLoadUser) {\n        await dispatch(loadMe());\n        state = getState();\n        user = getCurrentUser(state);\n    }\n\n    if (!user) {\n        return;\n    }\n\n    const locale = getCurrentLocale(state);\n    const teamId = LocalStorageStore.getPreviousTeamId(user.id);\n\n    let myTeams = getMyTeams(state);\n    if (myTeams.length === 0) {\n        browserHistory.push('/select_team');\n        return;\n    }\n\n    const team = getTeam(state, teamId);\n    if (team) {\n        const channel = await getTeamRedirectChannelIfIsAccesible(user, team);\n        if (channel) {\n            dispatch(selectChannel(channel.id));\n            browserHistory.push(`/${team.name}/channels/${channel.name}`);\n            return;\n        }\n    }\n\n    myTeams = filterAndSortTeamsByDisplayName(myTeams, locale);\n\n    for (const myTeam of myTeams) {\n        // This should execute async behavior in a pretty limited set of situations, so shouldn't be a problem\n        const channel = await getTeamRedirectChannelIfIsAccesible(user, myTeam); // eslint-disable-line no-await-in-loop\n        if (channel) {\n            dispatch(selectChannel(channel.id));\n            browserHistory.push(`/${myTeam.name}/channels/${channel.name}`);\n            return;\n        }\n    }\n\n    browserHistory.push('/select_team');\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\n\n// Prop types copied from the old version of\n\nexport const intlConfigPropTypes = {\n    locale: PropTypes.string,\n    timeZone: PropTypes.string,\n    formats: PropTypes.object,\n    messages: PropTypes.object,\n    textComponent: PropTypes.any,\n\n    defaultLocale: PropTypes.string,\n    defaultFormats: PropTypes.object,\n\n    onError: PropTypes.func,\n};\n\nexport const intlFormatPropTypes = {\n    formatDate: PropTypes.func.isRequired,\n    formatTime: PropTypes.func.isRequired,\n    formatRelativeTime: PropTypes.func.isRequired,\n    formatNumber: PropTypes.func.isRequired,\n    formatPlural: PropTypes.func.isRequired,\n    formatMessage: PropTypes.func.isRequired,\n    formatHTMLMessage: PropTypes.func.isRequired,\n};\n\nexport const intlShape = PropTypes.shape({\n    ...intlConfigPropTypes,\n    ...intlFormatPropTypes,\n    formatters: PropTypes.object,\n});\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\ntype Props = {\n\n    /*\n     * Set to show modal\n     */\n    show: boolean;\n\n    /*\n     * Title to use for the modal\n     */\n    title?: React.ReactNode;\n\n    /*\n     * Message to display in the body of the modal\n     */\n    message?: React.ReactNode;\n\n    /*\n     * The CSS class to apply to the confirm button\n     */\n    confirmButtonClass?: string;\n\n    /*\n     * The CSS class to apply to the modal\n     */\n    modalClass?: string;\n\n    /*\n     * Text/jsx element on the confirm button\n     */\n    confirmButtonText?: React.ReactNode;\n\n    /*\n     * Text/jsx element on the cancel button\n     */\n    cancelButtonText?: React.ReactNode;\n\n    /*\n     * Set to show checkbox\n     */\n    showCheckbox?: boolean;\n\n    /*\n     * Text/jsx element to display with the checkbox\n     */\n    checkboxText?: React.ReactNode;\n\n    /*\n     * Function called when the confirm button or ENTER is pressed. Passes `true` if the checkbox is checked\n     */\n    onConfirm: (checked: boolean) => void;\n\n    /*\n     * Function called when the cancel button is pressed or the modal is hidden. Passes `true` if the checkbox is checked\n     */\n    onCancel: (checked: boolean) => void;\n\n    /**\n     * Function called when modal is dismissed\n     */\n    onExited?: () => void;\n\n    /*\n     * Set to hide the cancel button\n     */\n    hideCancel?: boolean;\n};\n\ntype State = {\n    checked: boolean;\n}\n\nexport default class ConfirmModal extends React.Component<Props, State> {\n    static defaultProps = {\n        title: '',\n        message: '',\n        confirmButtonClass: 'btn btn-primary',\n        confirmButtonText: '',\n        modalClass: '',\n    }\n\n    constructor(props: Props) {\n        super(props);\n\n        this.state = {\n            checked: false,\n        };\n    }\n\n    componentDidMount() {\n        if (this.props.show) {\n            document.addEventListener('keydown', this.handleKeypress);\n        }\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleKeypress);\n    }\n\n    shouldComponentUpdate(nextProps: Props, nextState: State) {\n        return (\n            nextProps.show !== this.props.show ||\n            nextState.checked !== this.state.checked\n        );\n    }\n\n    componentDidUpdate(prevProps: Props) {\n        if (prevProps.show && !this.props.show) {\n            document.removeEventListener('keydown', this.handleKeypress);\n        } else if (!prevProps.show && this.props.show) {\n            document.addEventListener('keydown', this.handleKeypress);\n        }\n    }\n\n    handleKeypress = (e: KeyboardEvent) => {\n        if (e.key === 'Enter' && this.props.show) {\n            const cancelButton = document.getElementById('cancelModalButton');\n            if (cancelButton && cancelButton === document.activeElement) {\n                this.handleCancel();\n            } else {\n                this.handleConfirm();\n            }\n        }\n    }\n\n    handleCheckboxChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        this.setState({checked: e.target.checked});\n    }\n\n    handleConfirm = () => {\n        this.props.onConfirm(this.state.checked);\n    }\n\n    handleCancel = () => {\n        this.props.onCancel(this.state.checked);\n    }\n\n    render() {\n        let checkbox;\n        if (this.props.showCheckbox) {\n            checkbox = (\n                <div className='checkbox text-right mb-0'>\n                    <label>\n                        <input\n                            type='checkbox'\n                            onChange={this.handleCheckboxChange}\n                            checked={this.state.checked}\n                        />\n                        {this.props.checkboxText}\n                    </label>\n                </div>\n            );\n        }\n\n        let cancelText;\n        if (this.props.cancelButtonText) {\n            cancelText = this.props.cancelButtonText;\n        } else {\n            cancelText = (\n                <FormattedMessage\n                    id='confirm_modal.cancel'\n                    defaultMessage='Cancel'\n                />\n            );\n        }\n\n        let cancelButton;\n        if (!this.props.hideCancel) {\n            cancelButton = (\n                <button\n                    type='button'\n                    className='btn btn-link btn-cancel'\n                    onClick={this.handleCancel}\n                    id='cancelModalButton'\n                >\n                    {cancelText}\n                </button>\n            );\n        }\n\n        return (\n            <Modal\n                className={'modal-confirm ' + this.props.modalClass}\n                dialogClassName='a11y__modal'\n                show={this.props.show}\n                onHide={this.props.onCancel}\n                onExited={this.props.onExited}\n                id='confirmModal'\n                role='dialog'\n                aria-labelledby='confirmModalLabel'\n            >\n                <Modal.Header closeButton={false}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='confirmModalLabel'\n                    >\n                        {this.props.title}\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    {this.props.message}\n                    {checkbox}\n                </Modal.Body>\n                <Modal.Footer>\n                    {cancelButton}\n                    <button\n                        autoFocus={true}\n                        type='button'\n                        className={this.props.confirmButtonClass}\n                        onClick={this.handleConfirm}\n                        id='confirmModalButton'\n                    >\n                        {this.props.confirmButtonText}\n                    </button>\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport * as Utils from 'utils/utils.jsx';\nimport {showMobileSubMenuModal} from 'actions/global_actions';\n\nimport './menu_item.scss';\n\n// Requires an object conforming to a submenu structure passed to registerPostDropdownSubMenuAction\n// of the form:\n// {\n//     \"id\": \"A\",\n//     \"parentMenuId\": null,\n//     \"text\": \"A text\",\n//     \"subMenu\": [\n//         {\n//             \"id\": \"B\",\n//             \"parentMenuId\": \"A\",\n//             \"text\": \"B text\"\n//             \"subMenu\": [],\n//             \"action\": () => {},\n//             \"filter\": () => {},\n//         }\n//     ],\n//     \"action\": () => {},\n//     \"filter\": () => {},\n// }\n// Submenus can contain Submenus as well\n\ntype Props = {\n    id?: string;\n    postId?: string;\n    text: React.ReactNode;\n    subMenu?: Props[];\n    icon?: React.ReactNode;\n    action?: (id?: string) => {};\n    filter?: (id?: string) => {};\n    xOffset?: number;\n    ariaLabel?: string;\n    root?: boolean;\n    show?: boolean;\n}\n\ntype State = {\n    show: boolean;\n}\n\nexport default class SubMenuItem extends React.PureComponent<Props, State> {\n    private node: React.RefObject<any>;\n\n    public static defaultProps = {\n        show: true,\n    };\n\n    public constructor(props: Props) {\n        super(props);\n        this.node = React.createRef();\n\n        this.state = {\n            show: false,\n        };\n    }\n\n    private show = () => {\n        this.setState({show: true});\n    }\n\n    private hide = () => {\n        this.setState({show: false});\n    }\n\n    private onClick = (event: React.MouseEvent<HTMLElement>) => {\n        const {id, postId, subMenu, action, root} = this.props;\n        const isMobile = Utils.isMobile();\n        const pathPair = Object.entries(event.nativeEvent).find(([key, value]) => key === 'path');\n        let path: HTMLElement[] | undefined;\n        if (pathPair) {\n            path = pathPair[1];\n        }\n        if (isMobile) {\n            if (subMenu && subMenu.length) { // if contains a submenu, call openModal with it\n                if (!root) { //required to close only the original menu\n                    event.stopPropagation();\n                }\n                showMobileSubMenuModal(subMenu);\n            } else if (action) { // leaf node in the tree handles action only\n                action(postId);\n            }\n        } else if (path && // the first 2 elements in path match original event id\n            path.slice(0, 2).find((e) => e.id === id) &&\n            action) {\n            action(postId);\n        } else if (!path && !event.nativeEvent.composedPath && action) { //for tests only that don't contain `path` or `composedPath`\n            action(postId);\n        } else if (!path && (event.nativeEvent.composedPath() as HTMLElement[]).slice(0, 2).find((e) => e.id === id) && action) {\n            action(postId);\n        }\n    }\n\n    public render() {\n        const {id, postId, text, subMenu, root, icon, filter, xOffset, ariaLabel} = this.props;\n        const isMobile = Utils.isMobile();\n\n        if (filter && !filter(id)) {\n            return ('');\n        }\n\n        let textProp = text;\n        if (icon) {\n            textProp = (\n                <React.Fragment>\n                    <span className='icon'>{icon}</span>\n                    {text}\n                </React.Fragment>\n            );\n        }\n\n        const hasSubmenu = subMenu && subMenu.length;\n        const parentWidth = this.node && this.node.current ? this.node.current.getBoundingClientRect().width : 0;\n        const childOffset = (React.isValidElement(text)) ? 20 : 0;\n        const offset = (root ? 2 : childOffset);\n        const subMenuStyle = {\n            visibility: (this.state.show && hasSubmenu && !isMobile ? 'visible' : 'hidden') as 'visible' | 'hidden',\n            right: (parseInt(String(xOffset), 10) - offset) + 'px',\n        };\n\n        let subMenuContent: React.ReactNode = '';\n\n        if (!isMobile) {\n            subMenuContent = (\n                <ul\n                    className={'a11y__popup Menu dropdown-menu SubMenu'}\n                    style={subMenuStyle}\n                >\n                    {hasSubmenu ? subMenu!.map((s) => {\n                        return (\n                            <SubMenuItem\n                                key={s.id}\n                                id={s.id}\n                                postId={postId}\n                                text={s.text}\n                                subMenu={s.subMenu}\n                                action={s.action}\n                                filter={s.filter}\n                                xOffset={parentWidth}\n                                ariaLabel={ariaLabel}\n                                root={false}\n                            />\n                        );\n                    }) : ''}\n                </ul>\n            );\n        }\n\n        return (\n            <li\n                className={'SubMenuItem MenuItem'}\n                role='menuitem'\n                id={id + '_menuitem'}\n                ref={this.node}\n            >\n                <div\n                    id={id}\n                    aria-label={ariaLabel}\n                    onMouseEnter={this.show}\n                    onMouseLeave={this.hide}\n                    onClick={this.onClick}\n                >\n                    <span\n                        id={'channelHeaderDropdownIconLeft_' + id}\n                        className={'fa fa-angle-left SubMenu__icon-left' + (hasSubmenu && !isMobile ? '' : '-empty' + (isMobile ? ' mobile' : ''))}\n                        aria-label={Utils.localizeMessage('post_info.submenu.icon', 'submenu icon').toLowerCase()}\n                    />\n                    {textProp}\n                    <span\n                        id={'channelHeaderDropdownIconRight_' + id}\n                        className={'fa fa-angle-right SubMenu__icon-right' + (hasSubmenu && isMobile ? '' : '-empty')}\n                        aria-label={Utils.localizeMessage('post_info.submenu.icon', 'submenu icon').toLowerCase()}\n                    />\n                    {subMenuContent}\n                </div>\n            </li>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport './menu_group.scss';\n\ntype Props = {\n    divider?: React.ReactNode;\n    children?: React.ReactNode;\n}\n\nexport default class MenuGroup extends React.PureComponent<Props> {\n    handleDividerClick = (e: React.MouseEvent) => {\n        e.preventDefault();\n        e.stopPropagation();\n    }\n\n    public render() {\n        const {children} = this.props;\n\n        const divider = this.props.divider || (\n            <li\n                className='MenuGroup menu-divider'\n                onClick={this.handleDividerClick}\n            />\n        );\n\n        return (\n            <React.Fragment>\n                {divider}\n                {children}\n            </React.Fragment>\n        );\n    }\n}","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport menuItem from './menu_item';\n\ntype Props = {\n    onClick: (e: React.MouseEvent) => void;\n    ariaLabel?: string;\n    text: React.ReactNode;\n    extraText?: string;\n    id?: string;\n    buttonClass?: string;\n    isDangerous?: boolean;\n}\nexport const MenuItemActionImpl = ({onClick, ariaLabel, text, extraText, id, buttonClass, isDangerous}: Props) => (\n    <button\n        data-testid={id}\n        id={id}\n        aria-label={ariaLabel}\n        className={'style--none' + (extraText ? ' MenuItem__with-help' : '') + (buttonClass ? ' ' + buttonClass : '') + (isDangerous ? ' MenuItem__dangerous' : '')}\n        onClick={onClick}\n    >\n        {text && <span className='MenuItem__primary-text'>{text}</span>}\n        {extraText && <span className='MenuItem__help-text'>{extraText}</span>}\n    </button>\n);\n\nconst MenuItemAction = menuItem(MenuItemActionImpl);\nMenuItemAction.displayName = 'MenuItemAction';\n\nexport default MenuItemAction;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport menuItem from './menu_item';\n\ntype Props = {\n    url: string;\n    text: React.ReactNode;\n    onClick?: (event: React.MouseEvent<HTMLElement>) => void;\n}\nexport const MenuItemExternalLinkImpl: React.FC<Props> = ({url, text, onClick}: Props) => (\n    <a\n        target='_blank'\n        rel='noopener noreferrer'\n        href={url}\n        onClick={onClick}\n    >\n        {text}\n    </a>\n);\n\nconst MenuItemExternalLink = menuItem(MenuItemExternalLinkImpl);\nMenuItemExternalLink.displayName = 'MenuItemExternalLink';\nexport default MenuItemExternalLink;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Link} from 'react-router-dom';\n\nimport menuItem from './menu_item';\n\ntype Props = {\n    to: string;\n    text: React.ReactNode;\n}\n\nexport const MenuItemLinkImpl: React.FC<Props> = ({to, text}: Props) => <Link to={to}><span className='MenuItem__primary-text'>{text}</span></Link>;\n\nconst MenuItemLink = menuItem(MenuItemLinkImpl);\nMenuItemLink.displayName = 'MenuItemLink';\n\nexport default MenuItemLink;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport ToggleModalButtonRedux from 'components/toggle_modal_button_redux';\n\nimport menuItem from './menu_item';\n\ntype Props = {\n    modalId: string;\n    dialogType: React.ComponentType<any>;\n    dialogProps?: object;\n    extraText?: string;\n    text: string;\n}\n\nexport const MenuItemToggleModalReduxImpl: React.FC<Props> = ({modalId, dialogType, dialogProps, text, extraText}: Props) => (\n    <ToggleModalButtonRedux\n        accessibilityLabel={text}\n        modalId={modalId}\n        dialogType={dialogType}\n        dialogProps={dialogProps}\n        className={extraText && 'MenuItem__with-help'}\n    >\n        {text && <span className='MenuItem__primary-text'>{text}</span>}\n        {extraText && <span className='MenuItem__help-text'>{extraText}</span>}\n    </ToggleModalButtonRedux>\n);\n\nconst MenuItemToggleModalRedux = menuItem(MenuItemToggleModalReduxImpl);\nMenuItemToggleModalRedux.displayName = 'MenuItemToggleModalRedux';\n\nexport default MenuItemToggleModalRedux;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {isMobile} from 'utils/utils';\n\nimport SubMenuItem from './menu_items/submenu_item';\n\nimport MenuGroup from './menu_group';\nimport MenuItemAction from './menu_items/menu_item_action';\nimport MenuItemExternalLink from './menu_items/menu_item_external_link';\nimport MenuItemLink from './menu_items/menu_item_link';\nimport MenuItemToggleModalRedux from './menu_items/menu_item_toggle_modal_redux';\n\nimport './menu.scss';\n\ntype Props = {\n    children?: React.ReactNode;\n    openLeft?: boolean;\n    openUp?: boolean;\n    id?: string;\n    ariaLabel: string;\n    customStyles?: object;\n}\n\nexport default class Menu extends React.PureComponent<Props> {\n    public static Group = MenuGroup\n    public static ItemAction = MenuItemAction\n    public static ItemExternalLink = MenuItemExternalLink\n    public static ItemLink = MenuItemLink\n    public static ItemToggleModalRedux = MenuItemToggleModalRedux\n    public static ItemSubMenu = SubMenuItem\n\n    public node: React.RefObject<HTMLUListElement>; //Public because it is used by tests\n    private observer: MutationObserver;\n\n    public constructor(props: Props) {\n        super(props);\n        this.node = React.createRef();\n        this.observer = new MutationObserver(this.hideUnneededDividers);\n    }\n\n    public hideUnneededDividers = () => { //Public because it is used by tests\n        if (this.node.current === null) {\n            return;\n        }\n\n        this.observer.disconnect();\n        const children = Object.values(this.node.current.children).slice(0, this.node.current.children.length) as HTMLElement[];\n\n        // Hiding dividers at beginning and duplicated ones\n        let prevWasDivider = false;\n        let isAtBeginning = true;\n        for (const child of children) {\n            if (child.classList.contains('menu-divider') || child.classList.contains('mobile-menu-divider')) {\n                child.style.display = 'block';\n                if (isAtBeginning || prevWasDivider) {\n                    child.style.display = 'none';\n                }\n                prevWasDivider = true;\n            } else {\n                isAtBeginning = false;\n                prevWasDivider = false;\n            }\n        }\n\n        // Hiding trailing dividers\n        for (const child of children.reverse()) {\n            if (child.classList.contains('menu-divider') || child.classList.contains('mobile-menu-divider')) {\n                child.style.display = 'none';\n            } else {\n                break;\n            }\n        }\n        this.observer.observe(this.node.current, {attributes: true, childList: true, subtree: true});\n    }\n\n    public componentDidMount() {\n        this.hideUnneededDividers();\n    }\n\n    public componentDidUpdate() {\n        this.hideUnneededDividers();\n    }\n\n    public componentWillUnmount() {\n        this.observer.disconnect();\n    }\n\n    // Used from DotMenu component to know in which direction show the menu\n    public rect() {\n        if (this.node && this.node.current) {\n            return this.node.current.getBoundingClientRect();\n        }\n        return null;\n    }\n\n    handleMenuClick = (e: React.MouseEvent) => {\n        if (e.target === this.node.current) {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n    }\n\n    public render() {\n        const {children, openUp, openLeft, id, ariaLabel, customStyles} = this.props;\n        let styles: React.CSSProperties = {};\n        if (customStyles) {\n            styles = customStyles;\n        } else {\n            if (openLeft && !isMobile()) {\n                styles.left = 'inherit';\n                styles.right = 0;\n            }\n            if (openUp && !isMobile()) {\n                styles.bottom = '100%';\n                styles.top = 'auto';\n            }\n        }\n\n        return (\n            <div\n                aria-label={ariaLabel}\n                className='a11y__popup Menu'\n                id={id}\n                role='menu'\n            >\n                <ul\n                    ref={this.node}\n                    style={styles}\n                    className='Menu__content dropdown-menu'\n                    onClick={this.handleMenuClick}\n                >\n                    {children}\n                </ul>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {ActionTypes} from 'utils/constants';\n\nexport function openModal(modalData) {\n    return (dispatch) => {\n        const action = {\n            type: ActionTypes.MODAL_OPEN,\n            modalId: modalData.modalId,\n            dialogProps: modalData.dialogProps,\n            dialogType: modalData.dialogType,\n        };\n\n        dispatch(action);\n        return {data: true};\n    };\n}\n\nexport function closeModal(modalId) {\n    return (dispatch) => {\n        const action = {\n            type: ActionTypes.MODAL_CLOSE,\n            modalId,\n        };\n\n        dispatch(action);\n        return {data: true};\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport * as AdminActions from 'mattermost-redux/actions/admin';\nimport * as UserActions from 'mattermost-redux/actions/users';\nimport * as TeamActions from 'mattermost-redux/actions/teams';\nimport {Client4} from 'mattermost-redux/client';\nimport {bindClientFunc} from 'mattermost-redux/actions/helpers';\n\nimport {emitUserLoggedOutEvent} from 'actions/global_actions.jsx';\nimport {getOnNavigationConfirmed} from 'selectors/views/admin';\nimport store from 'stores/redux_store.jsx';\nimport {ActionTypes} from 'utils/constants';\n\nconst dispatch = store.dispatch;\nconst getState = store.getState;\n\nexport async function reloadConfig(success, error) {\n    const {data, error: err} = await dispatch(AdminActions.reloadConfig());\n    if (data && success) {\n        dispatch(AdminActions.getConfig());\n        dispatch(AdminActions.getEnvironmentConfig());\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function adminResetMfa(userId, success, error) {\n    const {data, error: err} = await UserActions.updateUserMfa(userId, false)(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function getClusterStatus(success, error) {\n    const {data, error: err} = await AdminActions.getClusterStatus()(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function ldapTest(success, error) {\n    const {data, error: err} = await AdminActions.testLdap()(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function invalidateAllCaches(success, error) {\n    const {data, error: err} = await AdminActions.invalidateCaches()(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function recycleDatabaseConnection(success, error) {\n    const {data, error: err} = await AdminActions.recycleDatabase()(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function adminResetEmail(user, success, error) {\n    const {data, error: err} = await UserActions.patchUser(user)(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function samlCertificateStatus(success, error) {\n    const {data, error: err} = await AdminActions.getSamlCertificateStatus()(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport function getOAuthAppInfo(clientId) {\n    return bindClientFunc({\n        clientFunc: Client4.getOAuthAppInfo,\n        params: [clientId],\n    });\n}\n\nexport function allowOAuth2({responseType, clientId, redirectUri, state, scope}) {\n    return bindClientFunc({\n        clientFunc: Client4.authorizeOAuthApp,\n        params: [responseType, clientId, redirectUri, state, scope],\n    });\n}\n\nexport async function emailToLdap(loginId, password, token, ldapId, ldapPassword, success, error) {\n    const {data, error: err} = await UserActions.switchEmailToLdap(loginId, password, ldapId, ldapPassword, token)(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function emailToOAuth(loginId, password, token, newType, success, error) {\n    const {data, error: err} = await UserActions.switchEmailToOAuth(newType, loginId, password, token)(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function oauthToEmail(currentService, email, password, success, error) {\n    const {data, error: err} = await UserActions.switchOAuthToEmail(currentService, email, password)(dispatch, getState);\n    if (data) {\n        if (data.follow_link) {\n            emitUserLoggedOutEvent(data.follow_link);\n        }\n        if (success) {\n            success(data);\n        }\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function uploadBrandImage(brandImage, success, error) {\n    const {data, error: err} = await AdminActions.uploadBrandImage(brandImage)(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function deleteBrandImage(success, error) {\n    const {data, error: err} = await AdminActions.deleteBrandImage()(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function uploadPublicSamlCertificate(file, success, error) {\n    const {data, error: err} = await AdminActions.uploadPublicSamlCertificate(file)(dispatch, getState);\n    if (data && success) {\n        success('saml-public.crt');\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function uploadPrivateSamlCertificate(file, success, error) {\n    const {data, error: err} = await AdminActions.uploadPrivateSamlCertificate(file)(dispatch, getState);\n    if (data && success) {\n        success('saml-private.key');\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function uploadIdpSamlCertificate(file, success, error) {\n    const {data, error: err} = await AdminActions.uploadIdpSamlCertificate(file)(dispatch, getState);\n    if (data && success) {\n        success('saml-idp.crt');\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function removePublicSamlCertificate(success, error) {\n    const {data, error: err} = await AdminActions.removePublicSamlCertificate()(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function removePrivateSamlCertificate(success, error) {\n    const {data, error: err} = await AdminActions.removePrivateSamlCertificate()(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function removeIdpSamlCertificate(success, error) {\n    const {data, error: err} = await AdminActions.removeIdpSamlCertificate()(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function getStandardAnalytics(teamId) {\n    await AdminActions.getStandardAnalytics(teamId)(dispatch, getState);\n}\n\nexport async function getAdvancedAnalytics(teamId) {\n    await AdminActions.getAdvancedAnalytics(teamId)(dispatch, getState);\n}\n\nexport async function getBotPostsPerDayAnalytics(teamId) {\n    await AdminActions.getBotPostsPerDayAnalytics(teamId)(dispatch, getState);\n}\n\nexport async function getPostsPerDayAnalytics(teamId) {\n    await AdminActions.getPostsPerDayAnalytics(teamId)(dispatch, getState);\n}\n\nexport async function getUsersPerDayAnalytics(teamId) {\n    await AdminActions.getUsersPerDayAnalytics(teamId)(dispatch, getState);\n}\n\nexport async function elasticsearchTest(config, success, error) {\n    const {data, error: err} = await AdminActions.testElasticsearch(config)(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function testS3Connection(success, error) {\n    const {data, error: err} = await AdminActions.testS3Connection()(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function elasticsearchPurgeIndexes(success, error) {\n    const {data, error: err} = await AdminActions.purgeElasticsearchIndexes()(dispatch, getState);\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport function setNavigationBlocked(blocked) {\n    return {\n        type: ActionTypes.SET_NAVIGATION_BLOCKED,\n        blocked,\n    };\n}\n\nexport function deferNavigation(onNavigationConfirmed) {\n    return {\n        type: ActionTypes.DEFER_NAVIGATION,\n        onNavigationConfirmed,\n    };\n}\n\nexport function cancelNavigation() {\n    return {\n        type: ActionTypes.CANCEL_NAVIGATION,\n    };\n}\n\nexport function confirmNavigation() {\n    // have to rename these because of lint no-shadow\n    return (thunkDispatch, thunkGetState) => {\n        const callback = getOnNavigationConfirmed(thunkGetState());\n\n        if (callback) {\n            callback();\n        }\n\n        thunkDispatch({\n            type: ActionTypes.CONFIRM_NAVIGATION,\n        });\n    };\n}\n\nexport async function invalidateAllEmailInvites(success, error) {\n    const {data, error: err} = await dispatch(TeamActions.invalidateAllEmailInvites());\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function testSmtp(success, error) {\n    const {data, error: err} = await dispatch(AdminActions.testEmail());\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport function registerAdminConsolePlugin(pluginId, reducer) {\n    return (storeDispatch) => {\n        storeDispatch({\n            type: ActionTypes.RECEIVED_ADMIN_CONSOLE_REDUCER,\n            data: {\n                pluginId,\n                reducer,\n            },\n        });\n    };\n}\n\nexport function unregisterAdminConsolePlugin(pluginId) {\n    return (storeDispatch) => {\n        storeDispatch({\n            type: ActionTypes.REMOVED_ADMIN_CONSOLE_REDUCER,\n            data: {\n                pluginId,\n            },\n        });\n    };\n}\n\nexport async function testSiteURL(success, error, siteURL) {\n    const {data, error: err} = await dispatch(AdminActions.testSiteURL(siteURL));\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport function registerAdminConsoleCustomSetting(pluginId, key, component, {showTitle}) {\n    return (storeDispatch) => {\n        storeDispatch({\n            type: ActionTypes.RECEIVED_ADMIN_CONSOLE_CUSTOM_COMPONENT,\n            data: {\n                pluginId,\n                key,\n                component,\n                options: {showTitle},\n            },\n        });\n    };\n}\n\nexport async function getSamlMetadataFromIdp(success, error, samlMetadataURL) {\n    const {data, error: err} = await dispatch(AdminActions.getSamlMetadataFromIdp(samlMetadataURL));\n    if (data && success) {\n        success(data);\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n\nexport async function setSamlIdpCertificateFromMetadata(success, error, certData) {\n    const {data, error: err} = await AdminActions.setSamlIdpCertificateFromMetadata(certData)(dispatch, getState);\n    if (data && success) {\n        success('saml-idp.crt');\n    } else if (err && error) {\n        error({id: err.server_error_id, ...err});\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\ntype Props = {\n    placeholder: {\n        id: string;\n        defaultMessage: string;\n        values?: {string: any};\n    };\n    value?: string;\n};\n\nconst LocalizedInput = React.forwardRef((props: Props, ref?: React.Ref<HTMLInputElement>) => {\n    const {placeholder, ...otherProps} = props;\n\n    return (\n        <FormattedMessage\n            id={placeholder.id}\n            defaultMessage={placeholder.defaultMessage}\n            values={placeholder.values}\n        >\n            {(localizedPlaceholder: (string | JSX.Element)) => (\n                <input\n                    {...otherProps}\n                    ref={ref}\n                    placeholder={localizedPlaceholder as string}\n                />\n            )}\n        </FormattedMessage>\n    );\n});\nLocalizedInput.displayName = 'LocalizedInput';\n\nexport default LocalizedInput;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\n// accepts either a single error or an array of errors\ntype Props = {\n    type?: React.ReactNode;\n    error?: React.ReactNode;\n    textClassName?: string;\n    iconClassName?: string;\n    margin?: boolean;\n    errors?: React.ReactNode[];\n}\n\nexport default class FormError extends React.Component<Props> {\n    public static defaultProps = {\n        error: null,\n        errors: [],\n    }\n    public render() {\n        const {error = null, errors = [], iconClassName, margin, textClassName, type} = this.props;\n\n        if (!error && errors.length === 0) {\n            return null;\n        }\n\n        // look for the first truthy error to display\n        let message = error;\n\n        if (!message) {\n            for (const err of errors) {\n                if (err) {\n                    message = err;\n                }\n            }\n        }\n\n        if (!message) {\n            return null;\n        }\n\n        if (type === 'modal') {\n            return (\n                <div className='form-group'>\n                    <label className='col-sm-12 has-error'>\n                        {message}\n                    </label>\n                </div>\n            );\n        }\n\n        if (type === 'backstage') {\n            return (\n                <div className='pull-left has-error'>\n                    <label className='control-label'>\n                        {message}\n                    </label>\n                </div>\n            );\n        }\n\n        if (margin) {\n            return (\n                <div className='form-group has-error'>\n                    <label className='control-label'>\n                        {message}\n                    </label>\n                </div>\n            );\n        }\n\n        return (\n            <div className={`col-sm-12 ${textClassName || 'has-error'}`}>\n                <label className='control-label'>\n                    <i className={`fa ${iconClassName || 'fa-exclamation-circle'}`}/> {message}\n                </label>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {chain, tween, styler, action} from 'popmotion';\nimport {CSSTransition} from 'react-transition-group';\n\nimport {isMobile} from 'utils/utils.jsx';\n\nconst ANIMATION_DURATION = 80;\n\ntype Props = {\n    children?: React.ReactNode;\n    show: boolean;\n}\n\nexport default class MenuWrapperAnimation extends React.PureComponent<Props> {\n    private onEntering = (node: HTMLElement, isAppearing: boolean) => {\n        const nodeStyler = styler(node);\n        chain(\n            action(({update, complete}) => {\n                update({display: 'block'});\n                complete();\n            }),\n            tween({from: {opacity: 0}, to: {opacity: 1}, duration: ANIMATION_DURATION}),\n        ).start(nodeStyler.set);\n    }\n\n    private onExiting = (node: HTMLElement) => {\n        const nodeStyler = styler(node);\n        chain(\n            tween({from: {opacity: 1}, to: {opacity: 0}, duration: ANIMATION_DURATION}),\n            action(({update, complete}) => {\n                update({display: 'none'});\n                complete();\n            }),\n        ).start(nodeStyler.set);\n    }\n\n    public render() {\n        return (\n            <CSSTransition\n                in={this.props.show}\n                classNames='MenuWrapperAnimation'\n                enter={true}\n                exit={true}\n                mountOnEnter={true}\n                unmountOnExit={true}\n                {...(isMobile() ? {} : {\n                    onEntering: this.onEntering,\n                    onExiting: this.onExiting,\n                })}\n                timeout={{\n                    enter: ANIMATION_DURATION,\n                    exit: ANIMATION_DURATION,\n                }}\n            >\n                {this.props.children}\n            </CSSTransition>\n        );\n    }\n}\n\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport Constants from 'utils/constants';\n\nimport MenuWrapperAnimation from './menu_wrapper_animation';\n\nimport './menu_wrapper.scss';\n\ntype Props = {\n    children?: React.ReactNode;\n    className: string;\n    onToggle?: (open: boolean) => void;\n    animationComponent: any;\n    id?: string;\n}\n\ntype State = {\n    open: boolean;\n}\n\nexport default class MenuWrapper extends React.PureComponent<Props, State> {\n    private node: React.RefObject<HTMLDivElement>;\n\n    public static defaultProps = {\n        className: '',\n        animationComponent: MenuWrapperAnimation,\n    };\n\n    public constructor(props: Props) {\n        super(props);\n        if (!Array.isArray(props.children) || props.children.length !== 2) {\n            throw new Error('MenuWrapper needs exactly 2 children');\n        }\n        this.state = {\n            open: false,\n        };\n        this.node = React.createRef();\n    }\n\n    public componentDidMount() {\n        document.addEventListener('click', this.closeOnBlur, true);\n        document.addEventListener('keyup', this.keyboardClose, true);\n    }\n\n    public componentWillUnmount() {\n        document.removeEventListener('click', this.closeOnBlur, true);\n        document.removeEventListener('keyup', this.keyboardClose, true);\n    }\n\n    private keyboardClose = (e: KeyboardEvent) => {\n        if (e.key === Constants.KeyCodes.ESCAPE[0]) {\n            this.close();\n        }\n\n        if (e.key === Constants.KeyCodes.TAB[0]) {\n            this.closeOnBlur(e);\n        }\n    }\n\n    private closeOnBlur = (e: Event) => {\n        if (this.node && this.node.current && e.target && this.node.current.contains(e.target as Node)) {\n            return;\n        }\n\n        this.close();\n    }\n\n    private close = () => {\n        if (this.state.open) {\n            this.setState({open: false});\n            if (this.props.onToggle) {\n                this.props.onToggle(false);\n            }\n        }\n    }\n\n    private toggle = () => {\n        const newState = !this.state.open;\n        this.setState({open: newState});\n        if (this.props.onToggle) {\n            this.props.onToggle(newState);\n        }\n    }\n\n    public render() {\n        const {children} = this.props;\n\n        const Animation = this.props.animationComponent;\n\n        return (\n            <div\n                id={this.props.id}\n                className={'MenuWrapper ' + this.props.className}\n                onClick={this.toggle}\n                ref={this.node}\n            >\n                {children ? Object.values(children)[0] : {}}\n                <Animation show={this.state.open}>\n                    {children ? Object.values(children)[1] : {}}\n                </Animation>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {batchActions} from 'redux-batched-actions';\n\nimport {\n    leaveChannel as leaveChannelRedux,\n    joinChannel,\n    markChannelAsRead,\n    unfavoriteChannel,\n} from 'mattermost-redux/actions/channels';\nimport * as PostActions from 'mattermost-redux/actions/posts';\nimport {TeamTypes} from 'mattermost-redux/action_types';\nimport {autocompleteUsers} from 'mattermost-redux/actions/users';\nimport {selectTeam} from 'mattermost-redux/actions/teams';\nimport {Posts} from 'mattermost-redux/constants';\nimport {\n    getChannel,\n    getChannelsNameMapInCurrentTeam,\n    getCurrentChannel,\n    getRedirectChannelNameForTeam,\n    getMyChannels,\n    getMyChannelMemberships,\n    isManuallyUnread,\n} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentRelativeTeamUrl, getCurrentTeam, getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentUserId, getUserByUsername} from 'mattermost-redux/selectors/entities/users';\nimport {getMyPreferences} from 'mattermost-redux/selectors/entities/preferences';\nimport {getChannelByName, isFavoriteChannel} from 'mattermost-redux/utils/channel_utils';\nimport EventEmitter from 'mattermost-redux/utils/event_emitter';\n\nimport {openDirectChannelToUserId} from 'actions/channel_actions.jsx';\nimport {getLastViewedChannelName} from 'selectors/local_storage';\nimport {getLastPostsApiTimeForChannel} from 'selectors/views/channel';\nimport {getSocketStatus} from 'selectors/views/websocket';\n\nimport {browserHistory} from 'utils/browser_history';\nimport {Constants, ActionTypes, EventTypes, PostRequestTypes} from 'utils/constants';\nimport {isMobile} from 'utils/utils.jsx';\nimport LocalStorageStore from 'stores/local_storage_store.jsx';\n\nexport function checkAndSetMobileView() {\n    return (dispatch) => {\n        dispatch({\n            type: ActionTypes.UPDATE_MOBILE_VIEW,\n            data: isMobile(),\n        });\n    };\n}\n\nexport function goToLastViewedChannel() {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const currentChannel = getCurrentChannel(state);\n        const channelsInTeam = getChannelsNameMapInCurrentTeam(state);\n\n        let channelToSwitchTo = getChannelByName(channelsInTeam, getLastViewedChannelName(state));\n\n        if (currentChannel.id === channelToSwitchTo.id) {\n            channelToSwitchTo = getChannelByName(channelsInTeam, getRedirectChannelNameForTeam(state, getCurrentTeamId(state)));\n        }\n\n        return dispatch(switchToChannel(channelToSwitchTo));\n    };\n}\n\nexport function switchToChannelById(channelId) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const channel = getChannel(state, channelId);\n        return dispatch(switchToChannel(channel));\n    };\n}\n\nexport function switchToChannel(channel) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const teamUrl = getCurrentRelativeTeamUrl(state);\n\n        if (channel.fake || channel.userId) {\n            const username = channel.userId ? channel.name : channel.display_name;\n            const user = getUserByUsername(state, username);\n            if (!user) {\n                return {error: true};\n            }\n\n            const direct = await dispatch(openDirectChannelToUserId(user.id));\n            if (direct.error) {\n                return {error: true};\n            }\n            browserHistory.push(`${teamUrl}/messages/@${channel.name}`);\n        } else if (channel.type === Constants.GM_CHANNEL) {\n            const gmChannel = getChannel(state, channel.id);\n            browserHistory.push(`${teamUrl}/channels/${gmChannel.name}`);\n        } else {\n            browserHistory.push(`${teamUrl}/channels/${channel.name}`);\n        }\n\n        return {data: true};\n    };\n}\n\nexport function joinChannelById(channelId) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const currentUserId = getCurrentUserId(state);\n        const currentTeamId = getCurrentTeamId(state);\n\n        return dispatch(joinChannel(currentUserId, currentTeamId, channelId));\n    };\n}\n\nexport function leaveChannel(channelId) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const myPreferences = getMyPreferences(state);\n        const currentUserId = getCurrentUserId(state);\n        const currentTeam = getCurrentTeam(state);\n\n        if (isFavoriteChannel(myPreferences, channelId)) {\n            dispatch(unfavoriteChannel(channelId));\n        }\n\n        const teamUrl = getCurrentRelativeTeamUrl(state);\n        LocalStorageStore.removePreviousChannelName(currentUserId, currentTeam.id, state);\n        const {error} = await dispatch(leaveChannelRedux(channelId));\n        if (error) {\n            return {error};\n        }\n        const prevChannelName = LocalStorageStore.getPreviousChannelName(currentUserId, currentTeam.id, state);\n        const channelsInTeam = getChannelsNameMapInCurrentTeam(state);\n        const prevChannel = getChannelByName(channelsInTeam, prevChannelName);\n        if (!prevChannel || !getMyChannelMemberships(state)[prevChannel.id]) {\n            LocalStorageStore.removePreviousChannelName(currentUserId, currentTeam.id, state);\n        }\n\n        if (getMyChannels(getState()).filter((c) => c.type === Constants.OPEN_CHANNEL || c.type === Constants.PRIVATE_CHANNEL).length === 0) {\n            LocalStorageStore.removePreviousChannelName(currentUserId, currentTeam.id, state);\n            dispatch(selectTeam(''));\n            dispatch({type: TeamTypes.LEAVE_TEAM, data: currentTeam});\n            browserHistory.push('/');\n        } else {\n            browserHistory.push(teamUrl);\n        }\n\n        return {\n            data: true,\n        };\n    };\n}\n\nexport function autocompleteUsersInChannel(prefix, channelId) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const currentTeamId = getCurrentTeamId(state);\n\n        return dispatch(autocompleteUsers(prefix, currentTeamId, channelId));\n    };\n}\n\nexport function loadUnreads(channelId) {\n    return async (dispatch) => {\n        const time = Date.now();\n        const {data, error} = await dispatch(PostActions.getPostsUnread(channelId));\n        if (error) {\n            return {\n                error,\n                atLatestMessage: false,\n                atOldestmessage: false,\n            };\n        }\n\n        dispatch({\n            type: ActionTypes.INCREASE_POST_VISIBILITY,\n            data: channelId,\n            amount: data.order.length,\n        });\n\n        if (data.next_post_id === '') {\n            dispatch({\n                type: ActionTypes.RECEIVED_POSTS_FOR_CHANNEL_AT_TIME,\n                channelId,\n                time,\n            });\n        }\n\n        return {\n            atLatestMessage: data.next_post_id === '',\n            atOldestmessage: data.prev_post_id === '',\n        };\n    };\n}\n\nexport function loadPostsAround(channelId, focusedPostId) {\n    return async (dispatch) => {\n        const {data, error} = await dispatch(PostActions.getPostsAround(channelId, focusedPostId, Posts.POST_CHUNK_SIZE / 2));\n        if (error) {\n            return {\n                error,\n                atLatestMessage: false,\n                atOldestmessage: false,\n            };\n        }\n\n        dispatch({\n            type: ActionTypes.INCREASE_POST_VISIBILITY,\n            data: channelId,\n            amount: data.order.length,\n        });\n        return {\n            atLatestMessage: data.next_post_id === '',\n            atOldestmessage: data.prev_post_id === '',\n        };\n    };\n}\n\nexport function loadLatestPosts(channelId) {\n    return async (dispatch) => {\n        const time = Date.now();\n        const {data, error} = await dispatch(PostActions.getPosts(channelId, 0, Posts.POST_CHUNK_SIZE / 2));\n\n        if (error) {\n            return {\n                error,\n                atLatestMessage: false,\n                atOldestmessage: false,\n            };\n        }\n\n        dispatch({\n            type: ActionTypes.RECEIVED_POSTS_FOR_CHANNEL_AT_TIME,\n            channelId,\n            time,\n        });\n\n        return {\n            data,\n            atLatestMessage: data.next_post_id === '',\n            atOldestmessage: data.prev_post_id === '',\n        };\n    };\n}\n\nexport function loadPosts({channelId, postId, type}) {\n    //type here can be BEFORE_ID or AFTER_ID\n    return async (dispatch) => {\n        const POST_INCREASE_AMOUNT = Constants.POST_CHUNK_SIZE / 2;\n\n        dispatch({\n            type: ActionTypes.LOADING_POSTS,\n            data: true,\n            channelId,\n        });\n\n        const page = 0;\n        let result;\n        if (type === PostRequestTypes.BEFORE_ID) {\n            result = await dispatch(PostActions.getPostsBefore(channelId, postId, page, POST_INCREASE_AMOUNT));\n        } else {\n            result = await dispatch(PostActions.getPostsAfter(channelId, postId, page, POST_INCREASE_AMOUNT));\n        }\n\n        const {data} = result;\n\n        const actions = [{\n            type: ActionTypes.LOADING_POSTS,\n            data: false,\n            channelId,\n        }];\n\n        if (result.error) {\n            return {\n                error: result.error,\n                moreToLoad: true,\n            };\n        }\n        actions.push({\n            type: ActionTypes.INCREASE_POST_VISIBILITY,\n            data: channelId,\n            amount: data.order.length,\n        });\n\n        dispatch(batchActions(actions));\n\n        return {\n            moreToLoad: type === PostRequestTypes.BEFORE_ID ? data.prev_post_id !== '' : data.next_post_id !== '',\n        };\n    };\n}\n\nexport function syncPostsInChannel(channelId, since) {\n    return async (dispatch, getState) => {\n        const time = Date.now();\n        const state = getState();\n        const socketStatus = getSocketStatus(state);\n        let sinceTimeToGetPosts = since;\n        const lastPostsApiCallForChannel = getLastPostsApiTimeForChannel(state, channelId);\n\n        if (lastPostsApiCallForChannel && lastPostsApiCallForChannel < socketStatus.lastDisconnectAt) {\n            sinceTimeToGetPosts = lastPostsApiCallForChannel;\n        }\n\n        const {data, error} = await dispatch(PostActions.getPostsSince(channelId, sinceTimeToGetPosts));\n        if (data) {\n            dispatch({\n                type: ActionTypes.RECEIVED_POSTS_FOR_CHANNEL_AT_TIME,\n                channelId,\n                time,\n            });\n        }\n        return {data, error};\n    };\n}\n\nexport function scrollPostListToBottom() {\n    return () => {\n        EventEmitter.emit(EventTypes.POST_LIST_SCROLL_TO_BOTTOM);\n    };\n}\n\nexport function markChannelAsReadOnFocus(channelId) {\n    return (dispatch, getState) => {\n        if (isManuallyUnread(getState(), channelId)) {\n            return;\n        }\n\n        dispatch(markChannelAsRead(channelId));\n    };\n}\n\nexport function updateToastStatus(status) {\n    return (dispatch) => {\n        dispatch({\n            type: ActionTypes.UPDATE_TOAST_STATUS,\n            data: status,\n        });\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport Badge from './badge';\n\ntype Props = {\n    className?: string;\n    show?: boolean;\n}\n\nconst BotBadge: React.FC<Props> = (props: Props) => (\n    <Badge\n        className={'BotBadge ' + props.className}\n        show={props.show}\n    >\n        <FormattedMessage\n            id='post_info.bot'\n            defaultMessage='BOT'\n        />\n    </Badge>\n);\n\nBotBadge.defaultProps = {\n    show: true,\n    className: '',\n};\n\nexport default BotBadge;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport SaveButton from 'components/save_button';\nimport Constants from 'utils/constants';\nimport {isKeyPressed} from 'utils/utils.jsx';\n\nexport default class SettingItemMax extends React.PureComponent {\n    static defaultProps = {\n        infoPosition: 'bottom',\n        saving: false,\n        section: '',\n        containerStyle: '',\n    };\n\n    static propTypes = {\n\n        /**\n         * Array of inputs selection\n         */\n        inputs: PropTypes.node,\n\n        /**\n         * Styles for main component\n         */\n        containerStyle: PropTypes.string,\n\n        /**\n         * Client error\n         */\n        clientError: PropTypes.oneOfType([\n            PropTypes.string,\n            PropTypes.object,\n        ]),\n\n        /**\n         * Server error\n         */\n        serverError: PropTypes.string,\n\n        /**\n         * Settings extra information\n         */\n        extraInfo: PropTypes.element,\n\n        /**\n         * Info position\n         */\n        infoPosition: PropTypes.string,\n\n        /**\n         * Settings or tab section\n         */\n        section: PropTypes.string,\n\n        /**\n         * Function to update section\n         */\n        updateSection: PropTypes.func,\n\n        /**\n         * setting to submit\n         */\n        setting: PropTypes.string,\n\n        /**\n         * Function to submit setting\n         */\n        submit: PropTypes.func,\n\n        /**\n         * Disable submit by enter key\n         */\n        disableEnterSubmit: PropTypes.bool,\n\n        /**\n         * Extra information on submit\n         */\n        submitExtra: PropTypes.node,\n\n        /**\n         * Indicates whether setting is on saving\n         */\n        saving: PropTypes.bool,\n\n        /**\n         * Settings title\n         */\n        title: PropTypes.node,\n\n        /**\n         * Settings width\n         */\n        width: PropTypes.string,\n\n        /**\n         * Text of cancel button\n         */\n        cancelButtonText: PropTypes.node,\n\n        /**\n         * Avoid submitting when using SHIFT + ENTER\n         */\n        shiftEnter: PropTypes.bool,\n\n        /**\n         * Text of save button\n         */\n        saveButtonText: PropTypes.string,\n    }\n\n    constructor(props) {\n        super(props);\n        this.settingList = React.createRef();\n    }\n\n    componentDidMount() {\n        if (this.settingList.current) {\n            const focusableElements = this.settingList.current.querySelectorAll('.btn:not(.save-button):not(.btn-cancel), input.form-control, select, textarea, [tabindex]:not([tabindex=\"-1\"])');\n            if (focusableElements.length > 0) {\n                focusableElements[0].focus();\n            } else {\n                this.settingList.current.focus();\n            }\n        }\n\n        document.addEventListener('keydown', this.onKeyDown);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.onKeyDown);\n    }\n\n    onKeyDown = (e) => {\n        if (this.props.shiftEnter && e.keyCode === Constants.KeyCodes.ENTER && e.shiftKey) {\n            return;\n        }\n        if (this.props.disableEnterSubmit !== true && isKeyPressed(e, Constants.KeyCodes.ENTER) && this.props.submit && e.target.tagName !== 'SELECT' && e.target.parentElement && e.target.parentElement.className !== 'react-select__input' && !e.target.classList.contains('btn-cancel') && this.settingList.current && this.settingList.current.contains(e.target)) {\n            this.handleSubmit(e);\n        }\n    }\n\n    handleSubmit = (e) => {\n        e.preventDefault();\n\n        if (this.props.setting) {\n            this.props.submit(this.props.setting);\n        } else {\n            this.props.submit();\n        }\n    }\n\n    handleUpdateSection = (e) => {\n        this.props.updateSection(this.props.section);\n        e.preventDefault();\n    }\n\n    render() {\n        let clientError = null;\n        if (this.props.clientError) {\n            clientError = (\n                <div className='form-group'>\n                    <label\n                        id='clientError'\n                        className='col-sm-12 has-error'\n                    >\n                        {this.props.clientError}\n                    </label>\n                </div>\n            );\n        }\n\n        let serverError = null;\n        if (this.props.serverError) {\n            serverError = (\n                <div className='form-group'>\n                    <label\n                        id='serverError'\n                        className='col-sm-12 has-error'\n                    >\n                        {this.props.serverError}\n                    </label>\n                </div>\n            );\n        }\n\n        let extraInfo = null;\n        let hintClass = 'setting-list__hint';\n        if (this.props.infoPosition === 'top') {\n            hintClass = 'pb-3';\n        }\n\n        if (this.props.extraInfo) {\n            extraInfo = (\n                <div\n                    id='extraInfo'\n                    className={hintClass}\n                >\n                    {this.props.extraInfo}\n                </div>\n            );\n        }\n\n        let submit = '';\n        if (this.props.submit) {\n            submit = (\n                <SaveButton\n                    defaultMessage={this.props.saveButtonText}\n                    saving={this.props.saving}\n                    disabled={this.props.saving}\n                    onClick={this.handleSubmit}\n                />\n            );\n        }\n\n        const inputs = this.props.inputs;\n        let widthClass;\n        if (this.props.width === 'full') {\n            widthClass = 'col-sm-12';\n        } else if (this.props.width === 'medium') {\n            widthClass = 'col-sm-10 col-sm-offset-2';\n        } else {\n            widthClass = 'col-sm-9 col-sm-offset-3';\n        }\n\n        let title;\n        if (this.props.title) {\n            title = (\n                <h4\n                    id='settingTitle'\n                    className='col-sm-12 section-title'\n                >\n                    {this.props.title}\n                </h4>\n            );\n        }\n\n        let listContent = (\n            <div className='setting-list-item'>\n                {inputs}\n                {extraInfo}\n            </div>\n        );\n\n        if (this.props.infoPosition === 'top') {\n            listContent = (\n                <div>\n                    {extraInfo}\n                    {inputs}\n                </div>\n            );\n        }\n\n        let cancelButtonText;\n        if (this.props.cancelButtonText) {\n            cancelButtonText = this.props.cancelButtonText;\n        } else {\n            cancelButtonText = (\n                <FormattedMessage\n                    id='setting_item_max.cancel'\n                    defaultMessage='Cancel'\n                />\n            );\n        }\n\n        return (\n            <section\n                className={`section-max form-horizontal ${this.props.containerStyle}`}\n            >\n                {title}\n                <div className={widthClass}>\n                    <div\n                        tabIndex='-1'\n                        ref={this.settingList}\n                        className='setting-list'\n                    >\n                        {listContent}\n                        <div className='setting-list-item'>\n                            <hr/>\n                            {this.props.submitExtra}\n                            {serverError}\n                            {clientError}\n                            {submit}\n                            <button\n                                id={'cancelSetting'}\n                                className='btn btn-sm btn-cancel cursor--pointer style--none'\n                                onClick={this.handleUpdateSection}\n                            >\n                                {cancelButtonText}\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </section>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\ntype Props = {\n    className?: string;\n    component?: string;\n    title: {\n        id: string;\n        defaultMessage: string;\n        values?: {string: any};\n    };\n}\n\nconst LocalizedIcon = React.forwardRef((props: Props, ref?: React.Ref<HTMLElement>) => {\n    const {\n        component,\n        title,\n        ...otherProps\n    } = props;\n\n    if (component !== 'i' && component !== 'span') {\n        return null;\n    }\n\n    const Component = component!; // Use an uppercase name since React thinks anything lowercase is an HTML tag\n\n    return (\n        <FormattedMessage\n            id={title.id}\n            defaultMessage={title.defaultMessage}\n            values={title.values}\n        >\n            {(localizedTitle: (string | JSX.Element)) => (\n                <Component\n                    {...otherProps}\n                    ref={ref}\n                    title={localizedTitle as string}\n                />\n            )}\n        </FormattedMessage>\n    );\n});\nLocalizedIcon.defaultProps = {\n    component: 'i',\n};\nLocalizedIcon.displayName = 'LocalizedIcon';\n\nexport default LocalizedIcon;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport './avatar.scss';\n\ntype Props = {\n    url: string;\n    username?: string;\n    size?: string;\n};\n\nconst Avatar: React.FunctionComponent<Props> = ({url, username, size = 'md'}: Props) => (\n    <img\n        className={`Avatar Avatar-${size}`}\n        alt={`${username || 'user'} profile image`}\n        src={url}\n    />\n);\n\nAvatar.defaultProps = {\n    size: 'md',\n};\n\nexport default Avatar;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport default class Provider {\n    constructor() {\n        this.latestPrefix = '';\n        this.latestComplete = true;\n        this.disableDispatches = false;\n        this.requestStarted = false;\n    }\n\n    handlePretextChanged(pretext) { // eslint-disable-line no-unused-vars\n        // NO-OP for inherited classes to override\n    }\n\n    resetRequest() {\n        this.requestStarted = false;\n    }\n\n    startNewRequest(prefix) {\n        this.latestPrefix = prefix;\n        this.latestComplete = false;\n        this.requestStarted = true;\n    }\n\n    shouldCancelDispatch(prefix) {\n        if (this.disableDispatches) {\n            return true;\n        }\n\n        if (!this.requestStarted) {\n            return true;\n        }\n\n        if (prefix === this.latestPrefix) {\n            this.latestComplete = true;\n        } else if (this.latestComplete) {\n            return true;\n        }\n\n        return false;\n    }\n\n    allowDividers() {\n        return true;\n    }\n\n    presentationType() {\n        return 'text';\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nexport default class Suggestion extends React.Component {\n    static get propTypes() {\n        return {\n            item: PropTypes.oneOfType([\n                PropTypes.object,\n                PropTypes.string,\n            ]).isRequired,\n            term: PropTypes.string.isRequired,\n            matchedPretext: PropTypes.string.isRequired,\n            isSelection: PropTypes.bool,\n            onClick: PropTypes.func,\n            onMouseMove: PropTypes.func,\n        };\n    }\n\n    static baseProps = {\n        role: 'button',\n        tabIndex: -1,\n    };\n\n    handleClick = (e) => {\n        e.preventDefault();\n\n        this.props.onClick(this.props.term, this.props.matchedPretext);\n    }\n\n    handleMouseMove = (e) => {\n        e.preventDefault();\n\n        this.props.onMouseMove(this.props.term);\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport function getPreviousActiveSection(state) {\n    return state.views.settings.previousActiveSection;\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {ActionTypes} from 'utils/constants';\n\nexport function updateActiveSection(newActiveSection) {\n    return {\n        type: ActionTypes.UPDATE_ACTIVE_SECTION,\n        data: newActiveSection,\n    };\n}","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {isMobile} from 'utils/utils.jsx';\nimport EditIcon from 'components/widgets/icons/fa_edit_icon';\n\ninterface Props {\n\n    /**\n     * Settings title\n     */\n    title: JSX.Element | string;\n\n    /**\n     * Option to disable opening the setting\n     */\n    disableOpen?: boolean;\n\n    /**\n     * Settings or tab section\n     */\n    section: string;\n\n    /**\n     * Function to update section\n     */\n    updateSection: (section: string) => void;\n\n    /**\n     * Settings description\n     */\n    describe?: JSX.Element | string;\n\n    /**\n     * Shows the previous active section for focusing\n     */\n    previousActiveSection?: string;\n\n    /**\n     * Actions\n     * Update the active section for focusing\n     */\n    actions: {updateActiveSection: (newActiveSection: string) => {type: string; data: string}};\n}\n\nexport default class SettingItemMin extends React.PureComponent<Props> {\n    private edit: HTMLButtonElement | null = null;\n\n    componentDidMount() {\n        if (this.props.previousActiveSection === this.props.section) {\n            if (this.edit) {\n                this.edit.focus();\n            }\n        }\n    }\n\n    private getEdit = (node: HTMLButtonElement) => {\n        this.edit = node;\n    }\n\n    handleUpdateSection = (e: React.MouseEvent<HTMLElement>) => {\n        e.preventDefault();\n        this.props.actions.updateActiveSection(this.props.section);\n        this.props.updateSection(this.props.section);\n    }\n\n    render(): JSX.Element {\n        let editButton = null;\n        let describeSection = null;\n\n        if (!this.props.disableOpen && isMobile()) {\n            editButton = (\n                <div className='section-min__edit'>\n                    <button\n                        id={this.props.section + 'Edit'}\n                        className='color--link cursor--pointer style--none'\n                        onClick={this.handleUpdateSection}\n                        ref={this.getEdit}\n                        aria-labelledby={this.props.section + 'Title ' + this.props.section + 'Edit'}\n                    >\n                        <EditIcon/>\n                        {this.props.describe}\n                    </button>\n                </div>\n            );\n        } else if (!this.props.disableOpen) {\n            editButton = (\n                <div className='section-min__edit'>\n                    <button\n                        id={this.props.section + 'Edit'}\n                        className='color--link cursor--pointer style--none text-left'\n                        onClick={this.handleUpdateSection}\n                        ref={this.getEdit}\n                        aria-labelledby={this.props.section + 'Title ' + this.props.section + 'Edit'}\n                    >\n                        <EditIcon/>\n                        <FormattedMessage\n                            id='setting_item_min.edit'\n                            defaultMessage='Edit'\n                        />\n                    </button>\n                </div>\n            );\n\n            describeSection = (\n                <div\n                    id={this.props.section + 'Desc'}\n                    className='section-min__describe'\n                >\n                    {this.props.describe}\n                </div>\n            );\n        }\n\n        return (\n            <div\n                className='section-min'\n                onClick={this.handleUpdateSection}\n            >\n                <div className='d-flex'>\n                    <h4\n                        id={this.props.section + 'Title'}\n                        className='section-min__title'\n                    >\n                        {this.props.title}\n                    </h4>\n                    {editButton}\n                </div>\n                {describeSection}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch} from 'redux';\n\nimport {GenericAction} from 'mattermost-redux/types/actions';\n\nimport {getPreviousActiveSection} from 'selectors/views/settings';\nimport {updateActiveSection} from 'actions/views/settings';\n\nimport {GlobalState} from 'types/store';\n\nimport SettingItemMin from './setting_item_min';\n\nfunction mapStateToProps(state: GlobalState) {\n    return {\n        previousActiveSection: getPreviousActiveSection(state),\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<GenericAction>) {\n    return {\n        actions: bindActionCreators({\n            updateActiveSection,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SettingItemMin);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport messageHtmlToComponent from 'utils/message_html_to_component';\nimport * as TextFormatting from 'utils/text_formatting';\n\nexport default class Markdown extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * An object mapping channel names to channels for the current team\n         */\n        channelNamesMap: PropTypes.object,\n\n        /*\n         * An array of URL schemes that should be turned into links. Anything that looks\n         * like a link will be turned into a link if this is not provided.\n         */\n        autolinkedUrlSchemes: PropTypes.array,\n\n        /*\n         * Whether or not to do Markdown rendering\n         */\n        enableFormatting: PropTypes.bool,\n\n        /*\n         * Whether or not this text is part of the RHS\n         */\n        isRHS: PropTypes.bool,\n\n        /*\n         * An array of words that can be used to mention a user\n         */\n        mentionKeys: PropTypes.arrayOf(PropTypes.object),\n\n        /*\n         * The text to be rendered\n         */\n        message: PropTypes.string.isRequired,\n\n        /*\n         * Any additional text formatting options to be used\n         */\n        options: PropTypes.object,\n\n        /*\n         * The root Site URL for the page\n         */\n        siteURL: PropTypes.string,\n\n        /*\n         * The current team\n         */\n        team: PropTypes.object,\n\n        /**\n         * If an image proxy is enabled.\n         */\n        hasImageProxy: PropTypes.bool,\n\n        /**\n         * Minimum number of characters in a hashtag.\n         */\n        minimumHashtagLength: PropTypes.number,\n\n        /**\n         * Whether or not to proxy image URLs\n         */\n        proxyImages: PropTypes.bool,\n\n        /**\n         * Any extra props that should be passed into the image component\n         */\n        imageProps: PropTypes.object,\n\n        /**\n         * prop for passed down to image component for dimensions\n         */\n        imagesMetadata: PropTypes.object,\n\n        /**\n         * Whether or not to place the LinkTooltip component inside links\n         */\n        hasPluginTooltips: PropTypes.bool,\n\n        /**\n         * Post id prop passed down to markdown image\n         */\n        postId: PropTypes.string,\n\n        /**\n         * Post id prop passed down to markdown image\n         */\n        postType: PropTypes.string,\n        emojiMap: PropTypes.object,\n    };\n\n    static defaultProps = {\n        options: {},\n        isRHS: false,\n        proxyImages: true,\n        imagesMetadata: {},\n        postId: '', // Needed to avoid proptypes console errors for cases like channel header, which doesn't have a proper value\n    };\n\n    render() {\n        if (!this.props.enableFormatting) {\n            return <span>{this.props.message}</span>;\n        }\n\n        const options = Object.assign({\n            autolinkedUrlSchemes: this.props.autolinkedUrlSchemes,\n            siteURL: this.props.siteURL,\n            mentionKeys: this.props.mentionKeys,\n            atMentions: true,\n            channelNamesMap: this.props.channelNamesMap,\n            proxyImages: this.props.hasImageProxy && this.props.proxyImages,\n            team: this.props.team,\n            minimumHashtagLength: this.props.minimumHashtagLength,\n        }, this.props.options);\n\n        const htmlFormattedText = TextFormatting.formatText(this.props.message, options, this.props.emojiMap);\n        return messageHtmlToComponent(htmlFormattedText, this.props.isRHS, {\n            imageProps: this.props.imageProps,\n            imagesMetadata: this.props.imagesMetadata,\n            hasPluginTooltips: this.props.hasPluginTooltips,\n            postId: this.props.postId,\n            postType: this.props.postType,\n            mentionHighlight: this.props.options.mentionHighlight,\n        });\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {createSelector} from 'reselect';\n\nimport {Preferences} from 'mattermost-redux/constants';\nimport {getChannelsNameMapInCurrentTeam} from 'mattermost-redux/selectors/entities/channels';\nimport {getAutolinkedUrlSchemes, getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getBool} from 'mattermost-redux/selectors/entities/preferences';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentUserMentionKeys} from 'mattermost-redux/selectors/entities/users';\n\nimport {getEmojiMap} from 'selectors/emojis';\nimport {getSiteURL} from 'utils/url';\n\nimport Markdown from './markdown';\n\nfunction makeGetChannelNamesMap() {\n    return createSelector(\n        getChannelsNameMapInCurrentTeam,\n        (state, props) => props && props.channelNamesMap,\n        (channelNamesMap, channelMentions) => {\n            if (channelMentions) {\n                return Object.assign({}, channelMentions, channelNamesMap);\n            }\n\n            return channelNamesMap;\n        }\n    );\n}\n\nfunction makeMapStateToProps() {\n    const getChannelNamesMap = makeGetChannelNamesMap();\n\n    return function mapStateToProps(state, ownProps) {\n        const config = getConfig(state);\n\n        return {\n            autolinkedUrlSchemes: getAutolinkedUrlSchemes(state),\n            channelNamesMap: getChannelNamesMap(state, ownProps),\n            enableFormatting: getBool(state, Preferences.CATEGORY_ADVANCED_SETTINGS, 'formatting', true),\n            mentionKeys: getCurrentUserMentionKeys(state),\n            siteURL: getSiteURL(),\n            team: getCurrentTeam(state),\n            hasImageProxy: config.HasImageProxy === 'true',\n            minimumHashtagLength: parseInt(config.MinimumHashtagLength, 10),\n            emojiMap: getEmojiMap(state)\n        };\n    };\n}\n\nexport default connect(makeMapStateToProps)(Markdown);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {batchActions} from 'redux-batched-actions';\n\nimport {PreferenceTypes} from 'mattermost-redux/action_types';\nimport * as ChannelActions from 'mattermost-redux/actions/channels';\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\nimport {getMyChannelMemberships} from 'mattermost-redux/selectors/entities/common';\nimport {getChannelByName, getUnreadChannelIds, getChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentTeamUrl, getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\n\nimport {trackEvent} from 'actions/diagnostics_actions.jsx';\nimport {loadNewDMIfNeeded, loadNewGMIfNeeded, loadProfilesForSidebar} from 'actions/user_actions.jsx';\nimport {browserHistory} from 'utils/browser_history';\nimport {Constants, Preferences} from 'utils/constants';\nimport {getDirectChannelName} from 'utils/utils';\n\nexport function openDirectChannelToUserId(userId) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const currentUserId = getCurrentUserId(state);\n        const channelName = getDirectChannelName(currentUserId, userId);\n        const channel = getChannelByName(state, channelName);\n\n        if (!channel) {\n            return dispatch(ChannelActions.createDirectChannel(currentUserId, userId));\n        }\n\n        trackEvent('api', 'api_channels_join_direct');\n        const now = Date.now();\n        const prefDirect = {\n            category: Preferences.CATEGORY_DIRECT_CHANNEL_SHOW,\n            name: userId,\n            value: 'true',\n        };\n        const prefOpenTime = {\n            category: Preferences.CATEGORY_CHANNEL_OPEN_TIME,\n            name: channel.id,\n            value: now.toString(),\n        };\n        const actions = [{\n            type: PreferenceTypes.RECEIVED_PREFERENCES,\n            data: [prefDirect],\n        }, {\n            type: PreferenceTypes.RECEIVED_PREFERENCES,\n            data: [prefOpenTime],\n        }];\n        dispatch(batchActions(actions));\n\n        dispatch(savePreferences(currentUserId, [\n            {user_id: currentUserId, ...prefDirect},\n            {user_id: currentUserId, ...prefOpenTime},\n        ]));\n\n        return {data: channel};\n    };\n}\n\nexport function openGroupChannelToUserIds(userIds) {\n    return async (dispatch, getState) => {\n        const result = await dispatch(ChannelActions.createGroupChannel(userIds));\n\n        if (result.error) {\n            browserHistory.push(getCurrentTeamUrl(getState()));\n        }\n\n        return result;\n    };\n}\n\nexport function loadChannelsForCurrentUser() {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const unreads = getUnreadChannelIds(state);\n\n        await dispatch(ChannelActions.fetchMyChannelsAndMembers(getCurrentTeamId(state)));\n        for (const id of unreads) {\n            const channel = getChannel(state, id);\n            if (channel && channel.type === Constants.DM_CHANNEL) {\n                loadNewDMIfNeeded(channel.id);\n            } else if (channel && channel.type === Constants.GM_CHANNEL) {\n                loadNewGMIfNeeded(channel.id);\n            }\n        }\n\n        loadProfilesForSidebar();\n    };\n}\n\nexport function searchMoreChannels(term, showArchivedChannels) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const teamId = getCurrentTeamId(state);\n\n        if (!teamId) {\n            throw new Error('No team id');\n        }\n\n        const {data, error} = await dispatch(ChannelActions.searchChannels(teamId, term, showArchivedChannels));\n        if (data) {\n            const myMembers = getMyChannelMemberships(state);\n\n            // When searching public channels, only get channels user is not a member of\n            const channels = showArchivedChannels ? data : data.filter((c) => !myMembers[c.id]);\n            return {data: channels};\n        }\n\n        return {error};\n    };\n}\n\nexport function autocompleteChannels(term, success, error) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const teamId = getCurrentTeamId(state);\n        if (!teamId) {\n            return;\n        }\n\n        const {data, error: err} = await dispatch(ChannelActions.autocompleteChannels(teamId, term));\n        if (data && success) {\n            success(data);\n        } else if (err && error) {\n            error({id: err.server_error_id, ...err});\n        }\n    };\n}\n\nexport function autocompleteChannelsForSearch(term, success, error) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const teamId = getCurrentTeamId(state);\n\n        if (!teamId) {\n            return;\n        }\n\n        const {data, error: err} = await dispatch(ChannelActions.autocompleteChannelsForSearch(teamId, term));\n        if (data && success) {\n            success(data);\n        } else if (err && error) {\n            error({id: err.server_error_id, ...err});\n        }\n    };\n}\n\nexport function addUsersToChannel(channelId, userIds) {\n    return async (dispatch) => {\n        try {\n            const requests = userIds.map((uId) => dispatch(ChannelActions.addChannelMember(channelId, uId)));\n\n            return await Promise.all(requests);\n        } catch (error) {\n            return {error};\n        }\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport LoadingWrapper from 'components/widgets/loading/loading_wrapper';\n\ntype Props = {\n    saving: boolean;\n    disabled?: boolean;\n    id?: string;\n    onClick?: (e: React.MouseEvent<HTMLButtonElement>) => void;\n    savingMessage?: React.ReactNode;\n    defaultMessage?: React.ReactNode;\n    btnClass?: string;\n    extraClasses?: string;\n}\n\nexport default class SaveButton extends React.PureComponent<Props> {\n    public static defaultProps: Partial<Props> = {\n        btnClass: 'btn-primary',\n        defaultMessage: (\n            <FormattedMessage\n                id='save_button.save'\n                defaultMessage='Save'\n            />\n        ),\n        disabled: false,\n        extraClasses: '',\n        savingMessage: (\n            <FormattedMessage\n                id='save_button.saving'\n                defaultMessage='Saving'\n            />\n        ),\n    }\n\n    public render() {\n        const {\n            saving,\n            disabled,\n            savingMessage,\n            defaultMessage,\n            btnClass,\n            extraClasses,\n            ...props\n        } = this.props;\n\n        let className = 'save-button btn';\n        if (!disabled || saving) {\n            className += ' ' + btnClass;\n        }\n\n        if (extraClasses) {\n            className += ' ' + extraClasses;\n        }\n\n        return (\n            <button\n                type='submit'\n                id='saveSetting'\n                className={className}\n                disabled={disabled}\n                {...props}\n            >\n                <LoadingWrapper\n                    loading={saving}\n                    text={savingMessage}\n                >\n                    <span>{defaultMessage}</span>\n                </LoadingWrapper>\n            </button>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport LocalizedIcon from 'components/localized_icon';\n\nimport {t} from 'utils/i18n';\n\ntype Props = {\n    text: React.ReactNode;\n}\n\nexport default class LoadingSpinner extends React.PureComponent<Props> {\n    public static defaultProps: Props = {\n        text: null,\n    }\n\n    public render() {\n        return (\n            <span\n                id='loadingSpinner'\n                className={'LoadingSpinner' + (this.props.text ? ' with-text' : '')}\n            >\n                <LocalizedIcon\n                    className='fa fa-spinner fa-fw fa-pulse spinner'\n                    component='span'\n                    title={{id: t('generic_icons.loading'), defaultMessage: 'Loading Icon'}}\n                />\n                {this.props.text}\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport LoadingSpinner from './loading_spinner';\n\ntype Props = {\n    loading: boolean;\n    text: React.ReactNode;\n    children: React.ReactNode;\n}\n\nexport default class LoadingWrapper extends React.Component<Props> {\n    public static defaultProps: Props = {\n        loading: true,\n        text: null,\n        children: null,\n    }\n\n    public render() {\n        const {text, loading, children} = this.props;\n        if (!loading) {\n            return children;\n        }\n\n        return <LoadingSpinner text={text}/>;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport Badge from './badge';\n\ntype Props = {\n    className?: string;\n    show?: boolean;\n};\n\nconst GuestBadge: React.FC<Props> = (props: Props) => (\n    <Badge\n        className={'GuestBadge ' + props.className}\n        show={props.show}\n    >\n        <FormattedMessage\n            id='post_info.guest'\n            defaultMessage='GUEST'\n        />\n    </Badge>\n);\n\nGuestBadge.defaultProps = {\n    show: true,\n    className: '',\n};\n\nexport default GuestBadge;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport LocalizedIcon from 'components/localized_icon';\n\nimport {t} from 'utils/i18n';\n\ntype Props = {\n    additionalClassName: string | null;\n}\n\nexport default class WarningIcon extends React.PureComponent<Props> {\n    public static defaultProps: Props = {\n        additionalClassName: null,\n    };\n\n    public render(): JSX.Element {\n        const className = 'fa fa-warning' + (this.props.additionalClassName ? ' ' + this.props.additionalClassName : '');\n        return (\n            <LocalizedIcon\n                className={className}\n                title={{id: t('generic_icons.warning'), defaultMessage: 'Warning Icon'}}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport exif2css from 'exif2css';\n\nimport Constants from 'utils/constants';\nimport * as UserAgent from 'utils/user_agent';\n\nexport function canUploadFiles(config) {\n    const enableFileAttachments = config.EnableFileAttachments === 'true';\n    const enableMobileFileUpload = config.EnableMobileFileUpload === 'true';\n\n    if (!enableFileAttachments) {\n        return false;\n    }\n\n    if (UserAgent.isMobileApp()) {\n        return enableMobileFileUpload;\n    }\n\n    return true;\n}\n\nexport function canDownloadFiles(config) {\n    if (UserAgent.isMobileApp()) {\n        return config.EnableMobileFileDownload === 'true';\n    }\n\n    return true;\n}\n\nexport function trimFilename(filename) {\n    let trimmedFilename = filename;\n    if (filename.length > Constants.MAX_FILENAME_LENGTH) {\n        trimmedFilename = filename.substring(0, Math.min(Constants.MAX_FILENAME_LENGTH, filename.length)) + '...';\n    }\n\n    return trimmedFilename;\n}\n\nexport function getFileTypeFromMime(mimetype) {\n    const mimeTypeSplitBySlash = mimetype.split('/');\n    const mimeTypePrefix = mimeTypeSplitBySlash[0];\n    const mimeTypeSuffix = mimeTypeSplitBySlash[1];\n\n    if (mimeTypePrefix === 'video') {\n        return 'video';\n    } else if (mimeTypePrefix === 'audio') {\n        return 'audio';\n    } else if (mimeTypePrefix === 'image') {\n        return 'image';\n    }\n\n    if (mimeTypeSuffix) {\n        if (mimeTypeSuffix === 'pdf') {\n            return 'pdf';\n        } else if (mimeTypeSuffix.includes('vnd.ms-excel') || mimeTypeSuffix.includes('spreadsheetml') || mimeTypeSuffix.includes('vnd.sun.xml.calc') || mimeTypeSuffix.includes('opendocument.spreadsheet')) {\n            return 'spreadsheet';\n        } else if (mimeTypeSuffix.includes('vnd.ms-powerpoint') || mimeTypeSuffix.includes('presentationml') || mimeTypeSuffix.includes('vnd.sun.xml.impress') || mimeTypeSuffix.includes('opendocument.presentation')) {\n            return 'presentation';\n        } else if ((mimeTypeSuffix === 'msword') || mimeTypeSuffix.includes('vnd.ms-word') || mimeTypeSuffix.includes('officedocument.wordprocessingml') || mimeTypeSuffix.includes('application/x-mswrite')) {\n            return 'word';\n        }\n    }\n\n    return 'other';\n}\n\n// based on https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side/32490603#32490603\nexport function getExifOrientation(data) {\n    var view = new DataView(data);\n\n    if (view.getUint16(0, false) !== 0xFFD8) {\n        return -2;\n    }\n\n    var length = view.byteLength;\n    var offset = 2;\n\n    while (offset < length) {\n        var marker = view.getUint16(offset, false);\n        offset += 2;\n\n        if (marker === 0xFFE1) {\n            if (view.getUint32(offset += 2, false) !== 0x45786966) {\n                return -1;\n            }\n\n            var little = view.getUint16(offset += 6, false) === 0x4949;\n            offset += view.getUint32(offset + 4, little);\n            var tags = view.getUint16(offset, little);\n            offset += 2;\n\n            for (var i = 0; i < tags; i++) {\n                if (view.getUint16(offset + (i * 12), little) === 0x0112) {\n                    return view.getUint16(offset + (i * 12) + 8, little);\n                }\n            }\n        } else if ((marker & 0xFF00) === 0xFF00) {\n            offset += view.getUint16(offset, false);\n        } else {\n            break;\n        }\n    }\n    return -1;\n}\n\nexport function getOrientationStyles(orientation) {\n    const {\n        transform,\n        'transform-origin': transformOrigin,\n    } = exif2css(orientation);\n    return {transform, transformOrigin};\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nexport default class Pluggable extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * Should be a single overridable React component. One of this or pluggableName is required\n         */\n        children: PropTypes.element,\n\n        /*\n         * Override the component to be plugged. One of this or children is required\n         */\n        pluggableName: PropTypes.string,\n\n        /*\n         * Components for overriding provided by plugins\n         */\n        components: PropTypes.object.isRequired,\n\n        /*\n         * Logged in user's theme\n         */\n        theme: PropTypes.object.isRequired,\n\n        /*\n         * Id of the specific component to be plugged.\n         */\n        pluggableId: PropTypes.string,\n    }\n\n    render() {\n        const pluggableName = this.props.pluggableName;\n\n        let child;\n        if (this.props.children) {\n            child = React.Children.only(this.props.children).type;\n        } else if (!pluggableName) {\n            return null;\n        }\n\n        const components = this.props.components;\n        const childrenProps = child ? this.props.children.props : {};\n        const componentName = pluggableName || child.getComponentName();\n\n        // Include any props passed to this component or to the child component\n        let props = {...this.props};\n        Reflect.deleteProperty(props, 'children');\n        Reflect.deleteProperty(props, 'components');\n        Reflect.deleteProperty(props, 'pluggableName');\n        props = {...props, ...childrenProps};\n\n        // Override the default component with any registered plugin's component\n        // Select a specific component by pluginId if available\n        if (components.hasOwnProperty(componentName)) {\n            let pluginComponents = components[componentName];\n\n            if (this.props.pluggableId) {\n                pluginComponents = pluginComponents.filter(\n                    (element) => element.id === this.props.pluggableId);\n            }\n\n            const content = pluginComponents.map((p) => {\n                const PluginComponent = p.component;\n                return (\n                    <PluginComponent\n                        {...props}\n                        theme={this.props.theme}\n                        key={componentName + p.id}\n                    />\n                );\n            });\n\n            return (\n                <React.Fragment>\n                    {content}\n                </React.Fragment>\n            );\n        }\n\n        if (child == null) {\n            return null;\n        }\n\n        return React.cloneElement(this.props.children, {...props});\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getTheme} from 'mattermost-redux/selectors/entities/preferences';\n\nimport Pluggable from './pluggable.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        components: state.plugins.components,\n        theme: getTheme(state),\n    };\n}\n\nexport default connect(mapStateToProps)(Pluggable);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class GlobeIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.channel.public'\n                    defaultMessage='Public Channel Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='13px'\n                            height='13px'\n                            viewBox='0 0 14 14'\n                            role='presentation'\n                            aria-label={ariaLabel}\n                        >\n                            <g\n                                stroke='none'\n                                strokeWidth='1'\n                                fill='inherit'\n                                fillRule='evenodd'\n                            >\n                                <g\n                                    transform='translate(-115.000000, -147.000000)'\n                                    fillRule='nonzero'\n                                    fill='inherit'\n                                >\n                                    <g transform='translate(95.000000, 0.000000)'>\n                                        <g transform='translate(20.000000, 113.000000)'>\n                                            <g transform='translate(0.000000, 34.000000)'>\n                                                <path d='M10.409,0.893375 C9.40275,0.329875 8.24075,0.00875 7,0 C3.13075,0 0,3.140375 0,7 C0,10.521875 2.594375,13.42775 5.97625,13.93 C6.314875,13.974625 6.6535,14 7,14 C8.24075,14 9.40275,13.678875 10.409,13.1145 C12.551875,11.918375 14,9.6285 14,7 C13.99125,4.3715 12.551875,2.090375 10.409,0.893375 Z M11.554375,4.375 L9.431625,4.375 C9.302125,3.5 9.10875,2.736125 8.86725,2.085125 C10.003875,2.519125 10.9515,3.5 11.554375,4.375 Z M6.941375,1.73775 C6.960625,1.736875 6.979875,1.73425 7,1.73425 C7.020125,1.73425 7.039375,1.736875 7.058625,1.73775 C7.340375,2.172625 7.697375,3.5 7.92225,4.375 L6.07775,4.375 C6.302625,3.5 6.659625,2.172625 6.941375,1.73775 Z M1.81475,7.875 C1.7675,7.875 1.73425,7.29925 1.73425,7 C1.73425,6.70075 1.764875,6.125 1.813,6.125 L4.396875,6.125 C4.384625,6.125 4.375,6.7025 4.375,7 C4.375,7.2975 4.384625,7.875 4.396875,7.875 L1.81475,7.875 Z M4.354875,11.54475 C4.346125,11.54475 4.337375,11.54475 4.337375,11.536 C3.548125,11.07575 2.893625,10.5 2.436875,9.625 L4.568375,9.625 C4.697875,10.5 4.890375,11.262125 5.131875,11.91225 C4.8615,11.81075 4.599875,11.692625 4.354875,11.54475 Z M4.568375,4.375 L2.443875,4.375 C3.045875,3.5 3.994375,2.517375 5.131875,2.083375 C4.89125,2.734375 4.697875,3.5 4.568375,4.375 Z M7.0595,12.26225 C7.039375,12.26225 7.020125,12.26575 7,12.26575 C6.979875,12.26575 6.960625,12.26225 6.9405,12.26225 C6.65875,11.8265 6.302625,11.375 6.07775,9.625 L7.921375,9.625 C7.697375,11.375 7.34125,11.8265 7.0595,12.26225 Z M8.11125,7.875 L5.88875,7.875 C5.873875,7.875 5.8625,7.30625 5.8625,7 C5.8625,6.69375 5.873875,6.125 5.88875,6.125 L8.11125,6.125 C8.126125,6.125 8.1375,6.69375 8.1375,7 C8.1375,7.30625 8.126125,7.875 8.11125,7.875 Z M10.409,11.0075 C10.13075,11.242 9.828,11.45025 9.506875,11.631375 C9.30125,11.74075 9.086875,11.839625 8.8655,11.923625 C9.107,11.270875 9.30125,10.5 9.431625,9.625 L11.557875,9.625 C11.25425,10.5 10.8675,10.618125 10.409,11.0075 Z M9.603125,7.875 C9.615375,7.875 9.625,7.2975 9.625,7 C9.625,6.7025 9.615375,6.125 9.603125,6.125 L12.186125,6.125 C12.235125,6.125 12.26575,6.70075 12.26575,7 C12.26575,7.29925 12.233375,7.875 12.18525,7.875 L9.603125,7.875 Z'/>\n                                            </g>\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {FormattedMessage} from 'react-intl';\n\nexport default class LockIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.channel.private'\n                    defaultMessage='Private Channel Icon'\n                >\n                    {(title) => (\n                        <svg\n                            width='12px'\n                            height='13px'\n                            viewBox='0 0 13 15'\n                            role='presentation'\n                            title={title}\n                        >\n                            <g\n                                stroke='none'\n                                strokeWidth='1'\n                                fill='inherit'\n                                fillRule='evenodd'\n                            >\n                                <g\n                                    transform='translate(-116.000000, -175.000000)'\n                                    fillRule='nonzero'\n                                    fill='inherit'\n                                >\n                                    <g transform='translate(95.000000, 0.000000)'>\n                                        <g transform='translate(20.000000, 113.000000)'>\n                                            <g transform='translate(1.000000, 62.000000)'>\n                                                <path d='M12.0714286,6.5 L11.1428571,6.5 L11.1428571,4.64285714 C11.1428571,2.07814286 9.06471429,0 6.5,0 C3.93528571,0 1.85714286,2.07814286 1.85714286,4.64285714 L1.85714286,6.5 L0.928571429,6.5 C0.415071429,6.5 0,7.00792857 0,7.52142857 L0,13.9285714 C0,14.4420714 0.415071429,14.8571429 0.928571429,14.8571429 L12.0714286,14.8571429 C12.5849286,14.8571429 13,14.4420714 13,13.9285714 L13,7.52142857 C13,7.00792857 12.5849286,6.5 12.0714286,6.5 Z M6.5,1.85714286 C8.03585714,1.85714286 9.28571429,3.107 9.28571429,4.64285714 L9.28571429,6.5 L8.35714286,6.5 L4.64285714,6.5 L3.71428571,6.5 L3.71428571,4.64285714 C3.71428571,3.107 4.96414286,1.85714286 6.5,1.85714286 Z'/>\n                                            </g>\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport {FormattedMessage} from 'react-intl';\n\nimport {isEmptyObject, windowHeight} from 'utils/utils.jsx';\nimport {Constants} from 'utils/constants.jsx';\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\n\nexport default class SuggestionList extends React.PureComponent {\n    static propTypes = {\n        ariaLiveRef: PropTypes.object,\n        open: PropTypes.bool.isRequired,\n        location: PropTypes.string,\n        renderDividers: PropTypes.bool,\n        renderNoResults: PropTypes.bool,\n        onCompleteWord: PropTypes.func.isRequired,\n        preventClose: PropTypes.func,\n        onItemHover: PropTypes.func.isRequired,\n        pretext: PropTypes.string.isRequired,\n        cleared: PropTypes.bool.isRequired,\n        matchedPretext: PropTypes.array.isRequired,\n        items: PropTypes.array.isRequired,\n        terms: PropTypes.array.isRequired,\n        selection: PropTypes.string.isRequired,\n        components: PropTypes.array.isRequired,\n        wrapperHeight: PropTypes.number,\n    };\n\n    static defaultProps = {\n        renderDividers: false,\n        renderNoResults: false,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.contentRef = React.createRef();\n        this.itemRefs = new Map();\n        this.suggestionReadOut = React.createRef();\n        this.currentLabel = '';\n        this.currentItem = {};\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.selection !== prevProps.selection && this.props.selection) {\n            this.scrollToItem(this.props.selection);\n        }\n\n        if (!isEmptyObject(this.currentItem)) {\n            this.generateLabel(this.currentItem);\n        }\n    }\n\n    componentWillUnmount() {\n        this.removeLabel();\n    }\n\n    announceLabel() {\n        const suggestionReadOut = this.props.ariaLiveRef.current;\n        if (suggestionReadOut) {\n            suggestionReadOut.innerHTML = this.currentLabel;\n        }\n    }\n\n    removeLabel() {\n        const suggestionReadOut = this.props.ariaLiveRef.current;\n        if (suggestionReadOut) {\n            suggestionReadOut.innerHTML = '';\n        }\n    }\n\n    generateLabel(item) {\n        if (item.username) {\n            this.currentLabel = item.username;\n            if ((item.first_name || item.last_name) && item.nickname) {\n                this.currentLabel += ` ${item.first_name} ${item.last_name} ${item.nickname}`;\n            } else if (item.nickname) {\n                this.currentLabel += ` ${item.nickname}`;\n            } else if (item.first_name || item.last_name) {\n                this.currentLabel += ` ${item.first_name} ${item.last_name}`;\n            }\n        } else if (item.type === 'mention.channels') {\n            this.currentLabel = item.channel.display_name;\n        }\n\n        if (this.currentLabel) {\n            this.currentLabel = this.currentLabel.toLowerCase();\n        }\n        this.announceLabel();\n    }\n\n    getContent = () => {\n        return $(this.contentRef.current);\n    }\n\n    scrollToItem = (term) => {\n        const content = this.getContent();\n        if (!content || content.length === 0) {\n            return;\n        }\n\n        const visibleContentHeight = content[0].clientHeight;\n        const actualContentHeight = content[0].scrollHeight;\n\n        if (visibleContentHeight < actualContentHeight) {\n            const contentTop = content.scrollTop();\n            const contentTopPadding = parseInt(content.css('padding-top'), 10);\n            const contentBottomPadding = parseInt(content.css('padding-top'), 10);\n\n            const item = $(ReactDOM.findDOMNode(this.itemRefs.get(term)));\n            if (item.length === 0) {\n                return;\n            }\n\n            const itemTop = item[0].offsetTop - parseInt(item.css('margin-top'), 10);\n            const itemBottomMargin = parseInt(item.css('margin-bottom'), 10) + parseInt(item.css('padding-bottom'), 10);\n            const itemBottom = item[0].offsetTop + item.height() + itemBottomMargin;\n\n            if (itemTop - contentTopPadding < contentTop) {\n                // the item is off the top of the visible space\n                content.scrollTop(itemTop - contentTopPadding);\n            } else if (itemBottom + contentTopPadding + contentBottomPadding > contentTop + visibleContentHeight) {\n                // the item has gone off the bottom of the visible space\n                content.scrollTop((itemBottom - visibleContentHeight) + contentTopPadding + contentBottomPadding);\n            }\n        }\n    }\n\n    renderDivider(type) {\n        return (\n            <div\n                key={type + '-divider'}\n                className='suggestion-list__divider'\n            >\n                <span>\n                    <FormattedMessage id={'suggestion.' + type}/>\n                </span>\n            </div>\n        );\n    }\n\n    renderNoResults() {\n        return (\n            <div\n                key='list-no-results'\n                className='suggestion-list__no-results'\n                ref={this.contentRef}\n            >\n                <FormattedMarkdownMessage\n                    id='suggestion_list.no_matches'\n                    defaultMessage='No items match __{value}__'\n                    values={{\n                        value: this.props.pretext || '\"\"',\n                    }}\n                />\n            </div>\n        );\n    }\n\n    render() {\n        if (!this.props.open || this.props.cleared) {\n            return null;\n        }\n\n        const items = [];\n        if (this.props.items.length === 0) {\n            if (!this.props.renderNoResults) {\n                return null;\n            }\n            items.push(this.renderNoResults());\n        }\n\n        let lastType;\n        for (let i = 0; i < this.props.items.length; i++) {\n            const item = this.props.items[i];\n            const term = this.props.terms[i];\n            const isSelection = term === this.props.selection;\n\n            // ReactComponent names need to be upper case when used in JSX\n            const Component = this.props.components[i];\n\n            if (this.props.renderDividers && item.type !== lastType) {\n                items.push(this.renderDivider(item.type));\n                lastType = item.type;\n            }\n\n            if (item.loading) {\n                items.push(<LoadingSpinner key={item.type}/>);\n                continue;\n            }\n\n            if (isSelection) {\n                this.currentItem = item;\n            }\n\n            items.push(\n                <Component\n                    key={term}\n                    ref={(ref) => this.itemRefs.set(term, ref)}\n                    item={this.props.items[i]}\n                    term={term}\n                    matchedPretext={this.props.matchedPretext[i]}\n                    isSelection={isSelection}\n                    onClick={this.props.onCompleteWord}\n                    onMouseMove={this.props.onItemHover}\n                />\n            );\n        }\n        const mainClass = 'suggestion-list suggestion-list--' + this.props.location;\n        const contentClass = 'suggestion-list__content suggestion-list__content--' + this.props.location;\n        let maxHeight = Constants.SUGGESTION_LIST_MAXHEIGHT;\n        if (this.props.wrapperHeight) {\n            maxHeight = Math.min(\n                windowHeight() - (this.props.wrapperHeight + Constants.SUGGESTION_LIST_MAXHEIGHT),\n                Constants.SUGGESTION_LIST_MAXHEIGHT\n            );\n        }\n\n        const contentStyle = {maxHeight};\n\n        return (\n            <div className={mainClass}>\n                <div\n                    id='suggestionList'\n                    ref={this.contentRef}\n                    style={{...contentStyle}}\n                    className={contentClass}\n                    onMouseDown={this.props.preventClose}\n                >\n                    {items}\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Popover as BSPopover, Sizes as BSSizes} from 'react-bootstrap';\n\nconst SizeMap = {xs: 'xsmall', sm: 'small', md: 'medium', lg: 'large'};\nexport type Sizes = 'xs' | 'sm' | 'md' | 'lg';\n\ninterface Props {\n    id?: string;\n    children?: React.ReactNode;\n    popoverStyle?: 'info';\n    popoverSize?: Sizes;\n    title?: React.ReactNode;\n    placement?: 'bottom' | 'top' | 'right' | 'left';\n    className?: string;\n    style?: React.CSSProperties;\n    onMouseOut?: React.MouseEventHandler<BSPopover>; // didn't find a better way to satisfy typing, so for now we have a slight 'bootstrap leakage'\n    onMouseOver?: React.MouseEventHandler<BSPopover>;\n}\n\nexport default class Popover extends React.PureComponent<Props> {\n    static defaultProps = {\n        placement: 'right',\n        popoverStyle: 'info',\n        popoverSize: 'sm'\n\n    }\n    render() {\n        const {placement, popoverSize, children, popoverStyle, title, id, onMouseOut, onMouseOver, className, style} = this.props;\n        return (\n            <BSPopover\n                id={id}\n                style={style}\n                className={className}\n                bsStyle={popoverStyle}\n                placement={placement}\n                bsClass='popover'\n                title={title}\n                bsSize={popoverSize && SizeMap[popoverSize] as BSSizes} // map our sizes to bootstrap\n                onMouseOut={onMouseOut!}\n                onMouseOver={onMouseOver}\n            >\n                {children}\n            </BSPopover>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport OverlayTrigger, {BaseOverlayTrigger} from 'components/overlay_trigger';\nimport ProfilePopover from 'components/profile_popover';\nimport StatusIcon from 'components/status_icon';\nimport Avatar from 'components/widgets/users/avatar';\n\ninterface MMOverlayTrigger extends BaseOverlayTrigger {\n    hide: () => void;\n}\n\ntype Props = {\n    hasMention?: boolean;\n    isBusy?: boolean;\n    isEmoji?: boolean;\n    isRHS?: boolean;\n    profileSrc?: string;\n    size: string;\n    src: string;\n    status?: string;\n    userId?: string;\n    username?: string;\n    wrapperClass?: string;\n}\n\nexport default class ProfilePicture extends React.PureComponent<Props> {\n    public static defaultProps = {\n        size: 'md',\n        isRHS: false,\n        isEmoji: false,\n        hasMention: false,\n        wrapperClass: '',\n    };\n\n    overlay = React.createRef<MMOverlayTrigger>();\n\n    public hideProfilePopover = () => {\n        if (this.overlay.current) {\n            this.overlay.current.hide();\n        }\n    }\n\n    public render() {\n        // profileSrc will, if possible, be the original user profile picture even if the icon\n        // for the post is overriden, so that the popup shows the user identity\n        const profileSrc = (typeof this.props.profileSrc === 'string' && this.props.profileSrc !== '') ?\n            this.props.profileSrc :\n            this.props.src;\n\n        const profileIconClass = `profile-icon ${this.props.isEmoji ? 'emoji' : ''}`;\n\n        if (this.props.userId) {\n            return (\n                <OverlayTrigger\n                    ref={this.overlay}\n                    trigger='click'\n                    placement='right'\n                    rootClose={true}\n                    overlay={\n                        <ProfilePopover\n                            className='user-profile-popover'\n                            userId={this.props.userId}\n                            src={profileSrc}\n                            isBusy={this.props.isBusy}\n                            hide={this.hideProfilePopover}\n                            isRHS={this.props.isRHS}\n                            hasMention={this.props.hasMention}\n                        />\n                    }\n                >\n                    <button\n                        className={`status-wrapper style--none ${this.props.wrapperClass}`}\n                        tabIndex={-1}\n                    >\n                        <span className={profileIconClass}>\n                            <Avatar\n                                username={this.props.username}\n                                size={this.props.size}\n                                url={this.props.src}\n                            />\n                        </span>\n                        <StatusIcon status={this.props.status}/>\n                    </button>\n                </OverlayTrigger>\n            );\n        }\n        return (\n            <span className='status-wrapper'>\n                <span className={profileIconClass}>\n                    <Avatar\n                        size={this.props.size}\n                        url={this.props.src}\n                    />\n                </span>\n                <StatusIcon status={this.props.status}/>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport function isModalOpen(state, modalId) {\n    return state.views.modals.modalState[modalId] && state.views.modals.modalState[modalId].open;\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {SearchTypes} from 'utils/constants';\n\nexport function setModalSearchTerm(term) {\n    return async (dispatch) => {\n        dispatch({\n            type: SearchTypes.SET_MODAL_SEARCH,\n            data: term,\n        });\n        return {data: true};\n    };\n}\n\nexport function setSystemUsersSearch(term, team, filter = '') {\n    return async (dispatch) => {\n        dispatch({\n            type: SearchTypes.SET_SYSTEM_USERS_SEARCH,\n            data: {term, team, filter},\n        });\n        return {data: true};\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nconst LICENSE_EXPIRY_NOTIFICATION = 1000 * 60 * 60 * 24 * 60; // 60 days\nconst LICENSE_GRACE_PERIOD = 1000 * 60 * 60 * 24 * 15; // 15 days\n\nexport function isLicenseExpiring(license) {\n    if (license.IsLicensed !== 'true') {\n        return false;\n    }\n\n    const timeDiff = parseInt(license.ExpiresAt, 10) - Date.now();\n    return timeDiff <= LICENSE_EXPIRY_NOTIFICATION;\n}\n\nexport function isLicenseExpired(license) {\n    if (license.IsLicensed !== 'true') {\n        return false;\n    }\n\n    const timeDiff = parseInt(license.ExpiresAt, 10) - Date.now();\n    return timeDiff < 0;\n}\n\nexport function isLicensePastGracePeriod(license) {\n    if (license.IsLicensed !== 'true') {\n        return false;\n    }\n\n    const timeDiff = Date.now() - parseInt(license.ExpiresAt, 10);\n    return timeDiff > LICENSE_GRACE_PERIOD;\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {ActionTypes} from 'utils/constants';\n\nexport function incrementAnnouncementBarCount() {\n    return {\n        type: ActionTypes.TRACK_ANNOUNCEMENT_BAR,\n    };\n}\n\nexport function decrementAnnouncementBarCount() {\n    return {\n        type: ActionTypes.DISMISS_ANNOUNCEMENT_BAR,\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {Tooltip} from 'react-bootstrap';\n\nimport {Constants, AnnouncementBarTypes} from 'utils/constants';\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\nimport OverlayTrigger from 'components/overlay_trigger';\n\nexport default class AnnouncementBar extends React.PureComponent {\n    static propTypes = {\n        showCloseButton: PropTypes.bool,\n        color: PropTypes.string,\n        textColor: PropTypes.string,\n        type: PropTypes.string,\n        message: PropTypes.node.isRequired,\n        handleClose: PropTypes.func,\n        announcementBarCount: PropTypes.number.isRequired,\n        actions: PropTypes.shape({\n            incrementAnnouncementBarCount: PropTypes.func.isRequired,\n            decrementAnnouncementBarCount: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    static defaultProps = {\n        showCloseButton: false,\n        color: '',\n        textColor: '',\n        type: AnnouncementBarTypes.CRITICAL,\n        handleClose: null,\n    }\n\n    componentDidMount() {\n        this.props.actions.incrementAnnouncementBarCount();\n\n        document.body.classList.add('announcement-bar--fixed');\n    }\n\n    componentWillUnmount() {\n        if (this.props.announcementBarCount === 1) {\n            document.body.classList.remove('announcement-bar--fixed');\n        }\n\n        this.props.actions.decrementAnnouncementBarCount();\n    }\n\n    handleClose = (e) => {\n        e.preventDefault();\n        if (this.props.handleClose) {\n            this.props.handleClose();\n        }\n    }\n\n    render() {\n        if (!this.props.message) {\n            return null;\n        }\n\n        let barClass = 'announcement-bar';\n        const barStyle = {};\n        const linkStyle = {};\n        if (this.props.color && this.props.textColor) {\n            barStyle.backgroundColor = this.props.color;\n            barStyle.color = this.props.textColor;\n            linkStyle.color = this.props.textColor;\n        } else if (this.props.type === AnnouncementBarTypes.DEVELOPER) {\n            barClass = 'announcement-bar announcement-bar-developer';\n        } else if (this.props.type === AnnouncementBarTypes.CRITICAL) {\n            barClass = 'announcement-bar announcement-bar-critical';\n        } else if (this.props.type === AnnouncementBarTypes.SUCCESS) {\n            barClass = 'announcement-bar announcement-bar-success';\n        }\n\n        let closeButton;\n        if (this.props.showCloseButton) {\n            closeButton = (\n                <a\n                    href='#'\n                    className='announcement-bar__close'\n                    style={linkStyle}\n                    onClick={this.handleClose}\n                >\n                    {''}\n                </a>\n            );\n        }\n\n        let message = this.props.message;\n        if (typeof message == 'string') {\n            message = (\n                <FormattedMarkdownMessage id={this.props.message}/>\n            );\n        }\n\n        const announcementTooltip = (\n            <Tooltip id='announcement-bar__tooltip'>\n                {message}\n            </Tooltip>\n        );\n\n        return (\n            <div\n                className={barClass}\n                style={barStyle}\n            >\n                <OverlayTrigger\n                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                    placement='bottom'\n                    overlay={announcementTooltip}\n                >\n                    <span>\n                        {message}\n                    </span>\n                </OverlayTrigger>\n                {closeButton}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {incrementAnnouncementBarCount, decrementAnnouncementBarCount} from 'actions/views/announcement_bar';\nimport {getAnnouncementBarCount} from 'selectors/views/announcement_bar';\n\nimport AnnouncementBar from './announcement_bar.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        announcementBarCount: getAnnouncementBarCount(state)\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            incrementAnnouncementBarCount,\n            decrementAnnouncementBarCount,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AnnouncementBar);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {trackEvent} from 'actions/diagnostics_actions.jsx';\nimport Markdown from 'components/markdown';\n\nimport AnnouncementBar from './default_announcement_bar';\n\nconst localStoragePrefix = '__announcement__';\n\nexport default class TextDismissableBar extends React.PureComponent {\n    static propTypes = {\n        allowDismissal: PropTypes.bool.isRequired,\n        text: PropTypes.string.isRequired,\n        onDismissal: PropTypes.func,\n\n        // Any props that AnnouncementBar supports\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            dismissed: true,\n        };\n    }\n\n    static getDerivedStateFromProps(props) {\n        const dismissed = localStorage.getItem(localStoragePrefix + props.text);\n        return {\n            dismissed,\n        };\n    }\n\n    handleDismiss = () => {\n        if (!this.props.allowDismissal) {\n            return;\n        }\n        trackEvent('signup', 'click_dismiss_bar');\n\n        localStorage.setItem(localStoragePrefix + this.props.text, true);\n        this.setState({\n            dismissed: true,\n        });\n        if (this.props.onDismissal) {\n            this.props.onDismissal();\n        }\n    }\n\n    render() {\n        if (this.state.dismissed) {\n            return null;\n        }\n        const {allowDismissal, text, ...extraProps} = this.props;\n        return (\n            <AnnouncementBar\n                {...extraProps}\n                showCloseButton={allowDismissal}\n                handleClose={this.handleDismiss}\n                message={\n                    <Markdown\n                        message={text}\n                        options={{\n                            singleline: true,\n                            mentionHighlight: false\n                        }}\n                    />\n                }\n            />\n        );\n    }\n}\n\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {FormattedMessage, injectIntl} from 'react-intl';\n\nimport {isLicenseExpired, isLicenseExpiring, isLicensePastGracePeriod} from 'utils/license_utils.jsx';\nimport {AnnouncementBarTypes, AnnouncementBarMessages} from 'utils/constants';\nimport {intlShape} from 'utils/react_intl';\n\nimport {t} from 'utils/i18n';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\n\nimport AnnouncementBar from '../default_announcement_bar';\nimport TextDismissableBar from '../text_dismissable_bar';\n\nconst RENEWAL_LINK = 'https://licensing.mattermost.com/renew';\n\nclass ConfigurationAnnouncementBar extends React.PureComponent {\n    static propTypes = {\n        config: PropTypes.object,\n        intl: intlShape.isRequired,\n        license: PropTypes.object,\n        user: PropTypes.object,\n        canViewSystemErrors: PropTypes.bool.isRequired,\n        totalUsers: PropTypes.number,\n        dismissedExpiringLicense: PropTypes.bool,\n        siteURL: PropTypes.string.isRequired,\n        actions: PropTypes.shape({\n            dismissNotice: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    dismissExpiringLicense = () => {\n        this.props.actions.dismissNotice(AnnouncementBarMessages.LICENSE_EXPIRING);\n    }\n\n    render() {\n        // System administrators\n        if (this.props.canViewSystemErrors) {\n            const renewalLink = RENEWAL_LINK + '?id=' + this.props.license.id + '&user_count=' + this.props.totalUsers;\n            if (isLicensePastGracePeriod(this.props.license)) {\n                return (\n                    <AnnouncementBar\n                        type={AnnouncementBarTypes.CRITICAL}\n                        message={\n                            <FormattedMarkdownMessage\n                                id={AnnouncementBarMessages.LICENSE_EXPIRED}\n                                defaultMessage='Enterprise license is expired and some features may be disabled. [Please renew](!{link}).'\n                                values={{\n                                    link: renewalLink,\n                                }}\n                            />\n                        }\n                    />\n                );\n            }\n\n            if (isLicenseExpired(this.props.license)) {\n                return (\n                    <AnnouncementBar\n                        type={AnnouncementBarTypes.CRITICAL}\n                        message={\n                            <FormattedMarkdownMessage\n                                id={AnnouncementBarMessages.LICENSE_EXPIRED}\n                                defaultMessage='Enterprise license is expired and some features may be disabled. [Please renew](!{link}).'\n                                values={{\n                                    link: renewalLink,\n                                }}\n                            />\n                        }\n                    />\n                );\n            }\n\n            if (isLicenseExpiring(this.props.license) && !this.props.dismissedExpiringLicense) {\n                return (\n                    <AnnouncementBar\n                        showCloseButton={true}\n                        handleClose={this.dismissExpiringLicense}\n                        type={AnnouncementBarTypes.ANNOUNCEMENT}\n                        message={\n                            <FormattedMarkdownMessage\n                                id={AnnouncementBarMessages.LICENSE_EXPIRING}\n                                defaultMessage='Enterprise license expires on {date, date, long}. [Please renew](!{link}).'\n                                values={{\n                                    date: new Date(parseInt(this.props.license.ExpiresAt, 10)),\n                                    link: renewalLink,\n                                }}\n                            />\n                        }\n                    />\n                );\n            }\n        } else {\n            // Regular users\n            if (isLicensePastGracePeriod(this.props.license)) { //eslint-disable-line no-lonely-if\n                return (\n                    <AnnouncementBar\n                        type={AnnouncementBarTypes.CRITICAL}\n                        message={\n                            <FormattedMessage\n                                id={AnnouncementBarMessages.LICENSE_PAST_GRACE}\n                                defaultMessage='Enterprise license is expired and some features may be disabled. Please contact your System Administrator for details.'\n                            />\n                        }\n                    />\n                );\n            }\n        }\n\n        const {formatMessage} = this.props.intl;\n\n        if (this.props.config.SendEmailNotifications !== 'true' &&\n            this.props.config.EnablePreviewModeBanner === 'true'\n        ) {\n            const emailMessage = formatMessage({\n                id: AnnouncementBarMessages.PREVIEW_MODE,\n                defaultMessage: 'Preview Mode: Email notifications have not been configured',\n            });\n\n            return (\n                <TextDismissableBar\n                    allowDismissal={true}\n                    text={emailMessage}\n                    type={AnnouncementBarTypes.ANNOUNCEMENT}\n                />\n            );\n        }\n\n        if (this.props.canViewSystemErrors && this.props.config.SiteURL === '') {\n            let id;\n            let defaultMessage;\n            if (this.props.config.EnableSignUpWithGitLab === 'true') {\n                id = t('announcement_bar.error.site_url_gitlab.full');\n                defaultMessage = 'Please configure your [site URL](https://docs.mattermost.com/administration/config-settings.html#site-url) either on the [System Console](/admin_console/environment/web_server) or, if you\\'re using GitLab Mattermost, in gitlab.rb.';\n            } else {\n                id = t('announcement_bar.error.site_url.full');\n                defaultMessage = 'Please configure your [site URL](https://docs.mattermost.com/administration/config-settings.html#site-url) on the [System Console](/admin_console/environment/web_server).';\n            }\n\n            const values = {siteURL: this.props.siteURL};\n            const siteURLMessage = formatMessage({id, defaultMessage}, values);\n\n            return (\n                <TextDismissableBar\n                    allowDismissal={true}\n                    text={siteURLMessage}\n                    type={AnnouncementBarTypes.ANNOUNCEMENT}\n                />\n            );\n        }\n\n        return null;\n    }\n}\n\nexport default injectIntl(ConfigurationAnnouncementBar);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {AnnouncementBarMessages} from 'utils/constants';\nimport {dismissNotice} from 'actions/views/notice';\nimport {getSiteURL} from 'utils/url';\n\nimport ConfigurationBar from './configuration_bar.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        siteURL: getSiteURL(state),\n        dismissedExpiringLicense: Boolean(state.views.notice.hasBeenDismissed[AnnouncementBarMessages.LICENSE_EXPIRING]),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            dismissNotice,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ConfigurationBar);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {FormattedMessage} from 'react-intl';\n\nimport {equalServerVersions} from 'utils/server_version';\nimport {AnnouncementBarTypes} from 'utils/constants';\n\nimport AnnouncementBar from '../default_announcement_bar';\n\nexport default class VersionBar extends React.PureComponent {\n    static propTypes = {\n        serverVersion: PropTypes.string,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            serverVersionOnAppLoad: props.serverVersion,\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        if (!state.serverVersionOnAppLoad && props.serverVersion) {\n            return {\n                serverVersionOnAppLoad: props.serverVersion,\n            };\n        }\n\n        return null;\n    }\n\n    reloadPage = () => {\n        window.location.reload();\n    }\n\n    render() {\n        const {serverVersionOnAppLoad} = this.state;\n        const {serverVersion} = this.props;\n\n        if (!serverVersionOnAppLoad) {\n            return null;\n        }\n\n        if (!equalServerVersions(serverVersionOnAppLoad, serverVersion)) {\n            return (\n                <AnnouncementBar\n                    type={AnnouncementBarTypes.ANNOUNCEMENT}\n                    message={\n                        <React.Fragment>\n                            <FormattedMessage\n                                id='version_bar.new'\n                                defaultMessage='A new version of Mattermost is available.'\n                            />\n                            {' '}\n                            <a onClick={this.reloadPage}>\n                                <FormattedMessage\n                                    id='version_bar.refresh'\n                                    defaultMessage='Refresh the app now'\n                                />\n                            </a>\n                            {'.'}\n                        </React.Fragment>\n                    }\n                />\n            );\n        }\n\n        return null;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport VersionBar from './version_bar.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        serverVersion: state.entities.general.serverVersion,\n    };\n}\n\nexport default connect(mapStateToProps)(VersionBar);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport ConfigurationAnnouncementBar from './configuration_bar';\nimport VersionBar from './version_bar';\nimport TextDismissableBar from './text_dismissable_bar.jsx';\nimport AnnouncementBar from './default_announcement_bar';\n\nexport default class AnnouncementBarController extends React.PureComponent {\n    static propTypes = {\n        license: PropTypes.object,\n        config: PropTypes.object,\n        user: PropTypes.shape({\n            email: PropTypes.string.isRequired,\n            email_verified: PropTypes.bool,\n        }),\n        canViewSystemErrors: PropTypes.bool.isRequired,\n        latestError: PropTypes.object,\n        totalUsers: PropTypes.number,\n        actions: PropTypes.shape({\n            dismissError: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    render() {\n        let adminConfiguredAnnouncementBar = null;\n        if (this.props.config.EnableBanner === 'true' && this.props.config.BannerText.trim()) {\n            adminConfiguredAnnouncementBar = (\n                <TextDismissableBar\n                    color={this.props.config.BannerColor}\n                    textColor={this.props.config.BannerTextColor}\n                    allowDismissal={this.props.config.AllowBannerDismissal === 'true'}\n                    text={this.props.config.BannerText}\n                />\n            );\n        }\n\n        let errorBar = null;\n        if (this.props.latestError) {\n            errorBar = (\n                <AnnouncementBar\n                    type={this.props.latestError.error.type}\n                    message={this.props.latestError.error.message}\n                    showCloseButton={true}\n                    handleClose={this.props.actions.dismissError}\n                />\n            );\n        }\n\n        return (\n            <React.Fragment>\n                {adminConfiguredAnnouncementBar}\n                {errorBar}\n                <VersionBar/>\n                <ConfigurationAnnouncementBar\n                    config={this.props.config}\n                    license={this.props.license}\n                    canViewSystemErrors={this.props.canViewSystemErrors}\n                    totalUsers={this.props.totalUsers}\n                    user={this.props.user}\n                />\n            </React.Fragment>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\nimport {haveISystemPermission} from 'mattermost-redux/selectors/entities/roles';\nimport {Permissions} from 'mattermost-redux/constants';\nimport {getConfig, getLicense} from 'mattermost-redux/selectors/entities/general';\nimport {getDisplayableErrors} from 'mattermost-redux/selectors/errors';\nimport {dismissError} from 'mattermost-redux/actions/errors';\nimport {getStandardAnalytics} from 'mattermost-redux/actions/admin';\n\nimport {dismissNotice} from 'actions/views/notice';\n\nimport AnnouncementBarController from './announcement_bar_controller.jsx';\n\nfunction mapStateToProps(state) {\n    const canViewSystemErrors = haveISystemPermission(state, {permission: Permissions.MANAGE_SYSTEM});\n    const license = getLicense(state);\n    const config = getConfig(state);\n    const user = getCurrentUser(state);\n    const errors = getDisplayableErrors(state);\n    const totalUsers = state.entities.admin.analytics.TOTAL_USERS;\n    let latestError = null;\n    if (errors && errors.length >= 1) {\n        latestError = errors[0];\n    }\n\n    return {\n        license,\n        config,\n        user,\n        canViewSystemErrors,\n        latestError,\n        totalUsers,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    const dismissFirstError = dismissError.bind(null, 0);\n    return {\n        actions: bindActionCreators({\n            getStandardAnalytics,\n            dismissError: dismissFirstError,\n            dismissNotice,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AnnouncementBarController);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nexport default class SystemPermissionGate extends React.Component {\n    static defaultProps = {\n        invert: false,\n    }\n\n    static propTypes = {\n\n        /**\n         * Permissions enough to pass the gate (binary OR)\n         */\n        permissions: PropTypes.arrayOf(PropTypes.string).isRequired,\n\n        /**\n         * Has permission\n         * This prop is will always be passed by the mapStateToProps function\n         * it should be required when this component is converted to TS, for now its optional to make the TS compiler quite.\n         * about this prop not being passed from where this component is used\n         */\n        hasPermission: PropTypes.bool,\n\n        /**\n         * Invert the permission (used for else)\n         */\n        invert: PropTypes.bool.isRequired,\n\n        /**\n         * Content protected by the permissions gate\n         */\n        children: PropTypes.node.isRequired,\n    };\n\n    render() {\n        if (this.props.hasPermission && !this.props.invert) {\n            return this.props.children;\n        }\n        if (!this.props.hasPermission && this.props.invert) {\n            return this.props.children;\n        }\n        return null;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {haveISystemPermission} from 'mattermost-redux/selectors/entities/roles';\n\nimport SystemPermissionGate from './system_permission_gate.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    for (const permission of ownProps.permissions) {\n        if (haveISystemPermission(state, {permission})) {\n            return {hasPermission: true};\n        }\n    }\n\n    return {hasPermission: false};\n}\n\nexport default connect(mapStateToProps)(SystemPermissionGate);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\ntype Props = {\n\n    /**\n     * Team to check the permission\n     */\n    teamId?: string;\n\n    /**\n     * Permissions enough to pass the gate (binary OR)\n     */\n    permissions: Array<string>;\n\n    /**\n     * Has permission\n     */\n    hasPermission: boolean;\n\n    /**\n     * Invert the permission (used for else)\n     */\n    invert: boolean;\n\n    /**\n     * Content protected by the permissions gate\n     */\n    children: React.ReactNode;\n};\n\nexport default class TeamPermissionGate extends React.Component<Props> {\n    public static defaultProps = {\n        invert: false,\n    }\n\n    render() {\n        if (this.props.hasPermission && !this.props.invert) {\n            return this.props.children;\n        }\n        if (!this.props.hasPermission && this.props.invert) {\n            return this.props.children;\n        }\n        return null;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\n\nimport {GlobalState} from 'types/store';\n\nimport TeamPermissionGate from './team_permission_gate';\n\ntype Props = {\n    teamId: string;\n    permissions: Array<string>;\n}\n\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\n    if (!ownProps.teamId) {\n        return {hasPermission: false};\n    }\n\n    for (const permission of ownProps.permissions) {\n        if (haveITeamPermission(state, {team: ownProps.teamId, permission})) {\n            return {hasPermission: true};\n        }\n    }\n\n    return {hasPermission: false};\n}\n\nexport default connect(mapStateToProps)(TeamPermissionGate);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent, ReactNode} from 'react';\n\nimport LoadingWrapper from 'components/widgets/loading/loading_wrapper';\n\ntype Props = {\n    children?: ReactNode;\n    spinning: boolean;\n    spinningText: ReactNode;\n    onClick?: (event: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void;\n}\n\nexport default class SpinnerButton extends PureComponent<Props> {\n    public static defaultProps: Partial<Props> = {\n        spinning: false,\n    }\n\n    public render(): JSX.Element {\n        const {spinning, spinningText, children, ...props} = this.props; // eslint-disable-line no-use-before-define\n\n        return (\n            <button\n                className='btn btn-primary'\n                disabled={spinning}\n                {...props}\n            >\n                <LoadingWrapper\n                    loading={spinning}\n                    text={spinningText}\n                >\n                    {children}\n                </LoadingWrapper>\n            </button>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport EventEmitter from 'mattermost-redux/utils/event_emitter';\n\nimport QuickInput from 'components/quick_input.jsx';\nimport Constants from 'utils/constants';\nimport * as UserAgent from 'utils/user_agent';\nimport * as Utils from 'utils/utils.jsx';\n\nconst KeyCodes = Constants.KeyCodes;\n\nexport default class SuggestionBox extends React.Component {\n    static propTypes = {\n\n        /**\n         * The list component to render, usually SuggestionList\n         */\n        listComponent: PropTypes.func.isRequired,\n\n        /**\n         * The date component to render\n         */\n        dateComponent: PropTypes.func,\n\n        /**\n         * The value of in the input\n         */\n        value: PropTypes.string.isRequired,\n\n        /**\n         * Array of suggestion providers\n         */\n        providers: PropTypes.arrayOf(PropTypes.object),\n\n        /**\n         * Where the list will be displayed relative to the input box, defaults to 'top'\n         */\n        listStyle: PropTypes.string,\n\n        /**\n         * CSS class for the div parent of the input box\n         */\n        containerClass: PropTypes.string,\n\n        /**\n         * Set to true to draw dividers between types of list items, defaults to false\n         */\n        renderDividers: PropTypes.bool,\n\n        /**\n         * Set to true to render a message when there were no results found, defaults to false\n         */\n        renderNoResults: PropTypes.bool,\n\n        /**\n         * Set to allow TAB to select an item in the list, defaults to true\n         */\n        completeOnTab: PropTypes.bool,\n\n        /**\n         * Function called when input box gains focus\n         */\n        onFocus: PropTypes.func,\n\n        /**\n         * Function called when input box loses focus\n         */\n        onBlur: PropTypes.func,\n\n        /**\n         * Function called when input box value changes\n         */\n        onChange: PropTypes.func,\n\n        /**\n         * Function called when a key is pressed and the input box is in focus\n         */\n        onKeyDown: PropTypes.func,\n        onComposition: PropTypes.func,\n\n        /**\n         * Function called when an item is selected\n         */\n        onItemSelected: PropTypes.func,\n\n        /**\n         * Flags if the suggestion_box is for the RHS (Reply).\n         */\n        isRHS: PropTypes.bool,\n\n        /**\n         * The number of characters required to show the suggestion list, defaults to 1\n         */\n        requiredCharacters: PropTypes.number,\n\n        /**\n         * If true, the suggestion box is opened on focus, default to false\n         */\n        openOnFocus: PropTypes.bool,\n\n        /**\n         * If true, the suggestion box is disabled\n         */\n        disabled: PropTypes.bool,\n\n        /**\n         * If true, it displays allow to display a default list when empty\n         */\n        openWhenEmpty: PropTypes.bool,\n\n        /**\n         * If true, replace all input in the suggestion box with the selected option after a select, defaults to false\n         */\n        replaceAllInputOnSelect: PropTypes.bool,\n\n        /**\n         * An optional, opaque identifier that distinguishes the context in which the suggestion\n         * box is rendered. This allows the reused component to otherwise respond to changes.\n         */\n        contextId: PropTypes.string,\n\n        /**\n         * If true, listen for clicks on a mention and populate the input with said mention, defaults to false\n         */\n        listenForMentionKeyClick: PropTypes.bool,\n\n        /**\n         * Passes the wrapper reference for height calculation\n         */\n        wrapperHeight: PropTypes.number,\n    }\n\n    static defaultProps = {\n        listStyle: 'top',\n        containerClass: '',\n        renderDividers: false,\n        renderNoResults: false,\n        completeOnTab: true,\n        isRHS: false,\n        requiredCharacters: 1,\n        openOnFocus: false,\n        openWhenEmpty: false,\n        replaceAllInputOnSelect: false,\n        listenForMentionKeyClick: false,\n    }\n\n    constructor(props) {\n        super(props);\n        this.suggestionReadOut = React.createRef();\n\n        // Keep track of whether we're composing a CJK character so we can make suggestions for partial characters\n        this.composing = false;\n\n        this.pretext = '';\n\n        // Used for debouncing pretext changes\n        this.timeoutId = '';\n\n        // Used for preventing suggestion list to close when scrollbar is clicked\n        this.preventSuggestionListCloseFlag = false;\n\n        // pretext: the text before the cursor\n        // matchedPretext: a list of the text before the cursor that will be replaced if the corresponding autocomplete term is selected\n        // terms: a list of strings which the previously typed text may be replaced by\n        // items: a list of objects backing the terms which may be used in rendering\n        // components: a list of react components that can be used to render their corresponding item\n        // selection: the term currently selected by the keyboard\n        this.state = {\n            focused: false,\n            cleared: true,\n            matchedPretext: [],\n            items: [],\n            terms: [],\n            components: [],\n            selection: '',\n            allowDividers: true,\n            presentationType: 'text',\n        };\n\n        this.inputRef = React.createRef();\n    }\n\n    componentDidMount() {\n        if (this.props.listenForMentionKeyClick) {\n            EventEmitter.addListener('mention_key_click', this.handleMentionKeyClick);\n        }\n    }\n\n    componentWillUnmount() {\n        EventEmitter.removeListener('mention_key_click', this.handleMentionKeyClick);\n    }\n\n    componentDidUpdate(prevProps) {\n        const {value} = this.props;\n\n        // Post was just submitted, update pretext property.\n        if (value === '' && this.pretext !== value) {\n            this.handlePretextChanged(value);\n            return;\n        }\n\n        if (prevProps.contextId !== this.props.contextId) {\n            const textbox = this.getTextbox();\n            const pretext = textbox.value.substring(0, textbox.selectionEnd).toLowerCase();\n\n            this.handlePretextChanged(pretext);\n        }\n    }\n\n    handleMentionKeyClick = (mentionKey, isRHS) => {\n        if (this.props.isRHS !== isRHS) {\n            return;\n        }\n\n        let insertText = '@' + mentionKey;\n\n        // if the current text does not end with a whitespace, then insert a space\n        if (this.props.value && (/[^\\s]$/).test(this.props.value)) {\n            insertText = ' ' + insertText;\n        }\n\n        this.addTextAtCaret(insertText, '');\n    }\n\n    getTextbox = () => {\n        if (!this.inputRef.current) {\n            return null;\n        }\n\n        const input = this.inputRef.current.getInput();\n\n        if (input.getDOMNode) {\n            return input.getDOMNode();\n        }\n\n        return input;\n    }\n\n    recalculateSize = () => {\n        // Pretty hacky way to force an AutosizeTextarea to recalculate its height if that's what\n        // we're rendering as the input\n        const input = this.inputRef.current.getInput();\n\n        if (input.recalculateSize) {\n            input.recalculateSize();\n        }\n    }\n\n    handleEmitClearSuggestions = (delay = 0) => {\n        setTimeout(() => {\n            this.clear();\n        }, delay);\n    }\n\n    preventSuggestionListClose = () => {\n        this.preventSuggestionListCloseFlag = true;\n    }\n\n    handleFocusOut = (e) => {\n        if (this.preventSuggestionListCloseFlag) {\n            this.preventSuggestionListCloseFlag = false;\n            return;\n        }\n\n        // Focus is switching TO e.relatedTarget, so only treat this as a blur event if we're not switching\n        // between children (like from the textbox to the suggestion list)\n        if (this.container.contains(e.relatedTarget)) {\n            return;\n        }\n\n        if (UserAgent.isIos() && !e.relatedTarget) {\n            // On Safari and iOS classic app, the autocomplete stays open\n            // when you tap outside of the post textbox or search box.\n            return;\n        }\n\n        this.handleEmitClearSuggestions();\n\n        this.setState({focused: false});\n\n        if (this.props.onBlur) {\n            this.props.onBlur();\n        }\n    };\n\n    handleFocusIn = (e) => {\n        // Focus is switching FROM e.relatedTarget, so only treat this as a focus event if we're not switching\n        // between children (like from the textbox to the suggestion list). PreventSuggestionListCloseFlag is\n        // checked because if true, it means that the focusIn comes from a click in the suggestion box, an\n        // option choice, so we don't want the focus event to be triggered\n        if (this.container.contains(e.relatedTarget) || this.preventSuggestionListCloseFlag) {\n            return;\n        }\n\n        this.setState({focused: true});\n\n        if (this.props.openOnFocus || this.props.openWhenEmpty) {\n            setTimeout(() => {\n                const textbox = this.getTextbox();\n                if (textbox) {\n                    const pretext = textbox.value.substring(0, textbox.selectionEnd);\n                    if (this.props.openWhenEmpty || pretext.length >= this.props.requiredCharacters) {\n                        this.handlePretextChanged(pretext);\n                    }\n                }\n            });\n        }\n\n        if (this.props.onFocus) {\n            this.props.onFocus();\n        }\n    };\n\n    handleChange = (e) => {\n        const textbox = this.getTextbox();\n        const pretext = textbox.value.substring(0, textbox.selectionEnd).toLowerCase();\n\n        if (!this.composing && this.pretext !== pretext) {\n            this.handlePretextChanged(pretext);\n        }\n\n        if (this.props.onChange) {\n            this.props.onChange(e);\n        }\n    }\n\n    handleCompositionStart = () => {\n        this.composing = true;\n        if (this.props.onComposition) {\n            this.props.onComposition();\n        }\n    }\n\n    handleCompositionUpdate = (e) => {\n        if (!e.data) {\n            return;\n        }\n\n        // The caret appears before the CJK character currently being composed, so re-add it to the pretext\n        const textbox = this.getTextbox();\n        const pretext = textbox.value.substring(0, textbox.selectionStart) + e.data;\n\n        this.handlePretextChanged(pretext);\n        if (this.props.onComposition) {\n            this.props.onComposition();\n        }\n    }\n\n    handleCompositionEnd = () => {\n        this.composing = false;\n        if (this.props.onComposition) {\n            this.props.onComposition();\n        }\n    }\n\n    addTextAtCaret = (term, matchedPretext) => {\n        const textbox = this.getTextbox();\n        const caret = textbox.selectionEnd;\n        const text = this.props.value;\n        const pretext = textbox.value.substring(0, textbox.selectionEnd);\n\n        let prefix;\n        let keepPretext = false;\n        if (pretext.toLowerCase().endsWith(matchedPretext.toLowerCase())) {\n            prefix = pretext.substring(0, pretext.length - matchedPretext.length);\n        } else {\n            // the pretext has changed since we got a term to complete so see if the term still fits the pretext\n            const termWithoutMatched = term.substring(matchedPretext.length);\n            const overlap = SuggestionBox.findOverlap(pretext, termWithoutMatched);\n\n            keepPretext = overlap.length === 0;\n            prefix = pretext.substring(0, pretext.length - overlap.length - matchedPretext.length);\n        }\n\n        const suffix = text.substring(caret);\n\n        let newValue;\n        if (keepPretext) {\n            newValue = pretext;\n        } else {\n            newValue = prefix + term + ' ' + suffix;\n        }\n\n        textbox.value = newValue;\n\n        if (this.props.onChange) {\n            // fake an input event to send back to parent components\n            const e = {\n                target: textbox,\n            };\n\n            // don't call handleChange or we'll get into an event loop\n            this.props.onChange(e);\n        }\n\n        // set the caret position after the next rendering\n        window.requestAnimationFrame(() => {\n            if (textbox.value === newValue) {\n                Utils.setCaretPosition(textbox, prefix.length + term.length + 1);\n            }\n        });\n    }\n\n    replaceText = (term) => {\n        const textbox = this.getTextbox();\n        textbox.value = term;\n\n        if (this.props.onChange) {\n            // fake an input event to send back to parent components\n            const e = {\n                target: textbox,\n            };\n\n            // don't call handleChange or we'll get into an event loop\n            this.props.onChange(e);\n        }\n    }\n\n    handleCompleteWord = (term, matchedPretext) => {\n        if (this.props.replaceAllInputOnSelect) {\n            this.replaceText(term);\n        } else {\n            this.addTextAtCaret(term, matchedPretext);\n        }\n\n        if (this.props.onItemSelected) {\n            const items = this.state.items;\n            const terms = this.state.terms;\n            for (let i = 0; i < terms.length; i++) {\n                if (terms[i] === term) {\n                    this.props.onItemSelected(items[i]);\n                    break;\n                }\n            }\n        }\n\n        this.clear();\n\n        this.inputRef.current.focus();\n\n        for (const provider of this.props.providers) {\n            if (provider.handleCompleteWord) {\n                provider.handleCompleteWord(term, matchedPretext);\n            }\n        }\n    }\n\n    selectNext = () => {\n        this.setSelectionByDelta(1);\n    }\n\n    selectPrevious = () => {\n        this.setSelectionByDelta(-1);\n    }\n\n    setSelectionByDelta = (delta) => {\n        let selectionIndex = this.state.terms.indexOf(this.state.selection);\n\n        if (selectionIndex === -1) {\n            this.setState({\n                selection: '',\n            });\n            return;\n        }\n\n        selectionIndex += delta;\n\n        if (selectionIndex < 0) {\n            selectionIndex = 0;\n        } else if (selectionIndex > this.state.terms.length - 1) {\n            selectionIndex = this.state.terms.length - 1;\n        }\n\n        this.setState({\n            selection: this.state.terms[selectionIndex],\n        });\n    }\n\n    setSelection = (term) => {\n        this.setState({\n            selection: term,\n        });\n    }\n\n    clear = () => {\n        if (!this.state.cleared) {\n            this.setState({\n                cleared: true,\n                matchedPretext: [],\n                terms: [],\n                items: [],\n                components: [],\n                selection: '',\n            });\n        }\n    }\n\n    hasSuggestions = () => {\n        return this.state.items.some((item) => !item.loading);\n    }\n\n    handleKeyDown = (e) => {\n        if ((this.props.openWhenEmpty || this.props.value) && this.hasSuggestions()) {\n            if (Utils.isKeyPressed(e, KeyCodes.UP)) {\n                this.selectPrevious();\n                e.preventDefault();\n            } else if (Utils.isKeyPressed(e, KeyCodes.DOWN)) {\n                this.selectNext();\n                e.preventDefault();\n            } else if (Utils.isKeyPressed(e, KeyCodes.ENTER) || (this.props.completeOnTab && Utils.isKeyPressed(e, KeyCodes.TAB))) {\n                let matchedPretext = '';\n                for (let i = 0; i < this.state.terms.length; i++) {\n                    if (this.state.terms[i] === this.state.selection) {\n                        matchedPretext = this.state.matchedPretext[i];\n                    }\n                }\n\n                // If these don't match, the user typed quickly and pressed enter before we could\n                // update the pretext, so update the pretext before completing\n                if (this.pretext.endsWith(matchedPretext)) {\n                    this.handleCompleteWord(this.state.selection, matchedPretext);\n                } else {\n                    clearTimeout(this.timeoutId);\n                    this.nonDebouncedPretextChanged(this.pretext, true);\n                }\n\n                if (this.props.onKeyDown) {\n                    this.props.onKeyDown(e);\n                }\n                e.preventDefault();\n            } else if (Utils.isKeyPressed(e, KeyCodes.ESCAPE)) {\n                this.clear();\n                this.setState({presentationType: 'text'});\n                e.preventDefault();\n                e.stopPropagation();\n            } else if (this.props.onKeyDown) {\n                this.props.onKeyDown(e);\n            }\n        } else if (this.props.onKeyDown) {\n            this.props.onKeyDown(e);\n        }\n    }\n\n    handleReceivedSuggestions = (suggestions) => {\n        const newComponents = [];\n        const newPretext = [];\n        for (let i = 0; i < suggestions.terms.length; i++) {\n            newComponents.push(suggestions.component);\n            newPretext.push(suggestions.matchedPretext);\n        }\n        const terms = suggestions.terms;\n        const items = suggestions.items;\n        let selection = this.state.selection;\n        if (terms.length > 0) {\n            // if the current selection is no longer in the map, select the first term in the list\n            if (!this.state.selection || terms.indexOf(this.state.selection) === -1) {\n                selection = terms[0];\n            }\n        } else if (this.state.selection) {\n            selection = '';\n        }\n\n        this.setState({\n            cleared: false,\n            selection,\n            terms,\n            items,\n            components: newComponents,\n            matchedPretext: newPretext,\n        });\n\n        return {selection, matchedPretext: suggestions.matchedPretext};\n    }\n\n    handleReceivedSuggestionsAndComplete = (suggestions) => {\n        const {selection, matchedPretext} = this.handleReceivedSuggestions(suggestions);\n        if (selection) {\n            this.handleCompleteWord(selection, matchedPretext);\n        }\n    }\n\n    nonDebouncedPretextChanged = (pretext, complete = false) => {\n        this.pretext = pretext;\n        let handled = false;\n        let callback = this.handleReceivedSuggestions;\n        if (complete) {\n            callback = this.handleReceivedSuggestionsAndComplete;\n        }\n        for (const provider of this.props.providers) {\n            handled = provider.handlePretextChanged(pretext, callback) || handled;\n\n            if (handled) {\n                this.setState({\n                    presentationType: provider.presentationType(),\n                    allowDividers: provider.allowDividers(),\n                });\n\n                break;\n            }\n        }\n        if (!handled) {\n            this.clear();\n        }\n    }\n\n    debouncedPretextChanged = (pretext) => {\n        clearTimeout(this.timeoutId);\n        this.timeoutId = setTimeout(() => this.nonDebouncedPretextChanged(pretext), Constants.SEARCH_TIMEOUT_MILLISECONDS);\n    };\n\n    handlePretextChanged = (pretext) => {\n        this.pretext = pretext;\n        this.debouncedPretextChanged(pretext);\n    }\n\n    blur = () => {\n        this.inputRef.current.blur();\n    }\n\n    setContainerRef = (container) => {\n        // Attach/detach event listeners that aren't supported by React\n        if (this.container) {\n            this.container.removeEventListener('focusin', this.handleFocusIn);\n            this.container.removeEventListener('focusout', this.handleFocusOut);\n        }\n\n        if (container) {\n            container.addEventListener('focusin', this.handleFocusIn);\n            container.addEventListener('focusout', this.handleFocusOut);\n        }\n\n        // Save ref\n        this.container = container;\n    };\n\n    render() {\n        const {\n            listComponent,\n            dateComponent,\n            listStyle,\n            renderNoResults,\n            ...props\n        } = this.props;\n\n        const renderDividers = this.props.renderDividers && this.state.allowDividers;\n\n        // Don't pass props used by SuggestionBox\n        Reflect.deleteProperty(props, 'providers');\n        Reflect.deleteProperty(props, 'onChange'); // We use onInput instead of onChange on the actual input\n        Reflect.deleteProperty(props, 'onComposition');\n        Reflect.deleteProperty(props, 'onItemSelected');\n        Reflect.deleteProperty(props, 'completeOnTab');\n        Reflect.deleteProperty(props, 'isRHS');\n        Reflect.deleteProperty(props, 'requiredCharacters');\n        Reflect.deleteProperty(props, 'openOnFocus');\n        Reflect.deleteProperty(props, 'openWhenEmpty');\n        Reflect.deleteProperty(props, 'onFocus');\n        Reflect.deleteProperty(props, 'onBlur');\n        Reflect.deleteProperty(props, 'containerClass');\n        Reflect.deleteProperty(props, 'replaceAllInputOnSelect');\n        Reflect.deleteProperty(props, 'renderDividers');\n        Reflect.deleteProperty(props, 'contextId');\n        Reflect.deleteProperty(props, 'listenForMentionKeyClick');\n        Reflect.deleteProperty(props, 'wrapperHeight');\n\n        // This needs to be upper case so React doesn't think it's an html tag\n        const SuggestionListComponent = listComponent;\n        const SuggestionDateComponent = dateComponent;\n\n        return (\n            <div\n                ref={this.setContainerRef}\n                className={this.props.containerClass}\n            >\n                <div\n                    ref={this.suggestionReadOut}\n                    aria-live='polite'\n                    role='alert'\n                    className='sr-only'\n                />\n                <QuickInput\n                    ref={this.inputRef}\n                    autoComplete='off'\n                    {...props}\n                    onInput={this.handleChange}\n                    onCompositionStart={this.handleCompositionStart}\n                    onCompositionUpdate={this.handleCompositionUpdate}\n                    onCompositionEnd={this.handleCompositionEnd}\n                    onKeyDown={this.handleKeyDown}\n                />\n                {(this.props.openWhenEmpty || this.props.value.length >= this.props.requiredCharacters) && this.state.presentationType === 'text' &&\n                    <div style={{width: this.state.width}}>\n                        <SuggestionListComponent\n                            ariaLiveRef={this.suggestionReadOut}\n                            open={this.state.focused}\n                            pretext={this.pretext}\n                            location={listStyle}\n                            renderDividers={renderDividers}\n                            renderNoResults={renderNoResults}\n                            onCompleteWord={this.handleCompleteWord}\n                            preventClose={this.preventSuggestionListClose}\n                            onItemHover={this.setSelection}\n                            cleared={this.state.cleared}\n                            matchedPretext={this.state.matchedPretext}\n                            items={this.state.items}\n                            terms={this.state.terms}\n                            selection={this.state.selection}\n                            components={this.state.components}\n                            wrapperHeight={this.props.wrapperHeight}\n                            inputRef={this.inputRef}\n                            onLoseVisibility={this.blur}\n                        />\n                    </div>\n                }\n                {(this.props.openWhenEmpty || this.props.value.length >= this.props.requiredCharacters) && this.state.presentationType === 'date' &&\n                    <SuggestionDateComponent\n                        items={this.state.items}\n                        terms={this.state.terms}\n                        components={this.state.components}\n                        matchedPretext={this.state.matchedPretext}\n                        onCompleteWord={this.handleCompleteWord}\n                    />\n                }\n            </div>\n        );\n    }\n\n    // Finds the longest substring that's at both the end of b and the start of a. For example,\n    // if a = \"firepit\" and b = \"pitbull\", findOverlap would return \"pit\".\n    static findOverlap(a, b) {\n        const aLower = a.toLowerCase();\n        const bLower = b.toLowerCase();\n\n        for (let i = bLower.length; i > 0; i--) {\n            const substring = bLower.substring(0, i);\n\n            if (aLower.endsWith(substring)) {\n                return substring;\n            }\n        }\n\n        return '';\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class ArchiveIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.archive'\n                    defaultMessage='Archive Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='14'\n                            height='14'\n                            viewBox='0 0 14 14'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path d='M8.5 6.5q0-0.203-0.148-0.352t-0.352-0.148h-2q-0.203 0-0.352 0.148t-0.148 0.352 0.148 0.352 0.352 0.148h2q0.203 0 0.352-0.148t0.148-0.352zM13 5v7.5q0 0.203-0.148 0.352t-0.352 0.148h-11q-0.203 0-0.352-0.148t-0.148-0.352v-7.5q0-0.203 0.148-0.352t0.352-0.148h11q0.203 0 0.352 0.148t0.148 0.352zM13.5 1.5v2q0 0.203-0.148 0.352t-0.352 0.148h-12q-0.203 0-0.352-0.148t-0.148-0.352v-2q0-0.203 0.148-0.352t0.352-0.148h12q0.203 0 0.352 0.148t0.148 0.352z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {TeamTypes} from 'mattermost-redux/action_types';\nimport {viewChannel, getChannelStats} from 'mattermost-redux/actions/channels';\nimport * as TeamActions from 'mattermost-redux/actions/teams';\nimport {getCurrentChannelId, isManuallyUnread} from 'mattermost-redux/selectors/entities/channels';\nimport {getUser} from 'mattermost-redux/actions/users';\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\n\nimport {browserHistory} from 'utils/browser_history';\nimport {Preferences} from 'utils/constants';\n\nexport function removeUserFromTeamAndGetStats(teamId, userId) {\n    return async (dispatch, getState) => {\n        const response = await dispatch(TeamActions.removeUserFromTeam(teamId, userId));\n        dispatch(getUser(userId));\n        dispatch(TeamActions.getTeamStats(teamId));\n        dispatch(getChannelStats(getCurrentChannelId(getState())));\n        return response;\n    };\n}\n\nexport function addUserToTeamFromInvite(token, inviteId) {\n    return async (dispatch) => {\n        const {data: member, error} = await dispatch(TeamActions.addUserToTeamFromInvite(token, inviteId));\n        if (member) {\n            const {data} = await dispatch(TeamActions.getTeam(member.team_id));\n\n            dispatch({\n                type: TeamTypes.RECEIVED_MY_TEAM_MEMBER,\n                data: {\n                    ...member,\n                    delete_at: 0,\n                    msg_count: 0,\n                    mention_count: 0,\n                },\n            });\n\n            return {data};\n        }\n        return {error};\n    };\n}\n\nexport function addUserToTeam(teamId, userId) {\n    return async (dispatch) => {\n        const {data: member, error} = await dispatch(TeamActions.addUserToTeam(teamId, userId));\n        if (member) {\n            const {data} = await dispatch(TeamActions.getTeam(member.team_id));\n\n            dispatch({\n                type: TeamTypes.RECEIVED_MY_TEAM_MEMBER,\n                data: {\n                    ...member,\n                    delete_at: 0,\n                    msg_count: 0,\n                    mention_count: 0,\n                },\n            });\n\n            return {data};\n        }\n        return {error};\n    };\n}\n\nexport function addUsersToTeam(teamId, userIds) {\n    return async (dispatch, getState) => {\n        const {data, error} = await dispatch(TeamActions.addUsersToTeamGracefully(teamId, userIds));\n\n        if (error) {\n            return {error};\n        }\n\n        dispatch(getChannelStats(getCurrentChannelId(getState())));\n\n        return {data};\n    };\n}\n\nexport function switchTeam(url) {\n    return (dispatch, getState) => {\n        const state = getState();\n        const currentChannelId = getCurrentChannelId(state);\n        if (!isManuallyUnread(state, currentChannelId)) {\n            dispatch(viewChannel(currentChannelId));\n        }\n\n        browserHistory.push(url);\n    };\n}\n\nexport function updateTeamsOrderForUser(teamIds) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const currentUserId = getCurrentUserId(state);\n        const teamOrderPreferences = [{\n            user_id: currentUserId,\n            name: '',\n            category: Preferences.TEAMS_ORDER,\n            value: teamIds.join(','),\n        }];\n        dispatch(savePreferences(currentUserId, teamOrderPreferences));\n    };\n}","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class SearchIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.search'\n                    defaultMessage='Search Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='14px'\n                            height='14px'\n                            viewBox='0 0 19 18'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g\n                                stroke='inherit'\n                                strokeWidth='1'\n                                fill='none'\n                                fillRule='evenodd'\n                            >\n                                <g\n                                    transform='translate(-719.000000, -20.000000)'\n                                    strokeWidth='1.5'\n                                >\n                                    <g transform='translate(0.000000, 1.000000)'>\n                                        <g transform='translate(63.000000, 10.000000)'>\n                                            <g transform='translate(657.000000, 10.000000)'>\n                                                <circle\n                                                    cx='7'\n                                                    cy='7'\n                                                    r='7'\n                                                />\n                                                <path\n                                                    d='M12.5,11.5 L16.5,15.5'\n                                                    strokeLinecap='round'\n                                                />\n                                            </g>\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {ActionTypes} from 'utils/constants';\n\nexport const toggle = () => (dispatch) => dispatch({\n    type: ActionTypes.TOGGLE_LHS,\n});\n\nexport const open = () => (dispatch) => dispatch({\n    type: ActionTypes.OPEN_LHS,\n});\n\nexport const close = () => (dispatch) => dispatch({\n    type: ActionTypes.CLOSE_LHS,\n});\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport function getNavigationBlocked(state) {\n    return state.views.admin.navigationBlock.blocked;\n}\n\nexport function showNavigationPrompt(state) {\n    return state.views.admin.navigationBlock.showNavigationPrompt;\n}\n\nexport function getOnNavigationConfirmed(state) {\n    return state.views.admin.navigationBlock.onNavigationConfirmed;\n}","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {imageURLForTeam} from 'utils/utils.jsx';\n\nimport './team_icon.scss';\n\ntype Props = {\n\n    /** Team icon URL (when available) */\n    url?: string | null;\n\n    /** Team display name (used for the initials) if icon URL is not set */\n    name: string;\n\n    /**\n     * Size of the icon, \"sm\", \"md\" or \"lg\".\n     *\n     * @default \"regular\"\n     **/\n    size?: 'sm'|'md'|'lg';\n\n    /** Whether to add hover effect to the icon */\n    withHover?: boolean;\n};\n\n/**\n * An icon representing a Team. If `url` is set - shows the image,\n * otherwise shows team initials\n */\nexport class TeamIcon extends React.PureComponent<Props> {\n    public static defaultProps = {\n        size: 'md',\n    };\n\n    public render() {\n        const {name, url, size, withHover} = this.props;\n        const hoverCss = withHover ? '' : 'no-hover';\n\n        // FIXME Nowhere does imageURLForTeam seem to check for display_name.\n        const teamIconUrl = url || imageURLForTeam({display_name: name});\n        let icon;\n        if (teamIconUrl) {\n            icon = (\n                <div\n                    data-testid='teamIconImage'\n                    className={`TeamIcon__image TeamIcon__${size}`}\n                    aria-label={'Team Icon'}\n                    style={{backgroundImage: `url('${teamIconUrl}')`}}\n                />\n            );\n        } else {\n            icon = (\n                <div\n                    data-testid='teamIconInitial'\n                    className={`TeamIcon__initials TeamIcon__initials__${size}`}\n                    aria-label={'Team Initials'}\n                >\n                    {name ? name.replace(/\\s/g, '').substring(0, 2) : '??'}\n                </div>\n            );\n        }\n        return (\n            <div className={`TeamIcon ${hoverCss} TeamIcon__${size}`} >\n                <div className={`TeamIcon__content ${hoverCss}`}>\n                    {icon}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default TeamIcon;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {getOptionValue} from 'react-select/src/builtins';\n\nimport Constants from 'utils/constants';\nimport {cmdOrCtrlPressed} from 'utils/utils.jsx';\n\nimport LoadingScreen from 'components/loading_screen';\n\nimport {Value} from './multiselect';\n\nexport type Props<T extends Value> = {\n    ariaLabelRenderer: getOptionValue<T>;\n    loading?: boolean;\n    onAdd: (value: T) => void;\n    onPageChange?: (newPage: number, currentPage: number) => void;\n    onSelect: (value: T | null) => void;\n    optionRenderer: (\n        option: T,\n        isSelected: boolean,\n        onAdd: (value: T) => void,\n        onMouseMove: (value: T) => void\n    ) => void;\n    options: T[];\n    page: number;\n    perPage: number;\n}\n\ntype State = {\n    selected: number;\n}\nconst KeyCodes = Constants.KeyCodes;\n\nexport default class MultiSelectList<T extends Value> extends React.Component<Props<T>, State> {\n    public static defaultProps = {\n        options: [],\n        perPage: 50,\n        onAction: () => null,\n    };\n\n    private toSelect = -1\n    private listRef = React.createRef<HTMLDivElement>()\n    private selectedRef = React.createRef<HTMLDivElement>()\n\n    public constructor(props: Props<T>) {\n        super(props);\n\n        this.state = {\n            selected: -1,\n        };\n    }\n\n    public componentDidMount() {\n        document.addEventListener('keydown', this.handleArrowPress);\n    }\n\n    public componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleArrowPress);\n    }\n\n    public componentDidUpdate(_: Props<T>, prevState: State) {\n        const options = this.props.options;\n        if (options && options.length > 0 && this.state.selected >= 0) {\n            this.props.onSelect(options[this.state.selected]);\n        }\n\n        if (prevState.selected === this.state.selected) {\n            return;\n        }\n\n        if (this.listRef.current && this.selectedRef.current) {\n            const elemTop = this.selectedRef.current.getBoundingClientRect().top;\n            const elemBottom = this.selectedRef.current.getBoundingClientRect().bottom;\n            const listTop = this.listRef.current.getBoundingClientRect().top;\n            const listBottom = this.listRef.current.getBoundingClientRect().bottom;\n            if (elemBottom > listBottom) {\n                this.selectedRef.current.scrollIntoView(false);\n            } else if (elemTop < listTop) {\n                this.selectedRef.current.scrollIntoView(true);\n            }\n        }\n    }\n\n    // setSelected updates the selected index and is referenced\n    // externally by the MultiSelect component.\n    public setSelected = (selected: number) => {\n        this.setState({selected});\n    }\n\n    private handleArrowPress = (e: KeyboardEvent) => {\n        if (cmdOrCtrlPressed(e) && e.shiftKey) {\n            return;\n        }\n\n        const options = this.props.options;\n        if (options.length === 0) {\n            return;\n        }\n\n        let selected;\n        switch (e.key) {\n        case KeyCodes.DOWN[0]:\n            if (this.state.selected === -1) {\n                selected = 0;\n                break;\n            }\n            selected = Math.min(this.state.selected + 1, options.length - 1);\n            break;\n        case KeyCodes.UP[0]:\n            if (this.state.selected === -1) {\n                selected = 0;\n                break;\n            }\n            selected = Math.max(this.state.selected - 1, 0);\n            break;\n        default:\n            return;\n        }\n\n        e.preventDefault();\n        this.setState({selected});\n        this.props.onSelect(options[selected]);\n    }\n\n    private defaultOptionRenderer = (option: T, isSelected: boolean, onAdd: Props<T>['onAdd'], onMouseMove: (value: T) => void) => {\n        let rowSelected = '';\n        if (isSelected) {\n            rowSelected = 'more-modal__row--selected';\n        }\n\n        return (\n            <div\n                ref={isSelected ? 'selected' : option.value}\n                className={rowSelected}\n                key={'multiselectoption' + option.value}\n                onClick={() => onAdd(option)}\n                onMouseMove={() => onMouseMove(option)}\n            >\n                {option.label}\n            </div>\n        );\n    }\n\n    private onMouseMove = (option: T) => {\n        const i = this.props.options.indexOf(option);\n        if (i !== -1) {\n            if (this.state.selected !== i) {\n                this.setSelected(i);\n            }\n        }\n    }\n\n    public render() {\n        const options = this.props.options;\n        let renderOutput;\n\n        if (this.props.loading) {\n            renderOutput = (\n                <div aria-hidden={true}>\n                    <LoadingScreen\n                        position='absolute'\n                        key='loading'\n                    />\n                </div>\n            );\n        } else if (options == null || options.length === 0) {\n            renderOutput = (\n                <div\n                    key='no-users-found'\n                    className='no-channel-message'\n                >\n                    <p className='primary-message'>\n                        <FormattedMessage\n                            id='multiselect.list.notFound'\n                            defaultMessage='No items found'\n                        />\n                    </p>\n                </div>\n            );\n        } else {\n            let renderer: Props<T>['optionRenderer'];\n            if (this.props.optionRenderer) {\n                renderer = this.props.optionRenderer;\n            } else {\n                renderer = this.defaultOptionRenderer;\n            }\n\n            const optionControls = options.map((o, i) => renderer(o, this.state.selected === i, this.props.onAdd, this.onMouseMove));\n\n            const selectedOption = options[this.state.selected];\n            const ariaLabel = this.props.ariaLabelRenderer(selectedOption);\n\n            renderOutput = (\n                <div className='more-modal__list'>\n                    <div\n                        className='sr-only'\n                        aria-live='polite'\n                        aria-atomic='true'\n                    >\n                        {ariaLabel}\n                    </div>\n                    <div\n                        ref='list'\n                        id='multiSelectList'\n                        role='presentation'\n                        aria-hidden={true}\n                    >\n                        {optionControls}\n                    </div>\n                </div>\n            );\n        }\n\n        return (\n            <div\n                className='multi-select__wrapper'\n                aria-live='polite'\n            >\n                {renderOutput}\n            </div>\n        );\n    }\n}\n\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport ReactSelect from 'react-select';\n\nimport {ActionMeta} from 'react-select/src/types';\nimport {getOptionValue} from 'react-select/src/builtins';\n\nimport {Constants, A11yCustomEventTypes} from 'utils/constants';\nimport SaveButton from 'components/save_button';\n\nimport MultiSelectList from './multiselect_list';\n\nexport type Value = {\n    deleteAt?: number;\n    display_name?: string;\n    id: string;\n    label: string;\n    scheme_id?: string;\n    value: string;\n};\n\nexport type Props<T extends Value> = {\n    ariaLabelRenderer: getOptionValue<T>;\n    buttonSubmitLoadingText?: JSX.Element | string;\n    buttonSubmitText?: JSX.Element | string;\n    handleAdd: (value: T) => void;\n    handleDelete: (values: T[]) => void;\n    handleInput: (input: string, multiselect: MultiSelect<T>) => void;\n    handlePageChange?: (newPage: number, currentPage: number) => void;\n    handleSubmit: (value?: T[]) => void;\n    loading?: boolean;\n    maxValues?: number;\n    noteText?: JSX.Element;\n    numRemainingText?: JSX.Element;\n    optionRenderer: (\n        option: T,\n        isSelected: boolean,\n        onAdd: (value: T) => void,\n        onMouseMove: (value: T) => void\n    ) => void;\n    options: T[];\n    perPage: number;\n    placeholderText?: string;\n    saving?: boolean;\n    submitImmediatelyOn?: (value: T) => void;\n    totalCount?: number;\n    users?: unknown[];\n    valueRenderer: (props: {data: T}) => any;\n    values: T[];\n}\n\nexport type State = {\n    a11yActive: boolean;\n    input: string;\n    page: number;\n}\n\nconst KeyCodes = Constants.KeyCodes;\n\nexport default class MultiSelect<T extends Value> extends React.Component<Props<T>, State> {\n    private listRef = React.createRef<MultiSelectList<T>>()\n    private reactSelectRef = React.createRef<ReactSelect>()\n    private selected: T | null = null\n\n    public static defaultProps = {\n        ariaLabelRenderer: defaultAriaLabelRenderer,\n    }\n\n    public constructor(props: Props<T>) {\n        super(props);\n\n        this.state = {\n            a11yActive: false,\n            page: 0,\n            input: '',\n        };\n    }\n\n    public componentDidMount() {\n        const inputRef: unknown = this.reactSelectRef.current && this.reactSelectRef.current.select.inputRef;\n\n        document.addEventListener<'keydown'>('keydown', this.handleEnterPress);\n        if (inputRef && typeof (inputRef as HTMLElement).addEventListener === 'function') {\n            (inputRef as HTMLElement).addEventListener(A11yCustomEventTypes.ACTIVATE, this.handleA11yActivateEvent);\n            (inputRef as HTMLElement).addEventListener(A11yCustomEventTypes.DEACTIVATE, this.handleA11yDeactivateEvent);\n\n            this.reactSelectRef.current!.focus(); // known from ternary definition of inputRef\n        }\n    }\n\n    public componentWillUnmount() {\n        const inputRef: unknown = this.reactSelectRef.current && this.reactSelectRef.current.select.inputRef;\n\n        if (inputRef && typeof (inputRef as HTMLElement).addEventListener === 'function') {\n            (inputRef as HTMLElement).removeEventListener(A11yCustomEventTypes.ACTIVATE, this.handleA11yActivateEvent);\n            (inputRef as HTMLElement).removeEventListener(A11yCustomEventTypes.DEACTIVATE, this.handleA11yDeactivateEvent);\n        }\n\n        document.removeEventListener('keydown', this.handleEnterPress);\n    }\n\n    private handleA11yActivateEvent = () => {\n        this.setState({a11yActive: true});\n    }\n\n    private handleA11yDeactivateEvent = () => {\n        this.setState({a11yActive: false});\n    }\n\n    private nextPage = () => {\n        if (this.props.handlePageChange) {\n            this.props.handlePageChange(this.state.page + 1, this.state.page);\n        }\n        if (this.listRef.current) {\n            this.listRef.current.setSelected(0);\n        }\n        this.setState({page: this.state.page + 1});\n    }\n\n    private prevPage = () => {\n        if (this.state.page === 0) {\n            return;\n        }\n\n        if (this.props.handlePageChange) {\n            this.props.handlePageChange(this.state.page - 1, this.state.page);\n        }\n\n        if (this.listRef.current) {\n            this.listRef.current.setSelected(0);\n        }\n        this.setState({page: this.state.page - 1});\n    }\n\n    public resetPaging = () => {\n        this.setState({page: 0});\n    }\n\n    private onSelect = (selected: T | null) => {\n        this.selected = selected;\n    }\n\n    private onAdd = (value: T) => {\n        if (this.props.maxValues && this.props.values.length >= this.props.maxValues) {\n            return;\n        }\n\n        for (let i = 0; i < this.props.values.length; i++) {\n            if (this.props.values[i].id === value.id) {\n                return;\n            }\n        }\n\n        this.props.handleAdd(value);\n        this.selected = null;\n\n        if (this.reactSelectRef.current) {\n            this.reactSelectRef.current.select.handleInputChange(\n                {currentTarget: {value: ''}} as React.KeyboardEvent<HTMLInputElement>\n            );\n            this.onInput('');\n            this.reactSelectRef.current.focus();\n        }\n\n        const submitImmediatelyOn = this.props.submitImmediatelyOn;\n        if (submitImmediatelyOn && submitImmediatelyOn(value)) {\n            this.props.handleSubmit([value]);\n        }\n    }\n\n    private onInput = (input: string, change: ActionMeta | { action: string } = {action: ''}) => {\n        if (!change) {\n            return;\n        }\n\n        if (change.action === 'input-blur' || change.action === 'menu-close') {\n            return;\n        }\n\n        if (this.state.input === input) {\n            return;\n        }\n\n        this.setState({input});\n\n        if (this.listRef.current) {\n            if (input === '') {\n                this.listRef.current.setSelected(-1);\n            } else {\n                this.listRef.current.setSelected(0);\n            }\n        }\n        this.selected = null;\n\n        this.props.handleInput(input, this);\n    }\n\n    private onInputKeyDown = (e: React.KeyboardEvent) => {\n        switch (e.key) {\n        case KeyCodes.ENTER[0]:\n            e.preventDefault();\n            break;\n        }\n    }\n\n    private handleEnterPress = (e: KeyboardEvent) => {\n        switch (e.key) {\n        case KeyCodes.ENTER[0]:\n            if (this.selected == null) {\n                this.props.handleSubmit();\n                return;\n            }\n            this.onAdd(this.selected);\n            break;\n        }\n    }\n\n    private handleOnClick = (e: React.MouseEvent<HTMLButtonElement>) => {\n        e.preventDefault();\n        this.props.handleSubmit();\n    }\n\n    private onChange: ReactSelect['onChange'] = (_, change) => {\n        if (change.action !== 'remove-value' && change.action !== 'pop-value') {\n            return;\n        }\n\n        const values = [...this.props.values];\n        for (let i = 0; i < values.length; i++) {\n            // Types of ReactSelect do not match the behavior here,\n            if (values[i].id === (change as any).removedValue.id) {\n                values.splice(i, 1);\n                break;\n            }\n        }\n\n        this.props.handleDelete(values);\n    }\n\n    public render() {\n        const options = Object.assign([...this.props.options]);\n        const {totalCount, users, values} = this.props;\n\n        let numRemainingText;\n        if (this.props.numRemainingText) {\n            numRemainingText = this.props.numRemainingText;\n        } else if (this.props.maxValues != null) {\n            numRemainingText = (\n                <FormattedMessage\n                    id='multiselect.numRemaining'\n                    defaultMessage='You can add {num, number} more. '\n                    values={{\n                        num: this.props.maxValues - this.props.values.length,\n                    }}\n                />\n            );\n        }\n\n        let buttonSubmitText;\n        if (this.props.buttonSubmitText) {\n            buttonSubmitText = this.props.buttonSubmitText;\n        } else if (this.props.maxValues != null) {\n            buttonSubmitText = (\n                <FormattedMessage\n                    id='multiselect.go'\n                    defaultMessage='Go'\n                />\n            );\n        }\n\n        let optionsToDisplay = [];\n        let nextButton;\n        let previousButton;\n        let noteTextContainer;\n\n        if (this.props.noteText) {\n            noteTextContainer = (\n                <div className='multi-select__note'>\n                    <div className='note__icon'>\n                        <FormattedMessage\n                            id='generic_icons.info'\n                            defaultMessage='Info Icon'\n                        >\n                            {(title) => (\n                                <span\n                                    className='fa fa-info'\n                                    title={title as string}\n                                />\n                            )}\n                        </FormattedMessage>\n                    </div>\n                    <div>{this.props.noteText}</div>\n                </div>\n            );\n        }\n\n        const valueMap: Record<string, boolean> = {};\n        for (let i = 0; i < values.length; i++) {\n            valueMap[values[i].id] = true;\n        }\n\n        for (let i = options.length - 1; i >= 0; i--) {\n            if (valueMap[options[i].id]) {\n                options.splice(i, 1);\n            }\n        }\n\n        if (options && options.length > this.props.perPage) {\n            const pageStart = this.state.page * this.props.perPage;\n            const pageEnd = pageStart + this.props.perPage;\n            optionsToDisplay = options.slice(pageStart, pageEnd);\n            if (!this.props.loading) {\n                if (options.length > pageEnd) {\n                    nextButton = (\n                        <button\n                            className='btn btn-link filter-control filter-control__next'\n                            onClick={this.nextPage}\n                        >\n                            <FormattedMessage\n                                id='filtered_user_list.next'\n                                defaultMessage='Next'\n                            />\n                        </button>\n                    );\n                }\n\n                if (this.state.page > 0) {\n                    previousButton = (\n                        <button\n                            className='btn btn-link filter-control filter-control__prev'\n                            onClick={this.prevPage}\n                        >\n                            <FormattedMessage\n                                id='filtered_user_list.prev'\n                                defaultMessage='Previous'\n                            />\n                        </button>\n                    );\n                }\n            }\n        } else {\n            optionsToDisplay = options;\n        }\n\n        let memberCount;\n        if (users && users.length && totalCount) {\n            memberCount = (\n                <FormattedMessage\n                    id='multiselect.numMembers'\n                    defaultMessage='{memberOptions, number} of {totalCount, number} members'\n                    values={{\n                        memberOptions: optionsToDisplay.length,\n                        totalCount: this.props.totalCount,\n                    }}\n                />\n            );\n        }\n\n        return (\n            <div className='filtered-user-list'>\n                <div className='filter-row filter-row--full'>\n                    <div className='multi-select__container react-select'>\n                        <ReactSelect\n                            id='selectItems'\n                            ref={this.reactSelectRef as React.RefObject<any>} // type of ref on @types/react-select is outdated\n                            isMulti={true}\n                            options={this.props.options}\n                            styles={styles}\n                            components={{\n                                Menu: nullComponent,\n                                IndicatorsContainer: nullComponent,\n                                MultiValueLabel: paddedComponent(this.props.valueRenderer),\n                            }}\n                            isClearable={false}\n                            openMenuOnFocus={false}\n                            menuIsOpen={false}\n                            onInputChange={this.onInput}\n                            onKeyDown={this.onInputKeyDown as React.KeyboardEventHandler}\n                            onChange={this.onChange}\n                            value={this.props.values}\n                            placeholder={this.props.placeholderText}\n                            inputValue={this.state.input}\n                            getOptionValue={(option: Value) => option.id}\n                            getOptionLabel={this.props.ariaLabelRenderer}\n                            aria-label={this.props.placeholderText}\n                            className={this.state.a11yActive ? 'multi-select__focused' : ''}\n                            classNamePrefix='react-select-auto react-select'\n                        />\n                        <SaveButton\n                            id='saveItems'\n                            saving={this.props.saving}\n                            disabled={this.props.saving}\n                            onClick={this.handleOnClick}\n                            defaultMessage={buttonSubmitText}\n                            savingMessage={this.props.buttonSubmitLoadingText}\n                        />\n                    </div>\n                    <div className='multi-select__help'>\n                        {numRemainingText}\n                        {memberCount}\n                    </div>\n                    <div className='multi-select__help'>\n                        {noteTextContainer}\n                    </div>\n                </div>\n                <MultiSelectList\n                    ref={this.listRef}\n                    options={optionsToDisplay}\n                    optionRenderer={this.props.optionRenderer}\n                    ariaLabelRenderer={this.props.ariaLabelRenderer}\n                    page={this.state.page}\n                    perPage={this.props.perPage}\n                    onPageChange={this.props.handlePageChange}\n                    onAdd={this.onAdd}\n                    onSelect={this.onSelect}\n                    loading={this.props.loading}\n                />\n                <div className='filter-controls'>\n                    {previousButton}\n                    {nextButton}\n                </div>\n            </div>\n        );\n    }\n}\n\nfunction defaultAriaLabelRenderer(option: Value) {\n    if (!option) {\n        return null;\n    }\n    return option.label;\n}\n\nconst nullComponent = () => null;\n\nconst paddedComponent = (WrappedComponent: any) => {\n    return (props: {data: any}) => {\n        return (\n            <div style={{paddingLeft: '10px'}}>\n                <WrappedComponent {...props}/>\n            </div>\n        );\n    };\n};\n\nconst styles = {\n    container: () => {\n        return {\n            display: 'table-cell',\n            paddingRight: '15px',\n            verticalAlign: 'top',\n            width: '100%',\n        };\n    },\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {batchActions} from 'redux-batched-actions';\nimport {\n    ChannelTypes,\n    EmojiTypes,\n    PostTypes,\n    TeamTypes,\n    UserTypes,\n    RoleTypes,\n    GeneralTypes,\n    AdminTypes,\n    IntegrationTypes,\n    PreferenceTypes,\n} from 'mattermost-redux/action_types';\nimport {WebsocketEvents, General, Permissions} from 'mattermost-redux/constants';\nimport {\n    getChannelAndMyMember,\n    getMyChannelMember,\n    getChannelMember,\n    getChannelStats,\n    viewChannel,\n    markChannelAsRead,\n} from 'mattermost-redux/actions/channels';\nimport {loadRolesIfNeeded} from 'mattermost-redux/actions/roles';\nimport {setServerVersion} from 'mattermost-redux/actions/general';\nimport {\n    getCustomEmojiForReaction,\n    getPosts,\n    getProfilesAndStatusesForPosts,\n    getThreadsForPosts,\n    postDeleted,\n    receivedNewPost,\n    receivedPost,\n} from 'mattermost-redux/actions/posts';\nimport {clearErrors, logError} from 'mattermost-redux/actions/errors';\n\nimport * as TeamActions from 'mattermost-redux/actions/teams';\nimport {\n    checkForModifiedUsers,\n    getMe,\n    getMissingProfilesByIds,\n    getStatusesByIds,\n    getUser as loadUser,\n} from 'mattermost-redux/actions/users';\nimport {removeNotVisibleUsers} from 'mattermost-redux/actions/websocket';\nimport {Client4} from 'mattermost-redux/client';\nimport {getCurrentUser, getCurrentUserId, getStatusForUserId, getUser, getIsManualStatusForUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getMyTeams, getCurrentRelativeTeamUrl, getCurrentTeamId, getCurrentTeamUrl, getTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getChannelsInTeam, getChannel, getCurrentChannel, getCurrentChannelId, getRedirectChannelNameForTeam, getMembersInCurrentChannel, getChannelMembersInChannels} from 'mattermost-redux/selectors/entities/channels';\nimport {getPost, getMostRecentPostIdInChannel} from 'mattermost-redux/selectors/entities/posts';\nimport {haveISystemPermission, haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\n\nimport {getSelectedChannelId} from 'selectors/rhs';\n\nimport {openModal} from 'actions/views/modals';\nimport {incrementWsErrorCount, resetWsErrorCount} from 'actions/views/system';\nimport {closeRightHandSide} from 'actions/views/rhs';\nimport {syncPostsInChannel} from 'actions/views/channel';\n\nimport {browserHistory} from 'utils/browser_history';\nimport {loadChannelsForCurrentUser} from 'actions/channel_actions.jsx';\nimport {redirectUserToDefaultTeam} from 'actions/global_actions.jsx';\nimport {handleNewPost} from 'actions/post_actions.jsx';\nimport * as StatusActions from 'actions/status_actions.jsx';\nimport {loadProfilesForSidebar} from 'actions/user_actions.jsx';\nimport store from 'stores/redux_store.jsx';\nimport WebSocketClient from 'client/web_websocket_client.jsx';\nimport {loadPlugin, loadPluginsIfNecessary, removePlugin} from 'plugins';\nimport {ActionTypes, Constants, AnnouncementBarMessages, SocketEvents, UserStatuses, ModalIdentifiers} from 'utils/constants';\nimport {fromAutoResponder} from 'utils/post_utils';\nimport {getSiteURL} from 'utils/url';\nimport {isGuest} from 'utils/utils';\nimport RemovedFromChannelModal from 'components/removed_from_channel_modal';\nimport InteractiveDialog from 'components/interactive_dialog';\n\nconst dispatch = store.dispatch;\nconst getState = store.getState;\n\nconst MAX_WEBSOCKET_FAILS = 7;\n\nconst pluginEventHandlers = {};\n\nexport function initialize() {\n    if (!window.WebSocket) {\n        console.log('Browser does not support websocket'); //eslint-disable-line no-console\n        return;\n    }\n\n    const config = getConfig(getState());\n    let connUrl = '';\n    if (config.WebsocketURL) {\n        connUrl = config.WebsocketURL;\n    } else {\n        connUrl = new URL(getSiteURL());\n\n        // replace the protocol with a websocket one\n        if (connUrl.protocol === 'https:') {\n            connUrl.protocol = 'wss:';\n        } else {\n            connUrl.protocol = 'ws:';\n        }\n\n        // append a port number if one isn't already specified\n        if (!(/:\\d+$/).test(connUrl.host)) {\n            if (connUrl.protocol === 'wss:') {\n                connUrl.host += ':' + config.WebsocketSecurePort;\n            } else {\n                connUrl.host += ':' + config.WebsocketPort;\n            }\n        }\n\n        connUrl = connUrl.toString();\n    }\n\n    // Strip any trailing slash before appending the pathname below.\n    if (connUrl.length > 0 && connUrl[connUrl.length - 1] === '/') {\n        connUrl = connUrl.substring(0, connUrl.length - 1);\n    }\n\n    connUrl += Client4.getUrlVersion() + '/websocket';\n\n    WebSocketClient.setEventCallback(handleEvent);\n    WebSocketClient.setFirstConnectCallback(handleFirstConnect);\n    WebSocketClient.setReconnectCallback(() => reconnect(false));\n    WebSocketClient.setMissedEventCallback(() => reconnect(false));\n    WebSocketClient.setCloseCallback(handleClose);\n    WebSocketClient.initialize(connUrl);\n}\n\nexport function close() {\n    WebSocketClient.close();\n}\n\nfunction reconnectWebSocket() {\n    close();\n    initialize();\n}\n\nconst pluginReconnectHandlers = {};\n\nexport function registerPluginReconnectHandler(pluginId, handler) {\n    pluginReconnectHandlers[pluginId] = handler;\n}\n\nexport function unregisterPluginReconnectHandler(pluginId) {\n    Reflect.deleteProperty(pluginReconnectHandlers, pluginId);\n}\n\nexport function reconnect(includeWebSocket = true) {\n    if (includeWebSocket) {\n        reconnectWebSocket();\n    }\n\n    dispatch({\n        type: GeneralTypes.WEBSOCKET_SUCCESS,\n        timestamp: Date.now(),\n    });\n\n    loadPluginsIfNecessary();\n\n    Object.values(pluginReconnectHandlers).forEach((handler) => {\n        if (handler && typeof handler === 'function') {\n            handler();\n        }\n    });\n\n    const state = getState();\n    const currentTeamId = state.entities.teams.currentTeamId;\n    if (currentTeamId) {\n        const currentChannelId = getCurrentChannelId(state);\n        const mostRecentId = getMostRecentPostIdInChannel(state, currentChannelId);\n        const mostRecentPost = getPost(state, mostRecentId);\n        dispatch(loadChannelsForCurrentUser());\n        if (mostRecentPost) {\n            dispatch(syncPostsInChannel(currentChannelId, mostRecentPost.create_at));\n        } else {\n            // if network timed-out the first time when loading a channel\n            // we can request for getPosts again when socket is connected\n            dispatch(getPosts(currentChannelId));\n        }\n        StatusActions.loadStatusesForChannelAndSidebar();\n        dispatch(TeamActions.getMyTeamUnreads());\n    }\n\n    if (state.websocket.lastDisconnectAt) {\n        dispatch(checkForModifiedUsers());\n    }\n\n    dispatch(resetWsErrorCount());\n    dispatch(clearErrors());\n}\n\nlet intervalId = '';\nconst SYNC_INTERVAL_MILLISECONDS = 1000 * 60 * 15; // 15 minutes\n\nexport function startPeriodicSync() {\n    clearInterval(intervalId);\n\n    intervalId = setInterval(\n        () => {\n            if (getCurrentUser(getState()) != null) {\n                reconnect(false);\n            }\n        },\n        SYNC_INTERVAL_MILLISECONDS\n    );\n}\n\nexport function stopPeriodicSync() {\n    clearInterval(intervalId);\n}\n\nexport function registerPluginWebSocketEvent(pluginId, event, action) {\n    if (!pluginEventHandlers[pluginId]) {\n        pluginEventHandlers[pluginId] = {};\n    }\n    pluginEventHandlers[pluginId][event] = action;\n}\n\nexport function unregisterPluginWebSocketEvent(pluginId, event) {\n    const events = pluginEventHandlers[pluginId];\n    if (!events) {\n        return;\n    }\n\n    Reflect.deleteProperty(events, event);\n}\n\nexport function unregisterAllPluginWebSocketEvents(pluginId) {\n    Reflect.deleteProperty(pluginEventHandlers, pluginId);\n}\n\nfunction handleFirstConnect() {\n    dispatch(batchActions([\n        {\n            type: GeneralTypes.WEBSOCKET_SUCCESS,\n            timestamp: Date.now(),\n        },\n        clearErrors(),\n    ]));\n}\n\nfunction handleClose(failCount) {\n    if (failCount > MAX_WEBSOCKET_FAILS) {\n        dispatch(logError({type: 'critical', message: AnnouncementBarMessages.WEBSOCKET_PORT_ERROR}, true));\n    }\n    dispatch(batchActions([\n        {\n            type: GeneralTypes.WEBSOCKET_FAILURE,\n            timestamp: Date.now(),\n        },\n        incrementWsErrorCount(),\n    ]));\n}\n\nexport function handleEvent(msg) {\n    switch (msg.event) {\n    case SocketEvents.POSTED:\n    case SocketEvents.EPHEMERAL_MESSAGE:\n        handleNewPostEventDebounced(msg);\n        break;\n\n    case SocketEvents.POST_EDITED:\n        handlePostEditEvent(msg);\n        break;\n\n    case SocketEvents.POST_DELETED:\n        handlePostDeleteEvent(msg);\n        break;\n\n    case SocketEvents.POST_UNREAD:\n        handlePostUnreadEvent(msg);\n        break;\n\n    case SocketEvents.LEAVE_TEAM:\n        handleLeaveTeamEvent(msg);\n        break;\n\n    case SocketEvents.UPDATE_TEAM:\n        handleUpdateTeamEvent(msg);\n        break;\n\n    case SocketEvents.DELETE_TEAM:\n        handleDeleteTeamEvent(msg);\n        break;\n\n    case SocketEvents.ADDED_TO_TEAM:\n        handleTeamAddedEvent(msg);\n        break;\n\n    case SocketEvents.USER_ADDED:\n        handleUserAddedEvent(msg);\n        break;\n\n    case SocketEvents.USER_REMOVED:\n        handleUserRemovedEvent(msg);\n        break;\n\n    case SocketEvents.USER_UPDATED:\n        handleUserUpdatedEvent(msg);\n        break;\n\n    case SocketEvents.ROLE_ADDED:\n        handleRoleAddedEvent(msg);\n        break;\n\n    case SocketEvents.ROLE_REMOVED:\n        handleRoleRemovedEvent(msg);\n        break;\n\n    case SocketEvents.CHANNEL_SCHEME_UPDATED:\n        handleChannelSchemeUpdatedEvent(msg);\n        break;\n\n    case SocketEvents.MEMBERROLE_UPDATED:\n        handleUpdateMemberRoleEvent(msg);\n        break;\n\n    case SocketEvents.ROLE_UPDATED:\n        handleRoleUpdatedEvent(msg);\n        break;\n\n    case SocketEvents.CHANNEL_CREATED:\n        handleChannelCreatedEvent(msg);\n        break;\n\n    case SocketEvents.CHANNEL_DELETED:\n        handleChannelDeletedEvent(msg);\n        break;\n\n    case SocketEvents.CHANNEL_UNARCHIVED:\n        handleChannelUnarchivedEvent(msg);\n        break;\n\n    case SocketEvents.CHANNEL_CONVERTED:\n        handleChannelConvertedEvent(msg);\n        break;\n\n    case SocketEvents.CHANNEL_UPDATED:\n        dispatch(handleChannelUpdatedEvent(msg));\n        break;\n\n    case SocketEvents.CHANNEL_MEMBER_UPDATED:\n        handleChannelMemberUpdatedEvent(msg);\n        break;\n\n    case SocketEvents.DIRECT_ADDED:\n        handleDirectAddedEvent(msg);\n        break;\n\n    case SocketEvents.PREFERENCE_CHANGED:\n        handlePreferenceChangedEvent(msg);\n        break;\n\n    case SocketEvents.PREFERENCES_CHANGED:\n        handlePreferencesChangedEvent(msg);\n        break;\n\n    case SocketEvents.PREFERENCES_DELETED:\n        handlePreferencesDeletedEvent(msg);\n        break;\n\n    case SocketEvents.TYPING:\n        dispatch(handleUserTypingEvent(msg));\n        break;\n\n    case SocketEvents.STATUS_CHANGED:\n        handleStatusChangedEvent(msg);\n        break;\n\n    case SocketEvents.HELLO:\n        handleHelloEvent(msg);\n        break;\n\n    case SocketEvents.REACTION_ADDED:\n        handleReactionAddedEvent(msg);\n        break;\n\n    case SocketEvents.REACTION_REMOVED:\n        handleReactionRemovedEvent(msg);\n        break;\n\n    case SocketEvents.EMOJI_ADDED:\n        handleAddEmoji(msg);\n        break;\n\n    case SocketEvents.CHANNEL_VIEWED:\n        handleChannelViewedEvent(msg);\n        break;\n\n    case SocketEvents.PLUGIN_ENABLED:\n        handlePluginEnabled(msg);\n        break;\n\n    case SocketEvents.PLUGIN_DISABLED:\n        handlePluginDisabled(msg);\n        break;\n\n    case SocketEvents.USER_ROLE_UPDATED:\n        handleUserRoleUpdated(msg);\n        break;\n\n    case SocketEvents.CONFIG_CHANGED:\n        handleConfigChanged(msg);\n        break;\n\n    case SocketEvents.LICENSE_CHANGED:\n        handleLicenseChanged(msg);\n        break;\n\n    case SocketEvents.PLUGIN_STATUSES_CHANGED:\n        handlePluginStatusesChangedEvent(msg);\n        break;\n\n    case SocketEvents.OPEN_DIALOG:\n        handleOpenDialogEvent(msg);\n        break;\n\n    default:\n    }\n\n    Object.values(pluginEventHandlers).forEach((pluginEvents) => {\n        if (!pluginEvents) {\n            return;\n        }\n\n        if (pluginEvents.hasOwnProperty(msg.event) && typeof pluginEvents[msg.event] === 'function') {\n            pluginEvents[msg.event](msg);\n        }\n    });\n}\n\n// handleChannelConvertedEvent handles updating of channel which is converted from public to private\nfunction handleChannelConvertedEvent(msg) {\n    const channelId = msg.data.channel_id;\n    if (channelId) {\n        const channel = getChannel(getState(), channelId);\n        if (channel) {\n            dispatch({\n                type: ChannelTypes.RECEIVED_CHANNEL,\n                data: {...channel, type: General.PRIVATE_CHANNEL},\n            });\n        }\n    }\n}\n\nexport function handleChannelUpdatedEvent(msg) {\n    return (doDispatch, doGetState) => {\n        const channel = JSON.parse(msg.data.channel);\n\n        doDispatch({type: ChannelTypes.RECEIVED_CHANNEL, data: channel});\n\n        const state = doGetState();\n        if (channel.id === getCurrentChannelId(state)) {\n            browserHistory.replace(`${getCurrentRelativeTeamUrl(state)}/channels/${channel.name}`);\n        }\n    };\n}\n\nfunction handleChannelMemberUpdatedEvent(msg) {\n    const channelMember = JSON.parse(msg.data.channelMember);\n    const roles = channelMember.roles.split(' ');\n    dispatch(loadRolesIfNeeded(roles));\n    dispatch({type: ChannelTypes.RECEIVED_MY_CHANNEL_MEMBER, data: channelMember});\n}\n\nfunction debouncePostEvent(wait) {\n    let timeout;\n    let queue = [];\n    let count = 0;\n\n    // Called when timeout triggered\n    const triggered = () => {\n        timeout = null;\n\n        if (queue.length > 0) {\n            dispatch(handleNewPostEvents(queue));\n        }\n\n        queue = [];\n        count = 0;\n    };\n\n    return function fx(msg) {\n        if (timeout && count > 2) {\n            // If the timeout is going this is the second or further event so queue them up.\n            if (queue.push(msg) > 200) {\n                // Don't run us out of memory, give up if the queue gets insane\n                queue = [];\n                console.log('channel broken because of too many incoming messages'); //eslint-disable-line no-console\n            }\n            clearTimeout(timeout);\n            timeout = setTimeout(triggered, wait);\n        } else {\n            // Apply immediately for events up until count reaches limit\n            count += 1;\n            dispatch(handleNewPostEvent(msg));\n            clearTimeout(timeout);\n            timeout = setTimeout(triggered, wait);\n        }\n    };\n}\n\nconst handleNewPostEventDebounced = debouncePostEvent(100);\n\nexport function handleNewPostEvent(msg) {\n    return (myDispatch, myGetState) => {\n        const post = JSON.parse(msg.data.post);\n        myDispatch(handleNewPost(post, msg));\n\n        getProfilesAndStatusesForPosts([post], myDispatch, myGetState);\n\n        if (post.user_id !== getCurrentUserId(myGetState()) && !fromAutoResponder(post) && !getIsManualStatusForUserId(myGetState(), post.user_id)) {\n            myDispatch({\n                type: UserTypes.RECEIVED_STATUSES,\n                data: [{user_id: post.user_id, status: UserStatuses.ONLINE}],\n            });\n        }\n    };\n}\n\nexport function handleNewPostEvents(queue) {\n    return (myDispatch, myGetState) => {\n        const posts = queue.map((msg) => JSON.parse(msg.data.post));\n\n        // Receive the posts as one continuous block since they were received within a short period\n        const actions = posts.map(receivedNewPost);\n        myDispatch(batchActions(actions));\n\n        // Load the posts' threads\n        myDispatch(getThreadsForPosts(posts));\n\n        // And any other data needed for them\n        getProfilesAndStatusesForPosts(posts, myDispatch, myGetState);\n    };\n}\n\nexport function handlePostEditEvent(msg) {\n    // Store post\n    const post = JSON.parse(msg.data.post);\n    dispatch(receivedPost(post));\n\n    getProfilesAndStatusesForPosts([post], dispatch, getState);\n    const currentChannelId = getCurrentChannelId(getState());\n\n    // Update channel state\n    if (currentChannelId === msg.broadcast.channel_id) {\n        if (window.isActive) {\n            dispatch(viewChannel(currentChannelId));\n        }\n    }\n}\n\nfunction handlePostDeleteEvent(msg) {\n    const post = JSON.parse(msg.data.post);\n    dispatch(postDeleted(post));\n}\n\nexport function handlePostUnreadEvent(msg) {\n    dispatch(\n        {\n            type: ActionTypes.POST_UNREAD_SUCCESS,\n            data: {\n                lastViewedAt: msg.data.last_viewed_at,\n                channelId: msg.broadcast.channel_id,\n                msgCount: msg.data.msg_count,\n                mentionCount: msg.data.mention_count,\n            },\n        }\n    );\n}\n\nasync function handleTeamAddedEvent(msg) {\n    await dispatch(TeamActions.getTeam(msg.data.team_id));\n    await dispatch(TeamActions.getMyTeamMembers());\n    await dispatch(TeamActions.getMyTeamUnreads());\n}\n\nexport function handleLeaveTeamEvent(msg) {\n    const state = getState();\n\n    const actions = [\n        {\n            type: UserTypes.RECEIVED_PROFILE_NOT_IN_TEAM,\n            data: {id: msg.data.team_id, user_id: msg.data.user_id},\n        },\n        {\n            type: TeamTypes.REMOVE_MEMBER_FROM_TEAM,\n            data: {team_id: msg.data.team_id, user_id: msg.data.user_id},\n        },\n    ];\n\n    const channelsPerTeam = getChannelsInTeam(state);\n    const channels = (channelsPerTeam && channelsPerTeam[msg.data.team_id]) || [];\n\n    for (const channel of channels) {\n        actions.push({\n            type: ChannelTypes.REMOVE_MEMBER_FROM_CHANNEL,\n            data: {id: channel, user_id: msg.data.user_id},\n        });\n    }\n\n    dispatch(batchActions(actions));\n    const currentUser = getCurrentUser(state);\n\n    if (currentUser.id === msg.data.user_id) {\n        dispatch({type: TeamTypes.LEAVE_TEAM, data: {id: msg.data.team_id}});\n\n        // if they are on the team being removed redirect them to default team\n        if (getCurrentTeamId(state) === msg.data.team_id) {\n            if (!global.location.pathname.startsWith('/admin_console')) {\n                redirectUserToDefaultTeam();\n            }\n        }\n        if (isGuest(currentUser)) {\n            dispatch(removeNotVisibleUsers());\n        }\n    } else {\n        const team = getTeam(state, msg.data.team_id);\n        const members = getChannelMembersInChannels(state);\n        const isMember = Object.values(members).some((member) => member[msg.data.user_id]);\n        if (team && isGuest(currentUser) && !isMember) {\n            dispatch(batchActions([\n                {\n                    type: UserTypes.PROFILE_NO_LONGER_VISIBLE,\n                    data: {user_id: msg.data.user_id},\n                },\n                {\n                    type: TeamTypes.REMOVE_MEMBER_FROM_TEAM,\n                    data: {team_id: team.id, user_id: msg.data.user_id},\n                },\n            ]));\n        }\n    }\n}\n\nfunction handleUpdateTeamEvent(msg) {\n    dispatch({type: TeamTypes.UPDATED_TEAM, data: JSON.parse(msg.data.team)});\n}\n\nfunction handleDeleteTeamEvent(msg) {\n    const deletedTeam = JSON.parse(msg.data.team);\n    const state = store.getState();\n    const {teams} = state.entities.teams;\n    if (\n        deletedTeam &&\n        teams &&\n        teams[deletedTeam.id] &&\n        teams[deletedTeam.id].delete_at === 0\n    ) {\n        const {currentUserId} = state.entities.users;\n        const {currentTeamId, myMembers} = state.entities.teams;\n        const teamMembers = Object.values(myMembers);\n        const teamMember = teamMembers.find((m) => m.user_id === currentUserId && m.team_id === currentTeamId);\n\n        let newTeamId = '';\n        if (\n            deletedTeam &&\n            teamMember &&\n            deletedTeam.id === teamMember.team_id\n        ) {\n            const myTeams = {};\n            getMyTeams(state).forEach((t) => {\n                myTeams[t.id] = t;\n            });\n\n            for (let i = 0; i < teamMembers.length; i++) {\n                const memberTeamId = teamMembers[i].team_id;\n                if (\n                    myTeams &&\n                    myTeams[memberTeamId] &&\n                    myTeams[memberTeamId].delete_at === 0 &&\n                    deletedTeam.id !== memberTeamId\n                ) {\n                    newTeamId = memberTeamId;\n                    break;\n                }\n            }\n        }\n\n        dispatch(batchActions([\n            {type: TeamTypes.RECEIVED_TEAM_DELETED, data: {id: deletedTeam.id}},\n            {type: TeamTypes.UPDATED_TEAM, data: deletedTeam},\n        ]));\n\n        if (newTeamId) {\n            dispatch({type: TeamTypes.SELECT_TEAM, data: newTeamId});\n            const globalState = getState();\n            const redirectChannel = getRedirectChannelNameForTeam(globalState, newTeamId);\n            browserHistory.push(`${getCurrentTeamUrl(globalState)}/channels/${redirectChannel}`);\n        } else {\n            browserHistory.push('/');\n        }\n    }\n}\n\nfunction handleUpdateMemberRoleEvent(msg) {\n    const memberData = JSON.parse(msg.data.member);\n    const newRoles = memberData.roles.split(' ');\n\n    dispatch(loadRolesIfNeeded(newRoles));\n\n    dispatch({\n        type: TeamTypes.RECEIVED_MY_TEAM_MEMBER,\n        data: memberData,\n    });\n}\n\nfunction handleDirectAddedEvent(msg) {\n    dispatch(getChannelAndMyMember(msg.broadcast.channel_id));\n}\n\nfunction handleUserAddedEvent(msg) {\n    const currentChannelId = getCurrentChannelId(getState());\n    if (currentChannelId === msg.broadcast.channel_id) {\n        dispatch(getChannelStats(currentChannelId));\n        dispatch({\n            type: UserTypes.RECEIVED_PROFILE_IN_CHANNEL,\n            data: {id: msg.broadcast.channel_id, user_id: msg.data.user_id},\n        });\n    }\n\n    const currentTeamId = getCurrentTeamId(getState());\n    const currentUserId = getCurrentUserId(getState());\n    if (currentTeamId === msg.data.team_id && currentUserId === msg.data.user_id) {\n        dispatch(getChannelAndMyMember(msg.broadcast.channel_id));\n    }\n}\n\nexport async function handleUserRemovedEvent(msg) {\n    const state = getState();\n    const currentChannel = getCurrentChannel(state) || {};\n    const currentUser = getCurrentUser(state);\n\n    if (msg.broadcast.user_id === currentUser.id) {\n        dispatch(loadChannelsForCurrentUser());\n\n        const rhsChannelId = getSelectedChannelId(state);\n        if (msg.data.channel_id === rhsChannelId) {\n            dispatch(closeRightHandSide());\n        }\n\n        await dispatch({\n            type: ChannelTypes.LEAVE_CHANNEL,\n            data: {id: msg.data.channel_id, user_id: msg.broadcast.user_id},\n        });\n\n        if (msg.data.channel_id === currentChannel.id) {\n            if (msg.data.remover_id === msg.broadcast.user_id) {\n                browserHistory.push(getCurrentRelativeTeamUrl(state));\n            } else {\n                const user = getUser(state, msg.data.remover_id);\n                if (!user) {\n                    dispatch(loadUser(msg.data.remover_id));\n                }\n\n                dispatch(openModal({\n                    modalId: ModalIdentifiers.REMOVED_FROM_CHANNEL,\n                    dialogType: RemovedFromChannelModal,\n                    dialogProps: {\n                        channelName: currentChannel.display_name,\n                        removerId: msg.data.remover_id,\n                    },\n                }));\n                redirectUserToDefaultTeam();\n            }\n        }\n\n        if (isGuest(currentUser)) {\n            dispatch(removeNotVisibleUsers());\n        }\n    } else if (msg.broadcast.channel_id === currentChannel.id) {\n        dispatch(getChannelStats(currentChannel.id));\n        dispatch({\n            type: UserTypes.RECEIVED_PROFILE_NOT_IN_CHANNEL,\n            data: {id: msg.broadcast.channel_id, user_id: msg.data.user_id},\n        });\n    }\n\n    if (msg.broadcast.user_id !== currentUser.id) {\n        const channel = getChannel(state, msg.broadcast.channel_id);\n        const members = getChannelMembersInChannels(state);\n        const isMember = Object.values(members).some((member) => member[msg.data.user_id]);\n        if (channel && isGuest(currentUser) && !isMember) {\n            const actions = [\n                {\n                    type: UserTypes.PROFILE_NO_LONGER_VISIBLE,\n                    data: {user_id: msg.data.user_id},\n                },\n                {\n                    type: TeamTypes.REMOVE_MEMBER_FROM_TEAM,\n                    data: {team_id: channel.team_id, user_id: msg.data.user_id},\n                },\n            ];\n            dispatch(batchActions(actions));\n        }\n    }\n\n    const channelId = msg.broadcast.channel_id || msg.data.channel_id;\n    const userId = msg.broadcast.user_id || msg.data.user_id;\n    const channel = getChannel(state, channelId);\n    if (channel && !haveISystemPermission(state, {permission: Permissions.VIEW_MEMBERS}) && !haveITeamPermission(state, {permission: Permissions.VIEW_MEMBERS, team: channel.team_id})) {\n        dispatch(batchActions([\n            {\n                type: UserTypes.RECEIVED_PROFILE_NOT_IN_TEAM,\n                data: {id: channel.team_id, user_id: userId},\n            },\n            {\n                type: TeamTypes.REMOVE_MEMBER_FROM_TEAM,\n                data: {team_id: channel.team_id, user_id: userId},\n            },\n        ]));\n    }\n}\n\nexport async function handleUserUpdatedEvent(msg) {\n    const state = getState();\n    const currentUser = getCurrentUser(state);\n    const user = msg.data.user;\n\n    if (isGuest(user)) {\n        let members = getMembersInCurrentChannel(state);\n        const currentChannelId = getCurrentChannelId(state);\n        if (members && members[user.id]) {\n            dispatch(getChannelStats(currentChannelId));\n        } else {\n            await dispatch(getChannelMember(currentChannelId, user.id));\n            members = getMembersInCurrentChannel(getState());\n            if (members && members[user.id]) {\n                dispatch(getChannelStats(currentChannelId));\n            }\n        }\n    }\n\n    if (currentUser.id === user.id) {\n        if (user.update_at > currentUser.update_at) {\n            // Need to request me to make sure we don't override with sanitized fields from the\n            // websocket event\n            getMe()(dispatch, getState);\n        }\n    } else {\n        dispatch({\n            type: UserTypes.RECEIVED_PROFILE,\n            data: user,\n        });\n    }\n}\n\nfunction handleRoleAddedEvent(msg) {\n    const role = JSON.parse(msg.data.role);\n\n    dispatch({\n        type: RoleTypes.RECEIVED_ROLE,\n        data: role,\n    });\n}\n\nfunction handleRoleRemovedEvent(msg) {\n    const role = JSON.parse(msg.data.role);\n\n    dispatch({\n        type: RoleTypes.ROLE_DELETED,\n        data: role,\n    });\n}\n\nfunction handleChannelSchemeUpdatedEvent(msg) {\n    dispatch(getMyChannelMember(msg.broadcast.channel_id));\n}\n\nfunction handleRoleUpdatedEvent(msg) {\n    const role = JSON.parse(msg.data.role);\n\n    dispatch({\n        type: RoleTypes.RECEIVED_ROLE,\n        data: role,\n    });\n}\n\nfunction handleChannelCreatedEvent(msg) {\n    const channelId = msg.data.channel_id;\n    const teamId = msg.data.team_id;\n    const state = getState();\n\n    if (getCurrentTeamId(state) === teamId && !getChannel(state, channelId)) {\n        dispatch(getChannelAndMyMember(channelId));\n    }\n}\n\nfunction handleChannelDeletedEvent(msg) {\n    const state = getState();\n    const config = getConfig(state);\n    const viewArchivedChannels = config.ExperimentalViewArchivedChannels === 'true';\n    if (getCurrentChannelId(state) === msg.data.channel_id && !viewArchivedChannels) {\n        const teamUrl = getCurrentRelativeTeamUrl(state);\n        const currentTeamId = getCurrentTeamId(state);\n        const redirectChannel = getRedirectChannelNameForTeam(state, currentTeamId);\n        browserHistory.push(teamUrl + '/channels/' + redirectChannel);\n    }\n\n    dispatch({type: ChannelTypes.RECEIVED_CHANNEL_DELETED, data: {id: msg.data.channel_id, team_id: msg.broadcast.team_id, deleteAt: msg.data.delete_at, viewArchivedChannels}});\n}\n\nfunction handleChannelUnarchivedEvent(msg) {\n    const state = getState();\n    const config = getConfig(state);\n    const viewArchivedChannels = config.ExperimentalViewArchivedChannels === 'true';\n\n    dispatch({type: ChannelTypes.RECEIVED_CHANNEL_UNARCHIVED, data: {id: msg.data.channel_id, team_id: msg.broadcast.team_id, viewArchivedChannels}});\n}\n\nfunction handlePreferenceChangedEvent(msg) {\n    const preference = JSON.parse(msg.data.preference);\n    dispatch({type: PreferenceTypes.RECEIVED_PREFERENCES, data: [preference]});\n\n    if (addedNewDmUser(preference)) {\n        loadProfilesForSidebar();\n    }\n}\n\nfunction handlePreferencesChangedEvent(msg) {\n    const preferences = JSON.parse(msg.data.preferences);\n    dispatch({type: PreferenceTypes.RECEIVED_PREFERENCES, data: preferences});\n\n    if (preferences.findIndex(addedNewDmUser) !== -1) {\n        loadProfilesForSidebar();\n    }\n}\n\nfunction handlePreferencesDeletedEvent(msg) {\n    const preferences = JSON.parse(msg.data.preferences);\n    dispatch({type: PreferenceTypes.DELETED_PREFERENCES, data: preferences});\n}\n\nfunction addedNewDmUser(preference) {\n    return preference.category === Constants.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW && preference.value === 'true';\n}\n\nexport function handleUserTypingEvent(msg) {\n    return (doDispatch, doGetState) => {\n        const state = doGetState();\n        const config = getConfig(state);\n        const currentUserId = getCurrentUserId(state);\n        const userId = msg.data.user_id;\n\n        const data = {\n            id: msg.broadcast.channel_id + msg.data.parent_id,\n            userId,\n            now: Date.now(),\n        };\n\n        doDispatch({\n            type: WebsocketEvents.TYPING,\n            data,\n        });\n\n        setTimeout(() => {\n            doDispatch({\n                type: WebsocketEvents.STOP_TYPING,\n                data,\n            });\n        }, parseInt(config.TimeBetweenUserTypingUpdatesMilliseconds, 10));\n\n        if (userId !== currentUserId) {\n            doDispatch(getMissingProfilesByIds([userId]));\n        }\n\n        const status = getStatusForUserId(state, userId);\n        if (status !== General.ONLINE) {\n            doDispatch(getStatusesByIds([userId]));\n        }\n    };\n}\n\nfunction handleStatusChangedEvent(msg) {\n    dispatch({\n        type: UserTypes.RECEIVED_STATUSES,\n        data: [{user_id: msg.data.user_id, status: msg.data.status}],\n    });\n}\n\nfunction handleHelloEvent(msg) {\n    setServerVersion(msg.data.server_version)(dispatch, getState);\n}\n\nfunction handleReactionAddedEvent(msg) {\n    const reaction = JSON.parse(msg.data.reaction);\n\n    dispatch(getCustomEmojiForReaction(reaction.emoji_name));\n\n    dispatch({\n        type: PostTypes.RECEIVED_REACTION,\n        data: reaction,\n    });\n}\n\nfunction handleAddEmoji(msg) {\n    const data = JSON.parse(msg.data.emoji);\n\n    dispatch({\n        type: EmojiTypes.RECEIVED_CUSTOM_EMOJI,\n        data,\n    });\n}\n\nfunction handleReactionRemovedEvent(msg) {\n    const reaction = JSON.parse(msg.data.reaction);\n\n    dispatch({\n        type: PostTypes.REACTION_DELETED,\n        data: reaction,\n    });\n}\n\nfunction handleChannelViewedEvent(msg) {\n    // Useful for when multiple devices have the app open to different channels\n    if ((!window.isActive || getCurrentChannelId(getState()) !== msg.data.channel_id) &&\n        getCurrentUserId(getState()) === msg.broadcast.user_id) {\n        dispatch(markChannelAsRead(msg.data.channel_id, '', false));\n    }\n}\n\nexport function handlePluginEnabled(msg) {\n    const manifest = msg.data.manifest;\n    loadPlugin(manifest).catch((error) => {\n        console.error(error.message); //eslint-disable-line no-console\n    });\n}\n\nexport function handlePluginDisabled(msg) {\n    const manifest = msg.data.manifest;\n    removePlugin(manifest);\n}\n\nfunction handleUserRoleUpdated(msg) {\n    const user = store.getState().entities.users.profiles[msg.data.user_id];\n\n    if (user) {\n        const roles = msg.data.roles;\n        const newRoles = roles.split(' ');\n        const demoted = user.roles.includes(Constants.PERMISSIONS_SYSTEM_ADMIN) && !roles.includes(Constants.PERMISSIONS_SYSTEM_ADMIN);\n\n        store.dispatch({type: UserTypes.RECEIVED_PROFILE, data: {...user, roles}});\n        dispatch(loadRolesIfNeeded(newRoles));\n\n        if (demoted && global.location.pathname.startsWith('/admin_console')) {\n            redirectUserToDefaultTeam();\n        }\n    }\n}\n\nfunction handleConfigChanged(msg) {\n    store.dispatch({type: GeneralTypes.CLIENT_CONFIG_RECEIVED, data: msg.data.config});\n}\n\nfunction handleLicenseChanged(msg) {\n    store.dispatch({type: GeneralTypes.CLIENT_LICENSE_RECEIVED, data: msg.data.license});\n}\n\nfunction handlePluginStatusesChangedEvent(msg) {\n    store.dispatch({type: AdminTypes.RECEIVED_PLUGIN_STATUSES, data: msg.data.plugin_statuses});\n}\n\nfunction handleOpenDialogEvent(msg) {\n    const data = (msg.data && msg.data.dialog) || {};\n    const dialog = JSON.parse(data);\n\n    store.dispatch({type: IntegrationTypes.RECEIVED_DIALOG, data: dialog});\n\n    const currentTriggerId = getState().entities.integrations.dialogTriggerId;\n\n    if (dialog.trigger_id !== currentTriggerId) {\n        return;\n    }\n\n    store.dispatch(openModal({modalId: ModalIdentifiers.INTERACTIVE_DIALOG, dialogType: InteractiveDialog}));\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport {Tooltip} from 'react-bootstrap';\n\nimport OverlayTrigger from 'components/overlay_trigger';\n\nimport Constants from 'utils/constants.jsx';\n\n// A component that can be used to make controlled inputs that function properly in certain\n// environments (ie. IE11) where typing quickly would sometimes miss inputs\nexport default class QuickInput extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * Whether to delay updating the value of the textbox from props. Should only be used\n         * on textboxes that to properly compose CJK characters as the user types.\n         */\n        delayInputUpdate: PropTypes.bool,\n\n        /**\n         * An optional React component that will be used instead of an HTML input when rendering\n         */\n        inputComponent: PropTypes.elementType,\n\n        /**\n         * The string value displayed in this input\n         */\n        value: PropTypes.string.isRequired,\n\n        /**\n         * When true, and an onClear callback is defined, show an X on the input field that clears\n         * the input when clicked.\n         */\n        clearable: PropTypes.bool,\n\n        /**\n         * The optional tooltip text to display on the X shown when clearable. Pass a components\n         * such as FormattedMessage to localize.\n         */\n        clearableTooltipText: PropTypes.oneOfType([PropTypes.string, PropTypes.element]),\n\n        /**\n         * Callback to clear the input value, and used in tandem with the clearable prop above.\n         */\n        onClear: PropTypes.func,\n    };\n\n    static defaultProps = {\n        delayInputUpdate: false,\n        value: '',\n        clearable: false,\n    };\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.value !== this.props.value) {\n            if (this.props.delayInputUpdate) {\n                requestAnimationFrame(this.updateInputFromProps);\n            } else {\n                this.updateInputFromProps();\n            }\n        }\n    }\n\n    updateInputFromProps = () => {\n        if (!this.input || this.input.value === this.props.value) {\n            return;\n        }\n\n        this.input.value = this.props.value;\n    }\n\n    get value() {\n        return this.input.value;\n    }\n\n    set value(value) {\n        this.input.value = value;\n    }\n\n    focus() {\n        this.input.focus();\n    }\n\n    blur() {\n        this.input.blur();\n    }\n\n    getInput = () => {\n        return this.input;\n    };\n\n    setInput = (input) => {\n        this.input = input;\n    }\n\n    onClear = () => {\n        if (this.props.onClear) {\n            this.props.onClear();\n        }\n        this.focus();\n    }\n\n    render() {\n        let clearableTooltipText = this.props.clearableTooltipText;\n        if (!clearableTooltipText) {\n            clearableTooltipText = (\n                <FormattedMessage\n                    id={'input.clear'}\n                    defaultMessage='Clear'\n                />\n            );\n        }\n\n        const clearableTooltip = (\n            <Tooltip id={'InputClearTooltip'}>\n                {clearableTooltipText}\n            </Tooltip>\n        );\n\n        const {value, inputComponent, clearable, ...props} = this.props;\n\n        Reflect.deleteProperty(props, 'delayInputUpdate');\n        Reflect.deleteProperty(props, 'onClear');\n        Reflect.deleteProperty(props, 'clearableTooltipText');\n\n        const inputElement = React.createElement(\n            inputComponent || 'input',\n            {\n                ...props,\n                ref: this.setInput,\n                defaultValue: value, // Only set the defaultValue since the real one will be updated using componentDidUpdate\n            }\n        );\n\n        return (<div>\n            {inputElement}\n            {clearable && value && this.props.onClear &&\n                <div\n                    className='input-clear visible'\n                    onClick={this.onClear}\n                >\n                    <OverlayTrigger\n                        delayShow={Constants.OVERLAY_TIME_DELAY}\n                        placement='bottom'\n                        overlay={clearableTooltip}\n                    >\n                        <span\n                            className='input-clear-x'\n                            aria-hidden='true'\n                        >\n                            {''}\n                        </span>\n                    </OverlayTrigger>\n                </div>\n            }\n        </div>);\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {browserHistory} from 'utils/browser_history';\nimport * as Selectors from 'selectors/storage';\nimport * as Actions from 'actions/storage';\nimport store from 'stores/redux_store.jsx';\nimport {ErrorPageTypes, StoragePrefixes, LandingPreferenceTypes} from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\n\nconst dispatch = store.dispatch;\nconst getState = store.getState;\n\nclass BrowserStoreClass {\n    setItem(name, value) {\n        dispatch(Actions.setItem(name, value));\n    }\n\n    getItem(name, defaultValue) {\n        return Selectors.makeGetItem(name, defaultValue)(getState());\n    }\n\n    removeItem(name) {\n        dispatch(Actions.removeItem(name));\n    }\n\n    setGlobalItem(name, value) {\n        dispatch(Actions.setGlobalItem(name, value));\n    }\n\n    getGlobalItem(name, defaultValue = null) {\n        return Selectors.makeGetGlobalItem(name, defaultValue)(getState());\n    }\n\n    removeGlobalItem(name) {\n        dispatch(Actions.removeGlobalItem(name));\n    }\n\n    signalLogout() {\n        if (this.isLocalStorageSupported()) {\n            // PLT-1285 store an identifier in session storage so we can catch if the logout came from this tab on IE11\n            const logoutId = Utils.generateId();\n\n            Utils.removePrefixFromLocalStorage(StoragePrefixes.ANNOUNCEMENT);\n\n            sessionStorage.setItem(StoragePrefixes.LOGOUT, logoutId);\n            localStorage.setItem(StoragePrefixes.LOGOUT, logoutId);\n            localStorage.removeItem(StoragePrefixes.LOGOUT);\n        }\n    }\n\n    isSignallingLogout(logoutId) {\n        return logoutId === sessionStorage.getItem(StoragePrefixes.LOGOUT);\n    }\n\n    signalLogin() {\n        if (this.isLocalStorageSupported()) {\n            // PLT-1285 store an identifier in session storage so we can catch if the logout came from this tab on IE11\n            const loginId = Utils.generateId();\n\n            sessionStorage.setItem(StoragePrefixes.LOGIN, loginId);\n            localStorage.setItem(StoragePrefixes.LOGIN, loginId);\n            localStorage.removeItem(StoragePrefixes.LOGIN);\n        }\n    }\n\n    isSignallingLogin(loginId) {\n        return loginId === sessionStorage.getItem(StoragePrefixes.LOGIN);\n    }\n\n    clear(options) {\n        dispatch(Actions.clear(options));\n    }\n\n    isLocalStorageSupported() {\n        if (this.hasCheckedLocalStorage) {\n            return this.localStorageSupported;\n        }\n\n        this.localStorageSupported = false;\n\n        try {\n            localStorage.setItem('__testLocal__', '1');\n            if (localStorage.getItem('__testLocal__') === '1') {\n                this.localStorageSupported = true;\n            }\n            localStorage.removeItem('__testLocal__', '1');\n        } catch (e) {\n            this.localStorageSupported = false;\n        }\n\n        try {\n            sessionStorage.setItem('__testSession__', '1');\n            sessionStorage.removeItem('__testSession__');\n        } catch (e) {\n            // Session storage not usable, website is unusable\n            browserHistory.push('/error?type=' + ErrorPageTypes.LOCAL_STORAGE);\n        }\n\n        this.hasCheckedLocalStorage = true;\n\n        return this.localStorageSupported;\n    }\n\n    hasSeenLandingPage() {\n        return localStorage.getItem(StoragePrefixes.LANDING_PAGE_SEEN);\n    }\n\n    setLandingPageSeen(landingPageSeen) {\n        localStorage.setItem(StoragePrefixes.LANDING_PAGE_SEEN, landingPageSeen);\n    }\n\n    getLandingPreference(siteUrl) {\n        return localStorage.getItem(StoragePrefixes.LANDING_PREFERENCE + String(siteUrl));\n    }\n\n    setLandingPreferenceToMattermostApp(siteUrl) {\n        localStorage.setItem(StoragePrefixes.LANDING_PREFERENCE + String(siteUrl), LandingPreferenceTypes.MATTERMOSTAPP);\n    }\n\n    setLandingPreferenceToBrowser(siteUrl) {\n        localStorage.setItem(StoragePrefixes.LANDING_PREFERENCE + String(siteUrl), LandingPreferenceTypes.BROWSER);\n    }\n\n    clearLandingPreference(siteUrl) {\n        localStorage.removeItem(StoragePrefixes.LANDING_PREFERENCE + String(siteUrl));\n    }\n}\n\nvar BrowserStore = new BrowserStoreClass();\nexport default BrowserStore;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\n// Use when sorting multiple teams by their `display_name` field\nfunction compareTeamsByDisplayName(locale, a, b) {\n    if (a.display_name !== null) {\n        if (a.display_name !== b.display_name) {\n            return a.display_name.localeCompare(b.display_name, locale, {numeric: true});\n        }\n    }\n\n    return a.name.localeCompare(b.name, locale, {numeric: true});\n}\n\n// Use to filter out teams that are deleted and without display_name, then sort by their `display_name` field\nexport function filterAndSortTeamsByDisplayName(teams, locale, teamsOrder = '') {\n    if (!teams) {\n        return [];\n    }\n\n    const teamsOrderList = teamsOrder.split(',');\n\n    const customSortedTeams = teams.filter((team) => {\n        if (team !== null) {\n            return teamsOrderList.includes(team.id);\n        }\n        return false;\n    }).sort((a, b) => {\n        return teamsOrderList.indexOf(a.id) - teamsOrderList.indexOf(b.id);\n    });\n\n    const otherTeams = teams.filter((team) => {\n        if (team !== null) {\n            return !teamsOrderList.includes(team.id);\n        }\n        return false;\n    }).sort((a, b) => {\n        return compareTeamsByDisplayName(locale, a, b);\n    });\n\n    return [...customSortedTeams, ...otherTeams].filter((team) => {\n        return team && !team.delete_at > 0 && team.display_name != null;\n    });\n}","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport './menu_item.scss';\n\nexport default function menuItem(Component: React.ComponentType<any>) {\n    type Props = {\n        show: boolean;\n        id?: string;\n        icon?: React.ReactNode;\n        text?: React.ReactNode;\n    }\n    class MenuItem extends React.PureComponent<Props|React.ComponentProps<typeof Component>> {\n        public static defaultProps = {\n            show: true,\n        };\n\n        public static displayName?: string;\n\n        public render() {\n            const {id, show, icon, text, ...props} = this.props;\n            if (!show) {\n                return null;\n            }\n\n            let textProp: React.ReactNode = text;\n            if (icon) {\n                textProp = (\n                    <React.Fragment>\n                        <span className='icon'>{icon}</span>\n                        {text}\n                    </React.Fragment>\n                );\n            }\n\n            return (\n                <li\n                    className='MenuItem'\n                    role='menuitem'\n                    id={id}\n                >\n                    <Component\n                        text={textProp}\n                        {...props}\n                    />\n                </li>\n            );\n        }\n    }\n    return MenuItem;\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport {localizeMessage} from 'utils/utils.jsx';\nimport LoadingImagePreview from 'components/loading_image_preview';\n\nconst MIN_IMAGE_SIZE = 48;\n\n// SizeAwareImage is a component used for rendering images where the dimensions of the image are important for\n// ensuring that the page is laid out correctly.\nexport default class SizeAwareImage extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * The source URL of the image\n         */\n        src: PropTypes.string.isRequired,\n\n        /*\n         * dimensions object to create empty space required to prevent scroll pop\n         */\n        dimensions: PropTypes.object,\n        fileInfo: PropTypes.object,\n\n        /*\n         * Boolean value to pass for showing a loader when image is being loaded\n         */\n        showLoader: PropTypes.bool,\n\n        /*\n         * A callback that is called as soon as the image component has a height value\n         */\n        onImageLoaded: PropTypes.func,\n\n        /*\n         * A callback that is called when image load fails\n         */\n        onImageLoadFail: PropTypes.func,\n\n        /*\n         * Fetch the onClick function\n         */\n        onClick: PropTypes.func,\n\n        /*\n         * css classes that can added to the img as well as parent div on svg for placeholder\n         */\n        className: PropTypes.string,\n\n        /*\n         * Enables the logic of surrounding small images with a bigger container div for better click/tap targeting\n         */\n        handleSmallImageContainer: PropTypes.bool,\n    }\n\n    constructor(props) {\n        super(props);\n        const {dimensions} = props;\n\n        this.state = {\n            loaded: false,\n            isSmallImage: this.dimensionsAvailable(dimensions) ? this.isSmallImage(\n                dimensions.width, dimensions.height) : false,\n        };\n\n        this.heightTimeout = 0;\n    }\n\n    componentDidMount() {\n        this.mounted = true;\n    }\n\n    componentWillUnmount() {\n        this.mounted = false;\n    }\n\n    dimensionsAvailable = (dimensions) => {\n        return dimensions && dimensions.width && dimensions.height;\n    }\n\n    isSmallImage = (width, height) => {\n        return width < MIN_IMAGE_SIZE || height < MIN_IMAGE_SIZE;\n    }\n\n    handleLoad = (event) => {\n        if (this.mounted) {\n            const image = event.target;\n            const isSmallImage = this.isSmallImage(image.naturalWidth, image.naturalHeight);\n            this.setState({\n                loaded: true,\n                error: false,\n                isSmallImage,\n                imageWidth: image.naturalWidth,\n            }, () => { // Call onImageLoaded prop only after state has already been set\n                if (this.props.onImageLoaded && image.naturalHeight) {\n                    this.props.onImageLoaded({height: image.naturalHeight, width: image.naturalWidth});\n                }\n            });\n        }\n    };\n\n    handleError = () => {\n        if (this.mounted) {\n            if (this.props.onImageLoadFail) {\n                this.props.onImageLoadFail();\n            }\n            this.setState({error: true});\n        }\n    };\n\n    onEnterKeyDown = (e) => {\n        if (e.key === 'Enter') {\n            this.props.onClick(e);\n        }\n    }\n\n    renderImageLoaderIfNeeded = () => {\n        if (!this.state.loaded && this.props.showLoader && !this.state.error) {\n            return (\n                <div style={{position: 'absolute', top: '50%', transform: 'translate(-50%, -50%)', left: '50%'}}>\n                    <LoadingImagePreview\n                        containerClass={'file__image-loading'}\n                    />\n                </div>\n            );\n        }\n        return null;\n    }\n\n    renderImageWithContainerIfNeeded = () => {\n        const {\n            fileInfo,\n            src,\n            ...props\n        } = this.props;\n\n        Reflect.deleteProperty(props, 'showLoader');\n        Reflect.deleteProperty(props, 'onImageLoaded');\n        Reflect.deleteProperty(props, 'onImageLoadFail');\n        Reflect.deleteProperty(props, 'dimensions');\n        Reflect.deleteProperty(props, 'handleSmallImageContainer');\n\n        let ariaLabelImage = localizeMessage('file_attachment.thumbnail', 'file thumbnail');\n        if (fileInfo) {\n            ariaLabelImage += ` ${fileInfo.name}`.toLowerCase();\n        }\n\n        const image = (\n            <img\n                {...props}\n                aria-label={ariaLabelImage}\n                tabIndex='0'\n                onKeyDown={this.onEnterKeyDown}\n                className={\n                    this.props.className +\n                    (this.props.handleSmallImageContainer &&\n                        this.state.isSmallImage ? ' small-image--inside-container' : '')}\n                src={src}\n                onError={this.handleError}\n                onLoad={this.handleLoad}\n            />\n        );\n\n        if (this.props.handleSmallImageContainer && this.state.isSmallImage) {\n            let className = 'small-image__container cursor--pointer a11y--active';\n            if (this.state.imageWidth < MIN_IMAGE_SIZE) {\n                className += ' small-image__container--min-width';\n            }\n\n            return (\n                <div\n                    onClick={this.props.onClick}\n                    className={className}\n                    style={this.state.imageWidth > MIN_IMAGE_SIZE ? {\n                        width: this.state.imageWidth + 2, // 2px to account for the border\n                    } : {}}\n                >\n                    {image}\n                </div>\n            );\n        }\n\n        return image;\n    }\n\n    renderImageOrPlaceholder = () => {\n        const {\n            dimensions,\n        } = this.props;\n\n        let placeHolder;\n\n        if (this.dimensionsAvailable(dimensions) && !this.state.loaded) {\n            placeHolder = (\n                <div\n                    className={`image-loading__container ${this.props.className}`}\n                    style={{maxWidth: dimensions.width}}\n                >\n                    {this.renderImageLoaderIfNeeded()}\n                    <svg\n                        xmlns='http://www.w3.org/2000/svg'\n                        viewBox={`0 0 ${dimensions.width} ${dimensions.height}`}\n                        style={{maxHeight: dimensions.height, maxWidth: dimensions.width, verticalAlign: 'middle'}}\n                    />\n                </div>\n            );\n        }\n\n        const shouldShowImg = !this.dimensionsAvailable(dimensions) || this.state.loaded;\n\n        return (\n            <React.Fragment>\n                {placeHolder}\n                <div\n                    className='file-preview__button'\n                    style={{display: shouldShowImg ? 'initial' : 'none'}}\n                >\n                    {this.renderImageWithContainerIfNeeded()}\n                </div>\n            </React.Fragment>\n        );\n    }\n\n    render() {\n        return (\n            this.renderImageOrPlaceholder()\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {FormattedMessage} from 'react-intl';\n\nexport default class SuccessIcon extends React.PureComponent {\n    render() {\n        return (\n            <FormattedMessage\n                id='generic_icons.success'\n                defaultMessage='Success Icon'\n            >\n                {(title) => (\n                    <i\n                        className='fa fa-check'\n                        title={title}\n                    />\n                )}\n            </FormattedMessage>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {FormattedMessage} from 'react-intl';\n\nexport default class BackIcon extends React.PureComponent {\n    render() {\n        return (\n            <FormattedMessage\n                id='generic_icons.back'\n                defaultMessage='Back Icon'\n            >\n                {(title) => (\n                    <i\n                        className='fa fa-angle-left'\n                        title={title}\n                    />\n                )}\n            </FormattedMessage>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {FormattedMessage} from 'react-intl';\n\nexport default class AddIcon extends React.PureComponent {\n    render() {\n        return (\n            <FormattedMessage\n                id='generic_icons.add'\n                defaultMessage='Add Icon'\n            >\n                {(title) => (\n                    <i\n                        className='fa fa-plus'\n                        title={title}\n                    />\n                )}\n            </FormattedMessage>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nexport default class ModalToggleButton extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            show: false,\n        };\n    }\n\n    show = (e) => {\n        if (e) {\n            e.preventDefault();\n        }\n        this.setState({show: true});\n    }\n\n    hide = () => {\n        this.setState({show: false});\n    }\n\n    render() {\n        const {children, dialogType, dialogProps, onClick, ...props} = this.props;\n\n        // allow callers to provide an onClick which will be called before the modal is shown\n        let clickHandler = this.show;\n        if (onClick) {\n            clickHandler = (e) => {\n                onClick();\n\n                this.show(e);\n            };\n        }\n\n        let dialog;\n        if (this.state.show) {\n            // this assumes that all modals will have an onHide event and will show when mounted\n            dialog = React.createElement(dialogType, Object.assign({}, dialogProps, {\n                onHide: () => {\n                    this.hide();\n\n                    if (dialogProps.onHide) {\n                        dialogProps.onHide();\n                    }\n                },\n            }));\n        }\n\n        // nesting the dialog in the anchor tag looks like it shouldn't work, but it does due to how react-bootstrap\n        // renders modals at the top level of the DOM instead of where you specify in the virtual DOM\n        return (\n            <button\n                {...props}\n                className={'style--none ' + props.className}\n                onClick={clickHandler}\n                data-testid='add-group'\n            >\n                {children}\n                {dialog}\n            </button>\n        );\n    }\n}\n\nModalToggleButton.propTypes = {\n    children: PropTypes.node.isRequired,\n    dialogType: PropTypes.func.isRequired,\n    dialogProps: PropTypes.object,\n    onClick: PropTypes.func,\n    className: PropTypes.string,\n};\n\nModalToggleButton.defaultProps = {\n    dialogProps: {},\n    className: '',\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class StatusAwayAvatarIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='mobile.set_status.away.icon'\n                    defaultMessage='Away Icon'\n                >\n                    {(ariaLabel) => (\n\n                        <svg\n                            width='13px'\n                            height='13px'\n                            viewBox='0 0 12 12'\n                            style={style}\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path\n                                className='away--icon'\n                                d='M9.081,5.712C9.267,5.712 9.417,5.863 9.417,6.048L9.417,9.086L11.864,10.499C12.025,10.592 12.08,10.797 11.987,10.958L11.482,11.832C11.39,11.993 11.184,12.048 11.023,11.955L7.904,10.154C7.788,10.087 7.727,9.961 7.737,9.836C7.736,9.827 7.736,9.818 7.736,9.809L7.736,6.048C7.736,5.863 7.886,5.712 8.072,5.712L9.081,5.712ZM4.812,11.513L4.605,11.513C2.325,11.41 0.253,10.374 0.046,9.027C-0.058,8.923 0.046,8.509 0.046,8.405C0.15,7.576 0.357,6.437 0.771,5.815C0.978,5.401 2.015,5.297 2.015,5.297C2.015,5.297 2.015,7.369 4.605,7.369L5.019,7.369C4.915,7.784 4.812,8.198 4.812,8.612C4.812,9.648 5.226,10.581 5.848,11.41C5.537,11.513 5.123,11.513 4.812,11.513ZM4.605,0.117C6.034,0.117 7.195,1.277 7.195,2.707C7.195,4.136 6.034,5.297 4.605,5.297C3.175,5.297 2.015,4.136 2.015,2.707C2.015,1.277 3.175,0.117 4.605,0.117Z'\n                            />\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n\nconst style = {\n    fillRule: 'evenodd',\n    clipRule: 'evenodd',\n    strokeLinejoin: 'round',\n    strokeMiterlimit: 1.41421,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class StatusAwayIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='mobile.set_status.away.icon'\n                    defaultMessage='Away Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='100%'\n                            height='100%'\n                            viewBox='0 0 20 20'\n                            style={style}\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path\n                                className='away--icon'\n                                d='M10,0C15.519,0 20,4.481 20,10C20,15.519 15.519,20 10,20C4.481,20 0,15.519 0,10C0,4.481 4.481,0 10,0ZM10.27,3C10.949,3 11.5,3.586 11.5,4.307L11.5,9.379L15.002,12.881C15.492,13.37 15.499,14.158 15.019,14.638L14.638,15.019C14.158,15.499 13.37,15.492 12.881,15.002L8.887,11.008C8.739,10.861 8.636,10.686 8.576,10.501C8.528,10.402 8.5,10.299 8.5,10.193L8.5,4.307C8.5,3.586 9.051,3 9.73,3L10.27,3Z'\n                            />\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n\nconst style = {\n    fillRule: 'evenodd',\n    clipRule: 'evenodd',\n    strokeLinejoin: 'round',\n    strokeMiterlimit: 1.41421,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class StatusDndAvatarIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='mobile.set_status.dnd.icon'\n                    defaultMessage='Do Not Disturb Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            x='0px'\n                            y='0px'\n                            width='13px'\n                            height='13px'\n                            viewBox='-299 391 12 12'\n                            style={style}\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g>\n                                <ellipse\n                                    className='dnd--icon'\n                                    cx='-294.6'\n                                    cy='394'\n                                    rx='2.5'\n                                    ry='2.5'\n                                />\n                                <path\n                                    className='dnd--icon'\n                                    d='M-293.8,399.4c0-0.4,0.1-0.7,0.2-1c-0.3,0.1-0.6,0.2-1,0.2c-2.5,0-2.5-2-2.5-2s-1,0.1-1.2,0.5c-0.4,0.6-0.6,1.7-0.7,2.5 c0,0.1-0.1,0.5,0,0.6c0.2,1.3,2.2,2.3,4.4,2.4c0,0,0.1,0,0.1,0c0,0,0.1,0,0.1,0c0.7,0,1.4-0.1,2-0.3 C-293.3,401.5-293.8,400.5-293.8,399.4z'\n                                />\n                            </g>\n                            <path\n                                className='dnd--icon'\n                                d='M-287,400c0,0.1-0.1,0.1-0.1,0.1l-4.9,0c-0.1,0-0.1-0.1-0.1-0.1v-1.6c0-0.1,0.1-0.1,0.1-0.1l4.9,0c0.1,0,0.1,0.1,0.1,0.1 V400z'\n                            />\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n\nconst style = {\n    enableBackground: 'new -299 391 12 12',\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class StatusDndIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='mobile.set_status.dnd.icon'\n                    defaultMessage='Do Not Disturb Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='100%'\n                            height='100%'\n                            viewBox='0 0 20 20'\n                            style={style}\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path\n                                className='dnd--icon'\n                                d='M10,0c5.519,0 10,4.481 10,10c0,5.519 -4.481,10 -10,10c-5.519,0 -10,-4.481 -10,-10c0,-5.519 4.481,-10 10,-10Zm5.25,8.5l-10.5,0c-0.414,0 -0.75,0.336 -0.75,0.75l0,1.5c0,0.414 0.336,0.75 0.75,0.75l10.5,0c0.414,0 0.75,-0.336 0.75,-0.75l0,-1.5c0,-0.414 -0.336,-0.75 -0.75,-0.75Z'\n                            />\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n\nconst style = {\n    fillRule: 'evenodd',\n    clipRule: 'evenodd',\n    strokeLinejoin: 'round',\n    strokeMiterlimit: 1.41421,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class StatusDndAvatarIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='mobile.set_status.offline.icon'\n                    defaultMessage='Offline Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            x='0px'\n                            y='0px'\n                            width='13px'\n                            height='13px'\n                            viewBox='-299 391 12 12'\n                            style={style}\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g>\n                                <g>\n                                    <ellipse\n                                        className='offline--icon'\n                                        cx='-294.5'\n                                        cy='394'\n                                        rx='2.5'\n                                        ry='2.5'\n                                    />\n                                    <path\n                                        className='offline--icon'\n                                        d='M-294.3,399.7c0-0.4,0.1-0.8,0.2-1.2c-0.1,0-0.2,0-0.4,0c-2.5,0-2.5-2-2.5-2s-1,0.1-1.2,0.5c-0.4,0.6-0.6,1.7-0.7,2.5 c0,0.1-0.1,0.5,0,0.6c0.2,1.3,2.2,2.3,4.4,2.4h0.1h0.1c0.3,0,0.7,0,1-0.1C-293.9,401.6-294.3,400.7-294.3,399.7z'\n                                    />\n                                </g>\n                            </g>\n                            <g>\n                                <path\n                                    className='offline--icon'\n                                    d='M-288.9,399.4l1.8-1.8c0.1-0.1,0.1-0.3,0-0.3l-0.7-0.7c-0.1-0.1-0.3-0.1-0.3,0l-1.8,1.8l-1.8-1.8c-0.1-0.1-0.3-0.1-0.3,0 l-0.7,0.7c-0.1,0.1-0.1,0.3,0,0.3l1.8,1.8l-1.8,1.8c-0.1,0.1-0.1,0.3,0,0.3l0.7,0.7c0.1,0.1,0.3,0.1,0.3,0l1.8-1.8l1.8,1.8 c0.1,0.1,0.3,0.1,0.3,0l0.7-0.7c0.1-0.1,0.1-0.3,0-0.3L-288.9,399.4z'\n                                />\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n\nconst style = {\n    enableBackground: 'new -299 391 12 12',\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class StatusOfflineIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='mobile.set_status.offline.icon'\n                    defaultMessage='Offline Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='100%'\n                            height='100%'\n                            className='offline--icon'\n                            viewBox='0 0 20 20'\n                            style={style}\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path d='M10,0c5.519,0 10,4.481 10,10c0,5.519 -4.481,10 -10,10c-5.519,0 -10,-4.481 -10,-10c0,-5.519 4.481,-10 10,-10Zm0,2c4.415,0 8,3.585 8,8c0,4.415 -3.585,8 -8,8c-4.415,0 -8,-3.585 -8,-8c0,-4.415 3.585,-8 8,-8Z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n\nconst style = {\n    fillRule: 'evenodd',\n    clipRule: 'evenodd',\n    strokeLinejoin: 'round',\n    strokeMiterlimit: 1.41421,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class StatusOnlineAvatarIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='mobile.set_status.online.icon'\n                    defaultMessage='Online Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            x='0px'\n                            y='0px'\n                            width='13px'\n                            height='13px'\n                            viewBox='-243 245 12 12'\n                            style={style}\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g>\n                                <path\n                                    className='online--icon'\n                                    d='M-236,250.5C-236,250.5-236,250.5-236,250.5C-236,250.5-236,250.5-236,250.5C-236,250.5-236,250.5-236,250.5z'\n                                />\n                                <ellipse\n                                    className='online--icon'\n                                    cx='-238.5'\n                                    cy='248'\n                                    rx='2.5'\n                                    ry='2.5'\n                                />\n                            </g>\n                            <path\n                                className='online--icon'\n                                d='M-238.9,253.8c0-0.4,0.1-0.9,0.2-1.3c-2.2-0.2-2.2-2-2.2-2s-1,0.1-1.2,0.5c-0.4,0.6-0.6,1.7-0.7,2.5c0,0.1-0.1,0.5,0,0.6 c0.2,1.3,2.2,2.3,4.4,2.4c0,0,0.1,0,0.1,0c0,0,0.1,0,0.1,0c0,0,0.1,0,0.1,0C-238.7,255.7-238.9,254.8-238.9,253.8z'\n                            />\n                            <g>\n                                <g>\n                                    <path\n                                        className='online--icon'\n                                        d='M-232.3,250.1l1.3,1.3c0,0,0,0.1,0,0.1l-4.1,4.1c0,0,0,0-0.1,0c0,0,0,0,0,0l-2.7-2.7c0,0,0-0.1,0-0.1l1.2-1.2 c0,0,0.1,0,0.1,0l1.4,1.4l2.9-2.9C-232.4,250.1-232.3,250.1-232.3,250.1z'\n                                    />\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n\nconst style = {\n    enableBackground: 'new -243 245 12 12',\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class StatusOnlineIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='mobile.set_status.online.icon'\n                    defaultMessage='Online Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='100%'\n                            height='100%'\n                            viewBox='0 0 20 20'\n                            style={style}\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path\n                                className='online--icon'\n                                d='M10,0c5.519,0 10,4.481 10,10c0,5.519 -4.481,10 -10,10c-5.519,0 -10,-4.481 -10,-10c0,-5.519 4.481,-10 10,-10Zm6.19,7.18c0,0.208 -0.075,0.384 -0.224,0.53l-5.782,5.64l-1.087,1.059c-0.149,0.146 -0.33,0.218 -0.543,0.218c-0.213,0 -0.394,-0.072 -0.543,-0.218l-1.086,-1.059l-2.891,-2.82c-0.149,-0.146 -0.224,-0.322 -0.224,-0.53c0,-0.208 0.075,-0.384 0.224,-0.53l1.086,-1.059c0.149,-0.146 0.33,-0.218 0.543,-0.218c0.213,0 0.394,0.072 0.543,0.218l2.348,2.298l5.24,-5.118c0.149,-0.146 0.33,-0.218 0.543,-0.218c0.213,0 0.394,0.072 0.543,0.218l1.086,1.059c0.149,0.146 0.224,0.322 0.224,0.53Z'\n                            />\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n\nconst style = {\n    fillRule: 'evenodd',\n    clipRule: 'evenodd',\n    strokeLinejoin: 'round',\n    strokeMiterlimit: 1.41421,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport StatusAwayAvatarIcon from 'components/widgets/icons/status_away_avatar_icon';\nimport StatusAwayIcon from 'components/widgets/icons/status_away_icon';\nimport StatusDndAvatarIcon from 'components/widgets/icons/status_dnd_avatar_icon';\nimport StatusDndIcon from 'components/widgets/icons/status_dnd_icon';\nimport StatusOfflineAvatarIcon from 'components/widgets/icons/status_offline_avatar_icon';\nimport StatusOfflineIcon from 'components/widgets/icons/status_offline_icon';\nimport StatusOnlineAvatarIcon from 'components/widgets/icons/status_online_avatar_icon';\nimport StatusOnlineIcon from 'components/widgets/icons/status_online_icon';\n\nexport default class StatusIcon extends React.PureComponent {\n    static propTypes = {\n        button: PropTypes.bool,\n        status: PropTypes.string,\n        className: PropTypes.string,\n        type: PropTypes.string,\n    };\n\n    static defaultProps = {\n        className: '',\n        button: false,\n    };\n\n    render() {\n        const {button, status, type} = this.props;\n\n        if (!status) {\n            return null;\n        }\n\n        let className = 'status ' + this.props.className;\n\n        if (button) {\n            className = this.props.className;\n        }\n\n        let IconComponent = 'span';\n        if (type === 'avatar') {\n            if (status === 'online') {\n                IconComponent = StatusOnlineAvatarIcon;\n            } else if (status === 'away') {\n                IconComponent = StatusAwayAvatarIcon;\n            } else if (status === 'dnd') {\n                IconComponent = StatusDndAvatarIcon;\n            } else {\n                IconComponent = StatusOfflineAvatarIcon;\n            }\n        } else if (status === 'online') {\n            IconComponent = StatusOnlineIcon;\n        } else if (status === 'away') {\n            IconComponent = StatusAwayIcon;\n        } else if (status === 'dnd') {\n            IconComponent = StatusDndIcon;\n        } else {\n            IconComponent = StatusOfflineIcon;\n        }\n\n        return <IconComponent className={className}/>;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport {getImageSrc} from 'utils/post_utils.jsx';\n\nexport default class ExternalImage extends React.PureComponent {\n    static propTypes = {\n        children: PropTypes.func.isRequired,\n        enableSVGs: PropTypes.bool.isRequired,\n        hasImageProxy: PropTypes.bool.isRequired,\n        imageMetadata: PropTypes.object,\n        src: PropTypes.string.isRequired,\n    };\n\n    isSVGImage = () => {\n        if (!this.props.imageMetadata) {\n            // Just check if the string contains an svg extension instead of if it ends with one because it avoids\n            // having to deal with query strings and proxied image URLs\n            return this.props.src.indexOf('.svg') !== -1;\n        }\n\n        return this.props.imageMetadata.format === 'svg';\n    }\n\n    shouldRenderImage = () => {\n        // Return true unless the image is an SVG and we have SVG rendering disabled\n        return this.props.enableSVGs || !this.isSVGImage();\n    }\n\n    render() {\n        let src = getImageSrc(this.props.src, this.props.hasImageProxy);\n\n        if (!this.shouldRenderImage()) {\n            src = '';\n        }\n\n        return this.props.children(src);\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport ExternalImage from './external_image';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n\n    return {\n        enableSVGs: config.EnableSVGs === 'true',\n        hasImageProxy: config.HasImageProxy === 'true',\n    };\n}\n\nexport default connect(mapStateToProps)(ExternalImage);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {getClientConfig, getLicenseConfig} from 'mattermost-redux/actions/general';\nimport * as UserActions from 'mattermost-redux/actions/users';\nimport {Client4} from 'mattermost-redux/client';\n\nimport {ActionTypes} from 'utils/constants';\nimport en from 'i18n/en.json';\nimport {getCurrentLocale, getTranslations} from 'selectors/i18n';\n\nexport function loadMeAndConfig() {\n    return async (dispatch) => {\n        // if any new promise needs to be added please be mindful of the order as it is used in root.jsx for redirection\n        const promises = [\n            dispatch(getClientConfig()),\n            dispatch(getLicenseConfig()),\n        ];\n\n        // need to await for clientConfig first as it is required for loadMe\n        const resolvedPromises = await Promise.all(promises);\n        if (document.cookie.indexOf('MMUSERID=') > -1) {\n            resolvedPromises.push(await dispatch(UserActions.loadMe()));\n        }\n\n        return resolvedPromises;\n    };\n}\n\nconst pluginTranslationSources = {};\n\nexport function registerPluginTranslationsSource(pluginId, sourceFunction) {\n    pluginTranslationSources[pluginId] = sourceFunction;\n    return (dispatch, getState) => {\n        const state = getState();\n        const locale = getCurrentLocale(state);\n        const immutableTranslations = getTranslations(state, locale);\n        const translations = {};\n        Object.assign(translations, immutableTranslations);\n        if (immutableTranslations) {\n            Object.assign(translations, sourceFunction(locale));\n            dispatch({\n                type: ActionTypes.RECEIVED_TRANSLATIONS,\n                data: {\n                    locale,\n                    translations,\n                },\n            });\n        }\n    };\n}\n\nexport function unregisterPluginTranslationsSource(pluginId) {\n    Reflect.deleteProperty(pluginTranslationSources, pluginId);\n}\n\nexport function loadTranslations(locale, url) {\n    return async (dispatch) => {\n        const translations = {...en};\n        Object.values(pluginTranslationSources).forEach((pluginFunc) => {\n            Object.assign(translations, pluginFunc(locale));\n        });\n\n        // Need to go to the server for languages other than English\n        if (locale !== 'en') {\n            try {\n                const serverTranslations = await Client4.getTranslations(url);\n                Object.assign(translations, serverTranslations);\n            } catch (error) {\n                console.error(error); //eslint-disable-line no-console\n            }\n        }\n        dispatch({\n            type: ActionTypes.RECEIVED_TRANSLATIONS,\n            data: {\n                locale,\n                translations,\n            },\n        });\n    };\n}\n\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport './badge.scss';\n\ntype Props = {\n    show: boolean;\n    children: React.ReactNode;\n    className: string;\n};\n\nexport default class Badge extends React.Component<Props> {\n    public static defaultProps = {\n        show: true,\n        className: '',\n    };\n\n    public render() {\n        if (!this.props.show) {\n            return null;\n        }\n        return (\n            <div className='Badge'>\n                <div className={'Badge__box ' + this.props.className}>\n                    {this.props.children}\n                </div>\n            </div>\n        );\n    }\n}\n","module.exports = __webpack_public_path__ + \"files/b96d9389dbf73d7c1584084920ee7c03.png\";","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class MenuIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.menu'\n                    defaultMessage='Menu Icon'\n                >\n                    {(title) => (\n                        <svg\n                            width='16px'\n                            height='10px'\n                            viewBox='0 0 16 10'\n                            version='1.1'\n                            role='img'\n                            title={title}\n                        >\n                            <g\n                                stroke='none'\n                                strokeWidth='1'\n                                fill='inherit'\n                                fillRule='evenodd'\n                            >\n                                <g\n                                    transform='translate(-188.000000, -38.000000)'\n                                    fillRule='nonzero'\n                                    fill='inherit'\n                                >\n                                    <g>\n                                        <g>\n                                            <g transform='translate(188.000000, 38.000000)'>\n                                                <path d='M15.5,0 C15.776,0 16,0.224 16,0.5 L16,1.5 C16,1.776 15.776,2 15.5,2 L0.5,2 C0.224,2 0,1.776 0,1.5 L0,0.5 C0,0.224 0.224,0 0.5,0 L15.5,0 Z M15.5,4 C15.776,4 16,4.224 16,4.5 L16,5.5 C16,5.776 15.776,6 15.5,6 L0.5,6 C0.224,6 0,5.776 0,5.5 L0,4.5 C0,4.224 0.224,4 0.5,4 L15.5,4 Z M15.5,8 C15.776,8 16,8.224 16,8.5 L16,9.5 C16,9.776 15.776,10 15.5,10 L0.5,10 C0.224,10 0,9.776 0,9.5 L0,8.5 C0,8.224 0.224,8 0.5,8 L15.5,8 Z'/>\n                                            </g>\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport Constants from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\n\nimport FileInfoPreview from 'components/file_info_preview';\n\nexport default class AudioVideoPreview extends React.PureComponent {\n    static propTypes = {\n\n        /**\n        * Compare file types\n        */\n        fileInfo: PropTypes.object.isRequired,\n\n        /**\n        *  URL of pdf file to output and compare to update props url\n        */\n        fileUrl: PropTypes.string.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            canPlay: true,\n        };\n    }\n\n    componentDidMount() {\n        this.handleFileInfoChanged(this.props.fileInfo);\n\n        if (this.refs.source) {\n            $(ReactDOM.findDOMNode(this.refs.source)).one('error', this.handleLoadError);\n        }\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.fileUrl !== prevProps.fileUrl) {\n            this.handleFileInfoChanged(this.props.fileInfo);\n        }\n\n        if (this.refs.source) {\n            $(ReactDOM.findDOMNode(this.refs.source)).one('error', this.handleLoadError);\n        }\n    }\n\n    handleFileInfoChanged = (fileInfo) => {\n        let video = ReactDOM.findDOMNode(this.refs.video);\n        if (!video) {\n            video = document.createElement('video');\n        }\n\n        const canPlayType = video.canPlayType(fileInfo.mime_type);\n\n        this.setState({\n            canPlay: canPlayType === 'probably' || canPlayType === 'maybe',\n        });\n    }\n\n    handleLoadError = () => {\n        this.setState({\n            canPlay: false,\n        });\n    }\n\n    stop = () => {\n        if (this.refs.video) {\n            const video = ReactDOM.findDOMNode(this.refs.video);\n            video.pause();\n            video.currentTime = 0;\n        }\n    }\n\n    render() {\n        if (!this.state.canPlay) {\n            return (\n                <FileInfoPreview\n                    fileInfo={this.props.fileInfo}\n                    fileUrl={this.props.fileUrl}\n                />\n            );\n        }\n\n        let width = Constants.WEB_VIDEO_WIDTH;\n        let height = Constants.WEB_VIDEO_HEIGHT;\n        if (Utils.isMobile()) {\n            width = Constants.MOBILE_VIDEO_WIDTH;\n            height = Constants.MOBILE_VIDEO_HEIGHT;\n        }\n\n        // add a key to the video to prevent React from using an old video source while a new one is loading\n        return (\n            <video\n                key={this.props.fileInfo.id}\n                ref='video'\n                data-setup='{}'\n                controls='controls'\n                width={width}\n                height={height}\n            >\n                <source\n                    ref='source'\n                    src={this.props.fileUrl}\n                />\n            </video>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport Constants from 'utils/constants.jsx';\nimport * as SyntaxHighlighting from 'utils/syntax_highlighting';\n\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\nimport FileInfoPreview from 'components/file_info_preview';\n\nexport default class CodePreview extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            code: '',\n            lang: '',\n            loading: true,\n            success: true,\n        };\n    }\n\n    componentDidMount() {\n        this.updateStateFromProps(this.props);\n    }\n\n    UNSAFE_componentWillReceiveProps(nextProps) { // eslint-disable-line camelcase\n        if (this.props.fileUrl !== nextProps.fileUrl) {\n            this.updateStateFromProps(nextProps);\n        }\n    }\n\n    updateStateFromProps = (props) => {\n        const usedLanguage = SyntaxHighlighting.getLanguageFromFileExtension(props.fileInfo.extension);\n\n        if (!usedLanguage || props.fileInfo.size > Constants.CODE_PREVIEW_MAX_FILE_SIZE) {\n            this.setState({code: '', lang: '', loading: false, success: false});\n            return;\n        }\n\n        this.setState({code: '', lang: usedLanguage, loading: true});\n\n        $.ajax({\n            async: true,\n            url: props.fileUrl,\n            type: 'GET',\n            dataType: 'text',\n            error: this.handleReceivedError,\n            success: this.handleReceivedCode,\n        });\n    }\n\n    handleReceivedCode = (data) => {\n        let code = data;\n        if (data.nodeName === '#document') {\n            code = new XMLSerializer().serializeToString(data);\n        }\n        this.setState({\n            code,\n            loading: false,\n            success: true,\n        });\n    }\n\n    handleReceivedError = () => {\n        this.setState({loading: false, success: false});\n    }\n\n    static supports(fileInfo) {\n        return Boolean(SyntaxHighlighting.getLanguageFromFileExtension(fileInfo.extension));\n    }\n\n    render() {\n        if (this.state.loading) {\n            return (\n                <div className='view-image__loading'>\n                    <LoadingSpinner/>\n                </div>\n            );\n        }\n\n        if (!this.state.success) {\n            return (\n                <FileInfoPreview\n                    fileInfo={this.props.fileInfo}\n                    fileUrl={this.props.fileUrl}\n                />\n            );\n        }\n\n        // add line numbers when viewing a code file preview\n        const lines = this.state.code.match(/\\r\\n|\\r|\\n|$/g).length;\n        let strlines = '';\n        for (let i = 1; i <= lines; i++) {\n            if (strlines) {\n                strlines += '\\n' + i;\n            } else {\n                strlines += i;\n            }\n        }\n\n        const language = SyntaxHighlighting.getLanguageName(this.state.lang);\n\n        const highlighted = SyntaxHighlighting.highlight(this.state.lang, this.state.code);\n\n        return (\n            <div className='post-code'>\n                <span className='post-code__language'>\n                    {`${this.props.fileInfo.name} - ${language}`}\n                </span>\n                <div className='post-code__container'>\n                    <code className='hljs'>\n                        <table>\n                            <tbody>\n                                <tr>\n                                    <td className='post-code__lineno'>{strlines}</td>\n                                    <td dangerouslySetInnerHTML={{__html: highlighted}}/>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </code>\n                </div>\n            </div>\n        );\n    }\n}\n\nCodePreview.propTypes = {\n    fileInfo: PropTypes.object.isRequired,\n    fileUrl: PropTypes.string.isRequired,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {getFilePreviewUrl, getFileDownloadUrl} from 'mattermost-redux/utils/file_utils';\n\nexport default function ImagePreview({fileInfo, canDownloadFiles}) {\n    const isExternalFile = !fileInfo.id;\n\n    let fileUrl;\n    let previewUrl;\n    if (isExternalFile) {\n        fileUrl = fileInfo.link;\n        previewUrl = fileInfo.link;\n    } else {\n        fileUrl = getFileDownloadUrl(fileInfo.id);\n        previewUrl = fileInfo.has_preview_image ? getFilePreviewUrl(fileInfo.id) : fileUrl;\n    }\n\n    if (!canDownloadFiles) {\n        return <img src={previewUrl}/>;\n    }\n\n    return (\n        <a\n            href={fileUrl}\n            target='_blank'\n            rel='noopener noreferrer'\n            download={!isExternalFile}\n        >\n            <img\n                data-testid='imagePreview'\n                alt={'preview url image'}\n                src={previewUrl}\n            />\n        </a>\n    );\n}\n\nImagePreview.propTypes = {\n    fileInfo: PropTypes.object.isRequired,\n    canDownloadFiles: PropTypes.bool.isRequired,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class PopoverBar extends React.PureComponent {\n    static propTypes = {\n        fileIndex: PropTypes.number.isRequired,\n        totalFiles: PropTypes.number.isRequired,\n        filename: PropTypes.string.isRequired,\n        fileURL: PropTypes.string.isRequired,\n        showPublicLink: PropTypes.bool,\n        enablePublicLink: PropTypes.bool.isRequired,\n        canDownloadFiles: PropTypes.bool.isRequired,\n        isExternalFile: PropTypes.bool.isRequired,\n        onGetPublicLink: PropTypes.func,\n    };\n\n    static defaultProps = {\n        fileIndex: 0,\n        totalFiles: 0,\n        filename: '',\n        fileURL: '',\n        showPublicLink: true,\n    };\n\n    render() {\n        var publicLink = '';\n        if (this.props.enablePublicLink && this.props.showPublicLink) {\n            publicLink = (\n                <div>\n                    <a\n                        href='#'\n                        className='public-link text'\n                        data-title='Public Image'\n                        onClick={this.props.onGetPublicLink}\n                    >\n                        <FormattedMessage\n                            id='view_image_popover.publicLink'\n                            defaultMessage='Get a public link'\n                        />\n                    </a>\n                    <span className='text'>{' | '}</span>\n                </div>\n            );\n        }\n\n        let downloadLinks = null;\n        if (this.props.canDownloadFiles) {\n            let downloadLinkText;\n            const downloadLinkProps = {};\n            if (this.props.isExternalFile) {\n                downloadLinkText = (\n                    <FormattedMessage\n                        id='view_image_popover.open'\n                        defaultMessage='Open'\n                    />\n                );\n            } else {\n                downloadLinkText = (\n                    <FormattedMessage\n                        id='view_image_popover.download'\n                        defaultMessage='Download'\n                    />\n                );\n\n                downloadLinkProps.download = this.props.filename;\n            }\n\n            downloadLinks = (\n                <div className='image-links'>\n                    {publicLink}\n                    <a\n                        href={this.props.fileURL}\n                        className='text'\n                        target='_blank'\n                        rel='noopener noreferrer'\n                        {...downloadLinkProps}\n                    >\n                        {downloadLinkText}\n                    </a>\n                </div>\n            );\n        }\n\n        return (\n            <div\n                data-testid='fileCountFooter'\n                ref='imageFooter'\n                className='modal-button-bar'\n            >\n                <span className='pull-left text'>\n                    <FormattedMessage\n                        id='view_image_popover.file'\n                        defaultMessage='File {count, number} of {total, number}'\n                        values={{\n                            count: (this.props.fileIndex + 1),\n                            total: this.props.totalFiles,\n                        }}\n                    />\n                </span>\n                {downloadLinks}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PopoverBar from './popover_bar.jsx';\n\nexport default PopoverBar;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {getFilePreviewUrl, getFileUrl, getFileDownloadUrl} from 'mattermost-redux/utils/file_utils';\n\nimport * as GlobalActions from 'actions/global_actions';\nimport Constants, {FileTypes} from 'utils/constants';\nimport * as Utils from 'utils/utils';\nimport AudioVideoPreview from 'components/audio_video_preview';\nimport CodePreview from 'components/code_preview';\nimport FileInfoPreview from 'components/file_info_preview';\nimport LoadingImagePreview from 'components/loading_image_preview';\nconst PDFPreview = React.lazy(() => import('components/pdf_preview'));\n\nimport ImagePreview from './image_preview';\nimport PopoverBar from './popover_bar';\n\nconst KeyCodes = Constants.KeyCodes;\n\nexport default class ViewImageModal extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * The post the files are attached to\n         */\n        post: PropTypes.object.isRequired,\n\n        /**\n         * Set whether to show this modal or not\n         */\n        show: PropTypes.bool.isRequired,\n\n        /**\n         * Function to call when this modal is dismissed\n         **/\n        onModalDismissed: PropTypes.func.isRequired,\n\n        /**\n         * List of FileInfo to view\n         **/\n        fileInfos: PropTypes.arrayOf(PropTypes.object).isRequired,\n\n        /**\n         * The index number of starting image\n         **/\n        startIndex: PropTypes.number.isRequired,\n\n        canDownloadFiles: PropTypes.bool.isRequired,\n        enablePublicLink: PropTypes.bool.isRequired,\n        pluginFilePreviewComponents: PropTypes.arrayOf(PropTypes.object),\n    };\n\n    static defaultProps = {\n        show: false,\n        fileInfos: [],\n        startIndex: 0,\n        pluginFilePreviewComponents: [],\n        post: {}, // Needed to avoid proptypes console errors for cases like channel header, which doesn't have a proper value\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            imageIndex: this.props.startIndex,\n            imageHeight: '100%',\n            loaded: Utils.fillArray(false, this.props.fileInfos.length),\n            progress: Utils.fillArray(0, this.props.fileInfos.length),\n            showCloseBtn: false,\n        };\n    }\n\n    handleNext = (e) => {\n        if (e) {\n            e.stopPropagation();\n        }\n        let id = this.state.imageIndex + 1;\n        if (id > this.props.fileInfos.length - 1) {\n            id = 0;\n        }\n        this.showImage(id);\n    }\n\n    handlePrev = (e) => {\n        if (e) {\n            e.stopPropagation();\n        }\n        let id = this.state.imageIndex - 1;\n        if (id < 0) {\n            id = this.props.fileInfos.length - 1;\n        }\n        this.showImage(id);\n    }\n\n    handleKeyPress = (e) => {\n        if (Utils.isKeyPressed(e, KeyCodes.RIGHT)) {\n            this.handleNext();\n        } else if (Utils.isKeyPressed(e, KeyCodes.LEFT)) {\n            this.handlePrev();\n        }\n    }\n\n    onModalShown = (nextProps) => {\n        document.addEventListener('keyup', this.handleKeyPress);\n\n        this.showImage(nextProps.startIndex);\n    }\n\n    onModalHidden = () => {\n        document.addEventListener('keyup', this.handleKeyPress);\n\n        if (this.refs.video) {\n            this.refs.video.stop();\n        }\n    }\n\n    UNSAFE_componentWillReceiveProps(nextProps) { // eslint-disable-line camelcase\n        if (nextProps.show === true && this.props.show === false) {\n            this.onModalShown(nextProps);\n        } else if (nextProps.show === false && this.props.show === true) {\n            this.onModalHidden();\n        }\n\n        if (this.props.fileInfos.length !== nextProps.fileInfos.length) {\n            this.setState({\n                loaded: Utils.fillArray(false, nextProps.fileInfos.length),\n                progress: Utils.fillArray(0, nextProps.fileInfos.length),\n            });\n        }\n    }\n\n    showImage = (id) => {\n        this.setState({imageIndex: id});\n\n        const imageHeight = window.innerHeight - 100;\n        this.setState({imageHeight});\n\n        if (!this.state.loaded[id]) {\n            this.loadImage(id);\n        }\n    }\n\n    loadImage = (index) => {\n        const fileInfo = this.props.fileInfos[index];\n        const fileType = Utils.getFileType(fileInfo.extension);\n\n        if (fileType === FileTypes.IMAGE && Boolean(fileInfo.id)) {\n            let previewUrl;\n            if (fileInfo.has_image_preview) {\n                previewUrl = getFilePreviewUrl(fileInfo.id);\n            } else {\n                // some images (eg animated gifs) just show the file itself and not a preview\n                previewUrl = getFileUrl(fileInfo.id);\n            }\n\n            Utils.loadImage(\n                previewUrl,\n                () => this.handleImageLoaded(index),\n                (completedPercentage) => this.handleImageProgress(index, completedPercentage)\n            );\n        } else {\n            // there's nothing to load for non-image files\n            this.handleImageLoaded(index);\n        }\n    }\n\n    handleImageLoaded = (index) => {\n        this.setState((prevState) => {\n            return {\n                loaded: {\n                    ...prevState.loaded,\n                    [index]: true,\n                },\n            };\n        });\n    }\n\n    handleImageProgress = (index, completedPercentage) => {\n        this.setState((prevState) => {\n            return {\n                progress: {\n                    ...prevState.progress,\n                    [index]: completedPercentage,\n                },\n            };\n        });\n    }\n\n    handleGetPublicLink = () => {\n        this.props.onModalDismissed();\n\n        GlobalActions.showGetPublicLinkModal(this.props.fileInfos[this.state.imageIndex].id);\n    }\n\n    onMouseEnterImage = () => {\n        this.setState({showCloseBtn: true});\n    }\n\n    onMouseLeaveImage = () => {\n        this.setState({showCloseBtn: false});\n    }\n\n    render() {\n        if (this.props.fileInfos.length < 1 || this.props.fileInfos.length - 1 < this.state.imageIndex) {\n            return null;\n        }\n\n        const fileInfo = this.props.fileInfos[this.state.imageIndex];\n        const showPublicLink = !fileInfo.link;\n        const fileName = fileInfo.link || fileInfo.name;\n        const fileUrl = fileInfo.link || getFileUrl(fileInfo.id);\n        const fileDownloadUrl = fileInfo.link || getFileDownloadUrl(fileInfo.id);\n        const isExternalFile = !fileInfo.id;\n        let dialogClassName = 'a11y__modal modal-image';\n\n        let content;\n        if (this.state.loaded[this.state.imageIndex]) {\n            const fileType = Utils.getFileType(fileInfo.extension);\n\n            if (fileType === FileTypes.IMAGE || fileType === FileTypes.SVG) {\n                content = (\n                    <ImagePreview\n                        fileInfo={fileInfo}\n                        canDownloadFiles={this.props.canDownloadFiles}\n                    />\n                );\n            } else if (fileType === FileTypes.VIDEO || fileType === FileTypes.AUDIO) {\n                content = (\n                    <AudioVideoPreview\n                        fileInfo={fileInfo}\n                        fileUrl={fileUrl}\n                    />\n                );\n            } else if (fileInfo && fileInfo.extension && fileInfo.extension === FileTypes.PDF) {\n                content = (\n                    <React.Suspense fallback={null}>\n                        <PDFPreview\n                            fileInfo={fileInfo}\n                            fileUrl={fileUrl}\n                        />\n                    </React.Suspense>\n                );\n            } else if (CodePreview.supports(fileInfo)) {\n                dialogClassName += ' modal-code';\n                content = (\n                    <CodePreview\n                        fileInfo={fileInfo}\n                        fileUrl={fileUrl}\n                    />\n                );\n            } else {\n                content = (\n                    <FileInfoPreview\n                        fileInfo={fileInfo}\n                        fileUrl={fileUrl}\n                    />\n                );\n            }\n        } else {\n            // display a progress indicator when the preview for an image is still loading\n            const loading = Utils.localizeMessage('view_image.loading', 'Loading');\n            const progress = Math.floor(this.state.progress[this.state.imageIndex]);\n\n            content = (\n                <LoadingImagePreview\n                    loading={loading}\n                    progress={progress}\n                />\n            );\n        }\n\n        for (const preview of this.props.pluginFilePreviewComponents) {\n            if (preview.override(fileInfo, this.props.post)) {\n                content = (\n                    <preview.component\n                        fileInfo={fileInfo}\n                        post={this.props.post}\n                    />\n                );\n                break;\n            }\n        }\n\n        let leftArrow = null;\n        let rightArrow = null;\n        if (this.props.fileInfos.length > 1) {\n            leftArrow = (\n                <a\n                    id='previewArrowLeft'\n                    ref='previewArrowLeft'\n                    className='modal-prev-bar'\n                    href='#'\n                    onClick={this.handlePrev}\n                >\n                    <i className='image-control image-prev'/>\n                </a>\n            );\n\n            rightArrow = (\n                <a\n                    id='previewArrowRight'\n                    ref='previewArrowRight'\n                    className='modal-next-bar'\n                    href='#'\n                    onClick={this.handleNext}\n                >\n                    <i className='image-control image-next'/>\n                </a>\n            );\n        }\n\n        let closeButtonClass = 'modal-close';\n        if (this.state.showCloseBtn) {\n            closeButtonClass += ' modal-close--show';\n        }\n\n        return (\n            <Modal\n                show={this.props.show}\n                onHide={this.props.onModalDismissed}\n                className='modal-image'\n                dialogClassName={dialogClassName}\n                role='dialog'\n                aria-labelledby='viewImageModalLabel'\n            >\n                <Modal.Body>\n                    <div\n                        className={'modal-image__wrapper'}\n                        onClick={this.props.onModalDismissed}\n                    >\n                        <div\n                            onMouseEnter={this.onMouseEnterImage}\n                            onMouseLeave={this.onMouseLeaveImage}\n                            onClick={(e) => e.stopPropagation()}\n                        >\n                            <Modal.Title\n                                componentClass='h1'\n                                id='viewImageModalLabel'\n                                className='hide'\n                            >\n                                {fileName}\n                            </Modal.Title>\n                            <div\n                                className={closeButtonClass}\n                                onClick={this.props.onModalDismissed}\n                            />\n                            <div className='modal-image__content'>\n                                {content}\n                            </div>\n                            <PopoverBar\n                                showPublicLink={showPublicLink}\n                                fileIndex={this.state.imageIndex}\n                                totalFiles={this.props.fileInfos.length}\n                                filename={fileName}\n                                fileURL={fileDownloadUrl}\n                                enablePublicLink={this.props.enablePublicLink}\n                                canDownloadFiles={this.props.canDownloadFiles}\n                                isExternalFile={isExternalFile}\n                                onGetPublicLink={this.handleGetPublicLink}\n                            />\n                        </div>\n                    </div>\n                    {leftArrow}\n                    {rightArrow}\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getPost} from 'mattermost-redux/selectors/entities/posts';\n\nimport {canDownloadFiles} from 'utils/file_utils.jsx';\n\nimport ViewImage from './view_image.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    const config = getConfig(state);\n\n    return {\n        canDownloadFiles: canDownloadFiles(config),\n        enablePublicLink: config.EnablePublicLink === 'true',\n        pluginFilePreviewComponents: state.plugins.components.FilePreview,\n        post: ownProps.post || getPost(state, ownProps.postId),\n    };\n}\n\nexport default connect(mapStateToProps)(ViewImage);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {injectIntl} from 'react-intl';\n\nimport {intlShape} from 'utils/react_intl';\n\nclass ModalToggleButtonRedux extends React.Component {\n    static propTypes = {\n        accessibilityLabel: PropTypes.string,\n        children: PropTypes.node.isRequired,\n        modalId: PropTypes.string.isRequired,\n        dialogType: PropTypes.func.isRequired,\n        dialogProps: PropTypes.object,\n        intl: intlShape.isRequired,\n        onClick: PropTypes.func,\n        className: PropTypes.string,\n        actions: PropTypes.shape({\n            openModal: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    static defaultProps = {\n        dialogProps: {},\n        className: '',\n    };\n\n    show(e) {\n        if (e) {\n            e.preventDefault();\n        }\n\n        const {modalId, dialogProps, dialogType} = this.props;\n\n        const modalData = {\n            modalId,\n            dialogProps,\n            dialogType,\n        };\n\n        this.props.actions.openModal(modalData);\n    }\n\n    render() {\n        const {children, onClick, ...props} = this.props;\n        const {formatMessage} = this.props.intl;\n        const ariaLabel = formatMessage({id: 'accessibility.button.dialog', defaultMessage: '{dialogName} dialog'}, {dialogName: props.accessibilityLabel});\n\n        // removing these three props since they are not valid props on buttons\n        delete props.modalId;\n        delete props.dialogType;\n        delete props.dialogProps;\n        delete props.accessibilityLabel;\n\n        // allow callers to provide an onClick which will be called before the modal is shown\n        let clickHandler = () => this.show();\n        if (onClick) {\n            clickHandler = (e) => {\n                onClick();\n\n                this.show(e);\n            };\n        }\n\n        return (\n            <button\n                {...props}\n                className={'style--none ' + props.className}\n                data-toggle='modal toggle'\n                aria-label={ariaLabel}\n                onClick={clickHandler}\n            >\n                {children}\n            </button>\n        );\n    }\n}\n\nexport default injectIntl(ModalToggleButtonRedux);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {openModal} from 'actions/views/modals';\n\nimport ModalToggleButtonRedux from './toggle_modal_button_redux.jsx';\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            openModal,\n        }, dispatch),\n    };\n}\n\nexport default connect(null, mapDispatchToProps)(ModalToggleButtonRedux);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport * as Utils from 'utils/utils.jsx';\n\ntype Props = {\n    fileInfo: {\n        name: string;\n        extension: string;\n        size: number;\n    };\n    fileUrl: string;\n    canDownloadFiles: boolean;\n};\n\nexport default class FileInfoPreview extends React.PureComponent<Props> {\n    render() {\n        const fileInfo = this.props.fileInfo;\n        const fileUrl = this.props.fileUrl;\n\n        // non-image files include a section providing details about the file\n        const infoParts = [];\n\n        if (fileInfo.extension !== '') {\n            infoParts.push(Utils.localizeMessage('file_info_preview.type', 'File type ') + fileInfo.extension.toUpperCase());\n        }\n\n        if (fileInfo.size) {\n            infoParts.push(Utils.localizeMessage('file_info_preview.size', 'Size ') + Utils.fileSizeToString(fileInfo.size));\n        }\n\n        const infoString = infoParts.join(', ');\n\n        let preview = null;\n        if (this.props.canDownloadFiles) {\n            preview = (\n                <a\n                    className='file-details__preview'\n                    href={fileUrl}\n                    target='_blank'\n                    rel='noopener noreferrer'\n                >\n                    <span className='file-details__preview-helper'/>\n                    <img\n                        alt={'file preview'}\n                        src={Utils.getFileIconPath(fileInfo)}\n                    />\n                </a>\n            );\n        } else {\n            preview = (\n                <span className='file-details__preview'>\n                    <span className='file-details__preview-helper'/>\n                    <img\n                        alt={'file preview'}\n                        src={Utils.getFileIconPath(fileInfo)}\n                    />\n                </span>\n            );\n        }\n\n        return (\n            <div className='file-details__container'>\n                {preview}\n                <div className='file-details'>\n                    <div className='file-details__name'>{fileInfo.name}</div>\n                    <div className='file-details__info'>{infoString}</div>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport {GlobalState} from 'types/store';\n\nimport {canDownloadFiles} from 'utils/file_utils.jsx';\n\nimport FileInfoPreview from './file_info_preview';\n\nfunction mapStateToProps(state: GlobalState) {\n    const config = getConfig(state);\n\n    return {\n        canDownloadFiles: canDownloadFiles(config),\n    };\n}\n\nexport default connect(mapStateToProps)(FileInfoPreview);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport {Groups} from 'mattermost-redux/constants';\n\nimport Constants from 'utils/constants';\nimport {localizeMessage} from 'utils/utils.jsx';\n\nimport MultiSelect from 'components/multiselect/multiselect';\nimport groupsAvatar from 'images/groups-avatar.png';\nimport AddIcon from 'components/widgets/icons/fa_add_icon';\n\nconst GROUPS_PER_PAGE = 50;\nconst MAX_SELECTABLE_VALUES = 10;\n\nexport default class AddGroupsToChannelModal extends React.Component {\n    static propTypes = {\n        currentChannelName: PropTypes.string.isRequired,\n        currentChannelId: PropTypes.string.isRequired,\n        searchTerm: PropTypes.string.isRequired,\n        groups: PropTypes.array.isRequired,\n\n        // used in tandem with 'skipCommit' to allow using this component without performing actual linking\n        excludeGroups: PropTypes.arrayOf(PropTypes.object),\n        includeGroups: PropTypes.arrayOf(PropTypes.object),\n        onHide: PropTypes.func,\n        skipCommit: PropTypes.bool,\n        onAddCallback: PropTypes.func,\n        actions: PropTypes.shape({\n            getGroupsNotAssociatedToChannel: PropTypes.func.isRequired,\n            setModalSearchTerm: PropTypes.func.isRequired,\n            linkGroupSyncable: PropTypes.func.isRequired,\n            getAllGroupsAssociatedToChannel: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.searchTimeoutId = 0;\n\n        this.state = {\n            values: [],\n            show: true,\n            search: false,\n            saving: false,\n            addError: null,\n            loadingGroups: true,\n        };\n    }\n\n    componentDidMount() {\n        Promise.all([\n            this.props.actions.getGroupsNotAssociatedToChannel(this.props.currentChannelId, '', 0, GROUPS_PER_PAGE + 1),\n            this.props.actions.getAllGroupsAssociatedToChannel(this.props.currentChannelId),\n        ]).then(() => {\n            this.setGroupsLoadingState(false);\n        });\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.searchTerm !== prevProps.searchTerm) {\n            clearTimeout(this.searchTimeoutId);\n\n            const searchTerm = this.props.searchTerm;\n            if (searchTerm === '') {\n                return;\n            }\n\n            this.searchTimeoutId = setTimeout(\n                async () => {\n                    this.setGroupsLoadingState(true);\n                    await this.props.actions.getGroupsNotAssociatedToChannel(this.props.currentChannelId, searchTerm);\n                    this.setGroupsLoadingState(false);\n                },\n                Constants.SEARCH_TIMEOUT_MILLISECONDS\n            );\n        }\n    }\n\n    handleHide = () => {\n        this.props.actions.setModalSearchTerm('');\n        this.setState({show: false});\n    }\n\n    handleExit = () => {\n        if (this.props.onHide) {\n            this.props.onHide();\n        }\n    }\n\n    handleResponse = (err) => {\n        let addError = null;\n        if (err && err.message) {\n            addError = err.message;\n        }\n\n        this.setState({\n            saving: false,\n            addError,\n        });\n    }\n\n    handleSubmit = async (e) => {\n        if (e) {\n            e.preventDefault();\n        }\n\n        const groupIDs = this.state.values.map((v) => v.id);\n        if (groupIDs.length === 0) {\n            return;\n        }\n\n        if (this.props.skipCommit) {\n            if (this.props.onAddCallback) {\n                this.props.onAddCallback(groupIDs);\n            }\n            this.handleHide();\n            return;\n        }\n\n        this.setState({saving: true});\n\n        groupIDs.forEach(async (groupID) => {\n            const {error} = await this.props.actions.linkGroupSyncable(groupID, this.props.currentChannelId, Groups.SYNCABLE_TYPE_CHANNEL, {auto_add: true});\n            this.handleResponse(error);\n            if (!error) {\n                this.handleHide();\n            }\n        });\n    }\n\n    addValue = (value) => {\n        const values = Object.assign([], this.state.values);\n        const userIds = values.map((v) => v.id);\n        if (value && value.id && userIds.indexOf(value.id) === -1) {\n            values.push(value);\n        }\n\n        this.setState({values});\n    }\n\n    setGroupsLoadingState = (loadingState) => {\n        this.setState({\n            loadingGroups: loadingState,\n        });\n    }\n\n    handlePageChange = (page, prevPage) => {\n        if (page > prevPage) {\n            this.setGroupsLoadingState(true);\n            this.props.actions.getGroupsNotAssociatedToChannel(this.props.currentChannelId, this.props.searchTerm, page, GROUPS_PER_PAGE + 1).then(() => {\n                this.setGroupsLoadingState(false);\n            });\n        }\n    }\n\n    handleDelete = (values) => {\n        this.setState({values});\n    }\n\n    search = (term) => {\n        this.props.actions.setModalSearchTerm(term);\n    }\n\n    renderOption(option, isSelected, onAdd, onMouseMove) {\n        const rowSelected = isSelected ? 'more-modal__row--selected' : '';\n\n        return (\n            <div\n                key={option.id}\n                ref={isSelected ? 'selected' : option.id}\n                className={'more-modal__row clickable ' + rowSelected}\n                onClick={() => onAdd(option)}\n                onMouseMove={() => onMouseMove(option)}\n            >\n                <img\n                    className='more-modal__image'\n                    src={groupsAvatar}\n                    alt='group picture'\n                    width='32'\n                    height='32'\n                />\n                <div\n                    className='more-modal__details'\n                >\n                    <div className='more-modal__name'>\n                        {option.display_name}&nbsp;{'-'}&nbsp;<span className='more-modal__name_sub'>\n                            <FormattedMessage\n                                id='numMembers'\n                                defaultMessage='{num, number} {num, plural, one {member} other {members}}'\n                                values={{\n                                    num: option.member_count,\n                                }}\n                            />\n                        </span>\n                    </div>\n                </div>\n                <div className='more-modal__actions'>\n                    <div className='more-modal__actions--round'>\n                        <AddIcon/>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    renderValue(props) {\n        return props.data.display_name;\n    }\n\n    render() {\n        const numRemainingText = (\n            <div id='numGroupsRemaining'>\n                <FormattedMessage\n                    id='multiselect.numGroupsRemaining'\n                    defaultMessage='Use  to browse,  to select. You can add {num, number} more {num, plural, one {group} other {groups}}. '\n                    values={{\n                        num: MAX_SELECTABLE_VALUES - this.state.values.length,\n                    }}\n                />\n            </div>\n        );\n\n        const buttonSubmitText = localizeMessage('multiselect.add', 'Add');\n        const buttonSubmitLoadingText = localizeMessage('multiselect.adding', 'Adding...');\n\n        let addError = null;\n        if (this.state.addError) {\n            addError = (<div className='has-error col-sm-12'><label className='control-label font-weight--normal'>{this.state.addError}</label></div>);\n        }\n        let groupsToShow = this.props.groups;\n        if (this.props.excludeGroups) {\n            const hasGroup = (og) => !this.props.excludeGroups.find((g) => g.id === og.id);\n            groupsToShow = groupsToShow.filter(hasGroup);\n        }\n        if (this.props.includeGroups) {\n            const hasGroup = (og) => this.props.includeGroups.find((g) => g.id === og.id);\n            groupsToShow = [...groupsToShow, ...this.props.includeGroups.filter(hasGroup)];\n        }\n        groupsToShow = groupsToShow.map((group) => {\n            return {label: group.display_name, value: group.id, ...group};\n        });\n\n        return (\n            <Modal\n                id='addGroupsToChannelModal'\n                dialogClassName={'a11y__modal more-modal more-direct-channels'}\n                show={this.state.show}\n                onHide={this.handleHide}\n                onExited={this.handleExit}\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title>\n                        <FormattedMessage\n                            id='add_groups_to_channel.title'\n                            defaultMessage='Add New Groups to {channelName} Channel'\n                            values={{\n                                channelName: (\n                                    <strong>{this.props.currentChannelName}</strong>\n                                ),\n                            }}\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    {addError}\n                    <MultiSelect\n                        key='addGroupsToChannelKey'\n                        options={groupsToShow}\n                        optionRenderer={this.renderOption}\n                        values={this.state.values}\n                        valueRenderer={this.renderValue}\n                        perPage={GROUPS_PER_PAGE}\n                        handlePageChange={this.handlePageChange}\n                        handleInput={this.search}\n                        handleDelete={this.handleDelete}\n                        handleAdd={this.addValue}\n                        handleSubmit={this.handleSubmit}\n                        maxValues={MAX_SELECTABLE_VALUES}\n                        numRemainingText={numRemainingText}\n                        buttonSubmitText={buttonSubmitText}\n                        buttonSubmitLoadingText={buttonSubmitLoadingText}\n                        saving={this.state.saving}\n                        loading={this.state.loadingGroups}\n                        placeholderText={localizeMessage('multiselect.addGroupsPlaceholder', 'Search and add groups')}\n                    />\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {getGroupsNotAssociatedToChannel, linkGroupSyncable, getAllGroupsAssociatedToChannel} from 'mattermost-redux/actions/groups';\nimport {getGroupsNotAssociatedToChannel as selectGroupsNotAssociatedToChannel} from 'mattermost-redux/selectors/entities/groups';\nimport {getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\n\nimport {setModalSearchTerm} from 'actions/views/search';\n\nimport AddGroupsToChannelModal from './add_groups_to_channel_modal';\n\nfunction mapStateToProps(state, ownProps) {\n    const searchTerm = state.views.search.modalSearch;\n\n    const channel = ownProps.channel || getCurrentChannel(state) || {};\n\n    let groups = selectGroupsNotAssociatedToChannel(state, channel.id);\n    if (searchTerm) {\n        const regex = RegExp(searchTerm, 'i');\n        groups = groups.filter((group) => regex.test(group.display_name) || regex.test(group.name));\n    }\n\n    return {\n        currentChannelName: channel.display_name,\n        currentChannelId: channel.id,\n        skipCommit: ownProps.skipCommit,\n        onAddCallback: ownProps.onAddCallback,\n        excludeGroups: ownProps.excludeGroups,\n        searchTerm,\n        groups,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            getGroupsNotAssociatedToChannel,\n            setModalSearchTerm,\n            linkGroupSyncable,\n            getAllGroupsAssociatedToChannel,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AddGroupsToChannelModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport {Groups} from 'mattermost-redux/constants';\n\nimport Constants from 'utils/constants';\nimport {localizeMessage} from 'utils/utils.jsx';\n\nimport MultiSelect from 'components/multiselect/multiselect';\nimport groupsAvatar from 'images/groups-avatar.png';\nimport AddIcon from 'components/widgets/icons/fa_add_icon';\n\nconst GROUPS_PER_PAGE = 50;\nconst MAX_SELECTABLE_VALUES = 10;\n\nexport default class AddGroupsToTeamModal extends React.Component {\n    static propTypes = {\n        currentTeamName: PropTypes.string.isRequired,\n        currentTeamId: PropTypes.string.isRequired,\n        searchTerm: PropTypes.string.isRequired,\n        groups: PropTypes.array.isRequired,\n\n        // used in tandem with 'skipCommit' to allow using this component without performing actual linking\n        excludeGroups: PropTypes.arrayOf(PropTypes.object),\n        includeGroups: PropTypes.arrayOf(PropTypes.object),\n        onHide: PropTypes.func,\n        skipCommit: PropTypes.bool,\n        onAddCallback: PropTypes.func,\n        actions: PropTypes.shape({\n            getGroupsNotAssociatedToTeam: PropTypes.func.isRequired,\n            setModalSearchTerm: PropTypes.func.isRequired,\n            linkGroupSyncable: PropTypes.func.isRequired,\n            getAllGroupsAssociatedToTeam: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.searchTimeoutId = 0;\n\n        this.state = {\n            values: [],\n            show: true,\n            search: false,\n            saving: false,\n            addError: null,\n            loadingGroups: true,\n        };\n    }\n\n    componentDidMount() {\n        Promise.all([\n            this.props.actions.getGroupsNotAssociatedToTeam(this.props.currentTeamId, '', 0, GROUPS_PER_PAGE + 1),\n            this.props.actions.getAllGroupsAssociatedToTeam(this.props.currentTeamId),\n        ]).then(() => {\n            this.setGroupsLoadingState(false);\n        });\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.searchTerm !== prevProps.searchTerm) {\n            clearTimeout(this.searchTimeoutId);\n\n            const searchTerm = this.props.searchTerm;\n            if (searchTerm === '') {\n                return;\n            }\n\n            this.searchTimeoutId = setTimeout(\n                async () => {\n                    this.setGroupsLoadingState(true);\n                    await this.props.actions.getGroupsNotAssociatedToTeam(this.props.currentTeamId, searchTerm);\n                    this.setGroupsLoadingState(false);\n                },\n                Constants.SEARCH_TIMEOUT_MILLISECONDS\n            );\n        }\n    }\n\n    handleHide = () => {\n        this.props.actions.setModalSearchTerm('');\n        this.setState({show: false});\n    }\n\n    handleExit = () => {\n        if (this.props.onHide) {\n            this.props.onHide();\n        }\n    }\n\n    handleResponse = (err) => {\n        let addError = null;\n        if (err && err.message) {\n            addError = err.message;\n        }\n\n        this.setState({\n            saving: false,\n            addError,\n        });\n    }\n\n    handleSubmit = async (e) => {\n        if (e) {\n            e.preventDefault();\n        }\n\n        const groupIDs = this.state.values.map((v) => v.id);\n        if (groupIDs.length === 0) {\n            return;\n        }\n        if (this.props.skipCommit) {\n            if (this.props.onAddCallback) {\n                this.props.onAddCallback(groupIDs);\n            }\n            this.handleHide();\n            return;\n        }\n\n        this.setState({saving: true});\n\n        groupIDs.forEach(async (groupID) => {\n            const {error} = await this.props.actions.linkGroupSyncable(groupID, this.props.currentTeamId, Groups.SYNCABLE_TYPE_TEAM, {auto_add: true});\n            this.handleResponse(error);\n            if (!error) {\n                this.handleHide();\n            }\n        });\n    }\n\n    addValue = (value) => {\n        const values = Object.assign([], this.state.values);\n        const userIds = values.map((v) => v.id);\n        if (value && value.id && userIds.indexOf(value.id) === -1) {\n            values.push(value);\n        }\n\n        this.setState({values});\n    }\n\n    setGroupsLoadingState = (loadingState) => {\n        this.setState({\n            loadingGroups: loadingState,\n        });\n    }\n\n    handlePageChange = (page, prevPage) => {\n        if (page > prevPage) {\n            this.setGroupsLoadingState(true);\n            this.props.actions.getGroupsNotAssociatedToTeam(this.props.currentTeamId, this.props.searchTerm, page, GROUPS_PER_PAGE + 1).then(() => {\n                this.setGroupsLoadingState(false);\n            });\n        }\n    }\n\n    handleDelete = (values) => {\n        this.setState({values});\n    }\n\n    search = (term) => {\n        this.props.actions.setModalSearchTerm(term);\n    }\n\n    renderOption(option, isSelected, onAdd, onMouseMove) {\n        const rowSelected = isSelected ? 'more-modal__row--selected' : '';\n\n        return (\n            <div\n                key={option.id}\n                ref={isSelected ? 'selected' : option.id}\n                className={'more-modal__row clickable ' + rowSelected}\n                onClick={() => onAdd(option)}\n                onMouseMove={() => onMouseMove(option)}\n            >\n                <img\n                    className='more-modal__image'\n                    src={groupsAvatar}\n                    alt='group picture'\n                    width='32'\n                    height='32'\n                />\n                <div\n                    className='more-modal__details'\n                >\n                    <div className='more-modal__name'>\n                        {option.display_name}&nbsp;{'-'}&nbsp;<span className='more-modal__name_sub'>\n                            <FormattedMessage\n                                id='numMembers'\n                                defaultMessage='{num, number} {num, plural, one {member} other {members}}'\n                                values={{\n                                    num: option.member_count,\n                                }}\n                            />\n                        </span>\n                    </div>\n                </div>\n                <div className='more-modal__actions'>\n                    <div className='more-modal__actions--round'>\n                        <AddIcon/>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    renderValue(props) {\n        return props.data.display_name;\n    }\n\n    render() {\n        const numRemainingText = (\n            <div id='numGroupsRemaining'>\n                <FormattedMessage\n                    id='multiselect.numGroupsRemaining'\n                    defaultMessage='Use  to browse,  to select. You can add {num, number} more {num, plural, one {group} other {groups}}. '\n                    values={{\n                        num: MAX_SELECTABLE_VALUES - this.state.values.length,\n                    }}\n                />\n            </div>\n        );\n\n        const buttonSubmitText = localizeMessage('multiselect.add', 'Add');\n        const buttonSubmitLoadingText = localizeMessage('multiselect.adding', 'Adding...');\n\n        let addError = null;\n        if (this.state.addError) {\n            addError = (<div className='has-error col-sm-12'><label className='control-label font-weight--normal'>{this.state.addError}</label></div>);\n        }\n\n        let groupsToShow = this.props.groups;\n        if (this.props.excludeGroups) {\n            const hasGroup = (og) => !this.props.excludeGroups.find((g) => g.id === og.id);\n            groupsToShow = groupsToShow.filter(hasGroup);\n        }\n        if (this.props.includeGroups) {\n            const hasGroup = (og) => this.props.includeGroups.find((g) => g.id === og.id);\n            groupsToShow = [...groupsToShow, ...this.props.includeGroups.filter(hasGroup)];\n        }\n\n        groupsToShow = groupsToShow.map((group) => {\n            return {label: group.display_name, value: group.id, ...group};\n        });\n\n        return (\n            <Modal\n                id='addGroupsToTeamModal'\n                dialogClassName={'a11y__modal more-modal more-direct-channels'}\n                show={this.state.show}\n                onHide={this.handleHide}\n                onExited={this.handleExit}\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title componentClass='h1'>\n                        <FormattedMessage\n                            id='add_groups_to_team.title'\n                            defaultMessage='Add New Groups to {teamName} Team'\n                            values={{\n                                teamName: (\n                                    <strong>{this.props.currentTeamName}</strong>\n                                ),\n                            }}\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    {addError}\n                    <MultiSelect\n                        key='addGroupsToTeamKey'\n                        options={groupsToShow}\n                        optionRenderer={this.renderOption}\n                        values={this.state.values}\n                        valueRenderer={this.renderValue}\n                        perPage={GROUPS_PER_PAGE}\n                        handlePageChange={this.handlePageChange}\n                        handleInput={this.search}\n                        handleDelete={this.handleDelete}\n                        handleAdd={this.addValue}\n                        handleSubmit={this.handleSubmit}\n                        maxValues={MAX_SELECTABLE_VALUES}\n                        numRemainingText={numRemainingText}\n                        buttonSubmitText={buttonSubmitText}\n                        buttonSubmitLoadingText={buttonSubmitLoadingText}\n                        saving={this.state.saving}\n                        loading={this.state.loadingGroups}\n                        placeholderText={localizeMessage('multiselect.addGroupsPlaceholder', 'Search and add groups')}\n                    />\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {getGroupsNotAssociatedToTeam, linkGroupSyncable, getAllGroupsAssociatedToTeam} from 'mattermost-redux/actions/groups';\nimport {getGroupsNotAssociatedToTeam as selectGroupsNotAssociatedToTeam} from 'mattermost-redux/selectors/entities/groups';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\n\nimport {setModalSearchTerm} from 'actions/views/search';\n\nimport AddGroupsToTeamModal from './add_groups_to_team_modal';\n\nfunction mapStateToProps(state, ownProps) {\n    const searchTerm = state.views.search.modalSearch;\n\n    const team = ownProps.team || getCurrentTeam(state) || {};\n\n    let groups = selectGroupsNotAssociatedToTeam(state, team.id);\n    if (searchTerm) {\n        const regex = RegExp(searchTerm, 'i');\n        groups = groups.filter((group) => regex.test(group.display_name) || regex.test(group.name));\n    }\n\n    return {\n        currentTeamName: team.display_name,\n        currentTeamId: team.id,\n        skipCommit: ownProps.skipCommit,\n        onAddCallback: ownProps.onAddCallback,\n        excludeGroups: ownProps.excludeGroups,\n        searchTerm,\n        groups,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            getGroupsNotAssociatedToTeam,\n            setModalSearchTerm,\n            linkGroupSyncable,\n            getAllGroupsAssociatedToTeam,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AddGroupsToTeamModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport ReactDOM from 'react-dom';\nimport {defineMessages, FormattedMessage, injectIntl} from 'react-intl';\nimport PropTypes from 'prop-types';\n\nimport Constants from 'utils/constants';\nimport {intlShape} from 'utils/react_intl';\nimport * as Utils from 'utils/utils.jsx';\nimport {t} from 'utils/i18n';\nimport ConfirmModal from '../../confirm_modal';\n\nconst UserSettings = React.lazy(() => import(/* webpackPrefetch: true */ 'components/user_settings'));\nconst SettingsSidebar = React.lazy(() => import(/* webpackPrefetch: true */ '../../settings_sidebar.tsx'));\n\nconst holders = defineMessages({\n    general: {\n        id: t('user.settings.modal.general'),\n        defaultMessage: 'General',\n    },\n    security: {\n        id: t('user.settings.modal.security'),\n        defaultMessage: 'Security',\n    },\n    notifications: {\n        id: t('user.settings.modal.notifications'),\n        defaultMessage: 'Notifications',\n    },\n    display: {\n        id: t('user.settings.modal.display'),\n        defaultMessage: 'Display',\n    },\n    sidebar: {\n        id: t('user.settings.modal.sidebar'),\n        defaultMessage: 'Sidebar',\n    },\n    advanced: {\n        id: t('user.settings.modal.advanced'),\n        defaultMessage: 'Advanced',\n    },\n    checkEmail: {\n        id: 'user.settings.general.checkEmail',\n        defaultMessage: 'Check your email at {email} to verify the address. Cannot find the email?',\n    },\n    confirmTitle: {\n        id: t('user.settings.modal.confirmTitle'),\n        defaultMessage: 'Discard Changes?',\n    },\n    confirmMsg: {\n        id: t('user.settings.modal.confirmMsg'),\n        defaultMessage: 'You have unsaved changes, are you sure you want to discard them?',\n    },\n    confirmBtns: {\n        id: t('user.settings.modal.confirmBtns'),\n        defaultMessage: 'Yes, Discard',\n    },\n});\n\nclass UserSettingsModal extends React.Component {\n    static propTypes = {\n        currentUser: PropTypes.object.isRequired,\n        onHide: PropTypes.func.isRequired,\n        intl: intlShape.isRequired,\n        actions: PropTypes.shape({\n            sendVerificationEmail: PropTypes.func.isRequred,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            active_tab: 'general',\n            active_section: '',\n            showConfirmModal: false,\n            enforceFocus: true,\n            show: true,\n        };\n\n        this.requireConfirm = false;\n\n        // Used when settings want to override the default confirm modal with their own\n        // If set by a child, it will be called in place of showing the regular confirm\n        // modal. It will be passed a function to call on modal confirm\n        this.customConfirmAction = null;\n\n        this.modalBodyRef = React.createRef();\n    }\n\n    handleResend = (email) => {\n        this.setState({resendStatus: 'sending'});\n\n        this.props.actions.sendVerificationEmail(email).then(({data, error: err}) => {\n            if (data) {\n                this.setState({resendStatus: 'success'});\n            } else if (err) {\n                this.setState({resendStatus: 'failure'});\n            }\n        });\n    }\n\n    componentDidMount() {\n        document.addEventListener('keydown', this.handleKeyDown);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleKeyDown);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.state.active_tab !== prevState.active_tab) {\n            $(ReactDOM.findDOMNode(this.modalBodyRef.current)).scrollTop(0);\n        }\n    }\n\n    handleKeyDown = (e) => {\n        if (Utils.cmdOrCtrlPressed(e) && e.shiftKey && Utils.isKeyPressed(e, Constants.KeyCodes.A)) {\n            this.handleHide();\n        }\n    }\n\n    // Called when the close button is pressed on the main modal\n    handleHide = () => {\n        if (this.requireConfirm) {\n            this.showConfirmModal(() => this.handleHide());\n            return;\n        }\n\n        this.setState({\n            show: false,\n        });\n    }\n\n    // called after the dialog is fully hidden and faded out\n    handleHidden = () => {\n        this.setState({\n            active_tab: 'general',\n            active_section: '',\n        });\n        this.props.onHide();\n    }\n\n    // Called to hide the settings pane when on mobile\n    handleCollapse = () => {\n        $(ReactDOM.findDOMNode(this.modalBodyRef.current)).closest('.modal-dialog').removeClass('display--content');\n\n        this.setState({\n            active_tab: '',\n            active_section: '',\n        });\n    }\n\n    handleConfirm = () => {\n        this.setState({\n            showConfirmModal: false,\n            enforceFocus: true,\n        });\n\n        this.requireConfirm = false;\n        this.customConfirmAction = null;\n\n        if (this.afterConfirm) {\n            this.afterConfirm();\n            this.afterConfirm = null;\n        }\n    }\n\n    handleCancelConfirmation = () => {\n        this.setState({\n            showConfirmModal: false,\n            enforceFocus: true,\n        });\n\n        this.afterConfirm = null;\n    }\n\n    showConfirmModal = (afterConfirm) => {\n        if (afterConfirm) {\n            this.afterConfirm = afterConfirm;\n        }\n\n        if (this.customConfirmAction) {\n            this.customConfirmAction(this.handleConfirm);\n            return;\n        }\n\n        this.setState({\n            showConfirmModal: true,\n            enforceFocus: false,\n        });\n    }\n\n    // Called by settings tabs when their close button is pressed\n    closeModal = () => {\n        if (this.requireConfirm) {\n            this.showConfirmModal(this.closeModal);\n        } else {\n            this.handleHide();\n        }\n    }\n\n    // Called by settings tabs when their back button is pressed\n    collapseModal = () => {\n        if (this.requireConfirm) {\n            this.showConfirmModal(this.collapseModal);\n        } else {\n            this.handleCollapse();\n        }\n    }\n\n    updateTab = (tab, skipConfirm) => {\n        if (!skipConfirm && this.requireConfirm) {\n            this.showConfirmModal(() => this.updateTab(tab, true));\n        } else {\n            this.setState({\n                active_tab: tab,\n                active_section: '',\n            });\n        }\n    }\n\n    updateSection = (section, skipConfirm) => {\n        if (!skipConfirm && this.requireConfirm) {\n            this.showConfirmModal(() => this.updateSection(section, true));\n        } else {\n            this.setState({\n                active_section: section,\n            });\n        }\n    }\n\n    render() {\n        const {formatMessage} = this.props.intl;\n        if (this.props.currentUser == null) {\n            return (<div/>);\n        }\n        var tabs = [];\n\n        tabs.push({name: 'general', uiName: formatMessage(holders.general), icon: 'icon fa fa-gear', iconTitle: Utils.localizeMessage('user.settings.general.icon', 'General Settings Icon')});\n        tabs.push({name: 'security', uiName: formatMessage(holders.security), icon: 'icon fa fa-lock', iconTitle: Utils.localizeMessage('user.settings.security.icon', 'Security Settings Icon')});\n        tabs.push({name: 'notifications', uiName: formatMessage(holders.notifications), icon: 'icon fa fa-exclamation-circle', iconTitle: Utils.localizeMessage('user.settings.notifications.icon', 'Notification Settings Icon')});\n        tabs.push({name: 'display', uiName: formatMessage(holders.display), icon: 'icon fa fa-eye', iconTitle: Utils.localizeMessage('user.settings.display.icon', 'Display Settings Icon')});\n        tabs.push({name: 'sidebar', uiName: formatMessage(holders.sidebar), icon: 'icon fa fa-columns', iconTitle: Utils.localizeMessage('user.settings.sidebar.icon', 'Sidebar Settings Icon')});\n        tabs.push({name: 'advanced', uiName: formatMessage(holders.advanced), icon: 'icon fa fa-list-alt', iconTitle: Utils.localizeMessage('user.settings.advance.icon', 'Advanced Settings Icon')});\n\n        return (\n            <Modal\n                id='accountSettingsModal'\n                dialogClassName='a11y__modal settings-modal'\n                show={this.state.show}\n                onHide={this.handleHide}\n                onExited={this.handleHidden}\n                enforceFocus={this.state.enforceFocus}\n                role='dialog'\n                aria-labelledby='accountSettingsModalLabel'\n            >\n                <Modal.Header\n                    id='accountSettingsHeader'\n                    closeButton={true}\n                >\n                    <Modal.Title\n                        componentClass='h1'\n                        id='accountSettingsModalLabel'\n                    >\n                        <FormattedMessage\n                            id='user.settings.modal.title'\n                            defaultMessage='Account Settings'\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body ref={this.modalBodyRef}>\n                    <div className='settings-table'>\n                        <div className='settings-links'>\n                            <React.Suspense fallback={null}>\n                                <SettingsSidebar\n                                    tabs={tabs}\n                                    activeTab={this.state.active_tab}\n                                    updateTab={this.updateTab}\n                                />\n                            </React.Suspense>\n                        </div>\n                        <div className='settings-content minimize-settings'>\n                            <React.Suspense fallback={null}>\n                                <UserSettings\n                                    activeTab={this.state.active_tab}\n                                    activeSection={this.state.active_section}\n                                    updateSection={this.updateSection}\n                                    updateTab={this.updateTab}\n                                    closeModal={this.closeModal}\n                                    collapseModal={this.collapseModal}\n                                    setEnforceFocus={(enforceFocus) => this.setState({enforceFocus})}\n                                    setRequireConfirm={\n                                        (requireConfirm, customConfirmAction) => {\n                                            this.requireConfirm = requireConfirm;\n                                            this.customConfirmAction = customConfirmAction;\n                                        }\n                                    }\n                                />\n                            </React.Suspense>\n                        </div>\n                    </div>\n                </Modal.Body>\n                <ConfirmModal\n                    title={formatMessage(holders.confirmTitle)}\n                    message={formatMessage(holders.confirmMsg)}\n                    confirmButtonText={formatMessage(holders.confirmBtns)}\n                    show={this.state.showConfirmModal}\n                    onConfirm={this.handleConfirm}\n                    onCancel={this.handleCancelConfirmation}\n                />\n            </Modal>\n        );\n    }\n}\n\nexport default injectIntl(UserSettingsModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {sendVerificationEmail} from 'mattermost-redux/actions/users';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\n\nimport UserSettingsModal from './user_settings_modal.jsx';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n\n    const closeUnusedDirectMessages = config.CloseUnusedDirectMessages === 'true';\n    const experimentalChannelOrganization = config.ExperimentalChannelOrganization === 'true';\n    const sendEmailNotifications = config.SendEmailNotifications === 'true';\n    const requireEmailVerification = config.RequireEmailVerification === 'true';\n\n    return {\n        currentUser: getCurrentUser(state),\n        closeUnusedDirectMessages,\n        experimentalChannelOrganization,\n        sendEmailNotifications,\n        requireEmailVerification,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            sendVerificationEmail,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserSettingsModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {getCurrentTeamId, getTeamByName} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\n\nimport localStorageStore from 'stores/local_storage_store';\n\n// getLastViewedChannelName combines data from the Redux store and localStorage to return the\n// previously selected channel name, returning the default channel if none exists.\n//\n// See LocalStorageStore for context.\nexport const getLastViewedChannelName = (state) => {\n    const userId = getCurrentUserId(state);\n    const teamId = getCurrentTeamId(state);\n\n    return localStorageStore.getPreviousChannelName(userId, teamId);\n};\n\nexport const getPenultimateViewedChannelName = (state) => {\n    const userId = getCurrentUserId(state);\n    const teamId = getCurrentTeamId(state);\n\n    return localStorageStore.getPenultimateChannelName(userId, teamId);\n};\n\n// getLastViewedChannelNameByTeamName combines data from the Redux store and localStorage to return\n// the url to the previously selected channel, returning the path to the default channel if none\n// exists.\n//\n// See LocalStorageStore for context.\nexport const getLastViewedChannelNameByTeamName = (state, teamName) => {\n    const userId = getCurrentUserId(state);\n    const team = getTeamByName(state, teamName);\n    const teamId = team && team.id;\n\n    return localStorageStore.getPreviousChannelName(userId, teamId);\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Client4} from 'mattermost-redux/client';\n\nimport * as Utils from 'utils/utils.jsx';\n\nimport GuestBadge from 'components/widgets/badges/guest_badge';\nimport BotBadge from 'components/widgets/badges/bot_badge';\nimport Avatar from 'components/widgets/users/avatar';\n\nimport Provider from './provider.jsx';\nimport Suggestion from './suggestion.jsx';\n\nclass UserSuggestion extends Suggestion {\n    render() {\n        const {item, isSelection} = this.props;\n\n        let className = 'suggestion-list__item mentions__name';\n        if (isSelection) {\n            className += ' suggestion--selected';\n        }\n\n        const username = item.username;\n        let description = '';\n\n        if ((item.first_name || item.last_name) && item.nickname) {\n            description = `- ${Utils.getFullName(item)} (${item.nickname})`;\n        } else if (item.nickname) {\n            description = `- (${item.nickname})`;\n        } else if (item.first_name || item.last_name) {\n            description = `- ${Utils.getFullName(item)}`;\n        }\n\n        return (\n            <div\n                className={className}\n                onClick={this.handleClick}\n                onMouseMove={this.handleMouseMove}\n                {...Suggestion.baseProps}\n            >\n                <Avatar\n                    size='xs'\n                    username={username}\n                    url={Client4.getUsersRoute() + '/' + item.id + '/image?_=' + (item.last_picture_update || 0)}\n                />\n                <span className='admin-setting-user--align'>\n                    {'@' + username}\n                </span>\n                <span className='admin-setting-user__fullname'>\n                    {' '}\n                    {description}\n                </span>\n                <BotBadge show={Boolean(item.is_bot)}/>\n                <GuestBadge show={Utils.isGuest(item)}/>\n            </div>\n        );\n    }\n}\n\nexport default class UserProvider extends Provider {\n    constructor(searchUsersFunc) {\n        super();\n        this.autocompleteUsers = searchUsersFunc;\n    }\n    async handlePretextChanged(pretext, resultsCallback) {\n        const normalizedPretext = pretext.toLowerCase();\n        this.startNewRequest(normalizedPretext);\n\n        const data = await this.autocompleteUsers(normalizedPretext);\n\n        if (this.shouldCancelDispatch(normalizedPretext)) {\n            return false;\n        }\n\n        const users = Object.assign([], data.users);\n\n        resultsCallback({\n            matchedPretext: normalizedPretext,\n            terms: users.map((user) => user.username),\n            items: users,\n            component: UserSuggestion,\n        });\n\n        return true;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\ntype Props = {\n    inputId?: string;\n    label: React.ReactNode;\n    labelClassName?: string;\n    inputClassName?: string;\n    children: React.ReactNode;\n    helpText?: React.ReactNode;\n    footer?: React.ReactNode;\n}\n\nconst Setting: React.FC<Props> = ({\n    inputId,\n    label,\n    labelClassName,\n    inputClassName,\n    children,\n    footer,\n    helpText,\n}: Props) => {\n    return (\n        <div\n            data-testid={inputId}\n            className='form-group'\n        >\n            <label\n                data-testid={inputId + 'label'}\n                className={'control-label ' + labelClassName}\n                htmlFor={inputId}\n            >\n                {label}\n            </label>\n            <div className={inputClassName}>\n                {children}\n                <div\n                    data-testid={inputId + 'help-text'}\n                    className='help-text'\n                >\n                    {helpText}\n                </div>\n                {footer}\n            </div>\n        </div>\n    );\n};\n\nexport default Setting;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport * as Flux from 'flux';\n\nimport Constants from 'utils/constants';\n\nconst PayloadSources = Constants.PayloadSources;\n\nconst AppDispatcher = Object.assign(new Flux.Dispatcher(), {\n    handleServerAction: function performServerAction(action) {\n        if (!action.type) {\n            console.warn('handleServerAction called with undefined action type'); // eslint-disable-line no-console\n        }\n\n        var payload = {\n            source: PayloadSources.SERVER_ACTION,\n            action,\n        };\n        this.dispatch(payload);\n    },\n\n    handleViewAction: function performViewAction(action) {\n        if (!action.type) {\n            console.warn('handleViewAction called with undefined action type'); // eslint-disable-line no-console\n        }\n\n        var payload = {\n            source: PayloadSources.VIEW_ACTION,\n            action,\n        };\n        this.dispatch(payload);\n    },\n});\n\nexport default AppDispatcher;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {ActionTypes} from 'utils/constants';\n\nexport function dismissNotice(type) {\n    return (dispatch) => {\n        dispatch({\n            type: ActionTypes.DISMISS_NOTICE,\n            data: type,\n        });\n\n        return {data: true};\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class MattermostLogo extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.mattermost'\n                    defaultMessage='Mattermost Logo'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            version='1.1'\n                            x='0px'\n                            y='0px'\n                            viewBox='0 0 500 500'\n                            style={style.background}\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g>\n                                <g>\n                                    <path\n                                        style={style.st0}\n                                        d='M396.9,47.7l2.6,53.1c43,47.5,60,114.8,38.6,178.1c-32,94.4-137.4,144.1-235.4,110.9 S51.1,253.1,83,158.7C104.5,95.2,159.2,52,222.5,40.5l34.2-40.4C150-2.8,49.3,63.4,13.3,169.9C-31,300.6,39.1,442.5,169.9,486.7 s272.6-25.8,316.9-156.6C522.7,223.9,483.1,110.3,396.9,47.7z'\n                                    />\n                                </g>\n                                <path\n                                    style={style.st0}\n                                    d='M335.6,204.3l-1.8-74.2l-1.5-42.7l-1-37c0,0,0.2-17.8-0.4-22c-0.1-0.9-0.4-1.6-0.7-2.2 c0-0.1-0.1-0.2-0.1-0.3c0-0.1-0.1-0.2-0.1-0.2c-0.7-1.2-1.8-2.1-3.1-2.6c-1.4-0.5-2.9-0.4-4.2,0.2c0,0-0.1,0-0.1,0 c-0.2,0.1-0.3,0.1-0.4,0.2c-0.6,0.3-1.2,0.7-1.8,1.3c-3,3-13.7,17.2-13.7,17.2l-23.2,28.8l-27.1,33l-46.5,57.8 c0,0-21.3,26.6-16.6,59.4s29.1,48.7,48,55.1c18.9,6.4,48,8.5,71.6-14.7C336.4,238.4,335.6,204.3,335.6,204.3z'\n                                />\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n\nconst style = {\n    background: {\n        enableBackground: 'new 0 0 500 500',\n    },\n    st0: {\n        fillRule: 'evenodd',\n        clipRule: 'evenodd',\n    },\n};\n","module.exports = __webpack_public_path__ + \"files/fb02f374b8f73825415db1bccd4bd76d.gif\";","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {getTeamMember} from 'mattermost-redux/actions/teams';\nimport {getChannelMember} from 'mattermost-redux/actions/channels';\nimport {getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\n\nimport {getSelectedPost} from 'selectors/rhs';\n\nexport function getMembershipForCurrentEntities(userId) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const currentTeamId = getCurrentTeamId(state);\n\n        const selectedPost = getSelectedPost(state);\n        const currentChannel = getCurrentChannel(state);\n\n        let channelId;\n        if (selectedPost.exists === false) {\n            channelId = currentChannel.id;\n        } else {\n            channelId = selectedPost.channel_id;\n        }\n\n        return Promise.all([dispatch(getTeamMember(currentTeamId, userId)), dispatch(getChannelMember(channelId, userId))]);\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {\n    getChannelsInCurrentTeam,\n} from 'mattermost-redux/selectors/entities/channels';\nimport {getMyChannelMemberships} from 'mattermost-redux/selectors/entities/common';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentUserLocale} from 'mattermost-redux/selectors/entities/i18n';\nimport {haveIChannelPermission} from 'mattermost-redux/selectors/entities/roles';\nimport {Permissions} from 'mattermost-redux/constants';\nimport {sortChannelsByTypeAndDisplayName} from 'mattermost-redux/utils/channel_utils';\nimport {logError} from 'mattermost-redux/actions/errors';\n\nimport GlobeIcon from 'components/widgets/icons/globe_icon';\nimport LockIcon from 'components/widgets/icons/lock_icon';\nimport ArchiveIcon from 'components/widgets/icons/archive_icon';\nimport store from 'stores/redux_store.jsx';\nimport {Constants} from 'utils/constants';\n\nimport Provider from './provider.jsx';\nimport Suggestion from './suggestion.jsx';\n\nclass SearchChannelWithPermissionsSuggestion extends Suggestion {\n    static get propTypes() {\n        return {\n            ...super.propTypes,\n        };\n    }\n\n    render() {\n        const {item, isSelection} = this.props;\n        const channel = item.channel;\n        const channelIsArchived = channel.delete_at && channel.delete_at !== 0;\n\n        let className = 'mentions__name';\n        if (isSelection) {\n            className += ' suggestion--selected';\n        }\n\n        const displayName = channel.display_name;\n        let icon = null;\n        if (channelIsArchived) {\n            icon = (\n                <ArchiveIcon className='icon icon__archive'/>\n            );\n        } else if (channel.type === Constants.OPEN_CHANNEL) {\n            icon = (\n                <GlobeIcon className='icon icon__globe icon--body'/>\n            );\n        } else if (channel.type === Constants.PRIVATE_CHANNEL) {\n            icon = (\n                <LockIcon className='icon icon__lock icon--body'/>\n            );\n        }\n\n        return (\n            <div\n                onClick={this.handleClick}\n                className={className}\n                onMouseMove={this.handleMouseMove}\n                ref={(node) => {\n                    this.node = node;\n                }}\n                {...Suggestion.baseProps}\n            >\n                {icon}\n                {displayName}\n            </div>\n        );\n    }\n}\n\nlet prefix = '';\n\nfunction channelSearchSorter(wrappedA, wrappedB) {\n    const aIsArchived = wrappedA.channel.delete_at ? wrappedA.channel.delete_at !== 0 : false;\n    const bIsArchived = wrappedB.channel.delete_at ? wrappedB.channel.delete_at !== 0 : false;\n    if (aIsArchived && !bIsArchived) {\n        return 1;\n    } else if (!aIsArchived && bIsArchived) {\n        return -1;\n    }\n\n    const locale = getCurrentUserLocale(store.getState());\n\n    const a = wrappedA.channel;\n    const b = wrappedB.channel;\n\n    const aDisplayName = a.display_name.toLowerCase();\n    const bDisplayName = b.display_name.toLowerCase();\n\n    const aStartsWith = aDisplayName.startsWith(prefix);\n    const bStartsWith = bDisplayName.startsWith(prefix);\n    if (aStartsWith && bStartsWith) {\n        return sortChannelsByTypeAndDisplayName(locale, a, b);\n    } else if (!aStartsWith && !bStartsWith) {\n        return sortChannelsByTypeAndDisplayName(locale, a, b);\n    } else if (aStartsWith) {\n        return -1;\n    }\n\n    return 1;\n}\n\nexport default class SearchChannelWithPermissionsProvider extends Provider {\n    constructor(channelSearchFunc) {\n        super();\n        this.autocompleteChannelsForSearch = channelSearchFunc;\n    }\n\n    makeChannelSearchFilter(channelPrefix) {\n        const channelPrefixLower = channelPrefix.toLowerCase();\n\n        return (channel) => {\n            const state = store.getState();\n            const channelId = channel.id;\n            const teamId = getCurrentTeamId(state);\n\n            const searchString = channel.display_name;\n\n            if (channel.type === Constants.OPEN_CHANNEL &&\n                haveIChannelPermission(state, {channel: channelId, team: teamId, permission: Permissions.MANAGE_PUBLIC_CHANNEL_MEMBERS})) {\n                return searchString.toLowerCase().includes(channelPrefixLower);\n            } else if (channel.type === Constants.PRIVATE_CHANNEL &&\n                haveIChannelPermission(state, {channel: channelId, team: teamId, permission: Permissions.MANAGE_PRIVATE_CHANNEL_MEMBERS})) {\n                return searchString.toLowerCase().includes(channelPrefixLower);\n            }\n\n            return false;\n        };\n    }\n\n    handlePretextChanged(channelPrefix, resultsCallback) {\n        if (channelPrefix) {\n            prefix = channelPrefix;\n            this.startNewRequest(channelPrefix);\n            const state = store.getState();\n\n            // Dispatch suggestions for local data\n            const channels = getChannelsInCurrentTeam(state);\n            this.formatChannelsAndDispatch(channelPrefix, resultsCallback, channels);\n\n            // Fetch data from the server and dispatch\n            this.fetchChannels(channelPrefix, resultsCallback);\n        }\n\n        return true;\n    }\n\n    async fetchChannels(channelPrefix, resultsCallback) {\n        const state = store.getState();\n        const teamId = getCurrentTeamId(state);\n        if (!teamId) {\n            return;\n        }\n\n        const channelsAsync = this.autocompleteChannelsForSearch(teamId, channelPrefix);\n\n        let channelsFromServer = [];\n        try {\n            const {data} = await channelsAsync;\n            channelsFromServer = data;\n        } catch (err) {\n            store.dispatch(logError(err));\n        }\n\n        if (this.shouldCancelDispatch(channelPrefix)) {\n            return;\n        }\n\n        const channels = getChannelsInCurrentTeam(state).concat(channelsFromServer);\n        this.formatChannelsAndDispatch(channelPrefix, resultsCallback, channels);\n    }\n\n    formatChannelsAndDispatch(channelPrefix, resultsCallback, allChannels) {\n        const channels = [];\n\n        const state = store.getState();\n\n        const members = getMyChannelMemberships(state);\n\n        if (this.shouldCancelDispatch(channelPrefix)) {\n            return;\n        }\n\n        const completedChannels = {};\n\n        const channelFilter = this.makeChannelSearchFilter(channelPrefix);\n\n        const config = getConfig(state);\n        const viewArchivedChannels = config.ExperimentalViewArchivedChannels === 'true';\n\n        for (const id of Object.keys(allChannels)) {\n            const channel = allChannels[id];\n            if (!channel) {\n                continue;\n            }\n\n            if (completedChannels[channel.id]) {\n                continue;\n            }\n\n            if (channelFilter(channel)) {\n                const newChannel = Object.assign({}, channel);\n                const channelIsArchived = channel.delete_at !== 0;\n\n                const wrappedChannel = {channel: newChannel, name: newChannel.name, deactivated: false};\n                if (!viewArchivedChannels && channelIsArchived) {\n                    continue;\n                } else if (!members[channel.id]) {\n                    continue;\n                } else if (channelIsArchived && !members[channel.id]) {\n                    continue;\n                } else if (channel.type === Constants.OPEN_CHANNEL) {\n                    wrappedChannel.type = Constants.OPEN_CHANNEL;\n                } else if (channel.type === Constants.PRIVATE_CHANNEL) {\n                    wrappedChannel.type = Constants.PRIVATE_CHANNEL;\n                } else {\n                    continue;\n                }\n                completedChannels[channel.id] = true;\n                channels.push(wrappedChannel);\n            }\n        }\n\n        const channelNames = channels.\n            sort(channelSearchSorter).\n            map((wrappedChannel) => wrappedChannel.channel.name);\n\n        resultsCallback({\n            matchedPretext: channelPrefix,\n            terms: channelNames,\n            items: channels,\n            component: SearchChannelWithPermissionsSuggestion,\n        });\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport {getFullName} from 'mattermost-redux/utils/user_utils';\n\nimport SearchChannelWithPermissionsProvider from 'components/suggestion/search_channel_with_permissions_provider.jsx';\nimport SuggestionBox from 'components/suggestion/suggestion_box.jsx';\nimport SuggestionList from 'components/suggestion/suggestion_list.jsx';\n\nimport {placeCaretAtEnd} from 'utils/utils.jsx';\n\nexport default class AddUserToChannelModal extends React.Component {\n    static propTypes = {\n\n        /**\n         * Function that's called when modal is closed\n         */\n        onHide: PropTypes.func.isRequired,\n\n        /**\n         * The user that is being added to a channel\n         */\n        user: PropTypes.object.isRequired,\n\n        /**\n         * Object used to determine if the user\n         * is a member of a given channel\n         */\n        channelMembers: PropTypes.object.isRequired,\n\n        actions: PropTypes.shape({\n\n            /**\n             * Function to add the user to a channel\n             */\n            addChannelMember: PropTypes.func.isRequired,\n\n            /**\n             * Function to fetch the user's channel membership\n             */\n            getChannelMember: PropTypes.func.isRequired,\n\n            /**\n             * Function passed on to the constructor of the\n             * SearchChannelWithPermissionsProvider class to fetch channels\n             * based on a search term\n             */\n            autocompleteChannelsForSearch: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n\n            /**\n             * Whether or not the modal is visible\n             */\n            show: true,\n\n            /**\n             * Whether or not a request to add the user is in progress\n             */\n            saving: false,\n\n            /**\n             * Whether or not a request to check for the user's channel membership\n             * is in progress\n             */\n            checkingForMembership: false,\n\n            /**\n             * The user input in the channel search box\n             */\n            text: '',\n\n            /**\n             * The id for the channel that is selected\n             */\n            selectedChannelId: null,\n\n            /**\n             * An error to display when the add request fails\n             */\n            submitError: '',\n        };\n        this.suggestionProviders = [new SearchChannelWithPermissionsProvider(props.actions.autocompleteChannelsForSearch)];\n        this.enableChannelProvider();\n    }\n\n    enableChannelProvider = () => {\n        this.suggestionProviders[0].disableDispatches = false;\n    }\n\n    focusTextbox = () => {\n        if (this.channelSearchBox == null) {\n            return;\n        }\n\n        const textbox = this.channelSearchBox.getTextbox();\n        if (document.activeElement !== textbox) {\n            textbox.focus();\n            placeCaretAtEnd(textbox);\n        }\n    }\n\n    onInputChange = (e) => {\n        this.setState({text: e.target.value, selectedChannelId: null});\n    }\n\n    onHide = () => {\n        this.setState({show: false});\n        this.props.onHide();\n    }\n\n    setSearchBoxRef = (input) => {\n        this.channelSearchBox = input;\n        this.focusTextbox();\n    }\n\n    handleSubmitError = (error) => {\n        if (error) {\n            this.setState({submitError: error.message, saving: false});\n        }\n    }\n\n    didSelectChannel = (selection) => {\n        const channel = selection.channel;\n        const userId = this.props.user.id;\n\n        this.setState({\n            text: channel.display_name,\n            selectedChannelId: channel.id,\n            checkingForMembership: true,\n            submitError: '',\n        });\n\n        this.props.actions.getChannelMember(channel.id, userId).then(() => {\n            this.setState({checkingForMembership: false});\n        });\n    }\n\n    handleSubmit = (e) => {\n        if (e && e.preventDefault) {\n            e.preventDefault();\n        }\n\n        const channelId = this.state.selectedChannelId;\n        const user = this.props.user;\n\n        if (!channelId) {\n            return;\n        }\n\n        if (this.isUserMemberOfChannel(channelId) || this.state.saving) {\n            return;\n        }\n\n        this.setState({saving: true});\n\n        this.props.actions.addChannelMember(channelId, user.id).then(({error}) => {\n            if (error) {\n                this.handleSubmitError(error);\n            } else {\n                this.onHide();\n            }\n        });\n    }\n\n    isUserMemberOfChannel = (channelId) => {\n        const user = this.props.user;\n        const memberships = this.props.channelMembers;\n\n        if (!channelId) {\n            return false;\n        }\n\n        if (!memberships[channelId]) {\n            return false;\n        }\n\n        return Boolean(memberships[channelId][user.id]);\n    }\n\n    render() {\n        const user = this.props.user;\n        const channelId = this.state.selectedChannelId;\n        const targetUserIsMemberOfSelectedChannel = this.isUserMemberOfChannel(channelId);\n\n        let name = getFullName(user);\n        if (!name) {\n            name = `@${user.username}`;\n        }\n\n        let errorMsg;\n        if (!this.state.saving) {\n            if (this.state.submitError) {\n                errorMsg = (\n                    <label\n                        id='add-user-to-channel-modal__invite-error'\n                        className='modal__error has-error control-label'\n                    >\n                        {this.state.submitError}\n                    </label>\n                );\n            } else if (targetUserIsMemberOfSelectedChannel) {\n                errorMsg = (\n                    <label\n                        id='add-user-to-channel-modal__user-is-member'\n                        className='modal__error has-error control-label'\n                    >\n                        <FormattedMessage\n                            id='add_user_to_channel_modal.membershipExistsError'\n                            defaultMessage='{name} is already a member of that channel'\n                            values={{\n                                name,\n                            }}\n                        />\n                    </label>\n                );\n            }\n        }\n\n        const help = (\n            <FormattedMessage\n                id='add_user_to_channel_modal.help'\n                defaultMessage='Type to find a channel. Use  to browse,  to select, ESC to dismiss.'\n            />\n        );\n\n        const content = (\n            <SuggestionBox\n                ref={this.setSearchBoxRef}\n                className='form-control focused'\n                onChange={this.onInputChange}\n                value={this.state.text}\n                onKeyDown={this.handleKeyDown}\n                onItemSelected={this.didSelectChannel}\n                listComponent={SuggestionList}\n                maxLength='64'\n                providers={this.suggestionProviders}\n                listStyle='bottom'\n                completeOnTab={false}\n                renderDividers={false}\n                delayInputUpdate={true}\n                openWhenEmpty={true}\n            />\n        );\n\n        const shouldDisableAddButton = targetUserIsMemberOfSelectedChannel ||\n            this.state.checkingForMembership ||\n            Boolean(!this.state.selectedChannelId) ||\n            this.state.saving;\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal modal--overflow'\n                show={this.state.show}\n                onHide={this.onHide}\n                onExited={this.props.onHide}\n                ref='modal'\n                enforceFocus={true}\n                role='dialog'\n                aria-labelledby='addChannelModalLabel'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='addChannelModalLabel'\n                    >\n                        <FormattedMessage\n                            id='add_user_to_channel_modal.title'\n                            defaultMessage='Add {name} to a Channel'\n                            values={{\n                                name,\n                            }}\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <form\n                    role='form'\n                    onSubmit={this.handleSubmit}\n                >\n                    <Modal.Body>\n                        <div className='modal__hint'>\n                            {help}\n                        </div>\n                        {content}\n                        <div>\n                            {errorMsg}\n                            <br/>\n                        </div>\n                    </Modal.Body>\n                    <Modal.Footer>\n                        <button\n                            type='button'\n                            className='btn btn-link'\n                            onClick={this.onHide}\n                        >\n                            <FormattedMessage\n                                id='add_user_to_channel_modal.cancel'\n                                defaultMessage='Cancel'\n                            />\n                        </button>\n                        <button\n                            type='button'\n                            id='add-user-to-channel-modal__add-button'\n                            className='btn btn-primary'\n                            onClick={this.handleSubmit}\n                            disabled={shouldDisableAddButton}\n                        >\n                            <FormattedMessage\n                                id='add_user_to_channel_modal.add'\n                                defaultMessage='Add'\n                            />\n                        </button>\n                    </Modal.Footer>\n                </form>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {addChannelMember, getChannelMember, autocompleteChannelsForSearch} from 'mattermost-redux/actions/channels';\nimport {getChannelMembersInChannels} from 'mattermost-redux/selectors/entities/channels';\n\nimport AddUserToChannelModal from './add_user_to_channel_modal.jsx';\n\nfunction mapStateToProps(state) {\n    const channelMembers = getChannelMembersInChannels(state) || {};\n    return {\n        channelMembers,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            addChannelMember,\n            getChannelMember,\n            autocompleteChannelsForSearch,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AddUserToChannelModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage, injectIntl} from 'react-intl';\n\nimport EventEmitter from 'mattermost-redux/utils/event_emitter';\n\nimport LocalDateTime from 'components/local_date_time';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport UserSettingsModal from 'components/user_settings/modal';\nimport {browserHistory} from 'utils/browser_history';\nimport * as GlobalActions from 'actions/global_actions.jsx';\nimport Constants, {ModalIdentifiers, UserStatuses} from 'utils/constants';\nimport {t} from 'utils/i18n';\nimport {intlShape} from 'utils/react_intl';\nimport * as Utils from 'utils/utils.jsx';\nimport Pluggable from 'plugins/pluggable';\n\nimport AddUserToChannelModal from 'components/add_user_to_channel_modal';\nimport LocalizedIcon from 'components/localized_icon';\nimport ToggleModalButtonRedux from 'components/toggle_modal_button_redux';\nimport Avatar from 'components/widgets/users/avatar';\nimport Popover from 'components/widgets/popover';\n\n/**\n * The profile popover, or hovercard, that appears with user information when clicking\n * on the username or profile picture of a user.\n */\nclass ProfilePopover extends React.PureComponent {\n    static getComponentName() {\n        return 'ProfilePopover';\n    }\n\n    static propTypes = {\n\n        /**\n         * Source URL from the image to display in the popover\n         */\n        src: PropTypes.string.isRequired,\n\n        /**\n         * User the popover is being opened for\n         */\n        user: PropTypes.object,\n\n        /**\n         * Status for the user, either 'offline', 'away', 'dnd' or 'online'\n         */\n        status: PropTypes.string,\n\n        hideStatus: PropTypes.bool,\n\n        /**\n         * Function to call to hide the popover\n         */\n        hide: PropTypes.func,\n\n        /**\n         * Set to true if the popover was opened from the right-hand\n         * sidebar (comment thread, search results, etc.)\n         */\n        isRHS: PropTypes.bool,\n\n        currentTeamId: PropTypes.string.isRequired,\n\n        /**\n         * @internal\n         */\n        currentUserId: PropTypes.string.isRequired,\n\n        /**\n         * @internal\n         */\n        hasMention: PropTypes.bool,\n\n        /**\n         * @internal\n         */\n        isInCurrentTeam: PropTypes.bool.isRequired,\n\n        /**\n         * @internal\n         */\n        teamUrl: PropTypes.string.isRequired,\n\n        /**\n         * @internal\n         */\n        isTeamAdmin: PropTypes.bool.isRequired,\n\n        /**\n         * @internal\n         */\n        isChannelAdmin: PropTypes.bool.isRequired,\n\n        /**\n         * @internal\n         */\n        canManageAnyChannelMembersInCurrentTeam: PropTypes.bool.isRequired,\n\n        /**\n         * @internal\n         */\n        actions: PropTypes.shape({\n            getMembershipForCurrentEntities: PropTypes.func.isRequired,\n            openDirectChannelToUserId: PropTypes.func.isRequired,\n            openModal: PropTypes.func.isRequired,\n        }).isRequired,\n\n        /**\n         * react-intl helper object\n         */\n        intl: intlShape.isRequired,\n\n        ...Popover.propTypes,\n    }\n\n    static defaultProps = {\n        isRHS: false,\n        hasMention: false,\n        status: UserStatuses.OFFLINE,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            loadingDMChannel: -1,\n        };\n    }\n\n    componentDidMount() {\n        this.props.actions.getMembershipForCurrentEntities(this.props.userId);\n    }\n\n    handleShowDirectChannel = (e) => {\n        const {actions} = this.props;\n        e.preventDefault();\n\n        if (!this.props.user) {\n            return;\n        }\n\n        const user = this.props.user;\n\n        if (this.state.loadingDMChannel !== -1) {\n            return;\n        }\n\n        this.setState({loadingDMChannel: user.id});\n\n        actions.openDirectChannelToUserId(user.id).then((result) => {\n            if (!result.error) {\n                if (Utils.isMobile()) {\n                    GlobalActions.emitCloseRightHandSide();\n                }\n                this.setState({loadingDMChannel: -1});\n                if (this.props.hide) {\n                    this.props.hide();\n                }\n                browserHistory.push(`${this.props.teamUrl}/messages/@${user.username}`);\n            }\n        });\n    }\n\n    handleMentionKeyClick = (e) => {\n        e.preventDefault();\n\n        if (!this.props.user) {\n            return;\n        }\n        if (this.props.hide) {\n            this.props.hide();\n        }\n        EventEmitter.emit('mention_key_click', this.props.user.username, this.props.isRHS);\n    }\n\n    handleEditAccountSettings = (e) => {\n        e.preventDefault();\n\n        if (!this.props.user) {\n            return;\n        }\n        if (this.props.hide) {\n            this.props.hide();\n        }\n        this.props.actions.openModal({ModalId: ModalIdentifiers.USER_SETTINGS, dialogType: UserSettingsModal});\n    }\n\n    render() {\n        if (!this.props.user) {\n            return null;\n        }\n\n        const popoverProps = Object.assign({}, this.props);\n        delete popoverProps.user;\n        delete popoverProps.userId;\n        delete popoverProps.src;\n        delete popoverProps.status;\n        delete popoverProps.hideStatus;\n        delete popoverProps.isBusy;\n        delete popoverProps.hide;\n        delete popoverProps.isRHS;\n        delete popoverProps.hasMention;\n        delete popoverProps.dispatch;\n        delete popoverProps.enableTimezone;\n        delete popoverProps.currentUserId;\n        delete popoverProps.currentTeamId;\n        delete popoverProps.teamUrl;\n        delete popoverProps.actions;\n        delete popoverProps.isTeamAdmin;\n        delete popoverProps.isChannelAdmin;\n        delete popoverProps.canManageAnyChannelMembersInCurrentTeam;\n        delete popoverProps.intl;\n\n        const {formatMessage} = this.props.intl;\n\n        var dataContent = [];\n        dataContent.push(\n            <Avatar\n                size='xxl'\n                username={this.props.user.username}\n                url={this.props.src}\n                key='user-popover-image'\n            />,\n        );\n\n        const fullname = Utils.getFullName(this.props.user);\n\n        if (fullname || this.props.user.position) {\n            dataContent.push(\n                <hr\n                    key='user-popover-hr'\n                    className='divider divider--expanded'\n                />,\n            );\n        }\n\n        if (fullname) {\n            dataContent.push(\n                <OverlayTrigger\n                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                    placement='top'\n                    overlay={<Tooltip id='fullNameTooltip'>{fullname}</Tooltip>}\n                    key='user-popover-fullname'\n                >\n                    <div\n                        className='overflow--ellipsis text-nowrap'\n                    >\n                        <strong>{fullname}</strong>\n                    </div>\n                </OverlayTrigger>,\n            );\n        }\n\n        if (this.props.user.is_bot) {\n            dataContent.push(\n                <div\n                    key='bot-description'\n                    className='overflow--ellipsis text-nowrap'\n                >\n                    {this.props.user.bot_description}\n                </div>,\n            );\n        }\n\n        if (this.props.user.position) {\n            const position = this.props.user.position.substring(0, Constants.MAX_POSITION_LENGTH);\n            dataContent.push(\n                <OverlayTrigger\n                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                    placement='top'\n                    overlay={<Tooltip id='positionTooltip'>{position}</Tooltip>}\n                    key='user-popover-position'\n                >\n                    <div\n                        className='overflow--ellipsis text-nowrap pt-1 pb-1'\n                    >\n                        {position}\n                    </div>\n                </OverlayTrigger>,\n            );\n        }\n\n        const email = this.props.user.email;\n        if (email && !this.props.user.is_bot) {\n            dataContent.push(\n                <hr\n                    key='user-popover-hr2'\n                    className='divider divider--expanded'\n                />,\n            );\n\n            dataContent.push(\n                <div\n                    data-toggle='tooltip'\n                    title={email}\n                    key='user-popover-email'\n                >\n                    <a\n                        href={'mailto:' + email}\n                        className='text-nowrap text-lowercase user-popover__email pb-1'\n                    >\n                        {email}\n                    </a>\n                </div>,\n            );\n        }\n\n        dataContent.push(\n            <Pluggable\n                key='profilePopoverPluggable2'\n                pluggableName='PopoverUserAttributes'\n                user={this.props.user}\n                hide={this.props.hide}\n                status={this.props.hideStatus ? null : this.props.status}\n            />,\n        );\n\n        if (this.props.enableTimezone && this.props.user.timezone) {\n            dataContent.push(\n                <div\n                    key='user-popover-local-time'\n                    className='pb-1'\n                >\n                    <FormattedMessage\n                        id='user_profile.account.localTime'\n                        defaultMessage='Local Time: '\n                    />\n                    <LocalDateTime userTimezone={this.props.user.timezone}/>\n                </div>,\n            );\n        }\n\n        if (this.props.user.id === this.props.currentUserId) {\n            dataContent.push(\n                <div\n                    data-toggle='tooltip'\n                    key='user-popover-settings'\n                    className='popover__row first'\n                >\n                    <a\n                        href='#'\n                        onClick={this.handleEditAccountSettings}\n                    >\n                        <LocalizedIcon\n                            className='fa fa-pencil-square-o'\n                            title={{id: t('generic_icons.edit'), defaultMessage: 'Edit Icon'}}\n                        />\n                        <FormattedMessage\n                            id='user_profile.account.editSettings'\n                            defaultMessage='Edit Account Settings'\n                        />\n                    </a>\n                </div>,\n            );\n        }\n\n        if (this.props.user.id !== this.props.currentUserId) {\n            dataContent.push(\n                <div\n                    data-toggle='tooltip'\n                    key='user-popover-dm'\n                    className='popover__row first'\n                >\n                    <a\n                        href='#'\n                        className='text-nowrap user-popover__email'\n                        onClick={this.handleShowDirectChannel}\n                    >\n                        <LocalizedIcon\n                            className='fa fa-paper-plane'\n                            title={{id: t('user_profile.send.dm.icon'), defaultMessage: 'Send Message Icon'}}\n                        />\n                        <FormattedMessage\n                            id='user_profile.send.dm'\n                            defaultMessage='Send Message'\n                        />\n                    </a>\n                </div>,\n            );\n\n            if (this.props.canManageAnyChannelMembersInCurrentTeam && this.props.isInCurrentTeam) {\n                const addToChannelMessage = formatMessage({id: 'user_profile.add_user_to_channel', defaultMessage: 'Add to a Channel'});\n                dataContent.push(\n                    <div\n                        data-toggle='tooltip'\n                        className='popover__row first'\n                        key='user-popover-add-to-channel'\n                    >\n                        <a\n                            href='#'\n                            className='text-nowrap'\n                        >\n                            <ToggleModalButtonRedux\n                                accessibilityLabel={addToChannelMessage}\n                                ref='addUserToChannelModalButton'\n                                modalId={ModalIdentifiers.ADD_USER_TO_CHANNEL}\n                                role='menuitem'\n                                dialogType={AddUserToChannelModal}\n                                dialogProps={{user: this.props.user}}\n                                onClick={this.props.hide}\n                            >\n                                <LocalizedIcon\n                                    className='fa fa-user-plus'\n                                    title={{id: t('user_profile.add_user_to_channel.icon'), defaultMessage: 'Add User to Channel Icon'}}\n                                />\n                                {addToChannelMessage}\n                            </ToggleModalButtonRedux>\n                        </a>\n                    </div>,\n                );\n            }\n        }\n\n        dataContent.push(\n            <Pluggable\n                key='profilePopoverPluggable3'\n                pluggableName='PopoverUserActions'\n                user={this.props.user}\n                hide={this.props.hide}\n                status={this.props.hideStatus ? null : this.props.status}\n            />,\n        );\n\n        let roleTitle;\n        if (this.props.user.is_bot) {\n            roleTitle = <span className='user-popover__role'>{Utils.localizeMessage('bots.is_bot', 'BOT')}</span>;\n        } else if (Utils.isGuest(this.props.user)) {\n            roleTitle = <span className='user-popover__role'>{Utils.localizeMessage('post_info.guest', 'GUEST')}</span>;\n        } else if (Utils.isSystemAdmin(this.props.user.roles)) {\n            roleTitle = <span className='user-popover__role'>{Utils.localizeMessage('admin.permissions.roles.system_admin.name', 'System Admin')}</span>;\n        } else if (this.props.isTeamAdmin) {\n            roleTitle = <span className='user-popover__role'>{Utils.localizeMessage('admin.permissions.roles.team_admin.name', 'Team Admin')}</span>;\n        } else if (this.props.isChannelAdmin) {\n            roleTitle = <span className='user-popover__role'>{Utils.localizeMessage('admin.permissions.roles.channel_admin.name', 'Channel Admin')}</span>;\n        }\n\n        let title = `@${this.props.user.username}`;\n        if (this.props.hasMention) {\n            title = <a onClick={this.handleMentionKeyClick}>{title}</a>;\n        }\n\n        title = (\n            <span data-testid={`profilePopoverTitle_${this.props.user.username}`}>\n                <span className='user-popover__username'>\n                    {title}\n                </span>\n                {roleTitle}\n            </span>\n        );\n\n        return (\n            <Popover\n                {...popoverProps}\n                title={title}\n                id='user-profile-popover'\n            >\n                {dataContent}\n            </Popover>\n        );\n    }\n}\n\ndelete ProfilePopover.propTypes.id;\n\nexport default injectIntl(ProfilePopover);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getCurrentUserId, getStatusForUserId, getUser} from 'mattermost-redux/selectors/entities/users';\nimport {\n    getCurrentTeam,\n    getCurrentRelativeTeamUrl,\n    getTeamMember,\n} from 'mattermost-redux/selectors/entities/teams';\nimport {\n    getCurrentChannel,\n    getChannelMembersInChannels,\n    canManageAnyChannelMembersInCurrentTeam,\n} from 'mattermost-redux/selectors/entities/channels';\n\nimport {openDirectChannelToUserId} from 'actions/channel_actions.jsx';\nimport {getMembershipForCurrentEntities} from 'actions/views/profile_popover';\nimport {openModal} from 'actions/views/modals';\n\nimport {areTimezonesEnabledAndSupported} from 'selectors/general';\nimport {getSelectedPost, getRhsState} from 'selectors/rhs';\n\nimport ProfilePopover from './profile_popover.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    const userId = ownProps.userId;\n    const team = getCurrentTeam(state);\n    const teamMember = getTeamMember(state, team.id, userId);\n\n    let isTeamAdmin = false;\n    if (teamMember && teamMember.scheme_admin) {\n        isTeamAdmin = true;\n    }\n\n    const selectedPost = getSelectedPost(state);\n    const currentChannel = getCurrentChannel(state);\n\n    let channelId;\n    if (selectedPost.exists === false) {\n        channelId = currentChannel.id;\n    } else {\n        channelId = selectedPost.channel_id;\n    }\n\n    const channelMember = getChannelMembersInChannels(state)[channelId][userId];\n\n    let isChannelAdmin = false;\n    if (getRhsState(state) !== 'search' && channelMember != null && channelMember.scheme_admin) {\n        isChannelAdmin = true;\n    }\n\n    return {\n        currentTeamId: team.id,\n        currentUserId: getCurrentUserId(state),\n        enableTimezone: areTimezonesEnabledAndSupported(state),\n        isTeamAdmin,\n        isChannelAdmin,\n        isInCurrentTeam: Boolean(teamMember) && teamMember.delete_at === 0,\n        canManageAnyChannelMembersInCurrentTeam: canManageAnyChannelMembersInCurrentTeam(state),\n        status: getStatusForUserId(state, userId),\n        teamUrl: getCurrentRelativeTeamUrl(state),\n        user: getUser(state, userId),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            openDirectChannelToUserId,\n            openModal,\n            getMembershipForCurrentEntities,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ProfilePopover);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class LatexBlock extends React.Component {\n    static propTypes = {\n        content: PropTypes.string.isRequired,\n        enableLatex: PropTypes.bool.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            katex: null,\n        };\n    }\n\n    componentDidMount() {\n        import('katex').then((katex) => {\n            this.setState({katex});\n        });\n    }\n\n    render() {\n        if (this.state.katex == null || !this.props.enableLatex) {\n            return (\n                <div\n                    className='post-body--code tex'\n                >\n                    {this.props.content}\n                </div>\n            );\n        }\n\n        try {\n            const katexOptions = {\n                throwOnError: false,\n                displayMode: true,\n                maxSize: 200,\n                maxExpand: 100\n            };\n            const html = this.state.katex.renderToString(this.props.content, katexOptions);\n\n            return (\n                <div\n                    className='post-body--code tex'\n                    dangerouslySetInnerHTML={{__html: html}}\n                />\n            );\n        } catch (e) {\n            return (\n                <div\n                    className='post-body--code tex'\n                >\n                    <FormattedMessage\n                        id='katex.error'\n                        defaultMessage=\"Couldn't compile your Latex code. Please review the syntax and try again.\"\n                    />\n                </div>\n            );\n        }\n    }\n}\n\nLatexBlock.defaultProps = {\n    enableLatex: false,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport LatexBlock from './latex_block.jsx';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n    return {\n        enableLatex: config.EnableLatex === 'true',\n    };\n}\n\nexport default connect(mapStateToProps)(LatexBlock);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport Constants from 'utils/constants.jsx';\n\nimport ExternalImage from 'components/external_image';\nimport SizeAwareImage from 'components/size_aware_image';\nimport ViewImageModal from 'components/view_image';\n\nimport brokenImageIcon from 'images/icons/brokenimage.png';\n\nexport default class MarkdownImage extends React.PureComponent {\n    static defaultProps = {\n        imageMetadata: {},\n    };\n\n    static propTypes = {\n        alt: PropTypes.string,\n        imageMetadata: PropTypes.object,\n        src: PropTypes.string.isRequired,\n        height: PropTypes.number,\n        width: PropTypes.number,\n        title: PropTypes.string,\n        className: PropTypes.string.isRequired,\n        postId: PropTypes.string.isRequired,\n        imageIsLink: PropTypes.bool.isRequired,\n        onImageLoaded: PropTypes.func,\n        postType: PropTypes.string,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            showModal: false,\n            loadFailed: false,\n            loaded: false,\n        };\n    }\n\n    showModal = (e) => {\n        if (!this.props.imageIsLink) {\n            e.preventDefault();\n            this.setState({showModal: true});\n        }\n    }\n\n    hideModal = () => {\n        this.setState({showModal: false});\n    }\n\n    handleLoadFail = () => {\n        this.setState({loadFailed: true});\n    }\n\n    isHeaderChangeMessage = () => {\n        return this.props.postType &&\n            this.props.postType === Constants.PostTypes.HEADER_CHANGE;\n    }\n\n    componentDidUpdate(prevProps) {\n        this.onUpdated(prevProps.src);\n    }\n\n    onUpdated = (prevSrc) => {\n        if (this.props.src && this.props.src !== prevSrc) {\n            this.setState({loadFailed: false});\n        }\n    }\n\n    handleImageLoaded = ({height, width}) => {\n        this.setState({\n            loaded: true,\n        }, () => { // Call onImageLoaded prop only after state has already been set\n            if (this.props.onImageLoaded) {\n                this.props.onImageLoaded({height, width});\n            }\n        });\n    }\n\n    render() {\n        const {imageMetadata, src, alt, imageIsLink} = this.props;\n        if (src === '' || this.state.loadFailed) {\n            let className = 'markdown-inline-img broken-image';\n            if (this.isHeaderChangeMessage()) {\n                className += ' broken-image--scaled-down';\n            }\n\n            return (\n                <div style={{display: 'inline-block'}}>\n                    <img\n                        className={className}\n                        alt={alt}\n                        src={brokenImageIcon}\n                    />\n                </div>\n            );\n        }\n        return (\n            <ExternalImage\n                src={src}\n                imageMetadata={imageMetadata}\n            >\n                {(safeSrc) => {\n                    if (!safeSrc) {\n                        return (\n                            <a\n                                className='theme markdown__link'\n                                href={src}\n                                rel='noopener noreferrer'\n                                target='_blank'\n                                title={this.props.title}\n                            >\n                                {alt}\n                            </a>\n                        );\n                    }\n\n                    const getFileExtensionFromUrl = (url) => {\n                        const index = url.lastIndexOf('.');\n                        return index > 0 ? url.substring(index + 1) : null;\n                    };\n                    const extension = getFileExtensionFromUrl(safeSrc);\n\n                    let className = '';\n                    if (this.state.loaded) {\n                        className = imageIsLink || !extension ?\n                            `${this.props.className} markdown-inline-img--hover markdown-inline-img--no-border` :\n                            `${this.props.className} markdown-inline-img--hover cursor--pointer a11y--active`;\n\n                        if (this.isHeaderChangeMessage()) {\n                            className += ' markdown-inline-img--scaled-down';\n                        }\n                    } else {\n                        const loadingClass = this.isHeaderChangeMessage() ?\n                            'markdown-inline-img--scaled-down-loading' : 'markdown-inline-img--loading';\n                        className = `${this.props.className} ${loadingClass}`;\n                    }\n\n                    const {height, width, title} = this.props;\n                    return (\n                        <>\n                            <SizeAwareImage\n                                alt={alt}\n                                className={className}\n                                src={safeSrc}\n                                height={height}\n                                width={width}\n                                title={title}\n                                dimensions={imageMetadata}\n                                showLoader={false}\n                                onClick={this.showModal}\n                                onImageLoadFail={this.handleLoadFail}\n                                onImageLoaded={this.handleImageLoaded}\n                            />\n                            {!imageIsLink && extension &&\n                            <ViewImageModal\n                                show={this.state.showModal}\n                                onModalDismissed={this.hideModal}\n                                postId={this.props.postId}\n                                startIndex={0}\n                                fileInfos={[{\n                                    has_preview_image: false,\n                                    link: safeSrc,\n                                    extension: imageMetadata.format || extension,\n                                    name: alt,\n                                }]}\n                            />\n                            }\n                        </>\n                    );\n                }}\n            </ExternalImage>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {CSSProperties} from 'react';\n\ninterface PostEmojiProps {\n    name: string;\n    imageUrl: string;\n}\ndeclare module 'react' {\n    interface HTMLAttributes<T> extends AriaAttributes, DOMAttributes<T> {\n        alt?: string;\n    }\n}\n\nexport default class PostEmoji extends React.PureComponent<PostEmojiProps, {}> {\n    public render() {\n        const emojiText = ':' + this.props.name + ':';\n\n        if (!this.props.imageUrl) {\n            return emojiText;\n        }\n\n        return (\n            <span\n                alt={emojiText}\n                className='emoticon'\n                title={emojiText}\n                style={{backgroundImage: 'url(' + this.props.imageUrl + ')'}}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getEmojiImageUrl} from 'mattermost-redux/utils/emoji_utils';\n\nimport {getEmojiMap} from 'selectors/emojis';\n\nimport {GlobalState} from 'types/store';\n\nimport PostEmoji from './post_emoji';\n\ntype Props = {\n    name: string;\n};\n\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\n    const emojiMap = getEmojiMap(state);\n    const emoji = emojiMap.get(ownProps.name);\n\n    return {\n        imageUrl: emoji ? getEmojiImageUrl(emoji) : '',\n    };\n}\n\nexport default connect(mapStateToProps)(PostEmoji);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Parser, ProcessNodeDefinitions} from 'html-to-react';\n\nimport AtMention from 'components/at_mention';\nimport LatexBlock from 'components/latex_block';\nimport LinkTooltip from 'components/link_tooltip/link_tooltip';\nimport MarkdownImage from 'components/markdown_image';\nimport PostEmoji from 'components/post_emoji';\n\n/*\n * Converts HTML to React components using html-to-react.\n * The following options can be specified:\n * - mentions - If specified, mentions are replaced with the AtMention component. Defaults to true.\n * - mentionHighlight - If specified, mentions for the current user are highlighted. Defaults to true.\n * - emoji - If specified, emoji text is replaced with the PostEmoji component. Defaults to true.\n * - images - If specified, markdown images are replaced with the image component. Defaults to true.\n * - imageProps - If specified, any extra props that should be passed into the image component.\n * - latex - If specified, latex is replaced with the LatexBlock component. Defaults to true.\n * - imagesMetadata - the dimensions of the image as retrieved from post.metadata.images.\n * - hasPluginTooltips - If specified, the LinkTooltip component is placed inside links. Defaults to false.\n */\nexport function messageHtmlToComponent(html, isRHS, options = {}) {\n    if (!html) {\n        return null;\n    }\n\n    const parser = new Parser();\n    const processNodeDefinitions = new ProcessNodeDefinitions(React);\n\n    function isValidNode() {\n        return true;\n    }\n\n    const processingInstructions = [\n\n        // Workaround to fix MM-14931\n        {\n            replaceChildren: false,\n            shouldProcessNode: (node) => node.type === 'tag' && node.name === 'input' && node.attribs.type === 'checkbox',\n            processNode: (node) => {\n                const attribs = node.attribs || {};\n                node.attribs.checked = Boolean(attribs.checked);\n\n                return React.createElement('input', {...node.attribs});\n            },\n        },\n    ];\n\n    if (options.hasPluginTooltips) {\n        const hrefAttrib = 'href';\n        processingInstructions.push({\n            replaceChildren: true,\n            shouldProcessNode: (node) => node.type === 'tag' && node.name === 'a' && node.attribs[hrefAttrib],\n            processNode: (node, children) => {\n                return (\n                    <LinkTooltip\n                        href={node.attribs[hrefAttrib]}\n                        title={children[0]}\n                    />\n                );\n            },\n        });\n    }\n    if (!('mentions' in options) || options.mentions) {\n        const mentionHighlight = 'mentionHighlight' in options ? options.mentionHighlight : true;\n        const mentionAttrib = 'data-mention';\n        processingInstructions.push({\n            replaceChildren: true,\n            shouldProcessNode: (node) => node.attribs && node.attribs[mentionAttrib],\n            processNode: (node, children) => {\n                const mentionName = node.attribs[mentionAttrib];\n                const callAtMention = (\n                    <AtMention\n                        mentionName={mentionName}\n                        isRHS={isRHS}\n                        hasMention={true}\n                        disableHighlight={!mentionHighlight}\n                    >\n                        {children}\n                    </AtMention>\n                );\n                return callAtMention;\n            },\n        });\n    }\n\n    if (!('emoji' in options) || options.emoji) {\n        const emojiAttrib = 'data-emoticon';\n        processingInstructions.push({\n            replaceChildren: true,\n            shouldProcessNode: (node) => node.attribs && node.attribs[emojiAttrib],\n            processNode: (node) => {\n                const emojiName = node.attribs[emojiAttrib];\n\n                return <PostEmoji name={emojiName}/>;\n            },\n        });\n    }\n\n    if (!('images' in options) || options.images) {\n        processingInstructions.push({\n            shouldProcessNode: (node) => node.type === 'tag' && node.name === 'img',\n            processNode: (node) => {\n                const {\n                    class: className,\n                    ...attribs\n                } = node.attribs;\n\n                const imageIsLink = (parentNode) => {\n                    if (parentNode &&\n                        parentNode.type === 'tag' &&\n                        parentNode.name === 'a'\n                    ) {\n                        return true;\n                    }\n                    return false;\n                };\n\n                return (\n                    <MarkdownImage\n                        className={className}\n                        imageMetadata={options.imagesMetadata && options.imagesMetadata[attribs.src]}\n                        {...attribs}\n                        {...options.imageProps}\n                        postId={options.postId}\n                        imageIsLink={imageIsLink(node.parentNode)}\n                        postType={options.postType}\n                    />\n                );\n            },\n        });\n    }\n\n    if (!('latex' in options) || options.latex) {\n        processingInstructions.push({\n            shouldProcessNode: (node) => node.attribs && node.attribs['data-latex'],\n            processNode: (node) => {\n                return (\n                    <LatexBlock content={node.attribs['data-latex']}/>\n                );\n            },\n        });\n    }\n\n    processingInstructions.push({\n        shouldProcessNode: () => true,\n        processNode: processNodeDefinitions.processDefaultNode,\n    });\n\n    return parser.parseWithInstructions(html, isValidNode, processingInstructions);\n}\n\nexport default messageHtmlToComponent;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\n\nimport * as ServerVersion from 'utils/server_version';\nimport * as UserAgent from 'utils/user_agent';\n\nimport mattermostIcon from 'images/icon50x50.png';\n\n// Notices are objects with the following fields:\n//  - name - string identifier\n//  - adminOnly - set to true if only system admins should see this message\n//  - icon - the image to display for the notice icon\n//  - title - JSX node to display for the notice title\n//  - body - JSX node to display for the notice body\n//  - allowForget - boolean to allow forget the notice\n//  - show - function that check if we need to show the notice\n//\n// Order is important! The notices at the top are shown first.\nexport default [\n    {\n        name: 'apiv3_deprecation',\n        adminOnly: true,\n        title: (\n            <FormattedMarkdownMessage\n                id='system_notice.title'\n                defaultMessage='**Notice**\\nfrom Mattermost'\n            />\n        ),\n        icon: mattermostIcon,\n        body: (\n            <FormattedMarkdownMessage\n                id='system_notice.body.api3'\n                defaultMessage='If youve created or installed integrations in the last two years, find out how [recent changes](!https://about.mattermost.com/default-apiv3-deprecation-guide) may have affected them.'\n            />\n        ),\n        allowForget: true,\n        show: (serverVersion, config) => {\n            if (config.InstallationDate >= new Date(2018, 5, 16, 0, 0, 0, 0).getTime()) {\n                return false;\n            }\n            return true;\n        },\n    },\n    {\n        name: 'advanced_permissions',\n        adminOnly: true,\n        title: (\n            <FormattedMarkdownMessage\n                id='system_notice.title'\n                defaultMessage='**Notice**\\nfrom Mattermost'\n            />\n        ),\n        icon: mattermostIcon,\n        body: (\n            <FormattedMarkdownMessage\n                id='system_notice.body.permissions'\n                defaultMessage='Some policy and permission System Console settings have moved with the release of [advanced permissions](!https://about.mattermost.com/default-advanced-permissions) in Enterprise E10 and E20.'\n            />\n        ),\n        allowForget: true,\n        show: (serverVersion, config, license) => {\n            if (license.IsLicensed === 'false') {\n                return false;\n            }\n            if (config.InstallationDate > new Date(2018, 5, 16, 0, 0, 0, 0).getTime()) {\n                return false;\n            }\n            if (license.IsLicensed === 'true' && license.IssuedAt > new Date(2018, 5, 16, 0, 0, 0, 0).getTime()) {\n                return false;\n            }\n            return true;\n        },\n    },\n    {\n        name: 'ee_upgrade_advice',\n        adminOnly: true,\n        title: (\n            <FormattedMarkdownMessage\n                id='system_notice.title'\n                defaultMessage='**Notice**\\nfrom Mattermost'\n            />\n        ),\n        icon: mattermostIcon,\n        body: (\n            <FormattedMarkdownMessage\n                id='system_notice.body.ee_upgrade_advice'\n                defaultMessage='Enterprise Edition is recommended to ensure optimal operation and reliability. [Learn more](!https://mattermost.com/performance).'\n            />\n        ),\n        allowForget: false,\n        show: (serverVersion, config, license, analytics) => {\n            const USERS_THRESHOLD = 10000;\n\n            // If we don't have the analytics yet, don't show\n            if (!analytics.hasOwnProperty('TOTAL_USERS')) {\n                return false;\n            }\n\n            if (analytics.TOTAL_USERS < USERS_THRESHOLD) {\n                return false;\n            }\n\n            if (license.IsLicensed === 'true' && license.Cluster === 'true') {\n                return false;\n            }\n\n            return true;\n        },\n    },\n    {\n        name: 'ie11_deprecation',\n        title: (\n            <FormattedMarkdownMessage\n                id='system_notice.title'\n                defaultMessage='**Notice**\\nfrom Mattermost'\n            />\n        ),\n        icon: mattermostIcon,\n        allowForget: false,\n        body: (\n            <FormattedMarkdownMessage\n                id='system_notice.body.ie11_deprecation'\n                defaultMessage='Your browser, IE11, will no longer be supported in an upcoming release. [Find out how to move to another browser in one simple step](!https://forum.mattermost.org/t/mattermost-is-dropping-support-for-internet-explorer-ie11-in-v5-16/7575).'\n            />\n        ),\n        show: (serverVersion) => {\n            // Don't show the notice after v5.16, show a different notice\n            if (ServerVersion.isServerVersionGreaterThanOrEqualTo(serverVersion, '5.16.0')) {\n                return false;\n            }\n\n            // Only show if they're using IE\n            if (!UserAgent.isInternetExplorer()) {\n                return false;\n            }\n\n            return true;\n        },\n    },\n];\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {FormattedMessage} from 'react-intl';\n\nimport {Preferences} from 'utils/constants';\nimport {t} from 'utils/i18n';\nimport LocalizedIcon from 'components/localized_icon';\nimport MattermostLogo from 'components/widgets/icons/mattermost_logo';\n\nexport default class SystemNotice extends React.PureComponent {\n    static propTypes = {\n        currentUserId: PropTypes.string.isRequired,\n        notices: PropTypes.arrayOf(PropTypes.object).isRequired,\n        preferences: PropTypes.object.isRequired,\n        dismissedNotices: PropTypes.object.isRequired,\n        isSystemAdmin: PropTypes.bool,\n        serverVersion: PropTypes.string.isRequired,\n        config: PropTypes.object.isRequired,\n        license: PropTypes.object.isRequired,\n        analytics: PropTypes.object,\n        actions: PropTypes.shape({\n            savePreferences: PropTypes.func.isRequired,\n            dismissNotice: PropTypes.func.isRequired,\n            getStandardAnalytics: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    componentDidMount() {\n        if (this.props.isSystemAdmin) {\n            this.props.actions.getStandardAnalytics();\n        }\n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.isSystemAdmin !== this.props.isSystemAdmin && this.props.isSystemAdmin) {\n            this.props.actions.getStandardAnalytics();\n        }\n    }\n\n    getCurrentNotice = () => {\n        for (const notice of this.props.notices) {\n            // Skip if dismissed previously this session\n            if (this.props.dismissedNotices[notice.name]) {\n                continue;\n            }\n\n            // Skip if dismissed forever\n            if (this.props.preferences[notice.name]) {\n                continue;\n            }\n\n            if (notice.adminOnly && !this.props.isSystemAdmin) {\n                continue;\n            }\n\n            if (!notice.show(this.props.serverVersion, this.props.config, this.props.license, this.props.analytics)) {\n                continue;\n            }\n\n            return notice;\n        }\n        return null;\n    }\n\n    hide = (remind = false) => {\n        const notice = this.getCurrentNotice();\n        if (!notice) {\n            return;\n        }\n\n        if (!remind) {\n            this.props.actions.savePreferences(this.props.currentUserId, [{\n                user_id: this.props.currentUserId,\n                category: Preferences.CATEGORY_SYSTEM_NOTICE,\n                name: notice.name,\n                value: 'dismissed',\n            }]);\n        }\n\n        this.props.actions.dismissNotice(notice.name);\n    }\n\n    hideAndRemind = () => {\n        this.hide(true);\n    }\n\n    hideAndForget = () => {\n        this.hide(false);\n    }\n\n    render() {\n        const notice = this.getCurrentNotice();\n\n        if (notice == null) {\n            return null;\n        }\n\n        let visibleMessage;\n        if (notice.adminOnly) {\n            visibleMessage = (\n                <div className='system-notice__info'>\n                    <LocalizedIcon\n                        className='fa fa-eye'\n                        title={{id: t('system_notice.adminVisible.icon'), defaultMessage: 'Only visible to System Admins Icon'}}\n                    />\n                    <FormattedMessage\n                        id='system_notice.adminVisible'\n                        defaultMessage='Only visible to System Admins'\n                    />\n                </div>\n            );\n        }\n\n        return (\n            <div\n                className='system-notice bg--white shadow--2'\n            >\n                <div className='system-notice__header'>\n                    <div className='system-notice__logo'>\n                        <MattermostLogo/>\n                    </div>\n                    <div className='system-notice__title'>\n                        {notice.title}\n                    </div>\n                </div>\n                <div className='system-notice__body'>\n                    {notice.body}\n                </div>\n                {visibleMessage}\n                <div className='system-notice__footer'>\n                    <button\n                        id='systemnotice_remindme'\n                        className='btn btn-transparent'\n                        onClick={this.hideAndRemind}\n                    >\n                        <FormattedMessage\n                            id='system_notice.remind_me'\n                            defaultMessage='Remind Me Later'\n                        />\n                    </button>\n                    {notice.allowForget &&\n                        <button\n                            id='systemnotice_dontshow'\n                            className='btn btn-transparent'\n                            onClick={this.hideAndForget}\n                        >\n                            <FormattedMessage\n                                id='system_notice.dont_show'\n                                defaultMessage=\"Don't Show Again\"\n                            />\n                        </button>}\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {createSelector} from 'reselect';\nimport {bindActionCreators} from 'redux';\nimport {makeGetCategory} from 'mattermost-redux/selectors/entities/preferences';\nimport {getConfig, getLicense} from 'mattermost-redux/selectors/entities/general';\nimport {haveISystemPermission} from 'mattermost-redux/selectors/entities/roles';\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\nimport {Permissions} from 'mattermost-redux/constants';\nimport {getStandardAnalytics} from 'mattermost-redux/actions/admin';\n\nimport {Preferences} from 'utils/constants';\n\nimport {dismissNotice} from 'actions/views/notice';\n\nimport Notices from './notices.jsx';\nimport SystemNotice from './system_notice.jsx';\n\nfunction makeMapStateToProps() {\n    const getCategory = makeGetCategory();\n\n    const getPreferenceNameMap = createSelector(\n        getCategory,\n        (preferences) => {\n            const nameMap = {};\n            preferences.forEach((p) => {\n                nameMap[p.name] = p;\n            });\n            return nameMap;\n        }\n    );\n\n    return function mapStateToProps(state) {\n        const license = getLicense(state);\n        const config = getConfig(state);\n        const serverVersion = state.entities.general.serverVersion;\n        const analytics = state.entities.admin.analytics;\n\n        return {\n            currentUserId: state.entities.users.currentUserId,\n            preferences: getPreferenceNameMap(state, Preferences.CATEGORY_SYSTEM_NOTICE),\n            dismissedNotices: state.views.notice.hasBeenDismissed,\n            isSystemAdmin: haveISystemPermission(state, {permission: Permissions.MANAGE_SYSTEM}),\n            notices: Notices,\n            config,\n            license,\n            serverVersion,\n            analytics,\n        };\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            savePreferences,\n            dismissNotice,\n            getStandardAnalytics,\n        }, dispatch),\n    };\n}\n\nexport default connect(makeMapStateToProps, mapDispatchToProps)(SystemNotice);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport WebSocketClient from './websocket_client.jsx';\n\nvar WebClient = new WebSocketClient();\nexport default WebClient;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nconst MAX_WEBSOCKET_FAILS = 7;\nconst MIN_WEBSOCKET_RETRY_TIME = 3000; // 3 sec\nconst MAX_WEBSOCKET_RETRY_TIME = 300000; // 5 mins\n\nexport default class WebSocketClient {\n    constructor() {\n        this.conn = null;\n        this.connectionUrl = null;\n        this.sequence = 1;\n        this.eventSequence = 0;\n        this.connectFailCount = 0;\n        this.eventCallback = null;\n        this.responseCallbacks = {};\n        this.firstConnectCallback = null;\n        this.reconnectCallback = null;\n        this.missedEventCallback = null;\n        this.errorCallback = null;\n        this.closeCallback = null;\n    }\n\n    initialize(connectionUrl = this.connectionUrl, token) {\n        if (this.conn) {\n            return;\n        }\n\n        if (connectionUrl == null) {\n            console.log('websocket must have connection url'); //eslint-disable-line no-console\n            return;\n        }\n\n        if (this.connectFailCount === 0) {\n            console.log('websocket connecting to ' + connectionUrl); //eslint-disable-line no-console\n        }\n\n        this.conn = new WebSocket(connectionUrl);\n        this.connectionUrl = connectionUrl;\n\n        this.conn.onopen = () => {\n            this.eventSequence = 0;\n\n            if (token) {\n                this.sendMessage('authentication_challenge', {token});\n            }\n\n            if (this.connectFailCount > 0) {\n                console.log('websocket re-established connection'); //eslint-disable-line no-console\n                if (this.reconnectCallback) {\n                    this.reconnectCallback();\n                }\n            } else if (this.firstConnectCallback) {\n                this.firstConnectCallback();\n            }\n\n            this.connectFailCount = 0;\n        };\n\n        this.conn.onclose = () => {\n            this.conn = null;\n            this.sequence = 1;\n\n            if (this.connectFailCount === 0) {\n                console.log('websocket closed'); //eslint-disable-line no-console\n            }\n\n            this.connectFailCount++;\n\n            if (this.closeCallback) {\n                this.closeCallback(this.connectFailCount);\n            }\n\n            let retryTime = MIN_WEBSOCKET_RETRY_TIME;\n\n            // If we've failed a bunch of connections then start backing off\n            if (this.connectFailCount > MAX_WEBSOCKET_FAILS) {\n                retryTime = MIN_WEBSOCKET_RETRY_TIME * this.connectFailCount * this.connectFailCount;\n                if (retryTime > MAX_WEBSOCKET_RETRY_TIME) {\n                    retryTime = MAX_WEBSOCKET_RETRY_TIME;\n                }\n            }\n\n            setTimeout(\n                () => {\n                    this.initialize(connectionUrl, token);\n                },\n                retryTime\n            );\n        };\n\n        this.conn.onerror = (evt) => {\n            if (this.connectFailCount <= 1) {\n                console.log('websocket error'); //eslint-disable-line no-console\n                console.log(evt); //eslint-disable-line no-console\n            }\n\n            if (this.errorCallback) {\n                this.errorCallback(evt);\n            }\n        };\n\n        this.conn.onmessage = (evt) => {\n            const msg = JSON.parse(evt.data);\n            if (msg.seq_reply) {\n                if (msg.error) {\n                    console.log(msg); //eslint-disable-line no-console\n                }\n\n                if (this.responseCallbacks[msg.seq_reply]) {\n                    this.responseCallbacks[msg.seq_reply](msg);\n                    Reflect.deleteProperty(this.responseCallbacks, msg.seq_reply);\n                }\n            } else if (this.eventCallback) {\n                if (msg.seq !== this.eventSequence && this.missedEventCallback) {\n                    console.log('missed websocket event, act_seq=' + msg.seq + ' exp_seq=' + this.eventSequence); //eslint-disable-line no-console\n                    this.missedEventCallback();\n                }\n                this.eventSequence = msg.seq + 1;\n                this.eventCallback(msg);\n            }\n        };\n    }\n\n    setEventCallback(callback) {\n        this.eventCallback = callback;\n    }\n\n    setFirstConnectCallback(callback) {\n        this.firstConnectCallback = callback;\n    }\n\n    setReconnectCallback(callback) {\n        this.reconnectCallback = callback;\n    }\n\n    setMissedEventCallback(callback) {\n        this.missedEventCallback = callback;\n    }\n\n    setErrorCallback(callback) {\n        this.errorCallback = callback;\n    }\n\n    setCloseCallback(callback) {\n        this.closeCallback = callback;\n    }\n\n    close() {\n        this.connectFailCount = 0;\n        this.sequence = 1;\n        if (this.conn && this.conn.readyState === WebSocket.OPEN) {\n            this.conn.onclose = () => {}; //eslint-disable-line no-empty-function\n            this.conn.close();\n            this.conn = null;\n            console.log('websocket closed'); //eslint-disable-line no-console\n        }\n    }\n\n    sendMessage(action, data, responseCallback) {\n        const msg = {\n            action,\n            seq: this.sequence++,\n            data,\n        };\n\n        if (responseCallback) {\n            this.responseCallbacks[msg.seq] = responseCallback;\n        }\n\n        if (this.conn && this.conn.readyState === WebSocket.OPEN) {\n            this.conn.send(JSON.stringify(msg));\n        } else if (!this.conn || this.conn.readyState === WebSocket.CLOSED) {\n            this.conn = null;\n            this.initialize();\n        }\n    }\n\n    userTyping(channelId, parentId, callback) {\n        const data = {};\n        data.channel_id = channelId;\n        data.parent_id = parentId;\n\n        this.sendMessage('user_typing', data, callback);\n    }\n\n    userUpdateActiveStatus(userIsActive, manual, callback) {\n        const data = {\n            user_is_active: userIsActive,\n            manual,\n        };\n        this.sendMessage('user_update_active_status', data, callback);\n    }\n\n    getStatuses(callback) {\n        this.sendMessage('get_statuses', null, callback);\n    }\n\n    getStatusesByIds(userIds, callback) {\n        const data = {};\n        data.user_ids = userIds;\n        this.sendMessage('get_statuses_by_ids', data, callback);\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {injectIntl} from 'react-intl';\nimport moment from 'moment-timezone';\n\n// Feature test the browser for support of hourCycle.\n// Note that ResolvedDateTimeFormatOptions doesn't yet support hourCycle.\n// See https://github.com/microsoft/TypeScript/issues/34399\nconst supportsHourCycle = Boolean(((new Intl.DateTimeFormat('en-US', {hour: 'numeric'})).resolvedOptions() as {hourCycle?: string}).hourCycle);\n\ntype Props = {\n\n    /*\n     * The time to display\n     */\n    eventTime?: number;\n\n    /*\n     * Set to display using 24 hour format\n     */\n    useMilitaryTime?: boolean;\n\n    /*\n     * Current timezone of the user\n     */\n    timeZone?: string | null | undefined;\n\n    /*\n     * Enable timezone feature\n     */\n    enableTimezone?: boolean;\n\n    intl: any; // TODO This needs to be replaced with IntlShape once react-intl is upgraded\n}\n\nclass LocalDateTime extends React.PureComponent<Props> {\n    public render() {\n        const {\n            enableTimezone,\n            eventTime,\n            timeZone,\n            useMilitaryTime,\n        } = this.props;\n\n        const date = eventTime ? new Date(eventTime) : new Date();\n\n        const momentDate = moment(date);\n        let titleString = momentDate.toString();\n        if (enableTimezone && timeZone) {\n            momentDate.tz(timeZone);\n            titleString = momentDate.toString() + ' (' + momentDate.tz() + ')';\n        }\n\n        // Ideally, we'd use Intl.DateTimeFormatOptions, but hourCycle is not yet supported.\n        // See https://github.com/microsoft/TypeScript/issues/34399\n        const options: {\n            hour?: string;\n            minute?: string;\n            timeZone?: string;\n            hourCycle?: string;\n            hour12?: boolean;\n        } = {\n            hour: 'numeric',\n            minute: 'numeric',\n        };\n        if (enableTimezone && timeZone) {\n            options.timeZone = timeZone;\n        }\n        if (supportsHourCycle) {\n            if (useMilitaryTime) {\n                options.hourCycle = 'h23';\n            } else {\n                options.hourCycle = 'h12';\n            }\n        } else {\n            options.hour12 = !useMilitaryTime;\n        }\n\n        let formattedTime;\n        try {\n            formattedTime = (new Intl.DateTimeFormat(this.props.intl.locale, options)).format(date);\n        } catch {\n            // Fallback to Moment.js as a default rendering strategy for unsupported timezones.\n            const format = useMilitaryTime ? 'HH:mm' : 'hh:mm A';\n            formattedTime = momentDate.format(format);\n        }\n\n        return (\n            <time\n                aria-label={date.toString()}\n                className='post__time'\n                dateTime={date.toISOString()}\n                title={titleString}\n            >\n                <span>{formattedTime}</span>\n            </time>\n        );\n    }\n}\n\nexport default injectIntl(LocalDateTime);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getUserTimezone} from 'mattermost-redux/selectors/entities/timezone';\nimport {getUserCurrentTimezone} from 'mattermost-redux/utils/timezone_utils';\nimport {getBool} from 'mattermost-redux/selectors/entities/preferences';\nimport {UserTimezone} from 'mattermost-redux/types/users';\n\nimport {areTimezonesEnabledAndSupported} from 'selectors/general';\n\nimport {GlobalState} from 'types/store';\n\nimport {Preferences} from 'utils/constants';\n\nimport LocalDateTime from './local_date_time';\n\ntype Props = {\n    userTimezone: UserTimezone;\n};\n\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\n    const currentUserId = getCurrentUserId(state);\n\n    let userTimezone;\n    if (ownProps.userTimezone) {\n        userTimezone = ownProps.userTimezone;\n    } else {\n        userTimezone = getUserTimezone(state, currentUserId);\n    }\n\n    return {\n        enableTimezone: areTimezonesEnabledAndSupported(state),\n        useMilitaryTime: getBool(state, Preferences.CATEGORY_DISPLAY_SETTINGS, Preferences.USE_MILITARY_TIME, false),\n        timeZone: getUserCurrentTimezone(userTimezone),\n    };\n}\n\nexport default connect(mapStateToProps)(LocalDateTime);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport const getLastPostsApiTimeForChannel = (state, channelId) => state.views.channel.lastGetPosts[channelId];\nexport const getToastStatus = (state) => state.views.channel.toastStatus;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport const getSocketStatus = (state) => state.websocket;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport Provider from './provider.jsx';\nimport Suggestion from './suggestion.jsx';\n\nclass MenuActionSuggestion extends Suggestion {\n    render() {\n        const {item, isSelection} = this.props;\n\n        let className = 'mentions__name';\n        if (isSelection) {\n            className += ' suggestion--selected';\n        }\n\n        return (\n            <div\n                className={className}\n                onClick={this.handleClick}\n                onMouseMove={this.handleMouseMove}\n                {...Suggestion.baseProps}\n            >\n                {item.text}\n            </div>\n        );\n    }\n}\n\nexport default class MenuActionProvider extends Provider {\n    constructor(options) {\n        super();\n        this.options = options;\n    }\n\n    handlePretextChanged(prefix, resultsCallback) {\n        if (prefix.length === 0) {\n            this.displayAllOptions(resultsCallback);\n            return true;\n        }\n\n        if (prefix) {\n            this.filterOptions(prefix, resultsCallback);\n            return true;\n        }\n\n        return false;\n    }\n\n    async displayAllOptions(resultsCallback) {\n        const terms = this.options.map((option) => option.text);\n\n        resultsCallback({\n            matchedPretext: '',\n            terms,\n            items: this.options,\n            component: MenuActionSuggestion,\n        });\n    }\n\n    async filterOptions(prefix, resultsCallback) {\n        const filteredOptions = this.options.filter((option) => option.text.toLowerCase().indexOf(prefix) >= 0);\n        const terms = filteredOptions.map((option) => option.text);\n\n        resultsCallback({\n            matchedPretext: prefix,\n            terms,\n            items: filteredOptions,\n            component: MenuActionSuggestion,\n        });\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport Provider from './provider.jsx';\nimport Suggestion from './suggestion.jsx';\n\nclass ChannelSuggestion extends Suggestion {\n    render() {\n        const isSelection = this.props.isSelection;\n        const item = this.props.item;\n\n        const channelName = item.display_name;\n        const purpose = item.purpose;\n\n        let className = 'mentions__name no-flex';\n        if (isSelection) {\n            className += ' suggestion--selected';\n        }\n\n        const description = '(~' + item.name + ')';\n\n        return (\n            <div\n                className={className}\n                onClick={this.handleClick}\n                onMouseMove={this.handleMouseMove}\n                {...Suggestion.baseProps}\n            >\n                <div className='mention__align'>\n                    <span>\n                        {channelName}\n                    </span>\n                    <span className='mention__channelname'>\n                        {' '}\n                        {description}\n                    </span>\n                </div>\n                <div className='mention__purpose'>\n                    {purpose}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default class ChannelProvider extends Provider {\n    constructor(channelSearchFunc) {\n        super();\n\n        this.autocompleteChannels = channelSearchFunc;\n    }\n\n    handlePretextChanged(pretext, resultsCallback) {\n        const normalizedPretext = pretext.toLowerCase();\n        this.startNewRequest(normalizedPretext);\n\n        this.autocompleteChannels(\n            normalizedPretext,\n            (data) => {\n                if (this.shouldCancelDispatch(normalizedPretext)) {\n                    return;\n                }\n\n                const channels = Object.assign([], data);\n\n                resultsCallback({\n                    matchedPretext: normalizedPretext,\n                    terms: channels.map((channel) => channel.display_name),\n                    items: channels,\n                    component: ChannelSuggestion,\n                });\n            }\n        );\n\n        return true;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport Setting from './setting';\n\ntype InputTypes = 'input' | 'textarea' | 'number' | 'email' | 'tel' | 'url' | 'password'\n\nexport type WidgetTextSettingProps = {\n    id: string;\n    label: React.ReactNode;\n    labelClassName: string;\n    placeholder?: string;\n    helpText?: React.ReactNode;\n    footer?: React.ReactNode;\n    value: string | number;\n    inputClassName: string;\n    maxLength: number;\n    resizable: boolean;\n    onChange(name: string, value: any): void;\n    disabled?: boolean;\n    type: InputTypes;\n}\n\n// Since handle change is read from input and textarea element\ntype HandleChangeTypes = React.ChangeEventHandler<HTMLInputElement | HTMLTextAreaElement>\n\nexport default class TextSetting extends React.Component<WidgetTextSettingProps> {\n    public static validTypes: string[] = ['input', 'textarea', 'number', 'email', 'tel', 'url', 'password'];\n\n    public static defaultProps: Partial<WidgetTextSettingProps> = {\n        labelClassName: '',\n        inputClassName: '',\n        type: 'input',\n        maxLength: -1, // A negative number allows for values of any length\n        resizable: true,\n    };\n\n    private handleChange: HandleChangeTypes = (e) => {\n        if (this.props.type === 'number') {\n            this.props.onChange(this.props.id, parseInt(e.target.value, 10));\n        } else {\n            this.props.onChange(this.props.id, e.target.value);\n        }\n    }\n\n    public render(): JSX.Element {\n        const {resizable} = this.props;\n        let {type} = this.props;\n        let input = null;\n\n        if (type === 'textarea') {\n            let style = {};\n            if (!resizable) {\n                style = Object.assign({}, {resize: 'none'});\n            }\n\n            input = (\n                <textarea\n                    data-testid={this.props.id + 'input'}\n                    id={this.props.id}\n                    style={style}\n                    className='form-control'\n                    rows={5}\n                    placeholder={this.props.placeholder}\n                    value={this.props.value}\n                    maxLength={this.props.maxLength}\n                    onChange={this.handleChange}\n                    disabled={this.props.disabled}\n                />\n            );\n        } else {\n            type = ['input', 'email', 'tel', 'number', 'url', 'password'].includes(type) ? type : 'input';\n\n            input = (\n                <input\n                    data-testid={this.props.id + type}\n                    id={this.props.id}\n                    className='form-control'\n                    type={type}\n                    placeholder={this.props.placeholder}\n                    value={this.props.value}\n                    maxLength={this.props.maxLength}\n                    onChange={this.handleChange}\n                    disabled={this.props.disabled}\n                />\n            );\n        }\n\n        return (\n            <Setting\n                label={this.props.label}\n                labelClassName={this.props.labelClassName}\n                inputClassName={this.props.inputClassName}\n                helpText={this.props.helpText}\n                inputId={this.props.id}\n                footer={this.props.footer}\n            >\n                {input}\n            </Setting>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport SuggestionBox from 'components/suggestion/suggestion_box.jsx';\nimport SuggestionList from 'components/suggestion/suggestion_list';\n\nexport default class AutocompleteSelector extends React.PureComponent {\n    static propTypes = {\n        providers: PropTypes.array.isRequired,\n        value: PropTypes.string.isRequired,\n        onSelected: PropTypes.func,\n        label: PropTypes.node,\n        labelClassName: PropTypes.string,\n        inputClassName: PropTypes.string,\n        helpText: PropTypes.node,\n        placeholder: PropTypes.string,\n        footer: PropTypes.node,\n        disabled: PropTypes.bool,\n        toggleFocus: PropTypes.func,\n        listComponent: PropTypes.elementType,\n        listStyle: PropTypes.string,\n    };\n\n    static defaultProps = {\n        value: '',\n        id: '',\n        labelClassName: '',\n        inputClassName: '',\n        listComponent: SuggestionList,\n        listStyle: 'top',\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            input: '',\n        };\n    }\n\n    onChange = (e) => {\n        if (!e || !e.target) {\n            return;\n        }\n\n        this.setState({input: e.target.value});\n    }\n\n    handleSelected = (selected) => {\n        this.setState({input: ''});\n\n        if (this.props.onSelected) {\n            this.props.onSelected(selected);\n        }\n\n        requestAnimationFrame(() => {\n            if (this.suggestionRef) {\n                this.suggestionRef.blur();\n            }\n        });\n    }\n\n    setSuggestionRef = (ref) => {\n        this.suggestionRef = ref;\n    }\n\n    onFocus = () => {\n        this.setState({focused: true});\n\n        if (this.props.toggleFocus) {\n            this.props.toggleFocus(true);\n        }\n    }\n\n    onBlur = () => {\n        this.setState({focused: false});\n\n        if (this.props.toggleFocus) {\n            this.props.toggleFocus(false);\n        }\n    }\n\n    render() {\n        const {\n            providers,\n            placeholder,\n            footer,\n            label,\n            labelClassName,\n            helpText,\n            inputClassName,\n            value,\n            disabled,\n            listComponent,\n            listStyle,\n        } = this.props;\n\n        const {focused} = this.state;\n        let {input} = this.state;\n\n        if (!focused) {\n            input = value;\n        }\n\n        let labelContent;\n        if (label) {\n            labelContent = (\n                <label\n                    className={'control-label ' + labelClassName}\n                >\n                    {label}\n                </label>\n            );\n        }\n\n        let helpTextContent;\n        if (helpText) {\n            helpTextContent = (\n                <div className='help-text'>\n                    {helpText}\n                </div>\n            );\n        }\n\n        return (\n            <div\n                data-testid='autoCompleteSelector'\n                className='form-group'\n            >\n                {labelContent}\n                <div className={inputClassName}>\n                    <SuggestionBox\n                        placeholder={placeholder}\n                        ref={this.setSuggestionRef}\n                        listComponent={listComponent}\n                        className='form-control'\n                        containerClass='select-suggestion-container'\n                        value={input}\n                        onChange={this.onChange}\n                        onItemSelected={this.handleSelected}\n                        onFocus={this.onFocus}\n                        onBlur={this.onBlur}\n                        providers={providers}\n                        completeOnTab={true}\n                        renderDividers={false}\n                        renderNoResults={true}\n                        openOnFocus={true}\n                        openWhenEmpty={true}\n                        replaceAllInputOnSelect={true}\n                        disabled={disabled}\n                        listStyle={listStyle}\n                    />\n                    {helpTextContent}\n                    {footer}\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport function popOverOverlayPosition(\n    targetBounds: DOMRect,\n    innerHeight: number,\n    spaceRequiredAbove: number,\n    spaceRequiredBelow?: number\n): string {\n    let placement: string;\n\n    if (targetBounds.top > spaceRequiredAbove) {\n        placement = 'top';\n    } else if (innerHeight - targetBounds.bottom > (spaceRequiredBelow || spaceRequiredAbove)) {\n        placement = 'bottom';\n    } else {\n        placement = 'left';\n    }\n    return placement;\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\n\ntype Props = {\n    loading?: string;\n    progress?: number;\n    containerClass?: string;\n}\n\nconst LoadingImagePreview: React.FC<Props> = ({loading, progress, containerClass}: Props) => {\n    let progressView: JSX.Element = (\n        <span className='loader-percent'/>\n    );\n\n    if (progress) {\n        progressView = (\n            <span className='loader-percent'>\n                {`${loading} ${progress}%`}\n            </span>\n        );\n    }\n\n    return (\n        <div className={containerClass}>\n            <LoadingSpinner/>\n            {progressView}\n        </div>\n    );\n};\n\nLoadingImagePreview.defaultProps = {\n    containerClass: 'view-image__loading',\n};\n\nexport default LoadingImagePreview;","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {ErrorPageTypes} from 'utils/constants';\nimport {isGuest} from 'utils/utils.jsx';\n\nexport function importComponentSuccess(callback) {\n    return (comp) => callback(null, comp.default);\n}\n\nexport function createGetChildComponentsFunction(arrayOfComponents) {\n    return (locaiton, callback) => callback(null, arrayOfComponents);\n}\n\nexport const notFoundParams = {\n    type: ErrorPageTypes.PAGE_NOT_FOUND,\n};\n\nconst mfaPaths = [\n    '/mfa/setup',\n    '/mfa/confirm',\n];\n\nconst mfaAuthServices = [\n    '',\n    'email',\n    'ldap',\n];\n\nexport function checkIfMFARequired(user, license, config, path) {\n    if (license.MFA === 'true' &&\n            config.EnableMultifactorAuthentication === 'true' &&\n            config.EnforceMultifactorAuthentication === 'true' &&\n            mfaPaths.indexOf(path) === -1) {\n        if (isGuest(user) && config.GuestAccountsEnforceMultifactorAuthentication !== 'true') {\n            return false;\n        }\n\n        if (user && !user.mfa_active &&\n                mfaAuthServices.indexOf(user.auth_service) !== -1) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport function getAnnouncementBarCount(state) {\n    return state.views.announcementBar.announcementBarState.announcementBarCount;\n}","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\n/**\n * Compare server versions, ignoring the configuration hash and licensed status.\n *\n * For example, the following two server versions are considered equal:\n *     4.7.1.dev.3034fbc5fd566195d1b53e03890e35ff.true\n *     4.7.1.dev.d131dd02c5e6eec4693d9a0698aff95c.false\n *\n * but the following two are not\n *     4.7.0.dev.3034fbc5fd566195d1b53e03890e35ff.true\n *     4.7.1.dev.d131dd02c5e6eec4693d9a0698aff95c.true\n */\nexport function equalServerVersions(a: string, b: string): boolean {\n    if (a === b) {\n        return true;\n    }\n\n    const ignoredComponents = 2;\n    const aIgnoringComponents = (a || '').split('.').slice(0, -ignoredComponents).join('.');\n    const bIgnoringComponents = (b || '').split('.').slice(0, -ignoredComponents).join('.');\n    if (aIgnoringComponents === bIgnoringComponents) {\n        return true;\n    }\n\n    return false;\n}\n\n/**\n * Boolean function to check if a server version is greater than another.\n *\n * currentVersion: The server version being checked\n * compareVersion: The version to compare the former version against\n *\n * eg.  currentVersion = 4.16.0, compareVersion = 4.17.0 returns false\n *      currentVersion = 4.16.1, compareVersion = 4.16.1 returns true\n */\nexport function isServerVersionGreaterThanOrEqualTo(currentVersion: string, compareVersion: string): boolean {\n    if (currentVersion === compareVersion) {\n        return true;\n    }\n\n    // We only care about the numbers\n    const currentVersionNumber = (currentVersion || '').split('.').filter((x) => (/^[0-9]+$/).exec(x) !== null);\n    const compareVersionNumber = (compareVersion || '').split('.').filter((x) => (/^[0-9]+$/).exec(x) !== null);\n\n    for (let i = 0; i < Math.max(currentVersionNumber.length, compareVersionNumber.length); i++) {\n        if ((currentVersionNumber[i] || 0) > (compareVersionNumber[i] || 0)) {\n            return true;\n        }\n\n        if ((currentVersionNumber[i] || 0) < (compareVersionNumber[i] || 0)) {\n            return false;\n        }\n    }\n\n    // If all components are equal, then return true\n    return true;\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {ChangeEvent, FormEvent, CSSProperties} from 'react';\n\ntype Props = {\n    id?: string;\n    disabled?: boolean;\n    value?: string;\n    defaultValue?: string;\n    onChange?: (e: ChangeEvent<HTMLTextAreaElement>) => void;\n    onHeightChange?: (height: number, maxHeight: number) => void;\n    onInput?: (e: FormEvent<HTMLTextAreaElement>) => void;\n    placeholder?: string;\n}\n\nexport default class AutosizeTextarea extends React.Component<Props> {\n    private height: number;\n    constructor(props: Props) {\n        super(props);\n\n        this.height = 0;\n    }\n\n    get value() {\n        return (this.refs.textarea as HTMLTextAreaElement).value;\n    }\n\n    set value(value) {\n        (this.refs.textarea as HTMLTextAreaElement).value = value;\n    }\n\n    get selectionStart() {\n        return (this.refs.textarea as HTMLTextAreaElement).selectionStart;\n    }\n\n    set selectionStart(selectionStart) {\n        (this.refs.textarea as HTMLTextAreaElement).selectionStart = selectionStart;\n    }\n\n    get selectionEnd() {\n        return (this.refs.textarea as HTMLTextAreaElement).selectionEnd;\n    }\n\n    set selectionEnd(selectionEnd) {\n        (this.refs.textarea as HTMLTextAreaElement).selectionEnd = selectionEnd;\n    }\n\n    focus() {\n        (this.refs.textarea as HTMLTextAreaElement).focus();\n    }\n\n    blur() {\n        (this.refs.textarea as HTMLTextAreaElement).blur();\n    }\n\n    componentDidMount() {\n        this.recalculateSize();\n    }\n\n    componentDidUpdate() {\n        this.recalculateSize();\n    }\n\n    recalculateSize = () => {\n        if (!this.refs.reference || !(this.refs.textarea as HTMLTextAreaElement)) {\n            return;\n        }\n\n        const height = (this.refs.reference as HTMLTextAreaElement).scrollHeight;\n        const textarea = (this.refs.textarea as HTMLTextAreaElement);\n\n        if (height > 0 && height !== this.height) {\n            const style = getComputedStyle(textarea);\n            const borderWidth = parseInt(style.borderTopWidth || '0', 10) + parseInt(style.borderBottomWidth || '0', 10);\n\n            // Directly change the height to avoid circular rerenders\n            textarea.style.height = String(height + borderWidth) + 'px';\n\n            this.height = height;\n\n            if (this.props.onHeightChange) {\n                this.props.onHeightChange(height, parseInt(style.maxHeight || '0', 10));\n            }\n        }\n    };\n\n    getDOMNode = () => {\n        return (this.refs.textarea as HTMLTextAreaElement);\n    };\n\n    handleChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n        if (this.props.onChange) {\n            this.props.onChange(e);\n        }\n    };\n\n    render() {\n        const props = {...this.props};\n\n        Reflect.deleteProperty(props, 'onHeightChange');\n        Reflect.deleteProperty(props, 'providers');\n        Reflect.deleteProperty(props, 'channelId');\n\n        const {\n            value,\n            defaultValue,\n            placeholder,\n            disabled,\n            onInput,\n\n            // TODO: The provided `id` is sometimes hard-coded and used to interface with the\n            // component, e.g. `post_textbox`, so it can't be changed. This would ideally be\n            // abstracted to avoid passing in an `id` prop at all, but we intentionally maintain\n            // the old behaviour to address ABC-213.\n            id,\n            ...otherProps\n        } = props;\n\n        const heightProps = {\n            rows: 0,\n            height: 0\n        };\n\n        if (this.height <= 0) {\n            // Set an initial number of rows so that the textarea doesn't appear too large when its first rendered\n            heightProps.rows = 1;\n        } else {\n            heightProps.height = this.height;\n        }\n\n        let textareaPlaceholder = null;\n        const placeholderAriaLabel = placeholder ? placeholder.toLowerCase() : '';\n        if (!this.props.value && !this.props.defaultValue) {\n            textareaPlaceholder = (\n                <div\n                    {...otherProps as any}\n                    data-testid={`${id}_placeholder`}\n                    style={style.placeholder}\n                >\n                    {placeholder}\n                </div>\n            );\n        }\n\n        return (\n            <div>\n                {textareaPlaceholder}\n                <textarea\n                    ref='textarea'\n                    data-testid={id}\n                    id={id}\n                    {...heightProps}\n                    {...otherProps}\n                    role='textbox'\n                    aria-label={placeholderAriaLabel}\n                    disabled={disabled}\n                    onChange={this.handleChange}\n                    onInput={onInput}\n                    value={value}\n                    defaultValue={defaultValue}\n                />\n                <div style={style.container}>\n                    <textarea\n                        ref='reference'\n                        id={id + '-reference'}\n                        style={style.reference}\n                        disabled={true}\n                        rows={1}\n                        {...otherProps}\n                        value={value || defaultValue}\n                        aria-hidden={true}\n                    />\n                </div>\n            </div>\n        );\n    }\n}\n\nconst style: { [Key: string]: CSSProperties} = {\n    container: {height: 0, overflow: 'hidden'},\n    reference: {height: 'auto', width: '100%'},\n    placeholder: {overflow: 'hidden', textOverflow: 'ellipsis', opacity: 0.5, pointerEvents: 'none', position: 'absolute', whiteSpace: 'nowrap', background: 'none'},\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {FormattedMessage} from 'react-intl';\n\nexport default class EditIcon extends React.PureComponent {\n    render() {\n        return (\n            <FormattedMessage\n                id='generic_icons.edit'\n                defaultMessage='Edit Icon'\n            >\n                {(title) => (\n                    <i\n                        className='fa fa-pencil'\n                        title={title}\n                    />\n                )}\n            </FormattedMessage>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React, {Component} from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport {Tooltip} from 'react-bootstrap';\n\nimport {Constants} from 'utils/constants';\nimport {fileSizeToString, localizeMessage} from 'utils/utils.jsx';\nimport * as FileUtils from 'utils/file_utils.jsx';\n\nimport FormError from 'components/form_error';\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message.jsx';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport LoadingWrapper from 'components/widgets/loading/loading_wrapper';\n\nexport default class SettingPicture extends Component {\n    static defaultProps = {\n        imageContext: 'profile',\n    };\n\n    static propTypes = {\n        clientError: PropTypes.string,\n        serverError: PropTypes.string,\n        src: PropTypes.string,\n        defaultImageSrc: PropTypes.string,\n        file: PropTypes.object,\n        loadingPicture: PropTypes.bool,\n        submitActive: PropTypes.bool,\n        onRemove: PropTypes.func,\n        onSetDefault: PropTypes.func,\n        onSubmit: PropTypes.func,\n        title: PropTypes.string,\n        onFileChange: PropTypes.func,\n        updateSection: PropTypes.func,\n        imageContext: PropTypes.string,\n        maxFileSize: PropTypes.number,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.settingList = React.createRef();\n        this.selectInput = React.createRef();\n        this.confirmButton = React.createRef();\n\n        this.state = {\n            image: null,\n            removeSrc: false,\n            setDefaultSrc: false,\n        };\n    }\n\n    focusFirstElement() {\n        if (this.settingList.current) {\n            this.settingList.current.focus();\n        }\n    }\n\n    componentDidMount() {\n        this.focusFirstElement();\n\n        if (this.selectInput.current) {\n            this.selectInput.current.addEventListener('input', this.handleFileSelected);\n        }\n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.file !== this.props.file) {\n            this.setPicture(this.props.file);\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.previewBlob) {\n            URL.revokeObjectURL(this.previewBlob);\n        }\n\n        if (this.selectInput.current) {\n            this.selectInput.current.removeEventListener('input', this.handleFileSelected);\n        }\n    }\n\n    handleCancel = (e) => {\n        this.setState({removeSrc: false, setDefaultSrc: false});\n        this.props.updateSection(e);\n    }\n\n    handleFileSelected = () => {\n        if (this.confirmButton.current) {\n            this.confirmButton.current.focus();\n        }\n    }\n\n    handleSave = (e) => {\n        e.preventDefault();\n        if (this.state.removeSrc) {\n            this.props.onRemove();\n        } else if (this.state.setDefaultSrc) {\n            this.props.onSetDefault();\n        } else {\n            this.props.onSubmit();\n        }\n    }\n\n    handleRemoveSrc = (e) => {\n        e.preventDefault();\n        this.setState({removeSrc: true});\n        this.focusFirstElement();\n    }\n\n    handleSetDefaultSrc = (e) => {\n        e.preventDefault();\n        this.setState({setDefaultSrc: true});\n        this.focusFirstElement();\n    }\n\n    handleFileChange = (e) => {\n        this.setState({removeSrc: false, setDefaultSrc: false});\n        this.props.onFileChange(e);\n    }\n\n    handleInputFile = () => {\n        this.selectInput.current.value = '';\n        this.selectInput.current.click();\n    }\n\n    setPicture = (file) => {\n        if (file) {\n            this.previewBlob = URL.createObjectURL(file);\n\n            var reader = new FileReader();\n            reader.onload = (e) => {\n                const orientation = FileUtils.getExifOrientation(e.target.result);\n                const orientationStyles = FileUtils.getOrientationStyles(orientation);\n\n                this.setState({\n                    image: this.previewBlob,\n                    orientationStyles,\n                });\n            };\n            reader.readAsArrayBuffer(file);\n        }\n    }\n\n    renderImg = () => {\n        const imageContext = this.props.imageContext;\n\n        if (this.props.file) {\n            const imageStyles = {\n                backgroundImage: 'url(' + this.state.image + ')',\n                ...this.state.orientationStyles,\n            };\n\n            return (\n                <div className={`${imageContext}-img-preview`}>\n                    <div className='img-preview__image'>\n                        <div\n                            alt={`${imageContext} image preview`}\n                            style={imageStyles}\n                            className={`${imageContext}-img-preview`}\n                        />\n                    </div>\n                </div>\n            );\n        }\n\n        if (this.state.setDefaultSrc) {\n            return (\n                <img\n                    className={`${imageContext}-img`}\n                    alt={`${imageContext} image`}\n                    src={this.props.defaultImageSrc}\n                />\n            );\n        }\n\n        if (this.props.src && !this.state.removeSrc) {\n            const imageElement = (\n                <img\n                    className={`${imageContext}-img`}\n                    alt={`${imageContext} image`}\n                    src={this.props.src}\n                />\n            );\n            if (!this.props.onRemove && !this.props.onSetDefault) {\n                return imageElement;\n            }\n\n            let title;\n            let handler;\n            if (this.props.onRemove) {\n                title = (\n                    <FormattedMessage\n                        id='setting_picture.remove'\n                        defaultMessage='Remove This Icon'\n                    />\n                );\n                handler = this.handleRemoveSrc;\n            } else if (this.props.onSetDefault) {\n                title = (\n                    <FormattedMessage\n                        id='setting_picture.remove_profile_picture'\n                        defaultMessage='Remove Profile Picture'\n                    />\n                );\n                handler = this.handleSetDefaultSrc;\n            }\n\n            return (\n                <div className={`${imageContext}-img__container`}>\n                    <div\n                        className='img-preview__image'\n                        aria-hidden={true}\n                    >\n                        {imageElement}\n                    </div>\n                    <OverlayTrigger\n                        delayShow={Constants.OVERLAY_TIME_DELAY}\n                        placement='right'\n                        overlay={(\n                            <Tooltip id='removeIcon'>\n                                <div aria-hidden={true}>\n                                    {title}\n                                </div>\n                            </Tooltip>\n                        )}\n                    >\n                        <button\n                            data-testid='removeSettingPicture'\n                            className={`${imageContext}-img__remove`}\n                            onClick={handler}\n                        >\n                            <span aria-hidden={true}>{''}</span>\n                            <span className='sr-only'>{title}</span>\n                        </button>\n                    </OverlayTrigger>\n                </div>\n            );\n        }\n        return null;\n    }\n\n    render() {\n        const imageContext = this.props.imageContext;\n\n        const img = this.renderImg();\n\n        let confirmButtonClass = 'btn btn-sm';\n        let disableSaveButtonFocus = false;\n        if (this.props.submitActive || this.state.removeSrc || this.state.setDefaultSrc) {\n            confirmButtonClass += ' btn-primary';\n        } else {\n            confirmButtonClass += ' btn-inactive disabled';\n            disableSaveButtonFocus = true;\n        }\n\n        let helpText;\n        if (imageContext === 'team') {\n            helpText = (\n                <FormattedMarkdownMessage\n                    id={'setting_picture.help.team'}\n                    defaultMessage='Upload a team icon in BMP, JPG or PNG format.\\nSquare images with a solid background color are recommended.'\n                />\n            );\n        } else {\n            helpText = (\n                <FormattedMessage\n                    id={'setting_picture.help.profile'}\n                    defaultMessage='Upload a picture in BMP, JPG or PNG format. Maximum file size: {max}'\n                    values={{max: fileSizeToString(this.props.maxFileSize)}}\n                />\n            );\n        }\n\n        let imgRender;\n        if (img) {\n            imgRender = (\n                <li\n                    className='setting-list-item'\n                    role='presentation'\n                >\n                    {img}\n                </li>\n            );\n        }\n\n        return (\n            <section className='section-max form-horizontal'>\n                <h4 className='col-xs-12 section-title'>\n                    {this.props.title}\n                </h4>\n                <div className='col-xs-offset-3 col-xs-8'>\n                    <div\n                        className='setting-list'\n                        ref={this.settingList}\n                        tabIndex='-1'\n                        aria-label={this.props.title}\n                        aria-describedby='setting-picture__helptext'\n                    >\n                        {imgRender}\n                        <div\n                            id='setting-picture__helptext'\n                            className='setting-list-item pt-3'\n                        >\n                            {helpText}\n                        </div>\n                        <div\n                            className='setting-list-item'\n                        >\n                            <hr/>\n                            <FormError\n                                errors={[this.props.clientError, this.props.serverError]}\n                                type={'modal'}\n                            />\n                            <input\n                                data-testid='uploadPicture'\n                                ref={this.selectInput}\n                                className='hidden'\n                                accept='.jpg,.png,.bmp'\n                                type='file'\n                                onChange={this.handleFileChange}\n                                disabled={this.props.loadingPicture}\n                                aria-hidden={true}\n                                tabIndex='-1'\n                            />\n                            <button\n                                data-testid='inputSettingPictureButton'\n                                className='btn btn-sm btn-primary btn-file sel-btn'\n                                disabled={this.props.loadingPicture}\n                                onClick={this.handleInputFile}\n                                aria-label={localizeMessage('setting_picture.select', 'Select')}\n                            >\n                                <FormattedMessage\n                                    id='setting_picture.select'\n                                    defaultMessage='Select'\n                                />\n                            </button>\n                            <button\n                                tabIndex={disableSaveButtonFocus ? '-1' : '0'}\n                                data-testid='saveSettingPicture'\n                                disabled={disableSaveButtonFocus}\n                                ref={this.confirmButton}\n                                className={confirmButtonClass}\n                                onClick={this.props.loadingPicture ? () => true : this.handleSave}\n                                aria-label={this.props.loadingPicture ? localizeMessage('setting_picture.uploading', 'Uploading...') : localizeMessage('setting_picture.save', 'Save')}\n                            >\n                                <LoadingWrapper\n                                    loading={this.props.loadingPicture}\n                                    text={localizeMessage('setting_picture.uploading', 'Uploading...')}\n                                >\n                                    <FormattedMessage\n                                        id='setting_picture.save'\n                                        defaultMessage='Save'\n                                    />\n                                </LoadingWrapper>\n                            </button>\n                            <button\n                                data-testid='cancelSettingPicture'\n                                className='btn btn-link btn-sm theme'\n                                href='#'\n                                onClick={this.handleCancel}\n                                aria-label={localizeMessage('setting_picture.cancel', 'Cancel')}\n                            >\n                                <FormattedMessage\n                                    id='setting_picture.cancel'\n                                    defaultMessage='Cancel'\n                                />\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </section>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport SuggestionList from 'components/suggestion/suggestion_list.jsx';\nimport {getClosestParent} from 'utils/utils.jsx';\n\nexport default class ModalSuggestionList extends React.PureComponent {\n    static propTypes = {\n        location: PropTypes.string.isRequired,\n        open: PropTypes.bool.isRequired,\n        cleared: PropTypes.bool.isRequired,\n        inputRef: PropTypes.object.isRequired,\n        onLoseVisibility: PropTypes.func.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            scroll: 0,\n            modalBounds: {top: 0, bottom: 0},\n            inputBounds: {top: 0, bottom: 0, width: 0},\n            location: props.location,\n        };\n\n        this.container = React.createRef();\n        this.suggestionList = React.createRef();\n        this.latestHeight = 0;\n    }\n\n    calculateInputRect = () => {\n        if (this.props.inputRef.current) {\n            const rect = this.props.inputRef.current.getInput().getBoundingClientRect();\n            return {top: rect.top, bottom: rect.bottom, width: rect.width};\n        }\n        return {top: 0, bottom: 0, width: 0};\n    }\n\n    onModalScroll = (e) => {\n        if (this.state.scroll !== e.target.scrollTop &&\n            this.latestHeight !== 0) {\n            this.setState({scroll: e.target.scrollTop});\n        }\n    }\n\n    componentDidMount() {\n        if (this.container.current) {\n            const modalBodyContainer = getClosestParent(this.container.current, '.modal-body');\n            modalBodyContainer.addEventListener('scroll', this.onModalScroll);\n        }\n        window.addEventListener('resize', this.updateModalBounds);\n    }\n\n    componentWillUnmount() {\n        if (this.container.current) {\n            const modalBodyContainer = getClosestParent(this.container.current, '.modal-body');\n            modalBodyContainer.removeEventListener('scroll', this.onModalScroll);\n        }\n        window.removeEventListener('resize', this.updateModalBounds);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (!this.props.open || this.props.cleared) {\n            return;\n        }\n\n        if (prevProps.open !== this.state.open ||\n            prevProps.cleared !== this.state.cleared ||\n            prevState.scroll !== this.state.scroll ||\n            prevState.modalBounds.top !== this.state.modalBounds.top ||\n            prevState.modalBounds.bottom !== this.state.modalBounds.bottom) {\n            const newInputBounds = this.updateInputBounds();\n            this.updateLocation(newInputBounds);\n\n            if (this.container.current) {\n                const modalBodyRect = getClosestParent(this.container.current, '.modal-body').getBoundingClientRect();\n                if ((newInputBounds.bottom < modalBodyRect.top) || (newInputBounds.top > modalBodyRect.bottom)) {\n                    this.props.onLoseVisibility();\n                    return;\n                }\n            }\n\n            this.updateModalBounds();\n        }\n    }\n\n    getChildHeight = () => {\n        if (!this.container.current) {\n            return 0;\n        }\n\n        const listElement = this.suggestionList.current.getContent()[0];\n        if (!listElement) {\n            return 0;\n        }\n\n        return listElement.getBoundingClientRect().height;\n    }\n\n    updateInputBounds = () => {\n        const inputBounds = this.calculateInputRect();\n        if (inputBounds.top !== this.state.inputBounds.top ||\n            inputBounds.bottom !== this.state.inputBounds.bottom ||\n            inputBounds.width !== this.state.inputBounds.width) {\n            this.setState({inputBounds});\n        }\n        return inputBounds;\n    }\n\n    updateLocation = (newInputBounds) => {\n        let inputBounds = newInputBounds;\n        if (!newInputBounds) {\n            inputBounds = this.state.inputBounds;\n        }\n\n        if (!this.container.current) {\n            return;\n        }\n\n        this.latestHeight = this.getChildHeight();\n\n        let newLocation = this.props.location;\n        if (window.innerHeight < inputBounds.bottom + this.latestHeight) {\n            newLocation = 'top';\n        }\n        if (inputBounds.top - this.latestHeight < 0) {\n            newLocation = 'bottom';\n        }\n\n        if (this.state.location !== newLocation) {\n            this.setState({location: newLocation});\n        }\n    }\n\n    updateModalBounds = () => {\n        if (!this.container.current) {\n            return;\n        }\n\n        const modalContainer = getClosestParent(this.container.current, '.modal-content');\n        const modalBounds = modalContainer.getBoundingClientRect();\n\n        if (this.state.modalBounds.top !== modalBounds.top || this.state.modalBounds.bottom !== modalBounds.bottom) {\n            this.setState({modalBounds: {top: modalBounds.top, bottom: modalBounds.bottom}});\n        }\n    }\n\n    render() {\n        const {\n            ...props\n        } = this.props;\n\n        Reflect.deleteProperty(props, 'onLoseVisibility');\n\n        let position = {};\n        if (this.state.location === 'top') {\n            position = {bottom: this.state.modalBounds.bottom - this.state.inputBounds.top};\n        } else {\n            position = {top: this.state.inputBounds.bottom - this.state.modalBounds.top};\n        }\n\n        return (\n            <div\n                style={{position: 'fixed', zIndex: 101, width: this.state.inputBounds.width, ...position}}\n                ref={this.container}\n            >\n                <SuggestionList\n                    {...props}\n                    location={this.state.location}\n                    ref={this.suggestionList}\n                />\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport Setting from './setting';\n\ntype Props = {\n    id: string;\n    label: React.ReactNode;\n    labelClassName: string;\n    helpText?: React.ReactNode;\n    placeholder: string;\n    value: boolean;\n    inputClassName: string;\n    onChange(name: string, value: any): void; // value is any since onChange is a common func for inputs and checkboxes\n}\n\nexport default class BoolSetting extends React.Component<Props> {\n    public static defaultProps: Partial<Props> = {\n        labelClassName: '',\n        inputClassName: '',\n    };\n\n    private handleChange: React.ChangeEventHandler<HTMLInputElement> = (e) => {\n        this.props.onChange(this.props.id, e.target.checked);\n    }\n\n    public render(): JSX.Element {\n        return (\n            <Setting\n                label={this.props.label}\n                labelClassName={this.props.labelClassName}\n                inputClassName={this.props.inputClassName}\n                helpText={this.props.helpText}\n                inputId={this.props.id}\n            >\n                <div className='checkbox'>\n                    <label>\n                        <input\n                            id={this.props.id}\n                            type='checkbox'\n                            checked={this.props.value}\n                            onChange={this.handleChange}\n                        />\n                        <span>{this.props.placeholder}</span>\n                    </label>\n                </div>\n            </Setting>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport Setting from './setting';\n\ntype Props = {\n    id: string;\n    options: {text: string;value: string}[];\n    label: React.ReactNode;\n    onChange(name: string, value: any): void;\n    value?: string;\n    labelClassName?: string;\n    inputClassName?: string;\n    helpText?: React.ReactNode;\n\n}\n\nexport default class RadioSetting extends React.Component<Props> {\n    public static defaultProps: Partial<Props> = {\n        labelClassName: '',\n        inputClassName: '',\n        options: [],\n    };\n\n    private handleChange: React.ChangeEventHandler<HTMLInputElement> = (e) => {\n        this.props.onChange(this.props.id, e.target.value);\n    }\n\n    public render(): JSX.Element {\n        return (\n            <Setting\n                label={this.props.label}\n                labelClassName={this.props.labelClassName}\n                inputClassName={this.props.inputClassName}\n                helpText={this.props.helpText}\n                inputId={this.props.id}\n            >\n                {\n                    this.props.options.map(({value, text}) => {\n                        return (\n                            <div\n                                className='radio'\n                                key={value}\n                            >\n                                <label>\n                                    <input\n                                        type='radio'\n                                        value={value}\n                                        name={this.props.id}\n                                        checked={value === this.props.value}\n                                        onChange={this.handleChange}\n                                    />\n                                    {text}\n                                </label>\n                            </div>\n                        );\n                    })\n                }\n            </Setting>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {FormattedMessage} from 'react-intl';\n\nimport MenuActionProvider from 'components/suggestion/menu_action_provider';\nimport GenericUserProvider from 'components/suggestion/generic_user_provider.jsx';\nimport GenericChannelProvider from 'components/suggestion/generic_channel_provider.jsx';\n\nimport TextSetting from 'components/widgets/settings/text_setting';\nimport AutocompleteSelector from 'components/autocomplete_selector';\nimport ModalSuggestionList from 'components/suggestion/modal_suggestion_list.jsx';\nimport BoolSetting from 'components/widgets/settings/bool_setting';\nimport RadioSetting from 'components/widgets/settings/radio_setting';\n\nconst TEXT_DEFAULT_MAX_LENGTH = 150;\nconst TEXTAREA_DEFAULT_MAX_LENGTH = 3000;\n\nexport default class DialogElement extends React.PureComponent {\n    static propTypes = {\n        displayName: PropTypes.string.isRequired,\n        name: PropTypes.string.isRequired,\n        type: PropTypes.string.isRequired,\n        subtype: PropTypes.string,\n        placeholder: PropTypes.string,\n        helpText: PropTypes.string,\n        errorText: PropTypes.node,\n        maxLength: PropTypes.number,\n        dataSource: PropTypes.string,\n        optional: PropTypes.bool,\n        options: PropTypes.arrayOf(PropTypes.object),\n        value: PropTypes.any,\n        onChange: PropTypes.func,\n        actions: PropTypes.shape({\n            autocompleteChannels: PropTypes.func.isRequired,\n            autocompleteUsers: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        let defaultText = '';\n        this.providers = [];\n        if (props.type === 'select') {\n            if (props.dataSource === 'users') {\n                this.providers = [new GenericUserProvider(props.actions.autocompleteUsers)];\n            } else if (props.dataSource === 'channels') {\n                this.providers = [new GenericChannelProvider(props.actions.autocompleteChannels)];\n            } else if (props.options) {\n                this.providers = [new MenuActionProvider(props.options)];\n            }\n\n            if (props.value && props.options) {\n                const defaultOption = props.options.find(\n                    (option) => option.value === props.value\n                );\n                defaultText = defaultOption ? defaultOption.text : '';\n            }\n        }\n\n        this.state = {\n            value: defaultText,\n        };\n    }\n\n    handleSelected = (selected) => {\n        const {name, dataSource, onChange} = this.props;\n\n        if (dataSource === 'users') {\n            onChange(name, selected.id);\n            this.setState({value: selected.username});\n        } else if (dataSource === 'channels') {\n            onChange(name, selected.id);\n            this.setState({value: selected.display_name});\n        } else {\n            onChange(name, selected.value);\n            this.setState({value: selected.text});\n        }\n    }\n\n    render() {\n        const {\n            name,\n            subtype,\n            displayName,\n            value,\n            placeholder,\n            onChange,\n            helpText,\n            errorText,\n            optional,\n            options,\n        } = this.props;\n\n        let {type, maxLength} = this.props;\n\n        let displayNameContent = displayName;\n        if (optional) {\n            displayNameContent = (\n                <React.Fragment>\n                    {displayName + ' '}\n                    <span className='font-weight--normal light'>\n                        <FormattedMessage\n                            id='interactive_dialog.element.optional'\n                            defaultMessage='(optional)'\n                        />\n                    </span>\n                </React.Fragment>\n            );\n        } else {\n            displayNameContent = (\n                <React.Fragment>\n                    {displayName}\n                    <span className='error-text'>{' *'}</span>\n                </React.Fragment>\n            );\n        }\n\n        let helpTextContent = helpText;\n        if (errorText) {\n            helpTextContent = (\n                <React.Fragment>\n                    {helpText}\n                    <div className='error-text mt-3'>\n                        {errorText}\n                    </div>\n                </React.Fragment>\n            );\n        }\n\n        if (type === 'text' || type === 'textarea') {\n            if (type === 'text') {\n                maxLength = maxLength || TEXT_DEFAULT_MAX_LENGTH;\n\n                if (subtype && TextSetting.validTypes.includes(subtype)) {\n                    type = subtype;\n                } else {\n                    type = 'input';\n                }\n            } else {\n                maxLength = maxLength || TEXTAREA_DEFAULT_MAX_LENGTH;\n            }\n\n            return (\n                <TextSetting\n                    id={name}\n                    type={type}\n                    label={displayNameContent}\n                    maxLength={maxLength}\n                    value={value || ''}\n                    placeholder={placeholder}\n                    helpText={helpTextContent}\n                    onChange={onChange}\n                    resizable={false}\n                />\n            );\n        } else if (type === 'select') {\n            return (\n                <AutocompleteSelector\n                    id={name}\n                    providers={this.providers}\n                    onSelected={this.handleSelected}\n                    label={displayNameContent}\n                    helpText={helpTextContent}\n                    placeholder={placeholder}\n                    value={this.state.value}\n                    listComponent={ModalSuggestionList}\n                    listStyle='bottom'\n                />\n            );\n        } else if (type === 'bool') {\n            return (\n                <BoolSetting\n                    id={name}\n                    label={displayNameContent}\n                    value={value || false}\n                    helpText={helpTextContent}\n                    placeholder={placeholder}\n                    onChange={onChange}\n                />\n            );\n        } else if (type === 'radio') {\n            return (\n                <RadioSetting\n                    id={name}\n                    label={displayNameContent}\n                    helpText={helpTextContent}\n                    options={options}\n                    value={value}\n                    onChange={onChange}\n                />\n            );\n        }\n\n        return null;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {autocompleteChannels} from 'actions/channel_actions';\nimport {autocompleteUsers} from 'actions/user_actions';\n\nimport DialogElement from './dialog_element';\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            autocompleteChannels,\n            autocompleteUsers,\n        }, dispatch),\n    };\n}\n\nexport default connect(null, mapDispatchToProps)(DialogElement);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport * as Markdown from 'utils/markdown';\n\nexport default class DialogIntroductionText extends React.PureComponent {\n    static propTypes = {\n        id: PropTypes.string,\n        value: PropTypes.string.isRequired,\n        emojiMap: PropTypes.object.isRequired\n    };\n\n    render() {\n        const formattedMessage = Markdown.format(\n            this.props.value,\n            {\n                breaks: true,\n                sanitize: true,\n                gfm: true\n            },\n            this.props.emojiMap\n        );\n\n        return (\n            <span\n                id={this.props.id}\n                dangerouslySetInnerHTML={{__html: formattedMessage}}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\nimport {\n    checkDialogElementForError,\n    checkIfErrorsMatchElements\n} from 'mattermost-redux/utils/integration_utils';\n\nimport SpinnerButton from 'components/spinner_button';\n\nimport {localizeMessage} from 'utils/utils.jsx';\n\nimport DialogElement from './dialog_element';\nimport DialogIntroductionText from './dialog_introduction_text';\n\nexport default class InteractiveDialog extends React.Component {\n    static propTypes = {\n        url: PropTypes.string.isRequired,\n        callbackId: PropTypes.string,\n        elements: PropTypes.arrayOf(PropTypes.object),\n        title: PropTypes.string.isRequired,\n        introductionText: PropTypes.string,\n        iconUrl: PropTypes.string,\n        submitLabel: PropTypes.string,\n        notifyOnCancel: PropTypes.bool,\n        state: PropTypes.string,\n        onHide: PropTypes.func,\n        actions: PropTypes.shape({\n            submitInteractiveDialog: PropTypes.func.isRequired\n        }).isRequired,\n        emojiMap: PropTypes.object.isRequired\n    };\n\n    constructor(props) {\n        super(props);\n\n        const values = {};\n        if (props.elements != null) {\n            props.elements.forEach((e) => {\n                if (e.type === 'bool') {\n                    values[e.name] =\n                        e.default === true ||\n                        String(e.default).toLowerCase() === 'true';\n                } else {\n                    values[e.name] = e.default || null;\n                }\n            });\n        }\n\n        this.state = {\n            show: true,\n            values,\n            error: null,\n            errors: {},\n            submitting: false\n        };\n    }\n\n    handleSubmit = async (e) => {\n        e.preventDefault();\n\n        const {elements} = this.props;\n        const values = this.state.values;\n        const errors = {};\n        if (elements) {\n            elements.forEach((elem) => {\n                const error = checkDialogElementForError(\n                    elem,\n                    values[elem.name]\n                );\n                if (error) {\n                    errors[elem.name] = (\n                        <FormattedMessage\n                            id={error.id}\n                            defaultMessage={error.defaultMessage}\n                            values={error.values}\n                        />\n                    );\n                }\n            });\n        }\n\n        this.setState({errors});\n\n        if (Object.keys(errors).length !== 0) {\n            return;\n        }\n\n        const {url, callbackId, state} = this.props;\n\n        const dialog = {\n            url,\n            callback_id: callbackId,\n            state,\n            submission: values\n        };\n\n        this.setState({submitting: true});\n\n        const {data} = await this.props.actions.submitInteractiveDialog(\n            dialog\n        );\n\n        this.setState({submitting: false});\n\n        let hasErrors = false;\n\n        if (data) {\n            if (data.error) {\n                hasErrors = true;\n                this.setState({error: data.error});\n            }\n\n            if (\n                data.errors &&\n                Object.keys(data.errors).length >= 0 &&\n                checkIfErrorsMatchElements(data.errors, elements)\n            ) {\n                hasErrors = true;\n                this.setState({errors: data.errors});\n            }\n        }\n\n        if (!hasErrors) {\n            this.handleHide(true);\n        }\n    };\n\n    onHide = () => {\n        this.handleHide(false);\n    };\n\n    handleHide = (submitted = false) => {\n        const {url, callbackId, state, notifyOnCancel} = this.props;\n\n        if (!submitted && notifyOnCancel) {\n            const dialog = {\n                url,\n                callback_id: callbackId,\n                state,\n                cancelled: true\n            };\n\n            this.props.actions.submitInteractiveDialog(dialog);\n        }\n\n        this.setState({show: false});\n    };\n\n    onChange = (name, value) => {\n        const values = {...this.state.values, [name]: value};\n        this.setState({values});\n    };\n\n    render() {\n        const {\n            title,\n            introductionText,\n            iconUrl,\n            submitLabel,\n            elements\n        } = this.props;\n\n        let submitText = (\n            <FormattedMessage\n                id='interactive_dialog.submit'\n                defaultMessage='Submit'\n            />\n        );\n        if (submitLabel) {\n            submitText = submitLabel;\n        }\n\n        let icon;\n        if (iconUrl) {\n            icon = (\n                <img\n                    id='interactiveDialogIconUrl'\n                    alt={'modal title icon'}\n                    className='more-modal__image'\n                    width='36'\n                    height='36'\n                    src={iconUrl}\n                />\n            );\n        }\n\n        return (\n            <Modal\n                id='interactiveDialogModal'\n                dialogClassName='a11y__modal about-modal'\n                show={this.state.show}\n                onHide={this.onHide}\n                onExited={this.props.onHide}\n                backdrop='static'\n                role='dialog'\n                aria-labelledby='interactiveDialogModalLabel'\n            >\n                <Modal.Header\n                    closeButton={true}\n                    style={{borderBottom: elements == null && '0px'}}\n                >\n                    <Modal.Title\n                        componentClass='h1'\n                        id='interactiveDialogModalLabel'\n                    >\n                        {icon}\n                        {title}\n                    </Modal.Title>\n                </Modal.Header>\n                {(elements || introductionText) && (\n                    <Modal.Body>\n                        {introductionText && (\n                            <DialogIntroductionText\n                                id='interactiveDialogModalIntroductionText'\n                                value={introductionText}\n                                emojiMap={this.props.emojiMap}\n                            />\n                        )}\n                        {elements &&\n                            elements.map((e) => {\n                                return (\n                                    <DialogElement\n                                        key={'dialogelement' + e.name}\n                                        displayName={e.display_name}\n                                        name={e.name}\n                                        type={e.type}\n                                        subtype={e.subtype}\n                                        helpText={e.help_text}\n                                        errorText={this.state.errors[e.name]}\n                                        placeholder={e.placeholder}\n                                        minLength={e.min_length}\n                                        maxLength={e.max_length}\n                                        dataSource={e.data_source}\n                                        optional={e.optional}\n                                        options={e.options}\n                                        value={this.state.values[e.name]}\n                                        onChange={this.onChange}\n                                    />\n                                );\n                            })}\n                    </Modal.Body>\n                )}\n                <Modal.Footer>\n                    {this.state.error && (\n                        <div className='error-text'>{this.state.error}</div>\n                    )}\n                    <button\n                        id='interactiveDialogCancel'\n                        type='button'\n                        className='btn btn-link cancel-button'\n                        onClick={this.onHide}\n                    >\n                        <FormattedMessage\n                            id='interactive_dialog.cancel'\n                            defaultMessage='Cancel'\n                        />\n                    </button>\n                    <SpinnerButton\n                        id='interactiveDialogSubmit'\n                        type='button'\n                        className='btn btn-primary save-button'\n                        onClick={this.handleSubmit}\n                        spinning={this.state.submitting}\n                        spinningText={localizeMessage(\n                            'interactive_dialog.submitting',\n                            'Submitting...'\n                        )}\n                    >\n                        {submitText}\n                    </SpinnerButton>\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {submitInteractiveDialog} from 'mattermost-redux/actions/integrations';\n\nimport {getEmojiMap} from 'selectors/emojis';\n\nimport InteractiveDialog from './interactive_dialog';\n\nfunction mapStateToProps(state) {\n    const data = state.entities.integrations.dialog;\n    if (!data || !data.dialog) {\n        return {};\n    }\n\n    return {\n        url: data.url,\n        callbackId: data.dialog.callback_id,\n        elements: data.dialog.elements,\n        title: data.dialog.title,\n        introductionText: data.dialog.introduction_text,\n        iconUrl: data.dialog.icon_url,\n        submitLabel: data.dialog.submit_label,\n        notifyOnCancel: data.dialog.notify_on_cancel,\n        state: data.dialog.state,\n        emojiMap: getEmojiMap(state)\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            submitInteractiveDialog\n        }, dispatch)\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(InteractiveDialog);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Client4} from 'mattermost-redux/client';\n\nimport * as Utils from 'utils/utils.jsx';\nimport ProfilePicture from 'components/profile_picture';\nimport GuestBadge from 'components/widgets/badges/guest_badge';\nimport BotBadge from 'components/widgets/badges/bot_badge';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message.jsx';\n\nexport default class UserListRow extends React.Component {\n    static propTypes = {\n        user: PropTypes.object.isRequired,\n        status: PropTypes.string,\n        extraInfo: PropTypes.arrayOf(PropTypes.object),\n        actions: PropTypes.arrayOf(PropTypes.func),\n        actionProps: PropTypes.object,\n        actionUserProps: PropTypes.object,\n        index: PropTypes.number,\n        totalUsers: PropTypes.number,\n        userCount: PropTypes.number,\n    };\n\n    static defaultProps = {\n        extraInfo: [],\n        actions: [],\n        actionProps: {},\n        actionUserProps: {},\n    };\n\n    render() {\n        let buttons = null;\n        if (this.props.actions) {\n            buttons = this.props.actions.map((Action, index) => {\n                return (\n                    <Action\n                        key={index.toString()}\n                        user={this.props.user}\n                        index={this.props.index}\n                        totalUsers={this.props.totalUsers}\n                        {...this.props.actionProps}\n                        {...this.props.actionUserProps}\n                    />\n                );\n            });\n        }\n\n        // QUICK HACK, NEEDS A PROP FOR TOGGLING STATUS\n        let email = this.props.user.email;\n        let emailStyle = 'more-modal__description';\n        let status;\n        if (this.props.extraInfo && this.props.extraInfo.length > 0) {\n            email = (\n                <FormattedMarkdownMessage\n                    id='admin.user_item.emailTitle'\n                    defaultMessage='**Email:** {email}'\n                    values={{\n                        email: this.props.user.email,\n                    }}\n                />\n            );\n            emailStyle = '';\n        } else if (this.props.user.status) {\n            status = this.props.user.status;\n        } else {\n            status = this.props.status;\n        }\n\n        if (this.props.user.is_bot) {\n            status = null;\n            email = null;\n        }\n\n        let userCountID = null;\n        let userCountEmail = null;\n        if (this.props.userCount >= 0) {\n            userCountID = Utils.createSafeId('userListRowName' + this.props.userCount);\n            userCountEmail = Utils.createSafeId('userListRowEmail' + this.props.userCount);\n        }\n\n        return (\n            <div\n                key={this.props.user.id}\n                className='more-modal__row'\n            >\n                <ProfilePicture\n                    src={Client4.getProfilePictureUrl(this.props.user.id, this.props.user.last_picture_update)}\n                    status={status}\n                    size='md'\n                />\n                <div\n                    className='more-modal__details'\n                    data-testid='userListItemDetails'\n                >\n                    <div\n                        id={userCountID}\n                        className='more-modal__name'\n                    >\n                        {Utils.displayEntireNameForUser(this.props.user)}\n                        <BotBadge\n                            className='badge-popoverlist'\n                            show={Boolean(this.props.user.is_bot)}\n                        />\n                        <GuestBadge\n                            className='badge-popoverlist'\n                            show={Utils.isGuest(this.props.user)}\n                        />\n                    </div>\n                    <div\n                        id={userCountEmail}\n                        className={emailStyle}\n                    >\n                        {email}\n                    </div>\n                    {this.props.extraInfo}\n                </div>\n                <div\n                    data-testid='userListItemActions'\n                    className='more-modal__actions'\n                >\n                    {buttons}\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getStatusForUserId} from 'mattermost-redux/selectors/entities/users';\n\nimport UserListRow from './user_list_row.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    const user = ownProps.user || {};\n    return {\n        status: getStatusForUserId(state, user.id),\n    };\n}\n\nexport default connect(mapStateToProps)(UserListRow);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport Constants from 'utils/constants';\nimport LoadingScreen from 'components/loading_screen';\n\nimport UserListRow from './user_list_row';\n\nexport default class UserList extends React.Component {\n    static propTypes = {\n        users: PropTypes.arrayOf(PropTypes.object),\n        extraInfo: PropTypes.object,\n        actions: PropTypes.arrayOf(PropTypes.func),\n        actionProps: PropTypes.object,\n        actionUserProps: PropTypes.object,\n\n        // the type of user list row to render\n        rowComponentType: PropTypes.func,\n    }\n\n    static defaultProps = {\n        users: [],\n        extraInfo: {},\n        actions: [],\n        actionProps: {},\n        rowComponentType: UserListRow,\n    }\n\n    scrollToTop = () => {\n        if (this.refs.container) {\n            this.refs.container.scrollTop = 0;\n        }\n    }\n\n    render() {\n        const users = this.props.users;\n        const RowComponentType = this.props.rowComponentType;\n\n        let content;\n        if (users == null) {\n            return <LoadingScreen/>;\n        } else if (users.length > 0) {\n            content = users.map((user, index) => {\n                return (\n                    <RowComponentType\n                        key={user.id}\n                        user={user}\n                        extraInfo={this.props.extraInfo[user.id]}\n                        actions={this.props.actions}\n                        actionProps={this.props.actionProps}\n                        actionUserProps={this.props.actionUserProps[user.id]}\n                        index={index}\n                        totalUsers={users.length}\n                        userCount={(index >= 0 && index < Constants.TEST_ID_COUNT) ? index : -1}\n                    />\n                );\n            });\n        } else {\n            content = (\n                <div\n                    key='no-users-found'\n                    className='more-modal__placeholder-row'\n                    data-testid='noUsersFound'\n                >\n                    <p>\n                        <FormattedMessage\n                            id='user_list.notFound'\n                            defaultMessage='No users found'\n                        />\n                    </p>\n                </div>\n            );\n        }\n\n        return (\n            <div ref='container'>\n                {content}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport {FormattedMessage, injectIntl} from 'react-intl';\n\nimport QuickInput from 'components/quick_input';\nimport UserList from 'components/user_list.jsx';\nimport LocalizedInput from 'components/localized_input/localized_input';\n\nimport {t} from 'utils/i18n';\n\nconst NEXT_BUTTON_TIMEOUT = 500;\n\nclass SearchableUserList extends React.Component {\n    static propTypes = {\n        users: PropTypes.arrayOf(PropTypes.object),\n        usersPerPage: PropTypes.number,\n        total: PropTypes.number,\n        extraInfo: PropTypes.object,\n        nextPage: PropTypes.func.isRequired,\n        previousPage: PropTypes.func.isRequired,\n        search: PropTypes.func.isRequired,\n        actions: PropTypes.arrayOf(PropTypes.func),\n        actionProps: PropTypes.object,\n        actionUserProps: PropTypes.object,\n        focusOnMount: PropTypes.bool,\n        renderCount: PropTypes.func,\n        filter: PropTypes.string,\n        renderFilterRow: PropTypes.func,\n        page: PropTypes.number.isRequired,\n        term: PropTypes.string.isRequired,\n        onTermChange: PropTypes.func.isRequired,\n        intl: PropTypes.any,\n\n        // the type of user list row to render\n        rowComponentType: PropTypes.func,\n    };\n\n    static defaultProps = {\n        users: [],\n        usersPerPage: 50, // eslint-disable-line no-magic-numbers\n        extraInfo: {},\n        actions: [],\n        actionProps: {},\n        actionUserProps: {},\n        showTeamToggle: false,\n        focusOnMount: false,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.nextTimeoutId = 0;\n\n        this.state = {\n            nextDisabled: false,\n        };\n    }\n\n    componentDidMount() {\n        this.focusSearchBar();\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.page !== prevProps.page || this.props.term !== prevProps.term) {\n            this.refs.userList.scrollToTop();\n        }\n    }\n\n    componentWillUnmount() {\n        clearTimeout(this.nextTimeoutId);\n    }\n\n    nextPage = (e) => {\n        e.preventDefault();\n\n        this.setState({nextDisabled: true});\n        this.nextTimeoutId = setTimeout(() => this.setState({nextDisabled: false}), NEXT_BUTTON_TIMEOUT);\n\n        this.props.nextPage();\n        $(ReactDOM.findDOMNode(this.refs.channelListScroll)).scrollTop(0);\n    }\n\n    previousPage = (e) => {\n        e.preventDefault();\n\n        this.props.previousPage();\n        $(ReactDOM.findDOMNode(this.refs.channelListScroll)).scrollTop(0);\n    }\n\n    focusSearchBar = () => {\n        if (this.props.focusOnMount) {\n            this.refs.filter.focus();\n        }\n    }\n\n    handleInput = (e) => {\n        this.props.onTermChange(e.target.value);\n        this.props.search(e.target.value);\n    }\n\n    renderCount = (users) => {\n        if (!users) {\n            return null;\n        }\n\n        if (this.props.filter) {\n            return null;\n        }\n\n        const count = users.length;\n        const total = this.props.total;\n        const isSearch = Boolean(this.props.term);\n\n        let startCount;\n        let endCount;\n        if (isSearch) {\n            startCount = -1;\n            endCount = -1;\n        } else {\n            startCount = this.props.page * this.props.usersPerPage;\n            endCount = Math.min(startCount + this.props.usersPerPage, total);\n        }\n\n        if (this.props.renderCount) {\n            return this.props.renderCount(count, this.props.total, startCount, endCount, isSearch);\n        }\n\n        if (this.props.total) {\n            if (isSearch) {\n                return (\n                    <FormattedMessage\n                        id='filtered_user_list.countTotal'\n                        defaultMessage='{count, number} {count, plural, one {member} other {members}} of {total, number} total'\n                        values={{\n                            count,\n                            total,\n                        }}\n                    />\n                );\n            }\n\n            return (\n                <FormattedMessage\n                    id='filtered_user_list.countTotalPage'\n                    defaultMessage='{startCount, number} - {endCount, number} {count, plural, one {member} other {members}} of {total, number} total'\n                    values={{\n                        count,\n                        startCount: startCount + 1,\n                        endCount,\n                        total,\n                    }}\n                />\n            );\n        }\n\n        return null;\n    }\n\n    render() {\n        let nextButton;\n        let previousButton;\n        let usersToDisplay;\n        const {formatMessage} = this.props.intl;\n\n        if (this.props.term || !this.props.users) {\n            usersToDisplay = this.props.users;\n        } else if (!this.props.term) {\n            const pageStart = this.props.page * this.props.usersPerPage;\n            const pageEnd = pageStart + this.props.usersPerPage;\n            usersToDisplay = this.props.users.slice(pageStart, pageEnd);\n\n            if (pageEnd < this.props.users.length) {\n                nextButton = (\n                    <button\n                        id='searchableUserListNextBtn'\n                        className='btn btn-link filter-control filter-control__next'\n                        onClick={this.nextPage}\n                        disabled={this.state.nextDisabled}\n                    >\n                        <FormattedMessage\n                            id='filtered_user_list.next'\n                            defaultMessage='Next'\n                        />\n                    </button>\n                );\n            }\n\n            if (this.props.page > 0) {\n                previousButton = (\n                    <button\n                        id='searchableUserListPrevBtn'\n                        className='btn btn-link filter-control filter-control__prev'\n                        onClick={this.previousPage}\n                    >\n                        <FormattedMessage\n                            id='filtered_user_list.prev'\n                            defaultMessage='Previous'\n                        />\n                    </button>\n                );\n            }\n        }\n\n        let filterRow;\n        if (this.props.renderFilterRow) {\n            filterRow = this.props.renderFilterRow(this.handleInput);\n        } else {\n            const searchUsersPlaceholder = {id: t('filtered_user_list.search'), defaultMessage: 'Search users'};\n            filterRow = (\n                <div className='col-xs-12'>\n                    <label\n                        className='hidden-label'\n                        htmlFor='searchUsersInput'\n                    >\n                        <FormattedMessage\n                            id='filtered_user_list.search'\n                            defaultMessage='Search users'\n                        />\n                    </label>\n                    <QuickInput\n                        id='searchUsersInput'\n                        ref='filter'\n                        className='form-control filter-textbox'\n                        placeholder={searchUsersPlaceholder}\n                        inputComponent={LocalizedInput}\n                        value={this.props.term}\n                        onInput={this.handleInput}\n                        aria-label={formatMessage(searchUsersPlaceholder).toLowerCase()}\n                    />\n                </div>\n            );\n        }\n\n        return (\n            <div className='filtered-user-list'>\n                <div className='filter-row'>\n                    {filterRow}\n                    <div className='col-sm-12'>\n                        <span\n                            id='searchableUserListTotal'\n                            className='member-count pull-left'\n                            aria-live='polite'\n                        >\n                            {this.renderCount(usersToDisplay)}\n                        </span>\n                    </div>\n                </div>\n                <div className='more-modal__list'>\n                    <UserList\n                        ref='userList'\n                        users={usersToDisplay}\n                        extraInfo={this.props.extraInfo}\n                        actions={this.props.actions}\n                        actionProps={this.props.actionProps}\n                        actionUserProps={this.props.actionUserProps}\n                        rowComponentType={this.props.rowComponentType}\n                    />\n                </div>\n                <div className='filter-controls'>\n                    {previousButton}\n                    {nextButton}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default injectIntl(SearchableUserList);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nexport default class ModalController extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * Object that has map of modal's id and element\n         */\n        modals: PropTypes.object.isRequired,\n\n        /**\n         * Object with action creators\n         */\n        actions: PropTypes.shape({\n\n            /**\n             * Action creator to close modal\n             */\n            closeModal: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    render() {\n        const {modals, ...props} = this.props;\n        const {modalState} = modals;\n\n        if (!modals) {\n            return <div/>;\n        }\n\n        const modalOutput = [];\n\n        for (const modalId in modalState) {\n            if (modalState.hasOwnProperty(modalId)) {\n                const modal = modalState[modalId];\n                if (modal.open) {\n                    const modalComponent = React.createElement(modal.dialogType, Object.assign({}, modal.dialogProps, {\n                        onHide: props.actions.closeModal.bind(this, modalId),\n                        key: `${modalId}_modal`,\n                    }));\n\n                    modalOutput.push(modalComponent);\n                }\n            }\n        }\n\n        return (\n            <div>{modalOutput}</div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {closeModal} from 'actions/views/modals';\n\nimport ModalController from './modal_controller.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        modals: state.views.modals,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            closeModal,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ModalController);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Overlay} from 'react-bootstrap';\nimport {Client4} from 'mattermost-redux/client';\nimport {displayUsername} from 'mattermost-redux/utils/user_utils';\n\nimport ProfilePopover from 'components/profile_popover';\n\nimport {popOverOverlayPosition} from 'utils/position_utils.tsx';\nconst spaceRequiredForPopOver = 300;\n\nexport default class AtMention extends React.PureComponent {\n    static propTypes = {\n        children: PropTypes.node,\n        currentUserId: PropTypes.string.isRequired,\n        hasMention: PropTypes.bool,\n        disableHighlight: PropTypes.bool,\n        isRHS: PropTypes.bool,\n        mentionName: PropTypes.string.isRequired,\n        teammateNameDisplay: PropTypes.string.isRequired,\n        usersByUsername: PropTypes.object.isRequired,\n    };\n\n    static defaultProps = {\n        isRHS: false,\n        hasMention: false,\n        disableHighlight: false,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            show: false,\n        };\n\n        this.overlayRef = React.createRef();\n    }\n\n    handleClick = (e) => {\n        const targetBounds = this.overlayRef.current.getBoundingClientRect();\n        const placement = popOverOverlayPosition(targetBounds, window.innerHeight, spaceRequiredForPopOver);\n\n        this.setState({target: e.target, show: !this.state.show, placement});\n    }\n\n    hideOverlay = () => {\n        this.setState({show: false});\n    }\n\n    getUserFromMentionName(props) {\n        const usersByUsername = props.usersByUsername;\n        let mentionName = props.mentionName.toLowerCase();\n\n        while (mentionName.length > 0) {\n            if (usersByUsername.hasOwnProperty(mentionName)) {\n                return usersByUsername[mentionName];\n            }\n\n            // Repeatedly trim off trailing punctuation in case this is at the end of a sentence\n            if ((/[._-]$/).test(mentionName)) {\n                mentionName = mentionName.substring(0, mentionName.length - 1);\n            } else {\n                break;\n            }\n        }\n\n        return '';\n    }\n\n    render() {\n        const user = this.getUserFromMentionName(this.props);\n        if (!user) {\n            return <React.Fragment>{this.props.children}</React.Fragment>;\n        }\n\n        const suffix = this.props.mentionName.substring(user.username.length);\n\n        let className = 'mention-link';\n        if (!this.props.disableHighlight && user.id === this.props.currentUserId) {\n            className += ' mention--highlight';\n        }\n\n        return (\n            <span>\n                <Overlay\n                    placement={this.state.placement}\n                    show={this.state.show}\n                    target={this.state.target}\n                    rootClose={true}\n                    onHide={this.hideOverlay}\n                >\n                    <ProfilePopover\n                        className='user-profile-popover'\n                        userId={user.id}\n                        src={Client4.getProfilePictureUrl(user.id, user.last_picture_update)}\n                        isRHS={this.props.isRHS}\n                        hasMention={this.props.hasMention}\n                        hide={this.hideOverlay}\n                    />\n                </Overlay>\n                <a\n                    className={className}\n                    onClick={this.handleClick}\n                    ref={this.overlayRef}\n                >\n                    {'@' + displayUsername(user, this.props.teammateNameDisplay)}\n                </a>\n                {suffix}\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getTeammateNameDisplaySetting} from 'mattermost-redux/selectors/entities/preferences';\nimport {getCurrentUserId, getUsersByUsername} from 'mattermost-redux/selectors/entities/users';\n\nimport AtMention from './at_mention.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        currentUserId: getCurrentUserId(state),\n        teammateNameDisplay: getTeammateNameDisplaySetting(state),\n        usersByUsername: getUsersByUsername(state),\n    };\n}\n\nexport default connect(mapStateToProps)(AtMention);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport reducerRegistry from 'mattermost-redux/store/reducer_registry';\n\nimport {\n    registerPluginWebSocketEvent,\n    unregisterPluginWebSocketEvent,\n    registerPluginReconnectHandler,\n    unregisterPluginReconnectHandler,\n} from 'actions/websocket_actions.jsx';\n\nimport {showRHSPlugin, hideRHSPlugin, toggleRHSPlugin} from 'actions/views/rhs';\n\nimport {\n    registerPluginTranslationsSource,\n} from 'actions/views/root';\n\nimport {\n    registerAdminConsolePlugin,\n    unregisterAdminConsolePlugin,\n    registerAdminConsoleCustomSetting,\n} from 'actions/admin_actions';\n\nimport store from 'stores/redux_store.jsx';\nimport {ActionTypes} from 'utils/constants';\nimport {generateId} from 'utils/utils.jsx';\n\nfunction dispatchPluginComponentAction(name, pluginId, component, id = generateId()) {\n    store.dispatch({\n        type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n        name,\n        data: {\n            id,\n            pluginId,\n            component,\n        },\n    });\n\n    return id;\n}\n\nconst resolveReactElement = (element) => {\n    if (typeof element === 'function') {\n        // Allow element to be passed as the name of the component, instead of a React element.\n        return React.createElement(element);\n    }\n\n    return element;\n};\n\nexport default class PluginRegistry {\n    constructor(id) {\n        this.id = id;\n    }\n\n    // Register a component at the root of the channel view of the app.\n    // Accepts a React component. Returns a unique identifier.\n    registerRootComponent(component) {\n        return dispatchPluginComponentAction('Root', this.id, component);\n    }\n\n    // Register a component in the user attributes section of the profile popover (hovercard), below the default user attributes.\n    // Accepts a React component. Returns a unique identifier.\n    registerPopoverUserAttributesComponent(component) {\n        return dispatchPluginComponentAction('PopoverUserAttributes', this.id, component);\n    }\n\n    // Register a component in the user actions of the profile popover (hovercard), below the default actions.\n    // Accepts a React component. Returns a unique identifier.\n    registerPopoverUserActionsComponent(component) {\n        return dispatchPluginComponentAction('PopoverUserActions', this.id, component);\n    }\n\n    // Register a component fixed to the top of the left-hand channel sidebar.\n    // Accepts a React component. Returns a unique identifier.\n    registerLeftSidebarHeaderComponent(component) {\n        return dispatchPluginComponentAction('LeftSidebarHeader', this.id, component);\n    }\n\n    // Register a component fixed to the bottom of the team sidebar. Does not render if\n    // user is only on one team and the team sidebar is not shown.\n    // Accepts a React component. Returns a unique identifier.\n    registerBottomTeamSidebarComponent(component) {\n        return dispatchPluginComponentAction('BottomTeamSidebar', this.id, component);\n    }\n\n    // Register a component fixed to the bottom of the post message.\n    // Accepts a React component. Returns a unique identifier.\n    registerPostMessageAttachmentComponent(component) {\n        return dispatchPluginComponentAction('PostMessageAttachment', this.id, component);\n    }\n\n    // Register a component to show as a tooltip when a user hovers on a link in a post.\n    // Accepts a React component. Returns a unique identifier.\n    registerLinkTooltipComponent(component) {\n        return dispatchPluginComponentAction('LinkTooltip', this.id, component);\n    }\n\n    // Add a button to the channel header. If there are more than one buttons registered by any\n    // plugin, a dropdown menu is created to contain all the plugin buttons.\n    // Accepts the following:\n    // - icon - React element to use as the button's icon\n    // - action - a function called when the button is clicked, passed the channel and channel member as arguments\n    // - dropdown_text - string or React element shown for the dropdown button description\n    // - tooltip_text - string shown for tooltip appear on hover\n    registerChannelHeaderButtonAction(icon, action, dropdownText, tooltipText) {\n        const id = generateId();\n\n        const data = {\n            id,\n            pluginId: this.id,\n            icon: resolveReactElement(icon),\n            action,\n            dropdownText: resolveReactElement(dropdownText),\n            tooltipText,\n        };\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n            name: 'ChannelHeaderButton',\n            data,\n        });\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n            name: 'MobileChannelHeaderButton',\n            data,\n        });\n\n        return id;\n    }\n\n    // Register a component to render a custom body for posts with a specific type.\n    // Custom post types must be prefixed with 'custom_'.\n    // Custom post types can also apply for ephemeral posts.\n    // Accepts a string type and a component.\n    // Returns a unique identifier.\n    registerPostTypeComponent(type, component) {\n        const id = generateId();\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_POST_COMPONENT,\n            data: {\n                id,\n                pluginId: this.id,\n                type,\n                component,\n            },\n        });\n\n        return id;\n    }\n\n    // Register a component to render a custom body for post cards with a specific type.\n    // Custom post types must be prefixed with 'custom_'.\n    // Accepts a string type and a component.\n    // Returns a unique identifier.\n    registerPostCardTypeComponent(type, component) {\n        const id = generateId();\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_POST_CARD_COMPONENT,\n            data: {\n                id,\n                pluginId: this.id,\n                type,\n                component,\n            },\n        });\n\n        return id;\n    }\n\n    // Register a component to render a custom embed preview for post links.\n    // Accepts the following:\n    // - match - A function that receives the embed object and returns a\n    //   boolean indicating if the plugin is able to process it.\n    //   The embed object contains the embed `type`, the `url` of the post link\n    //   and in some cases, a `data` object with information related to the\n    //   link (the opengraph or the image details, for example).\n    // - component - The component that renders the embed view for the link\n    // - toggleable - A boolean indicating if the embed view should be collapsable\n    // Returns a unique identifier.\n    registerPostWillRenderEmbedComponent(match, component, toggleable) {\n        const id = generateId();\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n            name: 'PostWillRenderEmbedComponent',\n            data: {\n                id,\n                pluginId: this.id,\n                component,\n                match,\n                toggleable,\n            },\n        });\n\n        return id;\n    }\n\n    // Register a main menu list item by providing some text and an action function.\n    // Accepts the following:\n    // - text - A string or React element to display in the menu\n    // - action - A function to trigger when component is clicked on\n    // - mobileIcon - A React element to display as the icon in the menu in mobile view\n    // Returns a unique identifier.\n    registerMainMenuAction(text, action, mobileIcon) {\n        const id = generateId();\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n            name: 'MainMenu',\n            data: {\n                id,\n                pluginId: this.id,\n                text: resolveReactElement(text),\n                action,\n                mobileIcon: resolveReactElement(mobileIcon),\n            },\n        });\n\n        return id;\n    }\n\n    // Register a channel menu list item by providing some text and an action function.\n    // Accepts the following:\n    // - text - A string or React element to display in the menu\n    // - action - A function that receives the channelId and is called when the menu items is clicked.\n    // Returns a unique identifier.\n    registerChannelHeaderMenuAction(text, action) {\n        const id = generateId();\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n            name: 'ChannelHeader',\n            data: {\n                id,\n                pluginId: this.id,\n                text: resolveReactElement(text),\n                action,\n            },\n        });\n\n        return id;\n    }\n\n    // Register a post menu list item by providing some text and an action function.\n    // Accepts the following:\n    // - text - A string or React element to display in the menu\n    // - action - A function to trigger when component is clicked on\n    // - filter - A function whether to apply the plugin into the post' dropdown menu\n    // Returns a unique identifier.\n    registerPostDropdownMenuAction(text, action, filter) {\n        const id = generateId();\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n            name: 'PostDropdownMenu',\n            data: {\n                id,\n                pluginId: this.id,\n                text: resolveReactElement(text),\n                action,\n                filter,\n            },\n        });\n\n        return id;\n    }\n\n    // Register a post sub menu list item by providing some text and an action function.\n    // Accepts the following:\n    // - text - A string or React element to display in the menu\n    // - action - A function to trigger when component is clicked on\n    // - filter - A function whether to apply the plugin into the post' dropdown menu\n    //\n    // Returns an unique identifier for the root submenu, and a function to register submenu items.\n    // At this time, only one level of nesting is allowed to avoid rendering issue in the RHS.\n    registerPostDropdownSubMenuAction(text, action, filter) {\n        function registerMenuItem(pluginId, id, parentMenuId, innerText, innerAction, innerFilter) {\n            store.dispatch({\n                type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n                name: 'PostDropdownMenu',\n                data: {\n                    id,\n                    parentMenuId,\n                    pluginId,\n                    text: resolveReactElement(innerText),\n                    subMenu: [],\n                    action: innerAction,\n                    filter: innerFilter,\n                },\n            });\n            return function registerSubMenuItem(t, a, f) {\n                if (parentMenuId) {\n                    throw new Error('Submenus are currently limited to a single level.');\n                }\n\n                return registerMenuItem(pluginId, generateId(), id, t, a, f);\n            };\n        }\n        const id = generateId();\n        return {id, rootRegisterMenuItem: registerMenuItem(this.id, id, null, text, action, filter)};\n    }\n\n    // Register a component at the bottom of the post dropdown menu.\n    // Accepts a React component. Returns a unique identifier.\n    registerPostDropdownMenuComponent(component) {\n        return dispatchPluginComponentAction('PostDropdownMenuItem', this.id, component);\n    }\n\n    // Register a file upload method by providing some text, an icon, and an action function.\n    // Accepts the following:\n    // - icon - JSX element to use as the button's icon\n    // - text - A string or JSX element to display in the file upload menu\n    // - action - A function to trigger when the menu item is selected.\n    // Returns a unique identifier.\n    registerFileUploadMethod(icon, action, text) {\n        const id = generateId();\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n            name: 'FileUploadMethod',\n            data: {\n                id,\n                pluginId: this.id,\n                text,\n                action,\n                icon,\n            },\n        });\n\n        return id;\n    }\n\n    // Register a hook to intercept file uploads before they take place.\n    // Accepts a function to run before files get uploaded. Receives an array of\n    // files and a function to upload files at a later time as arguments. Must\n    // return an object that can contain two properties:\n    // - message - An error message to display, leave blank or null to display no message\n    // - files - Modified array of files to upload, set to null to reject all files\n    // Returns a unique identifier.\n    registerFilesWillUploadHook(hook) {\n        const id = generateId();\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n            name: 'FilesWillUploadHook',\n            data: {\n                id,\n                pluginId: this.id,\n                hook,\n            },\n        });\n\n        return id;\n    }\n\n    // Unregister a component, action or hook using the unique identifier returned after registration.\n    // Accepts a string id.\n    // Returns undefined in all cases.\n    unregisterComponent(componentId) {\n        store.dispatch({\n            type: ActionTypes.REMOVED_PLUGIN_COMPONENT,\n            id: componentId,\n        });\n    }\n\n    // Unregister a component that provided a custom body for posts with a specific type.\n    // Accepts a string id.\n    // Returns undefined in all cases.\n    unregisterPostTypeComponent(componentId) {\n        store.dispatch({\n            type: ActionTypes.REMOVED_PLUGIN_POST_COMPONENT,\n            id: componentId,\n        });\n    }\n\n    // Register a reducer against the Redux store. It will be accessible in redux state\n    // under \"state['plugins-<yourpluginid>']\"\n    // Accepts a reducer. Returns undefined.\n    registerReducer(reducer) {\n        reducerRegistry.register('plugins-' + this.id, reducer);\n    }\n\n    // Register a handler for WebSocket events.\n    // Accepts the following:\n    // - event - the event type, can be a regular server event or an event from plugins.\n    // Plugin events will have \"custom_<pluginid>_\" prepended\n    // - handler - a function to handle the event, receives the event message as an argument\n    // Returns undefined.\n    registerWebSocketEventHandler(event, handler) {\n        registerPluginWebSocketEvent(this.id, event, handler);\n    }\n\n    // Unregister a handler for a custom WebSocket event.\n    // Accepts a string event type.\n    // Returns undefined.\n    unregisterWebSocketEventHandler(event) {\n        unregisterPluginWebSocketEvent(this.id, event);\n    }\n\n    // Register a handler that will be called when the app reconnects to the\n    // internet after previously disconnecting.\n    // Accepts a function to handle the event. Returns undefined.\n    registerReconnectHandler(handler) {\n        registerPluginReconnectHandler(this.id, handler);\n    }\n\n    // Unregister a previously registered reconnect handler.\n    // Returns undefined.\n    unregisterReconnectHandler() {\n        unregisterPluginReconnectHandler(this.id);\n    }\n\n    // Register a hook that will be called when a message is posted by the user before it\n    // is sent to the server. Accepts a function that receives the post as an argument.\n    //\n    // To reject a post, return an object containing an error such as\n    //     {error: {message: 'Rejected'}}\n    // To modify or allow the post without modifcation, return an object containing the post\n    // such as\n    //     {post: {...}}\n    //\n    // If the hook function is asynchronous, the message will not be sent to the server\n    // until the hook returns.\n    registerMessageWillBePostedHook(hook) {\n        const id = generateId();\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n            name: 'MessageWillBePosted',\n            data: {\n                id,\n                pluginId: this.id,\n                hook,\n            },\n        });\n\n        return id;\n    }\n\n    // Register a hook that will be called when a slash command is posted by the user before it\n    // is sent to the server. Accepts a function that receives the message (string) and the args\n    // (object) as arguments.\n    // The args object is:\n    //        {\n    //            channel_id: channelId,\n    //            team_id: teamId,\n    //            root_id: rootId,\n    //            parent_id: rootId,\n    //        }\n    //\n    // To reject a command, return an object containing an error:\n    //     {error: {message: 'Rejected'}}\n    // To ignore a command, return an empty object (to prevent an error from being displayed):\n    //     {}\n    // To modify or allow the command without modification, return an object containing the new message\n    // and args. It is not likely that you will need to change the args, so return the object that was provided:\n    //     {message: {...}, args}\n    //\n    // If the hook function is asynchronous, the command will not be sent to the server\n    // until the hook returns.\n    registerSlashCommandWillBePostedHook(hook) {\n        const id = generateId();\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n            name: 'SlashCommandWillBePosted',\n            data: {\n                id,\n                pluginId: this.id,\n                hook,\n            },\n        });\n\n        return id;\n    }\n\n    // Register a hook that will be called before a message is formatted into Markdown.\n    // Accepts a function that receives the unmodified post and the message (potentially\n    // already modified by other hooks) as arguments. This function must return a string\n    // message that will be formatted.\n    // Returns a unique identifier.\n    registerMessageWillFormatHook(hook) {\n        const id = generateId();\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n            name: 'MessageWillFormat',\n            data: {\n                id,\n                pluginId: this.id,\n                hook,\n            },\n        });\n\n        return id;\n    }\n\n    // Register a component to override file previews. Accepts a function to run before file is\n    // previewed and a react component to be rendered as the file preview.\n    // - override - A function to check whether preview needs to be overridden. Receives fileInfo and post as arguments.\n    // Returns true is preview should be overridden and false otherwise.\n    // - component - A react component to display instead of original preview. Receives fileInfo and post as props.\n    // Returns a unique identifier.\n    // Only one plugin can override a file preview at a time. If two plugins try to override the same file preview, the first plugin will perform the override and the second will not. Plugin precedence is ordered alphabetically by plugin ID.\n    registerFilePreviewComponent(override, component) {\n        const id = generateId();\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n            name: 'FilePreview',\n            data: {\n                id,\n                pluginId: this.id,\n                override,\n                component,\n            },\n        });\n\n        return id;\n    }\n\n    registerTranslations(getTranslationsForLocale) {\n        store.dispatch(registerPluginTranslationsSource(this.id, getTranslationsForLocale));\n    }\n\n    // Register a admin console definitions override function\n    // Note that this is a low-level interface primarily meant for internal use, and is not subject\n    // to semver guarantees. It may change in the future.\n    // Accepts the following:\n    // - func - A function that recieve the admin console config definitions and return a new\n    //          version of it, which is used for build the admin console.\n    // Each plugin can register at most one admin console plugin function, with newer registrations\n    // replacing older ones.\n    registerAdminConsolePlugin(func) {\n        store.dispatch(registerAdminConsolePlugin(this.id, func));\n    }\n\n    // Register a custom React component to manage the plugin configuration for the given setting key.\n    // Accepts the following:\n    // - key - A key specified in the settings_schema.settings block of the plugin's manifest.\n    // - component - A react component to render in place of the default handling.\n    // - options - Object for the following available options to display the setting:\n    //     showTitle - Optional boolean that if true the display_name of the setting will be rendered\n    // on the left column of the settings page and the registered component will be displayed on the\n    // available space in the right column.\n    registerAdminConsoleCustomSetting(key, component, {showTitle} = {}) {\n        store.dispatch(registerAdminConsoleCustomSetting(this.id, key, component, {showTitle}));\n    }\n\n    // Unregister a previously registered admin console definition override function.\n    // Returns undefined.\n    unregisterAdminConsolePlugin() {\n        store.dispatch(unregisterAdminConsolePlugin(this.id));\n    }\n\n    // Register a Right-Hand Sidebar component by providing a title for the right hand component.\n    // Accepts the following:\n    // - title - A string or JSX element to display as a title for the RHS.\n    // - component - A react component to display in the Right-Hand Sidebar.\n    // Returns:\n    // - id: a unique identifier\n    // - showRHSPlugin: the action to dispatch that will open the RHS.\n    // - hideRHSPlugin: the action to dispatch that will close the RHS\n    // - toggleRHSPlugin: the action to dispatch that will toggle the RHS\n    registerRightHandSidebarComponent(component, title) {\n        const id = generateId();\n\n        store.dispatch({\n            type: ActionTypes.RECEIVED_PLUGIN_COMPONENT,\n            name: 'RightHandSidebarComponent',\n            data: {\n                id,\n                pluginId: this.id,\n                component,\n                title,\n            },\n        });\n\n        return {id, showRHSPlugin: showRHSPlugin(id), hideRHSPlugin: hideRHSPlugin(id), toggleRHSPlugin: toggleRHSPlugin(id)};\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport regeneratorRuntime from 'regenerator-runtime';\n\nimport {Client4} from 'mattermost-redux/client';\n\nimport store from 'stores/redux_store.jsx';\nimport {ActionTypes} from 'utils/constants.jsx';\nimport {getSiteURL} from 'utils/url';\nimport PluginRegistry from 'plugins/registry';\nimport {unregisterAllPluginWebSocketEvents, unregisterPluginReconnectHandler} from 'actions/websocket_actions.jsx';\nimport {unregisterPluginTranslationsSource} from 'actions/views/root';\nimport {unregisterAdminConsolePlugin} from 'actions/admin_actions';\n\n// Plugins may have been compiled with the regenerator runtime. Ensure this remains available\n// as a global export even though the webapp does not depend on same.\nwindow.regeneratorRuntime = regeneratorRuntime;\n\n// plugins records all active web app plugins by id.\nwindow.plugins = {};\n\n// registerPlugin, on the global window object, should be invoked by a plugin's web app bundle as\n// it is loaded.\n//\n// During the beta, plugins manipulated the global window.plugins data structure directly. This\n// remains possible, but is officially deprecated and may be removed in a future release.\nfunction registerPlugin(id, plugin) {\n    window.plugins[id] = plugin;\n}\nwindow.registerPlugin = registerPlugin;\n\n// initializePlugins queries the server for all enabled plugins and loads each in turn.\nexport async function initializePlugins() {\n    if (store.getState().entities.general.config.PluginsEnabled !== 'true') {\n        return;\n    }\n\n    const {data, error} = await getPlugins()(store.dispatch);\n    if (error) {\n        console.error(error); //eslint-disable-line no-console\n        return;\n    }\n\n    if (data == null || data.length === 0) {\n        return;\n    }\n\n    await Promise.all(data.map((m) => {\n        return loadPlugin(m).catch((loadErr) => {\n            console.error(loadErr.message); //eslint-disable-line no-console\n        });\n    }));\n}\n\n// getPlugins queries the server for all enabled plugins\nexport function getPlugins() {\n    return async (dispatch) => {\n        let plugins;\n        try {\n            plugins = await Client4.getWebappPlugins();\n        } catch (error) {\n            return {error};\n        }\n\n        dispatch({type: ActionTypes.RECEIVED_WEBAPP_PLUGINS, data: plugins});\n\n        return {data: plugins};\n    };\n}\n\n// loadedPlugins tracks which plugins have been added as script tags to the page\nconst loadedPlugins = {};\n\n// loadPlugin fetches the web app bundle described by the given manifest, waits for the bundle to\n// load, and then ensures the plugin has been initialized.\nexport function loadPlugin(manifest) {\n    return new Promise((resolve, reject) => {\n        // Don't load it again if previously loaded\n        const oldManifest = loadedPlugins[manifest.id];\n        if (oldManifest && oldManifest.webapp.bundle_path === manifest.webapp.bundle_path) {\n            resolve();\n            return;\n        }\n\n        if (oldManifest) {\n            // upgrading, perform cleanup\n            store.dispatch({type: ActionTypes.REMOVED_WEBAPP_PLUGIN, data: manifest});\n        }\n\n        function onLoad() {\n            initializePlugin(manifest);\n            console.log('Loaded ' + manifest.id + ' plugin'); //eslint-disable-line no-console\n            resolve();\n        }\n\n        function onError() {\n            reject(new Error('Unable to load bundle for plugin ' + manifest.id));\n        }\n\n        // Backwards compatibility for old plugins\n        let bundlePath = manifest.webapp.bundle_path;\n        if (bundlePath.includes('/static/') && !bundlePath.includes('/static/plugins/')) {\n            bundlePath = bundlePath.replace('/static/', '/static/plugins/');\n        }\n\n        console.log('Loading ' + manifest.id + ' plugin'); //eslint-disable-line no-console\n\n        const script = document.createElement('script');\n        script.id = 'plugin_' + manifest.id;\n        script.type = 'text/javascript';\n        script.src = getSiteURL() + bundlePath;\n        script.onload = onLoad;\n        script.onerror = onError;\n\n        document.getElementsByTagName('head')[0].appendChild(script);\n        loadedPlugins[manifest.id] = manifest;\n    });\n}\n\n// initializePlugin creates a registry specific to the plugin and invokes any initialize function\n// on the registered plugin class.\nfunction initializePlugin(manifest) {\n    // Initialize the plugin\n    const plugin = window.plugins[manifest.id];\n    const registry = new PluginRegistry(manifest.id);\n    if (plugin && plugin.initialize) {\n        plugin.initialize(registry, store);\n    }\n}\n\n// removePlugin triggers any uninitialize callback on the registered plugin, unregisters any\n// event handlers, and removes the plugin script from the DOM entirely. The plugin is responsible\n// for removing any of its registered components.\nexport function removePlugin(manifest) {\n    if (!loadedPlugins[manifest.id]) {\n        return;\n    }\n    console.log('Removing ' + manifest.id + ' plugin'); //eslint-disable-line no-console\n\n    delete loadedPlugins[manifest.id];\n\n    store.dispatch({type: ActionTypes.REMOVED_WEBAPP_PLUGIN, data: manifest});\n\n    const plugin = window.plugins[manifest.id];\n    if (plugin && plugin.uninitialize) {\n        plugin.uninitialize();\n\n    // Support the deprecated deinitialize callback from the plugins beta.\n    } else if (plugin && plugin.deinitialize) {\n        plugin.deinitialize();\n    }\n    unregisterAllPluginWebSocketEvents(manifest.id);\n    unregisterPluginReconnectHandler(manifest.id);\n    store.dispatch(unregisterAdminConsolePlugin(manifest.id));\n    unregisterPluginTranslationsSource(manifest.id);\n    const script = document.getElementById('plugin_' + manifest.id);\n    if (!script) {\n        return;\n    }\n    script.parentNode.removeChild(script);\n    console.log('Removed ' + manifest.id + ' plugin'); //eslint-disable-line no-console\n}\n\n// loadPluginsIfNecessary synchronizes the current state of loaded plugins with that of the server,\n// loading any newly added plugins and unloading any removed ones.\nexport async function loadPluginsIfNecessary() {\n    if (store.getState().entities.general.config.PluginsEnabled !== 'true') {\n        return;\n    }\n\n    const oldManifests = store.getState().plugins.plugins;\n\n    const {error} = await getPlugins()(store.dispatch);\n    if (error) {\n        console.error(error); //eslint-disable-line no-console\n        return;\n    }\n\n    const newManifests = store.getState().plugins.plugins;\n\n    // Get new plugins and update existing plugins if version changed\n    Object.values(newManifests).forEach((newManifest) => {\n        const oldManifest = oldManifests[newManifest.id];\n        if (!oldManifest || oldManifest.version !== newManifest.version) {\n            loadPlugin(newManifest).catch((loadErr) => {\n                console.error(loadErr.message); //eslint-disable-line no-console\n            });\n        }\n    });\n\n    // Remove old plugins\n    Object.keys(oldManifests).forEach((id) => {\n        if (!newManifests.hasOwnProperty(id)) {\n            const oldManifest = oldManifests[id];\n            store.dispatch({type: ActionTypes.REMOVED_WEBAPP_PLUGIN, data: oldManifest});\n            removePlugin(oldManifest);\n        }\n    });\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\nimport MattermostLogo from 'components/widgets/icons/mattermost_logo';\n\nimport {AboutLinks} from 'utils/constants';\n\nexport default class AboutBuildModal extends React.PureComponent {\n    static defaultProps = {\n        show: false,\n    };\n\n    static propTypes = {\n\n        /**\n         * Function that is called when the modal is dismissed\n         */\n        onHide: PropTypes.func.isRequired,\n\n        /**\n         * Global config object\n         */\n        config: PropTypes.object.isRequired,\n\n        /**\n         * Global license object\n         */\n        license: PropTypes.object.isRequired,\n\n        /**\n         * Webapp build hash override. By default, webpack sets this (so it must be overridden in tests).\n         */\n        webappBuildHash: PropTypes.string,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            show: true,\n        };\n    }\n\n    doHide = () => {\n        this.setState({show: false});\n    }\n\n    handleExit = () => {\n        this.props.onHide();\n    }\n\n    render() {\n        const config = this.props.config;\n        const license = this.props.license;\n\n        let title = (\n            <FormattedMessage\n                id='about.teamEditiont0'\n                defaultMessage='Team Edition'\n            />\n        );\n\n        let subTitle = (\n            <FormattedMessage\n                id='about.teamEditionSt'\n                defaultMessage='All your team communication in one place, instantly searchable and accessible anywhere.'\n            />\n        );\n\n        let learnMore = (\n            <div>\n                <FormattedMessage\n                    id='about.teamEditionLearn'\n                    defaultMessage='Join the Mattermost community at '\n                />\n                <a\n                    target='_blank'\n                    rel='noopener noreferrer'\n                    href='http://www.mattermost.org/'\n                >\n                    {'mattermost.org'}\n                </a>\n            </div>\n        );\n\n        let licensee;\n        if (config.BuildEnterpriseReady === 'true') {\n            title = (\n                <FormattedMessage\n                    id='about.teamEditiont1'\n                    defaultMessage='Enterprise Edition'\n                />\n            );\n\n            subTitle = (\n                <FormattedMessage\n                    id='about.enterpriseEditionSt'\n                    defaultMessage='Modern communication from behind your firewall.'\n                />\n            );\n\n            learnMore = (\n                <div>\n                    <FormattedMessage\n                        id='about.enterpriseEditionLearn'\n                        defaultMessage='Learn more about Enterprise Edition at '\n                    />\n                    <a\n                        target='_blank'\n                        rel='noopener noreferrer'\n                        href='http://about.mattermost.com/'\n                    >\n                        {'about.mattermost.com'}\n                    </a>\n                </div>\n            );\n\n            if (license.IsLicensed === 'true') {\n                title = (\n                    <FormattedMessage\n                        id='about.enterpriseEditione1'\n                        defaultMessage='Enterprise Edition'\n                    />\n                );\n                licensee = (\n                    <div className='form-group'>\n                        <FormattedMessage\n                            id='about.licensed'\n                            defaultMessage='Licensed to:'\n                        />\n                        &nbsp;{license.Company}\n                    </div>\n                );\n            }\n        }\n\n        const termsOfService = (\n            <a\n                target='_blank'\n                id='tosLink'\n                rel='noopener noreferrer'\n                href={AboutLinks.TERMS_OF_SERVICE}\n            >\n                <FormattedMessage\n                    id='about.tos'\n                    defaultMessage='Terms of Service'\n                />\n            </a>\n        );\n\n        const privacyPolicy = (\n            <a\n                target='_blank'\n                id='privacyLink'\n                rel='noopener noreferrer'\n                href={AboutLinks.PRIVACY_POLICY}\n            >\n                <FormattedMessage\n                    id='about.privacy'\n                    defaultMessage='Privacy Policy'\n                />\n            </a>\n        );\n\n        let tosPrivacyHyphen;\n        if (config.TermsOfServiceLink && config.PrivacyPolicyLink) {\n            tosPrivacyHyphen = (\n                <span>\n                    {' - '}\n                </span>\n            );\n        }\n\n        // Only show build number if it's a number (so only builds from Jenkins)\n        let buildnumber = (\n            <div>\n                <FormattedMessage\n                    id='about.buildnumber'\n                    defaultMessage='Build Number:'\n                />\n                <span id='buildnumberString'>{'\\u00a0' + config.BuildNumber}</span>\n            </div>\n        );\n        if (isNaN(config.BuildNumber)) {\n            buildnumber = null;\n        }\n\n        let mmversion = config.BuildNumber;\n        if (!isNaN(config.BuildNumber)) {\n            mmversion = 'ci';\n        }\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal about-modal'\n                show={this.state.show}\n                onHide={this.doHide}\n                onExited={this.handleExit}\n                role='dialog'\n                aria-labelledby='aboutModalLabel'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='aboutModalLabel'\n                    >\n                        <FormattedMessage\n                            id='about.title'\n                            values={{appTitle: config.SiteName || 'Mattermost'}}\n                            defaultMessage='About {appTitle}'\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <div className='about-modal__content'>\n                        <div className='about-modal__logo'>\n                            <MattermostLogo/>\n                        </div>\n                        <div>\n                            <h3 className='about-modal__title'>{'Mattermost'} {title}</h3>\n                            <p className='about-modal__subtitle pb-2'>{subTitle}</p>\n                            <div className='form-group less'>\n                                <div>\n                                    <FormattedMessage\n                                        id='about.version'\n                                        defaultMessage='Mattermost Version:'\n                                    />\n                                    <span id='versionString'>{'\\u00a0' + mmversion}</span>\n                                </div>\n                                <div>\n                                    <FormattedMessage\n                                        id='about.dbversion'\n                                        defaultMessage='Database Schema Version:'\n                                    />\n                                    <span id='dbversionString'>{'\\u00a0' + config.Version}</span>\n                                </div>\n                                {buildnumber}\n                                <div>\n                                    <FormattedMessage\n                                        id='about.database'\n                                        defaultMessage='Database:'\n                                    />\n                                    {'\\u00a0' + config.SQLDriverName}\n                                </div>\n                            </div>\n                            {licensee}\n                        </div>\n                    </div>\n                    <div className='about-modal__footer'>\n                        {learnMore}\n                        <div className='form-group'>\n                            <div className='about-modal__copyright'>\n                                <FormattedMessage\n                                    id='about.copyright'\n                                    defaultMessage='Copyright 2015 - {currentYear} Mattermost, Inc. All rights reserved'\n                                    values={{\n                                        currentYear: new Date().getFullYear(),\n                                    }}\n                                />\n                            </div>\n                            <div className='about-modal__links'>\n                                {termsOfService}\n                                {tosPrivacyHyphen}\n                                {privacyPolicy}\n                            </div>\n                        </div>\n                    </div>\n                    <div className='about-modal__notice form-group pt-3'>\n                        <p>\n                            <FormattedMarkdownMessage\n                                id='about.notice'\n                                defaultMessage='Mattermost is made possible by the open source software used in our [server](!https://about.mattermost.com/platform-notice-txt/), [desktop](!https://about.mattermost.com/desktop-notice-txt/) and [mobile](!https://about.mattermost.com/mobile-notice-txt/) apps.'\n                            />\n                        </p>\n                    </div>\n                    <div className='about-modal__hash'>\n                        <p>\n                            <FormattedMessage\n                                id='about.hash'\n                                defaultMessage='Build Hash:'\n                            />\n                            &nbsp;{config.BuildHash}\n                            <br/>\n                            <FormattedMessage\n                                id='about.hashee'\n                                defaultMessage='EE Build Hash:'\n                            />\n                            &nbsp;{config.BuildHashEnterprise}\n                            <br/>\n                            <FormattedMessage\n                                id='about.hashwebapp'\n                                defaultMessage='Webapp Build Hash:'\n                            />\n                            &nbsp;{/* global COMMIT_HASH */ this.props.webappBuildHash || (typeof COMMIT_HASH === 'undefined' ? '' : COMMIT_HASH)}\n                        </p>\n                        <p>\n                            <FormattedMessage\n                                id='about.date'\n                                defaultMessage='Build Date:'\n                            />\n                            &nbsp;{config.BuildDate}\n                        </p>\n                    </div>\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getConfig, getLicense} from 'mattermost-redux/selectors/entities/general';\n\nimport {ModalIdentifiers} from 'utils/constants';\nimport {isModalOpen} from 'selectors/views/modals';\n\nimport AboutBuildModal from './about_build_modal.jsx';\n\nfunction mapStateToProps(state) {\n    const modalId = ModalIdentifiers.ABOUT;\n    return {\n        config: getConfig(state),\n        license: getLicense(state),\n        show: isModalOpen(state, modalId),\n    };\n}\n\nexport default connect(mapStateToProps)(AboutBuildModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport FastClick from 'fastclick';\nimport {Route, Switch, Redirect} from 'react-router-dom';\nimport {setUrl} from 'mattermost-redux/actions/general';\nimport {setSystemEmojis} from 'mattermost-redux/actions/emojis';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport * as UserAgent from 'utils/user_agent';\nimport {EmojiIndicesByAlias} from 'utils/emoji.jsx';\nimport {trackLoadTime} from 'actions/diagnostics_actions.jsx';\nimport * as GlobalActions from 'actions/global_actions.jsx';\nimport BrowserStore from 'stores/browser_store.jsx';\nimport {loadRecentlyUsedCustomEmojis} from 'actions/emoji_actions.jsx';\nimport {initializePlugins} from 'plugins';\nimport 'plugins/export.js';\nimport Constants, {StoragePrefixes} from 'utils/constants';\nimport {HFTRoute, LoggedInHFTRoute} from 'components/header_footer_template_route';\nimport IntlProvider from 'components/intl_provider';\nimport NeedsTeam from 'components/needs_team';\nimport PermalinkRedirector from 'components/permalink_redirector';\nimport {makeAsyncComponent} from 'components/async_load';\n\nconst LazyErrorPage = React.lazy(() => import('components/error_page'));\nconst LazyLoginController = React.lazy(() => import('components/login/login_controller'));\nconst LazyAdminConsole = React.lazy(() => import('components/admin_console'));\nconst LazyLoggedIn = React.lazy(() => import('components/logged_in'));\nconst LazyPasswordResetSendLink = React.lazy(() => import('components/password_reset_send_link'));\nconst LazyPasswordResetForm = React.lazy(() => import('components/password_reset_form'));\nconst LazySignupController = React.lazy(() => import('components/signup/signup_controller'));\nconst LazySignupEmail = React.lazy(() => import('components/signup/signup_email'));\nconst LazyTermsOfService = React.lazy(() => import('components/terms_of_service'));\nconst LazyShouldVerifyEmail = React.lazy(() => import('components/should_verify_email'));\nconst LazyDoVerifyEmail = React.lazy(() => import('components/do_verify_email'));\nconst LazyClaimController = React.lazy(() => import('components/claim'));\nconst LazyHelpController = React.lazy(() => import('components/help/help_controller'));\nconst LazyLinkingLandingPage = React.lazy(() => import('components/linking_landing_page'));\nconst LazySelectTeam = React.lazy(() => import('components/select_team'));\nconst LazyAuthorize = React.lazy(() => import('components/authorize'));\nconst LazyCreateTeam = React.lazy(() => import('components/create_team'));\nconst LazyMfa = React.lazy(() => import('components/mfa/mfa_controller'));\n\nimport store from 'stores/redux_store.jsx';\nimport {getSiteURL} from 'utils/url';\nimport {enableDevModeFeatures, isDevMode} from 'utils/utils';\n\nimport A11yController from 'utils/a11y_controller';\n\nconst CreateTeam = makeAsyncComponent(LazyCreateTeam);\nconst ErrorPage = makeAsyncComponent(LazyErrorPage);\nconst TermsOfService = makeAsyncComponent(LazyTermsOfService);\nconst LoginController = makeAsyncComponent(LazyLoginController);\nconst AdminConsole = makeAsyncComponent(LazyAdminConsole);\nconst LoggedIn = makeAsyncComponent(LazyLoggedIn);\nconst PasswordResetSendLink = makeAsyncComponent(LazyPasswordResetSendLink);\nconst PasswordResetForm = makeAsyncComponent(LazyPasswordResetForm);\nconst SignupController = makeAsyncComponent(LazySignupController);\nconst SignupEmail = makeAsyncComponent(LazySignupEmail);\nconst ShouldVerifyEmail = makeAsyncComponent(LazyShouldVerifyEmail);\nconst DoVerifyEmail = makeAsyncComponent(LazyDoVerifyEmail);\nconst ClaimController = makeAsyncComponent(LazyClaimController);\nconst HelpController = makeAsyncComponent(LazyHelpController);\nconst LinkingLandingPage = makeAsyncComponent(LazyLinkingLandingPage);\nconst SelectTeam = makeAsyncComponent(LazySelectTeam);\nconst Authorize = makeAsyncComponent(LazyAuthorize);\nconst Mfa = makeAsyncComponent(LazyMfa);\n\nconst LoggedInRoute = ({component: Component, ...rest}) => (\n    <Route\n        {...rest}\n        render={(props) => (\n            <LoggedIn {...props}>\n                <Component {...props}/>\n            </LoggedIn>\n        )}\n    />\n);\n\nexport default class Root extends React.Component {\n    static propTypes = {\n        diagnosticsEnabled: PropTypes.bool,\n        diagnosticId: PropTypes.string,\n        noAccounts: PropTypes.bool,\n        showTermsOfService: PropTypes.bool,\n        actions: PropTypes.shape({\n            loadMeAndConfig: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n        this.currentCategoryFocus = 0;\n        this.currentSidebarFocus = 0;\n\n        // Redux\n        setUrl(getSiteURL());\n\n        setSystemEmojis(EmojiIndicesByAlias);\n\n        // Force logout of all tabs if one tab is logged out\n        $(window).bind('storage', (e) => {\n            // when one tab on a browser logs out, it sets __logout__ in localStorage to trigger other tabs to log out\n            if (e.originalEvent.key === StoragePrefixes.LOGOUT && e.originalEvent.storageArea === localStorage && e.originalEvent.newValue) {\n                // make sure it isn't this tab that is sending the logout signal (only necessary for IE11)\n                if (BrowserStore.isSignallingLogout(e.originalEvent.newValue)) {\n                    return;\n                }\n\n                console.log('detected logout from a different tab'); //eslint-disable-line no-console\n                GlobalActions.emitUserLoggedOutEvent('/', false, false);\n            }\n\n            if (e.originalEvent.key === StoragePrefixes.LOGIN && e.originalEvent.storageArea === localStorage && e.originalEvent.newValue) {\n                // make sure it isn't this tab that is sending the logout signal (only necessary for IE11)\n                if (BrowserStore.isSignallingLogin(e.originalEvent.newValue)) {\n                    return;\n                }\n\n                console.log('detected login from a different tab'); //eslint-disable-line no-console\n                location.reload();\n            }\n        });\n\n        // Prevent drag and drop files from navigating away from the app\n        document.addEventListener('drop', (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n        });\n\n        document.addEventListener('dragover', (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n        });\n\n        // Fastclick\n        FastClick.attach(document.body);\n\n        this.state = {\n            configLoaded: false,\n        };\n\n        // Keyboard navigation for accessibility\n        if (!UserAgent.isInternetExplorer()) {\n            this.a11yController = new A11yController();\n        }\n    }\n\n    onConfigLoaded = () => {\n        if (isDevMode()) {\n            enableDevModeFeatures();\n        }\n\n        const segmentKey = Constants.DIAGNOSTICS_SEGMENT_KEY;\n        const diagnosticId = this.props.diagnosticId;\n\n        /*eslint-disable */\n        if (segmentKey != null && segmentKey !== '' && !segmentKey.startsWith('placeholder') && this.props.diagnosticsEnabled) {\n            !function(){var analytics=global.window.analytics=global.window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error(\"Segment snippet included twice.\");else{analytics.invoked=!0;analytics.methods=[\"trackSubmit\",\"trackClick\",\"trackLink\",\"trackForm\",\"pageview\",\"identify\",\"group\",\"track\",\"ready\",\"alias\",\"page\",\"once\",\"off\",\"on\"];analytics.factory=function(t){return function(...args){var e=Array.prototype.slice.call(args);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement(\"script\");e.type=\"text/javascript\";e.async=!0;e.src=(\"https:\"===document.location.protocol ? \"https://\":\"http://\")+\"cdn.segment.com/analytics.js/v1/\"+t+\"/analytics.min.js\";var n=document.getElementsByTagName(\"script\")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION=\"3.0.1\";\n                analytics.load(segmentKey);\n\n                analytics.identify(diagnosticId, {}, {\n                    context: {\n                        ip: '0.0.0.0',\n                    },\n                    page: {\n                        path: '',\n                        referrer: '',\n                        search: '',\n                        title: '',\n                        url: '',\n                    },\n                    anonymousId: '00000000000000000000000000',\n                });\n\n                analytics.page('ApplicationLoaded', {\n                        path: '',\n                        referrer: '',\n                        search: '',\n                        title: '',\n                        url: '',\n                    },\n                    {\n                        context: {\n                            ip: '0.0.0.0'\n                        },\n                        anonymousId: '00000000000000000000000000'\n                    });\n            }}();\n        }\n        /*eslint-enable */\n\n        if (this.props.location.pathname === '/' && this.props.noAccounts) {\n            this.props.history.push('/signup_user_complete');\n        }\n\n        initializePlugins().then(() => {\n            this.setState({configLoaded: true});\n        });\n\n        loadRecentlyUsedCustomEmojis()(store.dispatch, store.getState);\n\n        const iosDownloadLink = getConfig(store.getState()).IosAppDownloadLink;\n        const androidDownloadLink = getConfig(store.getState()).AndroidAppDownloadLink;\n\n        const toResetPasswordScreen = this.props.location.pathname === '/reset_password_complete';\n\n        // redirect to the mobile landing page if the user hasn't seen it before\n        let mobileLanding;\n        if (UserAgent.isAndroidWeb()) {\n            mobileLanding = androidDownloadLink;\n        } else if (UserAgent.isIosWeb()) {\n            mobileLanding = iosDownloadLink;\n        }\n\n        if (mobileLanding && !BrowserStore.hasSeenLandingPage() && !toResetPasswordScreen && !this.props.location.pathname.includes('/landing')) {\n            this.props.history.push('/landing#' + this.props.location.pathname + this.props.location.search);\n            BrowserStore.setLandingPageSeen(true);\n        }\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.location.pathname === '/') {\n            if (this.props.noAccounts) {\n                prevProps.history.push('/signup_user_complete');\n            } else if (this.props.showTermsOfService) {\n                prevProps.history.push('/terms_of_service');\n            }\n        }\n    }\n\n    componentDidMount() {\n        this.props.actions.loadMeAndConfig().then((response) => {\n            if (this.props.location.pathname === '/' && response[2] && response[2].data) {\n                GlobalActions.redirectUserToDefaultTeam();\n            }\n            this.onConfigLoaded();\n        });\n        trackLoadTime();\n    }\n\n    componentWillUnmount() {\n        $(window).unbind('storage');\n    }\n\n    render() {\n        if (!this.state.configLoaded) {\n            return <div/>;\n        }\n\n        return (\n            <IntlProvider>\n                <Switch>\n                    <Route\n                        path={'/error'}\n                        component={ErrorPage}\n                    />\n                    <HFTRoute\n                        path={'/login'}\n                        component={LoginController}\n                    />\n                    <HFTRoute\n                        path={'/reset_password'}\n                        component={PasswordResetSendLink}\n                    />\n                    <HFTRoute\n                        path={'/reset_password_complete'}\n                        component={PasswordResetForm}\n                    />\n                    <HFTRoute\n                        path={'/signup_user_complete'}\n                        component={SignupController}\n                    />\n                    <HFTRoute\n                        path={'/signup_email'}\n                        component={SignupEmail}\n                    />\n                    <HFTRoute\n                        path={'/should_verify_email'}\n                        component={ShouldVerifyEmail}\n                    />\n                    <HFTRoute\n                        path={'/do_verify_email'}\n                        component={DoVerifyEmail}\n                    />\n                    <HFTRoute\n                        path={'/claim'}\n                        component={ClaimController}\n                    />\n                    <HFTRoute\n                        path={'/help'}\n                        component={HelpController}\n                    />\n                    <LoggedInRoute\n                        path={'/terms_of_service'}\n                        component={TermsOfService}\n                    />\n                    <Route\n                        path={'/landing'}\n                        component={LinkingLandingPage}\n                    />\n                    <LoggedInRoute\n                        path={'/admin_console'}\n                        component={AdminConsole}\n                    />\n                    <LoggedInHFTRoute\n                        path={'/select_team'}\n                        component={SelectTeam}\n                    />\n                    <LoggedInHFTRoute\n                        path={'/oauth/authorize'}\n                        component={Authorize}\n                    />\n                    <LoggedInHFTRoute\n                        path={'/create_team'}\n                        component={CreateTeam}\n                    />\n                    <LoggedInRoute\n                        path={'/mfa'}\n                        component={Mfa}\n                    />\n                    <LoggedInRoute\n                        path={['/_redirect/integrations*', '/_redirect/pl/:postid']}\n                        component={PermalinkRedirector}\n                    />\n                    <LoggedInRoute\n                        path={'/:team'}\n                        component={NeedsTeam}\n                    />\n                    <Redirect\n                        to={{\n                            ...this.props.location,\n                            pathname: '/login',\n                        }}\n                    />\n                </Switch>\n            </IntlProvider>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {ActionTypes} from 'utils/constants';\n\nexport function incrementWsErrorCount() {\n    return async (dispatch) => {\n        dispatch({\n            type: ActionTypes.INCREMENT_WS_ERROR_COUNT,\n        });\n    };\n}\n\nexport function resetWsErrorCount() {\n    return async (dispatch) => {\n        dispatch({\n            type: ActionTypes.RESET_WS_ERROR_COUNT,\n        });\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React, {RefObject, MouseEvent, CSSProperties} from 'react';\nimport Popper from 'popper.js';\nimport ReactDOM from 'react-dom';\n\nimport {Constants} from 'utils/constants';\nimport Pluggable from 'plugins/pluggable';\n\nconst tooltipContainerStyles: CSSProperties = {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    zIndex: 10,\n};\n\ntype Props = {\n    href: string;\n    title: string;\n}\n\nexport default class LinkTooltip extends React.PureComponent<Props> {\n    public static propTypes = {\n        href: PropTypes.string.isRequired,\n        title: PropTypes.string.isRequired,\n    };\n    private tooltipContainerRef: RefObject<any>;\n    private show: boolean;\n    private hideTimeout: number;\n    private showTimeout: number;\n    private popper?: Popper;\n\n    public constructor(props: Props) {\n        super(props);\n\n        this.tooltipContainerRef = React.createRef();\n        this.show = false;\n        this.showTimeout = -1;\n        this.hideTimeout = -1;\n    }\n\n    public showTooltip = (e: any): void => {\n        //clear the hideTimeout in the case when the cursor is moved from a tooltipContainer child to the link\n        window.clearTimeout(this.hideTimeout);\n\n        if (!this.show) {\n            const $target: JQuery = $(e.target);\n            const target: Element = $target.get(0);\n            const $tooltipContainer: JQuery = $(this.tooltipContainerRef.current);\n            const tooltipContainer: Element = $tooltipContainer.get(0);\n\n            //clear the old this.showTimeout if there is any before overriding\n            window.clearTimeout(this.showTimeout);\n\n            this.showTimeout = window.setTimeout(() => {\n                this.show = true;\n\n                $tooltipContainer.show();\n                $tooltipContainer.children().on('mouseover', () => clearTimeout(this.hideTimeout));\n                $tooltipContainer.children().on('mouseleave', (event: JQueryEventObject) => {\n                    if (event.relatedTarget !== null) {\n                        this.hideTooltip();\n                    }\n                });\n\n                this.popper = new Popper(target, tooltipContainer, {\n                    placement: 'bottom',\n                    modifiers: {\n                        preventOverflow: {enabled: false},\n                        hide: {enabled: false},\n                    },\n                });\n            }, Constants.OVERLAY_TIME_DELAY);\n        }\n    };\n\n    public hideTooltip = (): void => {\n        //clear the old this.hideTimeout if there is any before overriding\n        window.clearTimeout(this.hideTimeout);\n\n        this.hideTimeout = window.setTimeout(() => {\n            this.show = false;\n\n            //prevent executing the showTimeout after the hideTooltip\n            clearTimeout(this.showTimeout);\n\n            $(this.tooltipContainerRef.current).hide();\n        }, Constants.OVERLAY_TIME_DELAY_SMALL);\n    };\n\n    public render() {\n        const {href, title} = this.props;\n        return (\n            <React.Fragment>\n                {ReactDOM.createPortal(\n                    <div\n                        style={tooltipContainerStyles}\n                        ref={this.tooltipContainerRef}\n                    >\n                        <Pluggable\n                            href={href}\n                            pluggableName='LinkTooltip'\n                        />\n                    </div>,\n                    document.getElementById('root') as HTMLElement\n                )}\n                <span\n                    onMouseOver={this.showTooltip}\n                    onMouseLeave={this.hideTooltip}\n                >\n                    {title}\n                </span>\n            </React.Fragment>\n        );\n    }\n}\n\n","module.exports = __webpack_public_path__ + \"files/32c2bbd0baa32c30ead015bd2c22222d.png\";","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Route} from 'react-router-dom';\n\nconst HeaderFooterTemplate = React.lazy(() => import('components/header_footer_template'));\nconst LoggedIn = React.lazy(() => import('components/logged_in'));\n\nexport const HFTRoute = ({component: Component, ...rest}) => (\n    <Route\n        {...rest}\n        render={(props) => (\n            <React.Suspense fallback={null}>\n                <HeaderFooterTemplate {...props}>\n                    <Component {...props}/>\n                </HeaderFooterTemplate>\n            </React.Suspense>\n        )}\n    />\n);\n\nexport const LoggedInHFTRoute = ({component: Component, ...rest}) => (\n    <Route\n        {...rest}\n        render={(props) => (\n            <React.Suspense fallback={null}>\n                <LoggedIn {...props}>\n                    <React.Suspense fallback={null}>\n                        <HeaderFooterTemplate {...props}>\n                            <Component {...props}/>\n                        </HeaderFooterTemplate>\n                    </React.Suspense>\n                </LoggedIn>\n            </React.Suspense>\n        )}\n    />\n);\n","module.exports = __webpack_public_path__ + \"files/3fee6e80a205e777a5acde9c16a90e55.png\";","module.exports = __webpack_public_path__ + \"files/6f4421b97edade53cd63705875f17a2a.png\";","module.exports = __webpack_public_path__ + \"files/bd956aafccffed574da236f21af209ef.gif\";","module.exports = __webpack_public_path__ + \"files/8b03642d36741ba3030a9004a1d56bb0.gif\";","module.exports = __webpack_public_path__ + \"files/c86ea01a44f1291289b4af3eeb01f261.png\";","module.exports = __webpack_public_path__ + \"files/8713c219cc92b0b4a2cc51f6eca009ca.png\";","module.exports = __webpack_public_path__ + \"files/6235966ceb0e6178c3f38e2be5f99035.png\";","module.exports = __webpack_public_path__ + \"files/0cacb9957a05c04c70242a5d2ce0d40c.png\";","module.exports = __webpack_public_path__ + \"files/5b30cabcbe85724f286c54208eaa1120.png\";","module.exports = __webpack_public_path__ + \"files/7cb508f6703ab3fc4adc463665732dc9.png\";","module.exports = __webpack_public_path__ + \"files/a84f8d6c46d2619f5864f2e6cd7e5c95.png\";","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport Constants, {EventTypes, A11yClassNames, A11yAttributeNames, A11yCustomEventTypes} from 'utils/constants';\nimport {isKeyPressed, cmdOrCtrlPressed, isMac} from 'utils/utils';\nimport {isDesktopApp} from 'utils/user_agent';\n\nconst listenerOptions = {\n    capture: true,\n};\n\nexport default class A11yController {\n    constructor() {\n        this.regionHTMLCollection = this.getAllRegions();\n        this.sectionHTMLCollection = null; // populated when region changes\n        this.modalHTMLCollection = this.getAllModals();\n        this.popupHTMLCollection = this.getAllPopups();\n\n        this.activeRegion = null;\n        this.activeSection = null;\n        this.activeElement = null;\n\n        this.mouseIsPressed = false;\n\n        this.lastInputEventIsKeyboard = false;\n\n        this.enterKeyIsPressed = false;\n        this.f6KeyIsPressed = false;\n        this.upArrowKeyIsPressed = false;\n        this.downArrowKeyIsPressed = false;\n        this.tabKeyIsPressed = false;\n        this.tildeKeyIsPressed = false;\n        this.lKeyIsPressed = false;\n        this.windowIsFocused = true;\n\n        // used to reset navigation whenever navigation within a region occurs (section or element)\n        this.resetNavigation = false;\n\n        document.addEventListener(EventTypes.KEY_DOWN, this.handleKeyDown, listenerOptions);\n        document.addEventListener(EventTypes.KEY_UP, this.handleKeyUp, listenerOptions);\n        document.addEventListener(EventTypes.CLICK, this.handleMouseClick, listenerOptions);\n        document.addEventListener(EventTypes.MOUSE_DOWN, this.handleMouseDown, listenerOptions);\n        document.addEventListener(EventTypes.MOUSE_UP, this.handleMouseUp, listenerOptions);\n        document.addEventListener(EventTypes.FOCUS, this.handleFocus, listenerOptions);\n        window.addEventListener(EventTypes.BLUR, this.handleWindowBlur, listenerOptions);\n    }\n\n    destroy() {\n        this.clearActiveRegion();\n        this.clearCurrentFocus();\n\n        document.removeEventListener(EventTypes.KEY_DOWN, this.handleKeyDown, listenerOptions);\n        document.removeEventListener(EventTypes.KEY_UP, this.handleKeyUp, listenerOptions);\n        document.removeEventListener(EventTypes.CLICK, this.handleMouseClick, listenerOptions);\n        document.removeEventListener(EventTypes.MOUSE_DOWN, this.handleMouseDown, listenerOptions);\n        document.removeEventListener(EventTypes.MOUSE_UP, this.handleMouseUp, listenerOptions);\n        document.removeEventListener(EventTypes.FOCUS, this.handleFocus, listenerOptions);\n        window.removeEventListener(EventTypes.BLUR, this.handleWindowBlur, listenerOptions);\n    }\n\n    // convenience getter/setters\n\n    /**\n     * Determines if keyboard navigation is currently in progress based on several criteria as follows:\n     * 1. There must be defined regions and a single region must be active\n     * 2. The last input event detected must be a keyboard event\n     * 3. There must be no open modals and/or popups\n     * 4. There must be an active element and it must support classList\n     */\n    get navigationInProgress() {\n        if (!this.regions || !this.regions.length || !this.isElementValid(this.activeRegion)) {\n            return false;\n        }\n        if (!this.lastInputEventIsKeyboard) {\n            return false;\n        }\n        if (this.modalIsOpen || this.popupIsOpen) {\n            return false;\n        }\n        if (!this.isElementValid(this.activeElement)) {\n            return false;\n        }\n        return true;\n    }\n\n    /**\n     * Returns an array of available regions sorted by A11yAttributeNames.SORT_ORDER\n     */\n    get regions() {\n        let domElements = this.sortElementsByAttributeOrder(this.regionHTMLCollection);\n        domElements = domElements.filter((element) => {\n            return this.elementIsVisible(element);\n        });\n        return domElements;\n    }\n\n    /**\n     * Returns an array of available sections sorted by A11yAttributeNames.SORT_ORDER and optionally reversed\n     */\n    get sections() {\n        let domElements = this.sortElementsByAttributeOrder(this.sectionHTMLCollection);\n        domElements = domElements.filter((element) => {\n            return this.elementIsVisible(element);\n        });\n        if (this.shouldReverseSections) {\n            domElements.reverse();\n        }\n        return domElements;\n    }\n\n    /**\n     * Returns the index of the active region\n     */\n    get activeRegionIndex() {\n        if (!this.activeRegion) {\n            return null;\n        }\n        return this.regions.indexOf(this.activeRegion);\n    }\n\n    /**\n     * Returns the index of the active section\n     */\n    get activeSectionIndex() {\n        if (!this.activeSection) {\n            return null;\n        }\n        return this.sections.indexOf(this.activeSection);\n    }\n\n    /**\n     * Returns whether the regions requires reverse section navigation\n     */\n    get shouldReverseSections() {\n        if (!this.activeRegion) {\n            return false;\n        }\n        return this.getOrderReverseAttribute(this.activeRegion);\n    }\n\n    /**\n     * Returns the element that should currently have focus\n     */\n    get focusedElement() {\n        let focusedElement;\n        if (this.activeElement) {\n            focusedElement = this.activeElement;\n        } else if (this.activeSection) {\n            focusedElement = this.activeSection;\n        } else if (this.activeRegion) {\n            focusedElement = this.activeRegion;\n        }\n        return focusedElement;\n    }\n\n    /**\n     * Returnes whether an a11y-specific key is currently pressed\n     */\n    get a11yKeyIsPressed() {\n        return this.f6KeyIsPressed ||\n               this.upArrowKeyIsPressed ||\n               this.downArrowKeyIsPressed ||\n               this.tabKeyIsPressed ||\n               this.tildeKeyIsPressed ||\n               this.lKeyIsPressed;\n    }\n\n    /**\n     * Indicates if a modal window is currently open\n     * - modals must have A11yClassNames.MODAL to be considered\n     */\n    get modalIsOpen() {\n        return this.modalHTMLCollection.length > 0;\n    }\n\n    /**\n     * Indicates if a popup/dropdown element is currently open\n     * - popups/dropdowns must have A11yClassNames.POPUP to be considered\n     */\n    get popupIsOpen() {\n        return this.popupHTMLCollection.length > 0;\n    }\n\n    // public methods\n\n    /**\n     * Determines the next region, sets it as active and updates the current focus\n     */\n    nextRegion() {\n        const regions = this.regions;\n        if (\n            !regions ||\n            !regions.length ||\n            this.modalIsOpen ||\n            this.popupIsOpen\n        ) {\n            return;\n        }\n        let newRegion;\n        if (\n            !this.activeRegion ||\n            this.activeRegionIndex === regions.length - 1 ||\n            this.resetNavigation\n        ) {\n            newRegion = regions[0];\n        } else {\n            newRegion = regions[this.activeRegionIndex + 1];\n        }\n        this.setActiveRegion(newRegion);\n        this.setCurrentFocus();\n        this.resetNavigation = false;\n    }\n\n    /**\n     * Determines the previous region, sets it as active and updates the current focus\n     */\n    previousRegion() {\n        const regions = this.regions;\n        if (\n            !regions ||\n            !regions.length ||\n            this.modalIsOpen ||\n            this.popupIsOpen\n        ) {\n            return;\n        }\n        let newRegion;\n        if (!this.activeRegion || (this.activeRegionIndex !== 0 && this.resetNavigation)) {\n            newRegion = regions[0];\n        } else if (this.activeRegionIndex === 0) {\n            newRegion = regions[regions.length - 1];\n        } else {\n            newRegion = regions[this.activeRegionIndex - 1];\n        }\n        this.setActiveRegion(newRegion);\n        this.setCurrentFocus();\n        this.resetNavigation = false;\n    }\n\n    /**\n     * Determines the next section, sets it as active and updates the current focus\n     */\n    nextSection() {\n        const sections = this.sections;\n        const shouldLoopNavigation = this.getLoopNavigationAttribute(this.activeRegion);\n        if (\n            this.modalIsOpen ||\n            this.popupIsOpen ||\n            !sections ||\n            !sections.length ||\n            (!shouldLoopNavigation && this.activeSectionIndex === sections.length - 1)\n        ) {\n            return;\n        }\n        let newSection;\n        if (this.activeSection && this.activeSectionIndex < sections.length - 1) {\n            newSection = sections[this.activeSectionIndex + 1];\n        } else {\n            newSection = sections[0];\n        }\n        this.setActiveSection(newSection);\n        this.setCurrentFocus();\n        this.resetNavigation = true;\n    }\n\n    /**\n     * Determines the previous section, sets it as active and updates the current focus\n     */\n    previousSection() {\n        const sections = this.sections;\n        const shouldLoopNavigation = this.getLoopNavigationAttribute(this.activeRegion);\n        if (\n            this.modalIsOpen ||\n            this.popupIsOpen ||\n            !sections ||\n            !sections.length ||\n            (!shouldLoopNavigation && this.activeSectionIndex === 0)\n        ) {\n            return;\n        }\n        let newSection;\n        if (this.activeSection && this.activeSectionIndex > 0) {\n            newSection = sections[this.activeSectionIndex - 1];\n        } else if (this.activeSection && this.activeSectionIndex === 0) {\n            newSection = sections[sections.length - 1];\n        } else {\n            newSection = sections[0];\n        }\n        this.setActiveSection(newSection);\n        this.setCurrentFocus();\n        this.resetNavigation = true;\n    }\n\n    /**\n     * Takes the provided dom element, finds it's parent section and region (if available),\n     * sets them as active and updates the current focus\n     * @param {HTMLElement} element - the DOM element to set as the active element\n     * @param {array or boolean} elementPath - array of element's dom branch or boolean to find section/region of element\n     */\n    nextElement(element, elementPath = false) {\n        let region;\n        let section;\n        if (elementPath && elementPath.length) {\n            // is the current element in an active region?\n            if (elementPath.indexOf(this.activeRegion) < 0) {\n                region = elementPath.find((pathElement) => {\n                    if (!pathElement.classList) {\n                        return false;\n                    }\n                    return pathElement.classList.contains(A11yClassNames.REGION);\n                });\n            }\n\n            // is the current element in an active section?\n            if (elementPath.indexOf(this.activeSection) < 0) {\n                section = elementPath.find((pathElement) => {\n                    if (!pathElement.classList) {\n                        return false;\n                    }\n                    return pathElement.classList.contains(A11yClassNames.SECTION);\n                });\n            }\n        } else if (elementPath && typeof element.closest === 'function') {\n            region = element.closest(`.${A11yClassNames.REGION}`);\n            section = element.closest(`.${A11yClassNames.SECTION}`);\n        }\n        if (region && this.activeRegion !== region) {\n            this.setActiveRegion(region, false);\n        }\n        if (section && this.activeSection !== section) {\n            this.setActiveSection(section);\n        }\n        this.setActiveElement(element);\n        this.setCurrentFocus();\n        this.resetNavigation = true;\n    }\n\n    /**\n     * Resets the a11y navigation controller, active region/section/element, clears focus and resets user interraction states\n     */\n    cancelNavigation() {\n        this.clearActiveRegion();\n        this.setCurrentFocus();\n        this.resetInterractionStates();\n    }\n\n    // private methods\n\n    /**\n     * Sets the currently active region and stores a list of the regions sections\n     * @param {HTMLElement} element - DOM element to set as the active region\n     * @param {boolean} canFocusChild - whether to focus child section instead of provide region\n     * @emits {A11yCustomEventTypes.ACTIVATE} - emitted on the provided DOM element once set to active\n     */\n    setActiveRegion(element, canFocusChild = true) {\n        if (!this.isElementValid(element, [this.activeRegion]) && !this.resetNavigation) {\n            return;\n        }\n\n        // clear previous active region\n        this.clearActiveRegion();\n\n        // setup new active region\n        this.activeRegion = element;\n        this.activeRegion.addEventListener(A11yCustomEventTypes.UPDATE, this.handleActiveRegionUpdate);\n        this.activeRegion.dispatchEvent(new Event(A11yCustomEventTypes.ACTIVATE));\n\n        // apply visual updates to active region\n        this.updateActiveRegion();\n\n        // retrieve all sections for the new active region\n        this.sectionHTMLCollection = this.getAllSectionsForRegion(this.activeRegion);\n\n        // should the visual focus start on a child section\n        if (canFocusChild && this.getFocusChildAttribute(this.activeRegion) && this.sections && this.sections.length) {\n            this.setActiveSection(this.sections[0]);\n        }\n    }\n\n    /**\n     * Sets the currently active section\n     * @param {HTMLElement} element - DOM element to set as the active section\n     * @emits {A11yCustomEventTypes.ACTIVATE} - emitted on the provided DOM element once set to active\n     */\n    setActiveSection(element) {\n        if (!this.isElementValid(element, [this.activeSection])) {\n            return;\n        }\n\n        // clear previous active section\n        this.clearActiveSection();\n\n        // setup new active section\n        this.activeSection = element;\n        this.activeSection.addEventListener(A11yCustomEventTypes.UPDATE, this.handleActiveSectionUpdate);\n        this.activeSection.dispatchEvent(new Event(A11yCustomEventTypes.ACTIVATE));\n\n        // apply visual updates to active section\n        this.updateActiveSection();\n    }\n\n    /**\n     * Sets the currently active element\n     * @param {HTMLElement} element - DOM element to set as the active element\n     * @emits {A11yCustomEventTypes.ACTIVATE} - emitted on the provided DOM element once set to active\n     */\n    setActiveElement(element) {\n        if (!this.isElementValid(element, [this.activeElement])) {\n            return;\n        }\n\n        // clear previous active element\n        this.clearActiveElement();\n\n        // setup new active element\n        this.activeElement = element;\n        this.activeElement.addEventListener(A11yCustomEventTypes.UPDATE, this.handleActiveElementUpdate);\n        if (this.activeElement !== this.activeRegion && this.activeElement !== this.activeSection) {\n            this.activeElement.dispatchEvent(new Event(A11yCustomEventTypes.ACTIVATE));\n        }\n\n        // apply visual updates to active element\n        this.updateActiveElement();\n    }\n\n    /**\n     * Updates the focus status of the element that should now have focus\n     */\n    setCurrentFocus() {\n        this.clearCurrentFocus();\n        if (!this.focusedElement) {\n            return;\n        }\n\n        // set focus on the element that should have focus if needed\n        if (document.activeElement !== this.focusedElement) {\n            this.focusedElement.focus();\n        }\n\n        // apply visual updates to focused element\n        this.udpateCurrentFocus();\n    }\n\n    /**\n     * Updates the visual state of the active region and makes sure it is focusable\n     */\n    updateActiveRegion() {\n        if (!this.activeRegion) {\n            return;\n        }\n        this.activeRegion.classList.add(A11yClassNames.ACTIVE);\n\n        // ensure active region element is focusable\n        if (!this.activeRegion.getAttribute('tabindex')) {\n            this.activeRegion.setAttribute('tabindex', -1);\n        }\n    }\n\n    /**\n     * Updates the visual state of the active section and makes sure it is focusable\n     */\n    updateActiveSection() {\n        if (!this.activeSection) {\n            return;\n        }\n        this.activeSection.classList.add(A11yClassNames.ACTIVE);\n\n        // ensure active section element is focusable\n        if (!this.activeSection.getAttribute('tabindex')) {\n            this.activeSection.setAttribute('tabindex', -1);\n        }\n    }\n\n    /**\n     * Updates the visual state of the active element\n     */\n    updateActiveElement() {\n        if (!this.activeElement) {\n            return;\n        }\n        this.activeElement.classList.add(A11yClassNames.ACTIVE);\n    }\n\n    /**\n     * Updates the visual state of the currently focused element\n     */\n    udpateCurrentFocus(forceUpdate = false) {\n        if ((!this.focusedElement || !this.a11yKeyIsPressed) && !forceUpdate) {\n            return;\n        }\n        this.focusedElement.classList.add(A11yClassNames.FOCUSED);\n    }\n\n    /**\n     * Clears all a11y-applied classes, events and the active region DOM element reference\n     */\n    clearActiveRegion() {\n        if (this.activeRegion) {\n            this.activeRegion.classList.remove(A11yClassNames.ACTIVE);\n            this.activeRegion.dispatchEvent(new Event(A11yCustomEventTypes.DEACTIVATE));\n            this.activeRegion.removeEventListener(A11yCustomEventTypes.UPDATE, this.handleActiveRegionUpdate);\n            this.activeRegion = null;\n        }\n        this.clearActiveSection();\n    }\n\n    /**\n     * Clears all a11y-applied classes, events and the active section DOM element reference\n     */\n    clearActiveSection() {\n        if (this.activeSection) {\n            this.activeSection.classList.remove(A11yClassNames.ACTIVE);\n            this.activeSection.dispatchEvent(new Event(A11yCustomEventTypes.DEACTIVATE));\n            this.activeSection.removeEventListener(A11yCustomEventTypes.UPDATE, this.handleActiveSectionUpdate);\n            this.activeSection = null;\n        }\n        this.clearActiveElement();\n    }\n\n    /**\n     * Clears all a11y-applied classes, events and the active DOM element reference\n     */\n    clearActiveElement() {\n        if (this.activeElement) {\n            if (this.activeElement !== this.activeRegion && this.activeElement !== this.activeSection) {\n                this.activeElement.classList.remove(A11yClassNames.ACTIVE);\n                this.activeElement.dispatchEvent(new Event(A11yCustomEventTypes.DEACTIVATE));\n            }\n            this.activeElement.removeEventListener(A11yCustomEventTypes.UPDATE, this.handleActiveElementUpdate);\n            this.activeElement = null;\n        }\n    }\n\n    /**\n     * Clears all focused element classes and blurs the active element if requested\n     */\n    clearCurrentFocus(blurActiveElement = false) {\n        Array.from(document.getElementsByClassName(A11yClassNames.FOCUSED)).forEach((element) => {\n            element.classList.remove(A11yClassNames.FOCUSED);\n        });\n        if (blurActiveElement) {\n            document.activeElement.blur();\n        }\n    }\n\n    /**\n     * Resets the state of all a11y-defined interraction methods\n     */\n    resetInterractionStates() {\n        this.mouseIsPressed = false;\n        this.f6KeyIsPressed = false;\n        this.upArrowKeyIsPressed = false;\n        this.downArrowKeyIsPressed = false;\n        this.tabKeyIsPressed = false;\n        this.tildeKeyIsPressed = false;\n        this.enterKeyIsPressed = false;\n        this.lKeyIsPressed = false;\n        this.lastInputEventIsKeyboard = false;\n    }\n\n    // helper methods\n\n    /**\n     * Returns an HTMLCollection object of all defined regions\n     * - use of HTMLCollection is intentional as this object auto updates to reflect DOM changes\n     */\n    getAllRegions() {\n        return document.getElementsByClassName(A11yClassNames.REGION);\n    }\n\n    /**\n     * Returns an HTMLCollection object of all defined sections for the currently active region\n     * - use of HTMLCollection is intentional as this object auto updates to reflect DOM changes\n     */\n    getAllSectionsForRegion(region) {\n        if (!region) {\n            return null;\n        }\n        return region.getElementsByClassName(A11yClassNames.SECTION);\n    }\n\n    /**\n     * Sort a list of DOM elements by defined A11yAttributeNames.SORT_ORDER attribute\n     * @param {HTMLCollection} elements - list of elements to be sorted\n     */\n    sortElementsByAttributeOrder(elements) {\n        if (!elements || !elements.length) {\n            return [];\n        }\n        return Array.from(elements).sort((elementA, elementB) => {\n            const elementAOrder = parseInt(elementA.getAttribute(A11yAttributeNames.SORT_ORDER), 10);\n            const elementBOrder = parseInt(elementB.getAttribute(A11yAttributeNames.SORT_ORDER), 10);\n\n            if (isNaN(elementAOrder) && isNaN(elementBOrder)) {\n                return 0;\n            }\n            if (isNaN(elementBOrder)) {\n                return -1;\n            }\n            if (isNaN(elementAOrder)) {\n                return 1;\n            }\n\n            return elementAOrder - elementBOrder;\n        });\n    }\n\n    /**\n     * Returns whether a DOM element is currently visible or not\n     * @param {HTMLElement} element - the DOM element to check\n     */\n    elementIsVisible(element) {\n        return element && element.offsetParent;\n    }\n\n    /**\n     * Retuns an HTMLCollection of all DOM elements that have the A11yClassNames.MODAL class\n     */\n    getAllModals() {\n        return document.getElementsByClassName(A11yClassNames.MODAL);\n    }\n\n    /**\n     * Retuns an HTMLCollection of all DOM elements that have the A11yClassNames.POPUP class\n     */\n    getAllPopups() {\n        return document.getElementsByClassName(A11yClassNames.POPUP);\n    }\n\n    /**\n     * Helper to retrieve the value of the A11yAttributeNames.LOOP_NAVIGATION attribute for the provided DOM element\n     * @param {HTMLElement} element - the element to retrive the A11yAttributeNames.LOOP_NAVIGATION value from\n     */\n    getLoopNavigationAttribute(element) {\n        const attributeValue = element.getAttribute(A11yAttributeNames.LOOP_NAVIGATION);\n        if (attributeValue && attributeValue.toLowerCase() === 'false') {\n            return false;\n        }\n        return true;\n    }\n\n    /**\n     * Helper to retrieve the value of the A11yAttributeNames.ORDER_REVERSE attribute for the provided DOM element\n     * @param {HTMLElement} element - the element to retrive the A11yAttributeNames.ORDER_REVERSE value from\n     */\n    getOrderReverseAttribute(element) {\n        const attributeValue = element.getAttribute(A11yAttributeNames.ORDER_REVERSE);\n        if (attributeValue && attributeValue.toLowerCase() === 'true') {\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Helper to retrieve the value of the A11yAttributeNames.FOCUS_CHILD attribute for the provided DOM element\n     * @param {HTMLElement} element - the element to retrive the A11yAttributeNames.FOCUS_CHILD value from\n     */\n    getFocusChildAttribute(element) {\n        const attributeValue = element.getAttribute(A11yAttributeNames.FOCUS_CHILD);\n        if (attributeValue && attributeValue.toLowerCase() === 'true') {\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Helper method to verify if a provided DOM element is a valid element for a11y navigation\n     * @param {HTMLElement} element - the DOM element to check\n     * @param {arry of HTMLElements} invalidElements - a list of invalid DOM elements to check against\n     */\n    isElementValid(element, invalidElements = []) {\n        if (\n            element &&\n            element.classList &&\n            !invalidElements.includes(element)\n        ) {\n            return true;\n        }\n        return false;\n    }\n\n    // event handling methods\n\n    handleKeyDown = (event) => {\n        const modifierKeys = {\n            ctrlIsPressed: event.ctrlKey,\n            altIsPressed: event.altKey,\n            shiftIsPressed: event.shiftKey,\n        };\n        switch (true) {\n        case isKeyPressed(event, Constants.KeyCodes.TAB):\n            this.lastInputEventIsKeyboard = true;\n            if ((!isMac() && modifierKeys.altIsPressed) || cmdOrCtrlPressed(event)) {\n                return;\n            }\n            this.tabKeyIsPressed = true;\n            break;\n        case isKeyPressed(event, Constants.KeyCodes.TILDE):\n            this.lastInputEventIsKeyboard = true;\n            if (!this.regions || !this.regions.length) {\n                return;\n            }\n\n            // Check to make sure both aren't pressed because some older webkit browsers set CTRL and ALT when AltGr is pressed\n            if (modifierKeys.ctrlIsPressed && !modifierKeys.altIsPressed) {\n                this.tildeKeyIsPressed = true;\n                event.preventDefault();\n                if (modifierKeys.shiftIsPressed) {\n                    this.previousRegion();\n                } else {\n                    this.nextRegion();\n                }\n            }\n            break;\n        case isKeyPressed(event, Constants.KeyCodes.F6):\n            this.lastInputEventIsKeyboard = true;\n            if (!isDesktopApp() && !cmdOrCtrlPressed(event)) {\n                return;\n            }\n            this.f6KeyIsPressed = true;\n            event.preventDefault();\n            if (modifierKeys.shiftIsPressed) {\n                this.previousRegion();\n            } else {\n                this.nextRegion();\n            }\n            break;\n        case isKeyPressed(event, Constants.KeyCodes.UP):\n            this.lastInputEventIsKeyboard = true;\n            if (!this.navigationInProgress || !this.sections || !this.sections.length) {\n                return;\n            }\n            this.upArrowKeyIsPressed = true;\n            event.preventDefault();\n            if (this.shouldReverseSections) {\n                this.nextSection();\n            } else {\n                this.previousSection();\n            }\n            break;\n        case isKeyPressed(event, Constants.KeyCodes.DOWN):\n            this.lastInputEventIsKeyboard = true;\n            if (!this.navigationInProgress || !this.sections || !this.sections.length) {\n                return;\n            }\n            this.downArrowKeyIsPressed = true;\n            event.preventDefault();\n            if (this.shouldReverseSections) {\n                this.previousSection();\n            } else {\n                this.nextSection();\n            }\n            break;\n        case isKeyPressed(event, Constants.KeyCodes.ESCAPE):\n            if (!this.navigationInProgress) {\n                return;\n            }\n            event.preventDefault();\n            this.cancelNavigation();\n            break;\n        case isKeyPressed(event, Constants.KeyCodes.ENTER):\n            this.enterKeyIsPressed = true;\n            break;\n        case isKeyPressed(event, Constants.KeyCodes.SPACE):\n            if (event.target.nodeName === 'BUTTON') {\n                event.preventDefault();\n                event.stopPropagation();\n                event.target.click();\n            }\n            break;\n        case isKeyPressed(event, Constants.KeyCodes.L):\n            // For the Ctrl+Shift+L keyboard shortcut\n            this.lastInputEventIsKeyboard = true;\n            this.lKeyIsPressed = true;\n            break;\n        }\n    }\n\n    handleKeyUp = () => {\n        this.resetInterractionStates();\n    }\n\n    handleMouseClick = (event) => {\n        // hitting enter on a <button> triggers a click event\n        if (!this.enterKeyIsPressed) {\n            this.lastInputEventIsKeyboard = false;\n        }\n        if (event.target === this.activeElement) {\n            return;\n        }\n        this.cancelNavigation();\n    }\n\n    handleMouseDown = () => {\n        this.mouseIsPressed = true;\n    }\n\n    handleMouseUp = () => {\n        this.mouseIsPressed = false;\n    }\n\n    handleFocus = (event) => {\n        if (this.lastInputEventIsKeyboard && this.windowIsFocused) {\n            this.nextElement(event.target, event.path || true);\n        }\n\n        // focus just came back to the app\n        if (!this.windowIsFocused) {\n            this.windowIsFocused = true;\n        }\n    }\n\n    handleWindowBlur = (event) => {\n        if (event.target === window) {\n            this.windowIsFocused = false;\n        }\n    }\n\n    handleActiveRegionUpdate = () => {\n        if (this.navigationInProgress) {\n            this.updateActiveRegion();\n            if (this.focusedElement === this.activeRegion) {\n                this.udpateCurrentFocus(true);\n            }\n        }\n    }\n\n    handleActiveSectionUpdate = () => {\n        if (this.navigationInProgress) {\n            this.updateActiveSection();\n            if (this.focusedElement === this.activeSection) {\n                this.udpateCurrentFocus(true);\n            }\n        }\n    }\n\n    handleActiveElementUpdate = () => {\n        if (this.navigationInProgress) {\n            this.updateActiveElement();\n            if (this.focusedElement === this.activeElement) {\n                this.udpateCurrentFocus(true);\n            }\n        }\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport * as PostActions from 'mattermost-redux/actions/posts';\n\nimport {logError} from 'mattermost-redux/actions/errors';\n\nimport {ActionTypes, AnnouncementBarTypes} from 'utils/constants';\n\nexport function editPost(post) {\n    return async (dispatch, getState) => {\n        const result = await PostActions.editPost(post)(dispatch, getState);\n\n        // Send to error bar if it's an edit post error about time limit.\n        if (result.error && result.error.server_error_id === 'api.post.update_post.permissions_time_limit.app_error') {\n            dispatch(logError({type: AnnouncementBarTypes.ANNOUNCEMENT, message: result.error.message}, true));\n        }\n\n        return result;\n    };\n}\n\nexport function selectAttachmentMenuAction(postId, actionId, cookie, dataSource, text, value) {\n    return async (dispatch) => {\n        dispatch({\n            type: ActionTypes.SELECT_ATTACHMENT_MENU_ACTION,\n            postId,\n            data: {\n                [actionId]: {\n                    text,\n                    value,\n                },\n            },\n        });\n\n        dispatch(PostActions.doPostActionWithCookie(postId, actionId, cookie, value));\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\nimport {matchPath} from 'react-router-dom';\n\nimport * as UserAgent from 'utils/user_agent';\nimport {browserHistory} from 'utils/browser_history';\n\nconst urlFormatForDMGMPermalink = '/:teamName/messages/:username/:postid';\nconst urlFormatForChannelPermalink = '/:teamName/channels/:channelname/:postid';\n\nexport default class DeletePostModal extends React.PureComponent {\n    static propTypes = {\n        channelName: PropTypes.string,\n        teamName: PropTypes.string,\n        post: PropTypes.object.isRequired,\n        commentCount: PropTypes.number.isRequired,\n        isRHS: PropTypes.bool.isRequired,\n        onHide: PropTypes.func.isRequired,\n        actions: PropTypes.shape({\n            deleteAndRemovePost: PropTypes.func.isRequired,\n        }),\n    }\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            show: true,\n        };\n    }\n\n    handleDelete = async () => {\n        const {\n            actions,\n            post,\n        } = this.props;\n\n        let permalinkPostId = '';\n\n        const result = await actions.deleteAndRemovePost(post);\n\n        const matchUrlForDMGM = matchPath(this.props.location.pathname, {\n            path: urlFormatForDMGMPermalink,\n        });\n\n        const matchUrlForChannel = matchPath(this.props.location.pathname, {\n            path: urlFormatForChannelPermalink,\n        });\n\n        if (matchUrlForDMGM) {\n            permalinkPostId = matchUrlForDMGM.params.postid;\n        } else if (matchUrlForChannel) {\n            permalinkPostId = matchUrlForChannel.params.postid;\n        }\n\n        if (permalinkPostId === post.id) {\n            const channelUrl = this.props.location.pathname.split('/').slice(0, -1).join('/');\n            browserHistory.replace(channelUrl);\n        }\n\n        if (result.data) {\n            this.onHide();\n        }\n    }\n\n    handleEntered = () => {\n        if (this.deletePostBtn) {\n            this.deletePostBtn.focus();\n        }\n    }\n\n    onHide = () => {\n        this.setState({show: false});\n\n        if (!UserAgent.isMobile()) {\n            var element;\n            if (this.props.isRHS) {\n                element = document.getElementById('reply_textbox');\n            } else {\n                element = document.getElementById('post_textbox');\n            }\n            if (element) {\n                element.focus();\n            }\n        }\n    }\n\n    render() {\n        var commentWarning = '';\n        if (this.props.commentCount > 0 && this.props.post.root_id === '') {\n            commentWarning = (\n                <FormattedMessage\n                    id='delete_post.warning'\n                    defaultMessage='This post has {count, number} {count, plural, one {comment} other {comments}} on it.'\n                    values={{\n                        count: this.props.commentCount,\n                    }}\n                />\n            );\n        }\n\n        const postTerm = this.props.post.root_id ? (\n            <FormattedMessage\n                id='delete_post.comment'\n                defaultMessage='Comment'\n            />\n        ) : (\n            <FormattedMessage\n                id='delete_post.post'\n                defaultMessage='Post'\n            />\n        );\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal'\n                show={this.state.show}\n                onEntered={this.handleEntered}\n                onHide={this.onHide}\n                onExited={this.props.onHide}\n                enforceFocus={false}\n                id='deletePostModal'\n                role='dialog'\n                aria-labelledby='deletePostModalLabel'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='deletePostModalLabel'\n                    >\n                        <FormattedMessage\n                            id='delete_post.confirm'\n                            defaultMessage='Confirm {term} Delete'\n                            values={{\n                                term: (postTerm),\n                            }}\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <FormattedMessage\n                        id='delete_post.question'\n                        defaultMessage='Are you sure you want to delete this {term}?'\n                        values={{\n                            term: (postTerm),\n                        }}\n                    />\n                    <br/>\n                    <br/>\n                    {commentWarning}\n                </Modal.Body>\n                <Modal.Footer>\n                    <button\n                        type='button'\n                        className='btn btn-link'\n                        onClick={this.onHide}\n                    >\n                        <FormattedMessage\n                            id='delete_post.cancel'\n                            defaultMessage='Cancel'\n                        />\n                    </button>\n                    <button\n                        ref={(deletePostBtn) => {\n                            this.deletePostBtn = deletePostBtn;\n                        }}\n                        type='button'\n                        autoFocus={true}\n                        className='btn btn-danger'\n                        onClick={this.handleDelete}\n                        id='deletePostModalButton'\n                    >\n                        <FormattedMessage\n                            id='delete_post.del'\n                            defaultMessage='Delete'\n                        />\n                    </button>\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {withRouter} from 'react-router-dom';\n\nimport {deleteAndRemovePost} from 'actions/post_actions.jsx';\n\nimport DeletePostModal from './delete_post_modal.jsx';\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            deleteAndRemovePost,\n        }, dispatch),\n    };\n}\n\nexport default withRouter(connect(null, mapDispatchToProps)(DeletePostModal));\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport default {\n    ItemTapAction: {\n        OPEN_EMBED_PAGE: 1,\n        SHARE: 2,\n    },\n\n    Tab: {\n        TRENDING: 0,\n        REACTIONS: 1,\n    },\n\n    appName: {\n        mattermost: 'mattermost',\n    },\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nexport default class GifSearchIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <svg\n                    width='100%'\n                    height='100%'\n                    viewBox='-10 -10 40 40'\n                    version='1.1'\n                >\n                    <g\n                        id='ic_search'\n                        transform='matrix(0.959095,-9.6091e-18,-1.00189e-17,0.959095,-0.0633002,-0.777826)'\n                    >\n                        <path\n                            d='M2.648,15.872C3.433,16.658 4.376,17.287 5.454,17.758C6.553,18.229 7.698,18.454 8.888,18.454C10.728,18.454 12.389,17.938 13.893,16.905L18.18,21.192C18.494,21.506 18.854,21.664 19.302,21.664C19.751,21.664 20.111,21.506 20.447,21.192C20.761,20.855 20.919,20.496 20.919,20.047C20.919,19.621 20.761,19.239 20.447,18.925L16.16,14.638C17.193,13.134 17.709,11.473 17.709,9.633C17.709,8.443 17.484,7.298 17.013,6.198C16.542,5.121 15.913,4.178 15.128,3.393C14.342,2.607 13.399,1.979 12.322,1.507C11.222,1.036 10.077,0.811 8.888,0.811C7.698,0.811 6.553,1.036 5.454,1.507C4.376,1.979 3.433,2.607 2.648,3.393C1.862,4.178 1.234,5.121 0.762,6.198C0.291,7.298 0.066,8.443 0.066,9.633C0.066,10.822 0.291,11.967 0.762,13.067C1.234,14.144 1.862,15.087 2.648,15.872ZM8.888,4.021C10.436,4.021 11.761,4.56 12.861,5.66C13.96,6.76 14.499,8.084 14.499,9.633C14.499,11.181 13.96,12.506 12.861,13.606C11.761,14.705 10.436,15.244 8.888,15.244C7.339,15.244 6.015,14.705 4.915,13.606C3.815,12.506 3.276,11.181 3.276,9.633C3.276,8.084 3.815,6.76 4.915,5.66C6.015,4.56 7.339,4.021 8.888,4.021Z'\n                            style={{fill: 'inherit'}}\n                        />\n                    </g>\n                </svg>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nexport default class GifSearchClearIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <svg\n                    width='100%'\n                    height='100%'\n                    viewBox='-10 -10 40 40'\n                    enableBackground='new 0 0 20 20'\n                    version='1.1'\n                >\n                    <g transform='matrix(0.952381,0,0,1,0,0)'>\n                        <path\n                            fill='inherit'\n                            d='M10.5 11.7L2.2 19.8C2 19.9 1.9 20 1.7 20 1.6 20 1.4 19.9 1.3 19.8L0.2 18.8C0.1 18.7 0 18.5 0 18.3 0 18.2 0.1 18 0.2 17.9L8.3 10 0.2 2.1C0.1 2 0 1.8 0 1.7 0 1.5 0.1 1.3 0.2 1.2L1.3 0.2C1.4 0.1 1.6 0 1.7 0 1.9 0 2 0.1 2.2 0.2L10.5 8.3 18.8 0.2C19 0.1 19.1 0 19.3 0 19.4 0 19.6 0.1 19.7 0.2L20.8 1.2C20.9 1.3 21 1.5 21 1.7 21 1.8 20.9 2 20.8 2.1L12.7 10 20.8 17.9C20.9 18 21 18.2 21 18.3 21 18.5 20.9 18.7 20.8 18.8L19.7 19.8C19.6 19.9 19.4 20 19.3 20 19.1 20 19 19.9 18.8 19.8L10.5 11.7Z'\n                        />\n                    </g>\n                </svg>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport {connect} from 'react-redux';\n\nimport {saveSearchScrollPosition, saveSearchBarText, searchTextUpdate} from 'mattermost-redux/actions/gifs';\nimport {getTheme} from 'mattermost-redux/selectors/entities/preferences';\nimport {changeOpacity, makeStyleFromTheme} from 'mattermost-redux/utils/theme_utils';\n\nimport GifSearchIcon from 'components/widgets/icons/gif_search_icon';\nimport GifSearchClearIcon from 'components/widgets/icons/gif_search_clear_icon';\nimport LocalizedInput from 'components/localized_input/localized_input';\nimport {t} from 'utils/i18n.jsx';\n\nimport './SearchBar.scss';\n\nfunction mapStateToProps(state) {\n    return {\n        ...state.entities.gifs.categories,\n        ...state.entities.gifs.search,\n        theme: getTheme(state),\n        appProps: state.entities.gifs.app,\n    };\n}\n\nconst mapDispatchToProps = ({\n    saveSearchBarText,\n    saveSearchScrollPosition,\n    searchTextUpdate,\n});\n\nconst getStyle = makeStyleFromTheme((theme) => {\n    return {\n        background: {\n            backgroundColor: theme.centerChannelBg,\n        },\n        icon: {\n            fill: changeOpacity(theme.centerChannelColor, 0.4),\n        },\n        inputBackground: {\n            backgroundColor: theme.centerChannelBg,\n        },\n        input: {\n            borderColor: changeOpacity(theme.centerChannelColor, 0.12),\n        },\n    };\n});\n\nexport class SearchBar extends Component {\n    static propTypes = {\n        searchBarText: PropTypes.string,\n        tagsList: PropTypes.array,\n        theme: PropTypes.object.isRequired,\n        onTrending: PropTypes.func,\n        onSearch: PropTypes.func,\n        onCategories: PropTypes.func,\n        action: PropTypes.string,\n        saveSearchScrollPosition: PropTypes.func,\n        saveSearchBarText: PropTypes.func,\n        searchTextUpdate: PropTypes.func,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            inputFocused: false,\n        };\n\n        this.searchTimeout = null;\n        this.props.saveSearchBarText('');\n        this.props.searchTextUpdate('');\n    }\n\n    componentDidUpdate(prevProps) {\n        const {searchBarText} = this.props;\n\n        if (searchBarText !== prevProps.searchBarText) {\n            if (searchBarText === 'trending') {\n                this.updateSearchInputValue('');\n            } else {\n                this.updateSearchInputValue(searchBarText);\n            }\n        }\n    }\n\n    /**\n     * Returns text request with hyphens\n     */\n    parseSearchText = (searchText) => {\n        return searchText.trim().split(/ +/).join('-');\n    }\n\n    removeExtraSpaces = (searchText) => {\n        return searchText.trim().split(/ +/).join(' ');\n    }\n\n    updateSearchInputValue = (searchText) => {\n        this.searchInput.value = searchText;\n        this.props.saveSearchBarText(searchText);\n    }\n\n    handleSubmit = (event) => {\n        event.preventDefault();\n        this.triggerSearch(this.searchInput.value);\n        this.searchInput.blur();\n    }\n\n    triggerSearch = (searchText) => {\n        const {onSearch} = this.props;\n        this.props.searchTextUpdate(this.parseSearchText(searchText));\n        onSearch();\n        this.props.saveSearchScrollPosition(0);\n    }\n\n    handleChange = (event) => {\n        clearTimeout(this.searchTimeout);\n\n        const searchText = event.target.value;\n\n        const {onCategories, action} = this.props;\n        this.props.saveSearchBarText(searchText);\n\n        if (searchText === '') {\n            onCategories();\n        } else if (action !== 'reactions' || !this.isFilteredTags(searchText)) {\n            // not reactions page or there's no reactions for this search request\n            this.searchTimeout = setTimeout(() => {\n                this.triggerSearch(searchText);\n            }, 500);\n        }\n    }\n\n    focusInput = () => {\n        this.setState({inputFocused: true});\n    }\n\n    blurInput = () => {\n        this.setState({inputFocused: false});\n    }\n\n    /**\n     * Checks if there're reactions for a current searchText\n     */\n    isFilteredTags = (searchText) => {\n        var text = this.removeExtraSpaces(searchText);\n\n        const {tagsList} = this.props;\n        const substr = text.toLowerCase();\n        const filteredTags = tagsList && tagsList.length ? tagsList.filter((tag) => {\n            if (!text || tag.tagName.indexOf(substr) !== -1) {\n                return tag;\n            }\n            return '';\n        }) : [];\n\n        return Boolean(filteredTags.length);\n    }\n\n    clearSearchHandle = () => {\n        const {action, onTrending, onCategories} = this.props;\n        this.updateSearchInputValue('');\n        if (action === 'reactions') {\n            onCategories();\n        } else {\n            onTrending();\n        }\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        return ((!nextProps.searchBarText && this.props.searchBarText) ||\n            (nextProps.searchBarText && !this.props.searchBarText) ||\n            (nextState.inputFocused !== this.state.inputFocused));\n    }\n\n    render() {\n        const style = getStyle(this.props.theme);\n        const {searchBarText} = this.props;\n        const clearSearchButton = searchBarText ?\n            (\n                <GifSearchClearIcon\n                    className='ic-clear-search'\n                    style={style.icon}\n                    onClick={this.clearSearchHandle}\n                />\n            ) : null;\n\n        return (\n            <form\n                className='gfycat-search'\n                method='get'\n                target='_top'\n                noValidate=''\n                onSubmit={this.handleSubmit}\n            >\n                <div\n                    className='search-bar'\n                    style={style.background}\n                >\n                    <div\n                        className='search-input-bg'\n                        style={style.inputBackground}\n                    />\n                    <LocalizedInput\n                        className='search-input'\n                        name='searchText'\n                        autoFocus={true}\n                        placeholder={{id: t('gif_picker.gfycat'), defaultMessage: 'Search Gfycat'}}\n                        onChange={this.handleChange}\n                        autoComplete='off'\n                        autoCapitalize='off'\n                        onFocus={this.focusInput}\n                        onBlur={this.blurInput}\n                        ref={(input) => {\n                            this.searchInput = input;\n                            return input;\n                        }}\n                        style={style.input}\n                    />\n                    <GifSearchIcon\n                        className='ic ic-search'\n                        style={style.icon}\n                    />\n                    {clearSearchButton}\n                </div>\n                <button\n                    type='submit'\n                    className='submit-button'\n                />\n            </form>\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SearchBar);\n\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nexport default class GifTrendingIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <svg\n                    className='ic-svg ic-trending-svg'\n                    width='11px'\n                    height='15px'\n                    viewBox='0 0 11 15'\n                    version='1.1'\n                >\n                    <g\n                        id='Finalized-Design'\n                        stroke='none'\n                        fill='inherit'\n                    >\n                        <g\n                            id='GfyCat---Gycat-Tab'\n                            transform='translate(-1212.000000, -619.000000)'\n                            fill='inherit'\n                        >\n                            <g\n                                id='modal---emojis'\n                                transform='translate(1147.000000, 542.000000)'\n                            >\n                                <g\n                                    id='tabs---gfycat'\n                                    transform='translate(1.000000, 68.000000)'\n                                >\n                                    <g id='tab---trending---selected'>\n                                        <path\n                                            d='M69.90625,10.4062776 C69.90625,10.9531513 70.0976562,11.4909106 70.4804688,12.019555 C70.6992188,12.32945 71.1276043,12.7760638 71.765625,13.3593956 C72.3489582,13.9062693 72.7773438,14.3346538 73.0507812,14.6445488 C73.5065106,15.1731932 73.8528644,15.7109525 74.0898438,16.2578262 C74.3632812,16.9505327 74.5,17.6979271 74.5,18.5000083 C74.5,19.4479229 74.2630207,20.3229208 73.7890625,21.1250021 C73.3151043,21.9270834 72.6770832,22.565103 71.875,23.03906 C71.0729168,23.5130171 70.1979168,23.7499958 69.25,23.7499958 C68.3020832,23.7499958 67.4270832,23.5130171 66.625,23.03906 C65.8229168,22.565103 65.1848957,21.9270834 64.7109375,21.1250021 C64.2369793,20.3229208 64,19.4479229 64,18.5000083 C64,17.6432397 64.2005207,16.8320436 64.6015625,16.0664204 C65.0026043,15.3007972 65.5494793,14.6718925 66.2421875,14.1797061 C66.4609375,14.0338733 66.6888019,14.0247585 66.9257812,14.1523625 C67.1627606,14.2799665 67.28125,14.4713723 67.28125,14.7265798 L67.28125,17.6250104 C67.28125,17.9349054 67.3860676,18.1946704 67.5957031,18.4043054 C67.8053387,18.6139405 68.0651043,18.7187578 68.375,18.7187578 C68.6848957,18.7187578 68.9446613,18.6139405 69.1542969,18.4043054 C69.3639324,18.1946704 69.46875,17.9349054 69.46875,17.6250104 C69.46875,17.4427191 69.4049481,17.2330844 69.2773438,16.9961057 C69.2044269,16.8320436 69.0677082,16.576836 68.8671875,16.2304825 C68.4661457,15.5742341 68.1835938,15.0547041 68.0195312,14.6718925 C67.7643231,13.9791859 67.6640625,13.2955938 67.71875,12.6211161 C67.8098957,11.7825763 68.1380207,10.9258077 68.703125,10.0508097 C68.8125,9.86851837 68.9628906,9.76825847 69.1542969,9.75002921 C69.3457031,9.73179994 69.5188801,9.78648731 69.6738281,9.91409132 C69.8287762,10.0416953 69.90625,10.2057574 69.90625,10.4062776 Z M69.2499875,22.437499 C69.9609233,22.437499 70.6171717,22.259765 71.2187328,21.9042971 C71.8202939,21.5488292 72.2988083,21.0703147 72.6542762,20.4687537 C73.0097441,19.8671926 73.1874781,19.2109441 73.1874781,18.5000083 C73.1874781,17.880218 73.0781034,17.3060006 72.8593539,16.7773562 C72.6588337,16.3398572 72.376282,15.9023583 72.0116996,15.4648593 C71.7929502,15.1914225 71.4329248,14.8131683 70.9316241,14.3300964 C70.4303233,13.8470245 70.070298,13.4687703 69.8515485,13.1953335 C69.4869662,12.7760638 69.2135294,12.3567937 69.031238,11.937524 C68.8671759,12.5573143 68.8945196,13.1953335 69.1132691,13.8515819 C69.2408731,14.2343935 69.5143099,14.7812672 69.9335796,15.492203 C70.2252457,15.9661601 70.4166515,16.321628 70.507797,16.5586067 C70.6900884,16.9414183 70.7812338,17.2968862 70.7812338,17.6250104 C70.7812338,18.2812589 70.5442551,18.8463618 70.070298,19.3203189 C69.596341,19.794276 69.031238,20.0312547 68.3749896,20.0312547 C67.7187411,20.0312547 67.1536382,19.794276 66.6796811,19.3203189 C66.205724,18.8463618 65.9687453,18.2812589 65.9687453,17.6250104 L65.9687453,16.0937641 C65.7682251,16.403659 65.60872,16.7819136 65.4902308,17.228527 C65.3717417,17.6751404 65.3124969,18.0989675 65.3124969,18.5000083 C65.3124969,19.2109441 65.4902308,19.8671926 65.8456987,20.4687537 C66.2011666,21.0703147 66.6796811,21.5488292 67.2812422,21.9042971 C67.8828032,22.259765 68.5390517,22.437499 69.2499875,22.437499 Z'\n                                            id='icon---trending'\n                                        />\n                                    </g>\n                                </g>\n                            </g>\n                        </g>\n                    </g>\n                </svg>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nexport default class GifReactionsIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <svg\n                    className='ic-svg ic-reactions-svg'\n                    width='14px'\n                    height='14px'\n                    viewBox='0 0 14 14'\n                    version='1.1'\n                >\n                    <g\n                        id='Finalized-Design'\n                        stroke='none'\n                        fill='inherit'\n                    >\n                        <g\n                            id='GfyCat---Gycat-Tab'\n                            transform='translate(-1348.000000, -620.000000)'\n                            fill='inherit'\n                        >\n                            <g\n                                id='modal---emojis'\n                                transform='translate(1147.000000, 542.000000)'\n                            >\n                                <g\n                                    id='tabs---gfycat'\n                                    transform='translate(1.000000, 68.000000)'\n                                >\n                                    <g\n                                        id='tab---category---deselected'\n                                        transform='translate(138.000000, 0.000000)'\n                                    >\n                                        <path\n                                            d='M62,16 L62,10 L68,10 L68,16 L62,16 Z M64,12 L64,14 L66,14 L66,12 L64,12 Z M70,24 L70,18 L76,18 L76,24 L70,24 Z M72,20 L72,22 L74,22 L74,20 L72,20 Z M70,10 L76,10 L76,16 L70,16 L70,10 Z M74,14 L74,12 L72,12 L72,14 L74,14 Z M62,24 L62,18 L68,18 L68,24 L62,24 Z M64,20 L64,22 L66,22 L66,20 L64,20 Z'\n                                            id='icon---categories'\n                                        />\n                                    </g>\n                                </g>\n                            </g>\n                        </g>\n                    </g>\n                </svg>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\nimport {connect} from 'react-redux';\n\nimport {saveSearchBarText, searchTextUpdate} from 'mattermost-redux/actions/gifs';\nimport {getTheme} from 'mattermost-redux/selectors/entities/preferences';\nimport {changeOpacity, makeStyleFromTheme} from 'mattermost-redux/utils/theme_utils';\n\nimport constants from 'components/gif_picker/utils/constants';\nimport SearchBar from 'components/gif_picker/components/SearchBar';\nimport GifTrendingIcon from 'components/widgets/icons/gif_trending_icon';\nimport GifReactionsIcon from 'components/widgets/icons/gif_reactions_icon';\nimport './Header.scss';\n\nfunction mapStateToProps(state) {\n    return {\n        theme: getTheme(state),\n    };\n}\n\nconst mapDispatchToProps = ({\n    saveSearchBarText,\n    searchTextUpdate,\n});\n\nconst getStyle = makeStyleFromTheme((theme) => {\n    return {\n        background: {\n            backgroundColor: theme.centerChannelBg,\n        },\n        header: {\n            borderBottomColor: changeOpacity(theme.centerChannelColor, 0.2),\n        },\n        icon: {\n            fill: changeOpacity(theme.centerChannelColor, 0.3),\n        },\n        iconActive: {\n            fill: theme.centerChannelColor,\n        },\n        iconHover: {\n            fill: changeOpacity(theme.centerChannelColor, 0.8),\n        },\n    };\n});\n\nexport class Header extends PureComponent {\n    static propTypes = {\n        action: PropTypes.string,\n        appProps: PropTypes.object,\n        saveSearchBarText: PropTypes.func,\n        searchTextUpdate: PropTypes.func,\n        theme: PropTypes.object.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            hovering: '',\n        };\n    }\n\n    render() {\n        const style = getStyle(this.props.theme);\n\n        return (\n            <header\n                className='header-container'\n                style={style.background}\n            >\n                <SearchBar {...this.props}/>\n                <nav\n                    className='nav-bar'\n                    style={style.header}\n                >\n                    {this.renderTabs(this.props, style)}\n                </nav>\n            </header>\n        );\n    }\n\n    renderTabs(props, style) {\n        const {appProps, onTrending, onCategories} = props;\n        const {header} = appProps;\n        return header.tabs.map((tab, index) => {\n            let link;\n            if (tab === constants.Tab.TRENDING) {\n                link = this.renderTab('trending', onTrending, GifTrendingIcon, index, style);\n            } else if (tab === constants.Tab.REACTIONS) {\n                link = this.renderTab('reactions', onCategories, GifReactionsIcon, index, style);\n            }\n            return link;\n        });\n    }\n\n    renderTab(name, callback, Icon, index, style) {\n        var props = this.props;\n        const {action} = props;\n        function callbackWrapper() {\n            props.searchTextUpdate('');\n            props.saveSearchBarText('');\n            callback();\n        }\n        return (\n            <a\n                onClick={callbackWrapper}\n                onMouseOver={() => {\n                    this.setState({hovering: name});\n                }}\n                onMouseOut={() => {\n                    this.setState({hovering: ''});\n                }}\n                style={{cursor: 'pointer'}}\n                key={index}\n            >\n                <div style={{paddingTop: '2px'}}>\n                    <Icon\n                        style={(() => {\n                            if (this.state.hovering === name) {\n                                return style.iconHover;\n                            }\n                            return action === name ? style.iconActive : style.icon;\n                        })()}\n                    />\n                </div>\n            </a>\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Header);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\nimport {connect} from 'react-redux';\n\nimport {saveAppProps} from 'mattermost-redux/actions/gifs';\n\nimport Header from 'components/gif_picker/components/Header';\n\nconst mapDispatchToProps = ({\n    saveAppProps,\n});\n\nexport class App extends PureComponent {\n    static propTypes = {\n        appProps: PropTypes.object,\n        action: PropTypes.string,\n        onCategories: PropTypes.func,\n        onSearch: PropTypes.func,\n        onTrending: PropTypes.func,\n        children: PropTypes.object,\n        saveAppProps: PropTypes.func,\n        authenticateSdk: PropTypes.func,\n    }\n\n    constructor(props) {\n        super(props);\n        const {appProps} = this.props;\n        this.props.saveAppProps(appProps);\n    }\n\n    render() {\n        const {\n            appProps,\n            action,\n            onCategories,\n            onSearch,\n            onTrending,\n            children,\n        } = this.props;\n        const appClassName = 'main-container ' + (appProps.appClassName || '');\n        return (\n            <div className={appClassName}>\n                <Header\n                    appProps={appProps}\n                    action={action}\n                    onCategories={onCategories}\n                    onSearch={onSearch}\n                    onTrending={onTrending}\n                />\n                <div className='component-container'>\n                    {children}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default connect(null, mapDispatchToProps)(App);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nexport default class InfiniteScroll extends PureComponent {\n    static propTypes = {\n        children: PropTypes.array,\n        element: PropTypes.string,\n        hasMore: PropTypes.bool,\n        initialLoad: PropTypes.bool,\n        loader: PropTypes.object,\n        loadMore: PropTypes.func.isRequired,\n        pageStart: PropTypes.number,\n        threshold: PropTypes.number,\n        useWindow: PropTypes.bool,\n        isReverse: PropTypes.bool,\n        containerHeight: PropTypes.number,\n        scrollPosition: PropTypes.number,\n    }\n\n    static defaultProps = {\n        element: 'div',\n        hasMore: false,\n        initialLoad: true,\n        pageStart: 0,\n        threshold: 250,\n        useWindow: true,\n        isReverse: false,\n        containerHeight: null,\n        scrollPosition: null,\n    }\n\n    componentDidMount() {\n        this.pageLoaded = this.props.pageStart;\n        this.attachScrollListener();\n        this.setScrollPosition();\n    }\n\n    componentDidUpdate() {\n        this.attachScrollListener();\n    }\n\n    render() {\n        const {\n            children,\n            element,\n            hasMore,\n            initialLoad, // eslint-disable-line no-unused-vars\n            loader,\n            loadMore, // eslint-disable-line no-unused-vars\n            pageStart, // eslint-disable-line no-unused-vars\n            threshold, // eslint-disable-line no-unused-vars\n            useWindow, // eslint-disable-line no-unused-vars\n            isReverse, // eslint-disable-line no-unused-vars\n            scrollPosition, // eslint-disable-line no-unused-vars\n            containerHeight,\n            ...props\n        } = this.props;\n\n        props.ref = (node) => {\n            this.scrollComponent = node;\n        };\n\n        const elementProps = containerHeight ? {...props, style: {height: containerHeight}} : props;\n\n        return React.createElement(element, elementProps, children, hasMore && (loader || this.defaultLoader));\n    }\n\n    calculateTopPosition(el) {\n        if (!el) {\n            return 0;\n        }\n        return el.offsetTop + this.calculateTopPosition(el.offsetParent);\n    }\n\n    setScrollPosition() {\n        const {scrollPosition} = this.props;\n        if (scrollPosition !== null) {\n            window.scrollTo(0, scrollPosition);\n        }\n    }\n\n    scrollListener = () => {\n        const el = this.scrollComponent;\n        const scrollEl = window;\n\n        let offset;\n        if (this.props.useWindow) {\n            var scrollTop = ('pageYOffset' in scrollEl) ? scrollEl.pageYOffset : (document.documentElement || document.body.parentNode || document.body).scrollTop;\n            if (this.props.isReverse) {\n                offset = scrollTop;\n            } else {\n                offset = this.calculateTopPosition(el) + (el.offsetHeight - scrollTop - window.innerHeight);\n            }\n        } else if (this.props.isReverse) {\n            offset = el.parentNode.scrollTop;\n        } else {\n            offset = el.scrollHeight - el.parentNode.scrollTop - el.parentNode.clientHeight;\n        }\n\n        if (offset < Number(this.props.threshold)) {\n            this.detachScrollListener();\n\n            // Call loadMore after detachScrollListener to allow for non-async loadMore functions\n            if (typeof this.props.loadMore === 'function') {\n                this.props.loadMore(this.pageLoaded += 1);\n            }\n        }\n    }\n\n    attachScrollListener() {\n        if (!this.props.hasMore) {\n            return;\n        }\n\n        let scrollEl = window;\n        if (this.props.useWindow === false) {\n            scrollEl = this.scrollComponent.parentNode;\n        }\n\n        scrollEl.addEventListener('scroll', this.scrollListener);\n        scrollEl.addEventListener('resize', this.scrollListener);\n\n        if (this.props.initialLoad) {\n            this.scrollListener();\n        }\n    }\n\n    detachScrollListener() {\n        var scrollEl = window;\n        if (this.props.useWindow === false) {\n            scrollEl = this.scrollComponent.parentNode;\n        }\n\n        scrollEl.removeEventListener('scroll', this.scrollListener);\n        scrollEl.removeEventListener('resize', this.scrollListener);\n    }\n\n    componentWillUnmount() {\n        this.detachScrollListener();\n    }\n\n    // Set a defaut loader for all your `InfiniteScroll` components\n    setDefaultLoader(loader) {\n        this.defaultLoader = loader;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\nimport {connect} from 'react-redux';\n\nimport {requestCategoriesList, requestCategoriesListIfNeeded, saveSearchBarText, saveSearchScrollPosition, searchTextUpdate} from 'mattermost-redux/actions/gifs';\nimport {getTheme} from 'mattermost-redux/selectors/entities/preferences';\nimport {changeOpacity, makeStyleFromTheme} from 'mattermost-redux/utils/theme_utils';\n\nimport {trackEvent} from 'actions/diagnostics_actions.jsx';\nimport * as PostUtils from 'utils/post_utils.jsx';\n\nimport InfiniteScroll from 'components/gif_picker/components/InfiniteScroll';\n\nimport './Categories.scss';\n\nfunction mapStateToProps(state) {\n    return {\n        ...state.entities.gifs.categories,\n        ...state.entities.gifs.cache,\n        theme: getTheme(state),\n        appProps: state.entities.gifs.app,\n        searchText: state.entities.gifs.search.searchText,\n        searchBarText: state.entities.gifs.search.searchBarText,\n        hasImageProxy: state.entities.general.config.HasImageProxy,\n    };\n}\n\nconst mapDispatchToProps = ({\n    saveSearchBarText,\n    saveSearchScrollPosition,\n    searchTextUpdate,\n    requestCategoriesList,\n    requestCategoriesListIfNeeded,\n});\n\nconst getStyle = makeStyleFromTheme((theme) => {\n    return {\n        background: {\n            backgroundColor: changeOpacity(theme.centerChannelColor, 0.05),\n        },\n    };\n});\n\nexport class Categories extends PureComponent {\n    static propTypes = {\n        appProps: PropTypes.object,\n        gifs: PropTypes.object,\n        hasMore: PropTypes.bool,\n        onSearch: PropTypes.func,\n        onTrending: PropTypes.func,\n        requestCategoriesList: PropTypes.func,\n        requestCategoriesListIfNeeded: PropTypes.func,\n        saveSearchBarText: PropTypes.func,\n        saveSearchScrollPosition: PropTypes.func,\n        searchTextUpdate: PropTypes.func,\n        searchBarText: PropTypes.string,\n        tagsList: PropTypes.array,\n        hasImageProxy: PropTypes.string,\n        theme: PropTypes.object.isRequired,\n    }\n\n    componentDidMount() {\n        window.scrollTo(0, 0);\n        this.props.requestCategoriesListIfNeeded();\n        this.sendImpressions();\n    }\n\n    sendImpressions = () => {\n        const {tagsList} = this.props;\n        const gfycats = tagsList.map((tag) => {\n            return {gfyId: tag.gfyId};\n        });\n\n        if (gfycats.length) {\n            trackEvent('gfycat', 'views', {context: 'category_list', count: gfycats.length});\n        }\n    }\n\n    componentWillUnmount() {\n        this.props.saveSearchScrollPosition(0);\n    }\n\n    filterTagsList = () => {\n        const {searchBarText, tagsList} = this.props;\n\n        const substr = searchBarText.toLowerCase().trim().split(/ +/).join(' ');\n        return tagsList && tagsList.length ? tagsList.filter((tag) => {\n            if (!searchBarText || tag.tagName.indexOf(substr) !== -1) {\n                return tag;\n            }\n            return '';\n        }) : [];\n    }\n\n    loadMore = () => {\n        this.props.requestCategoriesList();\n    }\n\n    render() {\n        const style = getStyle(this.props.theme);\n\n        const {hasMore, tagsList, gifs, onSearch, onTrending, hasImageProxy} = this.props;\n\n        const content = tagsList && tagsList.length ? this.filterTagsList(tagsList).map((item, index) => {\n            const {tagName, gfyId} = item;\n\n            if (!gifs[gfyId]) {\n                return null;\n            }\n\n            const gfyItem = gifs[gfyId];\n            const {max1mbGif, avgColor} = gfyItem;\n            const url = PostUtils.getImageSrc(max1mbGif, hasImageProxy === 'true');\n            const searchText = tagName.replace(/\\s/g, '-');\n            const backgroundImage = {backgroundImage: `url(${url}`};\n            const backgroundColor = {backgroundColor: avgColor};\n            const props = this.props;\n            function callback() {\n                props.searchTextUpdate(tagName);\n                props.saveSearchBarText(tagName);\n                if (searchText === 'trending') {\n                    onTrending();\n                } else {\n                    onSearch();\n                }\n            }\n            return (\n                <a\n                    onClick={callback}\n                    key={index}\n                >\n                    <div className='category-container'>\n                        <div\n                            className='category'\n                            style={{...backgroundImage, ...backgroundColor}}\n                        >\n                            <div className='category-name'>{tagName}</div>\n                        </div>\n                    </div>\n                </a>\n            );\n        }) : [];\n\n        return content && content.length ? (\n            <div\n                className='categories-container'\n                style={style.background}\n            >\n                <InfiniteScroll\n                    hasMore={hasMore}\n                    loadMore={this.loadMore}\n                    threshold={1}\n                >\n                    {content}\n                </InfiniteScroll>\n            </div>\n        ) : (\n            <div\n                className='categories-container'\n                style={style.background}\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Categories);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent} from 'react';\nimport {connect} from 'react-redux';\n\nimport PropTypes from 'prop-types';\n\nimport './SearchItem.scss';\nimport * as PostUtils from 'utils/post_utils.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        hasImageProxy: state.entities.general.config.HasImageProxy,\n    };\n}\n\nexport class SearchItem extends PureComponent {\n    static propTypes = {\n        gfyItem: PropTypes.object,\n        top: PropTypes.string,\n        left: PropTypes.string,\n        itemWidth: PropTypes.number,\n        itemClickHandler: PropTypes.func,\n        hasImageProxy: PropTypes.string,\n    }\n\n    render() {\n        const {\n            gfyItem,\n            top,\n            left,\n            itemWidth,\n            itemClickHandler,\n        } = this.props;\n\n        const {width, height, max1mbGif, avgColor} = gfyItem;\n        const {hasImageProxy} = this.props;\n        const url = PostUtils.getImageSrc(max1mbGif, hasImageProxy === 'true');\n\n        const backgroundImage = {backgroundImage: `url(${url})`};\n        const backgroundColor = {backgroundColor: avgColor};\n        const paddingBottom = {paddingBottom: ((itemWidth / width) * height) + 'px'};\n\n        return (\n            <div\n                className='search-item-wrapper'\n                style={{top, left, width: itemWidth ? `${itemWidth}px` : ''}}\n            >\n                <div\n                    className='search-item'\n                    style={{...backgroundImage, ...backgroundColor, ...paddingBottom}}\n                    onClick={() => itemClickHandler(gfyItem)}\n                />\n            </div>\n        );\n    }\n}\n\nexport default connect(mapStateToProps)(SearchItem);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\nimport {connect} from 'react-redux';\n\nimport {saveSearchScrollPosition} from 'mattermost-redux/actions/gifs';\nimport {getTheme} from 'mattermost-redux/selectors/entities/preferences';\nimport {changeOpacity, makeStyleFromTheme} from 'mattermost-redux/utils/theme_utils';\n\nimport {trackEvent} from 'actions/diagnostics_actions.jsx';\n\nimport InfiniteScroll from 'components/gif_picker/components/InfiniteScroll';\nimport SearchItem from 'components/gif_picker/components/SearchItem';\n\nimport './SearchGrid.scss';\n\nconst ITEMS_PADDING = 8;\nconst NUMBER_OF_COLUMNS_PORTRAIT = 2;\nconst NUMBER_OF_COLUMNS_LANDSCAPE = 2;\nconst WEBKIT_SCROLLBAR_WIDTH = 8;\n\nfunction mapStateToProps(state) {\n    return {\n        ...state.entities.gifs.cache,\n        ...state.entities.gifs.search,\n        theme: getTheme(state),\n        appProps: state.entities.gifs.app,\n    };\n}\n\nconst mapDispatchToProps = ({\n    saveSearchScrollPosition,\n});\n\nconst getStyle = makeStyleFromTheme((theme) => {\n    return {\n        background: {\n            backgroundColor: changeOpacity(theme.centerChannelColor, 0.05),\n        },\n    };\n});\n\nexport class SearchGrid extends PureComponent {\n    static propTypes = {\n        appProps: PropTypes.object,\n        gifs: PropTypes.object,\n        resultsByTerm: PropTypes.object,\n        containerClassName: PropTypes.string,\n        keyword: PropTypes.string, // searchText, tagName\n        handleItemClick: PropTypes.func,\n        onCategories: PropTypes.func,\n        loadMore: PropTypes.func,\n        numberOfColumns: PropTypes.number,\n        scrollPosition: PropTypes.number,\n        saveSearchScrollPosition: PropTypes.func,\n        theme: PropTypes.object.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            containerWidth: null,\n        };\n        this.scrollPosition = this.props.scrollPosition;\n        this.setNumberOfColumns();\n\n        /**\n         * Inital values for columns heights\n         */\n        this.columnsHeights = Array(this.numberOfColumns).fill(0);\n\n        /**\n         * Items padding value\n         */\n        this.padding = ITEMS_PADDING;\n    }\n\n    componentDidMount() {\n        this.container = document.getElementById('search-grid-container');\n        // eslint-disable-next-line react/no-did-mount-set-state\n        this.setState({\n            ...this.state,\n            containerWidth: this.container.offsetWidth - WEBKIT_SCROLLBAR_WIDTH,\n        });\n        window.addEventListener('resize', this.resizeHandler);\n        window.addEventListener('scroll', this.scrollHandler);\n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.keyword !== this.props.keyword) {\n            window.scrollTo(0, 0);\n        }\n    }\n\n    componentWillUnmount() {\n        const {keyword} = this.props;\n        if (keyword !== 'trending') {\n            this.props.saveSearchScrollPosition(this.scrollPosition);\n        }\n\n        window.removeEventListener('resize', this.resizeHandler);\n        window.removeEventListener('scroll', this.scrollHandler);\n    }\n\n    setNumberOfColumns = () => {\n        if (window.matchMedia('(orientation: portrait)').matches) {\n            this.numberOfColumns = NUMBER_OF_COLUMNS_PORTRAIT;\n        } else {\n            this.numberOfColumns = NUMBER_OF_COLUMNS_LANDSCAPE;\n        }\n    }\n\n    itemClickHandler = (gfyItem) => {\n        const {keyword, handleItemClick} = this.props;\n        this.props.saveSearchScrollPosition(this.scrollPosition);\n\n        trackEvent('gfycat', 'shares', {gfyid: gfyItem.gfyId, keyword});\n        handleItemClick(gfyItem);\n    }\n\n    minHeightColumnIndex = () => {\n        return this.columnsHeights.indexOf(Math.min(...this.columnsHeights));\n    }\n\n    maxHeightColumnIndex = () => {\n        return this.columnsHeights.indexOf(Math.max(...this.columnsHeights));\n    }\n\n    maxColumnHeight = () => {\n        return Math.max(...this.columnsHeights);\n    }\n\n    resizeHandler = () => {\n        if (this.state.containerWidth !== this.container.offsetWidth - WEBKIT_SCROLLBAR_WIDTH) {\n            this.setNumberOfColumns();\n            this.setState({\n                ...this.state,\n                containerWidth: this.container.offsetWidth - WEBKIT_SCROLLBAR_WIDTH,\n            });\n            this.columnsHeights = Array(this.numberOfColumns).fill(0);\n        }\n    }\n\n    scrollHandler = () => {\n        this.scrollPosition = window.scrollY;\n    }\n\n    render() {\n        const style = getStyle(this.props.theme);\n        const {\n            containerClassName,\n            gifs,\n            keyword,\n            resultsByTerm,\n            scrollPosition,\n            loadMore,\n            onCategories,\n        } = this.props;\n\n        const {containerWidth} = this.state;\n        const {moreRemaining, items = [], isEmpty} = resultsByTerm[keyword] ? resultsByTerm[keyword] : {};\n\n        /**\n         * Columns 'left' values\n         */\n        const columnWidth = parseInt(containerWidth / this.numberOfColumns, 10);\n        const leftPosition = Array(this.numberOfColumns).fill(0).map((item, index) => this.padding + ((index * columnWidth) - (index * (this.padding / 2))));\n\n        this.columnsHeights = Array(this.numberOfColumns).fill(this.padding);\n\n        // Item width in %\n        //const itemWidth = this.numberOfColumns === NUMBER_OF_COLUMNS_PORTRAIT ? 100 / NUMBER_OF_COLUMNS_PORTRAIT : 100 / this.numberOfColumns;\n        const itemWidth = 140;\n\n        const searchItems = containerWidth && items.length ?\n            items.map((item, index) => {\n                const gfyItem = gifs[item];\n                const {gfyId} = gfyItem;\n\n                // Position calculation\n                const colIndex = this.minHeightColumnIndex();\n                const top = this.columnsHeights[colIndex] + 'px';\n                const left = leftPosition[colIndex] + 'px';\n                const itemHeight = ((itemWidth / gfyItem.width) * gfyItem.height) + this.padding;\n                this.columnsHeights[colIndex] += itemHeight;\n\n                return (\n                    <SearchItem\n                        gfyItem={gfyItem}\n                        top={top}\n                        left={left}\n                        itemWidth={itemWidth}\n                        itemClickHandler={this.itemClickHandler}\n                        key={`${index}-${gfyId}`}\n                    />\n                );\n            }) : null;\n\n        this.containerHeight = this.maxColumnHeight();\n\n        const content = searchItems ? (\n            <InfiniteScroll\n                className='search-grid-infinite-scroll'\n                pageStart={0}\n                loadMore={loadMore}\n                initialLoad={false}\n                hasMore={moreRemaining}\n                threshold={1}\n                containerHeight={this.containerHeight}\n                scrollPosition={scrollPosition}\n                useWindow={false}\n            >\n                {searchItems}\n            </InfiniteScroll>\n        ) : null;\n\n        const emptySearch = isEmpty ? (\n            <div className='empty-search'>\n                <div className='empty-search-image'/>\n                <p>{'0 Gifs found for '}<strong>{keyword}</strong></p>\n                <a onClick={onCategories}>\n                    <div className='empty-search-button'>{'Go to Reactions'}</div>\n                </a>\n            </div>\n        ) : null;\n\n        return (\n            <div\n                id='search-grid-container'\n                className={`search-grid-container ${containerClassName}`}\n                style={style.background}\n            >\n                {content}\n                {emptySearch}\n            </div>\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SearchGrid);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {saveSearchScrollPosition} from 'mattermost-redux/actions/gifs';\n\nimport SearchGrid from './SearchGrid';\n\nfunction mapStateToProps(state) {\n    return {\n        ...state.entities.gifs.cache,\n        ...state.entities.gifs.search,\n        appProps: state.entities.gifs.app,\n    };\n}\n\nfunction mapDispatchToProps() {\n    return {\n        saveSearchScrollPosition,\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SearchGrid);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\nimport {connect} from 'react-redux';\n\nimport {searchIfNeededInitial, searchGfycat} from 'mattermost-redux/actions/gifs';\n\nimport SearchGrid from 'components/gif_picker/components/SearchGrid';\n\nfunction mapStateToProps(state) {\n    return {\n        ...state.entities.gifs.search,\n    };\n}\n\nconst mapDispatchToProps = ({\n    searchGfycat,\n    searchIfNeededInitial,\n});\n\nexport class Search extends PureComponent {\n    static propTypes = {\n        handleItemClick: PropTypes.func,\n        onCategories: PropTypes.func,\n        searchText: PropTypes.string,\n        searchIfNeededInitial: PropTypes.func,\n        searchGfycat: PropTypes.func,\n    }\n\n    componentDidMount() {\n        const {searchText} = this.props;\n        this.props.searchIfNeededInitial(searchText.split('-').join(' '));\n    }\n\n    componentDidUpdate(prevProps) {\n        const {searchText} = this.props;\n        if (prevProps.searchText !== searchText) {\n            this.props.searchIfNeededInitial(searchText.split('-').join(' '));\n        }\n    }\n\n    loadMore = () => {\n        const {searchText} = this.props;\n        this.props.searchGfycat({searchText});\n    }\n\n    render() {\n        const {handleItemClick, searchText, onCategories} = this.props;\n\n        return (\n            <SearchGrid\n                keyword={searchText}\n                handleItemClick={handleItemClick}\n                onCategories={onCategories}\n                loadMore={this.loadMore}\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Search);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\nimport {connect} from 'react-redux';\n\nimport {\n    searchCategory,\n    searchIfNeededInitial,\n    saveSearchScrollPosition,\n} from 'mattermost-redux/actions/gifs';\n\nimport SearchGrid from 'components/gif_picker/components/SearchGrid';\n\nconst mapDispatchToProps = ({\n    searchCategory,\n    searchIfNeededInitial,\n    saveSearchScrollPosition,\n});\n\nexport class Trending extends PureComponent {\n    static propTypes = {\n        handleItemClick: PropTypes.func,\n        onCategories: PropTypes.func,\n        searchCategory: PropTypes.func,\n        searchIfNeededInitial: PropTypes.func,\n        saveSearchScrollPosition: PropTypes.func,\n    }\n\n    componentDidMount() {\n        this.props.searchIfNeededInitial('trending');\n    }\n\n    componentWillUnmount() {\n        this.props.saveSearchScrollPosition(0);\n    }\n\n    loadMore = () => {\n        this.props.searchCategory({tagName: 'trending'});\n    }\n\n    render() {\n        const {handleItemClick, onCategories} = this.props;\n        return (\n            <SearchGrid\n                keyword='trending'\n                handleItemClick={handleItemClick}\n                onCategories={onCategories}\n                loadMore={this.loadMore}\n            />\n        );\n    }\n}\n\nexport default connect(null, mapDispatchToProps)(Trending);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport PureRenderMixin from 'react-addons-pure-render-mixin';\n\nimport App from 'components/gif_picker/components/App';\nimport Categories from 'components/gif_picker/components/Categories';\nimport Search from 'components/gif_picker/components/Search';\nimport Trending from 'components/gif_picker/components/Trending';\nimport constants from 'components/gif_picker/utils/constants';\n\nexport const appProps = {\n    appName: constants.appName.mattermost,\n    basePath: '/mattermost',\n    itemTapType: constants.ItemTapAction.SHARE,\n    appClassName: 'gfycat',\n    shareEvent: 'shareMattermost',\n    appId: 'mattermostwebviews',\n    enableHistory: true,\n    header: {\n        tabs: [constants.Tab.TRENDING, constants.Tab.REACTIONS],\n        displayText: false,\n    },\n};\n\nexport default class GifPicker extends React.Component {\n    static propTypes = {\n        onGifClick: PropTypes.func.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        // All props are primitives or treated as immutable\n        this.shouldComponentUpdate = PureRenderMixin.shouldComponentUpdate.bind(this);\n\n        this.state = {\n            action: 'trending',\n        };\n    }\n\n    handleTrending = () => {\n        this.setState({\n            action: 'trending',\n        });\n    }\n\n    handleCategories = () => {\n        this.setState({\n            action: 'reactions',\n        });\n    }\n\n    handleSearch = () => {\n        this.setState({\n            action: 'search',\n        });\n    }\n\n    handleItemClick = (gif) => {\n        this.props.onGifClick(gif.max5mbGif);\n    }\n\n    render() {\n        const {action} = this.state;\n        let component;\n        switch (action) {\n        case 'reactions':\n            component = (\n                <Categories\n                    appProps={appProps}\n                    onTrending={this.handleTrending}\n                    onSearch={this.handleSearch}\n                />\n            );\n            break;\n        case 'search':\n            component = (\n                <Search\n                    appProps={appProps}\n                    onCategories={this.handleCategories}\n                    handleItemClick={this.handleItemClick}\n                />\n            );\n            break;\n        case 'trending':\n            component = (\n                <Trending\n                    appProps={appProps}\n                    onCategories={this.handleCategories}\n                    handleItemClick={this.handleItemClick}\n                />\n            );\n            break;\n        }\n        return (\n            <div>\n                <App\n                    appProps={appProps}\n                    action={action}\n                    onTrending={this.handleTrending}\n                    onCategories={this.handleCategories}\n                    onSearch={this.handleSearch}\n                >\n                    {component}\n                </App>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nexport default class EmojiIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <svg\n                    width='16px'\n                    height='16px'\n                    viewBox='0 0 15 15'\n                    role='img'\n                    aria-label='Emoji icon'\n                >\n                    <g\n                        stroke='none'\n                        strokeWidth='1'\n                        fill='inherit'\n                        fillRule='evenodd'\n                    >\n                        <g\n                            transform='translate(-1071.000000, -954.000000)'\n                            fill='inherit'\n                        >\n                            <g transform='translate(25.000000, 937.000000)'>\n                                <g transform='translate(1046.000000, 17.000000)'>\n                                    <path d='M7.5,0.0852272727 C3.405,0.0852272727 0.0852272727,3.405 0.0852272727,7.5 C0.0852272727,11.595 3.405,14.9147727 7.5,14.9147727 C11.595,14.9147727 14.9147727,11.595 14.9147727,7.5 C14.9147727,3.405 11.595,0.0852272727 7.5,0.0852272727 Z M7.5,14.0663436 C3.87926951,14.0663436 0.933656417,11.1207305 0.933656417,7.5 C0.933656417,3.87926951 3.87926951,0.933656417 7.5,0.933656417 C11.1207305,0.933656417 14.0663436,3.87926951 14.0663436,7.5 C14.0663436,11.1207305 11.1207305,14.0663436 7.5,14.0663436 Z'/>\n                                    <path d='M11.7732955,8.95397727 C12.0119318,8.90488636 12.2159659,9.11778409 12.1684091,9.35676136 C11.8063636,11.1790909 9.85346591,12.5710227 7.49846591,12.5710227 C5.15096591,12.5710227 3.20284091,11.1877841 2.83193182,9.37397727 C2.78181818,9.129375 2.99267045,8.911875 3.23744318,8.96198864 C4.85369318,9.29232955 10.1786932,9.28142045 11.7732955,8.95397727 Z'/>\n                                    <ellipse\n                                        cx='4.94318182'\n                                        cy='5.50431818'\n                                        rx='1'\n                                        ry='1.06534091'\n                                    />\n                                    <ellipse\n                                        cx='10.0568182'\n                                        cy='5.50431818'\n                                        rx='1'\n                                        ry='1.06534091'\n                                    />\n                                </g>\n                            </g>\n                        </g>\n                    </g>\n                </svg>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nexport default class GfycatIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <svg\n                    width='22px'\n                    height='14px'\n                    viewBox='0 0 22 14'\n                >\n                    <g\n                        stroke='none'\n                        strokeWidth='1'\n                        fill='inherit'\n                        fillRule='evenodd'\n                    >\n                        <g\n                            transform='translate(-1344.000000, -552.000000)'\n                            fill='inherit'\n                        >\n                            <g transform='translate(1147.000000, 542.000000)'>\n                                <g transform='translate(1.000000, 1.000000)'>\n                                    <g transform='translate(138.000000, 0.000000)'>\n                                        <path d='M63.6748519,23 L62.2292481,23 C61.8176589,23 61.4619872,22.8510143 61.1631497,22.5539741 C60.8633954,22.2569338 60.71306,21.8993681 60.71306,21.4831393 C60.71306,21.0678417 60.8597287,20.710276 61.1539829,20.4132358 C61.4473204,20.1161955 61.800242,19.9672098 62.2118312,19.9672098 L63.6565183,19.9672098 C64.0681075,19.9672098 64.4182791,19.8219488 64.7061166,19.5304955 C64.993954,19.2390422 65.1378727,18.8917193 65.1378727,18.4866644 L65.1378727,15.4371134 C65.1378727,15.0208846 64.993954,14.6670436 64.7061166,14.3755903 C64.4182791,14.084137 64.0745243,13.938876 63.6748519,13.938876 C63.2632628,13.938876 62.9103411,14.0869305 62.6170036,14.3849019 C62.3227494,14.6819421 62.1760807,15.0329897 62.1760807,15.4371134 C62.1760807,15.7294978 62.3016658,16.0563352 62.5519193,16.4185567 L62.575753,16.4530096 C62.8269232,16.8143 62.9515917,17.1420685 62.9515917,17.4344529 C62.9515917,17.8506817 62.8049229,18.2073163 62.5115854,18.5043565 C62.2173313,18.8023279 61.8653263,18.9503824 61.4537371,18.9503824 C60.7836443,18.9503824 60.2198863,18.5164616 59.7615465,17.6486199 C59.373791,16.9232458 59.1794549,16.1857665 59.1794549,15.4371134 C59.1794549,14.188427 59.6176278,13.1213169 60.4930568,12.234852 C61.3684859,11.3493183 62.4226675,10.9060858 63.6565183,10.9060858 C64.8912858,10.9060858 65.9482175,11.3493183 66.8300633,12.234852 C67.7109925,13.1213169 68.1519154,14.188427 68.1519154,15.4371134 L68.1519154,18.4866644 C68.1519154,19.7353508 67.7137425,20.7996674 66.8383134,21.6796142 C65.9628844,22.559561 64.9087028,23 63.6748519,23 Z M80,15.9269039 C80,16.3068174 79.8689148,16.6317925 79.6076611,16.9027602 C79.3454907,17.173728 79.0319863,17.3096774 78.6653144,17.3096774 L76.8438719,17.3096774 L76.8438719,18.6589292 C76.8438719,19.0388427 76.7127867,19.3638178 76.4506164,19.6347855 C76.1893627,19.9057532 75.8749415,20.0417027 75.5082697,20.0417027 C75.1315143,20.0417027 74.8125098,19.9057532 74.5503394,19.6347855 C74.2890857,19.3638178 74.1580005,19.0388427 74.1580005,18.6589292 L74.1580005,13.1464583 C74.1580005,12.00858 74.5485061,11.0355171 75.3276838,10.2272697 C76.1077782,9.41995344 77.0473748,9.01582973 78.1473904,9.01582973 L78.6653144,9.01582973 C79.0319863,9.01582973 79.3454907,9.15177918 79.6076611,9.42274692 C79.8689148,9.69371467 80,10.0186897 80,10.3986033 C80,10.7775856 79.8689148,11.1034919 79.6076611,11.3744596 C79.3454907,11.6454273 79.0319863,11.7804456 78.6653144,11.7804456 L78.162974,11.7804456 C77.7963021,11.7804456 77.481881,11.9163951 77.2206273,12.1873628 C76.9584569,12.4583306 76.8282884,12.7777187 76.8282884,13.1464583 L76.8282884,14.5450615 L78.6653144,14.5450615 C79.0319863,14.5450615 79.3454907,14.681011 79.6076611,14.9519787 C79.8689148,15.2229465 80,15.5479215 80,15.9269039 Z M72.6344789,18.6589292 C72.6344789,19.0388427 72.5043104,19.3638178 72.24214,19.6347855 C71.9808863,19.9057532 71.6664652,20.0417027 71.2997933,20.0417027 C70.9340382,20.0417027 70.616867,19.9057532 70.3501132,19.6347855 C70.0833594,19.3638178 69.9495242,19.0388427 69.9495242,18.6589292 L69.9495242,14.170735 C69.9495242,13.7917526 70.0806094,13.4667775 70.3418631,13.1958098 C70.6040335,12.9239109 70.9175379,12.7888926 71.2842098,12.7888926 C71.6508817,12.7888926 71.9671361,12.9239109 72.2348066,13.1958098 C72.5015604,13.4667775 72.6344789,13.7917526 72.6344789,14.170735 L72.6344789,18.6589292 Z M58.3370263,12.5356169 C58.1023563,11.7441304 58.0042716,10.9163286 58.0042716,10.9163286 C57.9721878,10.6937812 58.1243566,10.547589 58.3425264,10.5904223 C58.3425264,10.5904223 58.5350291,10.6267376 58.8017829,10.6807449 C59.0767868,10.7375457 59.4324585,10.8139009 59.7404628,10.8921184 C60.3473048,11.0448287 60.95323,11.2720319 60.95323,11.2720319 C60.95323,11.2720319 60.2904706,11.6621882 59.7239626,12.3018956 C59.1565379,12.9406718 58.8650338,13.8420353 58.8650338,13.8420353 C58.8650338,13.8420353 58.5716963,13.3280346 58.3370263,12.5356169 Z M69.088762,12.5356169 C69.323432,11.7441304 69.4224334,10.9163286 69.4224334,10.9163286 C69.4536005,10.6937812 69.3014317,10.547589 69.0832619,10.5904223 C69.0832619,10.5904223 68.2921674,10.7384769 67.6853254,10.8921184 C67.0794002,11.0448287 66.4725583,11.2720319 66.4725583,11.2720319 C66.4725583,11.2720319 67.1353177,11.6621882 67.7027424,12.3018956 C68.2692504,12.9406718 68.5616712,13.8420353 68.5616712,13.8420353 C68.5616712,13.8420353 68.8550087,13.3280346 69.088762,12.5356169 Z M72.6344789,10.3818424 C72.6344789,10.7617559 72.5043104,11.086731 72.24214,11.3576987 C71.9808863,11.6286664 71.6664652,11.7646159 71.2997933,11.7646159 C70.9340382,11.7646159 70.616867,11.6286664 70.3501132,11.3576987 C70.0833594,11.086731 69.9495242,10.7617559 69.9495242,10.3818424 C69.9495242,10.00286 70.0806094,9.67788494 70.3418631,9.40691719 C70.6040335,9.13594945 70.9175379,9 71.2842098,9 C71.6508817,9 71.9671361,9.13594945 72.2348066,9.40691719 C72.5015604,9.67788494 72.6344789,10.00286 72.6344789,10.3818424 Z'/>\n                                    </g>\n                                </g>\n                            </g>\n                        </g>\n                    </g>\n                </svg>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class EmojiPickerHeader extends React.PureComponent {\n    static propTypes = {\n        handleEmojiPickerClose: PropTypes.func.isRequired,\n    };\n\n    render() {\n        return (\n            <div className='emoji-picker__header modal-header'>\n                <button\n                    type='button'\n                    className='close emoji-picker__header-close-button'\n                    onClick={this.props.handleEmojiPickerClose}\n                >\n                    <span aria-hidden='true'>{''}</span>\n                    <span className='sr-only'>\n                        <FormattedMessage\n                            id={'emoji_picker.close'}\n                            defaultMessage={'Close'}\n                        />\n                    </span>\n                </button>\n                <h4 className='modal-title emoji-picker__header-title'>\n                    <FormattedMessage\n                        id={'emoji_picker.header'}\n                        defaultMessage={'Emoji Picker'}\n                    />\n                </h4>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nconst defaultRule = (aName, bName, emojiA, emojiB) => {\n    if (emojiA && emojiB && emojiA.category === 'custom' && emojiB.category !== 'custom') {\n        return 1;\n    } else if (emojiB && emojiA && emojiB.category === 'custom' && emojiA.category !== 'custom') {\n        return -1;\n    }\n\n    return aName.localeCompare(bName);\n};\n\nconst thumbsDownRule = (otherName) => {\n    if (otherName === 'thumbsup' || otherName === '+1') {\n        return 1;\n    }\n    return 0;\n};\n\nconst thumbsUpRule = (otherName) => {\n    if (otherName === 'thumbsdown' || otherName === '-1') {\n        return -1;\n    }\n    return 0;\n};\n\nconst customRules = {\n    thumbsdown: thumbsDownRule,\n    '-1': thumbsDownRule,\n    thumbsup: thumbsUpRule,\n    '+1': thumbsUpRule,\n};\n\nconst getEmojiName = (emoji, searchedName) => {\n    // There's an edge case for custom emojis that start with a thumb prefix.\n    // It doesn't match the first alias for the relevant system emoji.\n    // We don't have control over the names or aliases of custom emojis...\n    // ... and how they compare to the relevant system ones.\n    // So we need to search for a matching alias in the whole array.\n    // E.g. thumbsup-custom vs [+1, thumbsup]\n    if (!emoji || !(emoji.name || emoji.aliases)) {\n        return '';\n    }\n\n    if (searchedName) {\n        return emoji.name || emoji.aliases.find((alias) => alias.startsWith(searchedName)) || emoji.aliases[0];\n    }\n\n    return emoji.name || emoji.aliases[0];\n};\n\nexport function compareEmojis(emojiA, emojiB, searchedName) {\n    const aName = getEmojiName(emojiA, searchedName);\n    const bName = getEmojiName(emojiB, searchedName);\n\n    // Have the emojis that contain the search appear first\n    const aPrefix = aName.startsWith(searchedName);\n    const bPrefix = bName.startsWith(searchedName);\n\n    if (aPrefix === bPrefix) {\n        if (customRules[aName]) {\n            return customRules[aName](bName, emojiB) || defaultRule(aName, bName, emojiA, emojiB);\n        }\n\n        return defaultRule(aName, bName, emojiA, emojiB);\n    } else if (aPrefix) {\n        return -1;\n    }\n\n    return 1;\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nexport default class EmojiPickerCategory extends React.Component {\n    static propTypes = {\n        category: PropTypes.string.isRequired,\n        icon: PropTypes.node.isRequired,\n        onCategoryClick: PropTypes.func.isRequired,\n        selected: PropTypes.bool.isRequired,\n        enable: PropTypes.bool.isRequired,\n    }\n\n    shouldComponentUpdate(nextProps) {\n        return nextProps.selected !== this.props.selected ||\n            nextProps.enable !== this.props.enable;\n    }\n\n    handleClick = (e) => {\n        e.preventDefault();\n        this.props.onCategoryClick(this.props.category);\n    }\n\n    render() {\n        let className = 'emoji-picker__category';\n        if (this.props.selected) {\n            className += ' emoji-picker__category--selected';\n        }\n\n        if (!this.props.enable) {\n            className += ' disable';\n        }\n\n        return (\n            <a\n                className={className}\n                href='#'\n                onClick={this.handleClick}\n                aria-label={this.props.category}\n            >\n                {this.props.icon}\n            </a>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {injectIntl} from 'react-intl';\nimport debounce from 'lodash/debounce';\nimport {getEmojiImageUrl} from 'mattermost-redux/utils/emoji_utils';\n\nimport imgTrans from 'images/img_trans.gif';\nimport {intlShape} from 'utils/react_intl';\n\nconst SCROLLING_ADDITIONAL_VISUAL_SPACING = 10; // to make give the emoji some visual 'breathing room'\nconst EMOJI_LAZY_LOAD_SCROLL_THROTTLE = 150;\n\nclass EmojiPickerItem extends React.Component {\n    static propTypes = {\n        emoji: PropTypes.object.isRequired,\n        onItemOver: PropTypes.func.isRequired,\n        onItemClick: PropTypes.func.isRequired,\n        category: PropTypes.string.isRequired,\n        isSelected: PropTypes.bool,\n        categoryIndex: PropTypes.number.isRequired,\n        emojiIndex: PropTypes.number.isRequired,\n        containerRef: PropTypes.any,\n        containerTop: PropTypes.number.isRequired,\n        containerBottom: PropTypes.number.isRequired,\n        intl: intlShape.isRequired,\n    };\n\n    shouldComponentUpdate(nextProps) {\n        return nextProps.isSelected !== this.props.isSelected;\n    }\n\n    emojiItemRef = (emojiItem) => {\n        this.emojiItem = emojiItem;\n    };\n\n    emojiName = () => {\n        const {formatMessage} = this.props.intl;\n        return formatMessage({\n            id: 'emoji_picker_item.emoji_aria_label',\n            defaultMessage: '{emojiName} emoji',\n        },\n        {\n            emojiName: this.props.emoji.aliases[0].replace(/_/g, ' '),\n        });\n    }\n\n    componentDidUpdate(prevProps) {\n        if (!prevProps.isSelected && this.props.isSelected) {\n            const topOfTheEmojiItem = this.emojiItem.offsetTop;\n            const bottomOfTheEmojiItem = topOfTheEmojiItem + this.emojiItem.offsetHeight;\n            const {containerRef, containerTop, containerBottom} = this.props;\n            if (topOfTheEmojiItem < containerTop) {\n                containerRef.scrollTop = topOfTheEmojiItem - SCROLLING_ADDITIONAL_VISUAL_SPACING;\n            } else if (bottomOfTheEmojiItem > containerBottom) {\n                containerRef.scrollTop = (bottomOfTheEmojiItem - containerRef.offsetHeight) + SCROLLING_ADDITIONAL_VISUAL_SPACING;\n            }\n        }\n    }\n\n    handleMouseOver = () => {\n        if (!this.props.isSelected) {\n            this.props.onItemOver(this.props.categoryIndex, this.props.emojiIndex);\n        }\n    };\n\n    handleMouseOverThrottle = debounce(this.handleMouseOver, EMOJI_LAZY_LOAD_SCROLL_THROTTLE, {leading: true, trailing: true});\n\n    handleClick = () => {\n        this.props.onItemClick(this.props.emoji);\n    };\n\n    render() {\n        const {emoji} = this.props;\n\n        let itemClassName = 'emoji-picker__item';\n        if (this.props.isSelected) {\n            itemClassName += ' selected';\n        }\n\n        let spriteClassName = 'emojisprite';\n        spriteClassName += ' emoji-category-' + emoji.category + '-' + emoji.batch;\n        spriteClassName += ' emoji-' + emoji.filename;\n\n        let image;\n        if (emoji.category && emoji.batch) {\n            image = (\n                <img\n                    alt={'emoji image'}\n                    data-testid={emoji.aliases}\n                    onMouseOver={this.handleMouseOverThrottle}\n                    src={imgTrans}\n                    className={spriteClassName}\n                    onClick={this.handleClick}\n                    id={'emoji-' + emoji.filename}\n                    aria-label={this.emojiName()}\n                    role='button'\n                />\n            );\n        } else {\n            image = (\n                <img\n                    alt={'custom emoji image'}\n                    onMouseOver={this.handleMouseOver}\n                    src={getEmojiImageUrl(emoji)}\n                    className={'emoji-category--custom'}\n                    onClick={this.handleClick}\n                />\n            );\n        }\n\n        return (\n            <div\n                className={itemClassName}\n                ref={this.emojiItemRef}\n            >\n                <div data-testid='emojiItem'>\n                    {image}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default injectIntl(EmojiPickerItem);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class EmojiPickerCategorySection extends React.PureComponent {\n    static propTypes = {\n        categoryName: PropTypes.string.isRequired,\n        children: PropTypes.any,\n        updateCategoryOffset: PropTypes.func.isRequired,\n    };\n\n    componentDidMount() {\n        this.updateOffsetFrame = window.requestAnimationFrame(() => {\n            this.props.updateCategoryOffset(this.props.categoryName, this.div.offsetTop);\n        });\n    }\n\n    componentWillUnmount() {\n        if (this.updateOffsetFrame) {\n            window.cancelAnimationFrame(this.updateOffsetFrame);\n        }\n    }\n\n    divRef = (div) => {\n        this.div = div;\n    };\n\n    render() {\n        return (\n            <div\n                ref={this.divRef}\n            >\n                <div className='emoji-picker-items__container'>\n                    <div\n                        className='emoji-picker__category-header'\n                        id={`emojipickercat-${this.props.categoryName}`}\n                    >\n                        <FormattedMessage id={'emoji_picker.' + this.props.categoryName}/>\n                    </div>\n                </div>\n                <div className='emoji-picker-items__container'>\n                    {this.props.children}\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport {getEmojiImageUrl} from 'mattermost-redux/utils/emoji_utils';\n\nimport imgTrans from 'images/img_trans.gif';\n\nexport default class EmojiPickerPreview extends React.Component {\n    static propTypes = {\n        emoji: PropTypes.object,\n    }\n\n    render() {\n        const emoji = this.props.emoji;\n\n        if (emoji) {\n            let name;\n            let aliases;\n            let previewImage;\n\n            if (emoji.aliases && emoji.category && emoji.batch) {\n                // This is a system emoji which only has a list of aliases\n                name = emoji.aliases[0];\n                aliases = emoji.aliases;\n\n                previewImage = (\n                    <span className='sprite-preview'>\n                        <img\n                            id='emojiPickerSpritePreview'\n                            alt={'emoji category image'}\n                            src={imgTrans}\n                            className={'emojisprite-preview emoji-category-' + emoji.category + '-' + emoji.batch + ' emoji-' + emoji.filename}\n                        />\n                    </span>\n                );\n            } else {\n                // This is a custom emoji that matches the model on the server\n                name = emoji.name;\n                aliases = [emoji.name];\n                previewImage = (\n                    <img\n                        id='emojiPickerSpritePreview'\n                        alt={'emoji preview image'}\n                        className='emoji-picker__preview-image'\n                        src={getEmojiImageUrl(emoji)}\n                    />\n                );\n            }\n\n            return (\n                <div className='emoji-picker__preview'>\n                    <div className='emoji-picker__preview-image-box'>\n                        {previewImage}\n                    </div>\n                    <div className='emoji-picker__preview-image-label-box'>\n                        <span className='emoji-picker__preview-name'>{name}</span>\n                        <span\n                            id='emojiPickerAliasesPreview'\n                            className='emoji-picker__preview-aliases'\n                        >\n                            {':' + aliases[0] + ':'}\n                        </span>\n                    </div>\n                </div>\n            );\n        }\n\n        return (\n            <div className='emoji-picker__preview emoji-picker__preview-placeholder'>\n                <FormattedMessage\n                    id='emoji_picker.emojiPicker'\n                    defaultMessage='Emoji Picker'\n                />\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport throttle from 'lodash/throttle';\n\nimport * as Emoji from 'utils/emoji.jsx';\nimport {compareEmojis} from 'utils/emoji_utils.jsx';\nimport {t} from 'utils/i18n';\nimport imgTrans from 'images/img_trans.gif';\n\nimport LocalizedInput from 'components/localized_input/localized_input';\n\nimport EmojiPickerCategory from './components/emoji_picker_category';\nimport EmojiPickerItem from './components/emoji_picker_item';\nimport EmojiPickerCategorySection from './emoji_picker_category_section';\nimport EmojiPickerPreview from './components/emoji_picker_preview';\n\nconst CATEGORY_SEARCH_RESULTS = 'searchResults';\nt('emoji_picker.searchResults');\n\nconst EMOJI_HEIGHT = 27;\n\n// If this changes, the spaceRequiredAbove and spaceRequiredBelow props passed to the EmojiPickerOverlay must be updated\nconst EMOJI_CONTAINER_HEIGHT = 290;\nconst EMOJI_CONTAINER_STYLE = {\n    height: EMOJI_CONTAINER_HEIGHT,\n};\n\nconst EMOJI_LAZY_LOAD_BUFFER = 75;\nconst EMOJI_PER_ROW = 9; // needs to match variable `$emoji-per-row` in _variables.scss\nconst EMOJI_TO_LOAD_PER_UPDATE = 135;\nconst SYSTEM_EMOJIS_COUNT = 1476;\nconst EMOJI_LAZY_LOAD_SCROLL_THROTTLE = 100;\n\nconst recentEmojiCategory = {\n    recent: {\n        name: 'recent',\n        className: 'fa fa-clock-o',\n        id: t('emoji_picker.recent'),\n        message: 'Recently Used',\n        offset: 0,\n    },\n};\n\nconst peopleEmojiCategory = {\n    people: {\n        name: 'people',\n        className: 'fa fa-smile-o',\n        id: t('emoji_picker.people'),\n        message: 'People',\n        offset: 0,\n    },\n};\n\nconst CATEGORIES = {\n    ...peopleEmojiCategory,\n    nature: {\n        name: 'nature',\n        className: 'fa fa-leaf',\n        id: t('emoji_picker.nature'),\n        message: 'Nature',\n        offset: 0,\n    },\n    foods: {\n        name: 'foods',\n        className: 'fa fa-cutlery',\n        id: t('emoji_picker.foods'),\n        message: 'Foods',\n        offset: 0,\n    },\n    activity: {\n        name: 'activity',\n        className: 'fa fa-futbol-o',\n        id: t('emoji_picker.activity'),\n        message: 'Activity',\n        offset: 0,\n    },\n    places: {\n        name: 'places',\n        className: 'fa fa-plane',\n        id: t('emoji_picker.places'),\n        message: 'Places',\n        offset: 0,\n    },\n    objects: {\n        name: 'objects',\n        className: 'fa fa-lightbulb-o',\n        id: t('emoji_picker.objects'),\n        message: 'Objects',\n        offset: 0,\n    },\n    symbols: {\n        name: 'symbols',\n        className: 'fa fa-heart-o',\n        id: t('emoji_picker.symbols'),\n        message: 'Symbols',\n        offset: 0,\n    },\n    flags: {\n        name: 'flags',\n        className: 'fa fa-flag-o',\n        id: t('emoji_picker.flags'),\n        message: 'Flags',\n        offset: 0,\n    },\n    custom: {\n        name: 'custom',\n        className: 'fa fa-at',\n        id: t('emoji_picker.custom'),\n        message: 'Custom',\n        offset: 0,\n    },\n};\n\nfunction getEmojiFilename(emoji) {\n    return emoji.filename || emoji.id;\n}\n\nexport function filterEmojiSearchInput(input) {\n    return input.toLowerCase().replace(/^:|:$/g, '');\n}\n\nconst EMOJIS_PER_PAGE = 200;\nconst LOAD_MORE_AT_PIXELS_FROM_BOTTOM = 500;\n\nexport default class EmojiPicker extends React.PureComponent {\n    static propTypes = {\n        listHeight: PropTypes.number,\n        onEmojiClose: PropTypes.func.isRequired,\n        onEmojiClick: PropTypes.func.isRequired,\n        customEmojisEnabled: PropTypes.bool,\n        emojiMap: PropTypes.object.isRequired,\n        recentEmojis: PropTypes.array.isRequired,\n        customEmojiPage: PropTypes.number.isRequired,\n        visible: PropTypes.bool,\n        actions: PropTypes.shape({\n            getCustomEmojis: PropTypes.func.isRequired,\n            searchCustomEmojis: PropTypes.func.isRequired,\n            incrementEmojiPickerPage: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    static defaultProps = {\n        listHeight: 245,\n        customEmojiPage: 0,\n        customEmojisEnabled: false,\n    };\n\n    static getEmojis(props, state) {\n        const {categories, allEmojis} = state;\n        const emojiMap = props.emojiMap;\n        const customEmojiMap = emojiMap.customEmojis;\n\n        for (const category of Object.keys(categories)) {\n            let categoryEmojis = [];\n            if (category === 'recent' && props.recentEmojis.length) {\n                const recentEmojis = [...props.recentEmojis].reverse();\n                categoryEmojis = recentEmojis.filter((name) => {\n                    return emojiMap.has(name);\n                }).map((name) => {\n                    return emojiMap.get(name);\n                });\n            } else {\n                const indices = Emoji.EmojiIndicesByCategory.get(category) || [];\n                categoryEmojis = indices.map((index) => Emoji.Emojis[index]);\n                if (category === 'custom') {\n                    categoryEmojis = categoryEmojis.concat([...customEmojiMap.values()]);\n                }\n            }\n            categories[category].emojiIds = categoryEmojis.map((emoji) => getEmojiFilename(emoji));\n            for (let i = 0; i < categoryEmojis.length; i++) {\n                const currentEmoji = categoryEmojis[i];\n                const fileName = getEmojiFilename(currentEmoji);\n                allEmojis[fileName] = {\n                    ...currentEmoji,\n                    visible: false,\n                    offset: null,\n                };\n                if (!currentEmoji.filename) {\n                    // if custom emoji, set proper attributes\n                    allEmojis[fileName] = {\n                        ...allEmojis[fileName],\n                        aliases: [currentEmoji.name],\n                        category: 'custom',\n                        filename: fileName,\n                    };\n                }\n            }\n        }\n\n        return {categories, allEmojis};\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        let updatedState = {emojiMap: props.emojiMap};\n        if (JSON.stringify(Object.keys(state.categories)) !== state.categoryKeys || props.emojiMap !== state.emojiMap) {\n            const {categories, allEmojis} = EmojiPicker.getEmojis(props, state);\n            updatedState = {...updatedState, categories, allEmojis, categoryKeys: JSON.stringify(Object.keys(categories))};\n        }\n\n        return updatedState;\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.handleScrollThrottle = throttle(this.handleScroll, EMOJI_LAZY_LOAD_SCROLL_THROTTLE, {leading: false, trailing: true});\n\n        this.divHeight = 0;\n        this.missingPages = true;\n        this.loadingMoreEmojis = false;\n        const categories = props.recentEmojis.length ? {...recentEmojiCategory, ...peopleEmojiCategory} : peopleEmojiCategory;\n        this.state = {\n            allEmojis: {},\n            categories,\n            filter: '',\n            cursor: [-1, -1], // categoryIndex, emojiIndex\n            divTopOffset: 0,\n            emojisToShow: SYSTEM_EMOJIS_COUNT,\n            renderAllCategories: false,\n        };\n    }\n\n    componentDidMount() {\n        if (this.props.customEmojiPage === 0) {\n            this.loadMoreCustomEmojis();\n        }\n\n        // Delay taking focus because this briefly renders offscreen when using an Overlay\n        // so focusing it immediately on mount can cause weird scrolling\n        window.requestAnimationFrame(() => {\n            if (this.searchInput) {\n                this.searchInput.focus();\n            }\n            this.renderAllCategoriesFrame = window.requestAnimationFrame(() => {\n                this.renderAllCategories();\n            });\n        });\n\n        if (this.emojiPickerContainer) {\n            this.divHeight = this.emojiPickerContainer.offsetHeight;\n        }\n\n        const rootComponent = document.getElementById('root');\n        if (rootComponent) {\n            rootComponent.classList.add('emoji-picker--active');\n        }\n    }\n\n    updateEmojisToShow(divTopOffset) {\n        if (divTopOffset === this.state.divTopOffset) {\n            return;\n        }\n\n        this.setState({divTopOffset});\n        if (this.lastVisibleEmoji) {\n            const difference = this.lastVisibleEmoji.offsetTop - (divTopOffset + EMOJI_CONTAINER_HEIGHT + EMOJI_LAZY_LOAD_BUFFER);\n            if (difference <= 0) {\n                const numToLoad = EMOJI_TO_LOAD_PER_UPDATE + Math.ceil((difference / EMOJI_HEIGHT) * EMOJI_PER_ROW * -1);\n                this.setState((state) => ({\n                    emojisToShow: state.emojisToShow + numToLoad,\n                }));\n            }\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.renderAllCategoriesFrame) {\n            window.cancelAnimationFrame(this.renderAllCategoriesFrame);\n        }\n\n        const rootComponent = document.getElementById('root');\n        if (rootComponent) {\n            rootComponent.classList.remove('emoji-picker--active');\n        }\n    }\n\n    renderAllCategories = () => {\n        const categories = this.props.recentEmojis.length ? {...recentEmojiCategory, ...CATEGORIES} : CATEGORIES;\n        this.setState((state) => ({\n            categories: {\n                ...categories,\n                ...state.categories,\n            },\n            renderAllCategories: true,\n        }));\n    }\n\n    loadMoreCustomEmojis = async () => {\n        if (!this.props.customEmojisEnabled || this.loadingMoreEmojis) {\n            return;\n        }\n\n        this.loadingMoreEmojis = true;\n\n        const {data} = await this.props.actions.getCustomEmojis(this.props.customEmojiPage, EMOJIS_PER_PAGE);\n        if (!data) {\n            this.loadingMoreEmojis = false;\n            return;\n        }\n\n        if (data.length < EMOJIS_PER_PAGE) {\n            this.missingPages = false;\n            this.loadingMoreEmojis = false;\n            return;\n        }\n\n        await this.props.actions.incrementEmojiPickerPage();\n\n        this.loadingMoreEmojis = false;\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.visible && !prevProps.visible) {\n            this.searchInput.focus();\n        }\n\n        if (!this.missingPages || !this.emojiPickerContainer) {\n            return;\n        }\n\n        const pixelsFromBottom = this.emojiPickerContainer.scrollHeight - this.state.divTopOffset - this.emojiPickerContainer.clientHeight;\n        if (pixelsFromBottom <= LOAD_MORE_AT_PIXELS_FROM_BOTTOM) {\n            this.loadMoreCustomEmojis();\n        }\n    }\n\n    lastVisibleEmojiRef = (lastVisibleEmoji) => {\n        this.lastVisibleEmoji = lastVisibleEmoji;\n    };\n    emojiPickerContainerRef = (emojiPickerContainer) => {\n        this.emojiPickerContainer = emojiPickerContainer;\n    };\n    emojiSearchInput = (input) => {\n        this.searchInput = input;\n    };\n\n    handleCategoryClick = (categoryName) => {\n        this.setState({\n            cursor: [Object.keys(this.state.categories).indexOf(categoryName), 0],\n        });\n        this.updateEmojisToShow(this.state.categories[categoryName].offset);\n        this.emojiPickerContainer.scrollTop = this.state.categories[categoryName].offset;\n        this.searchInput.focus();\n    }\n\n    handleFilterChange = (e) => {\n        e.preventDefault();\n        const filter = filterEmojiSearchInput(e.target.value);\n\n        if (this.props.customEmojisEnabled && filter && filter.trim() !== '') {\n            this.props.actions.searchCustomEmojis(filter);\n        }\n\n        this.setState(() => ({\n            filter,\n            cursor: [0, 0],\n        }));\n    }\n\n    handleItemOver = (categoryIndex, emojiIndex) => {\n        this.setState({\n            cursor: [categoryIndex, emojiIndex],\n        });\n    }\n\n    handleItemClick = (emoji) => {\n        this.props.onEmojiClick(emoji);\n    }\n\n    handleCategoryKeyDown = (e) => {\n        switch (e.key) {\n        case 'ArrowRight':\n            e.preventDefault();\n            this.selectNextEmoji();\n            this.searchInput.focus();\n            break;\n        case 'ArrowLeft':\n            e.preventDefault();\n            this.selectPrevEmoji();\n            this.searchInput.focus();\n            break;\n        case 'ArrowUp':\n            e.preventDefault();\n            this.selectPrevEmoji(EMOJI_PER_ROW);\n            this.searchInput.focus();\n            break;\n        case 'ArrowDown':\n            e.preventDefault();\n            this.selectNextEmoji(EMOJI_PER_ROW);\n            this.searchInput.focus();\n            break;\n        }\n    }\n\n    handleKeyDown = (e) => {\n        switch (e.key) {\n        case 'ArrowRight':\n            e.preventDefault();\n            this.selectNextEmoji();\n            break;\n        case 'ArrowLeft':\n            e.preventDefault();\n            this.selectPrevEmoji();\n            break;\n        case 'ArrowUp':\n            e.preventDefault();\n            this.selectPrevEmoji(EMOJI_PER_ROW);\n            break;\n        case 'ArrowDown':\n            e.preventDefault();\n            this.selectNextEmoji(EMOJI_PER_ROW);\n            break;\n        case 'Enter':\n            e.preventDefault();\n            if (this.getCurrentEmojiByCursor(this.state.cursor)) {\n                this.props.onEmojiClick(this.getCurrentEmojiByCursor(this.state.cursor));\n            }\n            break;\n        }\n    }\n\n    handleScroll = () => {\n        if (this.emojiPickerContainer) {\n            this.updateEmojisToShow(this.emojiPickerContainer.scrollTop);\n        }\n    }\n\n    selectNextEmoji(offset = 1) {\n        const {cursor} = this.state;\n\n        // try moving to next emoji in index\n        let newCursor = [cursor[0], cursor[1] + offset];\n        if (this.getCurrentEmojiByCursor(newCursor)) {\n            this.setState({cursor: newCursor});\n            return;\n        }\n\n        // try moving to next category\n        newCursor = [cursor[0] + 1, 0];\n        if (this.getCurrentEmojiByCursor(newCursor)) {\n            this.setState({cursor: newCursor});\n        }\n    }\n\n    selectPrevEmoji(offset = 1) {\n        const {cursor} = this.state;\n\n        // try moving to prev emoji in index\n        let newCursor = [cursor[0], cursor[1] - offset];\n        if (this.getCurrentEmojiByCursor(newCursor)) {\n            this.setState({cursor: newCursor});\n            return;\n        }\n\n        // try moving to end of prev category\n        if (cursor[0] !== 0) {\n            const newCategory = this.getCategoryByIndex(cursor[0] - 1);\n            const lastVisibleEmojiInNewCategory = this.state.categories[newCategory.name].emojiIds.length - 1;\n            newCursor = [cursor[0] - 1, lastVisibleEmojiInNewCategory];\n            if (this.getCurrentEmojiByCursor(newCursor)) {\n                this.setState({cursor: newCursor});\n            }\n        }\n    }\n\n    getCategoryByIndex(index) {\n        if (this.state.filter && index !== 0) {\n            return null;\n        }\n        return this.getCategoriesByKey(Object.keys(this.state.categories)[index]);\n    }\n\n    getCurrentEmojiByCursor(cursor) {\n        const category = this.getCategoryByIndex(cursor[0]);\n        if (!category) {\n            return null;\n        }\n        return this.getEmojisByCategory(category)[cursor[1]];\n    }\n\n    getCategoriesByKey(key) {\n        return this.state.filter ? {\n            id: CATEGORY_SEARCH_RESULTS,\n            name: CATEGORY_SEARCH_RESULTS,\n        } : this.state.categories[key];\n    }\n\n    sortEmojis(emojis) {\n        const {recentEmojis: recentEmojisProps} = this.props;\n        const recentEmojis = [];\n        const emojisMinusRecent = [];\n\n        Object.values(emojis).forEach((emoji) => {\n            let emojiArray = emojisMinusRecent;\n            for (let i = 0; i < emoji.aliases.length; i++) {\n                if (recentEmojisProps.includes(emoji.aliases[i].toLowerCase())) {\n                    emojiArray = recentEmojis;\n                }\n            }\n\n            emojiArray.push(emoji);\n        });\n\n        const sortEmojisHelper = (a, b) => {\n            return compareEmojis(a, b, this.state.filter);\n        };\n\n        recentEmojis.sort(sortEmojisHelper);\n\n        emojisMinusRecent.sort(sortEmojisHelper);\n\n        return [\n            ...recentEmojis,\n            ...emojisMinusRecent,\n        ];\n    }\n\n    getEmojisByCategory(category) {\n        if (this.state.filter) {\n            const emojis = Object.values(this.state.allEmojis).filter((emoji) => {\n                for (let i = 0; i < emoji.aliases.length; i++) {\n                    if (emoji.aliases[i].toLowerCase().includes(this.state.filter)) {\n                        return true;\n                    }\n                }\n\n                return false;\n            });\n\n            return this.sortEmojis(emojis);\n        }\n        return this.state.categories[category.name].emojiIds.map((emojiId) =>\n            this.state.allEmojis[emojiId]);\n    }\n\n    getCurrentEmojiName() {\n        const emoji = this.getCurrentEmojiByCursor(this.state.cursor);\n        if (!emoji) {\n            return '';\n        }\n\n        return emoji.aliases[0].replace(/_/g, ' ');\n    }\n\n    getCurrentEmojiCategoryName() {\n        const categories = Object.keys(this.state.categories);\n        let currentCategoryName = categories[0];\n\n        for (let i = categories.length - 1; i >= 0; i--) {\n            // go through in reverse so that you get the last category that matches\n            const category = this.state.categories[categories[i]];\n            if (category.offset && this.state.divTopOffset > category.offset - 20) {\n                currentCategoryName = categories[i];\n                break;\n            }\n        }\n        return currentCategoryName;\n    }\n\n    emojiCategories() {\n        const categories = this.props.recentEmojis.length ? {...recentEmojiCategory, ...CATEGORIES} : CATEGORIES;\n        const categoryKeys = Object.keys(categories);\n        const currentCategoryName = this.state.filter ? categoryKeys[0] : this.getCurrentEmojiCategoryName();\n        const emojiPickerCategories = categoryKeys.map((categoryName) => {\n            const category = categories[categoryName];\n\n            return (\n                <EmojiPickerCategory\n                    key={'header-' + category.name}\n                    category={category.name}\n                    icon={\n                        <FormattedMessage\n                            id={category.id}\n                            defaultMessage={category.message}\n                        >\n                            {(title) => (\n                                <i\n                                    className={category.className}\n                                    title={title}\n                                />\n                            )}\n                        </FormattedMessage>\n                    }\n                    onCategoryClick={this.handleCategoryClick}\n                    selected={currentCategoryName === category.name}\n                    enable={!this.state.filter}\n                />\n            );\n        });\n        return (\n            <div\n                id='emojiPickerCategories'\n                className='emoji-picker__categories'\n                onKeyDown={this.handleCategoryKeyDown}\n            >\n                {emojiPickerCategories}\n            </div>\n        );\n    }\n\n    emojiSearch() {\n        return (\n            <div className='emoji-picker__search-container'>\n                <span className='fa fa-search emoji-picker__search-icon'/>\n                <FormattedMessage\n                    id='emoji_picker.search_emoji'\n                    defaultMessage='Search for an emoji'\n                >\n                    {(ariaLabel) => (\n                        <LocalizedInput\n                            id='emojiPickerSearch'\n                            aria-label={ariaLabel}\n                            ref={this.emojiSearchInput}\n                            className='emoji-picker__search'\n                            data-testid='emojiInputSearch'\n                            type='text'\n                            onChange={this.handleFilterChange}\n                            onKeyDown={this.handleKeyDown}\n                            autocomplete='off'\n                            placeholder={{id: t('emoji_picker.search'), defaultMessage: 'Search Emoji'}}\n                        />\n                    )}\n                </FormattedMessage>\n            </div>\n        );\n    }\n\n    emojiCurrentResults() {\n        const {filter} = this.state;\n        const categories = filter ? [CATEGORY_SEARCH_RESULTS] : Object.keys(this.state.categories);\n        let numEmojisLoaded = 0;\n\n        let categoryComponents = [];\n        for (let i = 0; i < categories.length; i++) {\n            const category = this.getCategoriesByKey(categories[i]);\n            const emojis = this.getEmojisByCategory(category);\n            const items = this.emojiCurrentResultsItems(i, emojis, numEmojisLoaded);\n            numEmojisLoaded += items.length;\n            categoryComponents = [...categoryComponents, (\n                <EmojiPickerCategorySection\n                    key={category.id}\n                    categoryName={category.name}\n                    updateCategoryOffset={this.updateCategoryOffset}\n                    role='application'\n                >\n                    {items}\n                </EmojiPickerCategorySection>\n            )];\n        }\n\n        return (\n            <div\n                ref={this.emojiPickerContainerRef}\n                onScroll={this.handleScrollThrottle}\n                className='emoji-picker__items'\n                style={(EMOJI_CONTAINER_STYLE, {overflowY: this.state.renderAllCategories ? 'auto' : 'hidden'})}\n            >\n                <div className='emoji-picker__container'>\n                    {categoryComponents}\n                </div>\n            </div>\n        );\n    }\n    emojiCurrentResultsItems = (categoryIndex, emojis, currentEmojiLoadedCount) => {\n        const {cursor, emojisToShow} = this.state;\n        let numEmojisLoaded = currentEmojiLoadedCount;\n\n        return emojis.map((emoji, emojiIndex) => {\n            numEmojisLoaded++;\n\n            // set ref on first unloaded emoji\n            let ref;\n            if (numEmojisLoaded === emojisToShow) {\n                ref = this.lastVisibleEmojiRef;\n            }\n            if (numEmojisLoaded >= emojisToShow) {\n                return (\n                    <div\n                        key={numEmojisLoaded}\n                        className='emoji-picker__item'\n                        ref={ref}\n                    >\n                        <img\n                            alt={'emoji image'}\n                            src={imgTrans}\n                            className='emojisprite'\n                        />\n                    </div>\n                );\n            }\n            return (\n                <EmojiPickerItem\n                    key={emoji.filename + ':' + emojiIndex}\n                    emoji={emoji}\n                    onItemOver={this.handleItemOver}\n                    onItemClick={this.handleItemClick}\n                    onItemUnmount={emoji}\n                    category={emoji.category}\n                    isSelected={cursor[0] === (categoryIndex) && cursor[1] === emojiIndex}\n                    categoryIndex={categoryIndex}\n                    emojiIndex={emojiIndex}\n                    containerRef={this.emojiPickerContainer}\n                    containerTop={this.state.divTopOffset}\n                    containerBottom={this.state.divTopOffset + this.divHeight}\n                />\n            );\n        });\n    };\n\n    updateCategoryOffset = (categoryName, offset) => {\n        if (categoryName !== CATEGORY_SEARCH_RESULTS) {\n            this.setState((state) => ({\n                categories: {\n                    ...state.categories,\n                    [categoryName]: {\n                        ...state.categories[categoryName],\n                        offset,\n                    },\n                },\n            }));\n        }\n    }\n\n    render() {\n        return (\n            <div\n                className='emoji-picker__inner'\n                role='application'\n            >\n                <div\n                    aria-live='assertive'\n                    className='sr-only'\n                >\n                    <FormattedMessage\n                        id='emoji_picker_item.emoji_aria_label'\n                        defaultMessage='{emojiName} emoji'\n                        values={{\n                            emojiName: this.getCurrentEmojiName(),\n                        }}\n                    />\n                </div>\n                {this.emojiSearch()}\n                {this.emojiCategories()}\n                {this.emojiCurrentResults()}\n                <EmojiPickerPreview emoji={this.getCurrentEmojiByCursor(this.state.cursor)}/>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getCustomEmojis, searchCustomEmojis} from 'mattermost-redux/actions/emojis';\n\nimport {incrementEmojiPickerPage} from 'actions/emoji_actions.jsx';\nimport {getEmojiMap, getRecentEmojis} from 'selectors/emojis';\n\nimport EmojiPicker from './emoji_picker.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        customEmojisEnabled: state.entities.general.config.EnableCustomEmoji === 'true',\n        customEmojiPage: state.views.emoji.emojiPickerCustomPage,\n        emojiMap: getEmojiMap(state),\n        recentEmojis: getRecentEmojis(state),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            getCustomEmojis,\n            searchCustomEmojis,\n            incrementEmojiPickerPage,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(EmojiPicker);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React, {PureComponent} from 'react';\nimport {Tab, Tabs} from 'react-bootstrap';\n\nimport GifPicker from 'components/gif_picker/gif_picker.jsx';\nimport EmojiIcon from 'components/widgets/icons/emoji_icon';\nimport GfycatIcon from 'components/widgets/icons/gfycat_icon';\n\nimport EmojiPickerHeader from './components/emoji_picker_header';\n\nimport EmojiPicker from './';\n\nexport default class EmojiPickerTabs extends PureComponent {\n    static propTypes = {\n        style: PropTypes.object,\n        rightOffset: PropTypes.number,\n        topOffset: PropTypes.number,\n        placement: PropTypes.oneOf(['top', 'bottom', 'left']),\n        customEmojis: PropTypes.object,\n        onEmojiClose: PropTypes.func.isRequired,\n        onEmojiClick: PropTypes.func.isRequired,\n        onGifClick: PropTypes.func,\n        enableGifPicker: PropTypes.bool,\n    };\n\n    static defaultProps = {\n        rightOffset: 0,\n        topOffset: 0,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            emojiTabVisible: true,\n        };\n    }\n\n    handleEnterEmojiTab = () => {\n        this.setState({\n            emojiTabVisible: true,\n        });\n    };\n\n    handleExitEmojiTab = () => {\n        this.setState({\n            emojiTabVisible: false,\n        });\n    };\n\n    handleEmojiPickerClose = () => {\n        this.props.onEmojiClose();\n    }\n\n    render() {\n        let pickerStyle;\n        if (this.props.style && !(this.props.style.left === 0 && this.props.style.top === 0)) {\n            if (this.props.placement === 'top' || this.props.placement === 'bottom') {\n                // Only take the top/bottom position passed by React Bootstrap since we want to be right-aligned\n                pickerStyle = {\n                    top: this.props.style.top,\n                    bottom: this.props.style.bottom,\n                    right: this.props.rightOffset,\n                };\n            } else {\n                pickerStyle = {...this.props.style};\n            }\n\n            if (pickerStyle.top) {\n                pickerStyle.top += this.props.topOffset;\n            }\n        }\n\n        let pickerClass = 'emoji-picker';\n        if (this.props.placement === 'bottom') {\n            pickerClass += ' bottom';\n        }\n\n        if (this.props.enableGifPicker && typeof this.props.onGifClick != 'undefined') {\n            return (\n                <Tabs\n                    defaultActiveKey={1}\n                    id='emoji-picker-tabs'\n                    style={pickerStyle}\n                    className={pickerClass}\n                    justified={true}\n                >\n                    <EmojiPickerHeader handleEmojiPickerClose={this.handleEmojiPickerClose}/>\n                    <Tab\n                        eventKey={1}\n                        onEnter={this.handleEnterEmojiTab}\n                        onExit={this.handleExitEmojiTab}\n                        title={<EmojiIcon/>}\n                    >\n                        <EmojiPicker\n                            style={this.props.style}\n                            onEmojiClose={this.props.onEmojiClose}\n                            onEmojiClick={this.props.onEmojiClick}\n                            customEmojis={this.props.customEmojis}\n                            visible={this.state.emojiTabVisible}\n                        />\n                    </Tab>\n                    <Tab\n                        eventKey={2}\n                        title={<GfycatIcon/>}\n                        mountOnEnter={true}\n                        unmountOnExit={true}\n                    >\n                        <GifPicker\n                            onGifClick={this.props.onGifClick}\n                        />\n                    </Tab>\n                </Tabs>\n            );\n        }\n        return (\n            <div\n                id='emojiPicker'\n                style={pickerStyle}\n                className={`a11y__popup ${pickerClass} emoji-picker--single`}\n            >\n                <EmojiPickerHeader handleEmojiPickerClose={this.handleEmojiPickerClose}/>\n                <EmojiPicker\n                    style={this.props.style}\n                    onEmojiClose={this.props.onEmojiClose}\n                    onEmojiClick={this.props.onEmojiClick}\n                    customEmojis={this.props.customEmojis}\n                />\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Overlay} from 'react-bootstrap';\n\nimport {popOverOverlayPosition} from 'utils/position_utils.tsx';\nimport {Constants} from 'utils/constants';\n\nimport EmojiPickerTabs from './emoji_picker_tabs.jsx';\n\nexport default class EmojiPickerOverlay extends React.PureComponent {\n    // An emoji picker in the center channel is contained within the post list, so it needs space\n    // above for the channel header and below for the post textbox\n    static CENTER_SPACE_REQUIRED_ABOVE = 476;\n    static CENTER_SPACE_REQUIRED_BELOW = 497;\n\n    // An emoji picker in the RHS isn't constrained by the RHS, so it just needs space to fit\n    // the emoji picker itself\n    static RHS_SPACE_REQUIRED_ABOVE = 420;\n    static RHS_SPACE_REQUIRED_BELOW = 420;\n\n    static propTypes = {\n        show: PropTypes.bool.isRequired,\n        container: PropTypes.func,\n        target: PropTypes.func.isRequired,\n        onEmojiClick: PropTypes.func.isRequired,\n        onGifClick: PropTypes.func,\n        onHide: PropTypes.func.isRequired,\n        topOffset: PropTypes.number,\n        spaceRequiredAbove: PropTypes.number,\n        spaceRequiredBelow: PropTypes.number,\n        enableGifPicker: PropTypes.bool,\n    };\n\n    // Reasonable defaults calculated from from the center channel\n    static defaultProps = {\n        spaceRequiredAbove: EmojiPickerOverlay.CENTER_SPACE_REQUIRED_ABOVE,\n        spaceRequiredBelow: EmojiPickerOverlay.CENTER_SPACE_REQUIRED_BELOW,\n        enableGifPicker: false,\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {};\n    }\n\n    static emojiPickerPosition(props) {\n        const emojiTrigger = props.target();\n        let rightOffset = Constants.DEFAULT_EMOJI_PICKER_RIGHT_OFFSET;\n        if (emojiTrigger) {\n            rightOffset = window.innerWidth - emojiTrigger.getBoundingClientRect().left - Constants.DEFAULT_EMOJI_PICKER_LEFT_OFFSET;\n\n            if (rightOffset < Constants.DEFAULT_EMOJI_PICKER_RIGHT_OFFSET) {\n                rightOffset = Constants.DEFAULT_EMOJI_PICKER_RIGHT_OFFSET;\n            }\n        }\n\n        return rightOffset;\n    }\n\n    static getPlacement(props) {\n        const target = props.target();\n        if (target) {\n            const targetBounds = target.getBoundingClientRect();\n            return popOverOverlayPosition(targetBounds, window.innerHeight, props.spaceRequiredAbove, props.spaceRequiredBelow);\n        }\n\n        return 'top';\n    }\n\n    static getDerivedStateFromProps(props) {\n        return {\n            placement: EmojiPickerOverlay.getPlacement(props),\n            rightOffset: EmojiPickerOverlay.emojiPickerPosition(props),\n        };\n    }\n\n    render() {\n        return (\n            <Overlay\n                show={this.props.show}\n                placement={this.state.placement}\n                rootClose={true}\n                container={this.props.container}\n                onHide={this.props.onHide}\n                target={this.props.target}\n                animation={false}\n            >\n                <EmojiPickerTabs\n                    enableGifPicker={this.props.enableGifPicker}\n                    onEmojiClose={this.props.onHide}\n                    onEmojiClick={this.props.onEmojiClick}\n                    onGifClick={this.props.onGifClick}\n                    rightOffset={this.state.rightOffset}\n                    topOffset={this.props.topOffset}\n                />\n            </Overlay>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {haveIChannelPermission} from 'mattermost-redux/selectors/entities/roles';\nimport Permissions from 'mattermost-redux/constants/permissions';\n\nimport Constants from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\n\nexport function canManageMembers(state, channel) {\n    if (channel.type === Constants.PRIVATE_CHANNEL) {\n        return haveIChannelPermission(\n            state,\n            {\n                channel: channel.id,\n                team: channel.team_id,\n                permission: Permissions.MANAGE_PRIVATE_CHANNEL_MEMBERS,\n            }\n        );\n    }\n\n    if (channel.type === Constants.OPEN_CHANNEL) {\n        return haveIChannelPermission(\n            state,\n            {\n                channel: channel.id,\n                team: channel.team_id,\n                permission: Permissions.MANAGE_PUBLIC_CHANNEL_MEMBERS,\n            }\n        );\n    }\n\n    return true;\n}\n\nexport function findNextUnreadChannelId(curChannelId, allChannelIds, unreadChannelIds, direction) {\n    const curIndex = allChannelIds.indexOf(curChannelId);\n\n    for (let i = 1; i < allChannelIds.length; i++) {\n        const index = Utils.mod(curIndex + (i * direction), allChannelIds.length);\n\n        if (unreadChannelIds.includes(allChannelIds[index])) {\n            return index;\n        }\n    }\n\n    return -1;\n}\n\nexport function isArchivedChannel(channel) {\n    return Boolean(channel && channel.delete_at !== 0);\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {injectIntl} from 'react-intl';\n\nimport {Posts} from 'mattermost-redux/constants';\n\nimport {t} from 'utils/i18n';\nimport {intlShape} from 'utils/react_intl';\n\nimport Markdown from 'components/markdown';\n\nconst typeMessage = {\n    [Posts.POST_TYPES.ADD_TO_CHANNEL]: {\n        id: t('last_users_message.added_to_channel.type'),\n        defaultMessage: 'were **added to the channel** by {actor}.',\n    },\n    [Posts.POST_TYPES.JOIN_CHANNEL]: {\n        id: t('last_users_message.joined_channel.type'),\n        defaultMessage: '**joined the channel**.',\n    },\n    [Posts.POST_TYPES.LEAVE_CHANNEL]: {\n        id: t('last_users_message.left_channel.type'),\n        defaultMessage: '**left the channel**.',\n    },\n    [Posts.POST_TYPES.REMOVE_FROM_CHANNEL]: {\n        id: t('last_users_message.removed_from_channel.type'),\n        defaultMessage: 'were **removed from the channel**.',\n    },\n    [Posts.POST_TYPES.ADD_TO_TEAM]: {\n        id: t('last_users_message.added_to_team.type'),\n        defaultMessage: 'were **added to the team** by {actor}.',\n    },\n    [Posts.POST_TYPES.JOIN_TEAM]: {\n        id: t('last_users_message.joined_team.type'),\n        defaultMessage: '**joined the team**.',\n    },\n    [Posts.POST_TYPES.LEAVE_TEAM]: {\n        id: t('last_users_message.left_team.type'),\n        defaultMessage: '**left the team**.',\n    },\n    [Posts.POST_TYPES.REMOVE_FROM_TEAM]: {\n        id: t('last_users_message.removed_from_team.type'),\n        defaultMessage: 'were **removed from the team**.',\n    },\n};\n\nclass LastUsers extends React.PureComponent {\n    static propTypes = {\n        actor: PropTypes.string,\n        expandedLocale: PropTypes.object.isRequired,\n        formatOptions: PropTypes.object.isRequired,\n        intl: intlShape.isRequired,\n        postType: PropTypes.string.isRequired,\n        usernames: PropTypes.array.isRequired,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            expand: false,\n        };\n    }\n\n    handleOnClick = (e) => {\n        e.preventDefault();\n\n        this.setState({expand: true});\n    }\n\n    renderMessage = (formattedMessage) => {\n        return (\n            <Markdown\n                message={formattedMessage}\n                options={this.props.formatOptions}\n            />\n        );\n    }\n\n    render() {\n        const {formatMessage} = this.props.intl;\n        const {expand} = this.state;\n        const {\n            actor,\n            expandedLocale,\n            postType,\n            usernames,\n        } = this.props;\n\n        const firstUser = usernames[0];\n        const lastIndex = usernames.length - 1;\n        const lastUser = usernames[lastIndex];\n\n        if (expand) {\n            const formattedMessage = formatMessage(expandedLocale, {\n                users: usernames.slice(0, lastIndex).join(', '),\n                lastUser,\n                actor,\n            });\n\n            return this.renderMessage(formattedMessage);\n        }\n\n        const firstUserMessage = formatMessage(\n            {id: 'last_users_message.first', defaultMessage: '{firstUser} and '},\n            {firstUser}\n        );\n\n        const otherUsersMessage = formatMessage(\n            {id: 'last_users_message.others', defaultMessage: '{numOthers} others '},\n            {numOthers: lastIndex}\n        );\n\n        const actorMessage = formatMessage(\n            {id: typeMessage[postType].id, defaultMessage: typeMessage[postType].defaultMessage},\n            {actor}\n        );\n\n        return (\n            <span>\n                {this.renderMessage(firstUserMessage)}\n                <a onClick={this.handleOnClick}>\n                    {otherUsersMessage}\n                </a>\n                {this.renderMessage(actorMessage)}\n            </span>\n        );\n    }\n}\n\nexport default injectIntl(LastUsers);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {injectIntl} from 'react-intl';\n\nimport {Posts} from 'mattermost-redux/constants';\n\nimport {t} from 'utils/i18n';\nimport {intlShape} from 'utils/react_intl';\n\nimport Markdown from 'components/markdown';\n\nimport LastUsers from './last_users';\n\nconst {\n    JOIN_CHANNEL, ADD_TO_CHANNEL, REMOVE_FROM_CHANNEL, LEAVE_CHANNEL,\n    JOIN_TEAM, ADD_TO_TEAM, REMOVE_FROM_TEAM, LEAVE_TEAM,\n} = Posts.POST_TYPES;\n\nconst postTypeMessage = {\n    [JOIN_CHANNEL]: {\n        one: {\n            id: t('combined_system_message.joined_channel.one'),\n            defaultMessage: '{firstUser} **joined the channel**.',\n        },\n        one_you: {\n            id: t('combined_system_message.joined_channel.one_you'),\n            defaultMessage: 'You **joined the channel**.',\n        },\n        two: {\n            id: t('combined_system_message.joined_channel.two'),\n            defaultMessage: '{firstUser} and {secondUser} **joined the channel**.',\n        },\n        many_expanded: {\n            id: t('combined_system_message.joined_channel.many_expanded'),\n            defaultMessage: '{users} and {lastUser} **joined the channel**.',\n        },\n    },\n    [ADD_TO_CHANNEL]: {\n        one: {\n            id: t('combined_system_message.added_to_channel.one'),\n            defaultMessage: '{firstUser} **added to the channel** by {actor}.',\n        },\n        one_you: {\n            id: t('combined_system_message.added_to_channel.one_you'),\n            defaultMessage: 'You were **added to the channel** by {actor}.',\n        },\n        two: {\n            id: t('combined_system_message.added_to_channel.two'),\n            defaultMessage: '{firstUser} and {secondUser} **added to the channel** by {actor}.',\n        },\n        many_expanded: {\n            id: t('combined_system_message.added_to_channel.many_expanded'),\n            defaultMessage: '{users} and {lastUser} were **added to the channel** by {actor}.',\n        },\n    },\n    [REMOVE_FROM_CHANNEL]: {\n        one: {\n            id: t('combined_system_message.removed_from_channel.one'),\n            defaultMessage: '{firstUser} was **removed from the channel**.',\n        },\n        one_you: {\n            id: t('combined_system_message.removed_from_channel.one_you'),\n            defaultMessage: 'You were **removed from the channel**.',\n        },\n        two: {\n            id: t('combined_system_message.removed_from_channel.two'),\n            defaultMessage: '{firstUser} and {secondUser} were **removed from the channel**.',\n        },\n        many_expanded: {\n            id: t('combined_system_message.removed_from_channel.many_expanded'),\n            defaultMessage: '{users} and {lastUser} were **removed from the channel**.',\n        },\n    },\n    [LEAVE_CHANNEL]: {\n        one: {\n            id: t('combined_system_message.left_channel.one'),\n            defaultMessage: '{firstUser} **left the channel**.',\n        },\n        one_you: {\n            id: t('combined_system_message.left_channel.one_you'),\n            defaultMessage: 'You **left the channel**.',\n        },\n        two: {\n            id: t('combined_system_message.left_channel.two'),\n            defaultMessage: '{firstUser} and {secondUser} **left the channel**.',\n        },\n        many_expanded: {\n            id: t('combined_system_message.left_channel.many_expanded'),\n            defaultMessage: '{users} and {lastUser} **left the channel**.',\n        },\n    },\n    [JOIN_TEAM]: {\n        one: {\n            id: t('combined_system_message.joined_team.one'),\n            defaultMessage: '{firstUser} **joined the team**.',\n        },\n        one_you: {\n            id: t('combined_system_message.joined_team.one_you'),\n            defaultMessage: 'You **joined the team**.',\n        },\n        two: {\n            id: t('combined_system_message.joined_team.two'),\n            defaultMessage: '{firstUser} and {secondUser} **joined the team**.',\n        },\n        many_expanded: {\n            id: t('combined_system_message.joined_team.many_expanded'),\n            defaultMessage: '{users} and {lastUser} **joined the team**.',\n        },\n    },\n    [ADD_TO_TEAM]: {\n        one: {\n            id: t('combined_system_message.added_to_team.one'),\n            defaultMessage: '{firstUser} **added to the team** by {actor}.',\n        },\n        one_you: {\n            id: t('combined_system_message.added_to_team.one_you'),\n            defaultMessage: 'You were **added to the team** by {actor}.',\n        },\n        two: {\n            id: t('combined_system_message.added_to_team.two'),\n            defaultMessage: '{firstUser} and {secondUser} **added to the team** by {actor}.',\n        },\n        many_expanded: {\n            id: t('combined_system_message.added_to_team.many_expanded'),\n            defaultMessage: '{users} and {lastUser} were **added to the team** by {actor}.',\n        },\n    },\n    [REMOVE_FROM_TEAM]: {\n        one: {\n            id: t('combined_system_message.removed_from_team.one'),\n            defaultMessage: '{firstUser} was **removed from the team**.',\n        },\n        one_you: {\n            id: t('combined_system_message.removed_from_team.one_you'),\n            defaultMessage: 'You were **removed from the team**.',\n        },\n        two: {\n            id: t('combined_system_message.removed_from_team.two'),\n            defaultMessage: '{firstUser} and {secondUser} were **removed from the team**.',\n        },\n        many_expanded: {\n            id: t('combined_system_message.removed_from_team.many_expanded'),\n            defaultMessage: '{users} and {lastUser} were **removed from the team**.',\n        },\n    },\n    [LEAVE_TEAM]: {\n        one: {\n            id: t('combined_system_message.left_team.one'),\n            defaultMessage: '{firstUser} **left the team**.',\n        },\n        one_you: {\n            id: t('combined_system_message.left_team.one_you'),\n            defaultMessage: 'You **left the team**.',\n        },\n        two: {\n            id: t('combined_system_message.left_team.two'),\n            defaultMessage: '{firstUser} and {secondUser} **left the team**.',\n        },\n        many_expanded: {\n            id: t('combined_system_message.left_team.many_expanded'),\n            defaultMessage: '{users} and {lastUser} **left the team**.',\n        },\n    },\n};\n\nclass CombinedSystemMessage extends React.PureComponent {\n    static propTypes = {\n        allUserIds: PropTypes.array.isRequired,\n        allUsernames: PropTypes.array.isRequired,\n        currentUserId: PropTypes.string.isRequired,\n        currentUsername: PropTypes.string.isRequired,\n        intl: intlShape.isRequired,\n        messageData: PropTypes.array.isRequired,\n        showJoinLeave: PropTypes.bool.isRequired,\n        userProfiles: PropTypes.array.isRequired,\n        actions: PropTypes.shape({\n            getMissingProfilesByIds: PropTypes.func.isRequired,\n            getMissingProfilesByUsernames: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    static defaultProps = {\n        allUserIds: [],\n        allUsernames: [],\n    };\n\n    componentDidMount() {\n        this.loadUserProfiles(this.props.allUserIds, this.props.allUsernames);\n    }\n\n    componentDidUpdate(prevProps) {\n        const {allUserIds, allUsernames} = this.props;\n        if (allUserIds !== prevProps.allUserIds || allUsernames !== prevProps.allUsernames) {\n            this.loadUserProfiles(allUserIds, allUsernames);\n        }\n    }\n\n    loadUserProfiles = (allUserIds, allUsernames) => {\n        if (allUserIds.length > 0) {\n            this.props.actions.getMissingProfilesByIds(allUserIds);\n        }\n\n        if (allUsernames.length > 0) {\n            this.props.actions.getMissingProfilesByUsernames(allUsernames);\n        }\n    }\n\n    getAllUsernames = () => {\n        const {\n            allUserIds,\n            allUsernames,\n            currentUserId,\n            currentUsername,\n            userProfiles,\n        } = this.props;\n        const {formatMessage} = this.props.intl;\n        const usernames = userProfiles.reduce((acc, user) => {\n            acc[user.id] = user.username;\n            acc[user.username] = user.username;\n            return acc;\n        }, {});\n\n        const currentUserDisplayName = formatMessage({id: t('combined_system_message.you'), defaultMessage: 'You'});\n        if (allUserIds.includes(currentUserId)) {\n            usernames[currentUserId] = currentUserDisplayName;\n        } else if (allUsernames.includes(currentUsername)) {\n            usernames[currentUsername] = currentUserDisplayName;\n        }\n\n        return usernames;\n    }\n\n    getUsernamesByIds = (userIds = []) => {\n        const {currentUserId, currentUsername} = this.props;\n        const allUsernames = this.getAllUsernames();\n\n        const {formatMessage} = this.props.intl;\n        const someone = formatMessage({id: t('channel_loader.someone'), defaultMessage: 'Someone'});\n\n        const usernames = userIds.\n            filter((userId) => {\n                return userId !== currentUserId && userId !== currentUsername;\n            }).\n            map((userId) => {\n                return allUsernames[userId] ? `@${allUsernames[userId]}` : someone;\n            }).filter((username) => {\n                return username && username !== '';\n            });\n\n        if (userIds.includes(currentUserId)) {\n            usernames.unshift(allUsernames[currentUserId]);\n        } else if (userIds.includes(currentUsername)) {\n            usernames.unshift(allUsernames[currentUsername]);\n        }\n\n        return usernames;\n    }\n\n    renderFormattedMessage(postType, userIds, actorId) {\n        const {formatMessage} = this.props.intl;\n        const {currentUserId, currentUsername} = this.props;\n        const usernames = this.getUsernamesByIds(userIds);\n        let actor = actorId ? this.getUsernamesByIds([actorId])[0] : '';\n        if (actor && (actorId === currentUserId || actorId === currentUsername)) {\n            actor = actor.toLowerCase();\n        }\n\n        const firstUser = usernames[0];\n        const secondUser = usernames[1];\n        const numOthers = usernames.length - 1;\n\n        const options = {\n            atMentions: true,\n            mentionKeys: [{key: firstUser}, {key: secondUser}, {key: actor}],\n            mentionHighlight: false,\n            singleline: true,\n        };\n\n        if (numOthers > 1) {\n            return (\n                <LastUsers\n                    actor={actor}\n                    expandedLocale={postTypeMessage[postType].many_expanded}\n                    formatOptions={options}\n                    postType={postType}\n                    usernames={usernames}\n                />\n            );\n        }\n\n        let localeHolder;\n        if (numOthers === 0) {\n            localeHolder = postTypeMessage[postType].one;\n\n            if (\n                (userIds[0] === this.props.currentUserId || userIds[0] === this.props.currentUsername) &&\n                postTypeMessage[postType].one_you\n            ) {\n                localeHolder = postTypeMessage[postType].one_you;\n            }\n        } else if (numOthers === 1) {\n            localeHolder = postTypeMessage[postType].two;\n        }\n\n        const formattedMessage = formatMessage(localeHolder, {firstUser, secondUser, actor});\n\n        return (\n            <Markdown\n                message={formattedMessage}\n                options={options}\n            />\n        );\n    }\n\n    renderMessage(postType, userIds, actorId) {\n        return (\n            <React.Fragment key={postType + actorId}>\n                {this.renderFormattedMessage(postType, userIds, actorId)}\n                <br/>\n            </React.Fragment>\n        );\n    }\n\n    render() {\n        const {\n            currentUserId,\n            messageData,\n        } = this.props;\n\n        const content = [];\n        const removedUserIds = [];\n        for (const message of messageData) {\n            const {\n                postType,\n                actorId,\n            } = message;\n            let userIds = message.userIds;\n\n            if (!this.props.showJoinLeave && actorId !== currentUserId) {\n                const affectsCurrentUser = userIds.indexOf(currentUserId) !== -1;\n\n                if (affectsCurrentUser) {\n                    // Only show the message that the current user was added, etc\n                    userIds = [currentUserId];\n                } else {\n                    // Not something the current user did or was affected by\n                    continue;\n                }\n            }\n\n            if (postType === REMOVE_FROM_CHANNEL) {\n                removedUserIds.push(...userIds);\n                continue;\n            }\n\n            content.push(this.renderMessage(postType, userIds, actorId));\n        }\n\n        if (removedUserIds.length > 0) {\n            const uniqueRemovedUserIds = removedUserIds.filter((id, index, arr) => arr.indexOf(id) === index);\n            content.push(this.renderMessage(REMOVE_FROM_CHANNEL, uniqueRemovedUserIds, currentUserId));\n        }\n\n        return (\n            <React.Fragment>\n                {content}\n            </React.Fragment>\n        );\n    }\n}\n\nexport default injectIntl(CombinedSystemMessage);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getMissingProfilesByIds, getMissingProfilesByUsernames} from 'mattermost-redux/actions/users';\nimport {Preferences} from 'mattermost-redux/constants';\nimport {getBool} from 'mattermost-redux/selectors/entities/preferences';\nimport {getCurrentUser, makeGetProfilesByIdsAndUsernames} from 'mattermost-redux/selectors/entities/users';\n\nimport CombinedSystemMessage from './combined_system_message.jsx';\n\nfunction makeMapStateToProps() {\n    const getProfilesByIdsAndUsernames = makeGetProfilesByIdsAndUsernames();\n\n    return (state, ownProps) => {\n        const currentUser = getCurrentUser(state);\n        const {allUserIds, allUsernames} = ownProps;\n\n        return {\n            currentUserId: currentUser.id,\n            currentUsername: currentUser.username,\n            showJoinLeave: getBool(state, Preferences.CATEGORY_ADVANCED_SETTINGS, Preferences.ADVANCED_FILTER_JOIN_LEAVE, true),\n            userProfiles: getProfilesByIdsAndUsernames(state, {allUserIds, allUsernames}),\n        };\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            getMissingProfilesByIds,\n            getMissingProfilesByUsernames,\n        }, dispatch),\n    };\n}\n\nexport default connect(makeMapStateToProps, mapDispatchToProps)(CombinedSystemMessage);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {sendAddToChannelEphemeralPost} from 'actions/global_actions.jsx';\nimport {Constants} from 'utils/constants';\nimport {t} from 'utils/i18n';\nimport AtMention from 'components/at_mention';\n\nexport default class PostAddChannelMember extends React.PureComponent {\n    static propTypes = {\n\n        /*\n        * Current user\n        */\n        currentUser: PropTypes.object.isRequired,\n\n        /*\n        * Type of current channel\n        */\n        channelType: PropTypes.string.isRequired,\n\n        /*\n        * ID of ephemeral post (at-mention's \"add to channel\" post)\n        */\n        postId: PropTypes.string.isRequired,\n\n        /*\n        * Ephemeral post (at-mention's \"add to channel\" post)\n        */\n        post: PropTypes.object.isRequired,\n\n        /*\n        * user ids to add to channel\n        */\n        userIds: PropTypes.array.isRequired,\n\n        /*\n        * usernames to add to channel\n        */\n        usernames: PropTypes.array.isRequired,\n\n        noGroupsUsernames: PropTypes.array.isRequired,\n\n        actions: PropTypes.shape({\n\n            /*\n            * Function to add members to channel\n            */\n            addChannelMember: PropTypes.func.isRequired,\n\n            /*\n            * Function to remove post (ephemeral)\n            */\n            removePost: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    handleAddChannelMember = () => {\n        const {currentUser, post, userIds, usernames} = this.props;\n\n        if (post && post.channel_id) {\n            let createAt = post.create_at;\n            userIds.forEach((userId, index) => {\n                createAt++;\n                this.props.actions.addChannelMember(post.channel_id, userId);\n                sendAddToChannelEphemeralPost(currentUser, usernames[index], userId, post.channel_id, post.root_id, createAt);\n            });\n\n            this.props.actions.removePost(post);\n        }\n    }\n\n    generateAtMentions(usernames = []) {\n        if (usernames.length === 1) {\n            return (\n                <AtMention mentionName={usernames[0]}/>\n            );\n        } else if (usernames.length > 1) {\n            function andSeparator(key) {\n                return (\n                    <FormattedMessage\n                        key={key}\n                        id={'post_body.check_for_out_of_channel_mentions.link.and'}\n                        defaultMessage={' and '}\n                    />\n                );\n            }\n\n            function commaSeparator(key) {\n                return <span key={key}>{', '}</span>;\n            }\n\n            return (\n                <span>\n                    {\n                        usernames.map((username) => {\n                            return (\n                                <AtMention\n                                    key={username}\n                                    mentionName={username}\n                                />\n                            );\n                        }).reduce((acc, el, idx, arr) => {\n                            if (idx === 0) {\n                                return [el];\n                            } else if (idx === arr.length - 1) {\n                                return [...acc, andSeparator(idx), el];\n                            }\n\n                            return [...acc, commaSeparator(idx), el];\n                        }, [])\n                    }\n                </span>\n            );\n        }\n\n        return '';\n    }\n\n    render() {\n        const {channelType, postId, usernames, noGroupsUsernames} = this.props;\n        if (!postId || !channelType) {\n            return null;\n        }\n\n        let linkId;\n        let linkText;\n        if (channelType === Constants.PRIVATE_CHANNEL) {\n            linkId = t('post_body.check_for_out_of_channel_mentions.link.private');\n            linkText = 'add them to this private channel';\n        } else if (channelType === Constants.OPEN_CHANNEL) {\n            linkId = t('post_body.check_for_out_of_channel_mentions.link.public');\n            linkText = 'add them to the channel';\n        }\n\n        let outOfChannelMessageID;\n        let outOfChannelMessageText;\n        const outOfChannelAtMentions = this.generateAtMentions(usernames);\n        if (usernames.length === 1) {\n            outOfChannelMessageID = t('post_body.check_for_out_of_channel_mentions.message.one');\n            outOfChannelMessageText = 'did not get notified by this mention because they are not in the channel. Would you like to ';\n        } else if (usernames.length > 1) {\n            outOfChannelMessageID = t('post_body.check_for_out_of_channel_mentions.message.multiple');\n            outOfChannelMessageText = 'did not get notified by this mention because they are not in the channel. Would you like to ';\n        }\n\n        let outOfGroupsMessageID;\n        let outOfGroupsMessageText;\n        const outOfGroupsAtMentions = this.generateAtMentions(noGroupsUsernames);\n        if (noGroupsUsernames.length) {\n            outOfGroupsMessageID = t('post_body.check_for_out_of_channel_groups_mentions.message');\n            outOfGroupsMessageText = 'did not get notified by this mention because they are not in the channel. They cannot be added to the channel because they are not a member of the linked groups. To add them to this channel, they must be added to the linked groups.';\n        }\n\n        var outOfChannelMessage = null;\n        var outOfGroupsMessage = null;\n\n        if (usernames.length) {\n            outOfChannelMessage = (\n                <p>\n                    {outOfChannelAtMentions}\n                    {' '}\n                    <FormattedMessage\n                        id={outOfChannelMessageID}\n                        defaultMessage={outOfChannelMessageText}\n                    />\n                    <a\n                        id='add_channel_member_link'\n                        onClick={this.handleAddChannelMember}\n                    >\n                        <FormattedMessage\n                            id={linkId}\n                            defaultMessage={linkText}\n                        />\n                    </a>\n                    <FormattedMessage\n                        id={'post_body.check_for_out_of_channel_mentions.message_last'}\n                        defaultMessage={'? They will have access to all message history.'}\n                    />\n                </p>\n            );\n        }\n\n        if (noGroupsUsernames.length) {\n            outOfGroupsMessage = (\n                <p>\n                    {outOfGroupsAtMentions}\n                    {' '}\n                    <FormattedMessage\n                        id={outOfGroupsMessageID}\n                        defaultMessage={outOfGroupsMessageText}\n                    />\n                </p>\n            );\n        }\n\n        return (\n            <>\n                {outOfChannelMessage}\n                {outOfGroupsMessage}\n            </>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {addChannelMember} from 'mattermost-redux/actions/channels';\nimport {removePost} from 'mattermost-redux/actions/posts';\nimport {getPost} from 'mattermost-redux/selectors/entities/posts';\nimport {getChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\n\nimport PostAddChannelMember from './post_add_channel_member.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    const post = getPost(state, ownProps.postId) || {};\n    let channelType = '';\n    if (post && post.channel_id) {\n        const channel = getChannel(state, post.channel_id);\n        if (channel && channel.type) {\n            channelType = channel.type;\n        }\n    }\n\n    return {\n        channelType,\n        currentUser: getCurrentUser(state),\n        post,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            addChannelMember,\n            removePost,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PostAddChannelMember);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {General, Posts} from 'mattermost-redux/constants';\n\nimport * as Utils from 'utils/utils.jsx';\n\nimport Markdown from 'components/markdown';\nimport CombinedSystemMessage from 'components/post_view/combined_system_message';\nimport PostAddChannelMember from 'components/post_view/post_add_channel_member';\n\nfunction renderUsername(value) {\n    const username = (value[0] === '@') ? value : `@${value}`;\n\n    const options = {\n        markdown: false,\n    };\n\n    return renderFormattedText(username, options);\n}\n\nfunction renderFormattedText(value, options, post) {\n    return (\n        <Markdown\n            message={value}\n            options={options}\n            postId={post && post.id}\n            postType={post && post.type}\n        />\n    );\n}\n\nfunction renderJoinChannelMessage(post) {\n    const username = renderUsername(post.props.username);\n\n    return (\n        <FormattedMessage\n            id='api.channel.join_channel.post_and_forget'\n            defaultMessage='{username} joined the channel.'\n            values={{username}}\n        />\n    );\n}\n\nfunction renderGuestJoinChannelMessage(post) {\n    const username = renderUsername(post.props.username);\n\n    return (\n        <FormattedMessage\n            id='api.channel.guest_join_channel.post_and_forget'\n            defaultMessage='{username} joined the channel as a guest.'\n            values={{username}}\n        />\n    );\n}\n\nfunction renderLeaveChannelMessage(post) {\n    const username = renderUsername(post.props.username);\n\n    return (\n        <FormattedMessage\n            id='api.channel.leave.left'\n            defaultMessage='{username} has left the channel.'\n            values={{username}}\n        />\n    );\n}\n\nfunction renderAddToChannelMessage(post) {\n    const username = renderUsername(post.props.username);\n    const addedUsername = renderUsername(post.props.addedUsername);\n\n    return (\n        <FormattedMessage\n            id='api.channel.add_member.added'\n            defaultMessage='{addedUsername} added to the channel by {username}.'\n            values={{\n                username,\n                addedUsername,\n            }}\n        />\n    );\n}\n\nfunction renderAddGuestToChannelMessage(post) {\n    const username = renderUsername(post.props.username);\n    const addedUsername = renderUsername(post.props.addedUsername);\n\n    return (\n        <FormattedMessage\n            id='api.channel.add_guest.added'\n            defaultMessage='{addedUsername} added to the channel as a guest by {username}.'\n            values={{\n                username,\n                addedUsername,\n            }}\n        />\n    );\n}\n\nfunction renderRemoveFromChannelMessage(post) {\n    const removedUsername = renderUsername(post.props.removedUsername);\n\n    return (\n        <FormattedMessage\n            id='api.channel.remove_member.removed'\n            defaultMessage='{removedUsername} was removed from the channel'\n            values={{\n                removedUsername,\n            }}\n        />\n    );\n}\n\nfunction renderJoinTeamMessage(post) {\n    const username = renderUsername(post.props.username);\n\n    return (\n        <FormattedMessage\n            id='api.team.join_team.post_and_forget'\n            defaultMessage='{username} joined the team.'\n            values={{username}}\n        />\n    );\n}\n\nfunction renderLeaveTeamMessage(post) {\n    const username = renderUsername(post.props.username);\n\n    return (\n        <FormattedMessage\n            id='api.team.leave.left'\n            defaultMessage='{username} left the team.'\n            values={{username}}\n        />\n    );\n}\n\nfunction renderAddToTeamMessage(post) {\n    const username = renderUsername(post.props.username);\n    const addedUsername = renderUsername(post.props.addedUsername);\n\n    return (\n        <FormattedMessage\n            id='api.team.add_member.added'\n            defaultMessage='{addedUsername} added to the team by {username}.'\n            values={{\n                username,\n                addedUsername,\n            }}\n        />\n    );\n}\n\nfunction renderRemoveFromTeamMessage(post) {\n    const removedUsername = renderUsername(post.props.username);\n\n    return (\n        <FormattedMessage\n            id='api.team.remove_user_from_team.removed'\n            defaultMessage='{removedUsername} was removed from the team.'\n            values={{\n                removedUsername,\n            }}\n        />\n    );\n}\n\nfunction renderHeaderChangeMessage(post) {\n    if (!post.props.username) {\n        return null;\n    }\n\n    const headerOptions = {\n        singleline: true,\n        channelNamesMap: post.props && post.props.channel_mentions,\n        mentionHighlight: false,\n    };\n\n    const username = renderUsername(post.props.username);\n    const oldHeader = post.props.old_header ? renderFormattedText(post.props.old_header, headerOptions, post) : null;\n    const newHeader = post.props.new_header ? renderFormattedText(post.props.new_header, headerOptions, post) : null;\n\n    if (post.props.new_header) {\n        if (post.props.old_header) {\n            return (\n                <FormattedMessage\n                    id='api.channel.post_update_channel_header_message_and_forget.updated_from'\n                    defaultMessage='{username} updated the channel header from: {old} to: {new}'\n                    values={{\n                        username,\n                        old: oldHeader,\n                        new: newHeader,\n                    }}\n                />\n            );\n        }\n\n        return (\n            <FormattedMessage\n                id='api.channel.post_update_channel_header_message_and_forget.updated_to'\n                defaultMessage='{username} updated the channel header to: {new}'\n                values={{\n                    username,\n                    new: newHeader,\n                }}\n            />\n        );\n    } else if (post.props.old_header) {\n        return (\n            <FormattedMessage\n                id='api.channel.post_update_channel_header_message_and_forget.removed'\n                defaultMessage='{username} removed the channel header (was: {old})'\n                values={{\n                    username,\n                    old: oldHeader,\n                }}\n            />\n        );\n    }\n\n    return null;\n}\n\nfunction renderDisplayNameChangeMessage(post) {\n    if (!(post.props.username && post.props.old_displayname && post.props.new_displayname)) {\n        return null;\n    }\n\n    const username = renderUsername(post.props.username);\n    const oldDisplayName = post.props.old_displayname;\n    const newDisplayName = post.props.new_displayname;\n\n    return (\n        <FormattedMessage\n            id='api.channel.post_update_channel_displayname_message_and_forget.updated_from'\n            defaultMessage='{username} updated the channel display name from: {old} to: {new}'\n            values={{\n                username,\n                old: oldDisplayName,\n                new: newDisplayName,\n            }}\n        />\n    );\n}\n\nfunction renderConvertChannelToPrivateMessage(post) {\n    if (!(post.props.username)) {\n        return null;\n    }\n\n    const username = renderUsername(post.props.username);\n\n    return (\n        <FormattedMessage\n            id='api.channel.post_convert_channel_to_private.updated_from'\n            defaultMessage='{username} converted the channel from public to private'\n            values={{\n                username,\n            }}\n        />\n    );\n}\n\nfunction renderPurposeChangeMessage(post) {\n    if (!post.props.username) {\n        return null;\n    }\n\n    const username = renderUsername(post.props.username);\n    const oldPurpose = post.props.old_purpose;\n    const newPurpose = post.props.new_purpose;\n\n    if (post.props.new_purpose) {\n        if (post.props.old_purpose) {\n            return (\n                <FormattedMessage\n                    id='app.channel.post_update_channel_purpose_message.updated_from'\n                    defaultMessage='{username} updated the channel purpose from: {old} to: {new}'\n                    values={{\n                        username,\n                        old: oldPurpose,\n                        new: newPurpose,\n                    }}\n                />\n            );\n        }\n\n        return (\n            <FormattedMessage\n                id='app.channel.post_update_channel_purpose_message.updated_to'\n                defaultMessage='{username} updated the channel purpose to: {new}'\n                values={{\n                    username,\n                    new: newPurpose,\n                }}\n            />\n        );\n    } else if (post.props.old_purpose) {\n        return (\n            <FormattedMessage\n                id='app.channel.post_update_channel_purpose_message.removed'\n                defaultMessage='{username} removed the channel purpose (was: {old})'\n                values={{\n                    username,\n                    old: oldPurpose,\n                }}\n            />\n        );\n    }\n\n    return null;\n}\n\nfunction renderChannelDeletedMessage(post) {\n    if (!post.props.username) {\n        return null;\n    }\n\n    const username = renderUsername(post.props.username);\n\n    return (\n        <FormattedMessage\n            id='api.channel.delete_channel.archived'\n            defaultMessage='{username} has archived the channel.'\n            values={{username}}\n        />\n    );\n}\n\nfunction renderChannelUnarchivedMessage(post) {\n    if (!post.props.username) {\n        return null;\n    }\n\n    const username = renderUsername(post.props.username);\n\n    return (\n        <FormattedMessage\n            id='api.channel.restore_channel.unarchived'\n            defaultMessage='{username} has unarchived the channel.'\n            values={{username}}\n        />\n    );\n}\n\nfunction renderMeMessage(post) {\n    return renderFormattedText((post.props && post.props.message) ? post.props.message : post.message);\n}\n\nconst systemMessageRenderers = {\n    [Posts.POST_TYPES.JOIN_CHANNEL]: renderJoinChannelMessage,\n    [Posts.POST_TYPES.GUEST_JOIN_CHANNEL]: renderGuestJoinChannelMessage,\n    [Posts.POST_TYPES.LEAVE_CHANNEL]: renderLeaveChannelMessage,\n    [Posts.POST_TYPES.ADD_TO_CHANNEL]: renderAddToChannelMessage,\n    [Posts.POST_TYPES.ADD_GUEST_TO_CHANNEL]: renderAddGuestToChannelMessage,\n    [Posts.POST_TYPES.REMOVE_FROM_CHANNEL]: renderRemoveFromChannelMessage,\n    [Posts.POST_TYPES.JOIN_TEAM]: renderJoinTeamMessage,\n    [Posts.POST_TYPES.LEAVE_TEAM]: renderLeaveTeamMessage,\n    [Posts.POST_TYPES.ADD_TO_TEAM]: renderAddToTeamMessage,\n    [Posts.POST_TYPES.REMOVE_FROM_TEAM]: renderRemoveFromTeamMessage,\n    [Posts.POST_TYPES.HEADER_CHANGE]: renderHeaderChangeMessage,\n    [Posts.POST_TYPES.DISPLAYNAME_CHANGE]: renderDisplayNameChangeMessage,\n    [Posts.POST_TYPES.CONVERT_CHANNEL]: renderConvertChannelToPrivateMessage,\n    [Posts.POST_TYPES.PURPOSE_CHANGE]: renderPurposeChangeMessage,\n    [Posts.POST_TYPES.CHANNEL_DELETED]: renderChannelDeletedMessage,\n    [Posts.POST_TYPES.CHANNEL_UNARCHIVED]: renderChannelUnarchivedMessage,\n    [Posts.POST_TYPES.ME]: renderMeMessage,\n};\n\nexport function renderSystemMessage(post, channel, isUserCanManageMembers) {\n    if (post.props && post.props.add_channel_member) {\n        const isEphemeral = Utils.isPostEphemeral(post);\n\n        if ((channel.type === General.PRIVATE_CHANNEL || channel.type === General.OPEN_CHANNEL) &&\n            isUserCanManageMembers &&\n            isEphemeral\n        ) {\n            const addMemberProps = post.props.add_channel_member;\n            return (\n                <PostAddChannelMember\n                    postId={addMemberProps.post_id}\n                    userIds={addMemberProps.not_in_channel_user_ids}\n                    noGroupsUsernames={addMemberProps.not_in_groups_usernames}\n                    usernames={addMemberProps.not_in_channel_usernames}\n                />\n            );\n        }\n\n        return null;\n    } else if (systemMessageRenderers[post.type]) {\n        return systemMessageRenderers[post.type](post);\n    } else if (post.type === Posts.POST_TYPES.EPHEMERAL_ADD_TO_CHANNEL) {\n        return renderAddToChannelMessage(post);\n    } else if (post.type === Posts.POST_TYPES.COMBINED_USER_ACTIVITY) {\n        const {allUserIds, allUsernames, messageData} = post.props.user_activity;\n\n        return (\n            <CombinedSystemMessage\n                allUserIds={allUserIds}\n                allUsernames={allUsernames}\n                messageData={messageData}\n            />\n        );\n    }\n\n    return null;\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport Markdown from 'components/markdown';\n\nimport {renderSystemMessage} from './system_message_helpers.jsx';\n\nexport default class PostMarkdown extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * Any extra props that should be passed into the image component\n         */\n        imageProps: PropTypes.object,\n\n        /*\n         * Whether or not this text is part of the RHS\n         */\n        isRHS: PropTypes.bool,\n\n        /*\n         * The post text to be rendered\n         */\n        message: PropTypes.string.isRequired,\n\n        /*\n         * The optional post for which this message is being rendered\n         */\n        post: PropTypes.object,\n        channel: PropTypes.object,\n\n        options: PropTypes.object,\n\n        pluginHooks: PropTypes.arrayOf(PropTypes.object),\n\n        /**\n         * Whether or not to place the LinkTooltip component inside links\n         */\n        hasPluginTooltips: PropTypes.bool,\n\n        isUserCanManageMembers: PropTypes.bool,\n    };\n\n    static defaultProps = {\n        isRHS: false,\n        pluginHooks: [],\n        options: {},\n    };\n\n    render() {\n        if (this.props.post) {\n            const renderedSystemMessage = renderSystemMessage(this.props.post, this.props.channel, this.props.isUserCanManageMembers);\n            if (renderedSystemMessage) {\n                return <div>{renderedSystemMessage}</div>;\n            }\n        }\n\n        // Proxy images if we have an image proxy and the server hasn't already rewritten the post's image URLs.\n        const proxyImages = !this.props.post || !this.props.post.message_source || this.props.post.message === this.props.post.message_source;\n        const channelNamesMap = this.props.post && this.props.post.props && this.props.post.props.channel_mentions;\n\n        let {message} = this.props;\n        const {post} = this.props;\n        const options = {...this.props.options};\n\n        this.props.pluginHooks.forEach((o) => {\n            if (o && o.hook && post) {\n                message = o.hook(post, message);\n            }\n        });\n\n        if (post && post.props) {\n            options.mentionHighlight = !post.props.mentionHighlightDisabled;\n        }\n\n        return (\n            <Markdown\n                imageProps={this.props.imageProps}\n                isRHS={this.props.isRHS}\n                message={message}\n                proxyImages={proxyImages}\n                options={options}\n                channelNamesMap={channelNamesMap}\n                hasPluginTooltips={this.props.hasPluginTooltips}\n                imagesMetadata={this.props.post && this.props.post.metadata && this.props.post.metadata.images}\n                postId={this.props.post && this.props.post.id}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getChannel} from 'mattermost-redux/selectors/entities/channels';\n\nimport {canManageMembers} from 'utils/channel_utils.jsx';\n\nimport PostMarkdown from './post_markdown';\n\nfunction mapStateToProps(state, ownProps) {\n    const channel = getChannel(state, ownProps.channelId);\n    return {\n        channel,\n        pluginHooks: state.plugins.components.MessageWillFormat,\n        hasPluginTooltips: Boolean(state.plugins.components.LinkTooltip),\n        isUserCanManageMembers: channel && canManageMembers(state, channel),\n    };\n}\n\nexport default connect(mapStateToProps)(PostMarkdown);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport * as Utils from 'utils/utils.jsx';\nimport BotBadge from 'components/widgets/badges/bot_badge';\nimport GuestBadge from 'components/widgets/badges/guest_badge';\nimport Avatar from 'components/widgets/users/avatar';\n\nimport Suggestion from '../suggestion.jsx';\n\nexport default class AtMentionSuggestion extends Suggestion {\n    render() {\n        const isSelection = this.props.isSelection;\n        const user = this.props.item;\n\n        let username;\n        let description;\n        let icon;\n        if (user.username === 'all') {\n            username = 'all';\n            description = (\n                <FormattedMessage\n                    id='suggestion.mention.all'\n                    defaultMessage='Notifies everyone in this channel'\n                />\n            );\n            icon = (\n                <FormattedMessage\n                    id='generic_icons.member'\n                    defaultMessage='Member Icon'\n                >\n                    {(title) => (\n                        <i\n                            className='mention__image fa fa-users fa-2x'\n                            title={title}\n                        />\n                    )}\n                </FormattedMessage>\n            );\n        } else if (user.username === 'channel') {\n            username = 'channel';\n            description = (\n                <FormattedMessage\n                    id='suggestion.mention.channel'\n                    defaultMessage='Notifies everyone in this channel'\n                />\n            );\n            icon = (\n                <FormattedMessage\n                    id='generic_icons.member'\n                    defaultMessage='Member Icon'\n                >\n                    {(title) => (\n                        <i\n                            className='mention__image fa fa-users fa-2x'\n                            title={title}\n                        />\n                    )}\n                </FormattedMessage>\n            );\n        } else if (user.username === 'here') {\n            username = 'here';\n            description = (\n                <FormattedMessage\n                    id='suggestion.mention.here'\n                    defaultMessage='Notifies everyone online in this channel'\n                />\n            );\n            icon = (\n                <FormattedMessage\n                    id='generic_icons.member'\n                    defaultMessage='Member Icon'\n                >\n                    {(title) => (\n                        <i\n                            className='mention__image fa fa-users fa-2x'\n                            title={title}\n                        />\n                    )}\n                </FormattedMessage>\n            );\n        } else {\n            username = user.username;\n\n            if ((user.first_name || user.last_name) && user.nickname) {\n                description = `- ${Utils.getFullName(user)} (${user.nickname})`;\n            } else if (user.nickname) {\n                description = `- (${user.nickname})`;\n            } else if (user.first_name || user.last_name) {\n                description = `- ${Utils.getFullName(user)}`;\n            }\n\n            icon = (\n                <Avatar\n                    size='xs'\n                    username={user && user.username}\n                    url={Utils.imageURLForUser(user.id, user.last_picture_update)}\n                />\n            );\n        }\n\n        let youElement = null;\n        if (user.isCurrentUser) {\n            youElement =\n            (<span className='mention__you'>\n                <FormattedMessage\n                    id='suggestion.user.isCurrent'\n                    defaultMessage='(you)'\n                />\n            </span>);\n        }\n\n        let className = 'mentions__name';\n        if (isSelection) {\n            className += ' suggestion--selected';\n        }\n\n        return (\n            <div\n                className={className}\n                data-testid={`mentionSuggestion_${username}`}\n                onClick={this.handleClick}\n                onMouseMove={this.handleMouseMove}\n                {...Suggestion.baseProps}\n            >\n                {icon}\n                <span className='mention--align'>\n                    {'@' + username}\n                </span>\n                <BotBadge\n                    show={Boolean(user.is_bot)}\n                    className='badge-autocomplete'\n                />\n                <span className='mention__fullname'>\n                    {' '}\n                    {description}\n                </span>\n                {youElement}\n                <GuestBadge\n                    show={Utils.isGuest(user)}\n                    className='badge-autocomplete'\n                />\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport XRegExp from 'xregexp';\n\nimport {getSuggestionsSplitBy, getSuggestionsSplitByMultiple} from 'mattermost-redux/utils/user_utils';\n\nimport {Constants} from 'utils/constants';\n\nimport Provider from '../provider.jsx';\n\nimport AtMentionSuggestion from './at_mention_suggestion.jsx';\n\n// The AtMentionProvider provides matches for at mentions, including @here, @channel, @all,\n// users in the channel and users not in the channel. It mixes together results from the local\n// store with results fetch from the server.\nexport default class AtMentionProvider extends Provider {\n    constructor(props) {\n        super();\n\n        this.setProps(props);\n\n        this.data = null;\n    }\n\n    // setProps gives the provider additional context for matching pretexts. Ideally this would\n    // just be something akin to a connected component with access to the store itself.\n    setProps({currentUserId, profilesInChannel, profilesNotInChannel, autocompleteUsersInChannel, useChannelMentions}) {\n        this.currentUserId = currentUserId;\n        this.profilesInChannel = profilesInChannel;\n        this.profilesNotInChannel = profilesNotInChannel;\n        this.autocompleteUsersInChannel = autocompleteUsersInChannel;\n        this.useChannelMentions = useChannelMentions;\n    }\n\n    // specialMentions matches one of @here, @channel or @all, unless using /msg.\n    specialMentions() {\n        if (this.latestPrefix.startsWith('/msg') || !this.useChannelMentions) {\n            return [];\n        }\n\n        return ['here', 'channel', 'all'].filter((item) =>\n            item.startsWith(this.latestPrefix)\n        ).map((name) => ({\n            username: name,\n            type: Constants.MENTION_SPECIAL,\n        }));\n    }\n\n    // retrieves the parts of the profile that should be checked\n    // against the term\n    getProfileSuggestions(profile) {\n        const profileSuggestions = [];\n        if (!profile) {\n            return profileSuggestions;\n        }\n\n        if (profile.username) {\n            const usernameSuggestions = getSuggestionsSplitByMultiple(profile.username.toLowerCase(), Constants.AUTOCOMPLETE_SPLIT_CHARACTERS);\n            profileSuggestions.push(...usernameSuggestions);\n        }\n        [profile.first_name, profile.last_name, profile.nickname].forEach((property) => {\n            const suggestions = getSuggestionsSplitBy(property.toLowerCase(), ' ');\n            profileSuggestions.push(...suggestions);\n        });\n        profileSuggestions.push(profile.first_name.toLowerCase() + ' ' + profile.last_name.toLowerCase());\n\n        return profileSuggestions;\n    }\n\n    // filterProfile constrains profiles to those matching the latest prefix.\n    filterProfile(profile) {\n        if (!profile) {\n            return false;\n        }\n\n        const prefixLower = this.latestPrefix.toLowerCase();\n        const profileSuggestions = this.getProfileSuggestions(profile);\n\n        return profileSuggestions.some((suggestion) => suggestion.startsWith(prefixLower));\n    }\n\n    // localMembers matches up to 25 local results from the store before the server has responded.\n    localMembers() {\n        const localMembers = this.profilesInChannel.\n            filter((profile) => this.filterProfile(profile)).\n            map((profile) => this.createFromProfile(profile, Constants.MENTION_MEMBERS)).\n            sort((a, b) => a.username.localeCompare(b.username)).\n            splice(0, 25);\n\n        return localMembers;\n    }\n\n    // remoteMembers matches the users listed in the channel by the server.\n    remoteMembers() {\n        if (!this.data) {\n            return [];\n        }\n\n        return (this.data.users || []).\n            filter((profile) => this.filterProfile(profile)).\n            map((profile) => this.createFromProfile(profile, Constants.MENTION_MEMBERS));\n    }\n\n    // remoteNonMembers matches users listed as not in the channel by the server.\n    // listed in the channel from local results.\n    remoteNonMembers() {\n        if (!this.data) {\n            return [];\n        }\n\n        return (this.data.out_of_channel || []).\n            filter((profile) => this.filterProfile(profile)).\n            map((profile) => ({\n                type: Constants.MENTION_NONMEMBERS,\n                ...profile,\n            }));\n    }\n\n    users() {\n        const specialMentions = this.specialMentions();\n\n        const localMembers = this.localMembers();\n\n        const localUserIds = {};\n        localMembers.forEach((item) => {\n            localUserIds[item.id] = true;\n        });\n\n        const remoteMembers = this.remoteMembers().filter((item) => !localUserIds[item.id]);\n\n        // comparator which prioritises users with usernames starting with search term\n        const orderUsers = (a, b) => {\n            const aStartsWith = a.username.startsWith(this.latestPrefix);\n            const bStartsWith = b.username.startsWith(this.latestPrefix);\n\n            if (aStartsWith && bStartsWith) {\n                return a.username.localeCompare(b.username);\n            }\n            if (aStartsWith) {\n                return -1;\n            }\n            if (bStartsWith) {\n                return 1;\n            }\n            return a.username.localeCompare(b.username);\n        };\n\n        // Combine the local and remote members, sorting to mix the results together.\n        const localAndRemoteMembers = localMembers.concat(remoteMembers).sort(orderUsers);\n\n        const remoteNonMembers = this.remoteNonMembers().\n            filter((item) => !localUserIds[item.id]).\n            sort(orderUsers);\n\n        return localAndRemoteMembers.concat(specialMentions).concat(remoteNonMembers);\n    }\n\n    // updateMatches invokes the resultCallback with the metadata for rendering at mentions\n    updateMatches(resultCallback, users) {\n        const mentions = users.map((user) => {\n            if (user.username) {\n                return '@' + user.username;\n            }\n            return '';\n        });\n\n        resultCallback({\n            matchedPretext: `@${this.latestPrefix}`,\n            terms: mentions,\n            items: users,\n            component: AtMentionSuggestion,\n        });\n    }\n\n    handlePretextChanged(pretext, resultCallback) {\n        const captured = XRegExp.cache('(?:^|\\\\W)@([\\\\pL\\\\d\\\\-_. ]*)$', 'i').exec(pretext.toLowerCase());\n        if (!captured) {\n            return false;\n        }\n\n        const prefix = captured[1];\n\n        this.startNewRequest(prefix);\n        this.updateMatches(resultCallback, this.users());\n\n        // If we haven't gotten server-side results in 500 ms, add the loading indicator.\n        let showLoadingIndicator = setTimeout(() => {\n            if (this.shouldCancelDispatch(prefix)) {\n                return;\n            }\n\n            this.updateMatches(resultCallback, this.users().concat([{\n                type: Constants.MENTION_MORE_MEMBERS,\n                loading: true,\n            }]));\n\n            showLoadingIndicator = null;\n        }, 500);\n\n        // Query the server for remote results to add to the local results.\n        this.autocompleteUsersInChannel(prefix).then(({data}) => {\n            if (showLoadingIndicator) {\n                clearTimeout(showLoadingIndicator);\n            }\n\n            if (this.shouldCancelDispatch(prefix)) {\n                return;\n            }\n\n            this.data = data;\n            this.updateMatches(resultCallback, this.users());\n        });\n\n        return true;\n    }\n\n    createFromProfile(profile, type) {\n        if (profile.id === this.currentUserId) {\n            return {\n                type,\n                ...profile,\n                isCurrentUser: true,\n            };\n        }\n\n        return {\n            type,\n            ...profile,\n        };\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport AtMentionProvider from './at_mention_provider.jsx';\n\nexport default AtMentionProvider;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {getMyChannels, getMyChannelMemberships} from 'mattermost-redux/selectors/entities/channels';\n\nimport {sortChannelsByTypeAndDisplayName} from 'mattermost-redux/utils/channel_utils';\n\nimport store from 'stores/redux_store.jsx';\n\nimport {Constants} from 'utils/constants';\n\nimport Provider from './provider.jsx';\nimport Suggestion from './suggestion.jsx';\n\nclass ChannelMentionSuggestion extends Suggestion {\n    render() {\n        const isSelection = this.props.isSelection;\n        const item = this.props.item;\n\n        const channelName = item.channel.display_name;\n        const purpose = item.channel.purpose;\n\n        let className = 'mentions__name no-flex';\n        if (isSelection) {\n            className += ' suggestion--selected';\n        }\n\n        const description = '(~' + item.channel.name + ')';\n\n        return (\n            <div\n                className={className}\n                onClick={this.handleClick}\n                onMouseMove={this.handleMouseMove}\n                {...Suggestion.baseProps}\n            >\n                <div className='mention__align'>\n                    <span>\n                        {channelName}\n                    </span>\n                    <span className='mention__channelname'>\n                        {' '}\n                        {description}\n                    </span>\n                </div>\n                <div className='mention__purpose'>\n                    {purpose}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default class ChannelMentionProvider extends Provider {\n    constructor(channelSearchFunc) {\n        super();\n\n        this.lastPrefixTrimmed = '';\n        this.lastPrefixWithNoResults = '';\n        this.lastCompletedWord = '';\n\n        this.autocompleteChannels = channelSearchFunc;\n    }\n\n    handlePretextChanged(pretext, resultCallback) {\n        this.resetRequest();\n\n        const captured = (/\\B(~([^~\\r\\n]*))$/i).exec(pretext.toLowerCase());\n\n        if (!captured) {\n            // Not a channel mention\n            return false;\n        }\n\n        if (captured.index > 0 && pretext[captured.index - 1] === '~') {\n            // Multiple ~'s in a row so let's return and not show the autocomplete\n            return false;\n        }\n\n        const prefix = captured[2];\n\n        if (this.lastPrefixTrimmed && prefix.trim() === this.lastPrefixTrimmed) {\n            // Don't keep searching if the user keeps typing spaces\n            return true;\n        }\n\n        this.lastPrefixTrimmed = prefix.trim();\n\n        if (this.lastPrefixWithNoResults && prefix.startsWith(this.lastPrefixWithNoResults)) {\n            // Just give up since we know it won't return any results\n            return false;\n        }\n\n        if (this.lastCompletedWord && captured[0].startsWith(this.lastCompletedWord)) {\n            // It appears we're still matching a channel handle that we already completed\n            return false;\n        }\n\n        // Clear the last completed word since we've started to match new text\n        this.lastCompletedWord = '';\n\n        this.startNewRequest(prefix);\n\n        const words = prefix.toLowerCase().split(/\\s+/);\n        const wrappedChannelIds = {};\n        var wrappedChannels = [];\n        getMyChannels(store.getState()).forEach((item) => {\n            if (item.type !== 'O' || item.delete_at > 0) {\n                return;\n            }\n            const nameWords = item.name.toLowerCase().split(/\\s+/).concat(item.display_name.toLowerCase().split(/\\s+/));\n            var matched = true;\n            for (var j = 0; matched && j < words.length; j++) {\n                if (!words[j]) {\n                    continue;\n                }\n                var wordMatched = false;\n                for (var i = 0; i < nameWords.length; i++) {\n                    if (nameWords[i].startsWith(words[j])) {\n                        wordMatched = true;\n                        break;\n                    }\n                }\n                if (!wordMatched) {\n                    matched = false;\n                    break;\n                }\n            }\n            if (!matched) {\n                return;\n            }\n            wrappedChannelIds[item.id] = true;\n            wrappedChannels.push({\n                type: Constants.MENTION_CHANNELS,\n                channel: item,\n            });\n        });\n        wrappedChannels = wrappedChannels.sort((a, b) => {\n            //\n            // MM-12677 When this is migrated this needs to be fixed to pull the user's locale\n            //\n            return sortChannelsByTypeAndDisplayName('en', a.channel, b.channel);\n        });\n        const channelMentions = wrappedChannels.map((item) => '~' + item.channel.name);\n        resultCallback({\n            terms: channelMentions.concat([' ']),\n            items: wrappedChannels.concat([{\n                type: Constants.MENTION_MORE_CHANNELS,\n                loading: true,\n            }]),\n            component: ChannelMentionSuggestion,\n            matchedPretext: captured[1],\n        });\n\n        const handleChannels = (channels, withError) => {\n            if (prefix !== this.latestPrefix || this.shouldCancelDispatch(prefix)) {\n                return;\n            }\n\n            const myMembers = getMyChannelMemberships(store.getState());\n\n            if (channels.length === 0 && !withError) {\n                this.lastPrefixWithNoResults = prefix;\n            }\n\n            // Wrap channels in an outer object to avoid overwriting the 'type' property.\n            const wrappedMoreChannels = [];\n            channels.forEach((item) => {\n                if (item.delete_at > 0 && !myMembers[item.id]) {\n                    return;\n                }\n\n                if (myMembers[item.id] && !wrappedChannelIds[item.id]) {\n                    wrappedChannelIds[item.id] = true;\n                    wrappedChannels.push({\n                        type: Constants.MENTION_CHANNELS,\n                        channel: item,\n                    });\n                    return;\n                }\n\n                if (myMembers[item.id] && wrappedChannelIds[item.id]) {\n                    return;\n                }\n\n                if (!myMembers[item.id] && wrappedChannelIds[item.id]) {\n                    delete wrappedChannelIds[item.id];\n                    const idx = wrappedChannels.map((el) => el.channel.id).indexOf(item.id);\n                    if (idx >= 0) {\n                        wrappedChannels.splice(idx, 1);\n                    }\n                }\n\n                wrappedMoreChannels.push({\n                    type: Constants.MENTION_MORE_CHANNELS,\n                    channel: item,\n                });\n            });\n\n            wrappedChannels = wrappedChannels.sort((a, b) => {\n                //\n                // MM-12677 When this is migrated this needs to be fixed to pull the user's locale\n                //\n                return sortChannelsByTypeAndDisplayName('en', a.channel, b.channel);\n            });\n\n            const wrapped = wrappedChannels.concat(wrappedMoreChannels);\n            const mentions = wrapped.map((item) => '~' + item.channel.name);\n\n            resultCallback({\n                matchedPretext: captured[1],\n                terms: mentions,\n                items: wrapped,\n                component: ChannelMentionSuggestion,\n            });\n        };\n\n        this.autocompleteChannels(\n            prefix,\n            (channels) => handleChannels(channels, false),\n            () => handleChannels([], true),\n        );\n\n        return true;\n    }\n\n    handleCompleteWord(term) {\n        this.lastCompletedWord = term;\n        this.lastPrefixWithNoResults = '';\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {Client4} from 'mattermost-redux/client';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\n\nimport store from 'stores/redux_store.jsx';\n\nimport * as UserAgent from 'utils/user_agent';\n\nimport Suggestion from './suggestion.jsx';\nimport Provider from './provider.jsx';\n\nexport class CommandSuggestion extends Suggestion {\n    render() {\n        const {item, isSelection} = this.props;\n\n        let className = 'command';\n        if (isSelection) {\n            className += ' suggestion--selected';\n        }\n\n        return (\n            <div\n                className={className}\n                onClick={this.handleClick}\n                onMouseMove={this.handleMouseMove}\n                {...Suggestion.baseProps}\n            >\n                <div className='command__title'>\n                    {item.suggestion + ' ' + item.hint}\n                </div>\n                <div className='command__desc'>\n                    {item.description}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default class CommandProvider extends Provider {\n    handlePretextChanged(pretext, resultCallback) {\n        if (pretext.startsWith('/')) {\n            const command = pretext.toLowerCase();\n            Client4.getCommandsList(getCurrentTeamId(store.getState())).then(\n                (data) => {\n                    let matches = [];\n                    data.forEach((cmd) => {\n                        if (!cmd.auto_complete) {\n                            return;\n                        }\n\n                        if (cmd.trigger !== 'shortcuts' || !UserAgent.isMobile()) {\n                            if (('/' + cmd.trigger).indexOf(command) === 0) {\n                                const s = '/' + cmd.trigger;\n                                let hint = '';\n                                if (cmd.auto_complete_hint && cmd.auto_complete_hint.length !== 0) {\n                                    hint = cmd.auto_complete_hint;\n                                }\n                                matches.push({\n                                    suggestion: s,\n                                    hint,\n                                    description: cmd.auto_complete_desc,\n                                });\n                            }\n                        }\n                    });\n\n                    matches = matches.sort((a, b) => a.suggestion.localeCompare(b.suggestion));\n\n                    // pull out the suggested commands from the returned data\n                    const terms = matches.map((suggestion) => suggestion.suggestion);\n\n                    resultCallback({\n                        matchedPretext: command,\n                        terms,\n                        items: matches,\n                        component: CommandSuggestion,\n                    });\n                }\n            ).catch(\n                () => {} //eslint-disable-line no-empty-function\n            );\n\n            return true;\n        }\n        return false;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {autocompleteCustomEmojis} from 'mattermost-redux/actions/emojis';\nimport {getEmojiImageUrl} from 'mattermost-redux/utils/emoji_utils';\n\nimport {getEmojiMap, getRecentEmojis} from 'selectors/emojis';\n\nimport store from 'stores/redux_store.jsx';\n\nimport * as Emoticons from 'utils/emoticons';\nimport {compareEmojis} from 'utils/emoji_utils.jsx';\n\nimport Suggestion from './suggestion.jsx';\nimport Provider from './provider.jsx';\n\nexport const MIN_EMOTICON_LENGTH = 2;\nexport const EMOJI_CATEGORY_SUGGESTION_BLACKLIST = ['skintone'];\n\nclass EmoticonSuggestion extends Suggestion {\n    render() {\n        const text = this.props.term;\n        const emoji = this.props.item.emoji;\n\n        let className = 'emoticon-suggestion';\n        if (this.props.isSelection) {\n            className += ' suggestion--selected';\n        }\n\n        return (\n            <div\n                className={className}\n                onClick={this.handleClick}\n                onMouseMove={this.handleMouseMove}\n                {...Suggestion.baseProps}\n            >\n                <div className='pull-left'>\n                    <img\n                        alt={text}\n                        className='emoticon-suggestion__image'\n                        src={getEmojiImageUrl(emoji)}\n                        title={text}\n                    />\n                </div>\n                <div className='pull-left'>\n                    {text}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default class EmoticonProvider extends Provider {\n    handlePretextChanged(pretext, resultsCallback) {\n        // Look for the potential emoticons at the start of the text, after whitespace, and at the start of emoji reaction commands\n        const captured = (/(^|\\s|^\\+|^-)(:([^:\\s]*))$/g).exec(pretext);\n        if (!captured) {\n            return false;\n        }\n\n        const prefix = captured[1];\n        const text = captured[2];\n        const partialName = captured[3];\n\n        if (partialName.length < MIN_EMOTICON_LENGTH) {\n            return false;\n        }\n\n        // Check for text emoticons if this isn't for an emoji reaction\n        if (prefix !== '-' && prefix !== '+') {\n            for (const emoticon of Object.keys(Emoticons.emoticonPatterns)) {\n                if (Emoticons.emoticonPatterns[emoticon].test(text)) {\n                    // Don't show the autocomplete for text emoticons\n                    return false;\n                }\n            }\n        }\n\n        if (store.getState().entities.general.config.EnableCustomEmoji === 'true') {\n            store.dispatch(autocompleteCustomEmojis(partialName)).then(() => this.findAndSuggestEmojis(text, partialName, resultsCallback));\n        } else {\n            this.findAndSuggestEmojis(text, partialName, resultsCallback);\n        }\n\n        return true;\n    }\n\n    formatEmojis(emojis) {\n        return emojis.map((item) => ':' + item.name + ':');\n    }\n\n    // findAndSuggestEmojis uses the provided partialName to match anywhere inside an emoji name.\n    //\n    // For example, typing `:welc` would match both `:welcome:` and `:youre_welcome:` if those\n    // emojis are present in the local store. Note, however, that the server only does prefix\n    // matches, so a query to populate the local store for `:welc` would only return `:welcome:`.\n    // This results in surprising differences between a fresh load of the application, and the\n    // changes to the cache from expanding the cache with emojis found in existing posts.\n    //\n    // For now, this behaviour and difference is by design.\n    // See https://mattermost.atlassian.net/browse/MM-17320.\n    findAndSuggestEmojis(text, partialName, resultsCallback) {\n        const recentMatched = [];\n        const matched = [];\n\n        const emojiMap = getEmojiMap(store.getState());\n        const recentEmojis = getRecentEmojis(store.getState());\n\n        // Check for named emoji\n        for (const [name, emoji] of emojiMap) {\n            if (EMOJI_CATEGORY_SUGGESTION_BLACKLIST.includes(emoji.category)) {\n                continue;\n            }\n\n            if (emoji.aliases) {\n                // This is a system emoji so it may have multiple names\n                for (const alias of emoji.aliases) {\n                    if (alias.indexOf(partialName) !== -1) {\n                        const matchedArray = recentEmojis.includes(alias) || recentEmojis.includes(name) ?\n                            recentMatched :\n                            matched;\n\n                        matchedArray.push({name: alias, emoji});\n                        break;\n                    }\n                }\n            } else if (name.indexOf(partialName) !== -1) {\n                // This is a custom emoji so it only has one name\n                if (emojiMap.hasSystemEmoji(name)) {\n                    // System emojis take precedence over custom ones\n                    continue;\n                }\n\n                const matchedArray = recentEmojis.includes(name) ?\n                    recentMatched :\n                    matched;\n\n                matchedArray.push({name, emoji});\n            }\n        }\n\n        const sortEmojisHelper = (a, b) => {\n            return compareEmojis(a, b, partialName);\n        };\n\n        recentMatched.sort(sortEmojisHelper);\n\n        matched.sort(sortEmojisHelper);\n\n        const terms = [\n            ...this.formatEmojis(recentMatched),\n            ...this.formatEmojis(matched),\n        ];\n\n        const items = [\n            ...recentMatched,\n            ...matched,\n        ];\n\n        // Required to get past the dispatch during dispatch error\n\n        resultsCallback({\n            matchedPretext: text,\n            terms,\n            items,\n            component: EmoticonSuggestion,\n        });\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport AutosizeTextarea from 'components/autosize_textarea';\nimport PostMarkdown from 'components/post_markdown';\nimport AtMentionProvider from 'components/suggestion/at_mention_provider';\nimport ChannelMentionProvider from 'components/suggestion/channel_mention_provider.jsx';\nimport CommandProvider from 'components/suggestion/command_provider.jsx';\nimport EmoticonProvider from 'components/suggestion/emoticon_provider.jsx';\nimport SuggestionBox from 'components/suggestion/suggestion_box.jsx';\nimport SuggestionList from 'components/suggestion/suggestion_list.jsx';\nimport * as Utils from 'utils/utils.jsx';\n\nexport default class Textbox extends React.PureComponent {\n    static propTypes = {\n        id: PropTypes.string.isRequired,\n        channelId: PropTypes.string,\n        value: PropTypes.string.isRequired,\n        onChange: PropTypes.func.isRequired,\n        onKeyPress: PropTypes.func.isRequired,\n        onComposition: PropTypes.func,\n        onHeightChange: PropTypes.func,\n        createMessage: PropTypes.string.isRequired,\n        onKeyDown: PropTypes.func,\n        onMouseUp: PropTypes.func,\n        onKeyUp: PropTypes.func,\n        onBlur: PropTypes.func,\n        supportsCommands: PropTypes.bool.isRequired,\n        handlePostError: PropTypes.func,\n        suggestionListStyle: PropTypes.string,\n        emojiEnabled: PropTypes.bool,\n        isRHS: PropTypes.bool,\n        characterLimit: PropTypes.number.isRequired,\n        disabled: PropTypes.bool,\n        badConnection: PropTypes.bool,\n        listenForMentionKeyClick: PropTypes.bool,\n        currentUserId: PropTypes.string.isRequired,\n        preview: PropTypes.bool,\n        profilesInChannel: PropTypes.arrayOf(PropTypes.object).isRequired,\n        profilesNotInChannel: PropTypes.arrayOf(PropTypes.object).isRequired,\n        actions: PropTypes.shape({\n            autocompleteUsersInChannel: PropTypes.func.isRequired,\n            autocompleteChannels: PropTypes.func.isRequired,\n        }),\n        useChannelMentions: PropTypes.bool.isRequired,\n    };\n\n    static defaultProps = {\n        supportsCommands: true,\n        isRHS: false,\n        listenForMentionKeyClick: false,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.suggestionProviders = [\n            new AtMentionProvider({\n                currentUserId: this.props.currentUserId,\n                profilesInChannel: this.props.profilesInChannel,\n                profilesNotInChannel: this.props.profilesNotInChannel,\n                autocompleteUsersInChannel: (prefix) => this.props.actions.autocompleteUsersInChannel(prefix, props.channelId),\n                useChannelMentions: this.props.useChannelMentions,\n            }),\n            new ChannelMentionProvider(props.actions.autocompleteChannels),\n            new EmoticonProvider(),\n        ];\n\n        if (props.supportsCommands) {\n            this.suggestionProviders.push(new CommandProvider());\n        }\n\n        this.checkMessageLength(props.value);\n        this.wrapper = React.createRef();\n    }\n\n    handleChange = (e) => {\n        this.props.onChange(e);\n    }\n\n    updateSuggestions(prevProps) {\n        if (this.props.channelId !== prevProps.channelId ||\n            this.props.currentUserId !== prevProps.currentUserId ||\n            this.props.profilesInChannel !== prevProps.profilesInChannel ||\n            this.props.profilesNotInChannel !== prevProps.profilesNotInChannel) {\n            // Update channel id for AtMentionProvider.\n            const providers = this.suggestionProviders;\n            for (let i = 0; i < providers.length; i++) {\n                if (providers[i] instanceof AtMentionProvider) {\n                    providers[i].setProps({\n                        currentUserId: this.props.currentUserId,\n                        profilesInChannel: this.props.profilesInChannel,\n                        profilesNotInChannel: this.props.profilesNotInChannel,\n                        autocompleteUsersInChannel: (prefix) => this.props.actions.autocompleteUsersInChannel(prefix, this.props.channelId),\n                        useChannelMentions: this.props.useChannelMentions,\n                    });\n                }\n            }\n        }\n        if (prevProps.value !== this.props.value) {\n            this.checkMessageLength(this.props.value);\n        }\n    }\n    componentDidUpdate(prevProps) {\n        if (!prevProps.preview && this.props.preview) {\n            this.refs.preview.focus();\n        }\n\n        this.updateSuggestions(prevProps);\n    }\n\n    checkMessageLength = (message) => {\n        if (this.props.handlePostError) {\n            if (message.length > this.props.characterLimit) {\n                const errorMessage = (\n                    <FormattedMessage\n                        id='create_post.error_message'\n                        defaultMessage='Your message is too long. Character count: {length}/{limit}'\n                        values={{\n                            length: message.length,\n                            limit: this.props.characterLimit,\n                        }}\n                    />);\n                this.props.handlePostError(errorMessage);\n            } else {\n                this.props.handlePostError(null);\n            }\n        }\n    }\n\n    handleKeyDown = (e) => {\n        if (this.props.onKeyDown) {\n            this.props.onKeyDown(e);\n        }\n    }\n\n    handleMouseUp = (e) => {\n        if (this.props.onMouseUp) {\n            this.props.onMouseUp(e);\n        }\n    }\n\n    handleKeyUp = (e) => {\n        if (this.props.onKeyUp) {\n            this.props.onKeyUp(e);\n        }\n    }\n\n    handleBlur = (e) => {\n        if (this.props.onBlur) {\n            this.props.onBlur(e);\n        }\n    }\n\n    handleHeightChange = (height, maxHeight) => {\n        if (this.props.onHeightChange) {\n            this.props.onHeightChange(height, maxHeight);\n        }\n    }\n\n    getInputBox = () => {\n        const textbox = this.refs.message.getTextbox();\n        return textbox;\n    }\n\n    focus = () => {\n        const textbox = this.refs.message.getTextbox();\n\n        textbox.focus();\n        Utils.placeCaretAtEnd(textbox);\n\n        // reset character count warning\n        this.checkMessageLength(textbox.value);\n    }\n\n    blur = () => {\n        const textbox = this.refs.message.getTextbox();\n        textbox.blur();\n    };\n\n    recalculateSize = () => {\n        this.refs.message.recalculateSize();\n    }\n\n    render() {\n        let preview = null;\n\n        let textboxClassName = 'form-control custom-textarea';\n        let textWrapperClass = 'textarea-wrapper';\n        let wrapperHeight;\n        if (this.props.emojiEnabled) {\n            textboxClassName += ' custom-textarea--emoji-picker';\n        }\n        if (this.props.badConnection) {\n            textboxClassName += ' bad-connection';\n        }\n        if (this.wrapper.current) {\n            wrapperHeight = this.getInputBox().clientHeight;\n        }\n        if (this.props.preview) {\n            textboxClassName += ' custom-textarea--preview';\n            textWrapperClass += ' textarea-wrapper--preview';\n\n            preview = (\n                <div\n                    tabIndex='0'\n                    ref='preview'\n                    className='form-control custom-textarea textbox-preview-area'\n                    onKeyPress={this.props.onKeyPress}\n                    onKeyDown={this.handleKeyDown}\n                    onBlur={this.handleBlur}\n                >\n                    <PostMarkdown\n                        isRHS={this.props.isRHS}\n                        message={this.props.value}\n                    />\n                </div>\n            );\n        }\n\n        return (\n            <div\n                ref={this.wrapper}\n                className={textWrapperClass}\n            >\n                <SuggestionBox\n                    id={this.props.id}\n                    ref='message'\n                    className={textboxClassName}\n                    spellCheck='true'\n                    placeholder={this.props.createMessage}\n                    onChange={this.handleChange}\n                    onKeyPress={this.props.onKeyPress}\n                    onKeyDown={this.handleKeyDown}\n                    onMouseUp={this.handleMouseUp}\n                    onKeyUp={this.handleKeyUp}\n                    onComposition={this.props.onComposition}\n                    onBlur={this.handleBlur}\n                    onHeightChange={this.handleHeightChange}\n                    style={{visibility: this.props.preview ? 'hidden' : 'visible'}}\n                    inputComponent={AutosizeTextarea}\n                    listComponent={SuggestionList}\n                    listStyle={this.props.suggestionListStyle}\n                    providers={this.suggestionProviders}\n                    channelId={this.props.channelId}\n                    value={this.props.value}\n                    renderDividers={true}\n                    isRHS={this.props.isRHS}\n                    disabled={this.props.disabled}\n                    contextId={this.props.channelId}\n                    listenForMentionKeyClick={this.props.listenForMentionKeyClick}\n                    wrapperHeight={wrapperHeight}\n                />\n                {preview}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\n\nimport {getCurrentUserId, makeGetProfilesInChannel, makeGetProfilesNotInChannel} from 'mattermost-redux/selectors/entities/users';\n\nimport {autocompleteUsersInChannel} from 'actions/views/channel';\nimport {autocompleteChannels} from 'actions/channel_actions';\n\nimport Textbox from './textbox.jsx';\n\nconst makeMapStateToProps = () => {\n    const getProfilesInChannel = makeGetProfilesInChannel();\n    const getProfilesNotInChannel = makeGetProfilesNotInChannel();\n\n    return (state, ownProps) => ({\n        currentUserId: getCurrentUserId(state),\n        profilesInChannel: getProfilesInChannel(state, ownProps.channelId, true),\n        profilesNotInChannel: getProfilesNotInChannel(state, ownProps.channelId, true),\n    });\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({\n        autocompleteUsersInChannel,\n        autocompleteChannels,\n    }, dispatch),\n});\n\nexport default connect(makeMapStateToProps, mapDispatchToProps, null, {withRef: true})(Textbox);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport {Link} from 'react-router-dom';\n\nexport default class TextboxLinks extends React.PureComponent {\n    static propTypes = {\n        showPreview: PropTypes.bool,\n        characterLimit: PropTypes.number.isRequired,\n        previewMessageLink: PropTypes.string,\n        updatePreview: PropTypes.func,\n        message: PropTypes.string.isRequired,\n        isMarkdownPreviewEnabled: PropTypes.bool.isRequired,\n    };\n\n    static defaultProps = {\n        message: '',\n    };\n\n    togglePreview = (e) => {\n        e.preventDefault();\n        this.props.updatePreview(!this.props.showPreview);\n    }\n\n    render() {\n        const {isMarkdownPreviewEnabled} = this.props;\n        const hasText = this.props.message && this.props.message.length > 0;\n        let editHeader;\n\n        let helpTextClass = '';\n\n        if (this.props.message && this.props.message.length > this.props.characterLimit) {\n            helpTextClass = 'hidden';\n        }\n\n        if (this.props.previewMessageLink) {\n            editHeader = (\n                <span>\n                    {this.props.previewMessageLink}\n                </span>\n            );\n        } else {\n            editHeader = (\n                <FormattedMessage\n                    id='textbox.edit'\n                    defaultMessage='Edit message'\n                />\n            );\n        }\n\n        let previewLink = null;\n        if (isMarkdownPreviewEnabled) {\n            previewLink = (\n                <button\n                    id='previewLink'\n                    onClick={this.togglePreview}\n                    className='style--none textbox-preview-link color--link'\n                >\n                    {this.props.showPreview ? (\n                        editHeader\n                    ) : (\n                        <FormattedMessage\n                            id='textbox.preview'\n                            defaultMessage='Preview'\n                        />\n                    )}\n                </button>\n            );\n        }\n\n        const helpText = (\n            <div\n                style={{visibility: hasText ? 'visible' : 'hidden', opacity: hasText ? '0.45' : '0'}}\n                className='help__format-text'\n            >\n                <b>\n                    <FormattedMessage\n                        id='textbox.bold'\n                        defaultMessage='**bold**'\n                    />\n                </b>\n                <i>\n                    <FormattedMessage\n                        id='textbox.italic'\n                        defaultMessage='_italic_'\n                    />\n                </i>\n                <span>\n                    {'~~'}\n                    <strike>\n                        <FormattedMessage\n                            id='textbox.strike'\n                            defaultMessage='strike'\n                        />\n                    </strike>\n                    {'~~ '}\n                </span>\n                <span>\n                    <FormattedMessage\n                        id='textbox.inlinecode'\n                        defaultMessage='`inline code`'\n                    />\n                </span>\n                <span>\n                    <FormattedMessage\n                        id='textbox.preformatted'\n                        defaultMessage='```preformatted```'\n                    />\n                </span>\n                <span>\n                    <FormattedMessage\n                        id='textbox.quote'\n                        defaultMessage='>quote'\n                    />\n                </span>\n            </div>\n        );\n\n        return (\n            <div className={'help__text ' + helpTextClass}>\n                {helpText}\n                {previewLink}\n                <Link\n                    target='_blank'\n                    rel='noopener noreferrer'\n                    to='/help/messaging'\n                    className='textbox-help-link'\n                >\n                    <FormattedMessage\n                        id='textbox.help'\n                        defaultMessage='Help'\n                    />\n                </Link>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport Constants from 'utils/constants';\nimport {isFeatureEnabled} from 'utils/utils';\n\nimport TextboxLinks from './textbox_links.jsx';\n\nconst PreReleaseFeatures = Constants.PRE_RELEASE_FEATURES;\n\nconst mapStateToProps = (state) => {\n    return ({\n        isMarkdownPreviewEnabled: isFeatureEnabled(PreReleaseFeatures.MARKDOWN_PREVIEW, state),\n    });\n};\n\nexport default connect(mapStateToProps)(TextboxLinks);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage, injectIntl} from 'react-intl';\nimport PropTypes from 'prop-types';\n\nimport {Constants, ModalIdentifiers} from 'utils/constants';\nimport {splitMessageBasedOnCaretPosition, postMessageOnKeyPress} from 'utils/post_utils.jsx';\n\nimport {intlShape} from 'utils/react_intl';\nimport * as Utils from 'utils/utils.jsx';\n\nimport DeletePostModal from 'components/delete_post_modal';\nimport EmojiPickerOverlay from 'components/emoji_picker/emoji_picker_overlay.jsx';\nimport EmojiIcon from 'components/widgets/icons/emoji_icon';\nimport Textbox from 'components/textbox';\nimport TextboxLinks from 'components/textbox/textbox_links';\n\nconst KeyCodes = Constants.KeyCodes;\n\nclass EditPostModal extends React.PureComponent {\n    static propTypes = {\n        canEditPost: PropTypes.bool,\n        canDeletePost: PropTypes.bool,\n        codeBlockOnCtrlEnter: PropTypes.bool,\n        ctrlSend: PropTypes.bool,\n        config: PropTypes.object.isRequired,\n        intl: intlShape.isRequired,\n        maxPostSize: PropTypes.number.isRequired,\n        useChannelMentions: PropTypes.bool.isRequired,\n\n        editingPost: PropTypes.shape({\n            post: PropTypes.object,\n            postId: PropTypes.string,\n            refocusId: PropTypes.string,\n            commentCount: PropTypes.number,\n            show: PropTypes.bool.isRequired,\n            title: PropTypes.string,\n            isRHS: PropTypes.bool,\n        }).isRequired,\n\n        actions: PropTypes.shape({\n            addMessageIntoHistory: PropTypes.func.isRequired,\n            editPost: PropTypes.func.isRequired,\n            hideEditPostModal: PropTypes.func.isRequired,\n            openModal: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            preview: false,\n            editText: '',\n            caretPosition: ''.length,\n            postError: '',\n            errorClass: null,\n            showEmojiPicker: false,\n            prevShowState: props.editingPost.show,\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        if (props.editingPost.show && !state.prevShowState) {\n            return {\n                editText: props.editingPost.post.message_source || props.editingPost.post.message,\n                prevShowState: props.editingPost.show,\n            };\n        }\n\n        return null;\n    }\n\n    updatePreview = (newState) => {\n        this.setState({preview: newState});\n    }\n\n    getContainer = () => {\n        return this.refs.editModalBody;\n    }\n\n    toggleEmojiPicker = () => {\n        this.setState({showEmojiPicker: !this.state.showEmojiPicker});\n        if (!this.state.showEmojiPicker && this.editbox) {\n            this.editbox.focus();\n        }\n    }\n\n    hideEmojiPicker = () => {\n        this.setState({showEmojiPicker: false});\n        if (this.editbox) {\n            this.editbox.focus();\n        }\n    }\n\n    handleEmojiClick = (emoji) => {\n        const emojiAlias = emoji && (emoji.name || (emoji.aliases && emoji.aliases[0]));\n\n        if (!emojiAlias) {\n            //Oops.. There went something wrong\n            return;\n        }\n\n        if (this.state.editText === '') {\n            this.setState({editText: ':' + emojiAlias + ': '});\n        } else {\n            const {editText} = this.state;\n            const {firstPiece, lastPiece} = splitMessageBasedOnCaretPosition(this.state.caretPosition, editText);\n\n            // check whether the first piece of the message is empty when cursor\n            // is placed at beginning of message and avoid adding an empty string at the beginning of the message\n            const newMessage = firstPiece === '' ? `:${emojiAlias}: ${lastPiece}` : `${firstPiece} :${emojiAlias}: ${lastPiece}`;\n\n            const newCaretPosition = firstPiece === '' ? `:${emojiAlias}: `.length : `${firstPiece} :${emojiAlias}: `.length;\n\n            const textbox = this.editbox.getInputBox();\n\n            this.setState({\n                editText: newMessage,\n                caretPosition: newCaretPosition,\n            }, () => {\n                Utils.setCaretPosition(textbox, newCaretPosition);\n            });\n        }\n\n        this.setState({showEmojiPicker: false});\n\n        if (this.editbox) {\n            this.editbox.focus();\n        }\n    }\n\n    handleGifClick = (gif) => {\n        if (this.state.editText === '') {\n            this.setState({editText: gif});\n        } else {\n            const newMessage = ((/\\s+$/).test(this.state.editText)) ? this.state.editText + gif : this.state.editText + ' ' + gif;\n            this.setState({editText: newMessage});\n        }\n        this.setState({showEmojiPicker: false});\n        this.editbox.focus();\n    }\n\n    getEditPostControls = () => {\n        return this.refs.editPostEmoji;\n    }\n\n    handlePostError = (postError) => {\n        if (this.state.postError !== postError) {\n            this.setState({postError});\n        }\n    }\n\n    handleEdit = async () => {\n        if (this.isSaveDisabled()) {\n            return;\n        }\n\n        const {actions, editingPost} = this.props;\n        const updatedPost = {\n            message: this.state.editText,\n            id: editingPost.postId,\n            channel_id: editingPost.post.channel_id,\n        };\n\n        if (this.state.postError) {\n            this.setState({errorClass: 'animation--highlight'});\n            setTimeout(() => {\n                this.setState({errorClass: null});\n            }, Constants.ANIMATION_TIMEOUT);\n            return;\n        }\n\n        if (updatedPost.message === (editingPost.post.message_source || editingPost.post.message)) {\n            // no changes so just close the modal\n            this.handleHide();\n            return;\n        }\n\n        const hasAttachment = editingPost.post.file_ids && editingPost.post.file_ids.length > 0;\n        if (updatedPost.message.trim().length === 0 && !hasAttachment) {\n            this.handleHide(false);\n\n            const deletePostModalData = {\n                ModalId: ModalIdentifiers.DELETE_POST,\n                dialogType: DeletePostModal,\n                dialogProps: {\n                    post: editingPost.post,\n                    commentCount: editingPost.commentCount,\n                    isRHS: editingPost.isRHS,\n                },\n            };\n\n            this.props.actions.openModal(deletePostModalData);\n            return;\n        }\n\n        actions.addMessageIntoHistory(updatedPost.message);\n\n        const data = await actions.editPost(updatedPost);\n        if (data) {\n            window.scrollTo(0, 0);\n        }\n\n        this.handleHide();\n    }\n\n    handleChange = (e) => {\n        const message = e.target.value;\n        this.setState({\n            editText: message,\n        });\n    }\n\n    handleEditKeyPress = (e) => {\n        const {ctrlSend, codeBlockOnCtrlEnter} = this.props;\n\n        const {allowSending, ignoreKeyPress} = postMessageOnKeyPress(e, this.state.editText, ctrlSend, codeBlockOnCtrlEnter, Date.now(), this.lastChannelSwitchAt, this.state.caretPosition);\n\n        if (ignoreKeyPress) {\n            e.preventDefault();\n            e.stopPropagation();\n            return;\n        }\n\n        if (allowSending) {\n            e.preventDefault();\n            this.editbox.blur();\n            this.handleEdit();\n        }\n    }\n\n    handleMouseUpKeyUp = (e) => {\n        const caretPosition = Utils.getCaretPosition(e.target);\n        this.setState({\n            caretPosition,\n        });\n    }\n\n    handleKeyDown = (e) => {\n        if (this.props.ctrlSend && Utils.isKeyPressed(e, KeyCodes.ENTER) && e.ctrlKey === true) {\n            this.handleEdit();\n        } else if (Utils.isKeyPressed(e, KeyCodes.ESCAPE) && !this.state.showEmojiPicker) {\n            this.handleHide();\n        }\n    }\n\n    handleHide = (doRefocus = true) => {\n        this.refocusId = doRefocus ? this.props.editingPost.refocusId : null;\n        this.props.actions.hideEditPostModal();\n    }\n\n    handleCheckForChangesHide = () => {\n        if (this.state.editText !== this.props.editingPost.post.message) {\n            return;\n        }\n\n        this.handleHide();\n    }\n\n    handleEntered = () => {\n        if (this.editbox) {\n            this.editbox.focus();\n            this.editbox.recalculateSize();\n        }\n    }\n\n    handleExit = () => {\n        this.setState({preview: false});\n    }\n\n    handleExited = () => {\n        const refocusId = this.refocusId;\n        if (refocusId) {\n            setTimeout(() => {\n                const element = document.getElementById(refocusId);\n                if (element) {\n                    element.focus();\n                }\n            });\n        }\n\n        this.refocusId = null;\n        this.setState({editText: '', postError: '', errorClass: null, preview: false, showEmojiPicker: false, prevShowState: false});\n    }\n\n    setEditboxRef = (ref) => {\n        if (ref && ref.getWrappedInstance) {\n            this.editbox = ref.getWrappedInstance();\n        }\n\n        if (this.editbox) {\n            this.editbox.focus();\n        }\n    }\n\n    isSaveDisabled = () => {\n        const post = this.props.editingPost.post;\n        const hasAttachments = post && post.file_ids && post.file_ids.length > 0;\n        if (hasAttachments) {\n            return !this.props.canEditPost;\n        }\n\n        if (this.state.editText !== '') {\n            return !this.props.canEditPost;\n        }\n\n        return !this.props.canDeletePost;\n    }\n\n    render() {\n        const {formatMessage} = this.props.intl;\n        const errorBoxClass = 'edit-post-footer' + (this.state.postError ? ' has-error' : '');\n        let postError = null;\n        if (this.state.postError) {\n            const postErrorClass = 'post-error' + (this.state.errorClass ? (' ' + this.state.errorClass) : '');\n            postError = (<label className={postErrorClass}>{this.state.postError}</label>);\n        }\n\n        let emojiPicker = null;\n        const emojiButtonAriaLabel = formatMessage({id: 'emoji_picker.emojiPicker', defaultMessage: 'Emoji Picker'}).toLowerCase();\n        if (this.props.config.EnableEmojiPicker === 'true' && !this.state.preview) {\n            emojiPicker = (\n                <div>\n                    <EmojiPickerOverlay\n                        show={this.state.showEmojiPicker}\n                        container={this.getContainer}\n                        target={this.getEditPostControls}\n                        onHide={this.hideEmojiPicker}\n                        onEmojiClick={this.handleEmojiClick}\n                        onGifClick={this.handleGifClick}\n                        enableGifPicker={this.props.config.EnableGifPicker === 'true'}\n                        topOffset={-20}\n                    />\n                    <button\n                        aria-label={emojiButtonAriaLabel}\n                        id='editPostEmoji'\n                        ref='editPostEmoji'\n                        className='style--none post-action'\n                        onClick={this.toggleEmojiPicker}\n                    >\n                        <EmojiIcon\n                            className='icon icon--emoji'\n\n                        />\n                    </button>\n                </div>\n            );\n        }\n\n        return (\n            <Modal\n                id='editPostModal'\n                dialogClassName='a11y__modal edit-modal'\n                show={this.props.editingPost.show}\n                onKeyDown={this.handleKeyDown}\n                onHide={this.handleCheckForChangesHide}\n                onEntered={this.handleEntered}\n                onExit={this.handleExit}\n                onExited={this.handleExited}\n                keyboard={false}\n                role='dialog'\n                aria-labelledby='editPostModalLabel'\n            >\n                <Modal.Header\n                    closeButton={true}\n                    onHide={this.handleHide}\n                >\n                    <Modal.Title\n                        componentClass='h1'\n                        id='editPostModalLabel'\n                    >\n                        <FormattedMessage\n                            id='edit_post.edit'\n                            defaultMessage='Edit {title}'\n                            values={{\n                                title: this.props.editingPost.title,\n                            }}\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body\n                    bsClass={`modal-body edit-modal-body${this.state.showEmojiPicker ? ' edit-modal-body--add-reaction' : ''}`}\n                    ref='editModalBody'\n                >\n                    <div className='post-create__container'>\n                        <div className='textarea-wrapper'>\n                            <Textbox\n                                tabIndex='0'\n                                onChange={this.handleChange}\n                                onKeyPress={this.handleEditKeyPress}\n                                onKeyDown={this.handleKeyDown}\n                                onMouseUp={this.handleMouseUpKeyUp}\n                                onKeyUp={this.handleMouseUpKeyUp}\n                                handlePostError={this.handlePostError}\n                                value={this.state.editText}\n                                channelId={this.props.editingPost.post && this.props.editingPost.post.channel_id}\n                                emojiEnabled={this.props.config.EnableEmojiPicker === 'true'}\n                                createMessage={Utils.localizeMessage('edit_post.editPost', 'Edit the post...')}\n                                supportsCommands={false}\n                                suggestionListStyle='bottom'\n                                id='edit_textbox'\n                                ref={this.setEditboxRef}\n                                characterLimit={this.props.maxPostSize}\n                                preview={this.state.preview}\n                                useChannelMentions={this.props.useChannelMentions}\n                            />\n                            <div className='post-body__actions'>\n                                {emojiPicker}\n                            </div>\n                        </div>\n                        <div className='post-create-footer'>\n                            <TextboxLinks\n                                characterLimit={this.props.maxPostSize}\n                                showPreview={this.state.preview}\n                                ref={this.setTextboxLinksRef}\n                                updatePreview={this.updatePreview}\n                                message={this.state.editText}\n                            />\n                            <div className={errorBoxClass}>\n                                {postError}\n                            </div>\n                        </div>\n                    </div>\n                </Modal.Body>\n                <Modal.Footer>\n                    <button\n                        type='button'\n                        className='btn btn-link'\n                        onClick={this.handleHide}\n                    >\n                        <FormattedMessage\n                            id='edit_post.cancel'\n                            defaultMessage='Cancel'\n                        />\n                    </button>\n                    <button\n                        id='editButton'\n                        type='button'\n                        className='btn btn-primary'\n                        disabled={this.isSaveDisabled()}\n                        onClick={this.handleEdit}\n                    >\n                        <FormattedMessage\n                            id='edit_post.save'\n                            defaultMessage='Save'\n                        />\n                    </button>\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n\nexport default injectIntl(EditPostModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {addMessageIntoHistory} from 'mattermost-redux/actions/posts';\nimport {Preferences, Permissions} from 'mattermost-redux/constants';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {haveIChannelPermission} from 'mattermost-redux/selectors/entities/roles';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getBool} from 'mattermost-redux/selectors/entities/preferences';\n\nimport {openModal} from 'actions/views/modals';\nimport {hideEditPostModal} from 'actions/post_actions';\nimport {editPost} from 'actions/views/posts';\nimport {getEditingPost} from 'selectors/posts';\nimport Constants from 'utils/constants';\n\nimport EditPostModal from './edit_post_modal.jsx';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n    const editingPost = getEditingPost(state);\n    const currentUserId = getCurrentUserId(state);\n    const channelId = getCurrentChannelId(state);\n    const teamId = getCurrentTeamId(state);\n    let canDeletePost = false;\n    let canEditPost = false;\n    if (editingPost && editingPost.post && editingPost.post.user_id === currentUserId) {\n        canDeletePost = haveIChannelPermission(state, {channel: channelId, team: teamId, permission: Permissions.DELETE_POST});\n        canEditPost = haveIChannelPermission(state, {channel: channelId, team: teamId, permission: Permissions.EDIT_POST});\n    } else {\n        canDeletePost = haveIChannelPermission(state, {channel: channelId, team: teamId, permission: Permissions.DELETE_OTHERS_POSTS});\n        canEditPost = haveIChannelPermission(state, {channel: channelId, team: teamId, permission: Permissions.EDIT_OTHERS_POSTS});\n    }\n\n    const useChannelMentions = haveIChannelPermission(state, {\n        channel: channelId,\n        team: teamId,\n        permission: Permissions.USE_CHANNEL_MENTIONS,\n    });\n\n    return {\n        canEditPost,\n        canDeletePost,\n        codeBlockOnCtrlEnter: getBool(state, Preferences.CATEGORY_ADVANCED_SETTINGS, 'code_block_ctrl_enter', true),\n        ctrlSend: getBool(state, Preferences.CATEGORY_ADVANCED_SETTINGS, 'send_on_ctrl_enter'),\n        config,\n        editingPost,\n        maxPostSize: parseInt(config.MaxPostSize, 10) || Constants.DEFAULT_CHARACTER_LIMIT,\n        useChannelMentions,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            addMessageIntoHistory,\n            editPost,\n            hideEditPostModal,\n            openModal,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(EditPostModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport EventEmitter from 'events';\n\nimport Constants from 'utils/constants';\nimport AppDispatcher from '../dispatcher/app_dispatcher.jsx';\n\nconst ActionTypes = Constants.ActionTypes;\n\nclass ModalStoreClass extends EventEmitter {\n    constructor() {\n        super();\n\n        this.dispatchToken = AppDispatcher.register(this.handleEventPayload);\n    }\n\n    addModalListener = (action, callback) => {\n        this.on(action, callback);\n    }\n\n    removeModalListener = (action, callback) => {\n        this.removeListener(action, callback);\n    }\n\n    handleEventPayload = (payload) => {\n        // toggle event handlers should accept a boolean show/hide value and can accept a map of arguments\n        const {type, value, ...args} = payload.action; //eslint-disable-line no-use-before-define\n\n        switch (type) {\n        case ActionTypes.TOGGLE_SHORTCUTS_MODAL:\n        case ActionTypes.TOGGLE_IMPORT_THEME_MODAL:\n        case ActionTypes.TOGGLE_DELETE_POST_MODAL:\n        case ActionTypes.TOGGLE_GET_TEAM_INVITE_LINK_MODAL:\n        case ActionTypes.TOGGLE_GET_PUBLIC_LINK_MODAL:\n        case ActionTypes.TOGGLE_QUICK_SWITCH_MODAL:\n        case ActionTypes.TOGGLE_CHANNEL_PURPOSE_UPDATE_MODAL:\n        case ActionTypes.TOGGLE_CHANNEL_NAME_UPDATE_MODAL:\n        case ActionTypes.TOGGLE_LEAVE_PRIVATE_CHANNEL_MODAL:\n            this.emit(type, value, args);\n            break;\n        }\n    }\n}\n\nconst ModalStore = new ModalStoreClass();\nexport default ModalStore;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport SuccessIcon from 'components/widgets/icons/fa_success_icon';\n\ntype Props = {\n    show: boolean;\n    onHide: () => void;\n    title: string;\n    helpText?: string;\n    link: string;\n}\n\ntype State = {\n    copiedLink: boolean;\n}\n\nexport default class GetLinkModal extends React.PureComponent<Props, State> {\n    private textAreaRef = React.createRef<HTMLTextAreaElement>();\n    public static defaultProps = {\n        helpText: null,\n    };\n\n    public constructor(props: Props) {\n        super(props);\n        this.state = {\n            copiedLink: false,\n        };\n    }\n\n    public onHide = (): void => {\n        this.setState({copiedLink: false});\n        this.props.onHide();\n    }\n\n    public copyLink = (): void => {\n        const textarea = this.textAreaRef.current;\n\n        if (textarea) {\n            textarea.focus();\n            textarea.setSelectionRange(0, this.props.link.length);\n\n            try {\n                this.setState({copiedLink: document.execCommand('copy')});\n            } catch (err) {\n                this.setState({copiedLink: false});\n            }\n        }\n    }\n\n    public render(): JSX.Element {\n        let helpText = null;\n        if (this.props.helpText) {\n            helpText = (\n                <p>\n                    {this.props.helpText}\n                    <br/>\n                    <br/>\n                </p>\n            );\n        }\n\n        let copyLink = null;\n\n        if (document.queryCommandSupported('copy')) {\n            copyLink = (\n                <button\n                    id='linkModalCopyLink'\n                    data-copy-btn='true'\n                    type='button'\n                    className='btn btn-primary pull-left'\n                    onClick={this.copyLink}\n                >\n                    <FormattedMessage\n                        id='get_link.copy'\n                        defaultMessage='Copy Link'\n                    />\n                </button>\n            );\n        }\n\n        const linkText = (\n            <textarea\n                id='linkModalTextArea'\n                className='form-control no-resize min-height'\n                ref={this.textAreaRef}\n                value={this.props.link}\n                onClick={this.copyLink}\n                readOnly={true}\n            />\n        );\n\n        let copyLinkConfirm = null;\n        if (this.state.copiedLink) {\n            copyLinkConfirm = (\n                <p className='alert alert-success alert--confirm'>\n                    <SuccessIcon/>\n                    <FormattedMessage\n                        id='get_link.clipboard'\n                        defaultMessage=' Link copied'\n                    />\n                </p>\n            );\n        }\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal'\n                show={this.props.show}\n                onHide={this.onHide}\n                role='dialog'\n                aria-labelledby='getLinkModalLabel'\n            >\n                <Modal.Header\n                    id='getLinkModalLabel'\n                    closeButton={true}\n                >\n                    <h4 className='modal-title'>{this.props.title}</h4>\n                </Modal.Header>\n                <Modal.Body>\n                    {helpText}\n                    {linkText}\n                </Modal.Body>\n                <Modal.Footer>\n                    <button\n                        id='linkModalCloseButton'\n                        type='button'\n                        className='btn btn-link'\n                        onClick={this.onHide}\n                    >\n                        <FormattedMessage\n                            id='get_link.close'\n                            defaultMessage='Close'\n                        />\n                    </button>\n                    {copyLink}\n                    {copyLinkConfirm}\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport ModalStore from 'stores/modal_store.jsx';\nimport Constants from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\nimport GetLinkModal from 'components/get_link_modal';\n\nexport default class GetPublicLinkModal extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * Public link of the file\n         */\n        link: PropTypes.string,\n\n        actions: PropTypes.shape({\n\n            /**\n             * An action to get public link\n             */\n            getFilePublicLink: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    static defaultProps = {\n        link: '',\n    }\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            show: false,\n            fileId: '',\n        };\n    }\n\n    componentWillUnmount() {\n        ModalStore.removeModalListener(Constants.ActionTypes.TOGGLE_GET_PUBLIC_LINK_MODAL, this.handleToggle);\n    }\n\n    componentDidMount() {\n        ModalStore.addModalListener(Constants.ActionTypes.TOGGLE_GET_PUBLIC_LINK_MODAL, this.handleToggle);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.state.show && !prevState.show) {\n            this.props.actions.getFilePublicLink(this.state.fileId);\n        }\n    }\n\n    handleToggle = (value, args) => {\n        this.setState({\n            show: value,\n            fileId: args.fileId,\n        });\n    }\n\n    onHide = () => {\n        this.setState({\n            show: false,\n        });\n    }\n\n    render() {\n        return (\n            <GetLinkModal\n                show={this.state.show}\n                onHide={this.onHide}\n                title={Utils.localizeMessage('get_public_link_modal.title', 'Copy Public Link')}\n                helpText={Utils.localizeMessage('get_public_link_modal.help', 'The link below allows anyone to see this file without being registered on this server.')}\n                link={this.props.link}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {getFilePublicLink} from 'mattermost-redux/actions/files';\nimport * as Selectors from 'mattermost-redux/selectors/entities/files';\n\nimport GetPublicLinkModal from './get_public_link_modal.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        link: Selectors.getFilePublicLink(state).link,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            getFilePublicLink,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(GetPublicLinkModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {Channel} from 'mattermost-redux/types/channels';\n\nimport ModalStore from 'stores/modal_store.jsx';\nimport Constants from 'utils/constants';\nimport ConfirmModal from 'components/confirm_modal';\n\ntype State = {\n    show: boolean;\n    channel?: Channel;\n};\n\ntype Props = {\n    actions: {\n        leaveChannel: (channelId: any) => any;\n    };\n}\n\nexport default class LeavePrivateChannelModal extends React.Component<Props, State> {\n    constructor(props: Props) {\n        super(props);\n\n        this.state = {\n            show: false\n        };\n    }\n\n    componentDidMount() {\n        ModalStore.addModalListener(Constants.ActionTypes.TOGGLE_LEAVE_PRIVATE_CHANNEL_MODAL, this.handleToggle);\n    }\n\n    componentWillUnmount() {\n        ModalStore.removeModalListener(Constants.ActionTypes.TOGGLE_LEAVE_PRIVATE_CHANNEL_MODAL, this.handleToggle);\n    }\n\n    handleKeyPress = (e: KeyboardEvent) => {\n        if (e.key === 'Enter' && this.state.show) {\n            this.handleSubmit();\n        }\n    };\n\n    handleSubmit = () => {\n        const {actions} = this.props;\n        const {channel} = this.state;\n\n        if (channel) {\n            const channelId = channel.id;\n            actions.leaveChannel(channelId).then((result: {data: boolean}) => {\n                if (result.data) {\n                    this.handleHide();\n                }\n            });\n        }\n    };\n\n    handleToggle = (value: Channel): void => {\n        this.setState({\n            channel: value,\n            show: value !== null,\n        });\n    };\n\n    handleHide = () => {\n        this.setState({\n            show: false\n        });\n    };\n\n    render() {\n        let title;\n        let message;\n        if (this.state.channel && this.state.channel.display_name) {\n            title = (\n                <FormattedMessage\n                    id='leave_private_channel_modal.title'\n                    defaultMessage='Leave Private Channel {channel}'\n                    values={{\n                        channel: <b>{this.state.channel.display_name}</b>,\n                    }}\n                />\n            );\n\n            message = (\n                <FormattedMessage\n                    id='leave_private_channel_modal.message'\n                    defaultMessage='Are you sure you wish to leave the private channel {channel}? You must be re-invited in order to re-join this channel in the future.'\n                    values={{\n                        channel: <b>{this.state.channel.display_name}</b>,\n                    }}\n                />\n            );\n        }\n\n        const buttonClass = 'btn btn-danger';\n        const button = (\n            <FormattedMessage\n                id='leave_private_channel_modal.leave'\n                defaultMessage='Yes, leave channel'\n            />\n        );\n\n        return (\n            <ConfirmModal\n                show={this.state.show}\n                title={title}\n                message={message}\n                confirmButtonClass={buttonClass}\n                confirmButtonText={button}\n                onConfirm={this.handleSubmit}\n                onCancel={this.handleHide}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch} from 'redux';\n\nimport {GenericAction} from 'mattermost-redux/types/actions';\n\nimport {leaveChannel} from 'actions/views/channel';\n\nimport LeavePrivateChannelModal from './leave_private_channel_modal';\n\nfunction mapDispatchToProps(dispatch: Dispatch<GenericAction>) {\n    return {\n        actions: bindActionCreators({\n            leaveChannel,\n        }, dispatch),\n    };\n}\n\nexport default connect(null, mapDispatchToProps)(LeavePrivateChannelModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport {Preferences} from 'mattermost-redux/constants';\n\nimport ConfirmModal from 'components/confirm_modal';\nimport {toTitleCase} from 'utils/utils.jsx';\nimport {UserStatuses} from 'utils/constants';\nimport {t} from 'utils/i18n';\n\nexport default class ResetStatusModal extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * The user's preference for whether their status is automatically reset\n         */\n        autoResetPref: PropTypes.string,\n\n        /*\n         * Props value is used to update currentUserStatus\n         */\n        currentUserStatus: PropTypes.string,\n\n        /*\n         * Props value is used to reset status from status_dropdown\n         */\n        newStatus: PropTypes.string,\n\n        /**\n         * Function called when modal is dismissed\n         */\n        onHide: PropTypes.func,\n        actions: PropTypes.shape({\n\n            /*\n             * Function to get and then reset the user's status if needed\n             */\n            autoResetStatus: PropTypes.func.isRequired,\n\n            /*\n             * Function to set the status for a user\n             */\n            setStatus: PropTypes.func.isRequired,\n\n            /*\n             * Function to save user preferences\n             */\n            savePreferences: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            show: false,\n            currentUserStatus: {},\n            newStatus: props.newStatus || 'online',\n        };\n    }\n\n    componentDidMount() {\n        this.props.actions.autoResetStatus().then(\n            (status) => {\n                const statusIsManual = status.manual;\n                const autoResetPrefNotSet = this.props.autoResetPref === '';\n\n                this.setState({\n                    currentUserStatus: status, // Set in state until status refactor where we store 'manual' field in redux\n                    show: Boolean(status.status === UserStatuses.OUT_OF_OFFICE || (statusIsManual && autoResetPrefNotSet)),\n                });\n            }\n        );\n    }\n\n    hideModal = () => {\n        this.setState({show: false});\n    };\n\n    onConfirm = (checked) => {\n        this.hideModal();\n\n        const newStatus = {...this.state.currentUserStatus};\n        newStatus.status = this.state.newStatus;\n        this.props.actions.setStatus(newStatus);\n\n        if (checked) {\n            const pref = {category: Preferences.CATEGORY_AUTO_RESET_MANUAL_STATUS, user_id: newStatus.user_id, name: newStatus.user_id, value: 'true'};\n            this.props.actions.savePreferences(pref.user_id, [pref]);\n        }\n    };\n\n    onCancel = (checked) => {\n        this.hideModal();\n\n        if (checked) {\n            const status = {...this.state.currentUserStatus};\n            const pref = {category: Preferences.CATEGORY_AUTO_RESET_MANUAL_STATUS, user_id: status.user_id, name: status.user_id, value: 'false'};\n            this.props.actions.savePreferences(pref.user_id, [pref]);\n        }\n    };\n\n    renderModalMessage = () => {\n        if (this.props.currentUserStatus === UserStatuses.OUT_OF_OFFICE) {\n            return (\n                <FormattedMessage\n                    id={`modal.manual_status.auto_responder.message_${this.state.newStatus}`}\n                    defaultMessage='Would you like to switch your status to \"{status}\" and disable Automatic Replies?'\n                    values={{\n                        status: toTitleCase(this.state.newStatus),\n                    }}\n                />\n            );\n        }\n\n        return (\n            <FormattedMessage\n                id={`modal.manual_status.message_${this.state.newStatus}`}\n                defaultMessage='Would you like to switch your status to \"{status}\"?'\n                values={{\n                    status: toTitleCase(this.state.newStatus),\n                }}\n            />\n        );\n    };\n\n    render() {\n        const userStatus = this.state.currentUserStatus.status || '';\n        const userStatusId = 'modal.manual_status.title_' + userStatus;\n        const manualStatusTitle = (\n            <FormattedMessage\n                id={userStatusId}\n                defaultMessage='Your Status is Set to \"{status}\"'\n                values={{\n                    status: toTitleCase(userStatus),\n                }}\n            />\n        );\n\n        const manualStatusMessage = this.renderModalMessage();\n\n        const manualStatusButton = (\n            <FormattedMessage\n                id={`modal.manual_status.button_${this.state.newStatus}`}\n                defaultMessage='Yes, set my status to \"{status}\"'\n                values={{\n                    status: toTitleCase(this.state.newStatus),\n                }}\n            />\n        );\n        const manualStatusId = 'modal.manual_status.cancel_' + userStatus;\n        const manualStatusCancel = (\n            <FormattedMessage\n                id={manualStatusId}\n                defaultMessage='No, keep it as \"{status}\"'\n                values={{\n                    status: toTitleCase(userStatus),\n                }}\n            />\n        );\n\n        const manualStatusCheckbox = (\n            <FormattedMessage\n                id='modal.manual_status.ask'\n                defaultMessage='Do not ask me again'\n            />\n        );\n\n        const showCheckbox = this.props.currentUserStatus !== UserStatuses.OUT_OF_OFFICE;\n\n        return (\n            <ConfirmModal\n                show={this.state.show}\n                title={manualStatusTitle}\n                message={manualStatusMessage}\n                confirmButtonText={manualStatusButton}\n                onConfirm={this.onConfirm}\n                cancelButtonText={manualStatusCancel}\n                onCancel={this.onCancel}\n                onExited={this.props.onHide}\n                showCheckbox={showCheckbox}\n                checkboxText={manualStatusCheckbox}\n            />\n        );\n    }\n}\n\nt('modal.manual_status.auto_responder.message_');\nt('modal.manual_status.auto_responder.message_away');\nt('modal.manual_status.auto_responder.message_dnd');\nt('modal.manual_status.auto_responder.message_offline');\nt('modal.manual_status.auto_responder.message_online');\nt('modal.manual_status.button_');\nt('modal.manual_status.button_away');\nt('modal.manual_status.button_dnd');\nt('modal.manual_status.button_offline');\nt('modal.manual_status.button_online');\nt('modal.manual_status.cancel_');\nt('modal.manual_status.cancel_away');\nt('modal.manual_status.cancel_dnd');\nt('modal.manual_status.cancel_offline');\nt('modal.manual_status.cancel_ooo');\nt('modal.manual_status.message_');\nt('modal.manual_status.message_away');\nt('modal.manual_status.message_dnd');\nt('modal.manual_status.message_offline');\nt('modal.manual_status.message_online');\nt('modal.manual_status.title_');\nt('modal.manual_status.title_away');\nt('modal.manual_status.title_dnd');\nt('modal.manual_status.title_offline');\nt('modal.manual_status.title_ooo');\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\nimport {setStatus} from 'mattermost-redux/actions/users';\nimport {Preferences} from 'mattermost-redux/constants';\nimport {get} from 'mattermost-redux/selectors/entities/preferences';\nimport {getStatusForUserId} from 'mattermost-redux/selectors/entities/users';\n\nimport {autoResetStatus} from 'actions/user_actions.jsx';\n\nimport ResetStatusModal from './reset_status_modal.jsx';\n\nfunction mapStateToProps(state) {\n    const {currentUserId} = state.entities.users;\n    return {\n        autoResetPref: get(state, Preferences.CATEGORY_AUTO_RESET_MANUAL_STATUS, currentUserId, ''),\n        currentUserStatus: getStatusForUserId(state, currentUserId),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            autoResetStatus,\n            setStatus,\n            savePreferences,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ResetStatusModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {defineMessages, injectIntl} from 'react-intl';\n\nimport ModalStore from 'stores/modal_store.jsx';\nimport Constants from 'utils/constants';\nimport {intlShape} from 'utils/react_intl';\nimport {t} from 'utils/i18n';\n\nconst allShortcuts = defineMessages({\n    mainHeader: {\n        default: {\n            id: t('shortcuts.header'),\n            defaultMessage: 'Keyboard Shortcuts\\tCtrl|/',\n        },\n        mac: {\n            id: t('shortcuts.header.mac'),\n            defaultMessage: 'Keyboard Shortcuts\\t|/',\n        },\n    },\n    navHeader: {\n        id: t('shortcuts.nav.header'),\n        defaultMessage: 'Navigation',\n    },\n    navPrev: {\n        default: {\n            id: t('shortcuts.nav.prev'),\n            defaultMessage: 'Previous channel:\\tAlt|Up',\n        },\n        mac: {\n            id: t('shortcuts.nav.prev.mac'),\n            defaultMessage: 'Previous channel:\\t|Up',\n        },\n    },\n    navNext: {\n        default: {\n            id: t('shortcuts.nav.next'),\n            defaultMessage: 'Next channel:\\tAlt|Down',\n        },\n        mac: {\n            id: t('shortcuts.nav.next.mac'),\n            defaultMessage: 'Next channel:\\t|Down',\n        },\n    },\n    navUnreadPrev: {\n        default: {\n            id: t('shortcuts.nav.unread_prev'),\n            defaultMessage: 'Previous unread channel:\\tAlt|Shift|Up',\n        },\n        mac: {\n            id: t('shortcuts.nav.unread_prev.mac'),\n            defaultMessage: 'Previous unread channel:\\t|Shift|Up',\n        },\n    },\n    navUnreadNext: {\n        default: {\n            id: t('shortcuts.nav.unread_next'),\n            defaultMessage: 'Next unread channel:\\tAlt|Shift|Down',\n        },\n        mac: {\n            id: t('shortcuts.nav.unread_next.mac'),\n            defaultMessage: 'Next unread channel:\\t|Shift|Down',\n        },\n    },\n    teamNavPrev: {\n        default: {\n            id: t('shortcuts.team_nav.prev'),\n            defaultMessage: 'Previous team:\\tCtrl|Alt|Up',\n        },\n        mac: {\n            id: t('shortcuts.team_nav.prev.mac'),\n            defaultMessage: 'Previous team:\\t||Up',\n        },\n    },\n    teamNavNext: {\n        default: {\n            id: t('shortcuts.team_nav.next'),\n            defaultMessage: 'Next team:\\tCtrl|Alt|Down',\n        },\n        mac: {\n            id: t('shortcuts.team_nav.next.mac'),\n            defaultMessage: 'Next team:\\t||Down',\n        },\n    },\n    teamNavSwitcher: {\n        default: {\n            id: t('shortcuts.team_nav.switcher'),\n            defaultMessage: 'Switch to a specific team:\\tCtrl|Alt|[1-9]',\n        },\n        mac: {\n            id: t('shortcuts.team_nav.switcher.mac'),\n            defaultMessage: 'Switch to a specific team:\\t||[1-9]',\n        },\n    },\n    navSwitcher: {\n        default: {\n            id: t('shortcuts.nav.switcher'),\n            defaultMessage: 'Quick channel switcher:\\tCtrl|K',\n        },\n        mac: {\n            id: t('shortcuts.nav.switcher.mac'),\n            defaultMessage: 'Quick channel switcher:\\t|K',\n        },\n    },\n    navDMMenu: {\n        default: {\n            id: t('shortcuts.nav.direct_messages_menu'),\n            defaultMessage: 'Direct messages menu:\\tCtrl|Shift|K',\n        },\n        mac: {\n            id: t('shortcuts.nav.direct_messages_menu.mac'),\n            defaultMessage: 'Direct messages menu:\\t|Shift|K',\n        },\n    },\n    navSettings: {\n        default: {\n            id: t('shortcuts.nav.settings'),\n            defaultMessage: 'Account settings:\\tCtrl|Shift|A',\n        },\n        mac: {\n            id: t('shortcuts.nav.settings.mac'),\n            defaultMessage: 'Account settings:\\t|Shift|A',\n        },\n    },\n    navMentions: {\n        default: {\n            id: t('shortcuts.nav.recent_mentions'),\n            defaultMessage: 'Recent mentions:\\tCtrl|Shift|M',\n        },\n        mac: {\n            id: t('shortcuts.nav.recent_mentions.mac'),\n            defaultMessage: 'Recent mentions:\\t|Shift|M',\n        },\n    },\n    navFocusCenter: {\n        default: {\n            id: t('shortcuts.nav.focus_center'),\n            defaultMessage: 'Set focus to input field:\\tCtrl|Shift|L',\n        },\n        mac: {\n            id: t('shortcuts.nav.focus_center.mac'),\n            defaultMessage: 'Set focus to input field:\\t|Shift|L',\n        },\n    },\n    navOpenCloseSidebar: {\n        default: {\n            id: t('shortcuts.nav.open_close_sidebar'),\n            defaultMessage: 'Open or close the right sidebar\\tCtrl|.',\n        },\n        mac: {\n            id: t('shortcuts.nav.open_close_sidebar.mac'),\n            defaultMessage: 'Open or close the right sidebar\\t|.',\n        }\n    },\n    msgHeader: {\n        id: t('shortcuts.msgs.header'),\n        defaultMessage: 'Messages',\n    },\n    msgInputHeader: {\n        id: t('shortcuts.msgs.input.header'),\n        defaultMessage: 'Works inside an empty input field',\n    },\n    msgEdit: {\n        id: t('shortcuts.msgs.edit'),\n        defaultMessage: 'Edit last message in channel:\\tUp',\n    },\n    msgReply: {\n        id: t('shortcuts.msgs.reply'),\n        defaultMessage: 'Reply to last message in channel:\\tShift|Up',\n    },\n    msgReprintPrev: {\n        default: {\n            id: t('shortcuts.msgs.reprint_prev'),\n            defaultMessage: 'Reprint previous message:\\tCtrl|Up',\n        },\n        mac: {\n            id: t('shortcuts.msgs.reprint_prev.mac'),\n            defaultMessage: 'Reprint previous message:\\t|Up',\n        },\n    },\n    msgReprintNext: {\n        default: {\n            id: t('shortcuts.msgs.reprint_next'),\n            defaultMessage: 'Reprint next message:\\tCtrl|Down',\n        },\n        mac: {\n            id: t('shortcuts.msgs.reprint_next.mac'),\n            defaultMessage: 'Reprint next message:\\t|Down',\n        },\n    },\n    msgCompHeader: {\n        id: t('shortcuts.msgs.comp.header'),\n        defaultMessage: 'Autocomplete',\n    },\n    msgCompUsername: {\n        id: t('shortcuts.msgs.comp.username'),\n        defaultMessage: 'Username:\\t@|[a-z]|Tab',\n    },\n    msgCompChannel: {\n        id: t('shortcuts.msgs.comp.channel'),\n        defaultMessage: 'Channel:\\t~|[a-z]|Tab',\n    },\n    msgCompEmoji: {\n        id: t('shortcuts.msgs.comp.emoji'),\n        defaultMessage: 'Emoji:\\t:|[a-z]|Tab',\n    },\n    msgLastReaction: {\n        default: {\n            id: t('shortcuts.msgs.comp.last_reaction'),\n            defaultMessage: 'React to last message: \\tCtrl|Shift|\\u29F5',\n        },\n        mac: {\n            id: t('shortcuts.msgs.comp.last_reaction.mac'),\n            defaultMessage: 'React to last message: \\t|Shift|\\u29F5',\n        },\n    },\n    filesHeader: {\n        id: t('shortcuts.files.header'),\n        defaultMessage: 'Files',\n    },\n    filesUpload: {\n        default: {\n            id: t('shortcuts.files.upload'),\n            defaultMessage: 'Upload files:\\tCtrl|U',\n        },\n        mac: {\n            id: t('shortcuts.files.upload.mac'),\n            defaultMessage: 'Upload files:\\t|U',\n        },\n    },\n    browserHeader: {\n        id: t('shortcuts.browser.header'),\n        defaultMessage: 'Built-in Browser Commands',\n    },\n    browserChannelPrev: {\n        default: {\n            id: t('shortcuts.browser.channel_prev'),\n            defaultMessage: 'Back in history:\\tAlt|Left',\n        },\n        mac: {\n            id: t('shortcuts.browser.channel_prev.mac'),\n            defaultMessage: 'Back in history:\\t|[',\n        },\n    },\n    browserChannelNext: {\n        default: {\n            id: t('shortcuts.browser.channel_next'),\n            defaultMessage: 'Forward in history:\\tAlt|Right',\n        },\n        mac: {\n            id: t('shortcuts.browser.channel_next.mac'),\n            defaultMessage: 'Forward in history:\\t|]',\n        },\n    },\n    browserFontIncrease: {\n        default: {\n            id: t('shortcuts.browser.font_increase'),\n            defaultMessage: 'Zoom in:\\tCtrl|+',\n        },\n        mac: {\n            id: t('shortcuts.browser.font_increase.mac'),\n            defaultMessage: 'Zoom in:\\t|+',\n        },\n    },\n    browserFontDecrease: {\n        default: {\n            id: t('shortcuts.browser.font_decrease'),\n            defaultMessage: 'Zoom out:\\tCtrl|-',\n        },\n        mac: {\n            id: t('shortcuts.browser.font_decrease.mac'),\n            defaultMessage: 'Zoom out:\\t|-',\n        },\n    },\n    browserInputHeader: {\n        id: t('shortcuts.browser.input.header'),\n        defaultMessage: 'Works inside an input field',\n    },\n    browserHighlightPrev: {\n        id: t('shortcuts.browser.highlight_prev'),\n        defaultMessage: 'Highlight text to the previous line:\\tShift|Up',\n    },\n    browserHighlightNext: {\n        id: t('shortcuts.browser.highlight_next'),\n        defaultMessage: 'Highlight text to the next line:\\tShift|Down',\n    },\n    browserNewline: {\n        id: t('shortcuts.browser.newline'),\n        defaultMessage: 'Create a new line:\\tShift|Enter',\n    },\n    info: {\n        id: t('shortcuts.info'),\n        defaultMessage: 'Begin a message with / for a list of all the commands at your disposal.',\n    },\n});\n\nclass ShortcutsModal extends React.PureComponent {\n    static propTypes = {\n        intl: intlShape.isRequired,\n        isMac: PropTypes.bool.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            show: false,\n        };\n    }\n\n    componentDidMount() {\n        ModalStore.addModalListener(Constants.ActionTypes.TOGGLE_SHORTCUTS_MODAL, this.handleToggle);\n    }\n\n    componentWillUnmount() {\n        ModalStore.removeModalListener(Constants.ActionTypes.TOGGLE_SHORTCUTS_MODAL, this.handleToggle);\n    }\n\n    handleToggle = () => {\n        //toggles the state of shortcut dialog\n        this.setState({\n            show: !this.state.show,\n        });\n    }\n\n    handleHide = () => {\n        this.setState({show: false});\n    }\n\n    getShortcuts() {\n        const {isMac} = this.props;\n        const shortcuts = {};\n        Object.keys(allShortcuts).forEach((s) => {\n            if (isMac && allShortcuts[s].mac) {\n                shortcuts[s] = allShortcuts[s].mac;\n            } else if (!isMac && allShortcuts[s].default) {\n                shortcuts[s] = allShortcuts[s].default;\n            } else {\n                shortcuts[s] = allShortcuts[s];\n            }\n        });\n\n        return shortcuts;\n    }\n\n    render() {\n        const shortcuts = this.getShortcuts();\n        const {formatMessage} = this.props.intl;\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal shortcuts-modal'\n                show={this.state.show}\n                onHide={this.handleHide}\n                onExited={this.handleHide}\n                role='dialog'\n                aria-labelledby='shortcutsModalLabel'\n            >\n                <div className='shortcuts-content'>\n                    <Modal.Header closeButton={true}>\n                        <Modal.Title\n                            componentClass='h1'\n                            id='shortcutsModalLabel'\n                        >\n                            <strong>{renderShortcut(formatMessage(shortcuts.mainHeader))}</strong>\n                        </Modal.Title>\n                    </Modal.Header>\n                    <Modal.Body>\n                        <div className='row'>\n                            <div className='col-sm-4'>\n                                <div className='section'>\n                                    <div>\n                                        <h4 className='section-title'><strong>{formatMessage(shortcuts.navHeader)}</strong></h4>\n                                        {renderShortcut(formatMessage(shortcuts.navPrev))}\n                                        {renderShortcut(formatMessage(shortcuts.navNext))}\n                                        {renderShortcut(formatMessage(shortcuts.navUnreadPrev))}\n                                        {renderShortcut(formatMessage(shortcuts.navUnreadNext))}\n                                        {renderShortcut(formatMessage(shortcuts.teamNavPrev))}\n                                        {renderShortcut(formatMessage(shortcuts.teamNavNext))}\n                                        {renderShortcut(formatMessage(shortcuts.teamNavSwitcher))}\n                                        {renderShortcut(formatMessage(shortcuts.navSwitcher))}\n                                        {renderShortcut(formatMessage(shortcuts.navDMMenu))}\n                                        {renderShortcut(formatMessage(shortcuts.navSettings))}\n                                        {renderShortcut(formatMessage(shortcuts.navMentions))}\n                                        {renderShortcut(formatMessage(shortcuts.navFocusCenter))}\n                                        {renderShortcut(formatMessage(shortcuts.navOpenCloseSidebar))}\n                                    </div>\n                                </div>\n                            </div>\n                            <div className='col-sm-4'>\n                                <div className='section'>\n                                    <div>\n                                        <h4 className='section-title'><strong>{formatMessage(shortcuts.msgHeader)}</strong></h4>\n                                        <span><strong>{formatMessage(shortcuts.msgInputHeader)}</strong></span>\n                                        <div className='subsection'>\n                                            {renderShortcut(formatMessage(shortcuts.msgEdit))}\n                                            {renderShortcut(formatMessage(shortcuts.msgReply))}\n                                            {renderShortcut(formatMessage(shortcuts.msgLastReaction))}\n                                            {renderShortcut(formatMessage(shortcuts.msgReprintPrev))}\n                                            {renderShortcut(formatMessage(shortcuts.msgReprintNext))}\n                                        </div>\n                                        <span><strong>{formatMessage(shortcuts.msgCompHeader)}</strong></span>\n                                        <div className='subsection'>\n                                            {renderShortcut(formatMessage(shortcuts.msgCompUsername))}\n                                            {renderShortcut(formatMessage(shortcuts.msgCompChannel))}\n                                            {renderShortcut(formatMessage(shortcuts.msgCompEmoji))}\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                            <div className='col-sm-4'>\n                                <div className='section'>\n                                    <div>\n                                        <h4 className='section-title'><strong>{formatMessage(shortcuts.filesHeader)}</strong></h4>\n                                        {renderShortcut(formatMessage(shortcuts.filesUpload))}\n                                    </div>\n                                    <div className='section--lower'>\n                                        <h4 className='section-title'><strong>{formatMessage(shortcuts.browserHeader)}</strong></h4>\n                                        {renderShortcut(formatMessage(shortcuts.browserChannelPrev))}\n                                        {renderShortcut(formatMessage(shortcuts.browserChannelNext))}\n                                        {renderShortcut(formatMessage(shortcuts.browserFontIncrease))}\n                                        {renderShortcut(formatMessage(shortcuts.browserFontDecrease))}\n                                        <span><strong>{formatMessage(shortcuts.browserInputHeader)}</strong></span>\n                                        <div className='subsection'>\n                                            {renderShortcut(formatMessage(shortcuts.browserHighlightPrev))}\n                                            {renderShortcut(formatMessage(shortcuts.browserHighlightNext))}\n                                            {renderShortcut(formatMessage(shortcuts.browserNewline))}\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div className='info__label'>{formatMessage(shortcuts.info)}</div>\n                    </Modal.Body>\n                </div>\n            </Modal>\n        );\n    }\n}\n\nfunction renderShortcut(text) {\n    if (!text) {\n        return null;\n    }\n\n    const shortcut = text.split('\\t');\n    const description = <span>{shortcut[0]}</span>;\n\n    let keys = null;\n    if (shortcut.length > 1) {\n        keys = shortcut[1].split('|').map((key) => (\n            <span\n                className='shortcut-key'\n                key={key}\n            >\n                {key}\n            </span>\n        ));\n    }\n\n    return (\n        <div className='shortcut-line'>\n            {description}\n            {keys}\n        </div>\n    );\n}\n\nexport default injectIntl(ShortcutsModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport fileOverlayImage from 'images/filesOverlay.png';\nimport overlayLogoImage from 'images/logoWhite.png';\n\ntype Props = {\n    overlayType: string;\n}\n\nconst FileUploadOverlay: React.FC<Props> = (props: Props) => {\n    let overlayClass = 'file-overlay hidden';\n    if (props.overlayType === 'right') {\n        overlayClass += ' right-file-overlay';\n    } else if (props.overlayType === 'center') {\n        overlayClass += ' center-file-overlay';\n    }\n\n    return (\n        <div className={overlayClass}>\n            <div className='overlay__indent'>\n                <div className='overlay__circle'>\n                    <img\n                        className='overlay__files'\n                        src={fileOverlayImage}\n                        alt='Files'\n                    />\n                    <span>\n                        <FormattedMessage\n                            id='generic_icons.upload'\n                            defaultMessage='Upload Icon'\n                        >\n                            {(title) => (\n                                <i\n                                    className='fa fa-upload'\n                                    title={title as string}\n                                />\n                            )}\n                        </FormattedMessage>\n                        <FormattedMessage\n                            id='upload_overlay.info'\n                            defaultMessage='Drop a file to upload it.'\n                        />\n                    </span>\n                    <img\n                        className='overlay__logo'\n                        src={overlayLogoImage}\n                        width='100'\n                        alt='Logo'\n                    />\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default FileUploadOverlay;","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport default class DelayedAction {\n    private action: Function;\n    private timer: number;\n\n    public constructor(action: Function) {\n        this.action = action;\n\n        this.timer = -1;\n\n        // bind fire since it doesn't get passed the correct this value with setTimeout\n        this.fire = this.fire.bind(this);\n    }\n\n    public fire() {\n        this.action();\n\n        this.timer = -1;\n    }\n\n    public fireAfter(timeout: number) {\n        if (this.timer >= 0) {\n            window.clearTimeout(this.timer);\n        }\n\n        this.timer = window.setTimeout(this.fire, timeout);\n    }\n\n    public cancel() {\n        window.clearTimeout(this.timer);\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport function connectionErrorCount(state) {\n    return state.views.system.websocketConnectionErrorCount;\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {Client4} from 'mattermost-redux/client';\nimport {unfavoriteChannel} from 'mattermost-redux/actions/channels';\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\nimport {getCurrentChannel, getRedirectChannelNameForTeam} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getCurrentRelativeTeamUrl, getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {IntegrationTypes} from 'mattermost-redux/action_types';\nimport {isFavoriteChannel} from 'mattermost-redux/utils/channel_utils';\n\nimport {openModal} from 'actions/views/modals';\nimport * as GlobalActions from 'actions/global_actions.jsx';\nimport * as PostActions from 'actions/post_actions.jsx';\n\nimport {isUrlSafe, getSiteURL} from 'utils/url';\nimport {localizeMessage, getUserIdFromChannelName} from 'utils/utils.jsx';\nimport * as UserAgent from 'utils/user_agent';\nimport {Constants, ModalIdentifiers} from 'utils/constants';\nimport {browserHistory} from 'utils/browser_history';\n\nimport UserSettingsModal from 'components/user_settings/modal';\n\nexport function executeCommand(message, args) {\n    return async (dispatch, getState) => {\n        const state = getState();\n\n        let msg = message;\n\n        let cmdLength = msg.indexOf(' ');\n        if (cmdLength < 0) {\n            cmdLength = msg.length;\n        }\n        const cmd = msg.substring(0, cmdLength).toLowerCase();\n        msg = cmd + ' ' + msg.substring(cmdLength, msg.length).trim();\n\n        switch (cmd) {\n        case '/search':\n            dispatch(PostActions.searchForTerm(msg.substring(cmdLength + 1, msg.length)));\n            return {data: true};\n        case '/shortcuts':\n            if (UserAgent.isMobile()) {\n                const error = {message: localizeMessage('create_post.shortcutsNotSupported', 'Keyboard shortcuts are not supported on your device')};\n                return {error};\n            }\n\n            GlobalActions.toggleShortcutsModal();\n            return {data: true};\n        case '/leave': {\n        // /leave command not supported in reply threads.\n            if (args.channel_id && (args.root_id || args.parent_id)) {\n                GlobalActions.sendEphemeralPost('/leave is not supported in reply threads. Use it in the center channel instead.', args.channel_id, args.parent_id);\n                return {data: true};\n            }\n            const channel = getCurrentChannel(state);\n            if (channel.type === Constants.PRIVATE_CHANNEL) {\n                GlobalActions.showLeavePrivateChannelModal(channel);\n                return {data: true};\n            }\n            if (\n                channel.type === Constants.DM_CHANNEL ||\n                channel.type === Constants.GM_CHANNEL\n            ) {\n                const currentUserId = getCurrentUserId(state);\n                let name;\n                let category;\n                if (channel.type === Constants.DM_CHANNEL) {\n                    name = getUserIdFromChannelName(channel);\n                    category = Constants.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW;\n                } else {\n                    name = channel.id;\n                    category = Constants.Preferences.CATEGORY_GROUP_CHANNEL_SHOW;\n                }\n                const currentTeamId = getCurrentTeamId(state);\n                const redirectChannel = getRedirectChannelNameForTeam(state, currentTeamId);\n                const teamUrl = getCurrentRelativeTeamUrl(state);\n                browserHistory.push(`${teamUrl}/channels/${redirectChannel}`);\n\n                dispatch(savePreferences(currentUserId, [{category, name, user_id: currentUserId, value: 'false'}]));\n                if (isFavoriteChannel(channel)) {\n                    dispatch(unfavoriteChannel(channel.id));\n                }\n\n                return {data: true};\n            }\n            break;\n        }\n        case '/settings':\n            dispatch(openModal({modalId: ModalIdentifiers.USER_SETTINGS, dialogType: UserSettingsModal}));\n            return {data: true};\n        case '/collapse':\n        case '/expand':\n            dispatch(PostActions.resetEmbedVisibility());\n        }\n\n        let data;\n        try {\n            data = await Client4.executeCommand(msg, args);\n        } catch (err) {\n            return {error: err};\n        }\n\n        const hasGotoLocation = data.goto_location && isUrlSafe(data.goto_location);\n\n        if (msg.trim() === '/logout') {\n            GlobalActions.emitUserLoggedOutEvent(hasGotoLocation ? data.goto_location : '/');\n            return {data: true};\n        }\n\n        if (data.trigger_id) {\n            dispatch({type: IntegrationTypes.RECEIVED_DIALOG_TRIGGER_ID, data: data.trigger_id});\n        }\n\n        if (hasGotoLocation) {\n            if (data.goto_location.startsWith('/')) {\n                browserHistory.push(data.goto_location);\n            } else if (data.goto_location.startsWith(getSiteURL())) {\n                browserHistory.push(data.goto_location.substr(getSiteURL().length));\n            } else {\n                window.open(data.goto_location);\n            }\n        }\n\n        return {data: true};\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport function runMessageWillBePostedHooks(originalPost) {\n    return async (dispatch, getState) => {\n        const hooks = getState().plugins.components.MessageWillBePosted;\n        if (!hooks || hooks.length === 0) {\n            return {data: originalPost};\n        }\n\n        let post = originalPost;\n\n        for (const hook of hooks) {\n            const result = await hook.hook(post); // eslint-disable-line no-await-in-loop\n\n            if (result) {\n                if (result.error) {\n                    return {\n                        error: result.error,\n                    };\n                }\n\n                post = result.post;\n            }\n        }\n\n        return {data: post};\n    };\n}\n\nexport function runSlashCommandWillBePostedHooks(originalMessage, originalArgs) {\n    return async (dispatch, getState) => {\n        const hooks = getState().plugins.components.SlashCommandWillBePosted;\n        if (!hooks || hooks.length === 0) {\n            return {data: {message: originalMessage, args: originalArgs}};\n        }\n\n        let message = originalMessage;\n        let args = originalArgs;\n\n        for (const hook of hooks) {\n            const result = await hook.hook(message, args); // eslint-disable-line no-await-in-loop\n\n            if (result) {\n                if (result.error) {\n                    return {\n                        error: result.error,\n                    };\n                }\n\n                message = result.message;\n                args = result.args;\n            }\n        }\n\n        return {data: {message, args}};\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {createSelector} from 'reselect';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {\n    makeGetMessageInHistoryItem,\n    makeGetCommentCountForPost,\n    getPost,\n    getPostIdsInChannel,\n} from 'mattermost-redux/selectors/entities/posts';\nimport {getCustomEmojisByName} from 'mattermost-redux/selectors/entities/emojis';\nimport {\n    removeReaction,\n    addMessageIntoHistory,\n    moveHistoryIndexBack,\n    moveHistoryIndexForward,\n} from 'mattermost-redux/actions/posts';\nimport {Posts} from 'mattermost-redux/constants';\nimport {isPostPendingOrFailed} from 'mattermost-redux/utils/post_utils';\n\nimport * as PostActions from 'actions/post_actions.jsx';\nimport {executeCommand} from 'actions/command';\nimport {runMessageWillBePostedHooks, runSlashCommandWillBePostedHooks} from 'actions/hooks';\nimport {setGlobalItem, actionOnGlobalItemsWithPrefix} from 'actions/storage';\nimport EmojiMap from 'utils/emoji_map';\nimport {getPostDraft} from 'selectors/rhs';\n\nimport * as Utils from 'utils/utils.jsx';\nimport {Constants, StoragePrefixes} from 'utils/constants';\n\nexport function clearCommentDraftUploads() {\n    return actionOnGlobalItemsWithPrefix(StoragePrefixes.COMMENT_DRAFT, (key, value) => {\n        if (value) {\n            return {...value, uploadsInProgress: []};\n        }\n        return value;\n    });\n}\n\nexport function updateCommentDraft(rootId, draft) {\n    return setGlobalItem(`${StoragePrefixes.COMMENT_DRAFT}${rootId}`, draft);\n}\n\nexport function makeOnMoveHistoryIndex(rootId, direction) {\n    const getMessageInHistory = makeGetMessageInHistoryItem(Posts.MESSAGE_TYPES.COMMENT);\n\n    return () => (dispatch, getState) => {\n        const draft = getPostDraft(getState(), StoragePrefixes.COMMENT_DRAFT, rootId);\n        if (draft.message !== '' && draft.message !== getMessageInHistory(getState())) {\n            return;\n        }\n\n        if (direction === -1) {\n            dispatch(moveHistoryIndexBack(Posts.MESSAGE_TYPES.COMMENT));\n        } else if (direction === 1) {\n            dispatch(moveHistoryIndexForward(Posts.MESSAGE_TYPES.COMMENT));\n        }\n\n        const nextMessageInHistory = getMessageInHistory(getState());\n\n        dispatch(updateCommentDraft(rootId, {...draft, message: nextMessageInHistory}));\n    };\n}\n\nexport function submitPost(channelId, rootId, draft) {\n    return async (dispatch, getState) => {\n        const state = getState();\n\n        const userId = getCurrentUserId(state);\n\n        const time = Utils.getTimestamp();\n\n        let post = {\n            file_ids: [],\n            message: draft.message,\n            channel_id: channelId,\n            root_id: rootId,\n            parent_id: rootId,\n            pending_post_id: `${userId}:${time}`,\n            user_id: userId,\n            create_at: time,\n            metadata: {},\n            props: {...draft.props},\n        };\n\n        const hookResult = await dispatch(runMessageWillBePostedHooks(post));\n        if (hookResult.error) {\n            return {error: hookResult.error};\n        }\n\n        post = hookResult.data;\n\n        return dispatch(PostActions.createPost(post, draft.fileInfos));\n    };\n}\n\nexport function submitReaction(postId, action, emojiName) {\n    return (dispatch) => {\n        if (action === '+') {\n            dispatch(PostActions.addReaction(postId, emojiName));\n        } else if (action === '-') {\n            dispatch(removeReaction(postId, emojiName));\n        }\n    };\n}\n\nexport function submitCommand(channelId, rootId, draft) {\n    return async (dispatch, getState) => {\n        const state = getState();\n\n        const teamId = getCurrentTeamId(state);\n\n        let args = {\n            channel_id: channelId,\n            team_id: teamId,\n            root_id: rootId,\n            parent_id: rootId,\n        };\n\n        let {message} = draft;\n\n        const hookResult = await dispatch(runSlashCommandWillBePostedHooks(message, args));\n        if (hookResult.error) {\n            return {error: hookResult.error};\n        } else if (!hookResult.data.message && !hookResult.data.args) {\n            // do nothing with an empty return from a hook\n            return {};\n        }\n\n        message = hookResult.data.message;\n        args = hookResult.data.args;\n\n        const {error} = await dispatch(executeCommand(message, args));\n\n        if (error) {\n            if (error.sendMessage) {\n                return dispatch(submitPost(channelId, rootId, draft));\n            }\n            throw (error);\n        }\n\n        return {};\n    };\n}\n\nexport function makeOnSubmit(channelId, rootId, latestPostId) {\n    return (options = {}) => async (dispatch, getState) => {\n        const draft = getPostDraft(getState(), StoragePrefixes.COMMENT_DRAFT, rootId);\n        const {message} = draft;\n\n        dispatch(addMessageIntoHistory(message));\n\n        dispatch(updateCommentDraft(rootId, null));\n\n        const isReaction = Utils.REACTION_PATTERN.exec(message);\n\n        const emojis = getCustomEmojisByName(getState());\n        const emojiMap = new EmojiMap(emojis);\n\n        if (isReaction && emojiMap.has(isReaction[2])) {\n            dispatch(submitReaction(latestPostId, isReaction[1], isReaction[2]));\n        } else if (message.indexOf('/') === 0 && !options.ignoreSlash) {\n            await dispatch(submitCommand(channelId, rootId, draft));\n        } else {\n            dispatch(submitPost(channelId, rootId, draft));\n        }\n    };\n}\n\nfunction makeGetCurrentUsersLatestPost(channelId, rootId) {\n    return createSelector(\n        getCurrentUserId,\n        (state) => getPostIdsInChannel(state, channelId),\n        (state) => (id) => getPost(state, id),\n        (userId, postIds, getPostById) => {\n            let lastPost = null;\n\n            if (!postIds) {\n                return lastPost;\n            }\n\n            for (const id of postIds) {\n                const post = getPostById(id) || {};\n\n                // don't edit webhook posts, deleted posts, or system messages\n                if (\n                    post.user_id !== userId ||\n                    (post.props && post.props.from_webhook) ||\n                    post.state === Constants.POST_DELETED ||\n                    (post.type && post.type.startsWith(Constants.SYSTEM_MESSAGE_PREFIX)) ||\n                    isPostPendingOrFailed(post)\n                ) {\n                    continue;\n                }\n\n                if (rootId) {\n                    if (post.root_id === rootId || post.id === rootId) {\n                        lastPost = post;\n                        break;\n                    }\n                } else {\n                    lastPost = post;\n                    break;\n                }\n            }\n\n            return lastPost;\n        },\n    );\n}\n\nexport function makeOnEditLatestPost(channelId, rootId) {\n    const getCurrentUsersLatestPost = makeGetCurrentUsersLatestPost(channelId, rootId);\n    const getCommentCount = makeGetCommentCountForPost();\n\n    return () => (dispatch, getState) => {\n        const state = getState();\n\n        const lastPost = getCurrentUsersLatestPost(state);\n\n        if (!lastPost) {\n            return {data: false};\n        }\n\n        return dispatch(PostActions.setEditingPost(\n            lastPost.id,\n            getCommentCount(state, {post: lastPost}),\n            'reply_textbox',\n            Utils.localizeMessage('create_comment.commentTitle', 'Comment'),\n            true,\n        ));\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport function parseTable(html: string): HTMLTableElement | null {\n    const el = document.createElement('div');\n    el.innerHTML = html;\n    return el.querySelector('table');\n}\n\nexport function getTable(clipboardData: DataTransfer): HTMLTableElement | boolean {\n    if (Array.from(clipboardData.types).indexOf('text/html') === -1) {\n        return false;\n    }\n\n    const html = clipboardData.getData('text/html');\n\n    if (!(/<table/i).test(html)) {\n        return false;\n    }\n\n    const table = parseTable(html);\n    if (!table) {\n        return false;\n    }\n\n    return table;\n}\n\nexport function getPlainText(clipboardData: DataTransfer): string | boolean {\n    if (Array.from(clipboardData.types).indexOf('text/plain') === -1) {\n        return false;\n    }\n\n    const plainText = clipboardData.getData('text/plain');\n\n    return plainText;\n}\n\nexport function isGitHubCodeBlock(tableClassName: string): boolean {\n    const result = (/\\b(js|blob|diff)-./).test(tableClassName);\n    return result;\n}\n\nfunction columnText(column: Element): string {\n    const noBreakSpace = '\\u00A0';\n    const text = column.textContent == null ?\n        noBreakSpace : column.textContent.trim().replace(/\\|/g, '\\\\|').replace(/\\n/g, ' ');\n    return text;\n}\n\nfunction tableHeaders(row: HTMLTableRowElement): string[] {\n    return Array.from(row.querySelectorAll('td, th')).map(columnText);\n}\n\nexport function formatMarkdownTableMessage(table: HTMLTableElement, message?: string): string {\n    const rows = Array.from(table.querySelectorAll('tr'));\n\n    const headerRow = rows.shift();\n    const headers = headerRow ? tableHeaders(headerRow) : [];\n    const spacers = headers.map(() => '---');\n    const header = `|${headers.join(' | ')}|\\n|${spacers.join(' | ')}|\\n`;\n\n    const body = rows.map((row) => {\n        return `|${Array.from(row.querySelectorAll('td')).map(columnText).join(' | ')}|`;\n    }).join('\\n');\n\n    const formattedTable = `${header}${body}\\n`;\n\n    return message ? `${message}\\n\\n${formattedTable}` : formattedTable;\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class AttachmentIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.attach'\n                    defaultMessage='Attachment Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='18px'\n                            height='18px'\n                            viewBox='0 0 18 15'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g\n                                fill='inherit'\n                                fillRule='evenodd'\n                            >\n                                <g\n                                    transform='translate(-1029.000000, -954.000000)'\n                                    fillRule='nonzero'\n                                    fill='inherit'\n                                >\n                                    <g transform='translate(25.000000, 937.000000)'>\n                                        <g transform='translate(1004.000000, 17.000000)'>\n                                            <path d='M5.35,15.56 C3.98,15.56 2.61,15.039 1.567,13.997 C0.557,12.984 0,11.642 0,10.212 C0,8.783 0.557,7.44 1.566,6.429 L6.869,1.126 C8.371,-0.376 10.812,-0.375 12.314,1.125 C13.815,2.627 13.815,5.069 12.314,6.57 L7.011,11.873 C6.094,12.792 4.603,12.79 3.687,11.873 C2.771,10.958 2.771,9.467 3.687,8.551 L8.99,3.248 C9.323,2.916 9.861,2.916 10.193,3.248 C10.525,3.579 10.525,4.118 10.193,4.449 L4.89,9.752 C4.637,10.006 4.637,10.418 4.89,10.672 C5.143,10.923 5.555,10.925 5.809,10.672 L11.113,5.369 C11.952,4.53 11.952,3.166 11.113,2.327 C10.276,1.49 8.911,1.488 8.073,2.327 L2.769,7.631 C2.079,8.32 1.699,9.237 1.699,10.212 C1.699,11.188 2.079,12.104 2.768,12.794 C4.19,14.216 6.502,14.216 7.925,12.798 L7.929,12.794 C7.929,12.793 7.929,12.793 7.929,12.793 L15.355,5.369 C15.687,5.037 16.224,5.037 16.556,5.369 C16.888,5.7 16.888,6.239 16.556,6.57 L8.779,14.348 L8.761,14.332 C7.776,15.15 6.562,15.56 5.35,15.56 Z'/>\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {getFileDownloadUrl} from 'mattermost-redux/utils/file_utils';\n\nimport OverlayTrigger from 'components/overlay_trigger';\nimport AttachmentIcon from 'components/widgets/icons/attachment_icon';\nimport {trimFilename} from 'utils/file_utils';\nimport {localizeMessage} from 'utils/utils.jsx';\n\nexport default class FilenameOverlay extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * File detailed information\n         */\n        fileInfo: PropTypes.object.isRequired,\n\n        /*\n         * Handler for when the thumbnail is clicked passed the index above\n         */\n        handleImageClick: PropTypes.func,\n\n        /*\n         * Display in compact format\n         */\n        compactDisplay: PropTypes.bool,\n\n        /*\n         * If it should display link to download on file name\n         */\n        canDownload: PropTypes.bool,\n\n        /**\n         * Optional children like download icon\n         */\n        children: PropTypes.element,\n\n        /**\n         * Optional class like for icon\n         */\n        iconClass: PropTypes.string,\n    };\n\n    render() {\n        const {\n            canDownload,\n            children,\n            compactDisplay,\n            fileInfo,\n            handleImageClick,\n            iconClass,\n        } = this.props;\n\n        const fileName = fileInfo.name;\n        const trimmedFilename = trimFilename(fileName);\n\n        let filenameOverlay;\n        if (compactDisplay) {\n            filenameOverlay = (\n                <OverlayTrigger\n                    delayShow={1000}\n                    placement='top'\n                    overlay={<Tooltip id='file-name__tooltip'>{fileName}</Tooltip>}\n                >\n                    <a\n                        id='file-attachment-link'\n                        href='#'\n                        onClick={handleImageClick}\n                        className='post-image__name'\n                        rel='noopener noreferrer'\n                    >\n                        <AttachmentIcon className='icon'/>\n                        {trimmedFilename}\n                    </a>\n                </OverlayTrigger>\n            );\n        } else if (canDownload) {\n            filenameOverlay = (\n                <div className={iconClass || 'post-image__name'}>\n                    <a\n                        href={getFileDownloadUrl(fileInfo.id)}\n                        aria-label={localizeMessage('view_image_popover.download', 'Download').toLowerCase()}\n                        download={fileName}\n                        target='_blank'\n                        rel='noopener noreferrer'\n                    >\n                        <OverlayTrigger\n                            delayShow={1000}\n                            placement='top'\n                            overlay={\n                                <Tooltip id='file-name__tooltip'>\n                                    {localizeMessage('view_image_popover.download', 'Download')}\n                                </Tooltip>\n                            }\n                        >\n                            {children || trimmedFilename}\n                        </OverlayTrigger>\n                    </a>\n                </div>\n            );\n        } else {\n            filenameOverlay = (\n                <span className='post-image__name'>\n                    {trimmedFilename}\n                </span>\n            );\n        }\n\n        return (filenameOverlay);\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {FormattedMessage} from 'react-intl';\n\nexport default class RemoveIcon extends React.PureComponent {\n    render() {\n        return (\n            <FormattedMessage\n                id='generic_icons.remove'\n                defaultMessage='Remove Icon'\n            >\n                {(title) => (\n                    <i\n                        className='fa fa-remove'\n                        title={title}\n                    />\n                )}\n            </FormattedMessage>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport {ProgressBar} from 'react-bootstrap';\n\nimport FilenameOverlay from 'components/file_attachment/filename_overlay.jsx';\nimport RemoveIcon from 'components/widgets/icons/fa_remove_icon';\nimport {getFileTypeFromMime} from 'utils/file_utils';\nimport * as Utils from 'utils/utils.jsx';\n\nexport default class FileProgressPreview extends React.PureComponent {\n    static propTypes = {\n        handleRemove: PropTypes.func.isRequired,\n        clientId: PropTypes.string.isRequired,\n        fileInfo: PropTypes.object,\n    };\n\n    handleRemove = () => {\n        this.props.handleRemove(this.props.clientId);\n    }\n\n    render() {\n        let percent = 0;\n        let fileNameComponent;\n        let previewImage;\n        let progressBar;\n        const {fileInfo, clientId} = this.props;\n\n        if (fileInfo) {\n            percent = fileInfo.percent;\n            const percentTxt = percent && ` (${percent.toFixed(0)}%)`;\n            const fileType = getFileTypeFromMime(fileInfo.type);\n            previewImage = <div className={'file-icon ' + Utils.getIconClassName(fileType)}/>;\n\n            fileNameComponent = (\n                <React.Fragment>\n                    <FilenameOverlay\n                        fileInfo={fileInfo}\n                        index={clientId}\n                        handleImageClick={null}\n                        compactDisplay={false}\n                        canDownload={false}\n                    />\n                    <span className='post-image__uploadingTxt'>\n                        {percent === 100 ? (\n                            <FormattedMessage\n                                id='create_post.fileProcessing'\n                                defaultMessage='Processing...'\n                            />\n                        ) : (\n                            <React.Fragment>\n                                <FormattedMessage\n                                    id='admin.plugin.uploading'\n                                    defaultMessage='Uploading...'\n                                />\n                                <span>{percentTxt}</span>\n                            </React.Fragment>\n                        )}\n                    </span>\n                </React.Fragment>\n            );\n\n            if (percent) {\n                progressBar = (\n                    <ProgressBar\n                        className='post-image__progressBar'\n                        now={percent}\n                        active={percent === 100}\n                    />\n                );\n            }\n        }\n\n        return (\n            <div\n                ref={clientId}\n                key={clientId}\n                className='file-preview post-image__column'\n                data-client-id={clientId}\n            >\n                <div className='post-image__thumbnail'>\n                    {previewImage}\n                </div>\n                <div className='post-image__details'>\n                    <div className='post-image__detail_wrapper'>\n                        <div className='post-image__detail'>\n                            {fileNameComponent}\n                        </div>\n                    </div>\n                    <div>\n                        <a\n                            className='file-preview__remove'\n                            onClick={this.handleRemove}\n                        >\n                            <RemoveIcon/>\n                        </a>\n                    </div>\n                    {progressBar}\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {getFileThumbnailUrl, getFileUrl} from 'mattermost-redux/utils/file_utils';\n\nimport FilenameOverlay from 'components/file_attachment/filename_overlay.jsx';\nimport RemoveIcon from 'components/widgets/icons/fa_remove_icon';\nimport Constants, {FileTypes} from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\n\nimport FileProgressPreview from './file_progress_preview.jsx';\n\nexport default class FilePreview extends React.PureComponent {\n    static propTypes = {\n        enableSVGs: PropTypes.bool.isRequired,\n        onRemove: PropTypes.func.isRequired,\n        fileInfos: PropTypes.arrayOf(PropTypes.object).isRequired,\n        uploadsInProgress: PropTypes.array,\n        uploadsProgressPercent: PropTypes.object,\n    };\n\n    static defaultProps = {\n        fileInfos: [],\n        uploadsInProgress: [],\n        uploadsProgressPercent: {},\n    };\n\n    handleRemove = (id) => {\n        this.props.onRemove(id);\n    }\n\n    render() {\n        const previews = [];\n\n        this.props.fileInfos.forEach((info, idx) => {\n            const type = Utils.getFileType(info.extension);\n\n            let className = 'file-preview post-image__column';\n            let previewImage;\n            if (type === FileTypes.SVG && this.props.enableSVGs) {\n                previewImage = (\n                    <img\n                        alt={'file preview'}\n                        className='post-image normal'\n                        src={getFileUrl(info.id)}\n                    />\n                );\n            } else if (type === FileTypes.IMAGE) {\n                let imageClassName = 'post-image';\n\n                if (info.width < Constants.THUMBNAIL_WIDTH && info.height < Constants.THUMBNAIL_HEIGHT) {\n                    imageClassName += ' small';\n                } else {\n                    imageClassName += ' normal';\n                }\n\n                let thumbnailUrl = getFileThumbnailUrl(info.id);\n                if (Utils.isGIFImage(info.extension) && !info.has_preview_image) {\n                    thumbnailUrl = getFileUrl(info.id);\n                }\n\n                previewImage = (\n                    <div\n                        className={imageClassName}\n                        style={{\n                            backgroundImage: `url(${thumbnailUrl})`,\n                            backgroundSize: 'cover',\n                        }}\n                    />\n                );\n            } else {\n                className += ' custom-file';\n                previewImage = <div className={'file-icon ' + Utils.getIconClassName(type)}/>;\n            }\n\n            previews.push(\n                <div\n                    key={info.id}\n                    className={className}\n                >\n                    <div className='post-image__thumbnail'>\n                        {previewImage}\n                    </div>\n                    <div className='post-image__details'>\n                        <div className='post-image__detail_wrapper'>\n                            <div className='post-image__detail'>\n                                <FilenameOverlay\n                                    fileInfo={info}\n                                    index={idx}\n                                    handleImageClick={null}\n                                    compactDisplay={false}\n                                    canDownload={false}\n                                />\n                                <span className='post-image__type'>{info.extension.toUpperCase()}</span>\n                                <span className='post-image__size'>{Utils.fileSizeToString(info.size)}</span>\n                            </div>\n                        </div>\n                        <div>\n                            <a\n                                className='file-preview__remove'\n                                onClick={this.handleRemove.bind(this, info.id)}\n                            >\n                                <RemoveIcon/>\n                            </a>\n                        </div>\n                    </div>\n                </div>\n            );\n        });\n\n        this.props.uploadsInProgress.forEach((clientId) => {\n            previews.push(\n                <FileProgressPreview\n                    key={clientId}\n                    clientId={clientId}\n                    fileInfo={this.props.uploadsProgressPercent[clientId]}\n                    handleRemove={this.handleRemove}\n                />\n            );\n        });\n\n        return (\n            <div\n                className='file-preview__container'\n                ref='container'\n            >\n                {previews}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport FilePreview from './file_preview';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n\n    return {\n        enableSVGs: config.EnableSVGs === 'true',\n    };\n}\n\nexport default connect(mapStateToProps)(FilePreview);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {batchActions} from 'redux-batched-actions';\nimport request from 'superagent';\nimport {FileTypes} from 'mattermost-redux/action_types';\nimport {getLogErrorAction} from 'mattermost-redux/actions/errors';\nimport {forceLogoutIfNecessary} from 'mattermost-redux/actions/helpers';\nimport {Client4} from 'mattermost-redux/client';\n\nimport * as Utils from 'utils/utils.jsx';\n\nexport function uploadFile(file, name, channelId, rootId, clientId) {\n    return (dispatch) => {\n        dispatch({type: FileTypes.UPLOAD_FILES_REQUEST});\n\n        return request.\n            post(Client4.getFilesRoute()).\n            set(Client4.getOptions({method: 'post'}).headers).\n            attach('files', file, name).\n            field('channel_id', channelId).\n            field('client_ids', clientId).\n            accept('application/json');\n    };\n}\n\nexport function handleFileUploadEnd(file, name, channelId, rootId, clientId, {err, res}) {\n    return (dispatch, getState) => {\n        if (err) {\n            let e;\n            if (res && res.body && res.body.id) {\n                e = res.body;\n            } else if (err.status === 0 || !err.status) {\n                e = {message: Utils.localizeMessage('file_upload.generic_error', 'There was a problem uploading your files.')};\n            } else {\n                e = {message: Utils.localizeMessage('channel_loader.unknown_error', 'We received an unexpected status code from the server.') + ' (' + err.status + ')'};\n            }\n\n            forceLogoutIfNecessary(err, dispatch, getState);\n\n            const failure = {\n                type: FileTypes.UPLOAD_FILES_FAILURE,\n                clientIds: [clientId],\n                channelId,\n                rootId,\n                error: err,\n            };\n\n            dispatch(batchActions([failure, getLogErrorAction(err)]));\n            return {error: e};\n        }\n        const data = res.body.file_infos.map((fileInfo, index) => {\n            return {\n                ...fileInfo,\n                clientId: res.body.client_ids[index],\n            };\n        });\n\n        dispatch(batchActions([\n            {\n                type: FileTypes.RECEIVED_UPLOAD_FILES,\n                data,\n                channelId,\n                rootId,\n            },\n            {\n                type: FileTypes.UPLOAD_FILES_SUCCESS,\n            },\n        ]));\n\n        return {data: res.body};\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React, {PureComponent} from 'react';\nimport ReactDOM from 'react-dom';\nimport {defineMessages, FormattedMessage, injectIntl} from 'react-intl';\n\nimport dragster from 'utils/dragster';\nimport Constants from 'utils/constants';\nimport DelayedAction from 'utils/delayed_action';\nimport {t} from 'utils/i18n';\nimport {\n    isIosChrome,\n    isMobileApp,\n} from 'utils/user_agent';\nimport {getTable} from 'utils/paste';\nimport {intlShape} from 'utils/react_intl';\nimport {\n    clearFileInput,\n    cmdOrCtrlPressed,\n    isKeyPressed,\n    generateId,\n    isFileTransfer,\n    isUriDrop,\n    localizeMessage,\n} from 'utils/utils.jsx';\n\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\nimport Menu from 'components/widgets/menu/menu';\n\nimport AttachmentIcon from 'components/widgets/icons/attachment_icon';\n\nconst holders = defineMessages({\n    limited: {\n        id: t('file_upload.limited'),\n        defaultMessage: 'Uploads limited to {count, number} files maximum. Please use additional posts for more files.',\n    },\n    filesAbove: {\n        id: t('file_upload.filesAbove'),\n        defaultMessage: 'Files above {max}MB could not be uploaded: {filenames}',\n    },\n    fileAbove: {\n        id: t('file_upload.fileAbove'),\n        defaultMessage: 'File above {max}MB could not be uploaded: {filename}',\n    },\n    zeroBytesFiles: {\n        id: t('file_upload.zeroBytesFiles'),\n        defaultMessage: 'You are uploading empty files: {filenames}',\n    },\n    zeroBytesFile: {\n        id: t('file_upload.zeroBytesFile'),\n        defaultMessage: 'You are uploading an empty file: {filename}',\n    },\n    pasted: {\n        id: t('file_upload.pasted'),\n        defaultMessage: 'Image Pasted at ',\n    },\n    uploadFile: {\n        id: t('file_upload.upload_files'),\n        defaultMessage: 'Upload files',\n    },\n});\n\nconst OVERLAY_TIMEOUT = 500;\n\nconst customStyles = {\n    left: 'inherit',\n    right: 0,\n    bottom: '100%',\n    top: 'auto',\n};\n\nclass FileUpload extends PureComponent {\n    static propTypes = {\n\n        /**\n         * Current channel's ID\n         */\n        currentChannelId: PropTypes.string.isRequired,\n\n        /**\n         * Current root post's ID\n         */\n        rootId: PropTypes.string,\n\n        /**\n         * Number of files to attach\n         */\n        fileCount: PropTypes.number.isRequired,\n\n        /**\n         * Function to get file upload targeted input\n         */\n        getTarget: PropTypes.func.isRequired,\n\n        intl: intlShape.isRequired,\n\n        locale: PropTypes.string.isRequired,\n\n        /**\n         * Function to be called when file upload input is clicked\n         */\n        onClick: PropTypes.func,\n\n        /**\n         * Function to be called when file upload is complete\n         */\n        onFileUpload: PropTypes.func,\n\n        /**\n         * Function to be called when file upload input's change event is fired\n         */\n        onFileUploadChange: PropTypes.func,\n\n        /**\n         * Function to be called when upload fails\n         */\n        onUploadError: PropTypes.func,\n\n        /**\n         * Function to be called when file upload starts\n         */\n        onUploadStart: PropTypes.func,\n\n        /**\n         * Type of the object which the uploaded file is attached to\n         */\n        postType: PropTypes.string,\n\n        /**\n         * The maximum uploaded file size.\n         */\n        maxFileSize: PropTypes.number,\n\n        /**\n         * Whether or not file upload is allowed.\n         */\n        canUploadFiles: PropTypes.bool.isRequired,\n\n        /**\n         * Plugin file upload methods to be added\n         */\n        pluginFileUploadMethods: PropTypes.arrayOf(PropTypes.object),\n        pluginFilesWillUploadHooks: PropTypes.arrayOf(PropTypes.object),\n\n        /**\n         * Function called when superAgent fires progress event.\n         */\n        onUploadProgress: PropTypes.func.isRequired,\n        actions: PropTypes.shape({\n\n            /**\n             * Function to be called to upload file\n             */\n            uploadFile: PropTypes.func.isRequired,\n\n            /**\n             * Function to be called when file is uploaded or failed\n             */\n            handleFileUploadEnd: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    static defaultProps = {\n        pluginFileUploadMethods: [],\n        pluginFilesWillUploadHooks: [],\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            requests: {},\n            menuOpen: false,\n        };\n        this.fileInput = React.createRef();\n    }\n\n    componentDidMount() {\n        if (this.props.postType === 'post') {\n            this.registerDragEvents('.row.main', '.center-file-overlay');\n        } else if (this.props.postType === 'comment') {\n            this.registerDragEvents('.post-right__container', '.right-file-overlay');\n        }\n\n        document.addEventListener('paste', this.pasteUpload);\n        document.addEventListener('keydown', this.keyUpload);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('paste', this.pasteUpload);\n        document.removeEventListener('keydown', this.keyUpload);\n\n        this.unbindDragsterEvents();\n    }\n\n    fileUploadSuccess = (data, channelId, currentRootId) => {\n        if (data) {\n            this.props.onFileUpload(data.file_infos, data.client_ids, channelId, currentRootId);\n\n            const requests = Object.assign({}, this.state.requests);\n            for (var j = 0; j < data.client_ids.length; j++) {\n                Reflect.deleteProperty(requests, data.client_ids[j]);\n            }\n            this.setState({requests});\n        }\n    }\n\n    fileUploadFail = (err, clientId, channelId, currentRootId) => {\n        this.props.onUploadError(err, clientId, channelId, currentRootId);\n    }\n\n    pluginUploadFiles = (files) => {\n        // clear any existing errors\n        this.props.onUploadError(null);\n        this.uploadFiles(files);\n    }\n\n    checkPluginHooksAndUploadFiles = (files) => {\n        // clear any existing errors\n        this.props.onUploadError(null);\n\n        let sortedFiles = Array.from(files).sort((a, b) => a.name.localeCompare(b.name, this.props.locale, {numeric: true}));\n\n        const willUploadHooks = this.props.pluginFilesWillUploadHooks;\n        for (const h of willUploadHooks) {\n            const result = h.hook(sortedFiles, this.pluginUploadFiles);\n\n            // Display an error message if there is one but don't reject the upload\n            if (result.message) {\n                this.props.onUploadError(result.message);\n            }\n\n            sortedFiles = result.files;\n        }\n\n        if (sortedFiles) {\n            this.uploadFiles(sortedFiles);\n        }\n    }\n\n    uploadFiles = (sortedFiles) => {\n        const {currentChannelId, rootId} = this.props;\n\n        const uploadsRemaining = Constants.MAX_UPLOAD_FILES - this.props.fileCount;\n        let numUploads = 0;\n\n        // keep track of how many files have been too large\n        const tooLargeFiles = [];\n        const zeroFiles = [];\n        const clientIds = [];\n\n        for (let i = 0; i < sortedFiles.length && numUploads < uploadsRemaining; i++) {\n            if (sortedFiles[i].size > this.props.maxFileSize) {\n                tooLargeFiles.push(sortedFiles[i]);\n                continue;\n            }\n            if (sortedFiles[i].size === 0) {\n                zeroFiles.push(sortedFiles[i]);\n            }\n\n            // generate a unique id that can be used by other components to refer back to this upload\n            const clientId = generateId();\n\n            const request = this.props.actions.uploadFile(\n                sortedFiles[i],\n                sortedFiles[i].name,\n                currentChannelId,\n                rootId,\n                clientId,\n            );\n\n            request.on('progress', (progressEvent) => {\n                this.props.onUploadProgress({\n                    clientId,\n                    name: sortedFiles[i].name,\n                    percent: progressEvent.percent,\n                    type: sortedFiles[i].type,\n                });\n            });\n\n            request.end((err, res) => {\n                const {error, data} = this.props.actions.handleFileUploadEnd(\n                    sortedFiles[i],\n                    sortedFiles[i].name,\n                    currentChannelId,\n                    rootId,\n                    clientId,\n                    {err, res},\n                );\n\n                if (error) {\n                    this.fileUploadFail(error, clientId, currentChannelId, rootId);\n                } else if (data) {\n                    this.fileUploadSuccess(data, currentChannelId, rootId);\n                }\n            });\n\n            this.setState({requests: {...this.state.requests, [clientId]: request}});\n            clientIds.push(clientId);\n\n            numUploads += 1;\n        }\n\n        this.props.onUploadStart(clientIds, currentChannelId);\n\n        const {formatMessage} = this.props.intl;\n        const errors = [];\n        if (sortedFiles.length > uploadsRemaining) {\n            errors.push(formatMessage(holders.limited, {count: Constants.MAX_UPLOAD_FILES}));\n        }\n\n        if (tooLargeFiles.length > 1) {\n            var tooLargeFilenames = tooLargeFiles.map((file) => file.name).join(', ');\n\n            errors.push(formatMessage(holders.filesAbove, {max: (this.props.maxFileSize / 1048576), filenames: tooLargeFilenames}));\n        } else if (tooLargeFiles.length > 0) {\n            errors.push(formatMessage(holders.fileAbove, {max: (this.props.maxFileSize / 1048576), filename: tooLargeFiles[0].name}));\n        }\n\n        if (zeroFiles.length > 1) {\n            var zeroFilenames = zeroFiles.map((file) => file.name).join(', ');\n\n            errors.push(formatMessage(holders.zeroBytesFiles, {filenames: zeroFilenames}));\n        } else if (zeroFiles.length > 0) {\n            errors.push(formatMessage(holders.zeroBytesFile, {filename: zeroFiles[0].name}));\n        }\n\n        if (errors.length > 0) {\n            this.props.onUploadError(errors.join(', '));\n        }\n    }\n\n    handleChange = (e) => {\n        if (e.target.files.length > 0) {\n            this.checkPluginHooksAndUploadFiles(e.target.files);\n\n            clearFileInput(e.target);\n        }\n\n        this.props.onFileUploadChange();\n    }\n\n    handleDrop = (e) => {\n        if (!this.props.canUploadFiles) {\n            this.props.onUploadError(localizeMessage('file_upload.disabled', 'File attachments are disabled.'));\n            return;\n        }\n\n        this.props.onUploadError(null);\n\n        const items = e.dataTransfer.items || [];\n        const droppedFiles = e.dataTransfer.files;\n        const files = [];\n        Array.from(droppedFiles).forEach((file, index) => {\n            const item = items[index];\n            if (item && item.webkitGetAsEntry && (item.webkitGetAsEntry() === null || item.webkitGetAsEntry().isDirectory)) {\n                return;\n            }\n            files.push(file);\n        });\n\n        const types = e.dataTransfer.types;\n        if (types) {\n            if (isUriDrop(e.dataTransfer)) {\n                return;\n            }\n\n            // For non-IE browsers\n            if (types.includes && !types.includes('Files')) {\n                return;\n            }\n\n            // For IE browsers\n            if (types.contains && !types.contains('Files')) {\n                return;\n            }\n        }\n\n        if (files.length === 0) {\n            this.props.onUploadError(localizeMessage('file_upload.drag_folder', 'Folders cannot be uploaded. Please drag all files separately.'));\n            return;\n        }\n\n        if (files.length) {\n            this.checkPluginHooksAndUploadFiles(files);\n        }\n\n        this.props.onFileUploadChange();\n    }\n\n    registerDragEvents = (containerSelector, overlaySelector) => {\n        const self = this;\n\n        const overlay = document.querySelector(overlaySelector);\n\n        const dragTimeout = new DelayedAction(() => {\n            overlay.classList.add('hidden');\n        });\n\n        let dragsterActions = {};\n        if (this.props.canUploadFiles) {\n            dragsterActions = {\n                enter(e) {\n                    var files = e.detail.dataTransfer;\n                    if (!isUriDrop(files) && isFileTransfer(files)) {\n                        overlay.classList.remove('hidden');\n                    }\n                },\n                leave(e) {\n                    var files = e.detail.dataTransfer;\n\n                    if (!isUriDrop(files) && isFileTransfer(files)) {\n                        overlay.classList.add('hidden');\n                    }\n\n                    dragTimeout.cancel();\n                },\n                over() {\n                    dragTimeout.fireAfter(OVERLAY_TIMEOUT);\n                },\n                drop(e) {\n                    overlay.classList.add('hidden');\n                    dragTimeout.cancel();\n\n                    self.handleDrop(e.detail);\n                },\n            };\n        } else {\n            dragsterActions = {\n                drop(e) {\n                    self.handleDrop(e.detail);\n                },\n            };\n        }\n\n        this.unbindDragsterEvents = dragster(containerSelector, dragsterActions);\n    }\n\n    containsEventTarget = (targetElement, eventTarget) => targetElement && targetElement.contains(eventTarget);\n\n    pasteUpload = (e) => {\n        const {formatMessage} = this.props.intl;\n\n        if (!e.clipboardData || !e.clipboardData.items || getTable(e.clipboardData)) {\n            return;\n        }\n\n        const target = this.props.getTarget();\n        const textarea = ReactDOM.findDOMNode(target);\n        if (!this.containsEventTarget(textarea, e.target)) {\n            return;\n        }\n\n        this.props.onUploadError(null);\n\n        const items = [];\n        for (let i = 0; i < e.clipboardData.items.length; i++) {\n            const item = e.clipboardData.items[i];\n\n            if (item.kind !== 'file') {\n                continue;\n            }\n\n            items.push(item);\n        }\n\n        if (items && items.length > 0) {\n            if (!this.props.canUploadFiles) {\n                this.props.onUploadError(localizeMessage('file_upload.disabled', 'File attachments are disabled.'));\n                return;\n            }\n\n            const files = [];\n\n            for (let i = 0; i < items.length; i++) {\n                const file = items[i].getAsFile();\n                if (!file) {\n                    continue;\n                }\n\n                var d = new Date();\n                let hour = d.getHours();\n                hour = hour < 10 ? `0${hour}` : `${hour}`;\n\n                let minute = d.getMinutes();\n                minute = minute < 10 ? `0${minute}` : `${minute}`;\n\n                var ext = '';\n                if (file.name) {\n                    if (file.name.includes('.')) {\n                        ext = file.name.substr(file.name.lastIndexOf('.'));\n                    }\n                } else if (items[i].type.includes('/')) {\n                    ext = '.' + items[i].type.split('/')[1].toLowerCase();\n                }\n\n                const name = formatMessage(holders.pasted) + d.getFullYear() + '-' + (d.getMonth() + 1) + '-' + d.getDate() + ' ' + hour + '-' + minute + ext;\n\n                const newFile = new Blob([file], {type: file.type});\n                newFile.name = name;\n                files.push(newFile);\n            }\n\n            if (files.length > 0) {\n                this.checkPluginHooksAndUploadFiles(files);\n                this.props.onFileUploadChange();\n            }\n        }\n    }\n\n    keyUpload = (e) => {\n        if (cmdOrCtrlPressed(e) && isKeyPressed(e, Constants.KeyCodes.U)) {\n            e.preventDefault();\n\n            if (!this.props.canUploadFiles) {\n                this.props.onUploadError(localizeMessage('file_upload.disabled', 'File attachments are disabled.'));\n                return;\n            }\n            const postTextbox = this.props.postType === 'post' && document.activeElement.id === 'post_textbox';\n            const commentTextbox = this.props.postType === 'comment' && document.activeElement.id === 'reply_textbox';\n            if (postTextbox || commentTextbox) {\n                this.fileInput.current.focus();\n                this.fileInput.current.click();\n            }\n        }\n    }\n\n    cancelUpload = (clientId) => {\n        const requests = Object.assign({}, this.state.requests);\n        const request = requests[clientId];\n\n        if (request) {\n            request.abort();\n\n            Reflect.deleteProperty(requests, clientId);\n            this.setState({requests});\n        }\n    }\n\n    handleMaxUploadReached = (e) => {\n        if (e) {\n            e.preventDefault();\n        }\n\n        const {onUploadError} = this.props;\n        const {formatMessage} = this.props.intl;\n\n        onUploadError(formatMessage(holders.limited, {count: Constants.MAX_UPLOAD_FILES}));\n    }\n\n    toggleMenu = (open) => {\n        this.setState({menuOpen: open});\n    }\n\n    handleLocalFileUploaded = (e) => {\n        const uploadsRemaining = Constants.MAX_UPLOAD_FILES - this.props.fileCount;\n        if (uploadsRemaining > 0) {\n            if (this.props.onClick) {\n                this.props.onClick();\n            }\n        } else {\n            this.handleMaxUploadReached(e);\n        }\n        this.setState({menuOpen: false});\n    }\n\n    simulateInputClick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.fileInput.current.click();\n    }\n\n    render() {\n        const {formatMessage} = this.props.intl;\n        let multiple = true;\n        if (isMobileApp()) {\n            // iOS WebViews don't upload videos properly in multiple mode\n            multiple = false;\n        }\n\n        let accept = '';\n        if (isIosChrome()) {\n            // iOS Chrome can't upload videos at all\n            accept = 'image/*';\n        }\n\n        const uploadsRemaining = Constants.MAX_UPLOAD_FILES - this.props.fileCount;\n\n        let bodyAction;\n        const ariaLabel = formatMessage({id: 'accessibility.button.attachment', defaultMessage: 'attachment'});\n\n        if (this.props.pluginFileUploadMethods.length === 0) {\n            bodyAction = (\n                <div>\n                    <button\n                        type='button'\n                        id='fileUploadButton'\n                        aria-label={ariaLabel}\n                        className='style--none post-action icon icon--attachment'\n                        onClick={this.simulateInputClick}\n                        onTouchEnd={this.simulateInputClick}\n                    >\n                        <AttachmentIcon/>\n                    </button>\n                    <input\n                        id='fileUploadInput'\n                        tabIndex='-1'\n                        aria-label={formatMessage(holders.uploadFile)}\n                        ref={this.fileInput}\n                        type='file'\n                        onChange={this.handleChange}\n                        onClick={this.handleLocalFileUploaded}\n                        multiple={multiple}\n                        accept={accept}\n                    />\n                </div>\n            );\n        } else {\n            const pluginFileUploadMethods = this.props.pluginFileUploadMethods.map((item) => {\n                return (\n                    <li\n                        key={item.pluginId + '_fileuploadpluginmenuitem'}\n                        onClick={() => {\n                            if (item.action) {\n                                item.action(this.checkPluginHooksAndUploadFiles);\n                            }\n                            this.setState({menuOpen: false});\n                        }}\n                    >\n                        <a href='#'>\n                            <span className='mr-2'>\n                                {item.icon}\n                            </span>\n                            {item.text}\n                        </a>\n                    </li>\n                );\n            });\n            bodyAction = (\n                <div>\n                    <input\n                        tabIndex='-1'\n                        aria-label={formatMessage(holders.uploadFile)}\n                        ref={this.fileInput}\n                        type='file'\n                        className='file-attachment-menu-item-input'\n                        onChange={this.handleChange}\n                        onClick={this.handleLocalFileUploaded}\n                        multiple={multiple}\n                        accept={accept}\n                    />\n                    <MenuWrapper>\n                        <button\n                            type='button'\n                            aria-label={ariaLabel}\n                            className='style--none post-action'\n                        >\n                            <div\n                                id='fileUploadButton'\n                                className='icon icon--attachment'\n                            >\n                                <AttachmentIcon/>\n                            </div>\n                        </button>\n                        <Menu\n                            id='fileUploadOptions'\n                            openLeft={true}\n                            openUp={true}\n                            ariaLabel={formatMessage({id: 'file_upload.menuAriaLabel', defaultMessage: 'Upload type selector'})}\n                            customStyles={customStyles}\n                        >\n                            <li>\n                                <a\n                                    href='#'\n                                    onClick={this.simulateInputClick}\n                                    onTouchEnd={this.simulateInputClick}\n                                >\n                                    <span className='mr-2'>\n                                        <i className='fa fa-laptop'/>\n                                    </span>\n                                    <FormattedMessage\n                                        id='yourcomputer'\n                                        defaultMessage='Your computer'\n                                    />\n                                </a>\n                            </li>\n                            {pluginFileUploadMethods}\n                        </Menu>\n                    </MenuWrapper>\n                </div>\n            );\n        }\n\n        if (!this.props.canUploadFiles) {\n            bodyAction = null;\n        }\n\n        return (\n            <div className={uploadsRemaining <= 0 ? ' style--none btn-file__disabled' : 'style--none'}>\n                {bodyAction}\n            </div>\n        );\n    }\n}\n\nconst wrappedComponent = injectIntl(FileUpload, {forwardRef: true});\nwrappedComponent.displayName = 'injectIntl(FileUpload)';\nexport default wrappedComponent;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\ntype Options = {\n    enter?: (event: CustomEvent) => void;\n    leave?: (event: CustomEvent) => void;\n    over?: (event: CustomEvent) => void;\n    drop?: (event: CustomEvent) => void;\n}\n\nexport default function dragster(query: string, options: Options) {\n    const noop = () => {}; // eslint-disable-line no-empty-function\n\n    const defaults = {\n        enter: noop,\n        leave: noop,\n        over: noop,\n        drop: noop,\n    };\n\n    const settings = Object.assign(defaults, options);\n    const node = document.querySelector(query);\n\n    if (!node) {\n        return noop;\n    }\n\n    let first = false;\n    let second = false;\n\n    const dragenter = (event: Event) => {\n        if (first) {\n            second = true;\n            return;\n        }\n\n        first = true;\n        const enterEvent = new CustomEvent('dragster:enter', {detail: event});\n        node.dispatchEvent(enterEvent);\n\n        event.preventDefault();\n    };\n\n    const dragleave = (event: Event) => {\n        if (second) {\n            second = false;\n        } else if (first) {\n            first = false;\n        }\n        if (!first && !second) {\n            const leaveEvent = new CustomEvent('dragster:leave', {detail: event});\n            node.dispatchEvent(leaveEvent);\n        }\n        event.preventDefault();\n    };\n\n    const dragover = (event: Event) => {\n        const overEvent = new CustomEvent('dragster:over', {detail: event});\n        node.dispatchEvent(overEvent);\n        event.preventDefault();\n    };\n\n    const drop = (event: Event) => {\n        if (second) {\n            second = false;\n        } else if (first) {\n            first = false;\n        }\n        if (!first && !second) {\n            const dropEvent = new CustomEvent('dragster:drop', {detail: event});\n            node.dispatchEvent(dropEvent);\n        }\n        event.preventDefault();\n    };\n\n    node.addEventListener('dragenter', dragenter);\n    node.addEventListener('dragleave', dragleave);\n    node.addEventListener('dragover', dragover);\n    node.addEventListener('drop', drop);\n\n    node.addEventListener('dragster:enter', settings.enter);\n    node.addEventListener('dragster:leave', settings.leave);\n    node.addEventListener('dragster:over', settings.over);\n    node.addEventListener('dragster:drop', settings.drop);\n\n    const unbindEvents = () => {\n        node.removeEventListener('dragenter', dragenter);\n        node.removeEventListener('dragleave', dragleave);\n        node.removeEventListener('dragover', dragover);\n        node.removeEventListener('drop', drop);\n\n        node.removeEventListener('dragster:enter', settings.enter);\n        node.removeEventListener('dragster:leave', settings.leave);\n        node.removeEventListener('dragster:over', settings.over);\n        node.removeEventListener('dragster:drop', settings.drop);\n    };\n\n    return unbindEvents;\n}\n\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/channels';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport {uploadFile, handleFileUploadEnd} from 'actions/file_actions.jsx';\nimport {getCurrentLocale} from 'selectors/i18n';\nimport {canUploadFiles} from 'utils/file_utils';\n\nimport FileUpload from './file_upload.jsx';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n    const maxFileSize = parseInt(config.MaxFileSize, 10);\n\n    return {\n        currentChannelId: getCurrentChannelId(state),\n        maxFileSize,\n        canUploadFiles: canUploadFiles(config),\n        locale: getCurrentLocale(state),\n        pluginFileUploadMethods: state.plugins.components.FileUploadMethod,\n        pluginFilesWillUploadHooks: state.plugins.components.FilesWillUploadHook,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            uploadFile,\n            handleFileUploadEnd,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps, null, {withRef: true})(FileUpload);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\ntype Props = {\n    typingUsers: string[];\n}\n\nexport default class MsgTyping extends React.Component<Props> {\n    private getTypingText = () => {\n        let users: string[] = [];\n        let numUsers = 0;\n        if (this.props.typingUsers) {\n            users = [...this.props.typingUsers];\n            numUsers = users.length;\n        }\n\n        if (numUsers === 0) {\n            return '';\n        }\n        if (numUsers === 1) {\n            return (\n                <FormattedMessage\n                    id='msg_typing.isTyping'\n                    defaultMessage='{user} is typing...'\n                    values={{\n                        user: users[0],\n                    }}\n                />\n            );\n        }\n        const last = users.pop();\n        return (\n            <FormattedMessage\n                id='msg_typing.areTyping'\n                defaultMessage='{users} and {last} are typing...'\n                values={{\n                    users: (users.join(', ')),\n                    last,\n                }}\n            />\n        );\n    }\n\n    public render() {\n        return (\n            <span className='msg-typing'>{this.getTypingText()}</span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {makeGetUsersTypingByChannelAndPost} from 'mattermost-redux/selectors/entities/typing';\n\nimport {GlobalState} from 'types/store';\n\nimport MsgTyping from './msg_typing';\n\ntype Props = {\n    channelId: string;\n    postId: string;\n};\n\nfunction makeMapStateToProps() {\n    const getUsersTypingByChannelAndPost = makeGetUsersTypingByChannelAndPost();\n\n    return function mapStateToProps(state: GlobalState, ownProps: Props) {\n        const typingUsers = getUsersTypingByChannelAndPost(state, {channelId: ownProps.channelId, postId: ownProps.postId});\n\n        return {\n            typingUsers,\n        };\n    };\n}\n\nexport default connect(makeMapStateToProps)(MsgTyping);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\ntype Props = {\n    show: boolean;\n    onHide: (event: React.MouseEvent<HTMLButtonElement>) => void;\n}\n\nexport default class PostDeletedModal extends React.Component<Props> {\n    public shouldComponentUpdate(nextProps: Props): boolean {\n        return nextProps.show !== this.props.show;\n    }\n\n    public render(): JSX.Element {\n        return (\n            <Modal\n                dialogClassName='a11y__modal'\n                show={this.props.show}\n                onHide={this.props.onHide}\n                role='dialog'\n                aria-labelledby='postDeletedModalLabel'\n                data-testid='postDeletedModal'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='postDeletedModalLabel'\n                    >\n                        <FormattedMessage\n                            id='post_delete.notPosted'\n                            defaultMessage='Comment could not be posted'\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <p>\n                        <FormattedMessage\n                            id='post_delete.someone'\n                            defaultMessage='Someone deleted the message on which you tried to post a comment.'\n                        />\n                    </p>\n                </Modal.Body>\n                <Modal.Footer>\n                    <button\n                        type='button'\n                        className='btn btn-primary'\n                        autoFocus={true}\n                        onClick={this.props.onHide}\n                        data-testid='postDeletedModalOkButton'\n                    >\n                        <FormattedMessage\n                            id='post_delete.okay'\n                            defaultMessage='Okay'\n                        />\n                    </button>\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {ReactFragment} from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {isErrorInvalidSlashCommand} from 'utils/post_utils.jsx';\n\ninterface ErrorMessage {\n    message: string | ReactFragment;\n}\n\ninterface MessageSubmitErrorProps {\n    error: ErrorMessage;\n    handleSubmit: (e: React.MouseEvent<HTMLAnchorElement, MouseEvent>) => void;\n    submittedMessage?: string;\n}\n\nclass MessageSubmitError extends React.PureComponent<MessageSubmitErrorProps, {}> {\n    public renderSlashCommandError = (): string | ReactFragment => {\n        if (!this.props.submittedMessage) {\n            return this.props.error.message;\n        }\n\n        const command = this.props.submittedMessage.split(' ')[0];\n        return (\n            <React.Fragment>\n                <FormattedMessage\n                    id='message_submit_error.invalidCommand'\n                    defaultMessage=\"Command with a trigger of ''{command}'' not found. \"\n                    values={{\n                        command,\n                    }}\n                />\n                <a\n                    href='#'\n                    onClick={this.props.handleSubmit}\n                >\n                    <FormattedMessage\n                        id='message_submit_error.sendAsMessageLink'\n                        defaultMessage='Click here to send as a message.'\n                    />\n                </a>\n            </React.Fragment>\n        );\n    }\n\n    public render(): JSX.Element | null {\n        const error = this.props.error;\n\n        if (!error) {\n            return null;\n        }\n\n        let errorContent = error.message;\n        if (isErrorInvalidSlashCommand(error)) {\n            errorContent = this.renderSlashCommandError();\n        }\n\n        return (\n            <div className='has-error'>\n                <label className='control-label'>\n                    {errorContent}\n                </label>\n            </div>\n        );\n    }\n}\n\nexport default MessageSubmitError;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage, injectIntl} from 'react-intl';\n\nimport {sortFileInfos} from 'mattermost-redux/utils/file_utils';\n\nimport * as GlobalActions from 'actions/global_actions.jsx';\n\nimport Constants, {Locations} from 'utils/constants';\nimport {intlShape} from 'utils/react_intl';\nimport * as UserAgent from 'utils/user_agent';\nimport * as Utils from 'utils/utils.jsx';\nimport {containsAtChannel, postMessageOnKeyPress, shouldFocusMainTextbox, isErrorInvalidSlashCommand, splitMessageBasedOnCaretPosition} from 'utils/post_utils.jsx';\nimport {getTable, getPlainText, formatMarkdownTableMessage, isGitHubCodeBlock} from 'utils/paste';\n\nimport ConfirmModal from 'components/confirm_modal';\nimport EmojiPickerOverlay from 'components/emoji_picker/emoji_picker_overlay.jsx';\nimport FilePreview from 'components/file_preview';\nimport FileUpload from 'components/file_upload';\nimport MsgTyping from 'components/msg_typing';\nimport PostDeletedModal from 'components/post_deleted_modal';\nimport EmojiIcon from 'components/widgets/icons/emoji_icon';\nimport Textbox from 'components/textbox';\nimport TextboxLinks from 'components/textbox/textbox_links';\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message.jsx';\nimport MessageSubmitError from 'components/message_submit_error';\n\nconst KeyCodes = Constants.KeyCodes;\n\nclass CreateComment extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * The channel for which this comment is a part of\n         */\n        channelId: PropTypes.string.isRequired,\n\n        /**\n         * The number of channel members\n         */\n        channelMembersCount: PropTypes.number.isRequired,\n\n        /**\n         * The id of the parent post\n         */\n        rootId: PropTypes.string.isRequired,\n\n        /**\n         * True if the root message was deleted\n         */\n        rootDeleted: PropTypes.bool.isRequired,\n\n        /**\n         * The current history message selected\n         */\n        messageInHistory: PropTypes.string,\n\n        /**\n         * The current draft of the comment\n         */\n        draft: PropTypes.shape({\n            message: PropTypes.string.isRequired,\n            uploadsInProgress: PropTypes.array.isRequired,\n            fileInfos: PropTypes.array.isRequired,\n        }).isRequired,\n\n        /**\n         * Whether the submit button is enabled\n         */\n        enableAddButton: PropTypes.bool.isRequired,\n\n        /**\n         * Force message submission on CTRL/CMD + ENTER\n         */\n        codeBlockOnCtrlEnter: PropTypes.bool,\n\n        /**\n         * Set to force form submission on CTRL/CMD + ENTER instead of ENTER\n         */\n        ctrlSend: PropTypes.bool,\n\n        /**\n         * The id of the latest post in this channel\n         */\n        latestPostId: PropTypes.string,\n        locale: PropTypes.string.isRequired,\n\n        /**\n         * Create post error id\n         */\n        createPostErrorId: PropTypes.string,\n\n        /**\n         * Called to clear file uploads in progress\n         */\n        clearCommentDraftUploads: PropTypes.func.isRequired,\n\n        intl: intlShape.isRequired,\n\n        /**\n         * Called when comment draft needs to be updated\n         */\n        onUpdateCommentDraft: PropTypes.func.isRequired,\n\n        /**\n         * Called when comment draft needs to be updated for an specific root ID\n         */\n        updateCommentDraftWithRootId: PropTypes.func.isRequired,\n\n        /**\n         * Called when submitting the comment\n         */\n        onSubmit: PropTypes.func.isRequired,\n\n        /**\n         * Called when resetting comment message history index\n         */\n        onResetHistoryIndex: PropTypes.func.isRequired,\n\n        /**\n         * Called when navigating back through comment message history\n         */\n        onMoveHistoryIndexBack: PropTypes.func.isRequired,\n\n        /**\n         * Called when navigating forward through comment message history\n         */\n        onMoveHistoryIndexForward: PropTypes.func.isRequired,\n\n        /**\n         * Called to initiate editing the user's latest post\n         */\n        onEditLatestPost: PropTypes.func.isRequired,\n\n        /**\n         * Function to get the users timezones in the channel\n         */\n        getChannelTimezones: PropTypes.func.isRequired,\n\n        /**\n         * Reset state of createPost request\n         */\n        resetCreatePostRequest: PropTypes.func.isRequired,\n\n        /**\n         * Set if channel is read only\n         */\n        readOnlyChannel: PropTypes.bool,\n\n        /**\n         * Set if @channel should warn in this channel.\n         */\n        enableConfirmNotificationsToChannel: PropTypes.bool.isRequired,\n\n        /**\n         * Set if the emoji picker is enabled.\n         */\n        enableEmojiPicker: PropTypes.bool.isRequired,\n\n        /**\n         * Set if the gif picker is enabled.\n         */\n        enableGifPicker: PropTypes.bool.isRequired,\n\n        /**\n         * Set if the connection may be bad to warn user\n         */\n        badConnection: PropTypes.bool.isRequired,\n\n        /**\n         * The maximum length of a post\n         */\n        maxPostSize: PropTypes.number.isRequired,\n        rhsExpanded: PropTypes.bool.isRequired,\n\n        /**\n         * To check if the timezones are enable on the server.\n         */\n        isTimezoneEnabled: PropTypes.bool.isRequired,\n\n        /**\n         * The last time, if any, when the selected post changed. Will be 0 if no post selected.\n         */\n        selectedPostFocussedAt: PropTypes.number.isRequired,\n\n        isMarkdownPreviewEnabled: PropTypes.bool.isRequired,\n\n        /**\n         * Function to set or unset emoji picker for last message\n         */\n        emitShortcutReactToLastPostFrom: PropTypes.func,\n\n        canPost: PropTypes.bool.isRequired,\n\n        /**\n         * To determine if the current user can send special channel mentions\n         */\n        useChannelMentions: PropTypes.bool.isRequired,\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        let updatedState = {\n            createPostErrorId: props.createPostErrorId,\n            rootId: props.rootId,\n            messageInHistory: props.messageInHistory,\n            draft: state.draft || {...props.draft, caretPosition: props.draft.message.length, uploadsInProgress: []},\n        };\n\n        const rootChanged = props.rootId !== state.rootId;\n        const messageInHistoryChanged = props.messageInHistory !== state.messageInHistory;\n        if (rootChanged || messageInHistoryChanged) {\n            updatedState = {...updatedState, draft: {...props.draft, uploadsInProgress: rootChanged ? [] : props.draft.uploadsInProgress}};\n        }\n\n        if (props.createPostErrorId === 'api.post.create_post.root_id.app_error' && props.createPostErrorId !== state.createPostErrorId) {\n            updatedState = {...updatedState, showPostDeletedModal: true};\n        }\n\n        return updatedState;\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            showPostDeletedModal: false,\n            showConfirmModal: false,\n            showEmojiPicker: false,\n            showPreview: false,\n            channelTimezoneCount: 0,\n            uploadsProgressPercent: {},\n            renderScrollbar: false,\n            suggestionListStyle: 'top',\n        };\n\n        this.lastBlurAt = 0;\n        this.draftsForPost = {};\n        this.doInitialScrollToBottom = false;\n    }\n\n    componentDidMount() {\n        this.props.clearCommentDraftUploads();\n        this.props.onResetHistoryIndex();\n        this.focusTextbox();\n        document.addEventListener('paste', this.pasteHandler);\n        document.addEventListener('keydown', this.focusTextboxIfNecessary);\n\n        // When draft.message is not empty, set doInitialScrollToBottom to true so that\n        // on next component update, the actual this.scrollToBottom() will be called.\n        // This is made so that the this.scrollToBottom() will be called only once.\n        if (this.props.draft.message !== '') {\n            this.doInitialScrollToBottom = true;\n        }\n    }\n\n    componentWillUnmount() {\n        this.props.resetCreatePostRequest();\n        document.removeEventListener('paste', this.pasteHandler);\n        document.removeEventListener('keydown', this.focusTextboxIfNecessary);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (prevState.draft.uploadsInProgress.length < this.state.draft.uploadsInProgress.length) {\n            this.scrollToBottom();\n        }\n\n        // Focus on textbox when emoji picker is closed\n        if (prevState.showEmojiPicker && !this.state.showEmojiPicker) {\n            this.focusTextbox();\n        }\n\n        // Focus on textbox when returned from preview mode\n        if (prevState.showPreview && !this.state.showPreview) {\n            this.focusTextbox();\n        }\n\n        if (prevProps.rootId !== this.props.rootId || prevProps.selectedPostFocussedAt !== this.props.selectedPostFocussedAt) {\n            this.focusTextbox();\n        }\n\n        if (this.doInitialScrollToBottom) {\n            this.scrollToBottom();\n            this.doInitialScrollToBottom = false;\n        }\n    }\n\n    updatePreview = (newState) => {\n        this.setState({showPreview: newState});\n    }\n\n    focusTextboxIfNecessary = (e) => {\n        // Should only focus if RHS is expanded\n        if (!this.props.rhsExpanded) {\n            return;\n        }\n\n        // Bit of a hack to not steal focus from the channel switch modal if it's open\n        // This is a special case as the channel switch modal does not enforce focus like\n        // most modals do\n        if (document.getElementsByClassName('channel-switch-modal').length) {\n            return;\n        }\n\n        if (shouldFocusMainTextbox(e, document.activeElement)) {\n            this.focusTextbox();\n        }\n    }\n\n    pasteHandler = (e) => {\n        if (!e.clipboardData || !e.clipboardData.items || e.target.id !== 'reply_textbox') {\n            return;\n        }\n\n        const table = getTable(e.clipboardData);\n        if (!table) {\n            return;\n        }\n\n        e.preventDefault();\n\n        const {draft} = this.state;\n        let message = '';\n        if (isGitHubCodeBlock(table.className)) {\n            message = '```\\n' + getPlainText(e.clipboardData) + '\\n```';\n        } else {\n            message = formatMarkdownTableMessage(table, draft.message.trim());\n        }\n\n        const updatedDraft = {...draft, message};\n\n        this.props.onUpdateCommentDraft(updatedDraft);\n        this.setState({draft: updatedDraft});\n    }\n\n    handleNotifyAllConfirmation = (e) => {\n        this.hideNotifyAllModal();\n        this.doSubmit(e);\n    }\n\n    hideNotifyAllModal = () => {\n        this.setState({showConfirmModal: false});\n    }\n\n    showNotifyAllModal = () => {\n        this.setState({showConfirmModal: true});\n    }\n\n    toggleEmojiPicker = () => {\n        this.setState({showEmojiPicker: !this.state.showEmojiPicker});\n    }\n\n    hideEmojiPicker = () => {\n        this.setState({showEmojiPicker: false});\n    }\n\n    handleEmojiClick = (emoji) => {\n        const emojiAlias = emoji.name || emoji.aliases[0];\n\n        if (!emojiAlias) {\n            //Oops.. There went something wrong\n            return;\n        }\n\n        const {draft} = this.state;\n\n        let newMessage = '';\n        if (draft.message === '') {\n            newMessage = `:${emojiAlias}: `;\n        } else {\n            const {draft: {message}} = this.state;\n            const {firstPiece, lastPiece} = splitMessageBasedOnCaretPosition(this.state.caretPosition, message);\n\n            // check whether the first piece of the message is empty when cursor is placed at beginning of message and avoid adding an empty string at the beginning of the message\n            newMessage = firstPiece === '' ? `:${emojiAlias}: ${lastPiece} ` : `${firstPiece} :${emojiAlias}: ${lastPiece} `;\n\n            const newCaretPosition = firstPiece === '' ? `:${emojiAlias}: `.length : `${firstPiece} :${emojiAlias}: `.length;\n\n            const textbox = this.refs.textbox.getWrappedInstance().getInputBox();\n\n            this.setState({\n                caretPosition: newCaretPosition,\n            }, () => {\n                Utils.setCaretPosition(textbox, newCaretPosition);\n            });\n        }\n\n        const modifiedDraft = {\n            ...draft,\n            message: newMessage,\n        };\n\n        this.props.onUpdateCommentDraft(modifiedDraft);\n        this.draftsForPost[this.props.rootId] = modifiedDraft;\n\n        this.setState({\n            showEmojiPicker: false,\n            draft: modifiedDraft,\n        });\n    }\n\n    handleGifClick = (gif) => {\n        const {draft} = this.state;\n\n        let newMessage = '';\n        if (draft.message === '') {\n            newMessage = gif;\n        } else if ((/\\s+$/).test(draft.message)) {\n            // Check whether there is already a blank at the end of the current message\n            newMessage = `${draft.message}${gif} `;\n        } else {\n            newMessage = `${draft.message} ${gif} `;\n        }\n\n        const modifiedDraft = {\n            ...draft,\n            message: newMessage,\n        };\n\n        this.props.onUpdateCommentDraft(modifiedDraft);\n        this.draftsForPost[this.props.rootId] = modifiedDraft;\n\n        this.setState({\n            showEmojiPicker: false,\n            draft: modifiedDraft,\n        });\n\n        this.focusTextbox();\n    }\n\n    handlePostError = (postError) => {\n        this.setState({postError});\n    }\n\n    handleSubmit = async (e) => {\n        e.preventDefault();\n        this.updatePreview(false);\n\n        const {channelMembersCount, enableConfirmNotificationsToChannel, useChannelMentions, isTimezoneEnabled} = this.props;\n        const {draft} = this.state;\n        if (!useChannelMentions && containsAtChannel(draft.message, {checkAllMentions: true})) {\n            const updatedDraft = {\n                ...draft,\n                props: {\n                    ...draft.props,\n                    mentionHighlightDisabled: true,\n                },\n            };\n\n            this.props.onUpdateCommentDraft(updatedDraft);\n            this.setState({draft: updatedDraft});\n        }\n\n        if (enableConfirmNotificationsToChannel && useChannelMentions &&\n            channelMembersCount > Constants.NOTIFY_ALL_MEMBERS &&\n            containsAtChannel(this.state.draft.message)) {\n            if (isTimezoneEnabled) {\n                const {data} = await this.props.getChannelTimezones(this.props.channelId);\n                if (data) {\n                    this.setState({channelTimezoneCount: data.length});\n                } else {\n                    this.setState({channelTimezoneCount: 0});\n                }\n            }\n            this.showNotifyAllModal();\n            return;\n        }\n\n        await this.doSubmit(e);\n    }\n\n    doSubmit = async (e) => {\n        if (e) {\n            e.preventDefault();\n        }\n\n        const {draft} = this.state;\n        const enableAddButton = this.shouldEnableAddButton();\n\n        if (!enableAddButton) {\n            return;\n        }\n\n        if (draft.uploadsInProgress.length > 0) {\n            return;\n        }\n\n        if (this.state.postError) {\n            this.setState({errorClass: 'animation--highlight'});\n            setTimeout(() => {\n                this.setState({errorClass: null});\n            }, Constants.ANIMATION_TIMEOUT);\n            return;\n        }\n\n        if (this.props.rootDeleted) {\n            this.showPostDeletedModal();\n            return;\n        }\n\n        const fasterThanHumanWillClick = 150;\n        const forceFocus = (Date.now() - this.lastBlurAt < fasterThanHumanWillClick);\n        this.focusTextbox(forceFocus);\n\n        const serverError = this.state.serverError;\n        let ignoreSlash = false;\n        if (isErrorInvalidSlashCommand(serverError) && draft.message === serverError.submittedMessage) {\n            ignoreSlash = true;\n        }\n\n        const options = {ignoreSlash};\n\n        try {\n            await this.props.onSubmit(options);\n\n            this.setState({\n                postError: null,\n                serverError: null,\n            });\n        } catch (err) {\n            if (isErrorInvalidSlashCommand(err)) {\n                this.props.onUpdateCommentDraft(draft);\n            }\n            err.submittedMessage = draft.message;\n            this.setState({serverError: err});\n            return;\n        }\n\n        this.setState({draft: {...this.props.draft, uploadsInProgress: []}});\n    }\n\n    commentMsgKeyPress = (e) => {\n        const {\n            ctrlSend,\n            codeBlockOnCtrlEnter,\n        } = this.props;\n\n        const {allowSending, withClosedCodeBlock, message} = postMessageOnKeyPress(e, this.state.draft.message, ctrlSend, codeBlockOnCtrlEnter, 0, 0, this.state.caretPosition);\n\n        if (allowSending) {\n            e.persist();\n            if (this.refs.textbox) {\n                this.refs.textbox.getWrappedInstance().blur();\n            }\n\n            if (withClosedCodeBlock && message) {\n                const {draft} = this.state;\n                const updatedDraft = {...draft, message};\n                this.props.onUpdateCommentDraft(updatedDraft);\n                this.setState({draft: updatedDraft}, () => this.handleSubmit(e));\n                this.draftsForPost[this.props.rootId] = updatedDraft;\n            } else {\n                this.handleSubmit(e);\n            }\n\n            this.updatePreview(false);\n            setTimeout(() => {\n                this.focusTextbox();\n            });\n        }\n\n        this.emitTypingEvent();\n    }\n\n    reactToLastMessage = (e) => {\n        e.preventDefault();\n\n        const {emitShortcutReactToLastPostFrom} = this.props;\n\n        // Here we are not handling conditions such as check for modals,  popups etc as shortcut is only trigger on\n        // textbox input focus. Since all of them will already be closed as soon as they loose focus.\n        emitShortcutReactToLastPostFrom(Locations.RHS_ROOT);\n    }\n\n    emitTypingEvent = () => {\n        const {channelId, rootId} = this.props;\n        GlobalActions.emitLocalUserTypingEvent(channelId, rootId);\n    }\n\n    scrollToBottom = () => {\n        const $el = $('.post-right__scroll');\n        if ($el[0]) {\n            $el.parent().scrollTop($el[0].scrollHeight);\n        }\n    }\n\n    handleChange = (e) => {\n        const message = e.target.value;\n\n        let serverError = this.state.serverError;\n        if (isErrorInvalidSlashCommand(serverError)) {\n            serverError = null;\n        }\n\n        const {draft} = this.state;\n        const updatedDraft = {...draft, message};\n        this.props.onUpdateCommentDraft(updatedDraft);\n        this.setState({draft: updatedDraft, serverError}, () => {\n            this.scrollToBottom();\n        });\n        this.draftsForPost[this.props.rootId] = updatedDraft;\n    }\n\n    handleMouseUpKeyUp = (e) => {\n        const caretPosition = Utils.getCaretPosition(e.target);\n        this.setState({\n            caretPosition,\n        });\n    }\n\n    handleKeyDown = (e) => {\n        const ctrlOrMetaKeyPressed = e.ctrlKey || e.metaKey;\n        const lastMessageReactionKeyCombo = ctrlOrMetaKeyPressed && e.shiftKey && Utils.isKeyPressed(e, KeyCodes.BACK_SLASH);\n\n        if (\n            (this.props.ctrlSend || this.props.codeBlockOnCtrlEnter) &&\n            Utils.isKeyPressed(e, Constants.KeyCodes.ENTER) &&\n            (e.ctrlKey || e.metaKey)\n        ) {\n            this.updatePreview(false);\n            this.commentMsgKeyPress(e);\n            return;\n        }\n\n        const {draft} = this.state;\n        const {message} = draft;\n\n        if (!e.ctrlKey && !e.metaKey && !e.altKey && !e.shiftKey && Utils.isKeyPressed(e, Constants.KeyCodes.UP) && message === '') {\n            e.preventDefault();\n            if (this.refs.textbox) {\n                this.refs.textbox.getWrappedInstance().blur();\n            }\n\n            const {data: canEditNow} = this.props.onEditLatestPost();\n            if (!canEditNow) {\n                this.focusTextbox(true);\n            }\n        }\n\n        if ((e.ctrlKey || e.metaKey) && !e.altKey && !e.shiftKey) {\n            if (Utils.isKeyPressed(e, Constants.KeyCodes.UP)) {\n                e.preventDefault();\n                this.props.onMoveHistoryIndexBack();\n            } else if (Utils.isKeyPressed(e, Constants.KeyCodes.DOWN)) {\n                e.preventDefault();\n                this.props.onMoveHistoryIndexForward();\n            }\n        }\n\n        if (lastMessageReactionKeyCombo) {\n            this.reactToLastMessage(e);\n        }\n    }\n\n    handleFileUploadChange = () => {\n        this.focusTextbox();\n    }\n\n    handleUploadStart = (clientIds) => {\n        const {draft} = this.state;\n        const uploadsInProgress = [...draft.uploadsInProgress, ...clientIds];\n\n        const modifiedDraft = {\n            ...draft,\n            uploadsInProgress,\n        };\n        this.props.onUpdateCommentDraft(modifiedDraft);\n        this.setState({draft: modifiedDraft});\n        this.draftsForPost[this.props.rootId] = modifiedDraft;\n\n        // this is a bit redundant with the code that sets focus when the file input is clicked,\n        // but this also resets the focus after a drag and drop\n        this.focusTextbox();\n    }\n\n    handleUploadProgress = ({clientId, name, percent, type}) => {\n        const uploadsProgressPercent = {...this.state.uploadsProgressPercent, [clientId]: {percent, name, type}};\n        this.setState({uploadsProgressPercent});\n    }\n\n    handleFileUploadComplete = (fileInfos, clientIds, channelId, rootId) => {\n        const draft = this.draftsForPost[rootId];\n        const uploadsInProgress = [...draft.uploadsInProgress];\n        const newFileInfos = sortFileInfos([...draft.fileInfos, ...fileInfos], this.props.locale);\n\n        // remove each finished file from uploads\n        for (let i = 0; i < clientIds.length; i++) {\n            const index = uploadsInProgress.indexOf(clientIds[i]);\n\n            if (index !== -1) {\n                uploadsInProgress.splice(index, 1);\n            }\n        }\n\n        const modifiedDraft = {\n            ...draft,\n            fileInfos: newFileInfos,\n            uploadsInProgress,\n        };\n        this.props.updateCommentDraftWithRootId(rootId, modifiedDraft);\n        this.draftsForPost[rootId] = modifiedDraft;\n        if (this.props.rootId === rootId) {\n            this.setState({draft: modifiedDraft});\n        }\n    }\n\n    handleUploadError = (err, clientId = -1, currentChannelId, rootId = -1) => {\n        if (clientId !== -1) {\n            const draft = {...this.draftsForPost[rootId]};\n            const uploadsInProgress = [...draft.uploadsInProgress];\n\n            const index = uploadsInProgress.indexOf(clientId);\n            if (index !== -1) {\n                uploadsInProgress.splice(index, 1);\n            }\n\n            const modifiedDraft = {\n                ...draft,\n                uploadsInProgress,\n            };\n            this.props.updateCommentDraftWithRootId(rootId, modifiedDraft);\n            this.draftsForPost[rootId] = modifiedDraft;\n            if (this.props.rootId === rootId) {\n                this.setState({draft: modifiedDraft});\n            }\n        }\n\n        let serverError = err;\n        if (err && typeof err === 'string') {\n            serverError = new Error(err);\n        }\n\n        this.setState({serverError}, () => {\n            if (serverError) {\n                this.scrollToBottom();\n            }\n        });\n    }\n\n    removePreview = (id) => {\n        const {draft} = this.state;\n        const fileInfos = [...draft.fileInfos];\n        const uploadsInProgress = [...draft.uploadsInProgress];\n\n        // Clear previous errors\n        this.handleUploadError(null);\n\n        // id can either be the id of an uploaded file or the client id of an in progress upload\n        let index = fileInfos.findIndex((info) => info.id === id);\n        if (index === -1) {\n            index = uploadsInProgress.indexOf(id);\n\n            if (index !== -1) {\n                uploadsInProgress.splice(index, 1);\n\n                if (this.refs.fileUpload && this.refs.fileUpload.getWrappedInstance()) {\n                    this.refs.fileUpload.getWrappedInstance().cancelUpload(id);\n                }\n            }\n        } else {\n            fileInfos.splice(index, 1);\n        }\n\n        const modifiedDraft = {\n            ...draft,\n            fileInfos,\n            uploadsInProgress,\n        };\n\n        this.props.onUpdateCommentDraft(modifiedDraft);\n        this.setState({draft: modifiedDraft});\n        this.draftsForPost[this.props.rootId] = modifiedDraft;\n\n        this.handleFileUploadChange();\n    }\n\n    getFileCount = () => {\n        const {\n            draft: {\n                fileInfos,\n                uploadsInProgress,\n            },\n        } = this.state;\n        return fileInfos.length + uploadsInProgress.length;\n    }\n\n    getFileUploadTarget = () => {\n        return this.refs.textbox.getWrappedInstance();\n    }\n\n    getCreateCommentControls = () => {\n        return this.refs.createCommentControls;\n    }\n\n    shouldEnableAddButton = () => {\n        if (this.props.enableAddButton) {\n            return true;\n        }\n\n        return isErrorInvalidSlashCommand(this.state.serverError);\n    }\n\n    focusTextbox = (keepFocus = false) => {\n        if (this.refs.textbox && (keepFocus || !UserAgent.isMobile())) {\n            this.refs.textbox.getWrappedInstance().focus();\n        }\n    }\n\n    showPostDeletedModal = () => {\n        this.setState({\n            showPostDeletedModal: true,\n        });\n    }\n\n    hidePostDeletedModal = () => {\n        this.setState({\n            showPostDeletedModal: false,\n        });\n\n        this.props.resetCreatePostRequest();\n    }\n\n    handleBlur = () => {\n        this.lastBlurAt = Date.now();\n    }\n\n    handleHeightChange = (height, maxHeight) => {\n        this.setState({renderScrollbar: height > maxHeight});\n    }\n\n    render() {\n        const {draft} = this.state;\n        const readOnlyChannel = this.props.readOnlyChannel || !this.props.canPost;\n        const {formatMessage} = this.props.intl;\n        const enableAddButton = this.shouldEnableAddButton();\n        const {renderScrollbar} = this.state;\n        const ariaLabelReplyInput = Utils.localizeMessage('accessibility.sections.rhsFooter', 'reply input region');\n\n        const notifyAllTitle = (\n            <FormattedMessage\n                id='notify_all.title.confirm'\n                defaultMessage='Confirm sending notifications to entire channel'\n            />\n        );\n\n        const notifyAllConfirm = (\n            <FormattedMessage\n                id='notify_all.confirm'\n                defaultMessage='Confirm'\n            />\n        );\n\n        let notifyAllMessage = '';\n        if (this.state.channelTimezoneCount && this.props.isTimezoneEnabled) {\n            notifyAllMessage = (\n                <FormattedMarkdownMessage\n                    id='notify_all.question_timezone'\n                    defaultMessage='By using @all or @channel you are about to send notifications to **{totalMembers} people** in **{timezones, number} {timezones, plural, one {timezone} other {timezones}}**. Are you sure you want to do this?'\n                    values={{\n                        totalMembers: this.props.channelMembersCount - 1,\n                        timezones: this.state.channelTimezoneCount,\n                    }}\n                />\n            );\n        } else {\n            notifyAllMessage = (\n                <FormattedMessage\n                    id='notify_all.question'\n                    defaultMessage='By using @all or @channel you are about to send notifications to {totalMembers} people. Are you sure you want to do this?'\n                    values={{\n                        totalMembers: this.props.channelMembersCount - 1,\n                    }}\n                />\n            );\n        }\n\n        let serverError = null;\n        if (this.state.serverError) {\n            serverError = (\n                <MessageSubmitError\n                    id='postServerError'\n                    error={this.state.serverError}\n                    submittedMessage={this.state.serverError.submittedMessage}\n                    handleSubmit={this.handleSubmit}\n                />\n            );\n        }\n\n        let postError = null;\n        if (this.state.postError) {\n            const postErrorClass = 'post-error' + (this.state.errorClass ? (' ' + this.state.errorClass) : '');\n            postError = <label className={postErrorClass}>{this.state.postError}</label>;\n        }\n\n        let preview = null;\n        if (!readOnlyChannel && (draft.fileInfos.length > 0 || draft.uploadsInProgress.length > 0)) {\n            preview = (\n                <FilePreview\n                    fileInfos={draft.fileInfos}\n                    onRemove={this.removePreview}\n                    uploadsInProgress={draft.uploadsInProgress}\n                    uploadsProgressPercent={this.state.uploadsProgressPercent}\n                    ref='preview'\n                />\n            );\n        }\n\n        let uploadsInProgressText = null;\n        if (draft.uploadsInProgress.length > 0) {\n            uploadsInProgressText = (\n                <span className='post-right-comments-upload-in-progress'>\n                    {draft.uploadsInProgress.length === 1 ? (\n                        <FormattedMessage\n                            id='create_comment.file'\n                            defaultMessage='File uploading'\n                        />\n                    ) : (\n                        <FormattedMessage\n                            id='create_comment.files'\n                            defaultMessage='Files uploading'\n                        />\n                    )}\n                </span>\n            );\n        }\n\n        let addButtonClass = 'btn btn-primary comment-btn';\n        if (!enableAddButton) {\n            addButtonClass += ' disabled';\n        }\n\n        let fileUpload;\n        if (!readOnlyChannel && !this.state.showPreview) {\n            fileUpload = (\n                <FileUpload\n                    ref='fileUpload'\n                    fileCount={this.getFileCount()}\n                    getTarget={this.getFileUploadTarget}\n                    onFileUploadChange={this.handleFileUploadChange}\n                    onUploadStart={this.handleUploadStart}\n                    onFileUpload={this.handleFileUploadComplete}\n                    onUploadError={this.handleUploadError}\n                    onUploadProgress={this.handleUploadProgress}\n                    rootId={this.props.rootId}\n                    postType='comment'\n                />\n            );\n        }\n\n        let emojiPicker = null;\n        const emojiButtonAriaLabel = formatMessage({id: 'emoji_picker.emojiPicker', defaultMessage: 'Emoji Picker'}).toLowerCase();\n\n        if (this.props.enableEmojiPicker && !readOnlyChannel && !this.state.showPreview) {\n            emojiPicker = (\n                <div>\n                    <EmojiPickerOverlay\n                        show={this.state.showEmojiPicker}\n                        target={this.getCreateCommentControls}\n                        onHide={this.hideEmojiPicker}\n                        onEmojiClose={this.hideEmojiPicker}\n                        onEmojiClick={this.handleEmojiClick}\n                        onGifClick={this.handleGifClick}\n                        enableGifPicker={this.props.enableGifPicker}\n                        topOffset={55}\n                    />\n                    <button\n                        aria-label={emojiButtonAriaLabel}\n                        type='button'\n                        onClick={this.toggleEmojiPicker}\n                        className='style--none emoji-picker__container post-action'\n                    >\n                        <EmojiIcon className={'icon icon--emoji emoji-rhs ' + (this.state.showEmojiPicker ? 'active' : '')}/>\n                    </button>\n                </div>\n            );\n        }\n\n        let createMessage;\n        if (readOnlyChannel) {\n            createMessage = Utils.localizeMessage('create_post.read_only', 'This channel is read-only. Only members with permission can post here.');\n        } else {\n            createMessage = Utils.localizeMessage('create_comment.addComment', 'Add a comment...');\n        }\n\n        let scrollbarClass = '';\n        if (renderScrollbar) {\n            scrollbarClass = ' scroll';\n        }\n\n        const textboxRef = this.refs.textbox;\n        if (textboxRef) {\n            const textboxPosTop = textboxRef.getWrappedInstance().getInputBox().getBoundingClientRect().top;\n            if (textboxPosTop < Constants.SUGGESTION_LIST_SPACE_RHS) {\n                this.setState({suggestionListStyle: 'bottom'});\n            } else {\n                this.setState({suggestionListStyle: 'top'});\n            }\n        }\n\n        return (\n            <form onSubmit={this.handleSubmit}>\n                <div\n                    role='form'\n                    id='rhsFooter'\n                    aria-label={ariaLabelReplyInput}\n                    tabIndex='-1'\n                    className={`post-create a11y__region${scrollbarClass}`}\n                    data-a11y-sort-order='4'\n                >\n                    <div\n                        id={this.props.rootId}\n                        className='post-create-body comment-create-body'\n                    >\n                        <div className='post-body__cell'>\n                            <Textbox\n                                onChange={this.handleChange}\n                                onKeyPress={this.commentMsgKeyPress}\n                                onKeyDown={this.handleKeyDown}\n                                onMouseUp={this.handleMouseUpKeyUp}\n                                onKeyUp={this.handleMouseUpKeyUp}\n                                onComposition={this.emitTypingEvent}\n                                onHeightChange={this.handleHeightChange}\n                                handlePostError={this.handlePostError}\n                                value={readOnlyChannel ? '' : draft.message}\n                                onBlur={this.handleBlur}\n                                createMessage={createMessage}\n                                emojiEnabled={this.props.enableEmojiPicker}\n                                initialText=''\n                                channelId={this.props.channelId}\n                                isRHS={true}\n                                popoverMentionKeyClick={true}\n                                id='reply_textbox'\n                                ref='textbox'\n                                disabled={readOnlyChannel}\n                                characterLimit={this.props.maxPostSize}\n                                preview={this.state.showPreview}\n                                suggestionListStyle={this.state.suggestionListStyle}\n                                badConnection={this.props.badConnection}\n                                listenForMentionKeyClick={true}\n                                useChannelMentions={this.props.useChannelMentions}\n                            />\n                            <span\n                                ref='createCommentControls'\n                                className='post-body__actions'\n                            >\n                                {fileUpload}\n                                {emojiPicker}\n                            </span>\n                        </div>\n                    </div>\n                    <div\n                        className='post-create-footer'\n                    >\n                        <div className='d-flex justify-content-between'>\n                            <div className='col'>\n                                <MsgTyping\n                                    channelId={this.props.channelId}\n                                    postId={this.props.rootId}\n                                />\n                                {postError}\n                            </div>\n                            <div className='col col-auto'>\n                                <TextboxLinks\n                                    characterLimit={this.props.maxPostSize}\n                                    showPreview={this.state.showPreview}\n                                    updatePreview={this.updatePreview}\n                                    message={readOnlyChannel ? '' : this.state.message}\n                                    isMarkdownPreviewEnabled={this.props.isMarkdownPreviewEnabled}\n                                />\n                            </div>\n                        </div>\n                        <div className='text-right mt-2'>\n                            {uploadsInProgressText}\n                            <input\n                                type='button'\n                                disabled={!enableAddButton}\n                                id='addCommentButton'\n                                className={addButtonClass}\n                                value={formatMessage({id: 'create_comment.comment', defaultMessage: 'Add Comment'})}\n                                onClick={this.handleSubmit}\n                            />\n                            {preview}\n                            {serverError}\n                        </div>\n                    </div>\n                </div>\n                <PostDeletedModal\n                    show={this.state.showPostDeletedModal}\n                    onHide={this.hidePostDeletedModal}\n                />\n                <ConfirmModal\n                    title={notifyAllTitle}\n                    message={notifyAllMessage}\n                    confirmButtonText={notifyAllConfirm}\n                    show={this.state.showConfirmModal}\n                    onConfirm={this.handleNotifyAllConfirmation}\n                    onCancel={this.hideNotifyAllModal}\n                />\n            </form>\n        );\n    }\n}\n\nexport default injectIntl(CreateComment);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {isCurrentUserSystemAdmin} from 'mattermost-redux/selectors/entities/users';\nimport {haveIChannelPermission} from 'mattermost-redux/selectors/entities/roles';\nimport {getBool} from 'mattermost-redux/selectors/entities/preferences';\nimport {getAllChannelStats} from 'mattermost-redux/selectors/entities/channels';\nimport {makeGetMessageInHistoryItem} from 'mattermost-redux/selectors/entities/posts';\nimport {resetCreatePostRequest, resetHistoryIndex} from 'mattermost-redux/actions/posts';\nimport {getChannelTimezones} from 'mattermost-redux/actions/channels';\nimport {Permissions, Preferences, Posts} from 'mattermost-redux/constants';\n\nimport {connectionErrorCount} from 'selectors/views/system';\n\nimport {Constants, StoragePrefixes} from 'utils/constants';\nimport {getCurrentLocale} from 'selectors/i18n';\n\nimport {\n    clearCommentDraftUploads,\n    updateCommentDraft,\n    makeOnMoveHistoryIndex,\n    makeOnSubmit,\n    makeOnEditLatestPost,\n} from 'actions/views/create_comment';\nimport {emitShortcutReactToLastPostFrom} from 'actions/post_actions';\nimport {getPostDraft, getIsRhsExpanded, getSelectedPostFocussedAt} from 'selectors/rhs';\n\nimport CreateComment from './create_comment.jsx';\n\nfunction makeMapStateToProps() {\n    const getMessageInHistoryItem = makeGetMessageInHistoryItem(Posts.MESSAGE_TYPES.COMMENT);\n\n    return (state, ownProps) => {\n        const err = state.requests.posts.createPost.error || {};\n\n        const draft = getPostDraft(state, StoragePrefixes.COMMENT_DRAFT, ownProps.rootId);\n        const enableAddButton = draft.message.trim().length !== 0 || draft.fileInfos.length !== 0;\n\n        const channelMembersCount = getAllChannelStats(state)[ownProps.channelId] ? getAllChannelStats(state)[ownProps.channelId].member_count : 1;\n        const messageInHistory = getMessageInHistoryItem(state);\n\n        const channel = state.entities.channels.channels[ownProps.channelId] || {};\n\n        const config = getConfig(state);\n        const enableConfirmNotificationsToChannel = config.EnableConfirmNotificationsToChannel === 'true';\n        const enableEmojiPicker = config.EnableEmojiPicker === 'true';\n        const enableGifPicker = config.EnableGifPicker === 'true';\n        const badConnection = connectionErrorCount(state) > 1;\n        const isTimezoneEnabled = config.ExperimentalTimezone === 'true';\n        const canPost = haveIChannelPermission(\n            state,\n            {\n                channel: channel.id,\n                team: channel.team_id,\n                permission: Permissions.CREATE_POST,\n            }\n        );\n        const useChannelMentions = haveIChannelPermission(state, {\n            channel: channel.id,\n            team: channel.team_id,\n            permission: Permissions.USE_CHANNEL_MENTIONS,\n        });\n\n        return {\n            draft,\n            messageInHistory,\n            enableAddButton,\n            channelMembersCount,\n            codeBlockOnCtrlEnter: getBool(state, Preferences.CATEGORY_ADVANCED_SETTINGS, 'code_block_ctrl_enter', true),\n            ctrlSend: getBool(state, Preferences.CATEGORY_ADVANCED_SETTINGS, 'send_on_ctrl_enter'),\n            createPostErrorId: err.server_error_id,\n            readOnlyChannel: !isCurrentUserSystemAdmin(state) && config.ExperimentalTownSquareIsReadOnly === 'true' && channel.name === Constants.DEFAULT_CHANNEL,\n            enableConfirmNotificationsToChannel,\n            enableEmojiPicker,\n            enableGifPicker,\n            locale: getCurrentLocale(state),\n            maxPostSize: parseInt(config.MaxPostSize, 10) || Constants.DEFAULT_CHARACTER_LIMIT,\n            rhsExpanded: getIsRhsExpanded(state),\n            badConnection,\n            isTimezoneEnabled,\n            selectedPostFocussedAt: getSelectedPostFocussedAt(state),\n            canPost,\n            useChannelMentions,\n        };\n    };\n}\n\nfunction makeOnUpdateCommentDraft(rootId) {\n    return (draft) => updateCommentDraft(rootId, draft);\n}\n\nfunction makeMapDispatchToProps() {\n    let onUpdateCommentDraft;\n    let onSubmit;\n    let onMoveHistoryIndexBack;\n    let onMoveHistoryIndexForward;\n    let onEditLatestPost;\n\n    function onResetHistoryIndex() {\n        return resetHistoryIndex(Posts.MESSAGE_TYPES.COMMENT);\n    }\n\n    let rootId;\n    let channelId;\n    let latestPostId;\n\n    return (dispatch, ownProps) => {\n        if (rootId !== ownProps.rootId) {\n            onUpdateCommentDraft = makeOnUpdateCommentDraft(ownProps.rootId);\n            onMoveHistoryIndexBack = makeOnMoveHistoryIndex(ownProps.rootId, -1);\n            onMoveHistoryIndexForward = makeOnMoveHistoryIndex(ownProps.rootId, 1);\n        }\n\n        if (rootId !== ownProps.rootId || channelId !== ownProps.channelId) {\n            onEditLatestPost = makeOnEditLatestPost(ownProps.channelId, ownProps.rootId);\n        }\n\n        if (rootId !== ownProps.rootId || channelId !== ownProps.channelId || latestPostId !== ownProps.latestPostId) {\n            onSubmit = makeOnSubmit(ownProps.channelId, ownProps.rootId, ownProps.latestPostId);\n        }\n\n        rootId = ownProps.rootId;\n        channelId = ownProps.channelId;\n        latestPostId = ownProps.latestPostId;\n\n        return bindActionCreators({\n            clearCommentDraftUploads,\n            onUpdateCommentDraft,\n            updateCommentDraftWithRootId: updateCommentDraft,\n            onSubmit,\n            onResetHistoryIndex,\n            onMoveHistoryIndexBack,\n            onMoveHistoryIndexForward,\n            onEditLatestPost,\n            resetCreatePostRequest,\n            getChannelTimezones,\n            emitShortcutReactToLastPostFrom\n        }, dispatch);\n    };\n}\n\nexport default connect(makeMapStateToProps, makeMapDispatchToProps)(CreateComment);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {\n    FormattedMessage,\n    injectIntl,\n    IntlShape,\n} from 'react-intl';\nimport moment from 'moment-timezone';\n\ntype Props = {\n    timeZone?: string;\n    value: number | Date;\n    children?(val: string): React.ReactElement | null;\n    intl: IntlShape;\n}\n\nclass RecentDate extends React.PureComponent<Props> {\n    public render() {\n        const {value, timeZone} = this.props;\n        const date = new Date(value);\n\n        if (isToday(date)) {\n            return (\n                <FormattedMessage\n                    id='date_separator.today'\n                    defaultMessage='Today'\n                />\n            );\n        } else if (isYesterday(date)) {\n            return (\n                <FormattedMessage\n                    id='date_separator.yesterday'\n                    defaultMessage='Yesterday'\n                />\n            );\n        }\n\n        const options = {\n            timeZone,\n            weekday: 'short',\n            month: 'short',\n            day: '2-digit',\n            year: 'numeric'\n        };\n        const formattedDate = this.props.intl.formatDate(value, options);\n\n        // On error, `formatDate` returns unformatted date or value string like in the case of (react-intl) unsupported timezone.\n        // Therefore, use react-intl by default or moment-timezone for unsupported timezone.\n        if (formattedDate !== String(date) && formattedDate !== String(value)) {\n            return formattedDate;\n        }\n\n        const momentDate = value ? moment(value) : moment();\n\n        if (timeZone) {\n            momentDate.tz(timeZone);\n        }\n\n        return momentDate.format('ddd, MMM D, YYYY');\n    }\n}\n\nexport function isSameDay(a: Date, b: Date) {\n    return a.getDate() === b.getDate() && a.getMonth() === b.getMonth() && a.getFullYear() === b.getFullYear();\n}\n\nexport function isToday(date: Date) {\n    const now = new Date();\n\n    return isSameDay(date, now);\n}\n\nexport function isYesterday(date: Date) {\n    const yesterday = new Date();\n    yesterday.setDate(yesterday.getDate() - 1);\n\n    return isSameDay(date, yesterday);\n}\n\nexport default injectIntl(RecentDate);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport './separator.scss';\n\nexport default class BasicSeparator extends React.PureComponent<React.PropsWithChildren<{}>> {\n    public render() {\n        const {children} = this.props;\n        return (\n            <div\n                data-testid='basicSeparator'\n                className='Separator BasicSeparator'\n            >\n                <hr className='separator__hr'/>\n                {children && (\n                    <div className='separator__text'>\n                        {children}\n                    </div>\n                )}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport RecentDate from 'components/recent_date';\n\nimport BasicSeparator from 'components/widgets/separator/basic-separator';\n\nexport default class DateSeparator extends React.PureComponent {\n    static propTypes = {\n        date: PropTypes.oneOfType([\n            PropTypes.number,\n            PropTypes.instanceOf(Date),\n        ]).isRequired,\n        timeZone: PropTypes.string,\n        enableTimezone: PropTypes.bool,\n    }\n\n    render() {\n        const {\n            date,\n            enableTimezone,\n            timeZone,\n        } = this.props;\n        const timezoneProps = enableTimezone && timeZone ? {timeZone} : {};\n\n        return (\n            <BasicSeparator>\n                <RecentDate\n                    {...timezoneProps}\n                    value={date}\n                    weekday='short'\n                    month='short'\n                    day='2-digit'\n                    year='numeric'\n                />\n            </BasicSeparator>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getUserTimezone} from 'mattermost-redux/selectors/entities/timezone';\nimport {getUserCurrentTimezone} from 'mattermost-redux/utils/timezone_utils';\n\nimport {areTimezonesEnabledAndSupported} from 'selectors/general';\n\nimport DateSeparator from './date_separator';\n\nfunction mapStateToProps(state, props) {\n    const currentUserId = getCurrentUserId(state);\n\n    let userTimezone;\n    if (props.userTimezone) {\n        userTimezone = props.userTimezone;\n    } else {\n        userTimezone = getUserTimezone(state, currentUserId);\n    }\n\n    return {\n        enableTimezone: areTimezonesEnabledAndSupported(state),\n        timeZone: getUserCurrentTimezone(userTimezone),\n    };\n}\n\nexport default connect(mapStateToProps)(DateSeparator);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classNames from 'classnames';\n\nimport RecentDate from 'components/recent_date';\n\nexport default class FloatingTimestamp extends React.PureComponent {\n    static propTypes = {\n        isScrolling: PropTypes.bool.isRequired,\n        isMobile: PropTypes.bool,\n        createAt: PropTypes.oneOfType([\n            PropTypes.instanceOf(Date),\n            PropTypes.number,\n        ]).isRequired,\n        toastPresent: PropTypes.bool,\n        isRhsPost: PropTypes.bool,\n    }\n\n    render() {\n        const {isMobile, createAt, isScrolling, isRhsPost, toastPresent} = this.props;\n\n        if (!isMobile || createAt === 0) {\n            return null;\n        }\n\n        const dateString = (\n            <RecentDate\n                value={createAt}\n                weekday='short'\n                day='2-digit'\n                month='short'\n                year='numeric'\n            />\n        );\n\n        const classes = classNames('post-list__timestamp', {\n            scrolling: isScrolling,\n            rhs: isRhsPost,\n            toastAdjustment: toastPresent,\n        });\n\n        return (\n            <div\n                className={classes}\n                data-testid='floatingTimestamp'\n            >\n                <div>\n                    <span>{dateString}</span>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getPost} from 'mattermost-redux/selectors/entities/posts';\nimport * as PostListUtils from 'mattermost-redux/utils/post_list';\n\nimport {getToastStatus} from 'selectors/views/channel';\n\nimport FloatingTimestamp from './floating_timestamp';\n\nfunction mapStateToProps(state, ownProps) {\n    let postId = ownProps.postId;\n    if (PostListUtils.isCombinedUserActivityPost(postId)) {\n        const combinedIds = PostListUtils.getPostIdsForCombinedUserActivityPost(postId);\n\n        postId = combinedIds[combinedIds.length - 1];\n    }\n\n    const post = getPost(state, postId);\n\n    const toastPresent = getToastStatus(state);\n    return {\n        createAt: post ? post.create_at : 0,\n        toastPresent,\n    };\n}\n\nexport default connect(mapStateToProps)(FloatingTimestamp);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nexport default class ChannelPermissionGate extends React.Component {\n    static defaultProps = {\n        invert: false,\n    }\n\n    static propTypes = {\n\n        /**\n         * Channel to check the permission\n         */\n        channelId: PropTypes.string,\n\n        /**\n         * Team to check the permission\n         */\n        teamId: PropTypes.string,\n\n        /**\n         * Permissions enough to pass the gate (binary OR)\n         */\n        permissions: PropTypes.arrayOf(PropTypes.string).isRequired,\n\n        /**\n         * Has permission\n         */\n        hasPermission: PropTypes.bool.isRequired,\n\n        /**\n         * Invert the permission (used for else)\n         */\n        invert: PropTypes.bool.isRequired,\n\n        /**\n         * Content protected by the permissions gate\n         */\n        children: PropTypes.node.isRequired,\n    };\n\n    render() {\n        if (this.props.hasPermission && !this.props.invert) {\n            return this.props.children;\n        }\n        if (!this.props.hasPermission && this.props.invert) {\n            return this.props.children;\n        }\n        return null;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {haveIChannelPermission} from 'mattermost-redux/selectors/entities/roles';\n\nimport ChannelPermissionGate from './channel_permission_gate.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    if (!ownProps.channelId || ownProps.teamId === null || typeof ownProps.teamId === 'undefined') {\n        return {hasPermission: false};\n    }\n\n    for (const permission of ownProps.permissions) {\n        if (haveIChannelPermission(state, {channel: ownProps.channelId, team: ownProps.teamId, permission})) {\n            return {hasPermission: true};\n        }\n    }\n\n    return {hasPermission: false};\n}\n\nexport default connect(mapStateToProps)(ChannelPermissionGate);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport {Tooltip} from 'react-bootstrap';\n\nimport Permissions from 'mattermost-redux/constants/permissions';\n\nimport {Locations, ModalIdentifiers, Constants} from 'utils/constants';\nimport DeletePostModal from 'components/delete_post_modal';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport DelayedAction from 'utils/delayed_action';\nimport * as PostUtils from 'utils/post_utils.jsx';\nimport * as Utils from 'utils/utils.jsx';\nimport ChannelPermissionGate from 'components/permissions_gates/channel_permission_gate';\n\nimport Pluggable from 'plugins/pluggable';\n\nimport Menu from 'components/widgets/menu/menu';\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\n\nconst MENU_BOTTOM_MARGIN = 80;\n\nexport const PLUGGABLE_COMPONENT = 'PostDropdownMenuItem';\n\nexport default class DotMenu extends React.PureComponent {\n    static propTypes = {\n        post: PropTypes.object.isRequired,\n        teamId: PropTypes.string,\n        location: PropTypes.oneOf([Locations.CENTER, Locations.RHS_ROOT, Locations.RHS_COMMENT, Locations.SEARCH]).isRequired,\n        commentCount: PropTypes.number,\n        isFlagged: PropTypes.bool,\n        handleCommentClick: PropTypes.func,\n        handleDropdownOpened: PropTypes.func,\n        handleAddReactionClick: PropTypes.func,\n        isReadOnly: PropTypes.bool,\n        pluginMenuItems: PropTypes.arrayOf(PropTypes.object),\n        isLicensed: PropTypes.bool.isRequired,\n        postEditTimeLimit: PropTypes.string.isRequired,\n        enableEmojiPicker: PropTypes.bool.isRequired,\n        channelIsArchived: PropTypes.bool.isRequired,\n        currentTeamUrl: PropTypes.string.isRequired,\n\n        /*\n         * Components for overriding provided by plugins\n         */\n        components: PropTypes.object.isRequired,\n\n        actions: PropTypes.shape({\n\n            /**\n             * Function flag the post\n             */\n            flagPost: PropTypes.func.isRequired,\n\n            /**\n             * Function to unflag the post\n             */\n            unflagPost: PropTypes.func.isRequired,\n\n            /**\n             * Function to set the editing post\n             */\n            setEditingPost: PropTypes.func.isRequired,\n\n            /**\n             * Function to pin the post\n             */\n            pinPost: PropTypes.func.isRequired,\n\n            /**\n             * Function to unpin the post\n             */\n            unpinPost: PropTypes.func.isRequired,\n\n            /**\n             * Function to open a modal\n             */\n            openModal: PropTypes.func.isRequired,\n\n            /*\n             * Function to set the unread mark at given post\n             */\n            markPostAsUnread: PropTypes.func.isRequired,\n        }).isRequired,\n\n        canEdit: PropTypes.bool.isRequired,\n        canDelete: PropTypes.bool.isRequired,\n    }\n\n    static defaultProps = {\n        post: {},\n        commentCount: 0,\n        isFlagged: false,\n        isReadOnly: false,\n        pluginMenuItems: [],\n        location: Locations.CENTER,\n        enableEmojiPicker: false,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.editDisableAction = new DelayedAction(this.handleEditDisable);\n\n        this.state = {\n            openUp: false,\n            width: 0,\n            canEdit: props.canEdit && !props.isReadOnly,\n        };\n\n        this.buttonRef = React.createRef();\n    }\n\n    disableCanEditPostByTime() {\n        const {post, isLicensed, postEditTimeLimit} = this.props;\n        const {canEdit} = this.state;\n\n        if (canEdit && isLicensed) {\n            if (String(postEditTimeLimit) !== String(Constants.UNSET_POST_EDIT_TIME_LIMIT)) {\n                const milliseconds = 1000;\n                const timeLeft = (post.create_at + (postEditTimeLimit * milliseconds)) - Utils.getTimestamp();\n                if (timeLeft > 0) {\n                    this.editDisableAction.fireAfter(timeLeft + milliseconds);\n                }\n            }\n        }\n    }\n\n    componentDidMount() {\n        this.disableCanEditPostByTime();\n    }\n\n    static getDerivedStateFromProps(props) {\n        return {\n            canEdit: props.canEdit && !props.isReadOnly,\n            canDelete: props.canDelete && !props.isReadOnly,\n        };\n    }\n\n    componentWillUnmount() {\n        this.editDisableAction.cancel();\n    }\n\n    handleEditDisable = () => {\n        this.setState({canEdit: false});\n    }\n\n    handleFlagMenuItemActivated = () => {\n        if (this.props.isFlagged) {\n            this.props.actions.unflagPost(this.props.post.id);\n        } else {\n            this.props.actions.flagPost(this.props.post.id);\n        }\n    }\n\n    // listen to clicks/taps on add reaction menu item and pass to parent handler\n    handleAddReactionMenuItemActivated = (e) => {\n        e.preventDefault();\n\n        // to be safe, make sure the handler function has been defined\n        if (this.props.handleAddReactionClick) {\n            this.props.handleAddReactionClick();\n        }\n    }\n\n    copyLink = () => {\n        const postUrl = `${this.props.currentTeamUrl}/pl/${this.props.post.id}`;\n\n        const clipboard = navigator.clipboard;\n        if (clipboard) {\n            clipboard.writeText(postUrl);\n        } else {\n            const hiddenInput = document.createElement('textarea');\n            hiddenInput.value = postUrl;\n            document.body.appendChild(hiddenInput);\n            hiddenInput.focus();\n            hiddenInput.select();\n            document.execCommand('copy');\n            document.body.removeChild(hiddenInput);\n        }\n    }\n\n    handlePinMenuItemActivated = () => {\n        if (this.props.post.is_pinned) {\n            this.props.actions.unpinPost(this.props.post.id);\n        } else {\n            this.props.actions.pinPost(this.props.post.id);\n        }\n    }\n\n    handleUnreadMenuItemActivated = (e) => {\n        e.preventDefault();\n        this.props.actions.markPostAsUnread(this.props.post);\n    }\n\n    handleDeleteMenuItemActivated = (e) => {\n        e.preventDefault();\n\n        const deletePostModalData = {\n            ModalId: ModalIdentifiers.DELETE_POST,\n            dialogType: DeletePostModal,\n            dialogProps: {\n                post: this.props.post,\n                commentCount: this.props.commentCount,\n                isRHS: this.props.location === Locations.RHS_ROOT || this.props.location === Locations.RHS_COMMENT,\n            },\n        };\n\n        this.props.actions.openModal(deletePostModalData);\n    }\n\n    handleEditMenuItemActivated = () => {\n        this.props.actions.setEditingPost(\n            this.props.post.id,\n            this.props.commentCount,\n            this.props.location === Locations.CENTER ? 'post_textbox' : 'reply_textbox',\n            this.props.post.root_id ? Utils.localizeMessage('rhs_comment.comment', 'Comment') : Utils.localizeMessage('create_post.post', 'Post'),\n            this.props.location === Locations.RHS_ROOT || this.props.location === Locations.RHS_COMMENT,\n        );\n    }\n\n    tooltip = (\n        <Tooltip\n            id='dotmenu-icon-tooltip'\n            className='hidden-xs'\n        >\n            <FormattedMessage\n                id='post_info.dot_menu.tooltip.more_actions'\n                defaultMessage='More actions'\n            />\n        </Tooltip>\n    )\n\n    refCallback = (menuRef) => {\n        if (menuRef) {\n            const rect = menuRef.rect();\n            const buttonRect = this.buttonRef.current.getBoundingClientRect();\n            const y = typeof buttonRect.y === 'undefined' ? buttonRect.top : buttonRect.y;\n            const windowHeight = window.innerHeight;\n\n            const totalSpace = windowHeight - MENU_BOTTOM_MARGIN;\n            const spaceOnTop = y - Constants.CHANNEL_HEADER_HEIGHT;\n            const spaceOnBottom = (totalSpace - (spaceOnTop + Constants.POST_AREA_HEIGHT));\n\n            this.setState({\n                openUp: (spaceOnTop > spaceOnBottom),\n                width: rect.width,\n            });\n        }\n    }\n\n    renderDivider = (suffix) => {\n        return (\n            <li\n                id={`divider_post_${this.props.post.id}_${suffix}`}\n                className='MenuItem__divider'\n                role='menuitem'\n            />\n        );\n    }\n\n    render() {\n        const isSystemMessage = PostUtils.isSystemMessage(this.props.post);\n        const isMobile = Utils.isMobile();\n\n        const pluginItems = this.props.pluginMenuItems.\n            filter((item) => {\n                return item.filter ? item.filter(this.props.post.id) : item;\n            }).\n            map((item) => {\n                if (item.subMenu) {\n                    return (\n                        <Menu.ItemSubMenu\n                            key={item.id + '_pluginmenuitem'}\n                            id={item.text.id}\n                            postId={this.props.post.id}\n                            text={item.text}\n                            subMenu={item.subMenu}\n                            action={item.action}\n                            xOffset={this.state.width}\n                            root={true}\n                        />\n                    );\n                }\n                return (\n                    <Menu.ItemAction\n                        key={item.id + '_pluginmenuitem'}\n                        text={item.text}\n                        onClick={() => {\n                            if (item.action) {\n                                item.action(this.props.post.id);\n                            }\n                        }}\n                    />\n                );\n            });\n\n        if (!this.state.canDelete && !this.state.canEdit && pluginItems.length === 0 && isSystemMessage) {\n            return null;\n        }\n\n        return (\n            <MenuWrapper onToggle={this.props.handleDropdownOpened}>\n                <OverlayTrigger\n                    className='hidden-xs'\n                    delayShow={500}\n                    placement='top'\n                    overlay={this.tooltip}\n                    rootClose={true}\n                >\n                    <button\n                        ref={this.buttonRef}\n                        id={`${this.props.location}_button_${this.props.post.id}`}\n                        aria-label={Utils.localizeMessage('post_info.dot_menu.tooltip.more_actions', 'More actions').toLowerCase()}\n                        className='post__dropdown color--link style--none'\n                        type='button'\n                        aria-expanded='false'\n                    />\n                </OverlayTrigger>\n                <Menu\n                    id={`${this.props.location}_dropdown_${this.props.post.id}`}\n                    openLeft={true}\n                    openUp={this.state.openUp}\n                    ref={this.refCallback}\n                    ariaLabel={Utils.localizeMessage('post_info.menuAriaLabel', 'Post extra options')}\n                >\n                    <Menu.ItemAction\n                        show={!isSystemMessage && this.props.location === Locations.CENTER}\n                        text={Utils.localizeMessage('post_info.reply', 'Reply')}\n                        onClick={this.props.handleCommentClick}\n                    />\n                    <ChannelPermissionGate\n                        channelId={this.props.post.channel_id}\n                        teamId={this.props.teamId}\n                        permissions={[Permissions.ADD_REACTION]}\n                    >\n                        <Menu.ItemAction\n                            show={isMobile && !isSystemMessage && !this.props.isReadOnly && this.props.enableEmojiPicker}\n                            text={Utils.localizeMessage('rhs_root.mobile.add_reaction', 'Add Reaction')}\n                            onClick={this.handleAddReactionMenuItemActivated}\n                        />\n                    </ChannelPermissionGate>\n                    <Menu.ItemAction\n                        id={`unread_post_${this.props.post.id}`}\n                        show={!isSystemMessage && !this.props.channelIsArchived && this.props.location !== Locations.SEARCH}\n                        text={Utils.localizeMessage('post_info.unread', 'Mark as Unread')}\n                        onClick={this.handleUnreadMenuItemActivated}\n                    />\n                    <Menu.ItemAction\n                        id={`permalink_${this.props.post.id}`}\n                        show={!isSystemMessage}\n                        text={Utils.localizeMessage('post_info.permalink', 'Copy Link')}\n                        onClick={this.copyLink}\n                    />\n                    <Menu.ItemAction\n                        show={isMobile && !isSystemMessage && this.props.isFlagged}\n                        text={Utils.localizeMessage('rhs_root.mobile.unflag', 'Unflag')}\n                        onClick={this.handleFlagMenuItemActivated}\n                    />\n                    <Menu.ItemAction\n                        show={isMobile && !isSystemMessage && !this.props.isFlagged}\n                        text={Utils.localizeMessage('rhs_root.mobile.flag', 'Flag')}\n                        onClick={this.handleFlagMenuItemActivated}\n                    />\n                    <Menu.ItemAction\n                        id={`unpin_post_${this.props.post.id}`}\n                        show={!isSystemMessage && !this.props.isReadOnly && this.props.post.is_pinned}\n                        text={Utils.localizeMessage('post_info.unpin', 'Unpin')}\n                        onClick={this.handlePinMenuItemActivated}\n                    />\n                    <Menu.ItemAction\n                        id={`pin_post_${this.props.post.id}`}\n                        show={!isSystemMessage && !this.props.isReadOnly && !this.props.post.is_pinned}\n                        text={Utils.localizeMessage('post_info.pin', 'Pin')}\n                        onClick={this.handlePinMenuItemActivated}\n                    />\n                    {!isSystemMessage && (this.state.canEdit || this.state.canDelete) && this.renderDivider('edit')}\n                    <Menu.ItemAction\n                        id={`edit_post_${this.props.post.id}`}\n                        show={this.state.canEdit}\n                        text={Utils.localizeMessage('post_info.edit', 'Edit')}\n                        onClick={this.handleEditMenuItemActivated}\n                    />\n                    <Menu.ItemAction\n                        id={`delete_post_${this.props.post.id}`}\n                        show={this.state.canDelete}\n                        text={Utils.localizeMessage('post_info.del', 'Delete')}\n                        onClick={this.handleDeleteMenuItemActivated}\n                        isDangerous={true}\n                    />\n                    {(pluginItems.length > 0 || this.props.components[PLUGGABLE_COMPONENT]) && this.renderDivider('plugins')}\n                    {pluginItems}\n                    <Pluggable\n                        postId={this.props.post.id}\n                        pluggableName={PLUGGABLE_COMPONENT}\n                    />\n                </Menu>\n            </MenuWrapper>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getLicense, getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getCurrentTeamId, getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\n\nimport {openModal} from 'actions/views/modals';\nimport {\n    flagPost,\n    unflagPost,\n    pinPost,\n    unpinPost,\n    setEditingPost,\n    markPostAsUnread,\n} from 'actions/post_actions.jsx';\nimport * as PostUtils from 'utils/post_utils.jsx';\n\nimport {isArchivedChannel} from 'utils/channel_utils';\nimport {getSiteURL} from 'utils/url';\n\nimport DotMenu from './dot_menu.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    const {post} = ownProps;\n\n    const license = getLicense(state);\n    const config = getConfig(state);\n    const userId = getCurrentUserId(state);\n    const channel = getChannel(state, ownProps.post.channel_id);\n    const currentTeam = getCurrentTeam(state) || {};\n    const currentTeamUrl = `${getSiteURL()}/${currentTeam.name}`;\n\n    return {\n        channelIsArchived: isArchivedChannel(channel),\n        components: state.plugins.components,\n        postEditTimeLimit: getConfig(state).PostEditTimeLimit,\n        isLicensed: getLicense(state).IsLicensed === 'true',\n        teamId: getCurrentTeamId(state),\n        pluginMenuItems: state.plugins.components.PostDropdownMenu,\n        shouldShowDotMenu: PostUtils.shouldShowDotMenu(state, post, channel),\n        canEdit: PostUtils.canEditPost(state, post, license, config, channel, userId),\n        canDelete: PostUtils.canDeletePost(state, post, channel),\n        currentTeamUrl,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            flagPost,\n            unflagPost,\n            setEditingPost,\n            pinPost,\n            unpinPost,\n            openModal,\n            markPostAsUnread,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DotMenu);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class DownloadIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.download'\n                    defaultMessage='Download Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='40px'\n                            height='40px'\n                            viewBox='0 0 42 42'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g\n                                stroke='inherit'\n                                strokeWidth='1'\n                                fill='none'\n                                fillRule='evenodd'\n                            >\n                                <g transform='translate(-986.000000, -1142.000000)'>\n                                    <g transform='translate(50.000000, 1034.000000)'>\n                                        <g transform='translate(539.000000, 54.000000)'>\n                                            <g transform='translate(398.000000, 55.000000)'>\n                                                <g\n                                                    transform='translate(11.000000, 11.000000)'\n                                                    fillRule='nonzero'\n                                                    fill='inherit'\n                                                >\n                                                    <path d='M8.7345,14.1405 C8.74725,14.1525 8.763,14.15775 8.7765,14.16825 C8.802,14.18775 8.82675,14.20875 8.85675,14.22075 C8.9025,14.24025 8.95125,14.25 9,14.25 C9.04875,14.25 9.0975,14.24025 9.14325,14.22075 C9.18975,14.20125 9.23175,14.17275 9.267,14.1375 L13.764,9.6405 C13.91025,9.49425 13.91025,9.2565 13.764,9.11025 C13.61775,8.964 13.38,8.964 13.23375,9.11025 L9.375,12.969 L9.375,0.375 C9.375,0.168 9.207,0 9,0 C8.793,0 8.625,0.168 8.625,0.375 L8.625,12.9705 L4.76475,9.11025 C4.6185,8.964 4.38075,8.964 4.2345,9.11025 C4.08825,9.2565 4.08825,9.49425 4.2345,9.6405 L8.7345,14.1405 Z M17.25,13.5 C17.043,13.5 16.875,13.668 16.875,13.875 L16.875,17.25 L1.125,17.25 L1.125,13.875 C1.125,13.668 0.957,13.5 0.75,13.5 C0.543,13.5 0.375,13.668 0.375,13.875 L0.375,17.625 C0.375,17.832 0.543,18 0.75,18 L17.25,18 C17.457,18 17.625,17.832 17.625,17.625 L17.625,13.875 C17.625,13.668 17.457,13.5 17.25,13.5 Z'/>\n                                                </g>\n                                            </g>\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {getFileThumbnailUrl, getFileUrl} from 'mattermost-redux/utils/file_utils';\nimport {FileInfo} from 'mattermost-redux/types/files';\n\nimport Constants, {FileTypes} from 'utils/constants';\nimport {\n    getFileType,\n    getIconClassName,\n    isGIFImage,\n} from 'utils/utils.jsx';\n\ntype Props = {\n    enableSVGs: boolean;\n    fileInfo: FileInfo;\n}\n\nexport default class FileThumbnail extends React.PureComponent<Props> {\n    render() {\n        const {fileInfo} = this.props;\n        const type = getFileType(fileInfo.extension);\n\n        let thumbnail;\n        if (type === FileTypes.IMAGE) {\n            let className = 'post-image';\n\n            if (fileInfo.width < Constants.THUMBNAIL_WIDTH && fileInfo.height < Constants.THUMBNAIL_HEIGHT) {\n                className += ' small';\n            } else {\n                className += ' normal';\n            }\n\n            let thumbnailUrl = getFileThumbnailUrl(fileInfo.id);\n            if (isGIFImage(fileInfo.extension) && !fileInfo.has_preview_image) {\n                thumbnailUrl = getFileUrl(fileInfo.id);\n            }\n\n            return (\n                <div\n                    className={className}\n                    style={{\n                        backgroundImage: `url(${thumbnailUrl})`,\n                        backgroundSize: 'cover',\n                    }}\n                />\n            );\n        } else if (fileInfo.extension === FileTypes.SVG && this.props.enableSVGs) {\n            thumbnail = (\n                <img\n                    alt={'file thumbnail image'}\n                    className='post-image normal'\n                    src={getFileUrl(fileInfo.id)}\n                />\n            );\n        } else {\n            thumbnail = <div className={'file-icon ' + getIconClassName(type)}/>;\n        }\n\n        return thumbnail;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport {GlobalState} from 'types/store';\n\nimport FileThumbnail from './file_thumbnail';\n\nfunction mapStateToProps(state: GlobalState) {\n    return {\n        enableSVGs: getConfig(state).EnableSVGs === 'true',\n    };\n}\n\nexport default connect(mapStateToProps)(FileThumbnail);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {getFileThumbnailUrl, getFileUrl} from 'mattermost-redux/utils/file_utils';\n\nimport {FileTypes} from 'utils/constants';\nimport {\n    trimFilename,\n} from 'utils/file_utils';\nimport {\n    fileSizeToString,\n    getFileType,\n    loadImage,\n    localizeMessage,\n} from 'utils/utils.jsx';\n\nimport DownloadIcon from 'components/widgets/icons/download_icon';\n\nimport FilenameOverlay from './filename_overlay.jsx';\nimport FileThumbnail from './file_thumbnail';\n\nexport default class FileAttachment extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * File detailed information\n         */\n        fileInfo: PropTypes.object.isRequired,\n\n        /*\n         * The index of this attachment preview in the parent FileAttachmentList\n         */\n        index: PropTypes.number.isRequired,\n\n        /*\n         * Handler for when the thumbnail is clicked passed the index above\n         */\n        handleImageClick: PropTypes.func,\n\n        /*\n         * Display in compact format\n         */\n        compactDisplay: PropTypes.bool,\n\n        canDownloadFiles: PropTypes.bool,\n        enableSVGs: PropTypes.bool.isRequired,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            loaded: getFileType(props.fileInfo.extension) !== FileTypes.IMAGE,\n            fileInfo: props.fileInfo,\n        };\n    }\n\n    componentDidMount() {\n        this.mounted = true;\n        this.loadFiles();\n    }\n\n    static getDerivedStateFromProps(nextProps, prevState) {\n        if (nextProps.fileInfo.id !== prevState.fileInfo.id) {\n            const extension = nextProps.fileInfo.extension;\n\n            return {\n                loaded: getFileType(extension) !== FileTypes.IMAGE && !(nextProps.enableSVGs && extension === FileTypes.SVG),\n                fileInfo: nextProps.fileInfo,\n            };\n        }\n\n        return null;\n    }\n\n    componentDidUpdate(prevProps) {\n        if (!this.state.loaded && this.props.fileInfo.id !== prevProps.fileInfo.id) {\n            this.loadFiles();\n        }\n    }\n\n    componentWillUnmount() {\n        this.mounted = false;\n    }\n\n    loadFiles = () => {\n        const fileInfo = this.props.fileInfo;\n        const fileType = getFileType(fileInfo.extension);\n\n        if (fileType === FileTypes.IMAGE) {\n            const thumbnailUrl = getFileThumbnailUrl(fileInfo.id);\n\n            loadImage(thumbnailUrl, this.handleImageLoaded);\n        } else if (fileInfo.extension === FileTypes.SVG && this.props.enableSVGs) {\n            loadImage(getFileUrl(fileInfo.id), this.handleImageLoaded);\n        }\n    }\n\n    handleImageLoaded = () => {\n        if (this.mounted) {\n            this.setState({\n                loaded: true,\n            });\n        }\n    }\n\n    onAttachmentClick = (e) => {\n        e.preventDefault();\n        e.target.blur();\n        if (this.props.handleImageClick) {\n            this.props.handleImageClick(this.props.index);\n        }\n    }\n\n    render() {\n        const {\n            compactDisplay,\n            fileInfo,\n        } = this.props;\n\n        const trimmedFilename = trimFilename(fileInfo.name);\n        let fileThumbnail;\n        let fileDetail;\n        const ariaLabelImage = `${localizeMessage('file_attachment.thumbnail', 'file thumbnail')} ${fileInfo.name}`.toLowerCase();\n\n        if (!compactDisplay) {\n            fileThumbnail = (\n                <a\n                    aria-label={ariaLabelImage}\n                    className='post-image__thumbnail'\n                    href='#'\n                    onClick={this.onAttachmentClick}\n                >\n                    {this.state.loaded ? (\n                        <FileThumbnail fileInfo={fileInfo}/>\n                    ) : (\n                        <div className='post-image__load'/>\n                    )}\n                </a>\n            );\n\n            fileDetail = (\n                <div\n                    className='post-image__detail_wrapper'\n                    onClick={this.onAttachmentClick}\n                >\n                    <div className='post-image__detail'>\n                        <span className={'post-image__name'}>\n                            {trimmedFilename}\n                        </span>\n                        <span className='post-image__type'>{fileInfo.extension.toUpperCase()}</span>\n                        <span className='post-image__size'>{fileSizeToString(fileInfo.size)}</span>\n                    </div>\n                </div>\n            );\n        }\n\n        let filenameOverlay;\n        if (this.props.canDownloadFiles) {\n            filenameOverlay = (\n                <FilenameOverlay\n                    fileInfo={fileInfo}\n                    compactDisplay={compactDisplay}\n                    canDownload={this.props.canDownloadFiles}\n                    handleImageClick={this.onAttachmentClick}\n                    iconClass={'post-image__download'}\n                >\n                    <DownloadIcon/>\n                </FilenameOverlay>\n            );\n        }\n\n        return (\n            <div className='post-image__column'>\n                {fileThumbnail}\n                <div className='post-image__details'>\n                    {fileDetail}\n                    {filenameOverlay}\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport {canDownloadFiles} from 'utils/file_utils.jsx';\n\nimport FileAttachment from './file_attachment.jsx';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n\n    return {\n        canDownloadFiles: canDownloadFiles(config),\n        enableSVGs: config.EnableSVGs === 'true',\n    };\n}\n\nexport default connect(mapStateToProps)(FileAttachment);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport {getFilePreviewUrl, getFileUrl} from 'mattermost-redux/utils/file_utils';\n\nimport SizeAwareImage from 'components/size_aware_image';\nimport {FileTypes} from 'utils/constants';\nimport {\n    getFileType,\n} from 'utils/utils';\n\nimport ViewImageModal from 'components/view_image';\n\nconst PREVIEW_IMAGE_MIN_DIMENSION = 50;\n\nexport default class SingleImageView extends React.PureComponent {\n    static propTypes = {\n        postId: PropTypes.string.isRequired,\n        fileInfo: PropTypes.object.isRequired,\n        isRhsOpen: PropTypes.bool.isRequired,\n        compactDisplay: PropTypes.bool,\n        isEmbedVisible: PropTypes.bool,\n        actions: PropTypes.shape({\n            toggleEmbedVisibility: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    static defaultProps = {\n        fileInfo: {},\n        compactDisplay: false\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            loaded: false,\n            showPreviewModal: false,\n            dimensions: {\n                width: props.fileInfo.width,\n                height: props.fileInfo.height,\n            },\n        };\n    }\n\n    componentDidMount() {\n        this.mounted = true;\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        if ((props.fileInfo.width !== state.dimensions.width) || props.fileInfo.height !== state.dimensions.height) {\n            return {\n                dimensions: {\n                    width: props.fileInfo.width,\n                    height: props.fileInfo.height,\n                },\n            };\n        }\n        return null;\n    }\n\n    componentWillUnmount() {\n        this.mounted = false;\n    }\n\n    imageLoaded = () => {\n        if (this.mounted) {\n            this.setState({loaded: true});\n        }\n    }\n\n    handleImageClick = (e) => {\n        e.preventDefault();\n        this.setState({showPreviewModal: true});\n    }\n\n    showPreviewModal = () => {\n        this.setState({showPreviewModal: false});\n    }\n\n    toggleEmbedVisibility = () => {\n        this.props.actions.toggleEmbedVisibility(this.props.postId);\n    }\n\n    render() {\n        const {fileInfo, compactDisplay} = this.props;\n        const {\n            loaded,\n        } = this.state;\n\n        const {has_preview_image: hasPreviewImage, id} = fileInfo;\n        const fileURL = getFileUrl(id);\n        const previewURL = hasPreviewImage ? getFilePreviewUrl(id) : fileURL;\n\n        const previewHeight = fileInfo.height;\n        const previewWidth = fileInfo.width;\n\n        let minPreviewClass = '';\n        if (\n            previewWidth < PREVIEW_IMAGE_MIN_DIMENSION ||\n            previewHeight < PREVIEW_IMAGE_MIN_DIMENSION\n        ) {\n            minPreviewClass = 'min-preview ';\n\n            if (previewHeight > previewWidth) {\n                minPreviewClass += 'min-preview--portrait ';\n            }\n        }\n\n        // Add compact display class to image class if in compact mode\n        if (compactDisplay) {\n            minPreviewClass += ' compact-display';\n        }\n\n        const toggle = (\n            <button\n                key='toggle'\n                className='style--none post__embed-visibility color--link'\n                data-expanded={this.props.isEmbedVisible}\n                aria-label='Toggle Embed Visibility'\n                onClick={this.toggleEmbedVisibility}\n            />\n        );\n\n        let imageNameClass = 'image-name';\n        if (compactDisplay) {\n            imageNameClass += ' compact-display';\n        }\n\n        const fileHeader = (\n            <div\n                data-testid='image-name'\n                className={imageNameClass}\n            >\n                {toggle}\n                <div\n                    onClick={this.handleImageClick}\n                >\n                    {fileInfo.name}\n                </div>\n            </div>\n        );\n\n        let viewImageModal;\n        let fadeInClass = '';\n\n        const fileType = getFileType(fileInfo.extension);\n        let styleIfSvgWithDimensions = {};\n        let imageContainerStyle = {};\n        let svgClass = '';\n        if (fileType === FileTypes.SVG) {\n            svgClass = 'svg';\n            if (this.state.dimensions.height) {\n                styleIfSvgWithDimensions = {\n                    width: '100%',\n                };\n            } else {\n                imageContainerStyle = {\n                    height: 350,\n                    maxWidth: '100%',\n                };\n            }\n        }\n\n        if (loaded) {\n            viewImageModal = (\n                <ViewImageModal\n                    show={this.state.showPreviewModal}\n                    onModalDismissed={this.showPreviewModal}\n                    fileInfos={[fileInfo]}\n                    postId={this.props.postId}\n                />\n            );\n\n            fadeInClass = 'image-fade-in';\n        }\n\n        return (\n            <div\n                className={`${'file-view--single'}`}\n            >\n                <div\n                    className='file__image'\n                >\n                    {fileHeader}\n                    {this.props.isEmbedVisible &&\n                    <div\n                        className='image-container'\n                        style={imageContainerStyle}\n                    >\n                        <div\n                            className={`image-loaded ${fadeInClass} ${svgClass}`}\n                            style={styleIfSvgWithDimensions}\n                        >\n                            <SizeAwareImage\n                                onClick={this.handleImageClick}\n                                className={minPreviewClass}\n                                src={previewURL}\n                                dimensions={this.state.dimensions}\n                                fileInfo={this.props.fileInfo}\n                                onImageLoaded={this.imageLoaded}\n                                showLoader={this.props.isEmbedVisible}\n                                handleSmallImageContainer={true}\n                            />\n                        </div>\n                    </div>\n                    }\n                    {viewImageModal}\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {toggleEmbedVisibility} from 'actions/post_actions';\n\nimport {getIsRhsOpen} from 'selectors/rhs';\n\nimport SingleImageView from 'components/single_image_view/single_image_view.jsx';\n\nfunction mapStateToProps(state) {\n    const isRhsOpen = getIsRhsOpen(state);\n\n    return {\n        isRhsOpen,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            toggleEmbedVisibility,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SingleImageView);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport {sortFileInfos} from 'mattermost-redux/utils/file_utils';\n\nimport {FileTypes} from 'utils/constants';\nimport {getFileType} from 'utils/utils';\n\nimport FileAttachment from 'components/file_attachment';\nimport SingleImageView from 'components/single_image_view';\nimport ViewImageModal from 'components/view_image';\n\nexport default class FileAttachmentList extends React.Component {\n    static propTypes = {\n\n        /*\n         * The post the files are attached to\n         */\n        post: PropTypes.object.isRequired,\n\n        /*\n         * The number of files attached to the post\n         */\n        fileCount: PropTypes.number.isRequired,\n\n        /*\n         * Sorted array of metadata for each file attached to the post\n         */\n        fileInfos: PropTypes.arrayOf(PropTypes.object),\n\n        compactDisplay: PropTypes.bool,\n        enableSVGs: PropTypes.bool,\n        isEmbedVisible: PropTypes.bool,\n        locale: PropTypes.string.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {showPreviewModal: false, startImgIndex: 0};\n    }\n\n    handleImageClick = (indexClicked) => {\n        this.setState({showPreviewModal: true, startImgIndex: indexClicked});\n    }\n\n    hidePreviewModal = () => {\n        this.setState({showPreviewModal: false});\n    }\n\n    render() {\n        const {\n            compactDisplay,\n            enableSVGs,\n            fileInfos,\n            fileCount,\n            locale,\n        } = this.props;\n\n        if (fileInfos && fileInfos.length === 1) {\n            const fileType = getFileType(fileInfos[0].extension);\n\n            if (fileType === FileTypes.IMAGE || (fileType === FileTypes.SVG && enableSVGs)) {\n                return (\n                    <SingleImageView\n                        fileInfo={fileInfos[0]}\n                        isEmbedVisible={this.props.isEmbedVisible}\n                        postId={this.props.post.id}\n                        compactDisplay={compactDisplay}\n                    />\n                );\n            }\n        } else if (fileCount === 1 && this.props.isEmbedVisible) {\n            return (\n                <div style={style.minHeightPlaceholder}/>\n            );\n        }\n\n        const sortedFileInfos = sortFileInfos(fileInfos, locale);\n        const postFiles = [];\n        if (sortedFileInfos && sortedFileInfos.length > 0) {\n            for (let i = 0; i < sortedFileInfos.length; i++) {\n                const fileInfo = sortedFileInfos[i];\n                postFiles.push(\n                    <FileAttachment\n                        key={fileInfo.id}\n                        fileInfo={sortedFileInfos[i]}\n                        index={i}\n                        handleImageClick={this.handleImageClick}\n                        compactDisplay={compactDisplay}\n                    />\n                );\n            }\n        } else if (fileCount > 0) {\n            for (let i = 0; i < fileCount; i++) {\n                // Add a placeholder to avoid pop-in once we get the file infos for this post\n                postFiles.push(\n                    <div\n                        key={`fileCount-${i}`}\n                        className='post-image__column post-image__column--placeholder'\n                    />\n                );\n            }\n        }\n\n        return (\n            <React.Fragment>\n                <div\n                    data-testid='fileAttachmentList'\n                    className='post-image__columns clearfix'\n                >\n                    {postFiles}\n                </div>\n                <ViewImageModal\n                    show={this.state.showPreviewModal}\n                    onModalDismissed={this.hidePreviewModal}\n                    startIndex={this.state.startImgIndex}\n                    fileInfos={sortedFileInfos}\n                    postId={this.props.post.id}\n                />\n            </React.Fragment>\n        );\n    }\n}\n\nconst style = {\n    minHeightPlaceholder: {minHeight: '385px'},\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {makeGetFilesForPost} from 'mattermost-redux/selectors/entities/files';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport {getCurrentLocale} from 'selectors/i18n';\nimport {isEmbedVisible} from 'selectors/posts';\n\nimport FileAttachmentList from './file_attachment_list.jsx';\n\nfunction makeMapStateToProps() {\n    const selectFilesForPost = makeGetFilesForPost();\n\n    return function mapStateToProps(state, ownProps) {\n        const postId = ownProps.post ? ownProps.post.id : '';\n        const fileInfos = selectFilesForPost(state, postId);\n\n        let fileCount = 0;\n        if (ownProps.post.metadata && ownProps.post.metadata.files) {\n            fileCount = (ownProps.post.metadata.files || []).length;\n        } else if (ownProps.post.file_ids) {\n            fileCount = ownProps.post.file_ids.length;\n        } else if (ownProps.post.filenames) {\n            fileCount = ownProps.post.filenames.length;\n        }\n\n        return {\n            enableSVGs: getConfig(state).EnableSVGs === 'true',\n            fileInfos,\n            fileCount,\n            isEmbedVisible: isEmbedVisible(state, ownProps.post.id),\n            locale: getCurrentLocale(state),\n        };\n    };\n}\n\nexport default connect(makeMapStateToProps)(FileAttachmentList);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport ProfilePicture from 'components/profile_picture';\nimport MattermostLogo from 'components/widgets/icons/mattermost_logo';\n\nimport Constants, {UserStatuses} from 'utils/constants';\nimport * as PostUtils from 'utils/post_utils';\nimport * as Utils from 'utils/utils';\n\nexport default class PostProfilePicture extends React.PureComponent {\n    static propTypes = {\n        compactDisplay: PropTypes.bool.isRequired,\n        enablePostIconOverride: PropTypes.bool.isRequired,\n        hasImageProxy: PropTypes.bool.isRequired,\n        isBusy: PropTypes.bool,\n        isRHS: PropTypes.bool,\n        post: PropTypes.object.isRequired,\n        status: PropTypes.string,\n        user: PropTypes.object,\n        isBot: PropTypes.bool,\n        postIconOverrideURL: PropTypes.string,\n    };\n\n    static defaultProps = {\n        status: UserStatuses.OFFLINE,\n    };\n\n    getProfilePictureURL = () => {\n        const {post, user} = this.props;\n\n        if (user && user.id === post.user_id) {\n            return Utils.imageURLForUser(user.id, user.last_picture_update);\n        } else if (post.user_id) {\n            return Utils.imageURLForUser(post.user_id);\n        }\n\n        return '';\n    };\n\n    getStatus = (fromAutoResponder, fromWebhook, user) => {\n        if (fromAutoResponder || fromWebhook || (user && user.is_bot)) {\n            return '';\n        }\n\n        return this.props.status;\n    };\n\n    getPostIconURL = (defaultURL, fromAutoResponder, fromWebhook) => {\n        const {enablePostIconOverride, hasImageProxy, post} = this.props;\n        const postProps = post.props;\n        let postIconOverrideURL = '';\n        let useUserIcon = '';\n        if (postProps) {\n            postIconOverrideURL = postProps.override_icon_url;\n            useUserIcon = postProps.use_user_icon;\n        }\n\n        if (this.props.compactDisplay) {\n            return '';\n        }\n\n        if (!fromAutoResponder && fromWebhook && !useUserIcon && enablePostIconOverride) {\n            if (postIconOverrideURL && postIconOverrideURL !== '') {\n                return PostUtils.getImageSrc(postIconOverrideURL, hasImageProxy);\n            }\n\n            return Constants.DEFAULT_WEBHOOK_LOGO;\n        }\n\n        return defaultURL;\n    };\n\n    render() {\n        const {\n            compactDisplay,\n            isBusy,\n            isRHS,\n            post,\n            user,\n            isBot,\n        } = this.props;\n\n        const isSystemMessage = PostUtils.isSystemMessage(post);\n        const fromWebhook = PostUtils.isFromWebhook(post);\n\n        if (isSystemMessage && !compactDisplay && !fromWebhook && !isBot) {\n            return <MattermostLogo className='icon'/>;\n        }\n        const fromAutoResponder = PostUtils.fromAutoResponder(post);\n\n        const hasMention = !fromAutoResponder && !fromWebhook;\n        const profileSrc = this.getProfilePictureURL();\n        const src = this.getPostIconURL(profileSrc, fromAutoResponder, fromWebhook);\n\n        const overrideIconEmoji = post.props ? post.props.override_icon_emoji : '';\n        const isEmoji = typeof overrideIconEmoji == 'string' && overrideIconEmoji !== '';\n        const status = this.getStatus(fromAutoResponder, fromWebhook, user);\n\n        return (\n            <ProfilePicture\n                hasMention={hasMention}\n                isBusy={isBusy}\n                isRHS={isRHS}\n                size='md'\n                src={src}\n                profileSrc={profileSrc}\n                isEmoji={isEmoji}\n                status={status}\n                userId={user ? user.id : null}\n                username={user ? user.username : null}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getUser, getStatusForUserId} from 'mattermost-redux/selectors/entities/users';\n\nimport PostProfilePicture from './post_profile_picture';\n\nfunction mapStateToProps(state, ownProps) {\n    const config = getConfig(state);\n    const user = getUser(state, ownProps.userId);\n\n    return {\n        enablePostIconOverride: config.EnablePostIconOverride === 'true',\n        hasImageProxy: config.HasImageProxy === 'true',\n        status: getStatusForUserId(state, ownProps.userId),\n        isBot: Boolean(user && user.is_bot),\n        user,\n    };\n}\n\nexport default connect(mapStateToProps)(PostProfilePicture);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class FailedPostOptions extends React.PureComponent {\n    static propTypes = {\n        post: PropTypes.object.isRequired,\n        actions: PropTypes.shape({\n            createPost: PropTypes.func.isRequired,\n            removePost: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    retryPost = (e) => {\n        e.preventDefault();\n\n        const post = {...this.props.post};\n        Reflect.deleteProperty(post, 'id');\n        this.props.actions.createPost(post);\n    }\n\n    cancelPost = (e) => {\n        e.preventDefault();\n\n        this.props.actions.removePost(this.props.post);\n    }\n\n    render() {\n        return (\n            <span className='pending-post-actions'>\n                <a\n                    className='post-retry'\n                    href='#'\n                    onClick={this.retryPost}\n                >\n                    <FormattedMessage\n                        id='pending_post_actions.retry'\n                        defaultMessage='Retry'\n                    />\n                </a>\n                {' - '}\n                <a\n                    className='post-cancel'\n                    href='#'\n                    onClick={this.cancelPost}\n                >\n                    <FormattedMessage\n                        id='pending_post_actions.cancel'\n                        defaultMessage='Cancel'\n                    />\n                </a>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {removePost} from 'mattermost-redux/actions/posts';\n\nimport {createPost} from 'actions/post_actions.jsx';\n\nimport FailedPostOptions from './failed_post_options.jsx';\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            createPost,\n            removePost,\n        }, dispatch),\n    };\n}\n\nexport default connect(null, mapDispatchToProps)(FailedPostOptions);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class FlagIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.flag'\n                    defaultMessage='Flag Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='14px'\n                            height='14px'\n                            viewBox='0 0 16 16'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g\n                                stroke='none'\n                                strokeWidth='1'\n                                fill='inherit'\n                                fillRule='evenodd'\n                            >\n                                <g\n                                    transform='translate(-1106.000000, -33.000000)'\n                                    fillRule='nonzero'\n                                    fill='inherit'\n                                >\n                                    <g>\n                                        <g transform='translate(1096.000000, 22.000000)'>\n                                            <g transform='translate(10.000000, 11.000000)'>\n                                                <path d='M8,1 L2,1 C2,0.447 1.553,0 1,0 C0.447,0 0,0.447 0,1 L0,15.5 C0,15.776 0.224,16 0.5,16 L1.5,16 C1.776,16 2,15.776 2,15.5 L2,11 L7,11 L7,12 C7,12.553 7.447,13 8,13 L15,13 C15.553,13 16,12.553 16,12 L16,4 C16,3.447 15.553,3 15,3 L9,3 L9,2 C9,1.447 8.553,1 8,1 Z M9,11 L9,9.5 C9,9.224 8.776,9 8.5,9 L2,9 L2,3 L7,3 L7,4.5 C7,4.776 7.224,5 7.5,5 L14,5 L14,11 L9,11 Z'/>\n                                            </g>\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class FlagIconFilled extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.flagged'\n                    defaultMessage='Flagged Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='16px'\n                            height='16px'\n                            viewBox='0 0 16 16'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g\n                                stroke='none'\n                                strokeWidth='1'\n                                fill='inherit'\n                                fillRule='evenodd'\n                            >\n                                <g\n                                    transform='translate(-1073.000000, -33.000000)'\n                                    fillRule='nonzero'\n                                    fill='inherit'\n                                >\n                                    <g transform='translate(-1.000000, 0.000000)'>\n                                        <g transform='translate(1064.000000, 22.000000)'>\n                                            <g transform='translate(10.000000, 11.000000)'>\n                                                <path d='M8,1 L2,1 C2,0.447 1.553,0 1,0 C0.447,0 0,0.447 0,1 L0,15.5 C0,15.776 0.224,16 0.5,16 L1.5,16 C1.776,16 2,15.776 2,15.5 L2,11 L7,11 L7,12 C7,12.553 7.447,13 8,13 L15,13 C15.553,13 16,12.553 16,12 L16,4 C16,3.447 15.553,3 15,3 L9,3 L9,2 C9,1.447 8.553,1 8,1 Z'/>\n                                            </g>\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport OverlayTrigger from 'components/overlay_trigger';\nimport FlagIcon from 'components/widgets/icons/flag_icon';\nimport FlagIconFilled from 'components/widgets/icons/flag_icon_filled';\nimport Constants, {Locations, A11yCustomEventTypes} from 'utils/constants';\nimport {localizeMessage} from 'utils/utils.jsx';\nimport {t} from 'utils/i18n';\n\nexport default class PostFlagIcon extends React.PureComponent {\n    static propTypes = {\n        location: PropTypes.oneOf([Locations.CENTER, Locations.RHS_ROOT, Locations.RHS_COMMENT, Locations.SEARCH]).isRequired,\n        postId: PropTypes.string.isRequired,\n        isFlagged: PropTypes.bool.isRequired,\n        isEphemeral: PropTypes.bool,\n        actions: PropTypes.shape({\n            flagPost: PropTypes.func.isRequired,\n            unflagPost: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    static defaultProps = {\n        isEphemeral: false,\n        location: Locations.CENTER,\n    };\n\n    constructor() {\n        super();\n\n        this.buttonRef = React.createRef();\n\n        this.state = {\n            a11yActive: false,\n        };\n    }\n\n    componentDidMount() {\n        if (this.buttonRef.current) {\n            this.buttonRef.current.addEventListener(A11yCustomEventTypes.ACTIVATE, this.handleA11yActivateEvent);\n            this.buttonRef.current.addEventListener(A11yCustomEventTypes.DEACTIVATE, this.handleA11yDeactivateEvent);\n        }\n    }\n    componentWillUnmount() {\n        if (this.buttonRef.current) {\n            this.buttonRef.current.removeEventListener(A11yCustomEventTypes.ACTIVATE, this.handleA11yActivateEvent);\n            this.buttonRef.current.removeEventListener(A11yCustomEventTypes.DEACTIVATE, this.handleA11yDeactivateEvent);\n        }\n    }\n\n    componentDidUpdate() {\n        if (this.state.a11yActive && this.buttonRef.current) {\n            this.buttonRef.current.dispatchEvent(new Event(A11yCustomEventTypes.UPDATE));\n        }\n    }\n\n    handlePress = (e) => {\n        e.preventDefault();\n\n        const {\n            actions,\n            isFlagged,\n            postId,\n        } = this.props;\n\n        if (isFlagged) {\n            actions.unflagPost(postId);\n        } else {\n            actions.flagPost(postId);\n        }\n    }\n\n    handleA11yActivateEvent = () => {\n        this.setState({a11yActive: true});\n    }\n\n    handleA11yDeactivateEvent = () => {\n        this.setState({a11yActive: false});\n    }\n\n    render() {\n        if (this.props.isEphemeral) {\n            return null;\n        }\n\n        const isFlagged = this.props.isFlagged;\n\n        const flagVisible = isFlagged ? 'visible' : '';\n\n        let flagIcon;\n        if (isFlagged) {\n            flagIcon = <FlagIconFilled className='icon'/>;\n        } else {\n            flagIcon = <FlagIcon className='icon'/>;\n        }\n\n        return (\n            <button\n                ref={this.buttonRef}\n                id={`${this.props.location}_flagIcon_${this.props.postId}`}\n                aria-label={isFlagged ? localizeMessage('flag_post.unflag', 'Unflag').toLowerCase() : localizeMessage('flag_post.flag', 'Flag for follow up').toLowerCase()}\n                className={'style--none flag-icon__container ' + flagVisible}\n                onClick={this.handlePress}\n            >\n                <OverlayTrigger\n                    key={'flagtooltipkey' + flagVisible}\n                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                    placement='top'\n                    overlay={\n                        <Tooltip id='flagTooltip'>\n                            <FormattedMessage\n                                id={isFlagged ? t('flag_post.unflag') : t('flag_post.flag')}\n                                defaultMessage={isFlagged ? 'Unflag' : 'Flag for follow up'}\n                            />\n                        </Tooltip>\n                    }\n                >\n                    {flagIcon}\n                </OverlayTrigger>\n            </button>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {flagPost, unflagPost} from 'actions/post_actions.jsx';\n\nimport PostFlagIcon from './post_flag_icon';\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            flagPost,\n            unflagPost,\n        }, dispatch),\n    };\n}\n\nexport default connect(null, mapDispatchToProps)(PostFlagIcon);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Link} from 'react-router-dom';\n\nimport * as GlobalActions from 'actions/global_actions.jsx';\nimport {isMobile} from 'utils/user_agent';\nimport {Locations} from 'utils/constants';\nimport {isMobile as isMobileView} from 'utils/utils.jsx';\nimport LocalDateTime from 'components/local_date_time';\n\nexport default class PostTime extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * If true, time will be rendered as a permalink to the post\n         */\n        isPermalink: PropTypes.bool.isRequired,\n\n        /*\n         * The time to display\n         */\n        eventTime: PropTypes.number.isRequired,\n\n        location: PropTypes.oneOf([Locations.CENTER, Locations.RHS_ROOT, Locations.RHS_COMMENT, Locations.SEARCH]).isRequired,\n\n        /*\n         * The post id of posting being rendered\n         */\n        postId: PropTypes.string,\n        teamUrl: PropTypes.string,\n    };\n\n    static defaultProps = {\n        eventTime: 0,\n        location: Locations.CENTER,\n    };\n\n    handleClick = () => {\n        if (isMobileView()) {\n            GlobalActions.emitCloseRightHandSide();\n        }\n    };\n\n    render() {\n        const localDateTime = (\n            <LocalDateTime\n                eventTime={this.props.eventTime}\n            />\n        );\n        if (isMobile() || !this.props.isPermalink) {\n            return (\n                <div\n                    role='presentation'\n                    className='post__permalink'\n                >\n                    {localDateTime}\n                </div>\n            );\n        }\n\n        const {\n            location,\n            postId,\n            teamUrl,\n        } = this.props;\n\n        return (\n            <Link\n                id={`${location}_time_${postId}`}\n                to={`${teamUrl}/pl/${postId}`}\n                className='post__permalink'\n                onClick={this.handleClick}\n            >\n                {localDateTime}\n            </Link>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getCurrentRelativeTeamUrl} from 'mattermost-redux/selectors/entities/teams';\n\nimport PostTime from './post_time.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        teamUrl: getCurrentRelativeTeamUrl(state),\n    };\n}\n\nexport default connect(mapStateToProps)(PostTime);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport Permissions from 'mattermost-redux/constants/permissions';\n\nimport {Locations} from 'utils/constants';\nimport {localizeMessage} from 'utils/utils.jsx';\n\nimport OverlayTrigger from 'components/overlay_trigger';\nimport ChannelPermissionGate from 'components/permissions_gates/channel_permission_gate';\nimport EmojiIcon from 'components/widgets/icons/emoji_icon';\nimport EmojiPickerOverlay from 'components/emoji_picker/emoji_picker_overlay.jsx';\n\nconst TOP_OFFSET = -7;\n\nexport default class PostReaction extends React.PureComponent {\n    static propTypes = {\n        channelId: PropTypes.string,\n        postId: PropTypes.string.isRequired,\n        teamId: PropTypes.string.isRequired,\n        getDotMenuRef: PropTypes.func.isRequired,\n        location: PropTypes.oneOf([Locations.CENTER, Locations.RHS_ROOT, Locations.RHS_COMMENT]).isRequired,\n        showEmojiPicker: PropTypes.bool.isRequired,\n        toggleEmojiPicker: PropTypes.func.isRequired,\n        actions: PropTypes.shape({\n            addReaction: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    static defaultProps = {\n        location: Locations.CENTER,\n        showEmojiPicker: false,\n    };\n\n    handleAddEmoji = (emoji) => {\n        this.setState({showEmojiPicker: false});\n        const emojiName = emoji.name || emoji.aliases[0];\n        this.props.actions.addReaction(this.props.postId, emojiName);\n        this.props.toggleEmojiPicker();\n    };\n\n    render() {\n        const {\n            channelId,\n            location,\n            postId,\n            showEmojiPicker,\n            teamId,\n        } = this.props;\n\n        let spaceRequiredAbove;\n        let spaceRequiredBelow;\n        if (location === Locations.RHS_ROOT || location === Locations.RHS_COMMENT) {\n            spaceRequiredAbove = EmojiPickerOverlay.RHS_SPACE_REQUIRED_ABOVE;\n            spaceRequiredBelow = EmojiPickerOverlay.RHS_SPACE_REQUIRED_BELOW;\n        }\n\n        return (\n            <ChannelPermissionGate\n                channelId={channelId}\n                teamId={teamId}\n                permissions={[Permissions.ADD_REACTION]}\n            >\n                <div>\n                    <EmojiPickerOverlay\n                        show={showEmojiPicker}\n                        target={this.props.getDotMenuRef}\n                        onHide={this.props.toggleEmojiPicker}\n                        onEmojiClose={this.props.toggleEmojiPicker}\n                        onEmojiClick={this.handleAddEmoji}\n                        topOffset={TOP_OFFSET}\n                        spaceRequiredAbove={spaceRequiredAbove}\n                        n={true}\n                        spaceRequiredBelow={spaceRequiredBelow}\n                    />\n                    <OverlayTrigger\n                        className='hidden-xs'\n                        delayShow={500}\n                        placement='top'\n                        overlay={\n                            <Tooltip\n                                id='reaction-icon-tooltip'\n                                className='hidden-xs'\n                            >\n                                <FormattedMessage\n                                    id='post_info.tooltip.add_reactions'\n                                    defaultMessage='Add Reaction'\n                                />\n                            </Tooltip>\n                        }\n                    >\n                        <button\n                            data-testid='post-reaction-emoji-icon'\n                            id={`${location}_reaction_${postId}`}\n                            aria-label={localizeMessage('post_info.tooltip.add_reactions', 'Add Reaction').toLowerCase()}\n                            className='reacticon__container color--link style--none'\n                            onClick={this.props.toggleEmojiPicker}\n                        >\n                            <EmojiIcon className='icon icon--emoji'/>\n                        </button>\n                    </OverlayTrigger>\n                </div>\n            </ChannelPermissionGate>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {addReaction} from 'actions/post_actions.jsx';\n\nimport PostReaction from './post_reaction';\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            addReaction,\n        }, dispatch),\n    };\n}\n\nexport default connect(null, mapDispatchToProps)(PostReaction);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport OverlayTrigger from 'components/overlay_trigger';\n\nimport * as Utils from 'utils/utils.jsx';\n\nexport default class Reaction extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * The post to render the reaction for\n         */\n        post: PropTypes.object.isRequired,\n\n        /*\n         * The user id of the logged in user\n         */\n        currentUserId: PropTypes.string.isRequired,\n\n        /*\n         * The name of the emoji for the reaction\n         */\n        emojiName: PropTypes.string.isRequired,\n\n        /*\n         * The number of reactions to this post for this emoji\n         */\n        reactionCount: PropTypes.number.isRequired,\n\n        /*\n         * Array of users who reacted to this post\n         */\n        profiles: PropTypes.array.isRequired,\n\n        /*\n         * The number of users not in the profile list who have reacted with this emoji\n         */\n        otherUsersCount: PropTypes.number.isRequired,\n\n        /*\n         * Array of reactions by user\n         */\n        reactions: PropTypes.arrayOf(PropTypes.object).isRequired,\n\n        /*\n         * True if the user has the permission to add a reaction in this channel\n         */\n        canAddReaction: PropTypes.bool.isRequired,\n\n        /*\n         * True if user has the permission to remove his own reactions in this channel\n         */\n        canRemoveReaction: PropTypes.bool.isRequired,\n\n        /*\n         * The URL of the emoji image\n         */\n        emojiImageUrl: PropTypes.string.isRequired,\n\n        actions: PropTypes.shape({\n\n            /*\n             * Function to add a reaction to a post\n             */\n            addReaction: PropTypes.func.isRequired,\n\n            /*\n             * Function to get non-loaded profiles by id\n             */\n            getMissingProfilesByIds: PropTypes.func.isRequired,\n\n            /*\n             * Function to remove a reaction from a post\n             */\n            removeReaction: PropTypes.func.isRequired,\n        }),\n        sortedUsers: PropTypes.object.isRequired,\n    }\n\n    handleAddReaction = (e) => {\n        e.preventDefault();\n        const {actions, post, emojiName} = this.props;\n        actions.addReaction(post.id, emojiName);\n    }\n\n    handleRemoveReaction = (e) => {\n        e.preventDefault();\n        this.props.actions.removeReaction(this.props.post.id, this.props.emojiName);\n    }\n\n    loadMissingProfiles = async () => {\n        const ids = this.props.reactions.map((reaction) => reaction.user_id);\n        this.props.actions.getMissingProfilesByIds(ids);\n    }\n\n    render() {\n        if (!this.props.emojiImageUrl) {\n            return null;\n        }\n\n        const {currentUserReacted, users} = this.props.sortedUsers;\n\n        const otherUsersCount = this.props.otherUsersCount;\n        let names;\n        if (otherUsersCount > 0) {\n            if (users.length > 0) {\n                names = (\n                    <FormattedMessage\n                        id='reaction.usersAndOthersReacted'\n                        defaultMessage='{users} and {otherUsers, number} other {otherUsers, plural, one {user} other {users}}'\n                        values={{\n                            users: users.join(', '),\n                            otherUsers: otherUsersCount,\n                        }}\n                    />\n                );\n            } else {\n                names = (\n                    <FormattedMessage\n                        id='reaction.othersReacted'\n                        defaultMessage='{otherUsers, number} {otherUsers, plural, one {user} other {users}}'\n                        values={{\n                            otherUsers: otherUsersCount,\n                        }}\n                    />\n                );\n            }\n        } else if (users.length > 1) {\n            names = (\n                <FormattedMessage\n                    id='reaction.usersReacted'\n                    defaultMessage='{users} and {lastUser}'\n                    values={{\n                        users: users.slice(0, -1).join(', '),\n                        lastUser: users[users.length - 1],\n                    }}\n                />\n            );\n        } else {\n            names = users[0];\n        }\n\n        let reactionVerb;\n        if (users.length + otherUsersCount > 1) {\n            if (currentUserReacted) {\n                reactionVerb = (\n                    <FormattedMessage\n                        id='reaction.reactionVerb.youAndUsers'\n                        defaultMessage='reacted'\n                    />\n                );\n            } else {\n                reactionVerb = (\n                    <FormattedMessage\n                        id='reaction.reactionVerb.users'\n                        defaultMessage='reacted'\n                    />\n                );\n            }\n        } else if (currentUserReacted) {\n            reactionVerb = (\n                <FormattedMessage\n                    id='reaction.reactionVerb.you'\n                    defaultMessage='reacted'\n                />\n            );\n        } else {\n            reactionVerb = (\n                <FormattedMessage\n                    id='reaction.reactionVerb.user'\n                    defaultMessage='reacted'\n                />\n            );\n        }\n\n        const tooltip = (\n            <FormattedMessage\n                id='reaction.reacted'\n                defaultMessage='{users} {reactionVerb} with {emoji}'\n                values={{\n                    users: <b>{names}</b>,\n                    reactionVerb,\n                    emoji: <b>{':' + this.props.emojiName + ':'}</b>,\n                }}\n            />\n        );\n\n        let handleClick;\n        let clickTooltip;\n        let className = 'post-reaction';\n        const emojiNameWithSpaces = this.props.emojiName.replace(/_/g, ' ');\n        let ariaLabelEmoji = `${Utils.localizeMessage('reaction.reactWidth.ariaLabel', 'react with')} ${emojiNameWithSpaces}`;\n        if (currentUserReacted) {\n            if (this.props.canRemoveReaction) {\n                handleClick = this.handleRemoveReaction;\n                ariaLabelEmoji = `${Utils.localizeMessage('reaction.removeReact.ariaLabel', 'remove reaction')} ${emojiNameWithSpaces}`;\n                clickTooltip = (\n                    <FormattedMessage\n                        id='reaction.clickToRemove'\n                        defaultMessage='(click to remove)'\n                    />\n                );\n            } else {\n                className += ' post-reaction--read-only';\n            }\n\n            className += ' post-reaction--current-user';\n        } else if (!currentUserReacted && this.props.canAddReaction) {\n            handleClick = this.handleAddReaction;\n            clickTooltip = (\n                <FormattedMessage\n                    id='reaction.clickToAdd'\n                    defaultMessage='(click to add)'\n                />\n            );\n        } else {\n            className += ' post-reaction--read-only';\n        }\n\n        return (\n            <button\n                id={`postReaction-${this.props.post.id}-${this.props.emojiName}`}\n                aria-label={ariaLabelEmoji}\n                className={`style--none ${className}`}\n                onClick={handleClick}\n            >\n                <OverlayTrigger\n                    delayShow={500}\n                    placement='top'\n                    shouldUpdatePosition={true}\n                    overlay={\n                        <Tooltip id={`${this.props.post.id}-${this.props.emojiName}-reaction`}>\n                            {tooltip}\n                            <br/>\n                            {clickTooltip}\n                        </Tooltip>\n                    }\n                    onEnter={this.loadMissingProfiles}\n                >\n                    <span className='d-flex align-items-center'>\n                        <span\n                            className='post-reaction__emoji emoticon'\n                            style={{backgroundImage: 'url(' + this.props.emojiImageUrl + ')'}}\n                        />\n                        <span\n                            className='post-reaction__count'\n                        >\n                            {this.props.reactionCount}\n                        </span>\n                    </span>\n                </OverlayTrigger>\n            </button>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {removeReaction} from 'mattermost-redux/actions/posts';\nimport {getMissingProfilesByIds} from 'mattermost-redux/actions/users';\nimport {getCurrentUserId, makeGetProfilesForReactions, getCurrentUser} from 'mattermost-redux/selectors/entities/users';\nimport {getChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getCustomEmojisByName} from 'mattermost-redux/selectors/entities/emojis';\nimport {getEmojiImageUrl} from 'mattermost-redux/utils/emoji_utils';\nimport {getTeammateNameDisplaySetting} from 'mattermost-redux/selectors/entities/preferences';\nimport {haveIChannelPermission} from 'mattermost-redux/selectors/entities/roles';\nimport Permissions from 'mattermost-redux/constants/permissions';\nimport Constants from 'mattermost-redux/constants/general';\nimport {getConfig, getLicense} from 'mattermost-redux/selectors/entities/general';\n\nimport {addReaction} from 'actions/post_actions.jsx';\n\nimport * as Emoji from 'utils/emoji.jsx';\nimport {getSortedUsers} from 'utils/utils.jsx';\n\nimport Reaction from './reaction.jsx';\n\nfunction makeMapStateToProps() {\n    const getProfilesForReactions = makeGetProfilesForReactions();\n\n    return function mapStateToProps(state, ownProps) {\n        const config = getConfig(state);\n        const license = getLicense(state);\n        const me = getCurrentUser(state);\n\n        const profiles = getProfilesForReactions(state, ownProps.reactions);\n        let emoji;\n        if (Emoji.EmojiIndicesByAlias.has(ownProps.emojiName)) {\n            emoji = Emoji.Emojis[Emoji.EmojiIndicesByAlias.get(ownProps.emojiName)];\n        } else {\n            const emojis = getCustomEmojisByName(state);\n            emoji = emojis.get(ownProps.emojiName);\n        }\n\n        let emojiImageUrl = '';\n        if (emoji) {\n            emojiImageUrl = getEmojiImageUrl(emoji);\n        }\n        const channel = getChannel(state, ownProps.post.channel_id) || {};\n        const channelIsArchived = channel.delete_at !== 0;\n        const teamId = channel.team_id;\n        const currentUserId = getCurrentUserId(state);\n        const teammateNameDisplaySetting = getTeammateNameDisplaySetting(state);\n        let canAddReaction = false;\n        let canRemoveReaction = false;\n\n        if (!channelIsArchived) {\n            canAddReaction = checkReactionAction(state, teamId, ownProps.post.channel_id, channel.name, config, license, me, Permissions.REMOVE_REACTION);\n            canRemoveReaction = checkReactionAction(state, teamId, ownProps.post.channel_id, channel.name, config, license, me, Permissions.ADD_REACTION);\n        }\n\n        return {\n            profiles,\n            otherUsersCount: ownProps.reactions.length - profiles.length,\n            currentUserId,\n            reactionCount: ownProps.reactions.length,\n            canAddReaction,\n            canRemoveReaction,\n            emojiImageUrl,\n            sortedUsers: getSortedUsers(ownProps.reactions, currentUserId, profiles, teammateNameDisplaySetting),\n        };\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            addReaction,\n            removeReaction,\n            getMissingProfilesByIds,\n        }, dispatch),\n    };\n}\n\nfunction checkReactionAction(state, teamId, channelId, channelName, config, license, user, permission) {\n    if (!haveIChannelPermission(state, {team: teamId, channel: channelId, permission})) {\n        return false;\n    }\n\n    if (channelName === Constants.DEFAULT_CHANNEL && config.ExperimentalTownSquareIsReadOnly === 'true' && license.IsLicensed === 'true' && !user.roles.includes('system_admin')) {\n        return false;\n    }\n\n    return true;\n}\n\nexport default connect(makeMapStateToProps, mapDispatchToProps)(Reaction);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\nimport Permissions from 'mattermost-redux/constants/permissions';\n\nimport Constants from 'utils/constants';\nimport Reaction from 'components/post_view/reaction';\nimport EmojiPickerOverlay from 'components/emoji_picker/emoji_picker_overlay.jsx';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport ChannelPermissionGate from 'components/permissions_gates/channel_permission_gate';\nimport {localizeMessage} from 'utils/utils.jsx';\n\nconst DEFAULT_EMOJI_PICKER_RIGHT_OFFSET = 15;\nconst EMOJI_PICKER_WIDTH_OFFSET = 260;\n\nexport default class ReactionList extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * The post to render reactions for\n         */\n        post: PropTypes.object.isRequired,\n\n        /*\n         * The id of the team which belongs the post\n         */\n        teamId: PropTypes.string,\n\n        /**\n         * The reactions to render\n         */\n        reactions: PropTypes.object,\n\n        /**\n         * Whether to show the emoji picker.\n         */\n        enableEmojiPicker: PropTypes.bool.isRequired,\n\n        actions: PropTypes.shape({\n\n            /**\n             * Function to add a reaction to the post\n             */\n            addReaction: PropTypes.func.isRequired,\n        }),\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            showEmojiPicker: false,\n        };\n    }\n\n    getTarget = () => {\n        return this.refs.addReactionButton;\n    }\n\n    handleEmojiClick = (emoji) => {\n        this.setState({showEmojiPicker: false});\n        const emojiName = emoji.name || emoji.aliases[0];\n        this.props.actions.addReaction(this.props.post.id, emojiName);\n    }\n\n    hideEmojiPicker = () => {\n        this.setState({showEmojiPicker: false});\n    }\n\n    toggleEmojiPicker = () => {\n        this.setState({showEmojiPicker: !this.state.showEmojiPicker});\n    }\n\n    render() {\n        const reactionsByName = new Map();\n        const emojiNames = [];\n\n        if (this.props.reactions) {\n            for (const reaction of Object.values(this.props.reactions)) {\n                const emojiName = reaction.emoji_name;\n\n                if (reactionsByName.has(emojiName)) {\n                    reactionsByName.get(emojiName).push(reaction);\n                } else {\n                    emojiNames.push(emojiName);\n                    reactionsByName.set(emojiName, [reaction]);\n                }\n            }\n        }\n\n        if (reactionsByName.size === 0) {\n            return null;\n        }\n\n        const reactions = emojiNames.map((emojiName) => {\n            return (\n                <Reaction\n                    key={emojiName}\n                    post={this.props.post}\n                    emojiName={emojiName}\n                    reactions={reactionsByName.get(emojiName) || []}\n                />\n            );\n        });\n\n        const addReactionButton = this.getTarget();\n        let rightOffset = DEFAULT_EMOJI_PICKER_RIGHT_OFFSET;\n        if (addReactionButton) {\n            rightOffset = window.innerWidth - addReactionButton.getBoundingClientRect().right - EMOJI_PICKER_WIDTH_OFFSET;\n\n            if (rightOffset < 0) {\n                rightOffset = DEFAULT_EMOJI_PICKER_RIGHT_OFFSET;\n            }\n        }\n\n        let emojiPicker = null;\n        if (this.props.enableEmojiPicker) {\n            const addReactionTooltip = (\n                <Tooltip id='addReactionTooltip'>\n                    <FormattedMessage\n                        id='reaction_list.addReactionTooltip'\n                        defaultMessage='Add reaction'\n                    />\n                </Tooltip>\n            );\n\n            emojiPicker = (\n                <span className='emoji-picker__container'>\n                    <EmojiPickerOverlay\n                        show={this.state.showEmojiPicker}\n                        target={this.getTarget}\n                        onHide={this.hideEmojiPicker}\n                        onEmojiClose={this.hideEmojiPicker}\n                        onEmojiClick={this.handleEmojiClick}\n                        rightOffset={rightOffset}\n                        topOffset={-5}\n                    />\n                    <OverlayTrigger\n                        placement='top'\n                        delayShow={Constants.OVERLAY_TIME_DELAY}\n                        overlay={addReactionTooltip}\n                    >\n                        <ChannelPermissionGate\n                            channelId={this.props.post.channel_id}\n                            teamId={this.props.teamId}\n                            permissions={[Permissions.ADD_REACTION]}\n                        >\n                            <button\n                                aria-label={localizeMessage('reaction.add.ariaLabel', 'Add reaction')}\n                                className='style--none post-reaction'\n                                onClick={this.toggleEmojiPicker}\n                            >\n                                <span\n                                    id={`addReaction-${this.props.post.id}`}\n                                    className='post-reaction__add'\n                                    ref='addReactionButton'\n                                >\n                                    {'+'}\n                                </span>\n                            </button>\n                        </ChannelPermissionGate>\n                    </OverlayTrigger>\n                </span>\n            );\n        }\n\n        let addReactionClassName = 'post-add-reaction';\n        if (this.state.showEmojiPicker) {\n            addReactionClassName += ' post-add-reaction-emoji-picker-open';\n        }\n\n        return (\n            <div\n                aria-label={localizeMessage('reaction.container.ariaLabel', 'reactions')}\n                className='post-reaction-list'\n            >\n                {reactions}\n                <div className={addReactionClassName}>\n                    {emojiPicker}\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {makeGetReactionsForPost} from 'mattermost-redux/selectors/entities/posts';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport {addReaction} from 'actions/post_actions.jsx';\n\nimport ReactionList from './reaction_list.jsx';\n\nfunction makeMapStateToProps() {\n    const getReactionsForPost = makeGetReactionsForPost();\n\n    return function mapStateToProps(state, ownProps) {\n        const config = getConfig(state);\n        const enableEmojiPicker = config.EnableEmojiPicker === 'true' && !ownProps.isReadOnly;\n\n        const channel = getChannel(state, ownProps.post.channel_id) || {};\n        const teamId = channel.team_id;\n\n        return {\n            teamId,\n            reactions: getReactionsForPost(state, ownProps.post.id),\n            enableEmojiPicker,\n        };\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            addReaction,\n        }, dispatch),\n    };\n}\n\nexport default connect(makeMapStateToProps, mapDispatchToProps)(ReactionList);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport {localizeMessage} from 'utils/utils.jsx';\n\nconst MAX_POST_HEIGHT = 600;\nconst MAX_ATTACHMENT_TEXT_HEIGHT = 200;\nconst MARGIN_CHANGE_FOR_COMPACT_POST = 22;\n\nexport default class ShowMore extends React.PureComponent {\n    static propTypes = {\n        children: PropTypes.node,\n        checkOverflow: PropTypes.number,\n        isAttachmentText: PropTypes.bool,\n        isRHSExpanded: PropTypes.bool.isRequired,\n        isRHSOpen: PropTypes.bool.isRequired,\n        text: PropTypes.string,\n        compactDisplay: PropTypes.bool.isRequired,\n    }\n    constructor(props) {\n        super(props);\n        this.maxHeight = this.props.isAttachmentText ? MAX_ATTACHMENT_TEXT_HEIGHT : MAX_POST_HEIGHT;\n        this.state = {\n            isCollapsed: true,\n            isOverflow: false,\n        };\n    }\n\n    componentDidMount() {\n        this.checkTextOverflow();\n\n        window.addEventListener('resize', this.handleResize);\n    }\n\n    componentDidUpdate(prevProps) {\n        if (\n            this.props.text !== prevProps.text ||\n            this.props.isRHSExpanded !== prevProps.isRHSExpanded ||\n            this.props.isRHSOpen !== prevProps.isRHSOpen ||\n            this.props.checkOverflow !== prevProps.checkOverflow\n        ) {\n            this.checkTextOverflow();\n        }\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.handleResize);\n        if (this.overflowRef) {\n            window.cancelAnimationFrame(this.overflowRef);\n        }\n    }\n\n    toggleCollapse = (e) => {\n        e.preventDefault();\n        this.setState((prevState) => {\n            return {\n                isCollapsed: !prevState.isCollapsed,\n            };\n        });\n    };\n\n    checkTextOverflow = () => {\n        if (this.overflowRef) {\n            window.cancelAnimationFrame(this.overflowRef);\n        }\n        this.overflowRef = window.requestAnimationFrame(() => {\n            const textContainer = this.refs.textContainer;\n            let isOverflow = false;\n\n            if (textContainer && textContainer.scrollHeight > this.maxHeight) {\n                isOverflow = true;\n            }\n\n            if (isOverflow !== this.state.isOverflow) {\n                this.setState({\n                    isOverflow,\n                });\n            }\n        });\n    };\n\n    handleResize = () => {\n        this.checkTextOverflow();\n    };\n\n    render() {\n        const {\n            isCollapsed,\n            isOverflow,\n        } = this.state;\n\n        const {\n            children,\n            isAttachmentText,\n            compactDisplay,\n        } = this.props;\n\n        let className = 'post-message';\n        let collapsedMaxHeightStyle;\n        if (isCollapsed) {\n            collapsedMaxHeightStyle = this.maxHeight;\n            className += ' post-message--collapsed';\n        } else {\n            className += ' post-message--expanded';\n        }\n\n        let collapseGradientClass = 'post-collapse__gradient';\n        let collapseShowMoreClass = 'post-collapse__show-more';\n        if (isAttachmentText) {\n            collapseGradientClass = 'post-attachment-collapse__gradient';\n            collapseShowMoreClass = 'post-attachment-collapse__show-more';\n        }\n\n        let attachmentTextOverflow = null;\n        if (isOverflow) {\n            if (!isAttachmentText && isCollapsed && compactDisplay) {\n                collapsedMaxHeightStyle -= MARGIN_CHANGE_FOR_COMPACT_POST;\n            }\n\n            let showIcon = 'fa fa-angle-up';\n            let showText = localizeMessage('post_info.message.show_less', 'Show less');\n            if (isCollapsed) {\n                showIcon = 'fa fa-angle-down';\n                showText = localizeMessage('post_info.message.show_more', 'Show more');\n            }\n\n            attachmentTextOverflow = (\n                <div className='post-collapse'>\n                    <div\n                        id='collapseGradient'\n                        className={collapseGradientClass}\n                    />\n                    <div className={collapseShowMoreClass}>\n                        <div className='post-collapse__show-more-line'/>\n                        <button\n                            id='showMoreButton'\n                            className='post-collapse__show-more-button'\n                            onClick={this.toggleCollapse}\n                        >\n                            <span className={showIcon}/>\n                            {showText}\n                        </button>\n                        <div className='post-collapse__show-more-line'/>\n                    </div>\n                </div>\n            );\n\n            className += ' post-message--overflow';\n        }\n\n        return (\n            <div className={className}>\n                <div\n                    style={{maxHeight: collapsedMaxHeightStyle}}\n                    className='post-message__text-container'\n                    ref='textContainer'\n                >\n                    {children}\n                </div>\n                {attachmentTextOverflow}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {get} from 'mattermost-redux/selectors/entities/preferences';\n\nimport {getIsRhsExpanded, getIsRhsOpen} from 'selectors/rhs';\nimport {Preferences} from 'utils/constants';\n\nimport ShowMore from './show_more';\n\nfunction mapStateToProps(state) {\n    return {\n        isRHSExpanded: getIsRhsExpanded(state),\n        isRHSOpen: getIsRhsOpen(state),\n        compactDisplay: get(state, Preferences.CATEGORY_DISPLAY_SETTINGS, Preferences.MESSAGE_DISPLAY, Preferences.MESSAGE_DISPLAY_DEFAULT) === Preferences.MESSAGE_DISPLAY_COMPACT,\n    };\n}\n\nexport default connect(mapStateToProps)(ShowMore);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport Markdown from 'components/markdown';\n\nexport default class ActionButton extends React.PureComponent {\n    static propTypes = {\n        action: PropTypes.object.isRequired,\n        handleAction: PropTypes.func.isRequired,\n        disabled: PropTypes.bool,\n    }\n\n    render() {\n        const {action, handleAction, disabled} = this.props;\n        return (\n            <button\n                data-action-id={action.id}\n                data-action-cookie={action.cookie}\n                disabled={disabled}\n                key={action.id}\n                onClick={handleAction}\n            >\n                <Markdown\n                    message={action.name}\n                    options={{\n                        mentionHighlight: false,\n                        markdown: false,\n                        autolinkedUrlSchemes: [],\n                    }}\n                />\n            </button>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nconst PostContext = React.createContext({\n\n    // Post component event handler that should be\n    // called when any child component opens/closes a\n    // popup type component.\n    handlePopupOpened: null,\n});\n\nexport default PostContext;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport MenuActionProvider from 'components/suggestion/menu_action_provider';\nimport GenericUserProvider from 'components/suggestion/generic_user_provider.jsx';\nimport GenericChannelProvider from 'components/suggestion/generic_channel_provider.jsx';\nimport AutocompleteSelector from 'components/autocomplete_selector';\nimport PostContext from 'components/post_view/post_context';\n\nexport default class ActionMenu extends React.PureComponent {\n    static propTypes = {\n        postId: PropTypes.string.isRequired,\n        action: PropTypes.object.isRequired,\n        selected: PropTypes.object,\n        disabled: PropTypes.bool,\n        actions: PropTypes.shape({\n            autocompleteChannels: PropTypes.func.isRequired,\n            selectAttachmentMenuAction: PropTypes.func.isRequired,\n            autocompleteUsers: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        const action = props.action;\n        this.providers = [];\n        if (action) {\n            if (action.data_source === 'users') {\n                this.providers = [new GenericUserProvider(props.actions.autocompleteUsers)];\n            } else if (action.data_source === 'channels') {\n                this.providers = [new GenericChannelProvider(props.actions.autocompleteChannels)];\n            } else if (action.options) {\n                this.providers = [new MenuActionProvider(action.options)];\n            }\n        }\n\n        let selected;\n        let value = '';\n\n        if (action.default_option && action.options) {\n            selected = action.options.find((option) => option.value === action.default_option);\n            value = selected ? selected.text : '';\n        }\n\n        this.state = {\n            selected,\n            value,\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        if (props.selected && props.selected !== state.selected) {\n            return {\n                value: props.selected.text,\n                selected: props.selected,\n            };\n        }\n\n        return null;\n    }\n\n    handleSelected = (selected) => {\n        if (!selected) {\n            return;\n        }\n\n        const {action} = this.props;\n\n        let value = '';\n        let text = '';\n        if (action.data_source === 'users') {\n            text = selected.username;\n            value = selected.id;\n        } else if (action.data_source === 'channels') {\n            text = selected.display_name;\n            value = selected.id;\n        } else {\n            text = selected.text;\n            value = selected.value;\n        }\n\n        this.props.actions.selectAttachmentMenuAction(this.props.postId, this.props.action.id, this.props.action.cookie, this.props.action.data_source, text, value);\n\n        this.setState({value: text});\n    }\n\n    render() {\n        const {action, disabled} = this.props;\n\n        return (\n            <PostContext.Consumer>\n                {({handlePopupOpened}) => (\n                    <AutocompleteSelector\n                        providers={this.providers}\n                        onSelected={this.handleSelected}\n                        placeholder={action.name}\n                        inputClassName='post-attachment-dropdown'\n                        value={this.state.value}\n                        toggleFocus={handlePopupOpened}\n                        disabled={disabled}\n                    />\n                )}\n            </PostContext.Consumer>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {autocompleteChannels} from 'actions/channel_actions';\nimport {autocompleteUsers} from 'actions/user_actions';\nimport {selectAttachmentMenuAction} from 'actions/views/posts';\n\nimport ActionMenu from './action_menu.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    const actions = state.views.posts.menuActions[ownProps.postId];\n    const selected = actions && actions[ownProps.action && ownProps.action.id];\n\n    return {\n        selected,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            selectAttachmentMenuAction,\n            autocompleteChannels,\n            autocompleteUsers,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ActionMenu);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {getScheme} from 'utils/url';\n\nimport RemoveMarkdown from './remove_markdown';\n\nexport default class LinkOnlyRenderer extends RemoveMarkdown {\n    public link(href: string, title: string, text: string) {\n        let outHref = href;\n\n        if (!getScheme(href)) {\n            outHref = `http://${outHref}`;\n        }\n\n        let output = `<a class=\"theme markdown__link\" href=\"${outHref}\" target=\"_blank\"`;\n\n        if (title) {\n            output += ' title=\"' + title + '\"';\n        }\n\n        output += `>${text}</a>`;\n\n        return output;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport truncate from 'lodash/truncate';\n\nimport {isUrlSafe} from 'utils/url';\nimport {Constants} from 'utils/constants';\nimport * as Utils from 'utils/utils';\n\nimport ExternalImage from 'components/external_image';\nimport Markdown from 'components/markdown';\nimport ShowMore from 'components/post_view/show_more';\nimport SizeAwareImage from 'components/size_aware_image';\n\nimport ActionButton from '../action_button';\nimport ActionMenu from '../action_menu';\nimport LinkOnlyRenderer from 'utils/markdown/link_only_renderer';\n\nexport default class MessageAttachment extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * The post id\n         */\n        postId: PropTypes.string.isRequired,\n\n        /**\n         * The attachment to render\n         */\n        attachment: PropTypes.object.isRequired,\n\n        /**\n         * Options specific to text formatting\n         */\n        options: PropTypes.object,\n\n        /**\n         * images object for dimensions\n         */\n        imagesMetadata: PropTypes.object,\n\n        actions: PropTypes.shape({\n            doPostActionWithCookie: PropTypes.func.isRequired,\n        }).isRequired,\n\n        currentRelativeTeamUrl: PropTypes.string.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            checkOverflow: 0,\n        };\n\n        this.imageProps = {\n            onImageLoaded: this.handleHeightReceived,\n        };\n    }\n\n    componentDidMount() {\n        this.mounted = true;\n    }\n\n    componentWillUnmount() {\n        this.mounted = false;\n    }\n\n    handleHeightReceivedForThumbUrl = ({height}) => {\n        const {attachment} = this.props;\n        if (!this.props.imagesMetadata || (this.props.imagesMetadata && !this.props.imagesMetadata[attachment.thumb_url])) {\n            this.handleHeightReceived(height);\n        }\n    }\n\n    handleHeightReceivedForImageUrl = ({height}) => {\n        const {attachment} = this.props;\n        if (!this.props.imagesMetadata || (this.props.imagesMetadata && !this.props.imagesMetadata[attachment.image_url])) {\n            this.handleHeightReceived(height);\n        }\n    }\n\n    handleHeightReceived = (height) => {\n        if (!this.mounted) {\n            return;\n        }\n\n        if (height > 0) {\n            // Increment checkOverflow to indicate change in height\n            // and recompute textContainer height at ShowMore component\n            // and see whether overflow text of show more/less is necessary or not.\n            this.setState((prevState) => {\n                return {checkOverflow: prevState.checkOverflow + 1};\n            });\n        }\n    };\n\n    renderPostActions = () => {\n        const actions = this.props.attachment.actions;\n        if (!actions || !actions.length) {\n            return '';\n        }\n\n        const content = [];\n\n        actions.forEach((action) => {\n            if (!action.id || !action.name) {\n                return;\n            }\n\n            switch (action.type) {\n            case 'select':\n                content.push(\n                    <ActionMenu\n                        key={action.id}\n                        postId={this.props.postId}\n                        action={action}\n                        disabled={action.disabled}\n                    />\n                );\n                break;\n            case 'button':\n            default:\n                content.push(\n                    <ActionButton\n                        key={action.id}\n                        action={action}\n                        disabled={action.disabled}\n                        handleAction={this.handleAction}\n                    />\n                );\n                break;\n            }\n        });\n\n        return (\n            <div\n                className='attachment-actions'\n            >\n                {content}\n            </div>\n        );\n    };\n\n    handleAction = (e) => {\n        e.preventDefault();\n        const actionId = e.currentTarget.getAttribute('data-action-id');\n        const actionCookie = e.currentTarget.getAttribute('data-action-cookie');\n\n        this.props.actions.doPostActionWithCookie(this.props.postId, actionId, actionCookie);\n    };\n\n    getFieldsTable = () => {\n        const fields = this.props.attachment.fields;\n        if (!fields || !fields.length) {\n            return '';\n        }\n\n        const fieldTables = [];\n\n        let headerCols = [];\n        let bodyCols = [];\n        let rowPos = 0;\n        let lastWasLong = false;\n        let nrTables = 0;\n        const markdown = {markdown: false, mentionHighlight: false};\n\n        fields.forEach((field, i) => {\n            if (rowPos === 2 || !(field.short === true) || lastWasLong) {\n                fieldTables.push(\n                    <table\n                        className='attachment-fields'\n                        key={'attachment__table__' + nrTables}\n                    >\n                        <thead>\n                            <tr>\n                                {headerCols}\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr>\n                                {bodyCols}\n                            </tr>\n                        </tbody>\n                    </table>\n                );\n                headerCols = [];\n                bodyCols = [];\n                rowPos = 0;\n                nrTables += 1;\n                lastWasLong = false;\n            }\n            headerCols.push(\n                <th\n                    className='attachment-field__caption'\n                    key={'attachment__field-caption-' + i + '__' + nrTables}\n                    width='50%'\n                >\n                    <Markdown\n                        message={field.title}\n                        options={markdown}\n                    />\n                </th>\n            );\n\n            bodyCols.push(\n                <td\n                    className='attachment-field'\n                    key={'attachment__field-' + i + '__' + nrTables}\n                >\n                    <Markdown message={field.value}/>\n                </td>\n            );\n            rowPos += 1;\n            lastWasLong = !(field.short === true);\n        });\n        if (headerCols.length > 0) { // Flush last fields\n            fieldTables.push(\n                <table\n                    className='attachment-fields'\n                    key={'attachment__table__' + nrTables}\n                >\n                    <thead>\n                        <tr>\n                            {headerCols}\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr>\n                            {bodyCols}\n                        </tr>\n                    </tbody>\n                </table>\n            );\n        }\n        return (\n            <div>\n                {fieldTables}\n            </div>\n        );\n    };\n\n    handleFormattedTextClick = (e) => Utils.handleFormattedTextClick(e, this.props.currentRelativeTeamUrl);\n\n    render() {\n        const {attachment, options} = this.props;\n        let preTextClass = '';\n\n        let preText;\n        if (attachment.pretext) {\n            preTextClass = 'attachment--pretext';\n            preText = (\n                <div className='attachment__thumb-pretext'>\n                    <Markdown message={attachment.pretext}/>\n                </div>\n            );\n        }\n\n        let author = [];\n        if (attachment.author_name || attachment.author_icon) {\n            if (attachment.author_icon) {\n                author.push(\n                    <ExternalImage\n                        key={'attachment__author-icon'}\n                        src={attachment.author_icon}\n                        imageMetadata={this.props.imagesMetadata[attachment.author_icon]}\n                    >\n                        {(iconUrl) => (\n                            <img\n                                alt={'attachment author icon'}\n                                className='attachment__author-icon'\n                                src={iconUrl}\n                                height='14'\n                                width='14'\n                            />\n                        )}\n                    </ExternalImage>\n                );\n            }\n            if (attachment.author_name) {\n                author.push(\n                    <span\n                        className='attachment__author-name'\n                        key={'attachment__author-name'}\n                    >\n                        {attachment.author_name}\n                    </span>\n                );\n            }\n        }\n        if (attachment.author_link && isUrlSafe(attachment.author_link)) {\n            author = (\n                <a\n                    href={attachment.author_link}\n                    target='_blank'\n                    rel='noopener noreferrer'\n                >\n                    {author}\n                </a>\n            );\n        }\n\n        let title;\n        if (attachment.title) {\n            if (attachment.title_link && isUrlSafe(attachment.title_link)) {\n                title = (\n                    <h1 className='attachment__title'>\n                        <a\n                            className='attachment__title-link'\n                            href={attachment.title_link}\n                            target='_blank'\n                            rel='noopener noreferrer'\n                        >\n                            {attachment.title}\n                        </a>\n                    </h1>\n                );\n            } else {\n                title = (\n                    <h1 className='attachment__title'>\n                        <Markdown\n                            message={attachment.title}\n                            options={{\n                                mentionHighlight: false,\n                                renderer: new LinkOnlyRenderer(),\n                                autolinkedUrlSchemes: [],\n                            }}\n                        />\n                    </h1>\n                );\n            }\n        }\n\n        let attachmentText;\n        if (attachment.text) {\n            attachmentText = (\n                <ShowMore\n                    checkOverflow={this.state.checkOverflow}\n                    isAttachmentText={true}\n                    text={attachment.text}\n                >\n                    <Markdown\n                        message={attachment.text || ''}\n                        options={options}\n                        imageProps={this.imageProps}\n                    />\n                </ShowMore>\n            );\n        }\n\n        let image;\n        if (attachment.image_url) {\n            const imageMetadata = this.props.imagesMetadata[attachment.image_url];\n\n            image = (\n                <div className='attachment__image-container'>\n                    <ExternalImage\n                        src={attachment.image_url}\n                        imageMetadata={imageMetadata}\n                    >\n                        {(imageUrl) => (\n                            <SizeAwareImage\n                                className='attachment__image'\n                                onImageLoaded={this.handleHeightReceivedForImageUrl}\n                                src={imageUrl}\n                                dimensions={imageMetadata}\n                            />\n                        )}\n                    </ExternalImage>\n                </div>\n            );\n        }\n\n        let footer;\n        if (attachment.footer) {\n            let footerIcon;\n            if (attachment.footer_icon) {\n                const footerIconMetadata = this.props.imagesMetadata[attachment.footer_icon];\n\n                footerIcon = (\n                    <ExternalImage\n                        src={attachment.footer_icon}\n                        imageMetadata={footerIconMetadata}\n                    >\n                        {(footerIconUrl) => (\n                            <img\n                                alt={'attachment footer icon'}\n                                className='attachment__footer-icon'\n                                src={footerIconUrl}\n                                height='16'\n                                width='16'\n                            />\n                        )}\n                    </ExternalImage>\n                );\n            }\n\n            footer = (\n                <div className='attachment__footer-container'>\n                    {footerIcon}\n                    <span>{truncate(attachment.footer, {length: Constants.MAX_ATTACHMENT_FOOTER_LENGTH, omission: ''})}</span>\n                </div>\n            );\n        }\n\n        let thumb;\n        if (attachment.thumb_url) {\n            const thumbMetadata = this.props.imagesMetadata[attachment.thumb_url];\n\n            thumb = (\n                <div className='attachment__thumb-container'>\n                    <ExternalImage\n                        src={attachment.thumb_url}\n                        imageMetadata={thumbMetadata}\n                    >\n                        {(thumbUrl) => (\n                            <SizeAwareImage\n                                onImageLoaded={this.handleHeightReceivedForThumbUrl}\n                                src={thumbUrl}\n                                dimensions={thumbMetadata}\n                            />\n                        )}\n                    </ExternalImage>\n                </div>\n            );\n        }\n\n        const fields = this.getFieldsTable();\n        const actions = this.renderPostActions();\n\n        let useBorderStyle;\n        if (attachment.color && attachment.color[0] === '#') {\n            useBorderStyle = {borderLeftColor: attachment.color};\n        }\n\n        return (\n            <div\n                className={'attachment ' + preTextClass}\n                ref='attachment'\n            >\n                {preText}\n                <div className='attachment__content'>\n                    <div\n                        className={useBorderStyle ? 'clearfix attachment__container' : 'clearfix attachment__container attachment__container--' + attachment.color}\n                        style={useBorderStyle}\n                    >\n                        {author}\n                        {title}\n                        <div>\n                            <div\n                                className={thumb ? 'attachment__body' : 'attachment__body attachment__body--no_thumb'}\n                                onClick={this.handleFormattedTextClick}\n                            >\n                                {attachmentText}\n                                {image}\n                                {fields}\n                                {footer}\n                                {actions}\n                            </div>\n                            {thumb}\n                            <div style={style.footer}/>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nconst style = {\n    footer: {clear: 'both'},\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {doPostActionWithCookie} from 'mattermost-redux/actions/posts';\nimport {getCurrentRelativeTeamUrl} from 'mattermost-redux/selectors/entities/teams';\n\nimport MessageAttachment from './message_attachment';\n\nfunction mapStateToProps(state) {\n    return {\n        getCurrentRelativeTeamUrl: getCurrentRelativeTeamUrl(state),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            doPostActionWithCookie,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MessageAttachment);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport MessageAttachment from './message_attachment';\n\nexport default class MessageAttachmentList extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * The post id\n         */\n        postId: PropTypes.string.isRequired,\n\n        /**\n         * Array of attachments to render\n         */\n        attachments: PropTypes.array.isRequired,\n\n        /**\n         * Options specific to text formatting\n         */\n        options: PropTypes.object,\n\n        /**\n         * Images object used for creating placeholders to prevent scroll popup\n         */\n        imagesMetadata: PropTypes.object,\n    }\n\n    static defaultProps = {\n        imagesMetadata: {},\n    }\n\n    render() {\n        const content = [];\n        this.props.attachments.forEach((attachment, i) => {\n            content.push(\n                <MessageAttachment\n                    attachment={attachment}\n                    postId={this.props.postId}\n                    key={'att_' + i}\n                    options={this.props.options}\n                    imagesMetadata={this.props.imagesMetadata}\n                />\n            );\n        });\n\n        return (\n            <div\n                id={`messageAttachmentList_${this.props.postId}`}\n                className='attachment__list'\n            >\n                {content}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport function getDistanceBW2Points(point1, point2, xAttr = 'x', yAttr = 'y') {\n    return Math.sqrt(Math.pow(point1[xAttr] - point2[xAttr], 2) + Math.pow(point1[yAttr] - point2[yAttr], 2));\n}\n\n/**\n  * Funtion to return nearest point of given pivot point.\n  * It return two points one nearest and other nearest but having both coorditanes smaller than the given point's coordinates.\n  */\nexport function getNearestPoint(pivotPoint, points, xAttr = 'x', yAttr = 'y') {\n    var nearestPoint = {};\n    for (const point of points) {\n        if (typeof nearestPoint[xAttr] === 'undefined' || typeof nearestPoint[yAttr] === 'undefined') {\n            nearestPoint = point;\n        } else if (getDistanceBW2Points(point, pivotPoint, xAttr, yAttr) < getDistanceBW2Points(nearestPoint, pivotPoint, xAttr, yAttr)) {\n        // Check for bestImage\n            nearestPoint = point;\n        }\n    }\n    return nearestPoint;\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport ExternalImage from 'components/external_image';\nimport SizeAwareImage from 'components/size_aware_image';\n\nimport {PostTypes} from 'utils/constants';\nimport {useSafeUrl} from 'utils/url';\nimport {isSystemMessage} from 'utils/post_utils.jsx';\n\nimport {getNearestPoint} from './get_nearest_point';\n\nconst DIMENSIONS_NEAREST_POINT_IMAGE = {\n    height: 80,\n    width: 80,\n};\n\nexport default class PostAttachmentOpenGraph extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * The link to display the open graph data for\n         */\n        link: PropTypes.string.isRequired,\n\n        /**\n         * The ID of the current user\n         */\n        currentUserId: PropTypes.string,\n\n        /**\n         * The post where this link is included\n         */\n        post: PropTypes.object,\n\n        /**\n         * The open graph data to render\n         */\n        openGraphData: PropTypes.object,\n\n        /**\n         * Whether or not the server has link previews enabled.\n         */\n        enableLinkPreviews: PropTypes.bool.isRequired,\n\n        /**\n         * Whether or not the user has link previews enabled.\n         */\n        previewEnabled: PropTypes.bool.isRequired,\n\n        /**\n         * Whether or not the image in the OpenGraph preview has been collapsed.\n         */\n        isEmbedVisible: PropTypes.bool,\n\n        toggleEmbedVisibility: PropTypes.func.isRequired,\n\n        actions: PropTypes.shape({\n            editPost: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    getImageMetadata = (imageUrl) => {\n        if (!imageUrl) {\n            return null;\n        }\n\n        const imagesMetadata = this.props.post.metadata.images;\n        if (!imagesMetadata) {\n            return null;\n        }\n\n        return imagesMetadata[imageUrl];\n    }\n\n    isLargeImage = (dimensions) => {\n        if (!dimensions) {\n            return false;\n        }\n\n        const {height, width} = dimensions;\n\n        const largeImageMinRatio = 16 / 9;\n        const largeImageMinWidth = 150;\n\n        const imageRatio = width / height;\n\n        return width >= largeImageMinWidth && imageRatio >= largeImageMinRatio;\n    }\n\n    renderImageToggle() {\n        return (\n            <button\n                className={'style--none post__embed-visibility color--link'}\n                data-expanded={this.props.isEmbedVisible}\n                aria-label='Toggle Embed Visibility'\n                onClick={this.props.toggleEmbedVisibility}\n            />\n        );\n    }\n\n    renderLargeImage(imageUrl, imageMetadata) {\n        if (!this.props.isEmbedVisible) {\n            return null;\n        }\n\n        return (\n            <ExternalImage\n                src={imageUrl}\n                imageMetadata={imageMetadata}\n            >\n                {(safeImageUrl) => (\n                    <SizeAwareImage\n                        className='attachment__image attachment__image--opengraph large_image'\n                        src={safeImageUrl}\n                        dimensions={imageMetadata}\n                    />\n                )}\n            </ExternalImage>\n        );\n    }\n\n    renderSmallImage(imageUrl, imageMetadata) {\n        if (!this.props.isEmbedVisible) {\n            return null;\n        }\n\n        return (\n            <div className='attachment__image__container--opengraph'>\n                <ExternalImage\n                    src={imageUrl}\n                    imageMetadata={imageMetadata}\n                >\n                    {(safeImageUrl) => (\n                        <SizeAwareImage\n                            className='attachment__image attachment__image--opengraph'\n                            src={safeImageUrl}\n                            dimensions={imageMetadata}\n                        />\n                    )}\n                </ExternalImage>\n            </div>\n        );\n    }\n\n    truncateText(text) {\n        const maxLength = 300;\n        const ellipsis = '...';\n\n        if (text && text.length > maxLength) {\n            return text.substring(0, maxLength - ellipsis.length) + ellipsis;\n        }\n        return text;\n    }\n\n    handleRemovePreview = async () => {\n        const props = Object.assign({}, this.props.post.props);\n        props[PostTypes.REMOVE_LINK_PREVIEW] = 'true';\n\n        const patchedPost = ({\n            id: this.props.post.id,\n            props,\n        });\n\n        return this.props.actions.editPost(patchedPost);\n    }\n\n    hasPreviewBeenRemoved() {\n        const {post} = this.props;\n\n        if (!post || !post.props) {\n            return false;\n        }\n\n        return post.props[PostTypes.REMOVE_LINK_PREVIEW] === 'true';\n    }\n\n    render() {\n        if (!this.props.previewEnabled || !this.props.enableLinkPreviews) {\n            return null;\n        }\n\n        if (!this.props.post || isSystemMessage(this.props.post)) {\n            return null;\n        }\n\n        if (this.hasPreviewBeenRemoved()) {\n            return null;\n        }\n\n        const data = this.props.openGraphData;\n        if (!data) {\n            return null;\n        }\n\n        const imageUrl = getBestImageUrl(data, this.props.post.metadata.images);\n        const imageMetadata = this.getImageMetadata(imageUrl);\n        const hasLargeImage = this.isLargeImage(imageMetadata);\n\n        let removePreviewButton;\n        if (this.props.currentUserId === this.props.post.user_id) {\n            removePreviewButton = (\n                <button\n                    type='button'\n                    className='btn-close'\n                    aria-label='Close'\n                    onClick={this.handleRemovePreview}\n                    data-testid='removeLinkPreviewButton'\n                >\n                    <span aria-hidden='true'>{''}</span>\n                </button>\n            );\n        }\n\n        let body;\n        if (data.description || imageUrl) {\n            body = (\n                <div className={'attachment__body attachment__body--opengraph'}>\n                    <div>\n                        {this.truncateText(data.description)}\n                        {' '}\n                        {imageUrl && hasLargeImage && this.renderImageToggle()}\n                    </div>\n                    {(imageUrl && hasLargeImage) && this.renderLargeImage(imageUrl, imageMetadata)}\n                </div>\n            );\n        }\n\n        return (\n            <div className='attachment attachment--opengraph'>\n                <div className='attachment__content'>\n                    <div className={'clearfix attachment__container attachment__container--opengraph'}>\n                        <div className={'attachment__body__wrap attachment__body__wrap--opengraph'}>\n                            <span className='sitename'>{this.truncateText(data.site_name)}</span>\n                            {removePreviewButton}\n                            <h1 className={'attachment__title attachment__title--opengraph' + (data.title ? '' : ' is-url')}>\n                                <a\n                                    className='attachment__title-link attachment__title-link--opengraph'\n                                    href={useSafeUrl(data.url || this.props.link)}\n                                    target='_blank'\n                                    rel='noopener noreferrer'\n                                    title={data.title || data.url || this.props.link}\n                                >\n                                    {this.truncateText(data.title || data.url || this.props.link)}\n                                </a>\n                            </h1>\n                            {body}\n                        </div>\n                        {(imageUrl && !hasLargeImage) && this.renderSmallImage(imageUrl, imageMetadata)}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport function getBestImageUrl(openGraphData, imagesMetadata) {\n    if (!openGraphData || !openGraphData.images || openGraphData.images.length === 0) {\n        return null;\n    }\n\n    // Get the dimensions from the post metadata if they weren't provided by the website as part of the OpenGraph data\n    const images = openGraphData.images.map((image) => {\n        const imageUrl = image.secure_url || image.url;\n\n        if ((image.width && image.height) || !(imagesMetadata && imagesMetadata[imageUrl])) {\n            // The image already includes dimensions or we don't have the missing dimensions\n            return image;\n        }\n\n        return {\n            ...image,\n            height: image.height || imagesMetadata[imageUrl].height,\n            width: image.width || imagesMetadata[imageUrl].width,\n        };\n    });\n\n    const bestImage = getNearestPoint(DIMENSIONS_NEAREST_POINT_IMAGE, images, 'width', 'height');\n    return bestImage.secure_url || bestImage.url;\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getOpenGraphMetadataForUrl} from 'mattermost-redux/selectors/entities/posts';\nimport {getBool} from 'mattermost-redux/selectors/entities/preferences';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\n\nimport {editPost} from 'actions/views/posts';\n\nimport {Preferences} from 'utils/constants';\n\nimport PostAttachmentOpenGraph from './post_attachment_opengraph.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    const config = getConfig(state);\n\n    return {\n        currentUserId: getCurrentUserId(state),\n        enableLinkPreviews: config.EnableLinkPreviews === 'true',\n        openGraphData: getOpenGraphMetadataForUrl(state, ownProps.postId, ownProps.link),\n        previewEnabled: getBool(state, Preferences.CATEGORY_DISPLAY_SETTINGS, Preferences.LINK_PREVIEW_DISPLAY, true),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            editPost,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PostAttachmentOpenGraph);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport ExternalImage from 'components/external_image';\nimport SizeAwareImage from 'components/size_aware_image';\nimport ViewImageModal from 'components/view_image';\n\nexport default class PostImage extends React.PureComponent {\n    static propTypes = {\n        imageMetadata: PropTypes.object.isRequired,\n        link: PropTypes.string.isRequired,\n        post: PropTypes.object.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            showModal: false,\n        };\n    }\n\n    showModal = (e) => {\n        e.preventDefault();\n\n        this.setState({showModal: true});\n    }\n\n    hideModal = () => {\n        this.setState({showModal: false});\n    }\n\n    render() {\n        return (\n            <div className='post__embed-container'>\n                <ExternalImage\n                    src={this.props.link}\n                    imageMetadata={this.props.imageMetadata}\n                >\n                    {(safeLink) => (\n                        <React.Fragment>\n                            <SizeAwareImage\n                                className='img-div attachment__image cursor--pointer'\n                                src={safeLink}\n                                dimensions={this.props.imageMetadata}\n                                showLoader={true}\n                                onClick={this.showModal}\n                            />\n                            <ViewImageModal\n                                show={this.state.showModal}\n                                onModalDismissed={this.hideModal}\n                                post={this.props.post}\n                                startIndex={0}\n                                fileInfos={[{\n                                    has_preview_image: false,\n                                    link: safeLink,\n                                    extension: this.props.imageMetadata.format,\n                                }]}\n                            />\n                        </React.Fragment>\n                    )}\n                </ExternalImage>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PostImage from './post_image.jsx';\n\nexport default PostImage;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport const ytRegex = /(?:http|https):\\/\\/(?:www\\.|m\\.)?(?:(?:youtube\\.com\\/(?:(?:v\\/)|(?:(?:watch|embed\\/watch)(?:\\/|.*v=))|(?:embed\\/)|(?:user\\/[^/]+\\/u\\/[0-9]\\/)))|(?:youtu\\.be\\/))([^#&?]*)/;\n\nexport function handleYoutubeTime(link) {\n    const timeRegex = /[\\\\?&](t|time|start|time_continue)=([0-9]+h)?([0-9]+m)?([0-9]+s?)/;\n\n    const time = link.match(timeRegex);\n    if (!time?.[0]) {\n        return '';\n    }\n\n    const hours = time[2]?.match(/([0-9]+)h/) ?? null;\n    const minutes = time[3]?.match(/([0-9]+)m/) ?? null;\n    const seconds = time[4]?.match(/([0-9]+)s?/) ?? null;\n\n    let startSeconds = 0;\n\n    if (hours?.[1]) {\n        startSeconds += parseInt(hours[1], 10) * 3600;\n    }\n\n    if (minutes?.[1]) {\n        startSeconds += parseInt(minutes[1], 10) * 60;\n    }\n\n    if (seconds?.[1]) {\n        startSeconds += parseInt(seconds[1], 10);\n    }\n\n    return `&start=${startSeconds}`;\n}\n\nexport function getVideoId(link) {\n    const match = link.trim().match(ytRegex);\n    if (!match || match[1].length !== 11) {\n        return null;\n    }\n\n    return match[1];\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport {getVideoId, ytRegex, handleYoutubeTime} from 'utils/youtube';\n\nimport ExternalImage from 'components/external_image';\n\nexport default class YoutubeVideo extends React.PureComponent {\n    static propTypes = {\n        link: PropTypes.string.isRequired,\n        show: PropTypes.bool.isRequired,\n        metadata: PropTypes.object,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            playing: false,\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        if (!props.show && state.playing) {\n            return {playing: false};\n        }\n        return null;\n    }\n\n    play = () => {\n        this.setState({playing: true});\n    }\n\n    stop = () => {\n        this.setState({playing: false});\n    }\n\n    render() {\n        const {metadata, link} = this.props;\n\n        const videoId = getVideoId(link);\n        const time = handleYoutubeTime(link);\n\n        const header = (\n            <h4>\n                <span className='video-type'>{'YouTube - '}</span>\n                <span className='video-title'>\n                    <a\n                        href={this.props.link}\n                        target='blank'\n                        rel='noopener noreferrer'\n                    >\n                        {metadata.title}\n                    </a>\n                </span>\n            </h4>\n        );\n\n        let content;\n\n        if (this.state.playing) {\n            content = (\n                <iframe\n                    src={'https://www.youtube.com/embed/' + videoId + '?autoplay=1&autohide=1&border=0&wmode=opaque&fs=1&enablejsapi=1' + time}\n                    width='480px'\n                    height='360px'\n                    type='text/html'\n                    frameBorder='0'\n                    allowFullScreen='allowfullscreen'\n                />\n            );\n        } else {\n            const image = metadata.images[0];\n\n            content = (\n                <div className='embed-responsive video-div__placeholder'>\n                    <div className='video-thumbnail__container'>\n                        <ExternalImage src={image.secure_url || image.url}>\n                            {(safeUrl) => (\n                                <img\n                                    src={safeUrl}\n                                    alt='youtube video thumbnail'\n                                    className='video-thumbnail'\n                                />\n                            )}\n                        </ExternalImage>\n                        <div className='block'>\n                            <span className='play-button'><span/></span>\n                        </div>\n                    </div>\n                </div>\n            );\n        }\n\n        return (\n            <div\n                className='post__embed-container'\n            >\n                <div>\n                    {header}\n                    <div\n                        className='video-div embed-responsive-item'\n                        onClick={this.play}\n                    >\n                        {content}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    static isYoutubeLink(link) {\n        return link.trim().match(ytRegex);\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/channels';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getOpenGraphMetadataForUrl} from 'mattermost-redux/selectors/entities/posts';\n\nimport YoutubeVideo from './youtube_video';\n\nfunction mapStateToProps(state, ownProps) {\n    const config = getConfig(state);\n\n    return {\n        currentChannelId: getCurrentChannelId(state),\n        googleDeveloperKey: config.GoogleDeveloperKey,\n        hasImageProxy: config.HasImageProxy === 'true',\n        metadata: getOpenGraphMetadataForUrl(state, ownProps.postId, ownProps.link),\n    };\n}\n\nexport default connect(mapStateToProps)(YoutubeVideo);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport MessageAttachmentList from 'components/post_view/message_attachments/message_attachment_list';\nimport PostAttachmentOpenGraph from 'components/post_view/post_attachment_opengraph';\nimport PostImage from 'components/post_view/post_image';\nimport YoutubeVideo from 'components/youtube_video';\n\nexport default class PostBodyAdditionalContent extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * The post to render the content of\n         */\n        post: PropTypes.object.isRequired,\n\n        /**\n         * Plugin post will render embed\n         */\n        pluginPostWillRenderEmbedComponents: PropTypes.arrayOf(PropTypes.object),\n\n        /**\n         * The post's message\n         */\n        children: PropTypes.element,\n\n        /**\n         * Flag passed down to PostBodyAdditionalContent for determining if post embed is visible\n         */\n        isEmbedVisible: PropTypes.bool,\n\n        /**\n         * Options specific to text formatting\n         */\n        options: PropTypes.object,\n\n        actions: PropTypes.shape({\n            toggleEmbedVisibility: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    toggleEmbedVisibility = () => {\n        this.props.actions.toggleEmbedVisibility(this.props.post.id);\n    }\n\n    getEmbed = () => {\n        const {metadata} = this.props.post;\n        if (!metadata || !metadata.embeds || metadata.embeds.length === 0) {\n            return null;\n        }\n\n        return metadata.embeds[0];\n    }\n\n    isEmbedToggleable = (embed) => {\n        const postWillRenderEmbedComponents = this.props.pluginPostWillRenderEmbedComponents || [];\n        for (const c of postWillRenderEmbedComponents) {\n            if (c.match(embed)) {\n                return Boolean(c.toggleable);\n            }\n        }\n\n        return embed.type === 'image' || (embed.type === 'opengraph' && YoutubeVideo.isYoutubeLink(embed.url));\n    }\n\n    renderEmbed = (embed) => {\n        const postWillRenderEmbedComponents = this.props.pluginPostWillRenderEmbedComponents || [];\n        for (const c of postWillRenderEmbedComponents) {\n            if (c.match(embed)) {\n                const Component = c.component;\n                return this.props.isEmbedVisible && <Component embed={embed}/>;\n            }\n        }\n\n        switch (embed.type) {\n        case 'image':\n            if (!this.props.isEmbedVisible) {\n                return null;\n            }\n\n            return (\n                <PostImage\n                    imageMetadata={this.props.post.metadata.images[embed.url]}\n                    link={embed.url}\n                    post={this.props.post}\n                />\n            );\n\n        case 'message_attachment': {\n            let attachments = [];\n            if (this.props.post.props && this.props.post.props.attachments) {\n                attachments = this.props.post.props.attachments;\n            }\n\n            return (\n                <MessageAttachmentList\n                    attachments={attachments}\n                    postId={this.props.post.id}\n                    options={this.props.options}\n                    imagesMetadata={this.props.post.metadata.images}\n                />\n            );\n        }\n\n        case 'opengraph':\n            if (YoutubeVideo.isYoutubeLink(embed.url)) {\n                if (!this.props.isEmbedVisible) {\n                    return null;\n                }\n\n                return (\n                    <YoutubeVideo\n                        postId={this.props.post.id}\n                        link={embed.url}\n                        show={this.props.isEmbedVisible}\n                    />\n                );\n            }\n\n            return (\n                <PostAttachmentOpenGraph\n                    postId={this.props.post.id}\n                    link={embed.url}\n                    isEmbedVisible={this.props.isEmbedVisible}\n                    post={this.props.post}\n                    toggleEmbedVisibility={this.toggleEmbedVisibility}\n                />\n            );\n\n        default:\n            return null;\n        }\n    }\n\n    renderToggle = (prependToggle) => {\n        return (\n            <button\n                key='toggle'\n                className={`style--none post__embed-visibility color--link ${prependToggle ? 'pull-left' : ''}`}\n                data-expanded={this.props.isEmbedVisible}\n                aria-label='Toggle Embed Visibility'\n                onClick={this.toggleEmbedVisibility}\n            />\n        );\n    }\n\n    render() {\n        const embed = this.getEmbed();\n\n        if (embed) {\n            const toggleable = this.isEmbedToggleable(embed);\n            const prependToggle = (/^\\s*https?:\\/\\/.*$/).test(this.props.post.message);\n\n            return (\n                <div>\n                    {(toggleable && prependToggle) && this.renderToggle(true)}\n                    {this.props.children}\n                    {(toggleable && !prependToggle) && this.renderToggle(false)}\n                    {this.renderEmbed(embed)}\n                </div>\n            );\n        }\n\n        return this.props.children;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {toggleEmbedVisibility} from 'actions/post_actions';\n\nimport {isEmbedVisible} from 'selectors/posts';\n\nimport PostBodyAdditionalContent from './post_body_additional_content';\n\nfunction mapStateToProps(state, ownProps) {\n    return {\n        isEmbedVisible: isEmbedVisible(state, ownProps.post.id),\n        pluginPostWillRenderEmbedComponents: state.plugins.components.PostWillRenderEmbedComponent,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            toggleEmbedVisibility,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PostBodyAdditionalContent);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport {Posts} from 'mattermost-redux/constants';\n\nimport * as PostUtils from 'utils/post_utils';\nimport * as Utils from 'utils/utils';\n\nimport PostMarkdown from 'components/post_markdown';\nimport Pluggable from 'plugins/pluggable';\nimport ShowMore from 'components/post_view/show_more';\n\nexport default class PostMessageView extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * The post to render the message for\n         */\n        post: PropTypes.object.isRequired,\n\n        /*\n         * Set to enable Markdown formatting\n         */\n        enableFormatting: PropTypes.bool,\n\n        /*\n         * Options specific to text formatting\n         */\n        options: PropTypes.object,\n\n        /**\n         * Set to render post body compactly\n         */\n        compactDisplay: PropTypes.bool,\n\n        /**\n         * Flags if the post_message_view is for the RHS (Reply).\n         */\n        isRHS: PropTypes.bool,\n\n        /**\n         * Whether or not the RHS is visible\n         */\n        isRHSOpen: PropTypes.bool,\n\n        /**\n         * Whether or not the RHS is expanded\n         */\n        isRHSExpanded: PropTypes.bool,\n\n        /*\n         * Logged in user's theme\n         */\n        theme: PropTypes.object.isRequired,\n\n        /*\n         * Post type components from plugins\n         */\n        pluginPostTypes: PropTypes.object,\n        currentRelativeTeamUrl: PropTypes.string.isRequired,\n    };\n\n    static defaultProps = {\n        options: {},\n        isRHS: false,\n        pluginPostTypes: {},\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            collapse: true,\n            hasOverflow: false,\n            checkOverflow: 0,\n        };\n\n        this.imageProps = {\n            onImageLoaded: this.handleHeightReceived,\n        };\n    }\n\n    handleHeightReceived = (height) => {\n        if (height > 0) {\n            // Increment checkOverflow to indicate change in height\n            // and recompute textContainer height at ShowMore component\n            // and see whether overflow text of show more/less is necessary or not.\n            this.setState((prevState) => {\n                return {checkOverflow: prevState.checkOverflow + 1};\n            });\n        }\n    };\n\n    renderDeletedPost() {\n        return (\n            <p>\n                <FormattedMessage\n                    id='post_body.deleted'\n                    defaultMessage='(message deleted)'\n                />\n            </p>\n        );\n    }\n\n    renderEditedIndicator() {\n        if (!PostUtils.isEdited(this.props.post)) {\n            return null;\n        }\n\n        return (\n            <span\n                id={`postEdited_${this.props.post.id}`}\n                className='post-edited__indicator'\n            >\n                <FormattedMessage\n                    id='post_message_view.edited'\n                    defaultMessage='(edited)'\n                />\n            </span>\n        );\n    }\n\n    handleFormattedTextClick = (e) => Utils.handleFormattedTextClick(e, this.props.currentRelativeTeamUrl);\n\n    render() {\n        const {\n            post,\n            enableFormatting,\n            options,\n            pluginPostTypes,\n            compactDisplay,\n            isRHS,\n            theme,\n        } = this.props;\n\n        if (post.state === Posts.POST_DELETED) {\n            return this.renderDeletedPost();\n        }\n\n        if (!enableFormatting) {\n            return <span>{post.message}</span>;\n        }\n\n        const postType = post.props && post.props.type ? post.props.type : post.type;\n\n        if (pluginPostTypes.hasOwnProperty(postType)) {\n            const PluginComponent = pluginPostTypes[postType].component;\n            return (\n                <PluginComponent\n                    post={post}\n                    compactDisplay={compactDisplay}\n                    isRHS={isRHS}\n                    theme={theme}\n                />\n            );\n        }\n\n        let message = post.message;\n        const isEphemeral = Utils.isPostEphemeral(post);\n        if (compactDisplay && isEphemeral) {\n            const visibleMessage = Utils.localizeMessage('post_info.message.visible.compact', ' (Only visible to you)');\n            message = message.concat(visibleMessage);\n        }\n\n        const id = isRHS ? `rhsPostMessageText_${post.id}` : `postMessageText_${post.id}`;\n\n        return (\n            <ShowMore\n                checkOverflow={this.state.checkOverflow}\n                text={message}\n            >\n                <div\n                    aria-readonly='true'\n                    tabIndex='0'\n                    id={id}\n                    className='post-message__text'\n                    onClick={this.handleFormattedTextClick}\n                >\n                    <PostMarkdown\n                        message={message}\n                        imageProps={this.imageProps}\n                        isRHS={isRHS}\n                        options={options}\n                        post={post}\n                        channelId={post.channel_id}\n                    />\n                </div>\n                {this.renderEditedIndicator()}\n                <Pluggable\n                    pluggableName='PostMessageAttachment'\n                    postId={post.id}\n                    onHeightChange={this.handleHeightReceived}\n                />\n            </ShowMore>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {Preferences} from 'mattermost-redux/constants';\nimport {getTheme, getBool} from 'mattermost-redux/selectors/entities/preferences';\nimport {getCurrentRelativeTeamUrl} from 'mattermost-redux/selectors/entities/teams';\n\nimport {getIsRhsExpanded, getIsRhsOpen} from 'selectors/rhs';\n\nimport PostMessageView from './post_message_view.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        enableFormatting: getBool(state, Preferences.CATEGORY_ADVANCED_SETTINGS, 'formatting', true),\n        isRHSExpanded: getIsRhsExpanded(state),\n        isRHSOpen: getIsRhsOpen(state),\n        pluginPostTypes: state.plugins.postTypes,\n        theme: getTheme(state),\n        currentRelativeTeamUrl: getCurrentRelativeTeamUrl(state)\n    };\n}\n\nexport default connect(mapStateToProps)(PostMessageView);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Posts} from 'mattermost-redux/constants';\n\nimport PostBodyAdditionalContent from 'components/post_view/post_body_additional_content';\nimport PostMessageView from 'components/post_view/post_message_view';\n\nexport default function MessageWithAdditionalContent({post, previewCollapsed, previewEnabled, isEmbedVisible, pluginPostTypes}) {\n    const hasPlugin = post.type && pluginPostTypes.hasOwnProperty(post.type);\n    let msg;\n    const messageWrapper = (\n        <PostMessageView\n            post={post}\n            isRHS={true}\n            hasMention={true}\n        />\n    );\n    if (post.state === Posts.POST_DELETED || hasPlugin) {\n        msg = messageWrapper;\n    } else {\n        msg = (\n            <PostBodyAdditionalContent\n                post={post}\n                previewCollapsed={previewCollapsed}\n                previewEnabled={previewEnabled}\n                isEmbedVisible={isEmbedVisible}\n            >\n                {messageWrapper}\n            </PostBodyAdditionalContent>\n        );\n    }\n    return msg;\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class InfoSmallIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.info'\n                    defaultMessage='Info Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            className='svg-text-color'\n                            aria-label={ariaLabel}\n                            width='24px'\n                            height='24px'\n                            viewBox='0 0 24 24'\n                            version='1.1'\n                        >\n                            <g\n                                stroke='none'\n                                strokeWidth='1'\n                                fill='inherit'\n                                fillRule='evenodd'\n                            >\n                                <g\n                                    transform='translate(-1015.000000, -516.000000)'\n                                    fill='inherit'\n                                >\n                                    <path d='M1027,540 C1020.37258,540 1015,534.627417 1015,528 C1015,521.372583 1020.37258,516 1027,516 C1033.62742,516 1039,521.372583 1039,528 C1039,534.627417 1033.62742,540 1027,540 Z M1027,527 C1025.89543,527 1025,527.895431 1025,529 L1025,533 C1025,534.104569 1025.89543,535 1027,535 C1028.10457,535 1029,534.104569 1029,533 L1029,529 C1029,527.895431 1028.10457,527 1027,527 Z M1027,525 C1028.10457,525 1029,524.104569 1029,523 C1029,521.895431 1028.10457,521 1027,521 C1025.89543,521 1025,521.895431 1025,523 C1025,524.104569 1025.89543,525 1027,525 Z'/>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React, {PureComponent} from 'react';\n\nimport {imageURLForUser, isMobile, isGuest} from 'utils/utils.jsx';\n\nimport OverlayTrigger from 'components/overlay_trigger';\nimport ProfilePopover from 'components/profile_popover';\nimport BotBadge from 'components/widgets/badges/bot_badge';\nimport GuestBadge from 'components/widgets/badges/guest_badge';\n\nexport default class UserProfile extends PureComponent {\n    static propTypes = {\n        disablePopover: PropTypes.bool,\n        displayName: PropTypes.string,\n        hasMention: PropTypes.bool,\n        hideStatus: PropTypes.bool,\n        isBusy: PropTypes.bool,\n        isRHS: PropTypes.bool,\n        overwriteName: PropTypes.node,\n        user: PropTypes.object,\n        userId: PropTypes.string,\n    };\n\n    static defaultProps = {\n        disablePopover: false,\n        hasMention: false,\n        hideStatus: false,\n        isRHS: false,\n        overwriteImage: '',\n        overwriteName: '',\n    };\n\n    hideProfilePopover = () => {\n        if (this.overlay) {\n            this.overlay.hide();\n        }\n    }\n\n    setOverlaynRef = (ref) => {\n        this.overlay = ref;\n    }\n\n    render() {\n        const {\n            disablePopover,\n            displayName,\n            isBusy,\n            isRHS,\n            hasMention,\n            hideStatus,\n            overwriteName,\n            user,\n            userId,\n        } = this.props;\n\n        const name = overwriteName || displayName || '...';\n        if (disablePopover) {\n            return <div className='user-popover'>{name}</div>;\n        }\n\n        let placement = 'right';\n        if (isRHS && !isMobile()) {\n            placement = 'left';\n        }\n\n        let profileImg = '';\n        if (user) {\n            profileImg = imageURLForUser(user.id, user.last_picture_update);\n        }\n\n        return (\n            <React.Fragment>\n                <OverlayTrigger\n                    ref={this.setOverlaynRef}\n                    trigger='click'\n                    placement={placement}\n                    rootClose={true}\n                    overlay={\n                        <ProfilePopover\n                            className='user-profile-popover'\n                            userId={userId}\n                            src={profileImg}\n                            isBusy={isBusy}\n                            hide={this.hideProfilePopover}\n                            hideStatus={hideStatus}\n                            isRHS={isRHS}\n                            hasMention={hasMention}\n                        />\n                    }\n                >\n                    <button\n                        aria-label={name.toLowerCase()}\n                        className='user-popover style--none'\n                    >\n                        {name}\n                    </button>\n                </OverlayTrigger>\n                <BotBadge\n                    show={Boolean(user && user.is_bot)}\n                    className='badge-popoverlist'\n                />\n                <GuestBadge\n                    show={Boolean(user && isGuest(user))}\n                    className='badge-popoverlist'\n                />\n            </React.Fragment>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getUser, makeGetDisplayName} from 'mattermost-redux/selectors/entities/users';\n\nimport UserProfile from './user_profile';\n\nfunction makeMapStateToProps() {\n    const getDisplayName = makeGetDisplayName();\n\n    return (state, ownProps) => {\n        return {\n            displayName: getDisplayName(state, ownProps.userId),\n            user: getUser(state, ownProps.userId),\n        };\n    };\n}\n\nexport default connect(makeMapStateToProps)(UserProfile);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage, injectIntl} from 'react-intl';\nimport {Tooltip} from 'react-bootstrap';\nimport {Posts} from 'mattermost-redux/constants/index';\nimport {\n    isPostEphemeral,\n    isPostPendingOrFailed,\n} from 'mattermost-redux/utils/post_utils';\n\nimport Constants, {Locations, A11yCustomEventTypes} from 'utils/constants';\nimport * as PostUtils from 'utils/post_utils.jsx';\nimport {intlShape} from 'utils/react_intl';\nimport {isMobile} from 'utils/utils.jsx';\nimport DotMenu from 'components/dot_menu';\nimport FileAttachmentListContainer from 'components/file_attachment_list';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport PostProfilePicture from 'components/post_profile_picture';\nimport FailedPostOptions from 'components/post_view/failed_post_options';\nimport PostFlagIcon from 'components/post_view/post_flag_icon';\nimport PostTime from 'components/post_view/post_time';\nimport PostReaction from 'components/post_view/post_reaction';\nimport ReactionList from 'components/post_view/reaction_list';\nimport MessageWithAdditionalContent from 'components/message_with_additional_content';\nimport BotBadge from 'components/widgets/badges/bot_badge';\nimport Badge from 'components/widgets/badges/badge';\nimport InfoSmallIcon from 'components/widgets/icons/info_small_icon';\n\nimport UserProfile from 'components/user_profile';\n\nclass RhsComment extends React.PureComponent {\n    static propTypes = {\n        post: PropTypes.object,\n        teamId: PropTypes.string.isRequired,\n        currentUserId: PropTypes.string.isRequired,\n        compactDisplay: PropTypes.bool,\n        author: PropTypes.string,\n        reactions: PropTypes.object,\n        isFlagged: PropTypes.bool,\n        isBusy: PropTypes.bool,\n        removePost: PropTypes.func.isRequired,\n        previewCollapsed: PropTypes.string.isRequired,\n        previewEnabled: PropTypes.bool.isRequired,\n        isEmbedVisible: PropTypes.bool,\n        enableEmojiPicker: PropTypes.bool.isRequired,\n        enablePostUsernameOverride: PropTypes.bool.isRequired,\n        isReadOnly: PropTypes.bool.isRequired,\n        pluginPostTypes: PropTypes.object,\n        channelIsArchived: PropTypes.bool.isRequired,\n        isConsecutivePost: PropTypes.bool,\n        handleCardClick: PropTypes.func,\n        a11yIndex: PropTypes.number,\n\n        /**\n         * To Check if the current post is last in the list of RHS\n         */\n        isLastPost: PropTypes.bool,\n\n        /**\n         * To check if the state of emoji for last message and from where it was emitted\n         */\n        shortcutReactToLastPostEmittedFrom: PropTypes.string,\n        intl: intlShape.isRequired,\n        actions: PropTypes.shape({\n            markPostAsUnread: PropTypes.func.isRequired,\n\n            /**\n             * Function to set or unset emoji picker for last message\n             */\n            emitShortcutReactToLastPostFrom: PropTypes.func\n        }),\n        emojiMap: PropTypes.object.isRequired,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.postRef = React.createRef();\n\n        this.state = {\n            showEmojiPicker: false,\n            dropdownOpened: false,\n            alt: false,\n            hover: false,\n            a11yActive: false,\n            currentAriaLabel: '',\n        };\n\n        this.postHeaderRef = React.createRef();\n    }\n\n    componentDidMount() {\n        document.addEventListener('keydown', this.handleAlt);\n        document.addEventListener('keyup', this.handleAlt);\n\n        if (this.postRef.current) {\n            this.postRef.current.addEventListener(A11yCustomEventTypes.ACTIVATE, this.handleA11yActivateEvent);\n            this.postRef.current.addEventListener(A11yCustomEventTypes.DEACTIVATE, this.handleA11yDeactivateEvent);\n        }\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleAlt);\n        document.removeEventListener('keyup', this.handleAlt);\n\n        if (this.postRef.current) {\n            this.postRef.current.removeEventListener(A11yCustomEventTypes.ACTIVATE, this.handleA11yActivateEvent);\n            this.postRef.current.removeEventListener(A11yCustomEventTypes.DEACTIVATE, this.handleA11yDeactivateEvent);\n        }\n    }\n\n    componentDidUpdate(prevProps) {\n        const {shortcutReactToLastPostEmittedFrom, isLastPost} = this.props;\n\n        if (this.state.a11yActive) {\n            this.postRef.current.dispatchEvent(new Event(A11yCustomEventTypes.UPDATE));\n        }\n\n        const shortcutReactToLastPostEmittedFromRHS = prevProps.shortcutReactToLastPostEmittedFrom !== shortcutReactToLastPostEmittedFrom &&\n        shortcutReactToLastPostEmittedFrom === Locations.RHS_ROOT;\n        if (shortcutReactToLastPostEmittedFromRHS) {\n            // Opening the emoji picker when more than one post in rhs is present\n            this.handleShortcutReactToLastPost(isLastPost);\n        }\n    }\n\n    handleShortcutReactToLastPost = (isLastPost) => {\n        if (isLastPost) {\n            const {isReadOnly, channelIsArchived, enableEmojiPicker, post,\n                actions: {emitShortcutReactToLastPostFrom}} = this.props;\n\n            // Setting the last message emoji action to empty to clean up the redux state\n            emitShortcutReactToLastPostFrom(Locations.NO_WHERE);\n\n            // Following are the types of posts on which adding reaction is not possible\n            const isDeletedPost = post && post.state === Posts.POST_DELETED;\n            const isEphemeralPost = post && isPostEphemeral(post);\n            const isSystemMessage = post && PostUtils.isSystemMessage(post);\n            const isAutoRespondersPost = post && PostUtils.fromAutoResponder(post);\n            const isFailedPost = post && post.failed;\n\n            // Checking if rhs comment is in scroll view of the user\n            const boundingRectOfPostInfo = this.postHeaderRef.current.getBoundingClientRect();\n            const isPostHeaderVisibleToUser = (boundingRectOfPostInfo.top - 110) > 0 &&\n                boundingRectOfPostInfo.bottom < (window.innerHeight);\n\n            if (isPostHeaderVisibleToUser && !isEphemeralPost && !isSystemMessage && !isReadOnly && !isFailedPost &&\n                !isAutoRespondersPost && !isDeletedPost && !channelIsArchived && !isMobile() && enableEmojiPicker) {\n                this.setState({hover: true}, () => {\n                    this.toggleEmojiPicker();\n                });\n            }\n        }\n    }\n\n    removePost = () => {\n        this.props.removePost(this.props.post);\n    };\n\n    createRemovePostButton = () => {\n        return (\n            <button\n                className='post__remove theme color--link style--none'\n                type='button'\n                onClick={this.removePost}\n            >\n                {''}\n            </button>\n        );\n    };\n\n    renderPostTime = () => {\n        const post = this.props.post;\n\n        const isPermalink = !(Posts.POST_DELETED === post.state || isPostPendingOrFailed(post));\n\n        return (\n            <PostTime\n                isPermalink={isPermalink}\n                eventTime={post.create_at}\n                postId={post.id}\n                location={Locations.RHS_COMMENT}\n            />\n        );\n    };\n\n    toggleEmojiPicker = () => {\n        const showEmojiPicker = !this.state.showEmojiPicker;\n\n        this.setState({\n            showEmojiPicker,\n        });\n    };\n\n    getClassName = (post, isSystemMessage) => {\n        let className = 'post post--thread same--root post--comment';\n\n        if (this.props.currentUserId === post.user_id) {\n            className += ' current--user';\n        }\n\n        if (isSystemMessage) {\n            className += ' post--system';\n        }\n\n        if (this.props.compactDisplay) {\n            className += ' post--compact';\n        }\n\n        if (post.is_pinned) {\n            className += ' post--pinned';\n        }\n\n        if (this.state.dropdownOpened || this.state.showEmojiPicker) {\n            className += ' post--hovered';\n        }\n\n        if (this.props.isConsecutivePost) {\n            className += ' same--user';\n        }\n\n        if (this.state.alt && !this.props.channelIsArchived) {\n            className += ' cursor--pointer';\n        }\n\n        return className;\n    };\n\n    handleAlt = (e) => {\n        if (this.state.alt !== e.altKey) {\n            this.setState({alt: e.altKey});\n        }\n    }\n\n    handleDropdownOpened = (isOpened) => {\n        this.setState({\n            dropdownOpened: isOpened,\n        });\n    };\n\n    getDotMenuRef = () => {\n        return this.refs.dotMenu;\n    };\n\n    setHover = () => {\n        this.setState({hover: true});\n    }\n\n    unsetHover = () => {\n        this.setState({hover: false});\n    }\n\n    handleA11yActivateEvent = () => {\n        this.setState({a11yActive: true});\n    }\n\n    handleA11yDeactivateEvent = () => {\n        this.setState({a11yActive: false});\n    }\n\n    handlePostClick = (e) => {\n        if (this.props.channelIsArchived) {\n            return;\n        }\n\n        if (e.altKey) {\n            this.props.actions.markPostAsUnread(this.props.post);\n        }\n    }\n\n    handlePostFocus = () => {\n        const {post, author, reactions, isFlagged, intl, emojiMap} = this.props;\n        this.setState({currentAriaLabel: PostUtils.createAriaLabelForPost(post, author, isFlagged, reactions, intl, emojiMap)});\n    }\n\n    render() {\n        const {post, isConsecutivePost, isReadOnly, channelIsArchived} = this.props;\n\n        const isPostDeleted = post && post.state === Posts.POST_DELETED;\n        const isEphemeral = isPostEphemeral(post);\n        const isSystemMessage = PostUtils.isSystemMessage(post);\n        const fromAutoResponder = PostUtils.fromAutoResponder(post);\n\n        let botIndicator;\n        let profilePicture;\n        let visibleMessage;\n\n        let userProfile = null;\n        if (this.props.compactDisplay || isMobile()) {\n            userProfile = (\n                <UserProfile\n                    userId={post.user_id}\n                    isBusy={this.props.isBusy}\n                    isRHS={true}\n                    hasMention={true}\n                />\n            );\n        }\n\n        if (!isConsecutivePost) {\n            userProfile = (\n                <UserProfile\n                    userId={post.user_id}\n                    isBusy={this.props.isBusy}\n                    isRHS={true}\n                    hasMention={true}\n                />\n            );\n\n            profilePicture = (\n                <PostProfilePicture\n                    compactDisplay={this.props.compactDisplay}\n                    isBusy={this.props.isBusy}\n                    isRHS={true}\n                    post={post}\n                    userId={post.user_id}\n                />\n            );\n\n            if (post.props && post.props.from_webhook) {\n                if (post.props.override_username && this.props.enablePostUsernameOverride) {\n                    userProfile = (\n                        <UserProfile\n                            userId={post.user_id}\n                            hideStatus={true}\n                            overwriteName={post.props.override_username}\n                            disablePopover={true}\n                        />\n                    );\n                } else {\n                    userProfile = (\n                        <UserProfile\n                            userId={post.user_id}\n                            hideStatus={true}\n                            disablePopover={true}\n                        />\n                    );\n                }\n\n                botIndicator = (<BotBadge className='col col__name'/>);\n            } else if (fromAutoResponder) {\n                userProfile = (\n                    <span className='auto-responder'>\n                        <UserProfile\n                            userId={post.user_id}\n                            hideStatus={true}\n                            isBusy={this.props.isBusy}\n                            isRHS={true}\n                            hasMention={true}\n                        />\n                    </span>\n                );\n                botIndicator = (\n                    <Badge className='col col__name'>\n                        <FormattedMessage\n                            id='post_info.auto_responder'\n                            defaultMessage='AUTOMATIC REPLY'\n                        />\n                    </Badge>\n                );\n            } else if (isSystemMessage) {\n                userProfile = (\n                    <UserProfile\n                        overwriteName={\n                            <FormattedMessage\n                                id='post_info.system'\n                                defaultMessage='System'\n                            />\n                        }\n                        overwriteImage={Constants.SYSTEM_MESSAGE_PROFILE_IMAGE}\n                        disablePopover={true}\n                    />\n                );\n\n                visibleMessage = (\n                    <span className='post__visibility'>\n                        <FormattedMessage\n                            id='post_info.message.visible'\n                            defaultMessage='(Only visible to you)'\n                        />\n                    </span>\n                );\n            }\n        }\n\n        let failedPostOptions;\n        let postClass = '';\n\n        if (post.failed) {\n            postClass += ' post-failed';\n            failedPostOptions = <FailedPostOptions post={this.props.post}/>;\n        }\n\n        if (PostUtils.isEdited(this.props.post)) {\n            postClass += ' post--edited';\n        }\n\n        let fileAttachment = null;\n        if (post.file_ids && post.file_ids.length > 0) {\n            fileAttachment = (\n                <FileAttachmentListContainer\n                    post={post}\n                    compactDisplay={this.props.compactDisplay}\n                />\n            );\n        }\n\n        let postReaction;\n        if (!isReadOnly && !isEphemeral && !post.failed && !isSystemMessage && this.props.enableEmojiPicker && !channelIsArchived) {\n            postReaction = (\n                <PostReaction\n                    channelId={post.channel_id}\n                    postId={post.id}\n                    teamId={this.props.teamId}\n                    getDotMenuRef={this.getDotMenuRef}\n                    location={Locations.RHS_COMMENT}\n                    showEmojiPicker={this.state.showEmojiPicker}\n                    toggleEmojiPicker={this.toggleEmojiPicker}\n                />\n            );\n        }\n\n        let options;\n        if (isEphemeral) {\n            options = (\n                <div className='col col__remove'>\n                    {this.createRemovePostButton()}\n                </div>\n            );\n        } else if (isPostDeleted) {\n            options = null;\n        } else if (!isSystemMessage && (isMobile() || this.state.hover || this.state.a11yActive || this.state.dropdownOpened || this.state.showEmojiPicker)) {\n            const dotMenu = (\n                <DotMenu\n                    post={this.props.post}\n                    location={Locations.RHS_COMMENT}\n                    isFlagged={this.props.isFlagged}\n                    handleDropdownOpened={this.handleDropdownOpened}\n                    handleAddReactionClick={this.toggleEmojiPicker}\n                    isReadOnly={isReadOnly || channelIsArchived}\n                    enableEmojiPicker={this.props.enableEmojiPicker}\n                />\n            );\n\n            options = (\n                <div\n                    ref='dotMenu'\n                    className='col col__reply'\n                >\n                    {dotMenu}\n                    {postReaction}\n                </div>\n            );\n        }\n\n        let pinnedBadge;\n        if (post.is_pinned) {\n            pinnedBadge = (\n                <span className='post__pinned-badge'>\n                    <FormattedMessage\n                        id='post_info.pinned'\n                        defaultMessage='Pinned'\n                    />\n                </span>\n            );\n        }\n\n        let flagIcon = null;\n        if (this.state.hover || this.state.a11yActive || this.state.dropdownOpened || this.state.showEmojiPicker || this.props.isFlagged) {\n            flagIcon = (\n                <PostFlagIcon\n                    location={Locations.RHS_COMMENT}\n                    postId={post.id}\n                    isFlagged={this.props.isFlagged}\n                    isEphemeral={isEphemeral}\n                />\n            );\n        }\n        const postTime = this.renderPostTime();\n\n        let postInfoIcon;\n        if (post.props && post.props.card) {\n            postInfoIcon = (\n                <OverlayTrigger\n                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                    placement='top'\n                    overlay={\n                        <Tooltip>\n                            <FormattedMessage\n                                id='post_info.info.view_additional_info'\n                                defaultMessage='View additional info'\n                            />\n                        </Tooltip>\n                    }\n                >\n                    <button\n                        className='card-icon__container icon--show style--none'\n                        onClick={(e) => {\n                            e.preventDefault();\n                            this.props.handleCardClick(this.props.post);\n                        }}\n                    >\n                        <InfoSmallIcon\n                            className='icon icon__info'\n                            aria-hidden='true'\n                        />\n                    </button>\n                </OverlayTrigger>\n            );\n        }\n\n        return (\n            <div\n                role='listitem'\n                ref={this.postRef}\n                id={'rhsPost_' + post.id}\n                tabIndex='-1'\n                className={`a11y__section ${this.getClassName(post, isSystemMessage)}`}\n                onClick={this.handlePostClick}\n                onMouseOver={this.setHover}\n                onMouseLeave={this.unsetHover}\n                aria-label={this.state.currentAriaLabel}\n                onFocus={this.handlePostFocus}\n                data-a11y-sort-order={this.props.a11yIndex}\n            >\n                <div\n                    role='application'\n                    className='post__content'\n                >\n                    <div className='post__img'>\n                        {profilePicture}\n                    </div>\n                    <div>\n                        <div\n                            className='post__header'\n                            ref={this.postHeaderRef}\n                        >\n                            <div className='col col__name'>\n                                {userProfile}\n                                {botIndicator}\n                            </div>\n                            <div className='col'>\n                                {postTime}\n                                {pinnedBadge}\n                                {postInfoIcon}\n                                {flagIcon}\n                                {visibleMessage}\n                            </div>\n                            {options}\n                        </div>\n                        <div className='post__body' >\n                            <div className={postClass}>\n                                {failedPostOptions}\n                                <MessageWithAdditionalContent\n                                    post={post}\n                                    previewCollapsed={this.props.previewCollapsed}\n                                    previewEnabled={this.props.previewEnabled}\n                                    isEmbedVisible={this.props.isEmbedVisible}\n                                    pluginPostTypes={this.props.pluginPostTypes}\n                                />\n                            </div>\n                            {fileAttachment}\n                            <ReactionList\n                                post={post}\n                                isReadOnly={isReadOnly || channelIsArchived}\n                            />\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default injectIntl(RhsComment);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {Posts} from 'mattermost-redux/constants';\nimport {isChannelReadOnlyById} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {makeGetReactionsForPost, getPost} from 'mattermost-redux/selectors/entities/posts';\nimport {makeGetDisplayName} from 'mattermost-redux/selectors/entities/users';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {get} from 'mattermost-redux/selectors/entities/preferences';\nimport {isSystemMessage} from 'mattermost-redux/utils/post_utils';\n\nimport {markPostAsUnread, emitShortcutReactToLastPostFrom} from 'actions/post_actions.jsx';\nimport {isEmbedVisible} from 'selectors/posts';\nimport {getEmojiMap} from 'selectors/emojis';\n\nimport {isArchivedChannel} from 'utils/channel_utils';\nimport {Preferences} from 'utils/constants';\n\nimport {getShortcutReactToLastPostEmittedFrom} from 'selectors/emojis.js';\n\nimport RhsComment from './rhs_comment.jsx';\n\nfunction isConsecutivePost(state, ownProps) {\n    const post = ownProps.post;\n    const previousPost = ownProps.previousPostId && getPost(state, ownProps.previousPostId);\n\n    let consecutivePost = false;\n\n    if (previousPost) {\n        const postFromWebhook = Boolean(post.props && post.props.from_webhook);\n        const prevPostFromWebhook = Boolean(previousPost.props && previousPost.props.from_webhook);\n        if (previousPost && previousPost.user_id === post.user_id &&\n            post.create_at - previousPost.create_at <= Posts.POST_COLLAPSE_TIMEOUT &&\n            !postFromWebhook && !prevPostFromWebhook &&\n            !isSystemMessage(post) && !isSystemMessage(previousPost) &&\n            (previousPost.root_id === post.root_id || previousPost.id === post.root_id)) {\n            // The last post and this post were made by the same user within some time\n            consecutivePost = true;\n        }\n    }\n    return consecutivePost;\n}\n\nfunction mapStateToProps(state, ownProps) {\n    const getReactionsForPost = makeGetReactionsForPost();\n    const getDisplayName = makeGetDisplayName();\n    const emojiMap = getEmojiMap(state);\n\n    const config = getConfig(state);\n    const enableEmojiPicker = config.EnableEmojiPicker === 'true';\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\n    const teamId = ownProps.teamId || getCurrentTeamId(state);\n    const channel = state.entities.channels.channels[ownProps.post.channel_id];\n    const shortcutReactToLastPostEmittedFrom = getShortcutReactToLastPostEmittedFrom(state);\n\n    return {\n        author: getDisplayName(state, ownProps.post.user_id),\n        reactions: getReactionsForPost(state, ownProps.post.id),\n        enableEmojiPicker,\n        enablePostUsernameOverride,\n        isEmbedVisible: isEmbedVisible(state, ownProps.post.id),\n        isReadOnly: isChannelReadOnlyById(state, ownProps.post.channel_id),\n        teamId,\n        pluginPostTypes: state.plugins.postTypes,\n        channelIsArchived: isArchivedChannel(channel),\n        isConsecutivePost: isConsecutivePost(state, ownProps),\n        isFlagged: get(state, Preferences.CATEGORY_FLAGGED_POST, ownProps.post.id, null) != null,\n        compactDisplay: get(state, Preferences.CATEGORY_DISPLAY_SETTINGS, Preferences.MESSAGE_DISPLAY, Preferences.MESSAGE_DISPLAY_DEFAULT) === Preferences.MESSAGE_DISPLAY_COMPACT,\n        shortcutReactToLastPostEmittedFrom,\n        emojiMap,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            markPostAsUnread,\n            emitShortcutReactToLastPostFrom\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(RhsComment);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport OverlayTrigger from 'components/overlay_trigger';\n\nimport Constants, {RHSStates} from 'utils/constants';\n\nexport default class RhsHeaderPost extends React.Component {\n    static propTypes = {\n        previousRhsState: PropTypes.oneOf(\n            Object.values(RHSStates)\n        ),\n        actions: PropTypes.shape({\n            showMentions: PropTypes.func,\n            showSearchResults: PropTypes.func,\n            showFlaggedPosts: PropTypes.func,\n            showPinnedPosts: PropTypes.func,\n            closeRightHandSide: PropTypes.func,\n            toggleRhsExpanded: PropTypes.func,\n        }),\n    };\n\n    handleBack = (e) => {\n        e.preventDefault();\n\n        switch (this.props.previousRhsState) {\n        case RHSStates.SEARCH:\n            this.props.actions.showSearchResults();\n            break;\n        case RHSStates.MENTION:\n            this.props.actions.showMentions();\n            break;\n        case RHSStates.FLAG:\n            this.props.actions.showFlaggedPosts();\n            break;\n        case RHSStates.PIN:\n            this.props.actions.showPinnedPosts();\n            break;\n        default:\n            break;\n        }\n    }\n\n    render() {\n        let back;\n        const closeSidebarTooltip = (\n            <Tooltip id='closeSidebarTooltip'>\n                <FormattedMessage\n                    id='rhs_header.closeSidebarTooltip'\n                    defaultMessage='Close Sidebar'\n                />\n            </Tooltip>\n        );\n\n        let backToResultsTooltip;\n\n        switch (this.props.previousRhsState) {\n        case RHSStates.SEARCH:\n        case RHSStates.MENTION:\n            backToResultsTooltip = (\n                <Tooltip id='backToResultsTooltip'>\n                    <FormattedMessage\n                        id='rhs_header.backToResultsTooltip'\n                        defaultMessage='Back to search results'\n                    />\n                </Tooltip>\n            );\n            break;\n        case RHSStates.FLAG:\n            backToResultsTooltip = (\n                <Tooltip id='backToResultsTooltip'>\n                    <FormattedMessage\n                        id='rhs_header.backToFlaggedTooltip'\n                        defaultMessage='Back to flagged posts'\n                    />\n                </Tooltip>\n            );\n            break;\n        case RHSStates.PIN:\n            backToResultsTooltip = (\n                <Tooltip id='backToResultsTooltip'>\n                    <FormattedMessage\n                        id='rhs_header.backToPinnedTooltip'\n                        defaultMessage='Back to pinned posts'\n                    />\n                </Tooltip>\n            );\n            break;\n        }\n\n        const expandSidebarTooltip = (\n            <Tooltip id='expandSidebarTooltip'>\n                <FormattedMessage\n                    id='rhs_header.expandSidebarTooltip'\n                    defaultMessage='Expand Sidebar'\n                />\n            </Tooltip>\n        );\n\n        const shrinkSidebarTooltip = (\n            <Tooltip id='shrinkSidebarTooltip'>\n                <FormattedMessage\n                    id='rhs_header.shrinkSidebarTooltip'\n                    defaultMessage='Shrink Sidebar'\n                />\n            </Tooltip>\n        );\n\n        if (backToResultsTooltip) {\n            back = (\n                <a\n                    href='#'\n                    onClick={this.handleBack}\n                    className='sidebar--right__back'\n                >\n                    <OverlayTrigger\n                        delayShow={Constants.OVERLAY_TIME_DELAY}\n                        placement='top'\n                        overlay={backToResultsTooltip}\n                    >\n                        <FormattedMessage\n                            id='generic_icons.back'\n                            defaultMessage='Back Icon'\n                        >\n                            {(ariaLabel) => (\n                                <i\n                                    className='fa fa-angle-left'\n                                    aria-label={ariaLabel}\n                                />\n                            )}\n                        </FormattedMessage>\n                    </OverlayTrigger>\n                </a>\n            );\n        }\n\n        return (\n            <div className='sidebar--right__header'>\n                <span className='sidebar--right__title'>\n                    {back}\n                    <FormattedMessage\n                        id='rhs_header.details'\n                        defaultMessage='Message Details'\n                    />\n                </span>\n                <div className='pull-right'>\n                    <button\n                        type='button'\n                        className='sidebar--right__expand'\n                        aria-label='Expand'\n                        onClick={this.props.actions.toggleRhsExpanded}\n                    >\n                        <OverlayTrigger\n                            delayShow={Constants.OVERLAY_TIME_DELAY}\n                            placement='top'\n                            overlay={expandSidebarTooltip}\n                        >\n                            <FormattedMessage\n                                id='rhs_header.expandSidebarTooltip.icon'\n                                defaultMessage='Expand Sidebar Icon'\n                            >\n                                {(ariaLabel) => (\n                                    <i\n                                        className='fa fa-expand'\n                                        aria-label={ariaLabel}\n                                    />\n                                )}\n                            </FormattedMessage>\n                        </OverlayTrigger>\n                        <OverlayTrigger\n                            delayShow={Constants.OVERLAY_TIME_DELAY}\n                            placement='top'\n                            overlay={shrinkSidebarTooltip}\n                        >\n                            <FormattedMessage\n                                id='rhs_header.expandTooltip.icon'\n                                defaultMessage='Shrink Sidebar Icon'\n                            >\n                                {(ariaLabel) => (\n                                    <i\n                                        className='fa fa-compress'\n                                        aria-label={ariaLabel}\n                                    />\n                                )}\n                            </FormattedMessage>\n                        </OverlayTrigger>\n                    </button>\n                    <button\n                        id='rhsCloseButton'\n                        type='button'\n                        className='sidebar--right__close'\n                        aria-label='Close'\n                        onClick={this.props.actions.closeRightHandSide}\n                    >\n\n                        <OverlayTrigger\n                            delayShow={Constants.OVERLAY_TIME_DELAY}\n                            placement='top'\n                            overlay={closeSidebarTooltip}\n                        >\n                            <FormattedMessage\n                                id='rhs_header.closeTooltip.icon'\n                                defaultMessage='Close Sidebar Icon'\n                            >\n                                {(ariaLabel) => (\n                                    <i\n                                        className='fa fa-sign-out'\n                                        aria-label={ariaLabel}\n                                    />\n                                )}\n                            </FormattedMessage>\n                        </OverlayTrigger>\n                    </button>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {\n    showMentions,\n    showSearchResults,\n    showFlaggedPosts,\n    showPinnedPosts,\n    closeRightHandSide,\n    toggleRhsExpanded,\n} from 'actions/views/rhs';\n\nimport RhsHeaderPost from './rhs_header_post.jsx';\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            showSearchResults,\n            showMentions,\n            showFlaggedPosts,\n            showPinnedPosts,\n            closeRightHandSide,\n            toggleRhsExpanded,\n        }, dispatch),\n    };\n}\n\nexport default connect(null, mapDispatchToProps)(RhsHeaderPost);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage, injectIntl} from 'react-intl';\nimport {Tooltip} from 'react-bootstrap';\nimport {Posts} from 'mattermost-redux/constants';\nimport * as ReduxPostUtils from 'mattermost-redux/utils/post_utils';\n\nimport Constants, {Locations} from 'utils/constants';\nimport * as PostUtils from 'utils/post_utils.jsx';\nimport {intlShape} from 'utils/react_intl';\nimport * as Utils from 'utils/utils.jsx';\nimport DotMenu from 'components/dot_menu';\nimport FileAttachmentListContainer from 'components/file_attachment_list';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport PostProfilePicture from 'components/post_profile_picture';\nimport PostFlagIcon from 'components/post_view/post_flag_icon';\nimport ReactionList from 'components/post_view/reaction_list';\nimport PostTime from 'components/post_view/post_time';\nimport PostReaction from 'components/post_view/post_reaction';\nimport MessageWithAdditionalContent from 'components/message_with_additional_content';\nimport BotBadge from 'components/widgets/badges/bot_badge';\nimport InfoSmallIcon from 'components/widgets/icons/info_small_icon';\n\nimport UserProfile from 'components/user_profile';\n\nclass RhsRootPost extends React.PureComponent {\n    static propTypes = {\n        post: PropTypes.object.isRequired,\n        teamId: PropTypes.string.isRequired,\n        currentUserId: PropTypes.string.isRequired,\n        compactDisplay: PropTypes.bool,\n        commentCount: PropTypes.number.isRequired,\n        author: PropTypes.string,\n        reactions: PropTypes.object,\n        isFlagged: PropTypes.bool,\n        previewCollapsed: PropTypes.string,\n        previewEnabled: PropTypes.bool,\n        isBusy: PropTypes.bool,\n        isEmbedVisible: PropTypes.bool,\n        enableEmojiPicker: PropTypes.bool.isRequired,\n        enablePostUsernameOverride: PropTypes.bool.isRequired,\n        isReadOnly: PropTypes.bool.isRequired,\n        pluginPostTypes: PropTypes.object,\n        channelIsArchived: PropTypes.bool.isRequired,\n        channelType: PropTypes.string,\n        channelDisplayName: PropTypes.string,\n        handleCardClick: PropTypes.func.isRequired,\n\n        /**\n         * To Check if the current post is last in the list of RHS\n         */\n        isLastPost: PropTypes.bool,\n\n        /**\n         * To check if the state of emoji for last message and from where it was emitted\n         */\n        shortcutReactToLastPostEmittedFrom: PropTypes.string,\n        intl: intlShape.isRequired,\n        actions: PropTypes.shape({\n            markPostAsUnread: PropTypes.func.isRequired,\n\n            /**\n             * Function to set or unset emoji picker for last message\n             */\n            emitShortcutReactToLastPostFrom: PropTypes.func\n        }),\n        emojiMap: PropTypes.object.isRequired,\n    };\n\n    static defaultProps = {\n        commentCount: 0,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            alt: false,\n            showEmojiPicker: false,\n            testStateObj: true,\n            dropdownOpened: false,\n            currentAriaLabel: '',\n        };\n\n        this.postHeaderRef = React.createRef();\n    }\n\n    handleShortcutReactToLastPost = (isLastPost) => {\n        if (isLastPost) {\n            const {post, enableEmojiPicker, channelIsArchived,\n                actions: {emitShortcutReactToLastPostFrom}} = this.props;\n\n            // Setting the last message emoji action to empty to clean up the redux state\n            emitShortcutReactToLastPostFrom(Locations.NO_WHERE);\n\n            // Following are the types of posts on which adding reaction is not possible\n            const isDeletedPost = post && post.state === Posts.POST_DELETED;\n            const isEphemeralPost = post && Utils.isPostEphemeral(post);\n            const isSystemMessage = post && PostUtils.isSystemMessage(post);\n            const isFailedPost = post && post.failed;\n            const isPostsFakeParentDeleted = post && post.type === Constants.PostTypes.FAKE_PARENT_DELETED;\n\n            // Checking if rhs root comment is at scroll view of the user\n            const boundingRectOfPostInfo = this.postHeaderRef.current.getBoundingClientRect();\n            const isPostHeaderVisibleToUser = (boundingRectOfPostInfo.top - 110) > 0 &&\n                boundingRectOfPostInfo.bottom < (window.innerHeight);\n\n            if (isPostHeaderVisibleToUser) {\n                if (!isEphemeralPost && !isSystemMessage && !isDeletedPost && !isFailedPost && !Utils.isMobile() &&\n                    !channelIsArchived && !isPostsFakeParentDeleted && enableEmojiPicker) {\n                    // As per issue in #2 of mattermost-webapp/pull/4478#pullrequestreview-339313236\n                    // We are not not handling focus condition as we did for rhs_comment as the dot menu is already in dom and not visible\n                    this.toggleEmojiPicker(isLastPost);\n                }\n            }\n        }\n    }\n\n    componentDidMount() {\n        document.addEventListener('keydown', this.handleAlt);\n        document.addEventListener('keyup', this.handleAlt);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleAlt);\n        document.removeEventListener('keyup', this.handleAlt);\n    }\n\n    componentDidUpdate(prevProps) {\n        const {shortcutReactToLastPostEmittedFrom, isLastPost} = this.props;\n\n        const shortcutReactToLastPostEmittedFromRHS = prevProps.shortcutReactToLastPostEmittedFrom !== shortcutReactToLastPostEmittedFrom &&\n        shortcutReactToLastPostEmittedFrom === Locations.RHS_ROOT;\n        if (shortcutReactToLastPostEmittedFromRHS) {\n            this.handleShortcutReactToLastPost(isLastPost);\n        }\n    }\n\n    renderPostTime = (isEphemeral) => {\n        const post = this.props.post;\n\n        if (post.type === Constants.PostTypes.FAKE_PARENT_DELETED) {\n            return null;\n        }\n\n        const isPermalink = !(isEphemeral ||\n            Posts.POST_DELETED === post.state ||\n            ReduxPostUtils.isPostPendingOrFailed(post));\n\n        return (\n            <PostTime\n                isPermalink={isPermalink}\n                eventTime={post.create_at}\n                postId={post.id}\n                location={Locations.RHS_ROOT}\n            />\n        );\n    };\n\n    toggleEmojiPicker = () => {\n        const showEmojiPicker = !this.state.showEmojiPicker;\n\n        this.setState({\n            showEmojiPicker,\n        });\n    };\n\n    getClassName = (post, isSystemMessage) => {\n        let className = 'post post--root post--thread';\n        if (this.props.currentUserId === post.user_id) {\n            className += ' current--user';\n        }\n\n        if (isSystemMessage) {\n            className += ' post--system';\n        }\n\n        if (this.props.compactDisplay) {\n            className += ' post--compact';\n        }\n\n        if (post.is_pinned) {\n            className += ' post--pinned';\n        }\n\n        if (this.state.dropdownOpened || this.state.showEmojiPicker) {\n            className += ' post--hovered';\n        }\n\n        if (this.state.alt && !this.props.channelIsArchived) {\n            className += ' cursor--pointer';\n        }\n\n        return className;\n    };\n\n    handleAlt = (e) => {\n        if (this.state.alt !== e.altKey) {\n            this.setState({alt: e.altKey});\n        }\n    }\n\n    handleDropdownOpened = (isOpened) => {\n        this.setState({\n            dropdownOpened: isOpened,\n        });\n    };\n\n    handlePostClick = (e) => {\n        if (this.props.channelIsArchived) {\n            return;\n        }\n\n        if (e.altKey) {\n            this.props.actions.markPostAsUnread(this.props.post);\n        }\n    }\n\n    handlePostFocus = () => {\n        const {post, author, reactions, isFlagged, emojiMap} = this.props;\n        this.setState({currentAriaLabel: PostUtils.createAriaLabelForPost(post, author, isFlagged, reactions, this.props.intl, emojiMap)});\n    }\n\n    getDotMenuRef = () => {\n        return this.refs.dotMenu;\n    };\n\n    render() {\n        const {post, isReadOnly, teamId, channelIsArchived, channelType, channelDisplayName} = this.props;\n\n        const isPostDeleted = post && post.state === Posts.POST_DELETED;\n        const isEphemeral = Utils.isPostEphemeral(post);\n        const isSystemMessage = PostUtils.isSystemMessage(post);\n\n        let channelName;\n        if (channelType === 'D') {\n            channelName = (\n                <FormattedMessage\n                    id='rhs_root.direct'\n                    defaultMessage='Direct Message'\n                />\n            );\n        } else {\n            channelName = channelDisplayName;\n        }\n\n        let postReaction;\n        if (!isReadOnly && !isEphemeral && !post.failed && !isSystemMessage && this.props.enableEmojiPicker && !channelIsArchived) {\n            postReaction = (\n                <PostReaction\n                    channelId={post.channel_id}\n                    postId={post.id}\n                    teamId={teamId}\n                    getDotMenuRef={this.getDotMenuRef}\n                    location={Locations.RHS_ROOT}\n                    showEmojiPicker={this.state.showEmojiPicker}\n                    toggleEmojiPicker={this.toggleEmojiPicker}\n                />\n            );\n        }\n\n        let fileAttachment = null;\n        if (post.file_ids && post.file_ids.length > 0) {\n            fileAttachment = (\n                <FileAttachmentListContainer\n                    post={post}\n                    compactDisplay={this.props.compactDisplay}\n                />\n            );\n        }\n\n        let userProfile;\n        let botIndicator;\n        if (isSystemMessage) {\n            userProfile = (\n                <UserProfile\n                    overwriteName={\n                        <FormattedMessage\n                            id='post_info.system'\n                            defaultMessage='System'\n                        />\n                    }\n                    overwriteImage={Constants.SYSTEM_MESSAGE_PROFILE_IMAGE}\n                    disablePopover={true}\n                />\n            );\n        } else if (post.props && post.props.from_webhook) {\n            if (post.props.override_username && this.props.enablePostUsernameOverride) {\n                userProfile = (\n                    <UserProfile\n                        key={post.user_id}\n                        userId={post.user_id}\n                        hideStatus={true}\n                        overwriteName={post.props.override_username}\n                        disablePopover={true}\n                    />\n                );\n            } else {\n                userProfile = (\n                    <UserProfile\n                        key={post.user_id}\n                        userId={post.user_id}\n                        hideStatus={true}\n                        disablePopover={true}\n                    />\n                );\n            }\n\n            botIndicator = <BotBadge/>;\n        } else {\n            userProfile = (\n                <UserProfile\n                    key={post.user_id}\n                    userId={post.user_id}\n                    isBusy={this.props.isBusy}\n                    isRHS={true}\n                    hasMention={true}\n                />\n            );\n        }\n\n        let postClass = '';\n        if (PostUtils.isEdited(this.props.post)) {\n            postClass += ' post--edited';\n        }\n\n        let pinnedBadge;\n        if (post.is_pinned) {\n            pinnedBadge = (\n                <span className='post__pinned-badge'>\n                    <FormattedMessage\n                        id='post_info.pinned'\n                        defaultMessage='Pinned'\n                    />\n                </span>\n            );\n        }\n\n        const dotMenu = (\n            <DotMenu\n                post={this.props.post}\n                location={Locations.RHS_ROOT}\n                isFlagged={this.props.isFlagged}\n                handleDropdownOpened={this.handleDropdownOpened}\n                handleAddReactionClick={this.toggleEmojiPicker}\n                commentCount={this.props.commentCount}\n                isReadOnly={isReadOnly || channelIsArchived}\n                enableEmojiPicker={this.props.enableEmojiPicker}\n            />\n        );\n\n        let dotMenuContainer;\n        if (!isPostDeleted && this.props.post.type !== Constants.PostTypes.FAKE_PARENT_DELETED) {\n            dotMenuContainer = (\n                <div\n                    ref='dotMenu'\n                    className='col col__reply'\n                >\n                    {dotMenu}\n                    {postReaction}\n                </div>\n            );\n        }\n\n        let postFlagIcon;\n        const showFlagIcon = !isEphemeral && !post.failed && !isSystemMessage;\n        if (showFlagIcon) {\n            postFlagIcon = (\n                <PostFlagIcon\n                    location={Locations.RHS_ROOT}\n                    postId={post.id}\n                    isFlagged={this.props.isFlagged}\n                />\n            );\n        }\n\n        let postInfoIcon;\n        if (this.props.post.props && this.props.post.props.card) {\n            postInfoIcon = (\n                <OverlayTrigger\n                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                    placement='top'\n                    overlay={\n                        <Tooltip>\n                            <FormattedMessage\n                                id='post_info.info.view_additional_info'\n                                defaultMessage='View additional info'\n                            />\n                        </Tooltip>\n                    }\n                >\n                    <button\n                        className='card-icon__container icon--show style--none'\n                        onClick={(e) => {\n                            e.preventDefault();\n                            this.props.handleCardClick(this.props.post);\n                        }}\n                    >\n                        <InfoSmallIcon\n                            className='icon icon__info'\n                            aria-hidden='true'\n                        />\n                    </button>\n                </OverlayTrigger>\n            );\n        }\n\n        return (\n            <div\n                role='listitem'\n                id={'rhsPost_' + post.id}\n                tabIndex='-1'\n                className={`thread__root a11y__section ${this.getClassName(post, isSystemMessage)}`}\n                aria-label={this.state.currentAriaLabel}\n                onClick={this.handlePostClick}\n                onFocus={this.handlePostFocus}\n                data-a11y-sort-order='0'\n            >\n                <div className='post-right-channel__name'>{channelName}</div>\n                <div\n                    role='application'\n                    className='post__content'\n                >\n                    <div className='post__img'>\n                        <PostProfilePicture\n                            compactDisplay={this.props.compactDisplay}\n                            isBusy={this.props.isBusy}\n                            isRHS={true}\n                            post={post}\n                            userId={post.user_id}\n                        />\n                    </div>\n                    <div>\n                        <div\n                            className='post__header'\n                            ref={this.postHeaderRef}\n                        >\n                            <div className='col__name'>\n                                {userProfile}\n                                {botIndicator}\n                            </div>\n                            <div className='col'>\n                                {this.renderPostTime(isEphemeral)}\n                                {pinnedBadge}\n                                {postInfoIcon}\n                                {postFlagIcon}\n                            </div>\n                            {dotMenuContainer}\n                        </div>\n                        <div className='post__body'>\n                            <div className={postClass}>\n                                <MessageWithAdditionalContent\n                                    post={post}\n                                    previewCollapsed={this.props.previewCollapsed}\n                                    previewEnabled={this.props.previewEnabled}\n                                    isEmbedVisible={this.props.isEmbedVisible}\n                                    pluginPostTypes={this.props.pluginPostTypes}\n                                />\n                            </div>\n                            {fileAttachment}\n                            <ReactionList\n                                post={post}\n                                isReadOnly={isReadOnly || channelIsArchived}\n                            />\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default injectIntl(RhsRootPost);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {isChannelReadOnlyById, getChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {makeGetReactionsForPost} from 'mattermost-redux/selectors/entities/posts';\nimport {makeGetDisplayName} from 'mattermost-redux/selectors/entities/users';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {get} from 'mattermost-redux/selectors/entities/preferences';\n\nimport {markPostAsUnread, emitShortcutReactToLastPostFrom} from 'actions/post_actions.jsx';\nimport {isEmbedVisible} from 'selectors/posts';\nimport {getEmojiMap} from 'selectors/emojis';\nimport {isArchivedChannel} from 'utils/channel_utils';\nimport {Preferences} from 'utils/constants';\n\nimport {getShortcutReactToLastPostEmittedFrom} from 'selectors/emojis.js';\n\nimport RhsRootPost from './rhs_root_post.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    const getReactionsForPost = makeGetReactionsForPost();\n    const getDisplayName = makeGetDisplayName();\n\n    const config = getConfig(state);\n    const enableEmojiPicker = config.EnableEmojiPicker === 'true';\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\n    const teamId = ownProps.teamId || getCurrentTeamId(state);\n    const channel = getChannel(state, ownProps.post.channel_id) || {};\n    const emojiMap = getEmojiMap(state);\n    const shortcutReactToLastPostEmittedFrom = getShortcutReactToLastPostEmittedFrom(state);\n\n    return {\n        author: getDisplayName(state, ownProps.post.user_id),\n        reactions: getReactionsForPost(state, ownProps.post.id),\n        emojiMap,\n        enableEmojiPicker,\n        enablePostUsernameOverride,\n        isEmbedVisible: isEmbedVisible(state, ownProps.post.id),\n        isReadOnly: isChannelReadOnlyById(state, ownProps.post.channel_id),\n        teamId,\n        pluginPostTypes: state.plugins.postTypes,\n        channelIsArchived: isArchivedChannel(channel),\n        channelType: channel.type,\n        channelDisplayName: channel.display_name,\n        isFlagged: get(state, Preferences.CATEGORY_FLAGGED_POST, ownProps.post.id, null) != null,\n        compactDisplay: get(state, Preferences.CATEGORY_DISPLAY_SETTINGS, Preferences.MESSAGE_DISPLAY, Preferences.MESSAGE_DISPLAY_DEFAULT) === Preferences.MESSAGE_DISPLAY_COMPACT,\n        shortcutReactToLastPostEmittedFrom,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            markPostAsUnread,\n            emitShortcutReactToLastPostFrom\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(RhsRootPost);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport {FormattedMessage} from 'react-intl';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport Scrollbars from 'react-custom-scrollbars';\nimport {Posts} from 'mattermost-redux/constants';\n\nimport Constants from 'utils/constants';\nimport DelayedAction from 'utils/delayed_action';\nimport * as Utils from 'utils/utils.jsx';\nimport * as UserAgent from 'utils/user_agent';\nimport CreateComment from 'components/create_comment';\nimport DateSeparator from 'components/post_view/date_separator';\nimport FloatingTimestamp from 'components/post_view/floating_timestamp';\nimport RhsComment from 'components/rhs_comment';\nimport RhsHeaderPost from 'components/rhs_header_post';\nimport RhsRootPost from 'components/rhs_root_post';\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\n\nexport function renderView(props) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--view'\n        />);\n}\n\nexport function renderThumbHorizontal() {\n    return (<div/>);\n}\n\nexport function renderThumbVertical(props) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--vertical'\n        />);\n}\n\nexport default class RhsThread extends React.Component {\n    static propTypes = {\n        posts: PropTypes.arrayOf(PropTypes.object).isRequired,\n        channel: PropTypes.object.isRequired,\n        selected: PropTypes.object.isRequired,\n        previousRhsState: PropTypes.string,\n        currentUserId: PropTypes.string.isRequired,\n        previewCollapsed: PropTypes.string.isRequired,\n        previewEnabled: PropTypes.bool.isRequired,\n        socketConnectionStatus: PropTypes.bool.isRequired,\n        actions: PropTypes.shape({\n            removePost: PropTypes.func.isRequired,\n            selectPostCard: PropTypes.func.isRequired,\n            getPostThread: PropTypes.func.isRequired,\n        }).isRequired,\n        directTeammate: PropTypes.string.isRequired,\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        let updatedState = {selected: props.selected};\n        if (state.selected && props.selected && state.selected.id !== props.selected.id) {\n            updatedState = {...updatedState, openTime: (new Date()).getTime()};\n        }\n        return updatedState;\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.scrollStopAction = new DelayedAction(this.handleScrollStop);\n\n        const openTime = (new Date()).getTime();\n\n        this.state = {\n            windowWidth: Utils.windowWidth(),\n            windowHeight: Utils.windowHeight(),\n            isScrolling: false,\n            topRhsPostId: 0,\n            openTime,\n        };\n    }\n\n    componentDidMount() {\n        this.scrollToBottom();\n        window.addEventListener('resize', this.handleResize);\n        if (this.props.posts.length < (Utils.getRootPost(this.props.posts).reply_count + 1)) {\n            this.props.actions.getPostThread(this.props.selected.id, true);\n        }\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.handleResize);\n    }\n\n    componentDidUpdate(prevProps) {\n        const prevPostsArray = prevProps.posts || [];\n        const curPostsArray = this.props.posts || [];\n\n        if (this.props.socketConnectionStatus && !prevProps.socketConnectionStatus) {\n            this.props.actions.getPostThread(this.props.selected.id);\n        }\n\n        if (prevPostsArray.length >= curPostsArray.length) {\n            return;\n        }\n\n        const curLastPost = curPostsArray[0];\n\n        if (curLastPost.user_id === this.props.currentUserId) {\n            this.scrollToBottom();\n        }\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        if (!Utils.areObjectsEqual(nextState.postsArray, this.props.posts)) {\n            return true;\n        }\n\n        if (!Utils.areObjectsEqual(nextState.selected, this.props.selected)) {\n            return true;\n        }\n\n        if (nextProps.previewEnabled !== this.props.previewEnabled) {\n            return true;\n        }\n\n        if (nextState.isBusy !== this.state.isBusy) {\n            return true;\n        }\n\n        if (nextState.isScrolling !== this.state.isScrolling) {\n            return true;\n        }\n\n        if (nextState.topRhsPostId !== this.state.topRhsPostId) {\n            return true;\n        }\n\n        return false;\n    }\n\n    handleResize = () => {\n        this.setState({\n            windowWidth: Utils.windowWidth(),\n            windowHeight: Utils.windowHeight(),\n        });\n\n        if (UserAgent.isMobile() && document.activeElement.id === 'reply_textbox') {\n            this.scrollToBottom();\n        }\n    }\n\n    handleCardClick = (post) => {\n        if (!post) {\n            return;\n        }\n\n        this.props.actions.selectPostCard(post);\n    }\n\n    handleCardClickPost = (post) => {\n        if (!post) {\n            return;\n        }\n\n        this.props.actions.selectPostCard(post);\n    }\n\n    onBusy = (isBusy) => {\n        this.setState({isBusy});\n    }\n\n    filterPosts = (posts, selected, openTime) => {\n        const postsArray = [];\n\n        posts.forEach((cpost) => {\n            // Do not show empherals created before sidebar has been opened\n            if (cpost.type === 'system_ephemeral' && cpost.create_at < openTime) {\n                return;\n            }\n\n            if (cpost.root_id === selected.id) {\n                postsArray.unshift(cpost);\n            }\n        });\n\n        return postsArray;\n    }\n\n    scrollToBottom = () => {\n        if ($('.post-right__scroll')[0]) {\n            $('.post-right__scroll').parent().scrollTop($('.post-right__scroll')[0].scrollHeight);\n        }\n    }\n\n    updateFloatingTimestamp = () => {\n        // skip this in non-mobile view since that's when the timestamp is visible\n        if (!Utils.isMobile()) {\n            return;\n        }\n\n        if (this.props.posts) {\n            const childNodes = this.refs.rhspostlist.childNodes;\n            const viewPort = this.refs.rhspostlist.getBoundingClientRect();\n            let topRhsPostId = '';\n            const offset = 100;\n\n            // determine the top rhs comment assuming that childNodes and postsArray are of same length\n            for (let i = 0; i < childNodes.length; i++) {\n                if ((childNodes[i].offsetTop + viewPort.top) - offset > 0) {\n                    topRhsPostId = this.props.posts[i].id;\n                    break;\n                }\n            }\n\n            if (topRhsPostId !== this.state.topRhsPostId) {\n                this.setState({\n                    topRhsPostId,\n                });\n            }\n        }\n    }\n\n    handleScroll = () => {\n        this.updateFloatingTimestamp();\n\n        if (!this.state.isScrolling) {\n            this.setState({\n                isScrolling: true,\n            });\n        }\n\n        this.scrollStopAction.fireAfter(Constants.SCROLL_DELAY);\n    }\n\n    handleScrollStop = () => {\n        this.setState({\n            isScrolling: false,\n        });\n    }\n\n    render() {\n        if (this.props.posts == null || this.props.selected == null) {\n            return (\n                <div/>\n            );\n        }\n\n        const postsArray = this.filterPosts(this.props.posts, this.props.selected, this.state.openTime);\n        const postsLength = postsArray.length;\n        const {selected, currentUserId} = this.props;\n\n        let isRhsRootLastPost = false;\n        let lastRhsCommentPost = '';\n\n        if (postsLength === 0) {\n            isRhsRootLastPost = true;\n        } else {\n            lastRhsCommentPost = postsArray[postsLength - 1];\n        }\n\n        let createAt = selected.create_at;\n        if (!createAt && this.props.posts.length > 0) {\n            createAt = this.props.posts[this.props.posts.length - 1].create_at;\n        }\n        const rootPostDay = Utils.getDateForUnixTicks(createAt);\n        let previousPostDay = rootPostDay;\n\n        const commentsLists = [];\n        let a11yIndex = 1;\n        for (let i = 0; i < postsLength; i++) {\n            const comPost = postsArray[i];\n            const previousPostId = i > 0 ? postsArray[i - 1].id : '';\n\n            const currentPostDay = Utils.getDateForUnixTicks(comPost.create_at);\n            if (currentPostDay.toDateString() !== previousPostDay.toDateString()) {\n                previousPostDay = currentPostDay;\n                commentsLists.push(\n                    <DateSeparator\n                        key={currentPostDay}\n                        date={currentPostDay}\n                    />);\n            }\n\n            const keyPrefix = comPost.id ? comPost.id : comPost.pending_post_id;\n\n            commentsLists.push(\n                <RhsComment\n                    key={keyPrefix + 'commentKey'}\n                    ref={comPost.id}\n                    post={comPost}\n                    previousPostId={previousPostId}\n                    teamId={this.props.channel.team_id}\n                    currentUserId={currentUserId}\n                    isBusy={this.state.isBusy}\n                    removePost={this.props.actions.removePost}\n                    previewCollapsed={this.props.previewCollapsed}\n                    previewEnabled={this.props.previewEnabled}\n                    handleCardClick={this.handleCardClickPost}\n                    a11yIndex={a11yIndex++}\n                    isLastPost={comPost.id === lastRhsCommentPost.id}\n                />\n            );\n        }\n\n        let createComment;\n        const isFakeDeletedPost = selected.type === Constants.PostTypes.FAKE_PARENT_DELETED;\n        const channelIsArchived = this.props.channel.delete_at !== 0;\n        if (!isFakeDeletedPost) {\n            if (channelIsArchived) {\n                createComment = (\n                    <div className='channel-archived-warning'>\n                        <FormattedMarkdownMessage\n                            id='archivedChannelMessage'\n                            defaultMessage='You are viewing an **archived channel**. New messages cannot be posted.'\n                        />\n                    </div>\n                );\n            } else {\n                createComment = (\n                    <div className='post-create__container'>\n                        <CreateComment\n                            channelId={selected.channel_id}\n                            rootId={selected.id}\n                            rootDeleted={selected.state === Posts.POST_DELETED}\n                            latestPostId={postsLength > 0 ? postsArray[postsLength - 1].id : selected.id}\n                        />\n                    </div>\n                );\n            }\n        }\n\n        if (this.props.channel.type === Constants.DM_CHANNEL) {\n            const teammate = this.props.directTeammate;\n            if (teammate && teammate.delete_at) {\n                createComment = (\n                    <div\n                        className='post-create-message'\n                    >\n                        <FormattedMessage\n                            id='create_post.deactivated'\n                            defaultMessage='You are viewing an archived channel with a deactivated user.'\n                        />\n                    </div>\n                );\n            }\n        }\n\n        return (\n            <div\n                id='rhsContainer'\n                className='sidebar-right__body'\n            >\n                <FloatingTimestamp\n                    isScrolling={this.state.isScrolling}\n                    isMobile={Utils.isMobile()}\n                    postId={this.state.topRhsPostId}\n                    isRhsPost={true}\n                />\n                <RhsHeaderPost\n                    previousRhsState={this.props.previousRhsState}\n                />\n                <Scrollbars\n                    autoHide={true}\n                    autoHideTimeout={500}\n                    autoHideDuration={500}\n                    renderThumbHorizontal={renderThumbHorizontal}\n                    renderThumbVertical={renderThumbVertical}\n                    renderView={renderView}\n                    onScroll={this.handleScroll}\n                >\n                    <div className='post-right__scroll'>\n                        <div\n                            role='application'\n                            id='rhsContent'\n                            aria-label={Utils.localizeMessage('accessibility.sections.rhsContent', 'message details complimentary region')}\n                            className='post-right__content a11y__region'\n                            data-a11y-sort-order='3'\n                            data-a11y-focus-child={true}\n                            data-a11y-order-reversed={true}\n                        >\n                            {!isFakeDeletedPost && <DateSeparator date={rootPostDay}/>}\n                            <RhsRootPost\n                                ref={selected.id}\n                                post={selected}\n                                commentCount={postsLength}\n                                teamId={this.props.channel.team_id}\n                                currentUserId={this.props.currentUserId}\n                                previewCollapsed={this.props.previewCollapsed}\n                                previewEnabled={this.props.previewEnabled}\n                                isBusy={this.state.isBusy}\n                                handleCardClick={this.handleCardClick}\n                                isLastPost={isRhsRootLastPost}\n                            />\n                            {isFakeDeletedPost && rootPostDay && <DateSeparator date={rootPostDay}/>}\n                            <div\n                                ref='rhspostlist'\n                                className='post-right-comments-container'\n                                id='rhsPostList'\n                            >\n                                {commentsLists}\n                            </div>\n                        </div>\n                        {createComment}\n                    </div>\n                </Scrollbars>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {getChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {makeGetPostsForThread} from 'mattermost-redux/selectors/entities/posts';\nimport {get, getBool} from 'mattermost-redux/selectors/entities/preferences';\nimport {removePost, getPostThread} from 'mattermost-redux/actions/posts';\n\nimport {Preferences} from 'utils/constants';\nimport {getDirectTeammate} from 'utils/utils.jsx';\nimport {getSelectedPost} from 'selectors/rhs.jsx';\nimport {getSocketStatus} from 'selectors/views/websocket';\nimport {selectPostCard} from 'actions/views/rhs';\n\nimport RhsThread from './rhs_thread.jsx';\n\nfunction makeMapStateToProps() {\n    const getPostsForThread = makeGetPostsForThread();\n\n    return function mapStateToProps(state) {\n        const selected = getSelectedPost(state);\n        const socketStatus = getSocketStatus(state);\n\n        let channel = null;\n        let posts = [];\n        if (selected) {\n            posts = getPostsForThread(state, {rootId: selected.id});\n            channel = getChannel(state, selected.channel_id);\n        }\n\n        const previewCollapsed = get(state, Preferences.CATEGORY_DISPLAY_SETTINGS, Preferences.COLLAPSE_DISPLAY, Preferences.COLLAPSE_DISPLAY_DEFAULT);\n\n        return {\n            selected,\n            channel,\n            posts,\n            socketConnectionStatus: socketStatus.connected,\n            previewCollapsed,\n            previewEnabled: getBool(state, Preferences.CATEGORY_DISPLAY_SETTINGS, Preferences.LINK_PREVIEW_DISPLAY, Preferences.LINK_PREVIEW_DISPLAY_DEFAULT),\n            directTeammate: getDirectTeammate(state, channel.id),\n        };\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            removePost,\n            selectPostCard,\n            getPostThread,\n        }, dispatch),\n    };\n}\n\nexport default connect(makeMapStateToProps, mapDispatchToProps)(RhsThread);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport OverlayTrigger from 'components/overlay_trigger';\n\nimport Constants, {RHSStates} from 'utils/constants';\n\nexport default class RhsCardHeader extends React.Component {\n    static propTypes = {\n        previousRhsState: PropTypes.oneOf(Object.values(RHSStates)),\n        actions: PropTypes.shape({\n            showMentions: PropTypes.func,\n            showSearchResults: PropTypes.func,\n            showFlaggedPosts: PropTypes.func,\n            showPinnedPosts: PropTypes.func,\n            closeRightHandSide: PropTypes.func,\n            toggleRhsExpanded: PropTypes.func.isRequired,\n        }),\n    };\n\n    handleBack = (e) => {\n        e.preventDefault();\n\n        switch (this.props.previousRhsState) {\n        case RHSStates.SEARCH:\n            this.props.actions.showSearchResults();\n            break;\n        case RHSStates.MENTION:\n            this.props.actions.showMentions();\n            break;\n        case RHSStates.FLAG:\n            this.props.actions.showFlaggedPosts();\n            break;\n        case RHSStates.PIN:\n            this.props.actions.showPinnedPosts();\n            break;\n        default:\n            break;\n        }\n    }\n\n    render() {\n        let back;\n        let backToResultsTooltip;\n\n        switch (this.props.previousRhsState) {\n        case RHSStates.SEARCH:\n        case RHSStates.MENTION:\n            backToResultsTooltip = (\n                <Tooltip id='backToResultsTooltip'>\n                    <FormattedMessage\n                        id='rhs_header.backToResultsTooltip'\n                        defaultMessage='Back to search results'\n                    />\n                </Tooltip>\n            );\n            break;\n        case RHSStates.FLAG:\n            backToResultsTooltip = (\n                <Tooltip id='backToResultsTooltip'>\n                    <FormattedMessage\n                        id='rhs_header.backToFlaggedTooltip'\n                        defaultMessage='Back to flagged posts'\n                    />\n                </Tooltip>\n            );\n            break;\n        case RHSStates.PIN:\n            backToResultsTooltip = (\n                <Tooltip id='backToResultsTooltip'>\n                    <FormattedMessage\n                        id='rhs_header.backToPinnedTooltip'\n                        defaultMessage='Back to pinned posts'\n                    />\n                </Tooltip>\n            );\n            break;\n        }\n\n        const closeSidebarTooltip = (\n            <Tooltip id='closeSidebarTooltip'>\n                <FormattedMessage\n                    id='rhs_header.closeSidebarTooltip'\n                    defaultMessage='Close Sidebar'\n                />\n            </Tooltip>\n        );\n\n        const expandSidebarTooltip = (\n            <Tooltip id='expandSidebarTooltip'>\n                <FormattedMessage\n                    id='rhs_header.expandSidebarTooltip'\n                    defaultMessage='Expand Sidebar'\n                />\n            </Tooltip>\n        );\n\n        const shrinkSidebarTooltip = (\n            <Tooltip id='shrinkSidebarTooltip'>\n                <FormattedMessage\n                    id='rhs_header.shrinkSidebarTooltip'\n                    defaultMessage='Shrink Sidebar'\n                />\n            </Tooltip>\n        );\n\n        if (backToResultsTooltip) {\n            back = (\n                <a\n                    href='#'\n                    onClick={this.handleBack}\n                    className='sidebar--right__back'\n                >\n                    <OverlayTrigger\n                        delayShow={Constants.OVERLAY_TIME_DELAY}\n                        placement='top'\n                        overlay={backToResultsTooltip}\n                    >\n                        <FormattedMessage\n                            id='generic_icons.back'\n                            defaultMessage='Back Icon'\n                        >\n                            {(ariaLabel) => (\n                                <i\n                                    className='fa fa-angle-left'\n                                    aria-label={ariaLabel}\n                                />\n                            )}\n                        </FormattedMessage>\n                    </OverlayTrigger>\n                </a>\n            );\n        }\n\n        return (\n            <div className='sidebar--right__header'>\n                <span className='sidebar--right__title'>\n                    {back}\n                    <FormattedMessage\n                        id='search_header.title5'\n                        defaultMessage='Extra information'\n                    />\n                </span>\n                <div className='pull-right'>\n                    <button\n                        type='button'\n                        className='sidebar--right__expand'\n                        aria-label='Expand'\n                        onClick={this.props.actions.toggleRhsExpanded}\n                    >\n                        <OverlayTrigger\n                            delayShow={Constants.OVERLAY_TIME_DELAY}\n                            placement='top'\n                            overlay={expandSidebarTooltip}\n                        >\n                            <FormattedMessage\n                                id='rhs_header.expandSidebarTooltip.icon'\n                                defaultMessage='Expand Sidebar Icon'\n                            >\n                                {(ariaLabel) => (\n                                    <i\n                                        className='fa fa-expand'\n                                        aria-label={ariaLabel}\n                                    />\n                                )}\n                            </FormattedMessage>\n                        </OverlayTrigger>\n                        <OverlayTrigger\n                            delayShow={Constants.OVERLAY_TIME_DELAY}\n                            placement='top'\n                            overlay={shrinkSidebarTooltip}\n                        >\n                            <FormattedMessage\n                                id='rhs_header.expandTooltip.icon'\n                                defaultMessage='Shrink Sidebar Icon'\n                            >\n                                {(ariaLabel) => (\n                                    <i\n                                        className='fa fa-compress'\n                                        aria-label={ariaLabel}\n                                    />\n                                )}\n                            </FormattedMessage>\n                        </OverlayTrigger>\n                    </button>\n                    <button\n                        type='button'\n                        className='sidebar--right__close'\n                        aria-label='Close'\n                        onClick={this.props.actions.closeRightHandSide}\n                    >\n                        <OverlayTrigger\n                            delayShow={Constants.OVERLAY_TIME_DELAY}\n                            placement='top'\n                            overlay={closeSidebarTooltip}\n                        >\n                            <FormattedMessage\n                                id='rhs_header.closeTooltip.icon'\n                                defaultMessage='Close Sidebar Icon'\n                            >\n                                {(ariaLabel) => (\n                                    <i\n                                        className='fa fa-sign-out'\n                                        aria-label={ariaLabel}\n                                    />\n                                )}\n                            </FormattedMessage>\n                        </OverlayTrigger>\n                    </button>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {\n    showMentions,\n    showSearchResults,\n    showFlaggedPosts,\n    showPinnedPosts,\n    closeRightHandSide,\n    toggleRhsExpanded,\n} from 'actions/views/rhs';\n\nimport RshCardHeader from './rhs_card_header.jsx';\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            showMentions,\n            showSearchResults,\n            showFlaggedPosts,\n            showPinnedPosts,\n            closeRightHandSide,\n            toggleRhsExpanded,\n        }, dispatch),\n    };\n}\n\nexport default connect(null, mapDispatchToProps)(RshCardHeader);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport Scrollbars from 'react-custom-scrollbars';\nimport {FormattedMessage} from 'react-intl';\nimport {Link} from 'react-router-dom';\n\nimport DelayedAction from 'utils/delayed_action';\nimport Constants, {RHSStates} from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\nimport RhsCardHeader from 'components/rhs_card_header';\nimport Markdown from 'components/markdown';\nimport UserProfile from 'components/user_profile';\nimport PostProfilePicture from 'components/post_profile_picture';\nimport * as GlobalActions from 'actions/global_actions.jsx';\n\nexport function renderView(props) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--view'\n        />);\n}\n\nexport function renderThumbHorizontal(props) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--horizontal'\n        />);\n}\n\nexport function renderThumbVertical(props) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--vertical'\n        />);\n}\n\nexport default class RhsCard extends React.Component {\n    static propTypes = {\n        selected: PropTypes.object,\n        pluginPostCardTypes: PropTypes.object,\n        previousRhsState: PropTypes.oneOf(Object.values(RHSStates)),\n        enablePostUsernameOverride: PropTypes.bool,\n        teamUrl: PropTypes.string,\n    }\n\n    static defaultProps = {\n        pluginPostCardTypes: {},\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.scrollStopAction = new DelayedAction(this.handleScrollStop);\n\n        this.state = {\n            isScrolling: false,\n            topRhsPostCreateAt: 0,\n        };\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        if (!Utils.areObjectsEqual(nextState.selected, this.props.selected)) {\n            return true;\n        }\n        if (nextState.isScrolling !== this.state.isScrolling) {\n            return true;\n        }\n        return false;\n    }\n\n    handleScroll = () => {\n        if (!this.state.isScrolling) {\n            this.setState({\n                isScrolling: true,\n            });\n        }\n\n        this.scrollStopAction.fireAfter(Constants.SCROLL_DELAY);\n    }\n\n    handleScrollStop = () => {\n        this.setState({\n            isScrolling: false,\n        });\n    }\n\n    handleClick = () => {\n        if (Utils.isMobile()) {\n            GlobalActions.emitCloseRightHandSide();\n        }\n    };\n\n    render() {\n        if (this.props.selected == null) {\n            return (<div/>);\n        }\n\n        const {selected, pluginPostCardTypes, teamUrl} = this.props;\n        const postType = selected.type;\n        let content = null;\n        if (pluginPostCardTypes.hasOwnProperty(postType)) {\n            const PluginComponent = pluginPostCardTypes[postType].component;\n            content = <PluginComponent post={selected}/>;\n        }\n\n        if (!content) {\n            content = (\n                <div className='info-card'>\n                    <Markdown message={selected.props && selected.props.card}/>\n                </div>\n            );\n        }\n\n        let user = (\n            <UserProfile\n                userId={selected.user_id}\n                hideStatus={true}\n                disablePopover={true}\n            />\n        );\n        if (selected.props.override_username && this.props.enablePostUsernameOverride) {\n            user = (\n                <UserProfile\n                    userId={selected.user_id}\n                    hideStatus={true}\n                    disablePopover={true}\n                    overwriteName={selected.props.override_username}\n                />\n            );\n        }\n        const avatar = (\n            <PostProfilePicture\n                compactDisplay={false}\n                post={selected}\n                userId={selected.user_id}\n            />\n        );\n\n        return (\n            <div className='sidebar-right__body sidebar-right__card'>\n                <RhsCardHeader previousRhsState={this.props.previousRhsState}/>\n                <Scrollbars\n                    autoHide={true}\n                    autoHideTimeout={500}\n                    autoHideDuration={500}\n                    renderThumbHorizontal={renderThumbHorizontal}\n                    renderThumbVertical={renderThumbVertical}\n                    renderView={renderView}\n                    onScroll={this.handleScroll}\n                >\n                    <div className='post-right__scroll'>\n                        {content}\n                        <div className='d-flex post-card--info'>\n                            <div className='post-card--post-by overflow--ellipsis'>\n                                <FormattedMessage\n                                    id='rhs_card.message_by'\n                                    defaultMessage='Message by {avatar} {user}'\n                                    values={{user, avatar}}\n                                />\n                            </div>\n                            <div className='post-card--view-post'>\n                                <Link\n                                    to={`${teamUrl}/pl/${selected.id}`}\n                                    className='post__permalink'\n                                    onClick={this.handleClick}\n                                >\n                                    <FormattedMessage\n                                        id='rhs_card.jump'\n                                        defaultMessage='Jump'\n                                    />\n                                </Link>\n                            </div>\n                        </div>\n                    </div>\n                </Scrollbars>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getCurrentRelativeTeamUrl} from 'mattermost-redux/selectors/entities/teams';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport {getSelectedPostCard} from 'selectors/rhs.jsx';\n\nimport RhsCard from './rhs_card.jsx';\n\nfunction mapStateToProps(state) {\n    const selected = getSelectedPostCard(state);\n    const config = getConfig(state);\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\n\n    return {\n        enablePostUsernameOverride,\n        selected,\n        pluginPostCardTypes: state.plugins.postCardTypes,\n        teamUrl: getCurrentRelativeTeamUrl(state),\n    };\n}\n\nexport default connect(mapStateToProps)(RhsCard);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {FormattedMessage} from 'react-intl';\n\nexport default class SelectIcon extends React.PureComponent {\n    render() {\n        return (\n            <FormattedMessage\n                id='generic_icons.select'\n                defaultMessage='Select Icon'\n            >\n                {(title) => (\n                    <i\n                        className='fa fa fa-plus-square'\n                        title={title}\n                    />\n                )}\n            </FormattedMessage>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\nimport React from 'react';\n\nimport Constants from 'utils/constants';\nimport SelectIcon from 'components/widgets/icons/fa_select_icon';\nimport BotBadge from 'components/widgets/badges/bot_badge';\n\nimport Suggestion from '../suggestion.jsx';\n\nfunction itemToName(item) {\n    if (item.type === Constants.DM_CHANNEL) {\n        return '@' + item.display_name;\n    }\n    if (item.type === Constants.GM_CHANNEL) {\n        return '@' + item.display_name.replace(/ /g, '');\n    }\n    if (item.type === Constants.OPEN_CHANNEL || item.type === Constants.PRIVATE_CHANNEL) {\n        return item.display_name + ' (~' + item.name + ')';\n    }\n    return item.name;\n}\n\nexport default class SearchChannelSuggestion extends Suggestion {\n    render() {\n        const {item, isSelection, teammate} = this.props;\n\n        let className = 'search-autocomplete__item';\n        if (isSelection) {\n            className += ' selected a11y--focused';\n        }\n\n        const name = itemToName(item);\n\n        let tag = null;\n        if (item.type === Constants.DM_CHANNEL) {\n            tag = (\n                <BotBadge\n                    show={Boolean(teammate && teammate.is_bot)}\n                    className='badge-popoverlist'\n                />\n            );\n        }\n\n        return (\n            <div\n                onClick={this.handleClick}\n                className={className}\n                ref={(node) => {\n                    this.node = node;\n                }}\n                {...Suggestion.baseProps}\n            >\n                <SelectIcon/>\n                <span\n                    data-testid='listItem'\n                    className='search-autocomplete__name'\n                >\n                    {name}\n                </span>\n                {tag}\n            </div>\n        );\n    }\n}","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\nimport {connect} from 'react-redux';\n\nimport {getDirectTeammate} from 'utils/utils';\n\nimport SearchChannelSuggestion from './search_channel_suggestion';\n\nconst mapStateToProps = (state, ownProps) => {\n    return {\n        teammate: getDirectTeammate(state, ownProps.item.id),\n    };\n};\n\nexport default connect(mapStateToProps)(SearchChannelSuggestion);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {sortChannelsByTypeAndDisplayName} from 'mattermost-redux/utils/channel_utils';\n\nimport Constants from 'utils/constants';\n\nimport Provider from './provider.jsx';\nimport SearchChannelSuggestion from './search_channel_suggestion';\n\nfunction itemToTerm(item) {\n    if (item.type === Constants.DM_CHANNEL) {\n        return '@' + item.display_name;\n    }\n    if (item.type === Constants.GM_CHANNEL) {\n        return '@' + item.display_name.replace(/ /g, '');\n    }\n    if (item.type === Constants.OPEN_CHANNEL || item.type === Constants.PRIVATE_CHANNEL) {\n        return item.name;\n    }\n    return item.name;\n}\n\nexport default class SearchChannelProvider extends Provider {\n    constructor(channelSearchFunc) {\n        super();\n        this.autocompleteChannelsForSearch = channelSearchFunc;\n    }\n\n    handlePretextChanged(pretext, resultsCallback) {\n        const captured = (/\\b(?:in|channel):\\s*(\\S*)$/i).exec(pretext.toLowerCase());\n        if (captured) {\n            const channelPrefix = captured[1];\n\n            this.startNewRequest(channelPrefix);\n\n            this.autocompleteChannelsForSearch(\n                channelPrefix,\n                (data) => {\n                    if (this.shouldCancelDispatch(channelPrefix)) {\n                        return;\n                    }\n\n                    //\n                    // MM-12677 When this is migrated this needs to be fixed to pull the user's locale\n                    //\n                    const channels = data.sort(sortChannelsByTypeAndDisplayName.bind(null, 'en'));\n                    const channelNames = channels.map(itemToTerm);\n\n                    resultsCallback({\n                        matchedPretext: channelPrefix,\n                        terms: channelNames,\n                        items: channels,\n                        component: SearchChannelSuggestion,\n                    });\n                },\n            );\n        }\n\n        return Boolean(captured);\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport {FormattedMessage} from 'react-intl';\n\nimport Constants from 'utils/constants';\n\nimport Popover from 'components/widgets/popover';\n\nimport SuggestionList from './suggestion_list.jsx';\n\nexport default class SearchSuggestionList extends SuggestionList {\n    static propTypes = {\n        ...SuggestionList.propTypes,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.itemRefs = new Map();\n        this.popoverRef = React.createRef();\n        this.suggestionReadOut = React.createRef();\n    }\n\n    generateLabel(item) {\n        if (item.username) {\n            this.currentLabel = item.username;\n            if ((item.first_name || item.last_name) && item.nickname) {\n                this.currentLabel += ` ${item.first_name} ${item.last_name} ${item.nickname}`;\n            } else if (item.nickname) {\n                this.currentLabel += ` ${item.nickname}`;\n            } else if (item.first_name || item.last_name) {\n                this.currentLabel += ` ${item.first_name} ${item.last_name}`;\n            }\n        } else if (item.type === Constants.DM_CHANNEL || item.type === Constants.GM_CHANNEL) {\n            this.currentLabel = item.display_name;\n        } else {\n            this.currentLabel = item.name;\n        }\n\n        if (this.currentLabel) {\n            this.currentLabel = this.currentLabel.toLowerCase();\n        }\n\n        this.announceLabel();\n    }\n\n    getContent = () => {\n        return $(ReactDOM.findDOMNode(this.popoverRef.current)).find('.popover-content');\n    }\n\n    renderChannelDivider(type) {\n        let text;\n        if (type === Constants.OPEN_CHANNEL) {\n            text = (\n                <FormattedMessage\n                    id='suggestion.search.public'\n                    defaultMessage='Public Channels'\n                />\n            );\n        } else if (type === Constants.PRIVATE_CHANNEL) {\n            text = (\n                <FormattedMessage\n                    id='suggestion.search.private'\n                    defaultMessage='Private Channels'\n                />\n            );\n        } else {\n            text = (\n                <FormattedMessage\n                    id='suggestion.search.direct'\n                    defaultMessage='Direct Messages'\n                />\n            );\n        }\n\n        return (\n            <div\n                key={type + '-divider'}\n                className='search-autocomplete__divider'\n            >\n                <span>{text}</span>\n            </div>\n        );\n    }\n\n    render() {\n        if (this.props.items.length === 0) {\n            return null;\n        }\n\n        const items = [];\n        for (let i = 0; i < this.props.items.length; i++) {\n            const item = this.props.items[i];\n            const term = this.props.terms[i];\n            const isSelection = term === this.props.selection;\n\n            // ReactComponent names need to be upper case when used in JSX\n            const Component = this.props.components[i];\n\n            // temporary hack to add dividers between public and private channels in the search suggestion list\n            if (this.props.renderDividers) {\n                if (i === 0 || item.type !== this.props.items[i - 1].type) {\n                    if (item.type === Constants.OPEN_CHANNEL) {\n                        items.push(this.renderChannelDivider(Constants.OPEN_CHANNEL));\n                    } else if (item.type === Constants.PRIVATE_CHANNEL) {\n                        items.push(this.renderChannelDivider(Constants.PRIVATE_CHANNEL));\n                    } else if (i === 0 || this.props.items[i - 1].type === Constants.OPEN_CHANNEL || this.props.items[i - 1].type === Constants.PRIVATE_CHANNEL) {\n                        items.push(this.renderChannelDivider(Constants.DM_CHANNEL));\n                    }\n                }\n            }\n\n            if (isSelection) {\n                this.currentItem = item;\n            }\n\n            items.push(\n                <Component\n                    key={term}\n                    ref={(ref) => this.itemRefs.set(term, ref)}\n                    item={item}\n                    term={term}\n                    matchedPretext={this.props.matchedPretext[i]}\n                    isSelection={isSelection}\n                    onClick={this.props.onCompleteWord}\n                    onMouseMove={this.props.onItemHover}\n                />,\n            );\n        }\n\n        return (\n            <Popover\n                ref={this.popoverRef}\n                id='search-autocomplete__popover'\n                className='search-help-popover autocomplete visible'\n                placement='bottom'\n            >\n                <div\n                    ref={this.suggestionReadOut}\n                    aria-live='polite'\n                    className='hidden-label'\n                />\n                {items}\n            </Popover>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport Popover from 'components/widgets/popover';\n\nexport default class SuggestionDate extends React.PureComponent {\n    static propTypes = {\n        onCompleteWord: PropTypes.func.isRequired,\n        items: PropTypes.array.isRequired,\n        terms: PropTypes.array.isRequired,\n        components: PropTypes.array.isRequired,\n        matchedPretext: PropTypes.array.isRequired,\n    };\n\n    render() {\n        if (this.props.items.length === 0) {\n            return null;\n        }\n\n        const item = this.props.items[0];\n        const term = this.props.terms[0];\n\n        // ReactComponent names need to be upper case when used in JSX\n        const Component = this.props.components[0];\n\n        const itemComponent = (\n            <Component\n                key={term}\n                ref={term}\n                item={item}\n                term={term}\n                matchedPretext={this.props.matchedPretext[0]}\n                isSelection={false}\n                onClick={this.props.onCompleteWord}\n            />\n        );\n\n        return (\n            <Popover\n                id='search-autocomplete__popover'\n                className='search-help-popover autocomplete visible'\n                placement='bottom'\n            >\n                {itemComponent}\n            </Popover>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport * as Utils from 'utils/utils.jsx';\nimport BotBadge from 'components/widgets/badges/bot_badge';\nimport SelectIcon from 'components/widgets/icons/fa_select_icon';\nimport Avatar from 'components/widgets/users/avatar';\n\nimport Provider from './provider.jsx';\nimport Suggestion from './suggestion.jsx';\n\nclass SearchUserSuggestion extends Suggestion {\n    render() {\n        const {item, isSelection} = this.props;\n\n        let className = 'search-autocomplete__item';\n        if (isSelection) {\n            className += ' selected a11y--focused';\n        }\n\n        const username = item.username;\n        let description = '';\n\n        if ((item.first_name || item.last_name) && item.nickname) {\n            description = `- ${Utils.getFullName(item)} (${item.nickname})`;\n        } else if (item.nickname) {\n            description = `- (${item.nickname})`;\n        } else if (item.first_name || item.last_name) {\n            description = `- ${Utils.getFullName(item)}`;\n        }\n\n        return (\n            <div\n                className={className}\n                ref={(node) => {\n                    this.node = node;\n                }}\n                onClick={this.handleClick}\n                onMouseMove={this.handleMouseMove}\n                {...Suggestion.baseProps}\n            >\n                <SelectIcon/>\n                <Avatar\n                    size='xs'\n                    username={username}\n                    url={Utils.imageURLForUser(item.id, item.last_picture_update)}\n                />\n                <div className='mention--align'>\n                    <span>\n                        {username}\n                    </span>\n                    <BotBadge\n                        show={Boolean(item.is_bot)}\n                        className='badge-autocomplete'\n                    />\n                    <span className='mention__fullname'>\n                        {' '}\n                        {description}\n                    </span>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default class SearchUserProvider extends Provider {\n    constructor(userSearchFunc) {\n        super();\n        this.autocompleteUsersInTeam = userSearchFunc;\n    }\n\n    handlePretextChanged(pretext, resultsCallback) {\n        const captured = (/\\bfrom:\\s*(\\S*)$/i).exec(pretext.toLowerCase());\n\n        this.doAutocomplete(captured, resultsCallback);\n\n        return Boolean(captured);\n    }\n\n    async doAutocomplete(captured, resultsCallback) {\n        if (!captured) {\n            return;\n        }\n\n        const usernamePrefix = captured[1];\n\n        this.startNewRequest(usernamePrefix);\n\n        const data = await this.autocompleteUsersInTeam(usernamePrefix);\n\n        if (this.shouldCancelDispatch(usernamePrefix)) {\n            return;\n        }\n\n        const users = Object.assign([], data.users);\n        const mentions = users.map((user) => user.username);\n\n        resultsCallback({\n            matchedPretext: usernamePrefix,\n            terms: mentions,\n            items: users,\n            component: SearchUserSuggestion,\n        });\n    }\n\n    allowDividers() {\n        return false;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport DayPicker from 'react-day-picker';\n\nimport Suggestion from '../suggestion.jsx';\n\nimport 'react-day-picker/lib/style.css';\n\nexport default class SearchDateSuggestion extends Suggestion {\n    handleDayClick = (day) => {\n        const dayString = day.toISOString().split('T')[0];\n        this.props.onClick(dayString, this.props.matchedPretext);\n    }\n\n    render() {\n        let modifiers;\n        if (this.props.currentDate) {\n            modifiers = {\n                today: this.props.currentDate,\n            };\n        }\n        return (\n            <DayPicker\n                onDayClick={this.handleDayClick}\n                showOutsideDays={true}\n                modifiers={modifiers}\n                ref={(node) => {\n                    this.node = node;\n                }}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getUserTimezone} from 'mattermost-redux/selectors/entities/timezone';\n\nimport {getCurrentDateForTimezone} from 'utils/timezone';\nimport {areTimezonesEnabledAndSupported} from 'selectors/general';\n\nimport SearchDateSuggestion from './search_date_suggestion.jsx';\n\nfunction mapStateToProps(state) {\n    const currentUserId = getCurrentUserId(state);\n    const userTimezone = getUserTimezone(state, currentUserId);\n\n    const enableTimezone = areTimezonesEnabledAndSupported(state);\n\n    let currentDate;\n    if (enableTimezone) {\n        if (userTimezone.useAutomaticTimezone) {\n            currentDate = getCurrentDateForTimezone(userTimezone.automaticTimezone);\n        } else {\n            currentDate = getCurrentDateForTimezone(userTimezone.manualTimezone);\n        }\n    }\n\n    return {\n        currentDate,\n    };\n}\n\nexport default connect(mapStateToProps)(SearchDateSuggestion);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport Provider from './provider.jsx';\nimport SearchDateSuggestion from './search_date_suggestion';\n\nexport default class SearchDateProvider extends Provider {\n    handlePretextChanged(pretext, resultsCallback) {\n        const captured = (/\\b(?:on|before|after):\\s*(\\S*)$/i).exec(pretext.toLowerCase());\n        if (captured) {\n            const datePrefix = captured[1];\n\n            this.startNewRequest(datePrefix);\n\n            const dates = Object.assign([], [{label: 'Selected Date', date: datePrefix}]);\n            const terms = dates.map((date) => date.date);\n\n            resultsCallback({\n                matchedPretext: datePrefix,\n                terms,\n                items: dates,\n                component: SearchDateSuggestion,\n            });\n        }\n\n        return Boolean(captured);\n    }\n\n    allowDividers() {\n        return false;\n    }\n\n    presentationType() {\n        return 'date';\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport {Tooltip} from 'react-bootstrap';\n\nimport OverlayTrigger from 'components/overlay_trigger';\n\nimport {localizeMessage} from 'utils/utils.jsx';\nimport {Constants} from 'utils/constants';\nimport {t} from 'utils/i18n';\n\nexport default function HeaderIconWrapper({\n    iconComponent,\n    ariaLabel,\n    buttonClass,\n    buttonId,\n    onClick,\n    tooltipKey,\n    tooltipText,\n    isRhsOpen,\n}) {\n    const toolTips = {\n        flaggedPosts: {\n            class: 'text-nowrap',\n            id: 'flaggedTooltip',\n            messageID: t('channel_header.flagged'),\n            message: 'See flagged posts',\n        },\n        pinnedPosts: {\n            class: '',\n            id: 'pinnedPostTooltip',\n            messageID: t('channel_header.pinnedPosts'),\n            message: 'See pinned posts',\n        },\n        recentMentions: {\n            class: '',\n            id: 'recentMentionsTooltip',\n            messageID: t('channel_header.recentMentions'),\n            message: 'See recent mentions',\n        },\n        search: {\n            class: '',\n            id: 'searchTooltip',\n            messageID: t('channel_header.search'),\n            message: 'Search',\n        },\n    };\n\n    function getTooltip(key) {\n        if (toolTips[key] == null) {\n            return null;\n        }\n\n        return (\n            <Tooltip\n                id={toolTips[key].id}\n                className={toolTips[key].class}\n            >\n                <FormattedMessage\n                    id={toolTips[key].messageID}\n                    defaultMessage={toolTips[key].message}\n                />\n            </Tooltip>\n        );\n    }\n\n    let tooltip;\n    if (tooltipKey === 'plugin' && tooltipText) {\n        tooltip = (\n            <Tooltip\n                id='pluginTooltip'\n                className=''\n            >\n                <span>{tooltipText}</span>\n            </Tooltip>\n        );\n    } else {\n        tooltip = getTooltip(tooltipKey);\n    }\n\n    let ariaLabelText;\n    if (ariaLabel) {\n        ariaLabelText = `${localizeMessage(toolTips[tooltipKey].messageID, toolTips[tooltipKey].message)}`;\n    }\n\n    if (tooltip) {\n        return (\n            <div className='flex-child'>\n                <OverlayTrigger\n                    trigger={['hover']}\n                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                    placement='bottom'\n                    overlay={isRhsOpen ? <></> : tooltip}\n                >\n                    <button\n                        id={buttonId}\n                        aria-label={ariaLabelText}\n                        className={buttonClass || 'channel-header__icon style--none'}\n                        onClick={onClick}\n                    >\n                        {iconComponent}\n                    </button>\n                </OverlayTrigger>\n            </div>\n        );\n    }\n\n    return (\n        <div className='flex-child'>\n            <button\n                id={buttonId}\n                className={buttonClass || 'channel-header__icon style--none'}\n                onClick={onClick}\n            >\n                {iconComponent}\n            </button>\n        </div>\n    );\n}\n\nHeaderIconWrapper.propTypes = {\n    ariaLabel: PropTypes.bool,\n    buttonClass: PropTypes.string,\n    buttonId: PropTypes.string.isRequired,\n    iconComponent: PropTypes.element.isRequired,\n    onClick: PropTypes.func.isRequired,\n    tooltipKey: PropTypes.string,\n    tooltipText: PropTypes.node,\n    isRhsOpen: PropTypes.bool,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent} from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message.jsx';\n\ntype Props = {\n    withTitle?: boolean;\n}\n\nexport default class SearchHint extends PureComponent<Props> {\n    public render() {\n        return (\n            <React.Fragment>\n                {this.props.withTitle &&\n                <h4>\n                    <FormattedMessage\n                        id='search_bar.usage.title'\n                        defaultMessage='Search Options'\n                    />\n                </h4>\n                }\n                <FormattedMarkdownMessage\n                    id='search_bar.usage.tips'\n                    defaultMessage='* Use **\"quotation marks\"** to search for phrases\\n* Use **from:** to find posts from specific users\\n * Use **in:** to find posts in specific channels\\n* Use **on:** to find posts on a specific date\\n* Use **before:** to find posts before a specific date\\n* Use **after:** to find posts after a specific date\\n* Use **dash** \"-\" to exclude search terms and modifiers'\n                />\n            </React.Fragment>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class MentionsIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.mention'\n                    defaultMessage='Mention Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='14px'\n                            height='14px'\n                            viewBox='0 0 20 20'\n                            version='1.1'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g\n                                stroke='none'\n                                strokeWidth='1'\n                                fill='inherit'\n                                fillRule='evenodd'\n                            >\n                                <g\n                                    transform='translate(-1057.000000, -31.000000)'\n                                    fill='inherit'\n                                >\n                                    <g>\n                                        <g transform='translate(1049.000000, 22.000000)'>\n                                            <path d='M17.4296875,15.8867188 C15.9882812,15.8867188 15.1210938,17.0351562 15.1210938,18.96875 C15.1210938,20.8789062 15.9882812,22.0507812 17.4179688,22.0507812 C18.8945312,22.0507812 19.84375,20.8554688 19.84375,18.96875 C19.84375,17.0820312 18.90625,15.8867188 17.4296875,15.8867188 Z M17.8398438,9.125 C23.3242188,9.125 27.25,12.59375 27.25,17.7734375 C27.25,21.5117188 25.5625,23.9609375 22.7734375,23.9609375 C21.4023438,23.9609375 20.265625,23.1992188 20.078125,22.0390625 L19.9609375,22.0390625 C19.46875,23.2226562 18.4140625,23.8789062 17.0429688,23.8789062 C14.6054687,23.8789062 12.9648438,21.8867188 12.9648438,18.9101562 C12.9648438,16.0625 14.6171875,14.09375 16.9960938,14.09375 C18.25,14.09375 19.3632812,14.7382812 19.8085938,15.7460938 L19.9375,15.7460938 L19.9375,14.328125 L21.9179688,14.328125 L21.9179688,20.984375 C21.9179688,21.7578125 22.328125,22.2851562 23.171875,22.2851562 C24.4726562,22.2851562 25.421875,20.6679688 25.421875,17.8320312 C25.421875,13.5664062 22.2929688,10.7421875 17.7109375,10.7421875 C13.1640625,10.7421875 9.90625,14.140625 9.90625,18.96875 C9.90625,24.1367188 13.3515625,27.0429688 18.109375,27.0429688 C19.5625,27.0429688 21.0507812,26.84375 21.7773438,26.5390625 L21.7773438,28.15625 C20.78125,28.484375 19.4570312,28.671875 18.0273438,28.671875 C12.2382812,28.671875 8.078125,25.109375 8.078125,18.8984375 C8.078125,13.0625 12.0859375,9.125 17.8398438,9.125 Z'/>\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport Constants from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\nimport SearchChannelProvider from 'components/suggestion/search_channel_provider.jsx';\nimport SearchSuggestionList from 'components/suggestion/search_suggestion_list.jsx';\nimport SuggestionDate from 'components/suggestion/suggestion_date.jsx';\nimport SearchUserProvider from 'components/suggestion/search_user_provider.jsx';\nimport SearchDateProvider from 'components/suggestion/search_date_provider.jsx';\nimport SuggestionBox from 'components/suggestion/suggestion_box.jsx';\nimport HeaderIconWrapper from 'components/channel_header/components/header_icon_wrapper';\nimport SearchHint from 'components/search_hint/search_hint';\nimport FlagIcon from 'components/widgets/icons/flag_icon';\nimport MentionsIcon from 'components/widgets/icons/mentions_icon';\nimport SearchIcon from 'components/widgets/icons/search_icon';\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\nimport Popover from 'components/widgets/popover';\n\nconst {KeyCodes} = Constants;\n\nexport default class SearchBar extends React.Component {\n    static propTypes = {\n        isSearchingTerm: PropTypes.bool,\n        searchTerms: PropTypes.string,\n        isMentionSearch: PropTypes.bool,\n        isFlaggedPosts: PropTypes.bool,\n        showMentionFlagBtns: PropTypes.bool,\n        isFocus: PropTypes.bool,\n        isSideBarRight: PropTypes.bool,\n        isRhsOpen: PropTypes.bool,\n        actions: PropTypes.shape({\n            updateSearchTerms: PropTypes.func,\n            showSearchResults: PropTypes.func,\n            showMentions: PropTypes.func,\n            showFlaggedPosts: PropTypes.func,\n            closeRightHandSide: PropTypes.func,\n            autocompleteChannelsForSearch: PropTypes.func.isRequired,\n            autocompleteUsersInTeam: PropTypes.func.isRequired,\n        }),\n    };\n\n    static defaultProps = {\n        showMentionFlagBtns: true,\n        isFocus: false,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            focused: false,\n        };\n\n        this.suggestionProviders = [\n            new SearchDateProvider(),\n            new SearchChannelProvider(props.actions.autocompleteChannelsForSearch),\n            new SearchUserProvider(props.actions.autocompleteUsersInTeam),\n        ];\n    }\n\n    componentDidMount() {\n        if (Utils.isMobile()) {\n            setTimeout(() => {\n                const element = document.querySelector('.app__body .sidebar--menu');\n                if (element) {\n                    element.classList.remove('visible');\n                }\n            });\n        }\n    }\n\n    handleClose = () => {\n        this.props.actions.closeRightHandSide();\n    }\n\n    handleKeyDown = (e) => {\n        if (Utils.isKeyPressed(e, KeyCodes.ESCAPE)) {\n            e.stopPropagation();\n            e.preventDefault();\n        }\n    }\n\n    handleChange = (e) => {\n        var term = e.target.value;\n        this.props.actions.updateSearchTerms(term);\n    }\n\n    handleUserBlur = () => {\n        // add time out so that the pinned and member buttons are clickable\n        // when focus is released from the search box.\n        setTimeout(() => {\n            this.setState({focused: false});\n        }, 200);\n    }\n\n    onClear = () => {\n        this.props.actions.updateSearchTerms('');\n    }\n\n    handleUserFocus = () => {\n        this.setState({focused: true});\n    }\n\n    handleSearch = async (terms) => {\n        if (terms.length) {\n            const {error} = await this.props.actions.showSearchResults();\n\n            if (!error) {\n                this.handleSearchOnSuccess();\n            }\n        }\n    }\n\n    handleSearchOnSuccess = () => {\n        if (Utils.isMobile() && this.search) {\n            this.search.value = '';\n        }\n    }\n\n    handleSubmit = (e) => {\n        e.preventDefault();\n        const terms = this.props.searchTerms.trim();\n\n        if (terms.length === 0) {\n            return;\n        }\n\n        this.handleSearch(terms);\n\n        this.search.blur();\n    }\n\n    searchMentions = (e) => {\n        e.preventDefault();\n        if (this.props.isMentionSearch) {\n            // Close\n            this.props.actions.closeRightHandSide();\n        } else {\n            this.props.actions.showMentions();\n        }\n    }\n\n    getFlagged = (e) => {\n        e.preventDefault();\n        if (this.props.isFlaggedPosts) {\n            this.props.actions.closeRightHandSide();\n        } else {\n            this.props.actions.showFlaggedPosts();\n        }\n    }\n\n    renderHintPopover() {\n        if (Utils.isMobile()) {\n            return null;\n        }\n\n        let helpClass = 'search-help-popover';\n        if (!this.props.searchTerms && this.state.focused) {\n            helpClass += ' visible';\n        }\n\n        return (\n            <Popover\n                id={this.props.isSideBarRight ? 'sbr-searchbar-help-popup' : 'searchbar-help-popup'}\n                placement='bottom'\n                className={helpClass}\n            >\n                <SearchHint withTitle={true}/>\n            </Popover>\n        );\n    }\n\n    getSearch = (node) => {\n        this.search = node;\n    }\n\n    render() {\n        let mentionBtn;\n        let flagBtn;\n        if (this.props.showMentionFlagBtns) {\n            var mentionBtnClass = this.props.isMentionSearch ? 'active' : '';\n\n            mentionBtn = (\n                <HeaderIconWrapper\n                    iconComponent={\n                        <MentionsIcon\n                            className='icon icon__mentions'\n                            aria-hidden='true'\n                        />\n                    }\n                    ariaLabel={true}\n                    buttonClass={'channel-header__icon style--none ' + mentionBtnClass}\n                    buttonId={this.props.isSideBarRight ? 'sbrChannelHeaderMentionButton' : 'channelHeaderMentionButton'}\n                    onClick={this.searchMentions}\n                    tooltipKey={'recentMentions'}\n                    isRhsOpen={this.props.isRhsOpen}\n                />\n            );\n\n            var flagBtnClass = this.props.isFlaggedPosts ? 'active' : '';\n\n            flagBtn = (\n                <HeaderIconWrapper\n                    iconComponent={\n                        <FlagIcon className='icon icon__flag'/>\n                    }\n                    ariaLabel={true}\n                    buttonClass={'channel-header__icon style--none ' + flagBtnClass}\n                    buttonId={this.props.isSideBarRight ? 'sbrChannelHeaderFlagButton' : 'channelHeaderFlagButton'}\n                    onClick={this.getFlagged}\n                    tooltipKey={'flaggedPosts'}\n                    isRhsOpen={this.props.isRhsOpen}\n                />\n            );\n        }\n\n        let searchFormClass = 'search__form';\n        if (this.state.focused) {\n            searchFormClass += ' focused';\n        }\n\n        return (\n            <div className='sidebar-right__table'>\n                <div className='sidebar-collapse__container'>\n                    <div\n                        id={this.props.isSideBarRight ? 'sbrSidebarCollapse' : 'sidebarCollapse'}\n                        className='sidebar-collapse'\n                        onClick={this.handleClose}\n                    >\n                        <FormattedMessage\n                            id='generic_icons.back'\n                            defaultMessage='Back Icon'\n                        >\n                            {(title) => (\n                                <span\n                                    className='fa fa-2x fa-angle-left'\n                                    title={title}\n                                />\n                            )}\n                        </FormattedMessage>\n                    </div>\n                </div>\n                <div\n                    id={this.props.isSideBarRight ? 'sbrSearchFormContainer' : 'searchFormContainer'}\n                    className='search-form__container'\n                >\n                    <form\n                        role='application'\n                        className={searchFormClass}\n                        onSubmit={this.handleSubmit}\n                        style={style.searchForm}\n                        autoComplete='off'\n                        aria-labelledby='searchBox'\n                    >\n                        <SearchIcon\n                            className='search__icon'\n                            aria-hidden='true'\n                        />\n                        <SuggestionBox\n                            ref={this.getSearch}\n                            id={this.props.isSideBarRight ? 'sbrSearchBox' : 'searchBox'}\n                            tabIndex='0'\n                            className='search-bar a11y__region'\n                            data-a11y-sort-order='9'\n                            aria-describedby={this.props.isSideBarRight ? 'sbr-searchbar-help-popup' : 'searchbar-help-popup'}\n                            aria-label={Utils.localizeMessage('search_bar.search', 'Search')}\n                            placeholder={Utils.localizeMessage('search_bar.search', 'Search')}\n                            value={this.props.searchTerms}\n                            onFocus={this.handleUserFocus}\n                            onBlur={this.handleUserBlur}\n                            onChange={this.handleChange}\n                            onKeyDown={this.handleKeyDown}\n                            listComponent={SearchSuggestionList}\n                            dateComponent={SuggestionDate}\n                            providers={this.suggestionProviders}\n                            type='search'\n                            autoFocus={this.props.isFocus && this.props.searchTerms === ''}\n                            delayInputUpdate={true}\n                            renderDividers={true}\n                            clearable={true}\n                            onClear={this.onClear}\n                        />\n                        {this.props.isSearchingTerm && <LoadingSpinner/>}\n                        {this.renderHintPopover()}\n                    </form>\n                </div>\n                {mentionBtn}\n                {flagBtn}\n            </div>\n        );\n    }\n}\n\nconst style = {\n    searchForm: {overflow: 'visible'},\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {\n    updateSearchTerms,\n    showSearchResults,\n    showMentions,\n    showFlaggedPosts,\n    closeRightHandSide,\n} from 'actions/views/rhs';\nimport {autocompleteChannelsForSearch} from 'actions/channel_actions';\nimport {autocompleteUsersInTeam} from 'actions/user_actions';\nimport {getRhsState, getSearchTerms, getIsSearchingTerm, getIsRhsOpen} from 'selectors/rhs';\nimport {RHSStates} from 'utils/constants';\n\nimport SearchBar from './search_bar.jsx';\n\nfunction mapStateToProps(state) {\n    const rhsState = getRhsState(state);\n\n    return {\n        isSearchingTerm: getIsSearchingTerm(state),\n        searchTerms: getSearchTerms(state),\n        isMentionSearch: rhsState === RHSStates.MENTION,\n        isFlaggedPosts: rhsState === RHSStates.FLAG,\n        isRhsOpen: getIsRhsOpen(state),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            updateSearchTerms,\n            showSearchResults,\n            showMentions,\n            showFlaggedPosts,\n            closeRightHandSide,\n            autocompleteChannelsForSearch,\n            autocompleteUsersInTeam,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SearchBar);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport OverlayTrigger from 'components/overlay_trigger';\n\nimport Constants from 'utils/constants';\n\nexport default class SearchResultsHeader extends React.Component {\n    static propTypes = {\n        children: PropTypes.node,\n        actions: PropTypes.shape({\n            closeRightHandSide: PropTypes.func,\n            toggleRhsExpanded: PropTypes.func.isRequired,\n        }),\n    };\n\n    render() {\n        const closeSidebarTooltip = (\n            <Tooltip id='closeSidebarTooltip'>\n                <FormattedMessage\n                    id='rhs_header.closeSidebarTooltip'\n                    defaultMessage='Close the sidebar'\n                />\n            </Tooltip>\n        );\n\n        const expandSidebarTooltip = (\n            <Tooltip id='expandSidebarTooltip'>\n                <FormattedMessage\n                    id='rhs_header.expandSidebarTooltip'\n                    defaultMessage='Expand the sidebar'\n                />\n            </Tooltip>\n        );\n\n        const shrinkSidebarTooltip = (\n            <Tooltip id='shrinkSidebarTooltip'>\n                <FormattedMessage\n                    id='rhs_header.shrinkSidebarTooltip'\n                    defaultMessage='Shrink the sidebar'\n                />\n            </Tooltip>\n        );\n\n        return (\n            <div className='sidebar--right__header'>\n                <span className='sidebar--right__title'>{this.props.children}</span>\n                <div className='pull-right'>\n                    <button\n                        type='button'\n                        className='sidebar--right__expand'\n                        aria-label='Expand'\n                        onClick={this.props.actions.toggleRhsExpanded}\n                    >\n                        <OverlayTrigger\n                            delayShow={Constants.OVERLAY_TIME_DELAY}\n                            placement='top'\n                            overlay={expandSidebarTooltip}\n                        >\n                            <FormattedMessage\n                                id='rhs_header.expandSidebarTooltip.icon'\n                                defaultMessage='Expand the sidebar icon'\n                            >\n                                {(ariaLabel) => (\n                                    <i\n                                        className='fa fa-expand'\n                                        aria-label={ariaLabel}\n                                    />\n                                )}\n                            </FormattedMessage>\n                        </OverlayTrigger>\n                        <OverlayTrigger\n                            delayShow={Constants.OVERLAY_TIME_DELAY}\n                            placement='top'\n                            overlay={shrinkSidebarTooltip}\n                        >\n                            <FormattedMessage\n                                id='rhs_header.expandTooltip.icon'\n                                defaultMessage='Shrink the sidebar icon'\n                            >\n                                {(ariaLabel) => (\n                                    <i\n                                        className='fa fa-compress'\n                                        aria-label={ariaLabel}\n                                    />\n                                )}\n                            </FormattedMessage>\n                        </OverlayTrigger>\n                    </button>\n                    <button\n                        id='searchResultsCloseButton'\n                        type='button'\n                        className='sidebar--right__close'\n                        aria-label='Close'\n                        onClick={this.props.actions.closeRightHandSide}\n                    >\n                        <OverlayTrigger\n                            delayShow={Constants.OVERLAY_TIME_DELAY}\n                            placement='top'\n                            overlay={closeSidebarTooltip}\n                        >\n                            <FormattedMessage\n                                id='rhs_header.closeTooltip.icon'\n                                defaultMessage='Close the sidebar icon'\n                            >\n                                {(ariaLabel) => (\n                                    <i\n                                        className='fa fa-sign-out'\n                                        aria-label={ariaLabel}\n                                    />\n                                )}\n                            </FormattedMessage>\n                        </OverlayTrigger>\n                    </button>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {\n    closeRightHandSide,\n    toggleRhsExpanded,\n} from 'actions/views/rhs';\n\nimport SearchResultsHeader from './search_results_header.jsx';\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            closeRightHandSide,\n            toggleRhsExpanded,\n        }, dispatch),\n    };\n}\n\nexport default connect(null, mapDispatchToProps)(SearchResultsHeader);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class ReplyIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.reply'\n                    defaultMessage='Reply Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            x='0px'\n                            y='0px'\n                            width='17px'\n                            height='17px'\n                            viewBox='-158 242 18 18'\n                            style={style}\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path d='M-142.2,252.6c-2-3-4.8-4.7-8.3-4.8v-3.3c0-0.2-0.1-0.3-0.2-0.3s-0.3,0-0.4,0.1l-6.9,6.2c-0.1,0.1-0.1,0.2-0.1,0.3 c0,0.1,0,0.2,0.1,0.3l6.9,6.4c0.1,0.1,0.3,0.1,0.4,0.1c0.1-0.1,0.2-0.2,0.2-0.4v-3.8c4.2,0,7.4,0.4,9.6,4.4c0.1,0.1,0.2,0.2,0.3,0.2 c0,0,0.1,0,0.1,0c0.2-0.1,0.3-0.3,0.2-0.4C-140.2,257.3-140.6,255-142.2,252.6z M-150.8,252.5c-0.2,0-0.4,0.2-0.4,0.4v3.3l-6-5.5 l6-5.3v2.8c0,0.2,0.2,0.4,0.4,0.4c3.3,0,6,1.5,8,4.5c0.5,0.8,0.9,1.6,1.2,2.3C-144,252.8-147.1,252.5-150.8,252.5z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n\nconst style = {\n    enableBackground: 'new -158 242 18 18',\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport {localizeMessage} from 'utils/utils.jsx';\n\nimport OverlayTrigger from 'components/overlay_trigger';\nimport ReplyIcon from 'components/widgets/icons/reply_icon';\n\ntype Props = {\n    location: 'CENTER' | 'SEARCH';\n    handleCommentClick: React.EventHandler<React.MouseEvent>;\n    searchStyle: string;\n    commentCount: number;\n    postId?: string;\n    extraClass: string;\n}\n\nexport default class CommentIcon extends React.PureComponent<Props> {\n    public static defaultProps: Partial<Props> = {\n        location: 'CENTER',\n        searchStyle: '',\n        commentCount: 0,\n        extraClass: '',\n    }\n\n    public render(): JSX.Element {\n        let commentCountSpan: JSX.Element | null = null;\n        let iconStyle = 'comment-icon__container';\n        if (this.props.commentCount > 0) {\n            iconStyle += ' icon--show';\n            commentCountSpan = (\n                <span className='comment-count'>\n                    {this.props.commentCount}\n                </span>\n            );\n        } else if (this.props.searchStyle !== '') {\n            iconStyle = iconStyle + ' ' + this.props.searchStyle;\n        }\n\n        const tooltip = (\n            <Tooltip\n                id='comment-icon-tooltip'\n                className='hidden-xs'\n            >\n                <FormattedMessage\n                    id='post_info.comment_icon.tooltip.reply'\n                    defaultMessage='Reply'\n                />\n            </Tooltip>\n        );\n\n        return (\n            <OverlayTrigger\n                delayShow={500}\n                placement='top'\n                overlay={tooltip}\n            >\n                <button\n                    id={`${this.props.location}_commentIcon_${this.props.postId}`}\n                    aria-label={localizeMessage('post_info.comment_icon.tooltip.reply', 'Reply').toLowerCase()}\n                    className={iconStyle + ' color--link style--none ' + this.props.extraClass}\n                    onClick={this.props.handleCommentClick}\n                >\n                    <span className='d-flex'>\n                        <ReplyIcon className='comment-icon'/>\n                        {commentCountSpan}\n                    </span>\n                </button>\n            </OverlayTrigger>\n        );\n    }\n}\n\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {FormattedMessage, injectIntl} from 'react-intl';\nimport {Posts} from 'mattermost-redux/constants/index';\nimport * as ReduxPostUtils from 'mattermost-redux/utils/post_utils';\nimport {Tooltip} from 'react-bootstrap';\n\nimport PostMessageContainer from 'components/post_view/post_message_view';\nimport FileAttachmentListContainer from 'components/file_attachment_list';\nimport CommentIcon from 'components/common/comment_icon';\nimport DotMenu from 'components/dot_menu';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport PostProfilePicture from 'components/post_profile_picture';\nimport UserProfile from 'components/user_profile';\nimport DateSeparator from 'components/post_view/date_separator';\nimport PostBodyAdditionalContent from 'components/post_view/post_body_additional_content';\nimport PostFlagIcon from 'components/post_view/post_flag_icon';\nimport ArchiveIcon from 'components/widgets/icons/archive_icon';\nimport PostTime from 'components/post_view/post_time';\nimport {browserHistory} from 'utils/browser_history';\nimport BotBadge from 'components/widgets/badges/bot_badge';\nimport InfoSmallIcon from 'components/widgets/icons/info_small_icon';\n\nimport Constants, {Locations} from 'utils/constants';\nimport * as PostUtils from 'utils/post_utils.jsx';\nimport {intlShape} from 'utils/react_intl';\nimport * as Utils from 'utils/utils.jsx';\n\nclass SearchResultsItem extends React.PureComponent {\n    static propTypes = {\n\n        /**\n        *  Data used for rendering post\n        */\n        post: PropTypes.object,\n\n        /**\n         * The function to create an aria-label\n         */\n        createAriaLabel: PropTypes.func,\n\n        /**\n        * An array of strings in this post that were matched by the search\n        */\n        matches: PropTypes.array,\n\n        channelName: PropTypes.string,\n        channelType: PropTypes.string,\n        channelIsArchived: PropTypes.bool,\n\n        /**\n        *  Flag for determining result display setting\n        */\n        compactDisplay: PropTypes.bool,\n\n        /**\n        *  Flag for highlighting mentions\n        */\n        isMentionSearch: PropTypes.bool,\n\n        /**\n        *  Flag for highlighting search term\n        */\n        term: PropTypes.string,\n\n        /**\n        *  Flag for determining result flag state\n        */\n        isFlagged: PropTypes.bool,\n\n        /**\n        *  Data used creating URl for jump to post\n        */\n        currentTeamName: PropTypes.string,\n\n        /**\n        *  Data used for delete in DotMenu\n        */\n        commentCountForPost: PropTypes.number,\n\n        /**\n         * Whether post username overrides are to be respected.\n         */\n        enablePostUsernameOverride: PropTypes.bool.isRequired,\n\n        /**\n         * Is the search results item from a bot.\n         */\n        isBot: PropTypes.bool.isRequired,\n\n        a11yIndex: PropTypes.number,\n\n        /**\n        *  Function used for closing LHS\n        */\n        actions: PropTypes.shape({\n            closeRightHandSide: PropTypes.func.isRequired,\n            selectPost: PropTypes.func.isRequired,\n            selectPostCard: PropTypes.func.isRequired,\n            setRhsExpanded: PropTypes.func.isRequired,\n        }).isRequired,\n\n        /**\n         * react-intl helper object\n         */\n        intl: intlShape.isRequired,\n        directTeammate: PropTypes.string.isRequired,\n        displayName: PropTypes.string.isRequired,\n\n        /**\n         * The number of replies in the same thread as this post\n         */\n        replyCount: PropTypes.number,\n    };\n\n    static defaultProps = {\n        isBot: false,\n        channelIsArchived: false,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            dropdownOpened: false,\n        };\n    }\n\n    handleFocusRHSClick = (e) => {\n        e.preventDefault();\n        this.props.actions.selectPost(this.props.post);\n    };\n\n    handleJumpClick = (e) => {\n        e.preventDefault();\n        if (Utils.isMobile()) {\n            this.props.actions.closeRightHandSide();\n        }\n\n        this.props.actions.setRhsExpanded(false);\n        browserHistory.push(`/${this.props.currentTeamName}/pl/${this.props.post.id}`);\n    };\n\n    handleCardClick = (post) => {\n        if (!post) {\n            return;\n        }\n\n        this.props.actions.selectPostCard(post);\n    }\n\n    handleDropdownOpened = (isOpened) => {\n        this.setState({\n            dropdownOpened: isOpened,\n        });\n    };\n\n    renderPostTime = () => {\n        const post = this.props.post;\n\n        const isPermalink = !(Posts.POST_DELETED === post.state ||\n            ReduxPostUtils.isPostPendingOrFailed(post));\n\n        return (\n            <PostTime\n                isPermalink={isPermalink}\n                eventTime={post.create_at}\n                postId={post.id}\n                location={Locations.SEARCH}\n            />\n        );\n    };\n\n    getClassName = () => {\n        let className = 'post post--thread';\n\n        if (this.props.compactDisplay) {\n            className += ' post--compact';\n        }\n\n        if (this.state.dropdownOpened) {\n            className += ' post--hovered';\n        }\n\n        return className;\n    };\n\n    handleSearchItemFocus = () => {\n        this.setState({currentAriaLabel: `${this.getChannelName()}, ${this.props.createAriaLabel(this.props.intl)}`});\n    }\n\n    getChannelName = () => {\n        const {channelType} = this.props;\n        let {channelName} = this.props;\n\n        if (channelType === Constants.DM_CHANNEL) {\n            channelName = this.props.intl.formatMessage({\n                id: 'search_item.direct',\n                defaultMessage: 'Direct Message (with {username})',\n            }, {\n                username: this.props.displayName,\n            });\n        }\n\n        return channelName;\n    }\n\n    render() {\n        const {post, channelIsArchived} = this.props;\n        const channelName = this.getChannelName();\n\n        let overrideUsername;\n        let disableProfilePopover = false;\n        if (post.props &&\n            post.props.from_webhook &&\n            post.props.override_username &&\n            this.props.enablePostUsernameOverride) {\n            overrideUsername = post.props.override_username;\n            disableProfilePopover = true;\n        }\n\n        const profilePic = (\n            <PostProfilePicture\n                compactDisplay={this.props.compactDisplay}\n                post={post}\n                userId={post.user_id}\n            />\n        );\n\n        const profilePicContainer = (<div className='post__img'>{profilePic}</div>);\n\n        let postClass = '';\n        if (PostUtils.isEdited(this.props.post)) {\n            postClass += ' post--edited';\n        }\n\n        let fileAttachment = null;\n        if (post.file_ids && post.file_ids.length > 0) {\n            fileAttachment = (\n                <FileAttachmentListContainer\n                    post={post}\n                    compactDisplay={this.props.compactDisplay}\n                />\n            );\n        }\n\n        let message;\n        let flagContent;\n        let postInfoIcon;\n        let rhsControls;\n        if (post.state === Constants.POST_DELETED || post.state === Posts.POST_DELETED) {\n            message = (\n                <p>\n                    <FormattedMessage\n                        id='post_body.deleted'\n                        defaultMessage='(message deleted)'\n                    />\n                </p>\n            );\n        } else {\n            flagContent = (\n                <PostFlagIcon\n                    location={Locations.SEARCH}\n                    postId={post.id}\n                    isFlagged={this.props.isFlagged}\n                />\n            );\n\n            if (post.props && post.props.card) {\n                postInfoIcon = (\n                    <OverlayTrigger\n                        delayShow={Constants.OVERLAY_TIME_DELAY}\n                        placement='top'\n                        overlay={\n                            <Tooltip>\n                                <FormattedMessage\n                                    id='post_info.info.view_additional_info'\n                                    defaultMessage='View additional info'\n                                />\n                            </Tooltip>\n                        }\n                    >\n                        <button\n                            className='card-icon__container icon--show style--none'\n                            onClick={(e) => {\n                                e.preventDefault();\n                                this.handleCardClick(this.props.post);\n                            }}\n                        >\n                            <InfoSmallIcon\n                                className='icon icon__info'\n                                aria-hidden='true'\n                            />\n                        </button>\n                    </OverlayTrigger>\n                );\n            }\n\n            rhsControls = (\n                <div className='col__controls col__reply'>\n                    <DotMenu\n                        post={post}\n                        location={Locations.SEARCH}\n                        isFlagged={this.props.isFlagged}\n                        handleDropdownOpened={this.handleDropdownOpened}\n                        commentCount={this.props.commentCountForPost}\n                        isReadOnly={channelIsArchived || null}\n                    />\n                    <CommentIcon\n                        location={Locations.SEARCH}\n                        handleCommentClick={this.handleFocusRHSClick}\n                        commentCount={this.props.replyCount}\n                        postId={post.id}\n                        searchStyle={'search-item__comment'}\n                        extraClass={this.props.replyCount ? 'icon--visible' : ''}\n                    />\n                    <a\n                        href='#'\n                        onClick={this.handleJumpClick}\n                        className='search-item__jump'\n                    >\n                        <FormattedMessage\n                            id='search_item.jump'\n                            defaultMessage='Jump'\n                        />\n                    </a>\n                </div>\n            );\n\n            message = (\n                <PostBodyAdditionalContent\n                    post={post}\n                    options={{\n                        searchTerm: this.props.term,\n                        searchMatches: this.props.matches,\n                    }}\n                >\n                    <PostMessageContainer\n                        post={post}\n                        options={{\n                            searchTerm: this.props.term,\n                            searchMatches: this.props.matches,\n                            mentionHighlight: this.props.isMentionSearch,\n                        }}\n                        isRHS={true}\n                    />\n                </PostBodyAdditionalContent>\n            );\n        }\n\n        let pinnedBadge;\n        if (post.is_pinned) {\n            pinnedBadge = (\n                <span className='post__pinned-badge'>\n                    <FormattedMessage\n                        id='post_info.pinned'\n                        defaultMessage='Pinned'\n                    />\n                </span>\n            );\n        }\n\n        const currentPostDay = Utils.getDateForUnixTicks(post.create_at);\n\n        return (\n            <div\n                data-testid='search-item-container'\n                className='search-item__container'\n            >\n                <DateSeparator date={currentPostDay}/>\n                <div\n                    className={`a11y__section ${this.getClassName()}`}\n                    aria-label={this.state.currentAriaLabel}\n                    onFocus={this.handleSearchItemFocus}\n                    data-a11y-sort-order={this.props.a11yIndex}\n                >\n                    <div\n                        className='search-channel__name'\n                        aria-hidden='true'\n                    >\n                        {channelName}\n                        {channelIsArchived &&\n                            <span className='search-channel__archived'>\n                                <ArchiveIcon className='icon icon__archive channel-header-archived-icon svg-text-color'/>\n                                <FormattedMessage\n                                    id='search_item.channelArchived'\n                                    defaultMessage='Archived'\n                                />\n                            </span>\n                        }\n                    </div>\n                    <div\n                        role='application'\n                        className='post__content'\n                    >\n                        {profilePicContainer}\n                        <div>\n                            <div className='post__header'>\n                                <div className='col col__name'>\n                                    <UserProfile\n                                        userId={post.user_id}\n                                        overwriteName={overrideUsername}\n                                        disablePopover={disableProfilePopover}\n                                        isRHS={true}\n                                    />\n                                    <BotBadge show={Boolean(post.props && post.props.from_webhook && !this.props.isBot)}/>\n                                </div>\n                                <div className='col'>\n                                    {this.renderPostTime()}\n                                    {pinnedBadge}\n                                    {postInfoIcon}\n                                    {flagContent}\n                                </div>\n                                {rhsControls}\n                            </div>\n                            <div className='search-item-snippet post__body'>\n                                <div className={postClass}>\n                                    {message}\n                                    {fileAttachment}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default injectIntl(SearchResultsItem);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getUser} from 'mattermost-redux/selectors/entities/users';\nimport {makeGetCommentCountForPost} from 'mattermost-redux/selectors/entities/posts';\nimport {getMyPreferences} from 'mattermost-redux/selectors/entities/preferences';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {isPostFlagged} from 'mattermost-redux/utils/post_utils';\n\nimport {\n    closeRightHandSide,\n    selectPostFromRightHandSideSearch,\n    selectPostCardFromRightHandSideSearch,\n    setRhsExpanded,\n} from 'actions/views/rhs';\n\nimport {makeCreateAriaLabelForPost, makeGetReplyCount} from 'utils/post_utils.jsx';\nimport {getDirectTeammate, getDisplayNameByUser} from 'utils/utils.jsx';\n\nimport SearchResultsItem from './search_results_item.jsx';\n\nfunction mapStateToProps() {\n    const getReplyCount = makeGetReplyCount();\n    const createAriaLabelForPost = makeCreateAriaLabelForPost();\n    const getCommentCountForPost = makeGetCommentCountForPost();\n\n    return (state, ownProps) => {\n        const config = getConfig(state);\n        const preferences = getMyPreferences(state);\n        const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\n        const {post} = ownProps;\n        const user = getUser(state, post.user_id);\n        const channel = getChannel(state, post.channel_id) || {delete_at: 0};\n        const directTeammate = getDirectTeammate(state, channel.id);\n\n        return {\n            createAriaLabel: createAriaLabelForPost(state, post),\n            channelId: channel.id,\n            channelName: channel.display_name,\n            channelType: channel.type,\n            channelIsArchived: channel.delete_at !== 0,\n            currentTeamName: getCurrentTeam(state).name,\n            commentCountForPost: getCommentCountForPost(state, {post}),\n            enablePostUsernameOverride,\n            isFlagged: isPostFlagged(post.id, preferences),\n            isBot: user ? user.is_bot : false,\n            directTeammate,\n            displayName: getDisplayNameByUser(state, directTeammate),\n            replyCount: getReplyCount(state, post),\n        };\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            closeRightHandSide,\n            selectPost: selectPostFromRightHandSideSearch,\n            selectPostCard: selectPostCardFromRightHandSideSearch,\n            setRhsExpanded,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SearchResultsItem);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class DataRetentionHint extends PureComponent {\n    static propTypes = {\n        dataRetentionMessageRetentionDays: PropTypes.string,\n    }\n\n    render() {\n        return (\n            <li>\n                <FormattedMessage\n                    id='search_results.usage.dataRetention'\n                    defaultMessage='Only messages posted in the last {days} days are returned. Contact your System Administrator for more detail.'\n                    values={{\n                        days: this.props.dataRetentionMessageRetentionDays,\n                    }}\n                />\n            </li>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\nimport {FormattedMessage} from 'react-intl';\n\nimport FlagIcon from 'components/widgets/icons/flag_icon';\n\nimport DataRetentionHint from './data_retention_hint';\n\nexport default class FlagPostSearchHint extends PureComponent {\n    static propTypes = {\n        dataRetentionEnableMessageDeletion: PropTypes.bool,\n        dataRetentionMessageRetentionDays: PropTypes.string,\n    }\n\n    render() {\n        return (\n            <React.Fragment>\n                <ul>\n                    <li>\n                        <FormattedMessage\n                            id='search_results.usageFlag1'\n                            defaultMessage=\"You haven't flagged any messages yet.\"\n                        />\n                    </li>\n                    <li>\n                        <FormattedMessage\n                            id='search_results.usageFlag2'\n                            defaultMessage='You can add a flag to messages and comments by clicking the {flagIcon} icon next to the timestamp.'\n                            values={{\n                                flagIcon: <FlagIcon className='usage__icon'/>,\n                            }}\n                        />\n                    </li>\n                    <li>\n                        <FormattedMessage\n                            id='search_results.usageFlag4'\n                            defaultMessage='Flags are a way to mark messages for follow up. Your flags are personal, and cannot be seen by other users.'\n                        />\n                    </li>\n                    {this.props.dataRetentionEnableMessageDeletion &&\n                        <DataRetentionHint dataRetentionMessageRetentionDays={this.props.dataRetentionMessageRetentionDays}/>\n                    }\n                </ul>\n            </React.Fragment>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\nimport {FormattedMessage} from 'react-intl';\n\nimport DataRetentionHint from './data_retention_hint';\n\nexport default class PinPostSearchHint extends PureComponent {\n    static propTypes = {\n        dataRetentionEnableMessageDeletion: PropTypes.bool,\n        dataRetentionMessageRetentionDays: PropTypes.string,\n    }\n\n    render() {\n        return (\n            <React.Fragment>\n                <h4 id='noResultsMessage'>\n                    <FormattedMessage\n                        id='search_results.noResults'\n                        defaultMessage='No results found. Try again?'\n                    />\n                </h4>\n                <ul>\n                    <li>\n                        <FormattedMessage\n                            id='search_results.noResults.partialPhraseSuggestion'\n                            defaultMessage='If you&#39;re searching a partial phrase (ex. searching \"rea\", looking for \"reach\" or \"reaction\"), append a * to your search term.'\n                        />\n                    </li>\n                    <li>\n                        <FormattedMessage\n                            id='search_results.noResults.stopWordsSuggestion'\n                            defaultMessage='Two letter searches and common words like \"this\", \"a\" and \"is\" won&#39;t appear in search results due to the excessive results returned.'\n                        />\n                    </li>\n                    {this.props.dataRetentionEnableMessageDeletion &&\n                        <DataRetentionHint dataRetentionMessageRetentionDays={this.props.dataRetentionMessageRetentionDays}/>\n                    }\n                </ul>\n            </React.Fragment>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\nimport {FormattedMessage} from 'react-intl';\n\nimport DataRetentionHint from './data_retention_hint';\n\nexport default class PinPostSearchHint extends PureComponent {\n    static propTypes = {\n        dataRetentionEnableMessageDeletion: PropTypes.bool,\n        dataRetentionMessageRetentionDays: PropTypes.string,\n    }\n\n    render() {\n        return (\n            <React.Fragment>\n                <ul>\n                    <li>\n                        <FormattedMessage\n                            id='search_results.usagePin1'\n                            defaultMessage='There are no pinned messages yet.'\n                        />\n                    </li>\n                    <li>\n                        <FormattedMessage\n                            id='search_results.usagePin2'\n                            defaultMessage='All members of this channel can pin important or useful messages.'\n                        />\n                    </li>\n                    <li>\n                        <FormattedMessage\n                            id='search_results.usagePin3'\n                            defaultMessage='Pinned messages are visible to all channel members.'\n                        />\n                    </li>\n                    <li>\n                        <FormattedMessage\n                            id='search_results.usagePin4'\n                            defaultMessage={'To pin a message: Go to the message that you want to pin and click [...] > \"Pin to channel\".'}\n                        />\n                    </li>\n                    {this.props.dataRetentionEnableMessageDeletion &&\n                        <DataRetentionHint dataRetentionMessageRetentionDays={this.props.dataRetentionMessageRetentionDays}/>\n                    }\n                </ul>\n            </React.Fragment>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport Scrollbars from 'react-custom-scrollbars';\n\nimport {injectIntl} from 'react-intl';\n\nimport {debounce} from 'mattermost-redux/actions/helpers';\n\nimport {intlShape} from 'utils/react_intl';\nimport * as Utils from 'utils/utils.jsx';\n\nimport SearchResultsHeader from 'components/search_results_header';\nimport SearchResultsItem from 'components/search_results_item';\nimport SearchHint from 'components/search_hint/search_hint';\nimport FlagPostSearchHint from 'components/search_hint/flag_post_search_hint';\nimport NoResultSearchHint from 'components/search_hint/no_result_search_hint';\nimport PinPostSearchHint from 'components/search_hint/pin_post_search_hint';\nimport LoadingSpinner from 'components/widgets/loading/loading_wrapper';\n\nconst GET_MORE_BUFFER = 30;\n\nexport function renderView(props) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--view'\n        />);\n}\n\nexport function renderThumbHorizontal(props) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--horizontal'\n        />);\n}\n\nexport function renderThumbVertical(props) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--vertical'\n        />);\n}\n\nexport function shouldRenderFromPropsAndState(props, nextProps, state, nextState) {\n    // Shallow compare for all props except 'results'\n    for (const key in nextProps) {\n        if (!nextProps.hasOwnProperty(key) || key === 'results') {\n            continue;\n        }\n\n        if (nextProps[key] !== props[key]) {\n            return true;\n        }\n    }\n\n    // Shallow compare state\n    for (const key in nextState) {\n        if (!nextState.hasOwnProperty(key)) {\n            continue;\n        }\n\n        if (nextState[key] !== state[key]) {\n            return true;\n        }\n    }\n\n    // Here we do a slightly deeper compare on 'results' because it is frequently a new\n    // array but without any actual changes\n    const results = props.results;\n    const nextResults = nextProps.results;\n\n    if (results.length !== nextResults.length) {\n        return true;\n    }\n\n    for (let i = 0; i < results.length; i++) {\n        // Only need a shallow compare on each post\n        if (results[i] !== nextResults[i]) {\n            return true;\n        }\n    }\n\n    return false;\n}\nclass SearchResults extends React.Component {\n    static propTypes = {\n        results: PropTypes.array,\n        matches: PropTypes.object,\n        currentUser: PropTypes.object,\n        searchTerms: PropTypes.string,\n        isSearchingTerm: PropTypes.bool,\n        isSearchingFlaggedPost: PropTypes.bool,\n        isSearchingPinnedPost: PropTypes.bool,\n        isSearchGettingMore: PropTypes.bool,\n        isSearchAtEnd: PropTypes.bool,\n        compactDisplay: PropTypes.bool,\n        isMentionSearch: PropTypes.bool,\n        isFlaggedPosts: PropTypes.bool,\n        isPinnedPosts: PropTypes.bool,\n        isCard: PropTypes.bool,\n        channelDisplayName: PropTypes.string.isRequired,\n        dataRetentionEnableMessageDeletion: PropTypes.bool.isRequired,\n        dataRetentionMessageRetentionDays: PropTypes.string,\n        isOpened: PropTypes.bool,\n        actions: PropTypes.shape({\n            getMorePostsForSearch: PropTypes.func.isRequired,\n        }),\n        intl: intlShape.isRequired,\n    };\n\n    static defaultProps = {\n        matches: {},\n        currentUser: {},\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            windowWidth: Utils.windowWidth(),\n            windowHeight: Utils.windowHeight(),\n        };\n    }\n\n    componentDidMount() {\n        this.scrollToTop();\n        window.addEventListener('resize', this.handleResize);\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.handleResize);\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        return shouldRenderFromPropsAndState(this.props, nextProps, this.state, nextState);\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.searchTerms !== prevProps.searchTerms) {\n            this.scrollToTop();\n        }\n    }\n\n    handleResize = () => {\n        this.setState({\n            windowWidth: Utils.windowWidth(),\n            windowHeight: Utils.windowHeight(),\n        });\n    }\n\n    scrollToTop = () => {\n        this.refs.scrollbars.scrollToTop();\n    }\n\n    handleScroll = () => {\n        if (!this.props.isFlaggedPosts && !this.props.isPinnedPosts && !this.props.isSearchingTerm && !this.props.isSearchGettingMore) {\n            const scrollHeight = this.refs.scrollbars.getScrollHeight();\n            const scrollTop = this.refs.scrollbars.getScrollTop();\n            const clientHeight = this.refs.scrollbars.getClientHeight();\n            if ((scrollTop + clientHeight + GET_MORE_BUFFER) >= scrollHeight) {\n                this.loadMorePosts();\n            }\n        }\n    }\n\n    loadMorePosts = debounce(() => {\n        this.props.actions.getMorePostsForSearch();\n    }, 100);\n\n    render() {\n        const results = this.props.results;\n        const noResults = (!results || results.length === 0);\n        const searchTerms = this.props.searchTerms;\n\n        let ctls = null;\n        let loadingMorePostsComponent = null;\n\n        if (\n            this.props.isSearchingTerm ||\n            this.props.isSearchingFlaggedPost ||\n            this.props.isSearchingPinnedPost ||\n            !this.props.isOpened\n        ) {\n            ctls = (\n                <div className='sidebar--right__subheader a11y__section'>\n                    <div className='sidebar--right__loading'>\n                        <LoadingSpinner text={Utils.localizeMessage('search_header.loading', 'Searching')}/>\n                    </div>\n                </div>\n            );\n        } else if (this.props.isFlaggedPosts && noResults) {\n            ctls = (\n                <div className='sidebar--right__subheader a11y__section'>\n                    <FlagPostSearchHint\n                        dataRetentionEnableMessageDeletion={this.props.dataRetentionEnableMessageDeletion}\n                        dataRetentionMessageRetentionDays={this.props.dataRetentionMessageRetentionDays}\n                    />\n                </div>\n            );\n        } else if (this.props.isPinnedPosts && noResults) {\n            ctls = (\n                <div className='sidebar--right__subheader a11y__section'>\n                    <PinPostSearchHint\n                        dataRetentionEnableMessageDeletion={this.props.dataRetentionEnableMessageDeletion}\n                        dataRetentionMessageRetentionDays={this.props.dataRetentionMessageRetentionDays}\n                    />\n                </div>\n            );\n        } else if (!searchTerms && noResults) {\n            ctls = (\n                <div className='sidebar--right__subheader a11y__section'>\n                    <SearchHint/>\n                </div>\n            );\n        } else if (noResults) {\n            ctls = (\n                <div className='sidebar--right__subheader a11y__section'>\n                    <NoResultSearchHint\n                        dataRetentionEnableMessageDeletion={this.props.dataRetentionEnableMessageDeletion}\n                        dataRetentionMessageRetentionDays={this.props.dataRetentionMessageRetentionDays}\n                    />\n                </div>\n            );\n        } else {\n            let sortedResults;\n            if (this.props.isPinnedPosts) {\n                sortedResults = [...results];\n                sortedResults.sort((postA, postB) => postB.create_at - postA.create_at);\n            } else {\n                sortedResults = results;\n            }\n\n            ctls = sortedResults.map((post, index) => {\n                return (\n                    <SearchResultsItem\n                        key={post.id}\n                        compactDisplay={this.props.compactDisplay}\n                        post={post}\n                        matches={this.props.matches[post.id]}\n                        term={(!this.props.isFlaggedPosts && !this.props.isPinnedPosts && !this.props.isMentionSearch) ? searchTerms : ''}\n                        isMentionSearch={this.props.isMentionSearch}\n                        a11yIndex={index}\n                    />\n                );\n            }, this);\n\n            if (!this.props.isSearchAtEnd && !this.props.isFlaggedPosts && !this.props.isPinnedPosts) {\n                loadingMorePostsComponent = (\n                    <div className='loading-screen'>\n                        <div className='loading__content'>\n                            <div className='round round-1'/>\n                            <div className='round round-2'/>\n                            <div className='round round-3'/>\n                        </div>\n                    </div>\n                );\n            }\n        }\n\n        var formattedTitle = this.props.intl.formatMessage({\n            id: 'search_header.results',\n            defaultMessage: 'Search Results',\n        });\n\n        if (this.props.isMentionSearch) {\n            formattedTitle = this.props.intl.formatMessage({\n                id: 'search_header.title2',\n                defaultMessage: 'Recent Mentions',\n            });\n        } else if (this.props.isFlaggedPosts) {\n            formattedTitle = this.props.intl.formatMessage({\n                id: 'search_header.title3',\n                defaultMessage: 'Flagged Posts',\n            });\n        } else if (this.props.isPinnedPosts) {\n            formattedTitle = this.props.intl.formatMessage({\n                id: 'search_header.title4',\n                defaultMessage: 'Pinned Posts in {channelDisplayName}',\n            }, {\n                channelDisplayName: this.props.channelDisplayName,\n            });\n        } else if (this.props.isCard) {\n            formattedTitle = this.props.intl.formatMessage({\n                id: 'search_header.title5',\n                defaultMessage: 'Extra information',\n            });\n        }\n\n        return (\n            <div\n                id='searchContainer'\n                className='sidebar-right__body'\n            >\n                <SearchResultsHeader>\n                    {formattedTitle}\n                </SearchResultsHeader>\n                <Scrollbars\n                    ref='scrollbars'\n                    autoHide={true}\n                    autoHideTimeout={500}\n                    autoHideDuration={500}\n                    renderThumbHorizontal={renderThumbHorizontal}\n                    renderThumbVertical={renderThumbVertical}\n                    renderView={renderView}\n                    onScroll={this.handleScroll}\n                >\n                    <div\n                        id='search-items-container'\n                        role='application'\n                        className='search-items-container post-list__table a11y__region'\n                        data-a11y-sort-order='3'\n                        data-a11y-focus-child={true}\n                        data-a11y-loop-navigation={false}\n                        aria-label={this.props.intl.formatMessage({\n                            id: 'accessibility.sections.rhs',\n                            defaultMessage: '{regionTitle} complimentary region',\n                        }, {\n                            regionTitle: formattedTitle,\n                        })}\n                    >\n                        {ctls}\n                        {loadingMorePostsComponent}\n                    </div>\n                </Scrollbars>\n            </div>\n        );\n    }\n}\n\nexport default injectIntl(SearchResults);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getMorePostsForSearch} from 'mattermost-redux/actions/search';\nimport {getChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getSearchMatches, getSearchResults} from 'mattermost-redux/selectors/entities/posts';\nimport * as PreferenceSelectors from 'mattermost-redux/selectors/entities/preferences';\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\nimport {getCurrentSearchForCurrentTeam} from 'mattermost-redux/selectors/entities/search';\n\nimport {\n    getSearchResultsTerms,\n    getIsSearchingTerm,\n    getIsSearchingFlaggedPost,\n    getIsSearchingPinnedPost,\n    getIsSearchGettingMore,\n} from 'selectors/rhs';\nimport {Preferences} from 'utils/constants.jsx';\n\nimport SearchResults from './search_results.jsx';\n\nfunction makeMapStateToProps() {\n    let results;\n    let posts;\n\n    return function mapStateToProps(state) {\n        const config = getConfig(state);\n\n        const dataRetentionEnableMessageDeletion = config.DataRetentionEnableMessageDeletion === 'true';\n        const dataRetentionMessageRetentionDays = config.DataRetentionMessageRetentionDays;\n        const viewArchivedChannels = config.ExperimentalViewArchivedChannels === 'true';\n\n        const newResults = getSearchResults(state);\n\n        // Cache posts and channels\n        if (newResults && newResults !== results) {\n            results = newResults;\n\n            posts = [];\n            results.forEach((post) => {\n                if (!post) {\n                    return;\n                }\n\n                const channel = getChannel(state, post.channel_id);\n                if (channel && channel.delete_at !== 0 && !viewArchivedChannels) {\n                    return;\n                }\n\n                posts.push(post);\n            });\n        }\n\n        const currentSearch = getCurrentSearchForCurrentTeam(state) || {};\n\n        return {\n            results: posts,\n            matches: getSearchMatches(state),\n            currentUser: getCurrentUser(state),\n            searchTerms: getSearchResultsTerms(state),\n            isSearchingTerm: getIsSearchingTerm(state),\n            isSearchingFlaggedPost: getIsSearchingFlaggedPost(state),\n            isSearchingPinnedPost: getIsSearchingPinnedPost(state),\n            isSearchGettingMore: getIsSearchGettingMore(state),\n            isSearchAtEnd: currentSearch.isEnd,\n            compactDisplay: PreferenceSelectors.get(state, Preferences.CATEGORY_DISPLAY_SETTINGS, Preferences.MESSAGE_DISPLAY, Preferences.MESSAGE_DISPLAY_DEFAULT) === Preferences.MESSAGE_DISPLAY_COMPACT,\n            dataRetentionEnableMessageDeletion,\n            dataRetentionMessageRetentionDays,\n        };\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            getMorePostsForSearch,\n        }, dispatch),\n    };\n}\n\nexport default connect(makeMapStateToProps, mapDispatchToProps)(SearchResults);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport SearchResultsHeader from 'components/search_results_header';\n\nimport Pluggable from 'plugins/pluggable';\n\nexport default class RhsPlugin extends React.PureComponent {\n    static propTypes = {\n        title: PropTypes.oneOfType([\n            PropTypes.string,\n            PropTypes.object,\n        ]),\n        pluggableId: PropTypes.string.isRequired,\n    }\n\n    render() {\n        return (\n            <div\n                id='rhsContainer'\n                className='sidebar-right__body'\n            >\n                <SearchResultsHeader>\n                    {this.props.title}\n                </SearchResultsHeader>\n                <Pluggable\n                    pluggableName='RightHandSidebarComponent'\n                    pluggableId={this.props.pluggableId}\n                />\n            </div>\n        );\n    }\n}\n","\n// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getPluginId} from 'selectors/rhs';\n\nimport RHSPlugin from './rhs_plugin.jsx';\n\nfunction mapStateToProps(state) {\n    const rhsPlugins = state.plugins.components.RightHandSidebarComponent;\n    const pluginId = getPluginId(state);\n\n    const plugin = rhsPlugins.find((element) => element.id === pluginId);\n    const pluginName = plugin ? plugin.title : '';\n\n    return {\n        title: pluginName,\n        pluggableId: pluginId,\n    };\n}\n\nexport default connect(mapStateToProps)(RHSPlugin);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classNames from 'classnames';\n\nimport {trackEvent} from 'actions/diagnostics_actions.jsx';\nimport Constants from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\n\nimport FileUploadOverlay from 'components/file_upload_overlay';\nimport RhsThread from 'components/rhs_thread';\nimport RhsCard from 'components/rhs_card';\nimport SearchBar from 'components/search_bar';\nimport SearchResults from 'components/search_results';\n\nimport RhsPlugin from 'plugins/rhs_plugin';\n\nexport default class SidebarRight extends React.PureComponent {\n    static propTypes = {\n        isExpanded: PropTypes.bool.isRequired,\n        isOpen: PropTypes.bool.isRequired,\n        currentUserId: PropTypes.string.isRequired,\n        channel: PropTypes.object,\n        postRightVisible: PropTypes.bool,\n        postCardVisible: PropTypes.bool,\n        searchVisible: PropTypes.bool,\n        isMentionSearch: PropTypes.bool,\n        isFlaggedPosts: PropTypes.bool,\n        isPinnedPosts: PropTypes.bool,\n        isPluginView: PropTypes.bool,\n        previousRhsState: PropTypes.string,\n        selectedPostId: PropTypes.string,\n        selectedPostCardId: PropTypes.string,\n        actions: PropTypes.shape({\n            setRhsExpanded: PropTypes.func.isRequired,\n            showPinnedPosts: PropTypes.func.isRequired,\n            openRHSSearch: PropTypes.func.isRequired,\n            closeRightHandSide: PropTypes.func.isRequired,\n            openAtPrevious: PropTypes.func.isRequired,\n        }),\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.sidebarRight = React.createRef();\n        this.state = {\n            isOpened: false,\n        };\n    }\n\n    setPrevious = () => {\n        if (!this.props.isOpen) {\n            return;\n        }\n\n        this.previous = {\n            searchVisible: this.props.searchVisible,\n            isMentionSearch: this.props.isMentionSearch,\n            isPinnedPosts: this.props.isPinnedPosts,\n            isFlaggedPosts: this.props.isFlaggedPosts,\n            selectedPostId: this.props.selectedPostId,\n            selectedPostCardId: this.props.selectedPostCardId,\n            previousRhsState: this.props.previousRhsState,\n        };\n    }\n\n    handleShortcut = (e) => {\n        if (Utils.cmdOrCtrlPressed(e) && Utils.isKeyPressed(e, Constants.KeyCodes.PERIOD)) {\n            e.preventDefault();\n            if (this.props.isOpen) {\n                this.props.actions.closeRightHandSide();\n            } else {\n                this.props.actions.openAtPrevious(this.previous);\n            }\n        }\n    }\n\n    componentDidMount() {\n        window.addEventListener('resize', this.determineTransition);\n        document.addEventListener('keydown', this.handleShortcut);\n        this.determineTransition();\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.determineTransition);\n        document.removeEventListener('keydown', this.handleShortcut);\n        if (this.sidebarRight.current) {\n            this.sidebarRight.current.removeEventListener('transitionend', this.onFinishTransition);\n        }\n    }\n\n    componentDidUpdate(prevProps) {\n        const wasOpen = prevProps.searchVisible || prevProps.postRightVisible;\n        const isOpen = this.props.searchVisible || this.props.postRightVisible;\n\n        if (!wasOpen && isOpen) {\n            trackEvent('ui', 'ui_rhs_opened');\n        }\n\n        const {actions, isPinnedPosts, channel} = this.props;\n        if (isPinnedPosts && prevProps.isPinnedPosts === isPinnedPosts && channel.id !== prevProps.channel.id) {\n            actions.showPinnedPosts(channel.id);\n        }\n\n        this.setPrevious();\n    }\n\n    determineTransition = () => {\n        const transitionInfo = window.getComputedStyle(this.sidebarRight.current).getPropertyValue('transition');\n        const hasTransition = Boolean(transitionInfo) && transitionInfo !== 'all 0s ease 0s';\n\n        if (this.sidebarRight.current && hasTransition) {\n            this.setState({isOpened: this.props.isOpen});\n            this.sidebarRight.current.addEventListener('transitionend', this.onFinishTransition);\n        } else {\n            this.setState({isOpened: true});\n            if (this.sidebarRight.current) {\n                this.sidebarRight.current.removeEventListener('transitionend', this.onFinishTransition);\n            }\n        }\n    }\n\n    onFinishTransition = (e) => {\n        if (e.propertyName === 'transform') {\n            this.setState({isOpened: this.props.isOpen});\n        }\n    }\n\n    onShrink = () => {\n        this.props.actions.setRhsExpanded(false);\n    };\n\n    render() {\n        const {\n            channel,\n            currentUserId,\n            isFlaggedPosts,\n            isMentionSearch,\n            isPinnedPosts,\n            postRightVisible,\n            postCardVisible,\n            previousRhsState,\n            searchVisible,\n            isPluginView,\n        } = this.props;\n\n        let content = null;\n        let expandedClass = '';\n\n        if (this.props.isExpanded) {\n            expandedClass = 'sidebar--right--expanded';\n        }\n\n        var searchForm = null;\n        if (currentUserId) {\n            searchForm = (\n                <SearchBar\n                    isFocus={searchVisible && !isFlaggedPosts && !isPinnedPosts}\n                    isSideBarRight={true}\n                />\n            );\n        }\n\n        let channelDisplayName = '';\n        if (channel) {\n            if (channel.type === Constants.DM_CHANNEL || channel.type === Constants.GM_CHANNEL) {\n                channelDisplayName = Utils.localizeMessage('rhs_root.direct', 'Direct Message');\n            } else {\n                channelDisplayName = channel.display_name;\n            }\n        }\n\n        if (searchVisible) {\n            content = (\n                <div className='sidebar--right__content'>\n                    <div className='search-bar__container channel-header alt'>{searchForm}</div>\n                    <SearchResults\n                        isMentionSearch={isMentionSearch}\n                        isFlaggedPosts={isFlaggedPosts}\n                        isPinnedPosts={isPinnedPosts}\n                        toggleSize={this.toggleSize}\n                        shrink={this.onShrink}\n                        channelDisplayName={channelDisplayName}\n                        isOpened={this.state.isOpened}\n                    />\n                </div>\n            );\n        } else if (postRightVisible) {\n            content = (\n                <div className='post-right__container'>\n                    <FileUploadOverlay overlayType='right'/>\n                    <div className='search-bar__container channel-header alt'>{searchForm}</div>\n                    <RhsThread\n                        previousRhsState={previousRhsState}\n                        currentUserId={currentUserId}\n                        toggleSize={this.toggleSize}\n                        shrink={this.onShrink}\n                    />\n                </div>\n            );\n        } else if (isPluginView) {\n            content = (\n                <div className='post-right__container'>\n                    <div className='search-bar__container channel-header alt'>{searchForm}</div>\n                    <RhsPlugin/>\n                </div>\n            );\n        } else if (postCardVisible) {\n            content = (\n                <div className='post-right__container'>\n                    <div className='search-bar__container channel-header alt'>{searchForm}</div>\n                    <RhsCard previousRhsState={previousRhsState}/>\n                </div>\n            );\n        }\n\n        if (!content) {\n            expandedClass = '';\n        }\n\n        return (\n            <div\n                className={classNames('sidebar--right', expandedClass, {'move--left': this.props.isOpen})}\n                id='sidebar-right'\n                role='complementary'\n                ref={this.sidebarRight}\n            >\n                <div\n                    onClick={this.onShrink}\n                    className='sidebar--right__bg'\n                />\n                <div className='sidebar-right-container'>\n                    {content}\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getChannel} from 'mattermost-redux/selectors/entities/channels';\n\nimport {setRhsExpanded, showPinnedPosts, openRHSSearch, closeRightHandSide, openAtPrevious} from 'actions/views/rhs';\nimport {\n    getIsRhsExpanded,\n    getIsRhsOpen,\n    getRhsState,\n    getSelectedPostId,\n    getSelectedPostCardId,\n    getSelectedChannelId,\n    getPreviousRhsState,\n} from 'selectors/rhs';\nimport {RHSStates} from 'utils/constants';\n\nimport SidebarRight from './sidebar_right.jsx';\n\nfunction mapStateToProps(state) {\n    const rhsState = getRhsState(state);\n\n    const channelId = getSelectedChannelId(state);\n\n    let channel = null;\n    if (channelId) {\n        channel = getChannel(state, channelId);\n    }\n\n    const selectedPostId = getSelectedPostId(state);\n    const selectedPostCardId = getSelectedPostCardId(state);\n\n    return {\n        isExpanded: getIsRhsExpanded(state),\n        isOpen: getIsRhsOpen(state),\n        channel,\n        currentUserId: getCurrentUserId(state),\n        postRightVisible: Boolean(selectedPostId),\n        postCardVisible: Boolean(selectedPostCardId),\n        searchVisible: Boolean(rhsState) && rhsState !== RHSStates.PLUGIN,\n        previousRhsState: getPreviousRhsState(state),\n        isMentionSearch: rhsState === RHSStates.MENTION,\n        isFlaggedPosts: rhsState === RHSStates.FLAG,\n        isPinnedPosts: rhsState === RHSStates.PIN,\n        isPluginView: rhsState === RHSStates.PLUGIN,\n        selectedPostId,\n        selectedPostCardId,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            setRhsExpanded,\n            showPinnedPosts,\n            openRHSSearch,\n            closeRightHandSide,\n            openAtPrevious,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SidebarRight);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Overlay} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport {trackEvent} from 'actions/diagnostics_actions.jsx';\nimport Constants from 'utils/constants';\nimport tutorialGif from 'images/tutorialTip.gif';\nimport tutorialGifWhite from 'images/tutorialTipWhite.gif';\n\nconst Preferences = Constants.Preferences;\nconst TutorialSteps = Constants.TutorialSteps;\n\ntype Preference = {\n    user_id: string;\n    category: string;\n    name: string;\n    value: string;\n}\n\ntype Props = {\n    currentUserId: string;\n    step: number;\n    screens: Array<JSX.Element>;\n    placement: string;\n    overlayClass: string;\n    diagnosticsTag?: string;\n    actions: {\n        closeRhsMenu: () => void;\n        savePreferences: (currentUserId: string, preferences: Array<Preference>) => void;\n    };\n}\n\ntype State = {\n    currentScreen: number;\n    show: boolean;\n}\n\nexport default class TutorialTip extends React.Component<Props, State> {\n    public targetRef: React.RefObject<HTMLImageElement>;\n\n    public static defaultProps: Partial<Props> = {\n        overlayClass: '',\n    }\n\n    public constructor(props: Props) {\n        super(props);\n\n        this.state = {\n            currentScreen: 0,\n            show: false\n        };\n\n        this.targetRef = React.createRef();\n    }\n\n    private show = (): void => {\n        this.setState({show: true});\n    }\n\n    private hide = (): void => {\n        this.setState({show: false});\n    }\n\n    public handleNext = (): void => {\n        if (this.state.currentScreen < this.props.screens.length - 1) {\n            this.setState({currentScreen: this.state.currentScreen + 1});\n            return;\n        }\n\n        if (this.props.diagnosticsTag) {\n            let tag = this.props.diagnosticsTag;\n\n            if (this.props.screens.length > 1) {\n                tag += '_' + (this.state.currentScreen + 1).toString();\n            }\n\n            if (this.state.currentScreen === this.props.screens.length - 1) {\n                tag += '_okay';\n            } else {\n                tag += '_next';\n            }\n\n            trackEvent('tutorial', tag);\n        }\n\n        const {currentUserId, actions} = this.props;\n        const {closeRhsMenu, savePreferences} = actions;\n\n        const preferences = [{\n            user_id: currentUserId,\n            category: Preferences.TUTORIAL_STEP,\n            name: currentUserId,\n            value: (this.props.step + 1).toString(),\n        }];\n\n        closeRhsMenu();\n        this.hide();\n\n        savePreferences(currentUserId, preferences);\n    }\n\n    public skipTutorial = (e: React.MouseEvent<HTMLAnchorElement>): void => {\n        e.preventDefault();\n\n        if (this.props.diagnosticsTag) {\n            let tag = this.props.diagnosticsTag;\n            if (this.props.screens.length > 1) {\n                tag += '_' + this.state.currentScreen;\n            }\n            tag += '_skip';\n            trackEvent('tutorial', tag);\n        }\n\n        const {currentUserId, actions} = this.props;\n        const preferences = [{\n            user_id: currentUserId,\n            category: Preferences.TUTORIAL_STEP,\n            name: currentUserId,\n            value: TutorialSteps.FINISHED.toString(),\n        }];\n\n        actions.savePreferences(currentUserId, preferences);\n    }\n\n    private handleCircleClick = (e: React.MouseEvent<HTMLAnchorElement>, screen: number): void => {\n        e.preventDefault();\n        this.setState({currentScreen: screen});\n    }\n\n    private getTarget = (): HTMLImageElement | null => {\n        return this.targetRef.current;\n    }\n\n    public render(): JSX.Element {\n        const buttonText = this.state.currentScreen === this.props.screens.length - 1 ?\n            (\n                <FormattedMessage\n                    id='tutorial_tip.ok'\n                    defaultMessage='Okay'\n                />\n            ) :\n            (\n                <FormattedMessage\n                    id='tutorial_tip.next'\n                    defaultMessage='Next'\n                />\n            );\n\n        const dots = [];\n        if (this.props.screens.length > 1) {\n            for (let i = 0; i < this.props.screens.length; i++) {\n                let className = 'circle';\n                if (i === this.state.currentScreen) {\n                    className += ' active';\n                }\n\n                dots.push(\n                    <a\n                        href='#'\n                        key={'dotactive' + i}\n                        className={className}\n                        data-screen={i}\n                        onClick={(e) => this.handleCircleClick(e, i)}\n                    />\n                );\n            }\n        }\n\n        let tutorialGifImage = tutorialGif;\n        if (this.props.overlayClass === 'tip-overlay--header' || this.props.overlayClass === 'tip-overlay--sidebar' || this.props.overlayClass === 'tip-overlay--header--up') {\n            tutorialGifImage = tutorialGifWhite;\n        }\n\n        return (\n            <div\n                id='tipButton'\n                className={'tip-div ' + this.props.overlayClass}\n                onClick={this.show}\n            >\n                <img\n                    alt={'tutorial tip'}\n                    className='tip-button'\n                    src={tutorialGifImage}\n                    width='35'\n                    onClick={this.show}\n                    ref={this.targetRef}\n                />\n\n                <Overlay\n                    show={this.state.show}\n                >\n                    <div className='tip-backdrop'/>\n                </Overlay>\n\n                <Overlay\n                    placement={this.props.placement}\n                    show={this.state.show}\n                    rootClose={true}\n                    onHide={this.hide}\n                    target={this.getTarget}\n                >\n                    <div className={'tip-overlay ' + this.props.overlayClass}>\n                        <div className='arrow'/>\n                        {this.props.screens[this.state.currentScreen]}\n                        <div className='tutorial__footer'>\n                            <div className='tutorial__circles'>{dots}</div>\n                            <div className='text-right'>\n                                <button\n                                    id='tipNextButton'\n                                    className='btn btn-primary'\n                                    onClick={this.handleNext}\n                                >\n                                    {buttonText}\n                                </button>\n                                <div className='tip-opt'>\n                                    <FormattedMessage\n                                        id='tutorial_tip.seen'\n                                        defaultMessage='Seen this before? '\n                                    />\n                                    <a\n                                        href='#'\n                                        onClick={this.skipTutorial}\n                                    >\n                                        <FormattedMessage\n                                            id='tutorial_tip.out'\n                                            defaultMessage='Opt out of these tips.'\n                                        />\n                                    </a>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </Overlay>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getInt} from 'mattermost-redux/selectors/entities/preferences';\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\n\nimport {closeMenu as closeRhsMenu} from 'actions/views/rhs';\nimport {Preferences} from 'utils/constants';\n\nimport TutorialTip from './tutorial_tip';\n\nfunction mapStateToProps(state) {\n    const currentUserId = getCurrentUserId(state);\n    return {\n        currentUserId,\n        step: getInt(state, Preferences.TUTORIAL_STEP, currentUserId, 0),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            closeRhsMenu,\n            savePreferences,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TutorialTip);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {FormattedMessage} from 'react-intl';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message.jsx';\n\nimport TutorialTip from './tutorial_tip';\n\nconst MenuTutorialTip = ({toggleFunc, onBottom}) => {\n    const screens = [];\n\n    screens.push(\n        <div>\n            <h4>\n                <FormattedMessage\n                    id='sidebar_header.tutorial.title'\n                    defaultMessage='Main Menu'\n                />\n            </h4>\n            <p>\n                <FormattedMarkdownMessage\n                    id='sidebar_header.tutorial.body1'\n                    defaultMessage='The **Main Menu** is where you can **Invite New Members**, access your **Account Settings** and set your **Theme Color**.'\n                />\n            </p>\n            <p>\n                <FormattedMarkdownMessage\n                    id='sidebar_header.tutorial.body2'\n                    defaultMessage='Team administrators can also access their **Team Settings** from this menu.'\n                />\n            </p>\n            <p>\n                <FormattedMarkdownMessage\n                    id='sidebar_header.tutorial.body3'\n                    defaultMessage='System administrators will find a **System Console** option to administrate the entire system.'\n                />\n            </p>\n        </div>\n    );\n\n    let placement = 'right';\n    let arrow = 'left';\n    if (onBottom) {\n        placement = 'bottom';\n        arrow = 'up';\n    }\n\n    return (\n        <div\n            onClick={toggleFunc}\n        >\n            <TutorialTip\n                placement={placement}\n                screens={screens}\n                overlayClass={'tip-overlay--header--' + arrow}\n                diagnosticsTag='tutorial_tip_3_main_menu'\n            />\n        </div>\n    );\n};\n\nMenuTutorialTip.propTypes = {\n    toggleFunc: PropTypes.func,\n    onBottom: PropTypes.bool.isRequired,\n};\n\nexport default MenuTutorialTip;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport * as TeamActions from 'mattermost-redux/actions/teams';\nimport {getTeamMember} from 'mattermost-redux/selectors/entities/teams';\nimport {getChannelMembersInChannels} from 'mattermost-redux/selectors/entities/channels';\nimport {joinChannel} from 'mattermost-redux/actions/channels';\n\nimport {addUsersToTeam} from 'actions/team_actions';\n\nimport {t} from 'utils/i18n';\nimport {isGuest, localizeMessage} from 'utils/utils';\n\nexport function sendMembersInvites(teamId, users, emails) {\n    return async (dispatch, getState) => {\n        if (users.length > 0) {\n            await dispatch(TeamActions.getTeamMembersByIds(teamId, users.map((u) => u.id)));\n        }\n        const state = getState();\n        const sent = [];\n        const notSent = [];\n        const usersToAdd = [];\n        for (const user of users) {\n            const member = getTeamMember(state, teamId, user.id);\n            if (isGuest(user)) {\n                notSent.push({user, reason: localizeMessage('invite.members.user-is-guest', 'Contact your admin to make this guest a full member.')});\n            } else if (member) {\n                notSent.push({user, reason: localizeMessage('invite.members.already-member', 'This person is already a team member.')});\n            } else {\n                usersToAdd.push(user);\n            }\n        }\n        if (usersToAdd.length > 0) {\n            const response = await dispatch(addUsersToTeam(teamId, usersToAdd.map((u) => u.id)));\n            const members = response.data || [];\n            for (const userToAdd of usersToAdd) {\n                const memberWithError = members.find((m) => m.user_id === userToAdd.id && m.error);\n                if (memberWithError) {\n                    notSent.push({user: userToAdd, reason: memberWithError.error.message});\n                } else {\n                    sent.push({user: userToAdd, reason: localizeMessage('invite.members.added-to-team', 'This member has been added to the team.')});\n                }\n            }\n        }\n        if (emails.length > 0) {\n            let response;\n            try {\n                response = await dispatch(TeamActions.sendEmailInvitesToTeamGracefully(teamId, emails));\n            } catch (e) {\n                response = {data: emails.map((email) => ({email, error: {error: localizeMessage('invite.members.unable-to-add-the-user-to-the-team', 'Unable to add the user to the team.')}}))};\n            }\n            const invitesWithErrors = response.data || [];\n            for (const email of emails) {\n                const inviteWithError = invitesWithErrors.find((i) => email === i.email && i.error);\n                if (inviteWithError) {\n                    notSent.push({email, reason: inviteWithError.error.message});\n                } else {\n                    sent.push({email, reason: localizeMessage('invite.members.invite-sent', 'An invitation email has been sent.')});\n                }\n            }\n        }\n        return {sent, notSent};\n    };\n}\n\nexport async function sendGuestInviteForUser(dispatch, user, teamId, channels, members) {\n    if (!isGuest(user)) {\n        return {notSent: {user, reason: localizeMessage('invite.members.user-is-not-guest', 'This person is already a member.')}};\n    }\n    let memberOfAll = true;\n    let memberOfAny = false;\n\n    for (const channel of channels) {\n        const member = members && members[channel] && members[channel][user.id];\n        if (member) {\n            memberOfAny = true;\n        } else {\n            memberOfAll = false;\n        }\n    }\n\n    if (memberOfAll) {\n        return {notSent: {user, reason: localizeMessage('invite.guests.already-all-channels-member', 'This person is already a member of all the channels.')}};\n    }\n\n    try {\n        await dispatch(addUsersToTeam(teamId, [user.id]));\n        for (const channel of channels) {\n            const member = members && members[channel] && members[channel][user.id];\n            if (!member) {\n                await dispatch(joinChannel(user.id, teamId, channel)); // eslint-disable-line no-await-in-loop\n            }\n        }\n    } catch (e) {\n        return {notSent: {user, reason: localizeMessage('invite.guests.unable-to-add-the-user-to-the-channels', 'Unable to add the guest to the channels.')}};\n    }\n\n    if (memberOfAny) {\n        return {notSent: {user, reason: localizeMessage('invite.guests.already-some-channels-member', 'This person is already a member of some of the channels.')}};\n    }\n    return {sent: {user, reason: {id: t('invite.guests.new-member'), message: 'This guest has been added to the team and {count, plural, one {channel} other {channels}}.', values: {count: channels.length}}}};\n}\n\nexport function sendGuestsInvites(teamId, channels, users, emails, message) {\n    return async (dispatch, getState) => {\n        if (users.length > 0) {\n            await dispatch(TeamActions.getTeamMembersByIds(teamId, users.map((u) => u.id)));\n        }\n        const state = getState();\n        const sent = [];\n        const notSent = [];\n        const members = getChannelMembersInChannels(state);\n        const results = await Promise.all(users.map((user) => sendGuestInviteForUser(dispatch, user, teamId, channels, members)));\n\n        for (const result of results) {\n            if (result.sent) {\n                sent.push(result.sent);\n            }\n            if (result.notSent) {\n                notSent.push(result.notSent);\n            }\n        }\n\n        if (emails.length > 0) {\n            let response;\n            try {\n                response = await dispatch(TeamActions.sendEmailGuestInvitesToChannelsGracefully(teamId, channels, emails, message));\n            } catch (e) {\n                response = {data: emails.map((email) => ({email, error: {error: localizeMessage('invite.guests.unable-to-add-the-user-to-the-channels', 'Unable to add the guest to the channels.')}}))};\n            }\n\n            for (const res of (response.data || [])) {\n                if (res.error) {\n                    notSent.push({email: res.email, reason: res.error.message});\n                } else {\n                    sent.push({email: res.email, reason: localizeMessage('invite.guests.added-to-channel', 'An invitation email has been sent.')});\n                }\n            }\n        }\n        return {sent, notSent};\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class CloseIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.close'\n                    defaultMessage='Close Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='24px'\n                            height='24px'\n                            viewBox='0 0 24 24'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path\n                                fillRule='nonzero'\n                                d='M18 7.209L16.791 6 12 10.791 7.209 6 6 7.209 10.791 12 6 16.791 7.209 18 12 13.209 16.791 18 18 16.791 13.209 12z'\n                            />\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class BackIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.back'\n                    defaultMessage='Back Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='24px'\n                            height='24px'\n                            viewBox='0 0 24 24'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path d='M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {CSSTransition} from 'react-transition-group';\nimport {injectIntl} from 'react-intl';\n\nimport CloseIcon from 'components/widgets/icons/close_icon';\nimport BackIcon from 'components/widgets/icons/back_icon';\n\nimport './full_screen_modal.scss';\n\n// This must be on sync with the animation time in ./full_screen_modal.scss\nconst ANIMATION_DURATION = 100;\n\ntype Props = {\n    show: boolean;\n    onClose: () => void;\n    onGoBack?: () => void;\n    children: React.ReactNode;\n    ariaLabel?: string;\n    ariaLabelledBy?: string;\n    intl: any; // TODO This needs to be replaced with IntlShape once react-intl is upgraded\n};\n\nclass FullScreenModal extends React.Component<Props> {\n    private modal = React.createRef<HTMLDivElement>();\n\n    public componentDidMount() {\n        document.addEventListener('keydown', this.handleKeypress);\n        document.addEventListener('focus', this.enforceFocus, true);\n        this.enforceFocus();\n    }\n\n    public componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleKeypress);\n        document.removeEventListener('focus', this.enforceFocus, true);\n    }\n\n    public enforceFocus = () => {\n        setTimeout(() => {\n            const currentActiveElement = document.activeElement;\n            if (this.modal && this.modal.current && !this.modal.current.contains(currentActiveElement)) {\n                this.modal.current.focus();\n            }\n        });\n    }\n\n    private handleKeypress = (e: KeyboardEvent) => {\n        if (e.key === 'Escape' && this.props.show) {\n            this.close();\n        }\n    }\n\n    private close = () => {\n        this.props.onClose();\n    }\n\n    public render() {\n        return (\n            <CSSTransition\n                in={this.props.show}\n                classNames='FullScreenModal'\n                mountOnEnter={true}\n                unmountOnExit={true}\n                timeout={ANIMATION_DURATION}\n                appear={true}\n            >\n                <>\n                    <div\n                        className='FullScreenModal'\n                        ref={this.modal}\n                        tabIndex={-1}\n                        aria-modal={true}\n                        aria-label={this.props.ariaLabel}\n                        aria-labelledby={this.props.ariaLabelledBy}\n                        role='dialog'\n                    >\n                        {this.props.onGoBack &&\n                            <button\n                                onClick={this.props.onGoBack}\n                                className='back'\n                                aria-label={this.props.intl.formatMessage({id: 'full_screen_modal.back', defaultMessage: 'Back'})}\n                            >\n                                <BackIcon id='backIcon'/>\n                            </button>}\n                        <button\n                            onClick={this.close}\n                            className='close-x'\n                            aria-label={this.props.intl.formatMessage({id: 'full_screen_modal.close', defaultMessage: 'Close'})}\n                        >\n                            <CloseIcon id='closeIcon'/>\n                        </button>\n                        {this.props.children}\n                    </div>\n                    <div\n                        tabIndex={0}\n                        style={{display: 'none'}}\n                    />\n                </>\n            </CSSTransition>\n        );\n    }\n}\n\nconst wrappedComponent = injectIntl(FullScreenModal, {forwardRef: true});\nwrappedComponent.displayName = 'injectIntl(FullScreenModal)';\nexport default wrappedComponent;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\n\nexport default class RootPortal extends React.Component {\n    static propTypes = {\n        children: PropTypes.node,\n    }\n\n    constructor(props) {\n        super(props);\n        this.el = document.createElement('div');\n    }\n\n    componentDidMount() {\n        const rootPortal = document.getElementById('root-portal');\n        if (rootPortal) {\n            rootPortal.appendChild(this.el);\n        }\n    }\n\n    componentWillUnmount() {\n        const rootPortal = document.getElementById('root-portal');\n        if (rootPortal) {\n            rootPortal.removeChild(this.el);\n        }\n    }\n\n    render() {\n        return ReactDOM.createPortal(\n            this.props.children,\n            this.el,\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class InviteIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.invite'\n                    defaultMessage='Invite Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='126px'\n                            height='32px'\n                            viewBox='0 0 126 32'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path d='M 106,18 86,5.52 V 4 c 0,-2.22 1.78,-4 4,-4 h 32 c 2.20914,0 4,1.790861 4,4 v 1.5 z m 20,10 c 0,2.209139 -1.79086,4 -4,4 H 90 c -2.22,0 -4,-1.8 -4,-4 V 10.22 l 4,2.5 V 28 h 32 V 12.72 l 4,-2.5 z M 1,15 h 62 c 0.552285,0 1,0.447715 1,1 0,0.552285 -0.447715,1 -1,1 H 1 C 0.44771525,17 0,16.552285 0,16 0,15.447715 0.44771525,15 1,15 Z M 21,5 h 48 c 0.552285,0 1,0.447715 1,1 0,0.552285 -0.447715,1 -1,1 H 21 C 20.447715,7 20,6.552285 20,6 20,5.447715 20.447715,5 21,5 Z m 0,20 h 48 c 0.552285,0 1,0.447715 1,1 0,0.552285 -0.447715,1 -1,1 H 21 c -0.552285,0 -1,-0.447715 -1,-1 0,-0.552285 0.447715,-1 1,-1 z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {FormattedMessage} from 'react-intl';\n\nexport default class ArrowRightIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.channel.arrow-right'\n                    defaultMessage='Arrow right'\n                >\n                    {(title) => (\n                        <svg\n                            width='24px'\n                            height='24px'\n                            viewBox='0 0 24 24'\n                            role='img'\n                            title={title}\n                        >\n                            <path d='M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\nimport InviteIcon from 'components/widgets/icons/invite_icon';\nimport ArrowRightIcon from 'components/widgets/icons/arrow_right_icon';\n\nimport './invitation_modal_initial_step.scss';\n\nexport default class InvitationModalInitialStep extends React.Component {\n    static propTypes = {\n        teamName: PropTypes.string.isRequired,\n        goToMembers: PropTypes.func.isRequired,\n        goToGuests: PropTypes.func.isRequired,\n        emailInvitationsEnabled: PropTypes.bool.isRequired,\n    }\n\n    onMembersKeyDown = (e) => {\n        const code = e.which;\n        if ((code === 13) || (code === 32)) {\n            this.props.goToMembers();\n        }\n    }\n\n    onGuestsKeyDown = (e) => {\n        const code = e.which;\n        if ((code === 13) || (code === 32)) {\n            this.props.goToGuests();\n        }\n    }\n\n    render() {\n        const teamName = this.props.teamName;\n        return (\n            <div className='InvitationModalInitialStep'>\n                <div className='modal-icon'>\n                    <InviteIcon/>\n                </div>\n                <h1 id='invitation_modal_title'>\n                    <FormattedMarkdownMessage\n                        id='invitation_modal.title'\n                        defaultMessage='Invite people to **{teamName}**'\n                        values={{teamName}}\n                    />\n                </h1>\n                <div\n                    className='invitation-modal-option'\n                    onClick={this.props.goToMembers}\n                    data-testid='inviteMembersLink'\n                    tabIndex='0'\n                    onKeyDown={this.onMembersKeyDown}\n                    aria-labelledby='inviteMembersSectionHeader'\n                    aria-describedby='inviteMembersSectionDescription'\n                >\n                    <div data-testid='inviteMembersSection'>\n                        <h2 id='inviteMembersSectionHeader'>\n                            <FormattedMarkdownMessage\n                                id='invitation_modal.invite_members.title'\n                                defaultMessage='Invite **Members**'\n                            />\n                        </h2>\n                        {this.props.emailInvitationsEnabled &&\n                        <FormattedMessage\n                            id='invitation_modal.invite_members.description'\n                            defaultMessage='Invite new team members with a link or by email. Team members have access to messages and files in open teams and public channels.'\n                        >\n                            {(text) => (<span id='inviteMembersSectionDescription'>{text}</span>)}\n                        </FormattedMessage>\n                        }\n                        {!this.props.emailInvitationsEnabled &&\n                        <FormattedMessage\n                            id='invitation_modal.invite_members.description-email-disabled'\n                            defaultMessage='Invite new team members with a link. Team members have access to messages and files in open teams and public channels.'\n                        >\n                            {(text) => (<span id='inviteMembersSectionDescription'>{text}</span>)}\n                        </FormattedMessage>\n                        }\n                    </div>\n                    <ArrowRightIcon className='arrow'/>\n                </div>\n                <div\n                    className='invitation-modal-option'\n                    onClick={this.props.goToGuests}\n                    data-testid='inviteGuestLink'\n                    tabIndex='0'\n                    onKeyDown={this.onGuestsKeyDown}\n                    aria-labelledby='inviteGuestsSectionHeader'\n                    aria-describedby='inviteGuestsSectionDescription'\n                >\n                    <div>\n                        <h2 id='inviteGuestsSectionHeader'>\n                            <FormattedMarkdownMessage\n                                id='invitation_modal.invite_guests.title'\n                                defaultMessage='Invite **Guests**'\n                            />\n                        </h2>\n                        <FormattedMessage\n                            id='invitation_modal.invite_guests.description'\n                            defaultMessage='Invite guests to one or more channels. Guests only have access to messages, files, and people in the channels they are members of.'\n                        >\n                            {(text) => (<span id='inviteGuestsSectionDescription'>{text}</span>)}\n                        </FormattedMessage>\n                    </div>\n                    <ArrowRightIcon className='arrow'/>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class InviteMembersIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.invite_members'\n                    defaultMessage='Invite Members Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='126px'\n                            height='38px'\n                            viewBox='0 0 126 38'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path d='M 108.83398 0.03515625 C 108.64165 0.03515625 108.4496 0.04983111 108.25977 0.08203125 C 109.08339 0.57981559 109.86736 1.165576 110.60156 1.8359375 C 113.34699 4.3426243 115.07813 7.1515117 115.07812 10.777344 L 115.07812 15.908203 C 115.07812 17.577458 114.81586 19.392207 114.32812 21.453125 C 114.19039 22.035006 114.02467 22.601886 113.83008 23.152344 C 116.57398 24.811724 118.17106 25.88194 118.62109 26.361328 C 120.0119 27.842823 120.78516 29.798054 120.78516 31.830078 L 120.78516 32 C 122.99178 32 124.78125 32.008356 124.78125 30.001953 C 124.78125 26.755542 122.78085 23.90476 118.77734 21.453125 L 118.46875 21.267578 L 118.46094 21.285156 C 118.44384 21.330296 118.43871 21.318446 118.44531 21.253906 L 118.46875 21.267578 L 118.47266 21.251953 C 118.52056 21.104379 118.6246 20.690139 118.78516 20.011719 C 119.2074 18.22759 119.07227 17.224165 119.07227 15.908203 L 119.07227 10.777344 C 119.07227 8.5210935 117.78998 3.8565489 115.79297 2.0332031 C 113.81134 0.22387865 111.50192 0.03515625 108.83594 0.03515625 L 108.83398 0.03515625 z M 100.84375 2.0332031 C 98.23721 2.0332031 95.848767 2.9659792 93.835938 4.7363281 C 91.761167 6.5611731 90.535156 8.4793085 90.535156 10.777344 L 90.535156 15.908203 C 90.535156 17.293336 90.80759 18.870238 91.328125 20.703125 C 91.751681 22.194536 92.389981 23.518449 93.25 24.634766 L 87.810547 27.792969 C 87.734577 27.827779 87.659451 27.865141 87.585938 27.904297 C 87.562827 27.916627 87.538385 27.928746 87.515625 27.941406 C 87.254658 28.067724 87.009242 28.216755 86.775391 28.382812 L 86.509766 28.574219 C 85.454567 29.323561 84.826172 30.535879 84.826172 31.830078 L 84.826172 33.994141 C 84.826172 36.20075 86.615661 37.992188 88.822266 37.992188 L 112.79492 37.992188 C 115.00153 37.992188 116.79102 36.20075 116.79102 33.994141 L 116.79102 31.830078 C 116.79102 30.814065 116.40241 29.834497 115.70703 29.09375 C 115.33382 28.696209 114.89968 28.36777 114.42188 28.113281 L 114.13867 27.962891 C 114.10527 27.945041 114.06897 27.932866 114.03516 27.916016 C 113.99746 27.894746 113.96392 27.869949 113.92578 27.849609 L 108.53711 24.673828 C 109.43906 23.498248 110.06724 22.107856 110.43945 20.535156 C 110.86169 18.751027 111.08203 17.224166 111.08203 15.908203 L 111.08203 10.777344 C 111.08203 8.5210941 109.90325 6.6104541 107.90625 4.7871094 C 105.92461 2.977785 103.50974 2.0332043 100.84375 2.0332031 z M 100.84375 6.0273438 C 102.50853 6.0273438 103.96628 6.5982778 105.21484 7.7382812 C 106.46343 8.878286 107.08789 9.8906745 107.08789 10.777344 L 107.08789 15.908203 C 107.08789 16.870874 106.90948 18.105944 106.55273 19.613281 C 106.19601 21.12062 105.52977 22.279175 104.55469 23.089844 C 104.24552 23.343181 104.012 23.661015 103.85742 24.041016 C 103.70244 24.421017 103.65168 24.811463 103.69922 25.216797 C 103.72302 25.622132 103.84065 25.997842 104.05469 26.339844 C 104.26872 26.681846 104.54401 26.953582 104.87695 27.15625 L 112.04492 31.375 C 112.09262 31.40033 112.13432 31.425832 112.16992 31.451172 C 112.20552 31.476502 112.23401 31.488281 112.25781 31.488281 L 112.54297 31.640625 C 112.63817 31.691295 112.72361 31.754092 112.79492 31.830078 L 112.79492 33.994141 L 88.822266 33.994141 L 88.822266 31.830078 L 89.089844 31.640625 C 89.196862 31.564625 89.297447 31.513613 89.392578 31.488281 C 89.416398 31.462951 89.439071 31.442357 89.462891 31.429688 C 89.486711 31.416988 89.513289 31.412109 89.537109 31.412109 L 96.921875 27.117188 C 97.254845 26.939854 97.526184 26.681846 97.740234 26.339844 C 97.954274 25.997845 98.073886 25.622132 98.097656 25.216797 C 98.145256 24.811463 98.089577 24.421017 97.935547 24.041016 C 97.780967 23.661012 97.562734 23.343179 97.277344 23.089844 C 96.302254 22.279177 95.599958 21.120619 95.171875 19.613281 C 94.743792 18.105943 94.529297 16.870874 94.529297 15.908203 L 94.529297 10.777344 C 94.529297 9.8906751 95.178468 8.8782834 96.474609 7.7382812 C 97.770749 6.5982776 99.22654 6.0273453 100.84375 6.0273438 z M 21 7.9707031 C 20.447715 7.9707031 20 8.4184181 20 8.9707031 C 20 9.5229881 20.447715 9.9707031 21 9.9707031 L 69 9.9707031 C 69.552285 9.9707031 70 9.5229881 70 8.9707031 C 70 8.4184181 69.552285 7.9707031 69 7.9707031 L 21 7.9707031 z M 1 17.970703 C 0.4477153 17.970703 -2.220446e-16 18.418418 0 18.970703 C 0 19.522988 0.4477153 19.970703 1 19.970703 L 63 19.970703 C 63.552285 19.970703 64 19.522988 64 18.970703 C 64 18.418418 63.552285 17.970703 63 17.970703 L 1 17.970703 z M 21 27.970703 C 20.447715 27.970703 20 28.418418 20 28.970703 C 20 29.522988 20.447715 29.970703 21 29.970703 L 69 29.970703 C 69.552285 29.970703 70 29.522988 70 28.970703 C 70 28.418418 69.552285 27.970703 69 27.970703 L 21 27.970703 z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class MailIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.mail'\n                    defaultMessage='Mail Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='24px'\n                            height='24px'\n                            viewBox='0 0 24 24'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path d='M4,4H20A2,2 0 0,1 22,6V18A2,2 0 0,1 20,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4M12,11L20,6H4L12,11M4,18H20V8.37L12,13.36L4,8.37V18Z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class MailPlusIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.add-mail'\n                    defaultMessage='Add Mail Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='24px'\n                            height='24px'\n                            viewBox='0 0 24 24'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path d='M3,4C1.89,4 1,4.89 1,6V18A2,2 0 0,0 3,20H14V18H3V8.37L11,13.36L19,8.37V13H21V6A2,2 0 0,0 19,4H3M3,6H19L11,11L3,6M19,15V18H16V20H19V23H21V20H24V18H21V15H19Z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class CloseCircleSolidIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.close'\n                    defaultMessage='Close Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='16px'\n                            height='16px'\n                            viewBox='0 0 16 16'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path\n                                d='m 8,0 c 4.424,0 8,3.576 8,8 0,4.424 -3.576,8 -8,8 C 3.576,16 0,12.424 0,8 0,3.576 3.576,0 8,0 Z M 10.872,4 8,6.872 5.128,4 4,5.128 6.872,8 4,10.872 5.128,12 8,9.128 10.872,12 12,10.872 9.128,8 12,5.128 Z'\n                            />\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport AsyncSelect from 'react-select/lib/AsyncCreatable';\nimport {components} from 'react-select';\nimport classNames from 'classnames';\n\nimport {isEmail} from 'mattermost-redux/utils/helpers';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\nimport MailIcon from 'components/widgets/icons/mail_icon';\nimport MailPlusIcon from 'components/widgets/icons/mail_plus_icon';\nimport CloseCircleSolidIcon from 'components/widgets/icons/close_circle_solid_icon';\nimport GuestBadge from 'components/widgets/badges/guest_badge';\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\nimport Avatar from 'components/widgets/users/avatar';\nimport {imageURLForUser, getDisplayName, getLongDisplayNameParts} from 'utils/utils.jsx';\n\nimport {t} from 'utils/i18n.jsx';\nimport {isGuest} from 'utils/utils';\n\nimport './users_emails_input.scss';\n\nexport default class UsersEmailsInput extends React.Component {\n    static propTypes = {\n        placeholder: PropTypes.string,\n        ariaLabel: PropTypes.string.isRequired,\n        usersLoader: PropTypes.func,\n        onChange: PropTypes.func,\n        value: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.object, PropTypes.string])),\n        onInputChange: PropTypes.func,\n        inputValue: PropTypes.string,\n        noMatchMessageId: PropTypes.string,\n        noMatchMessageDefault: PropTypes.string,\n        validAddressMessageId: PropTypes.string,\n        validAddressMessageDefault: PropTypes.string,\n        loadingMessageId: PropTypes.string,\n        loadingMessageDefault: PropTypes.string,\n        emailInvitationsEnabled: PropTypes.bool,\n    }\n\n    static defaultProps = {\n        noMatchMessageId: t('widgets.users_emails_input.no_user_found_matching'),\n        noMatchMessageDefault: 'No one found matching **{text}**, type email address',\n        validAddressMessageId: t('widgets.users_emails_input.valid_email'),\n        validAddressMessageDefault: 'Add **{email}**',\n        loadingMessageId: t('widgets.users_emails_input.loading'),\n        loadingMessageDefault: 'Loading',\n    };\n\n    constructor(props) {\n        super(props);\n        this.selectRef = React.createRef();\n        this.state = {\n            options: [],\n        };\n    }\n\n    renderUserName = (user) => {\n        const parts = getLongDisplayNameParts(user);\n        let fullName = null;\n        if (parts.fullName) {\n            fullName = (<span className='fullname'>{parts.fullName}</span>);\n        }\n        let nickname = null;\n        if (parts.nickname) {\n            nickname = (<span className='nickname'>{parts.nickname}</span>);\n        }\n\n        return (\n            <>\n                {parts.displayName}\n                {fullName}\n                {nickname}\n            </>\n        );\n    }\n\n    loadingMessage = () => {\n        const text = (\n            <FormattedMessage\n                id={this.props.loadingMessageId}\n                defaultMessage={this.props.loadingMessageDefault}\n            />\n        );\n\n        return (<LoadingSpinner text={text}/>);\n    }\n\n    getOptionValue = (user) => {\n        return user.id || user.value;\n    }\n\n    formatOptionLabel = (user, options) => {\n        const profileImg = imageURLForUser(user.id, user.last_picture_update);\n        let guestBadge = null;\n        if (!isEmail(user.value) && isGuest(user)) {\n            guestBadge = <GuestBadge/>;\n        }\n\n        if (options.context === 'menu') {\n            if (user.value && isEmail(user.value)) {\n                return this.getCreateLabel(user.value);\n            }\n            return (\n                <React.Fragment>\n                    <Avatar\n                        size='lg'\n                        username={user.username}\n                        url={profileImg}\n                    />\n                    {this.renderUserName(user)}\n                    {guestBadge}\n                </React.Fragment>\n            );\n        }\n\n        if (user.value && isEmail(user.value)) {\n            return (\n                <React.Fragment>\n                    <MailIcon className='mail-icon'/>\n                    <span>{user.value}</span>\n                </React.Fragment>\n            );\n        }\n\n        return (\n            <React.Fragment>\n                <Avatar\n                    size='sm'\n                    username={user.username}\n                    url={profileImg}\n                />\n                {getDisplayName(user)}\n                {guestBadge}\n            </React.Fragment>\n        );\n    }\n\n    onChange = (value) => {\n        if (this.props.onChange) {\n            this.props.onChange(value.map((v) => {\n                if (v.id) {\n                    return v;\n                }\n                return v.value;\n            }));\n        }\n    }\n\n    getCreateLabel = (value) => (\n        <React.Fragment>\n            <MailPlusIcon className='mail-plus-icon'/>\n            <FormattedMarkdownMessage\n                key='widgets.users_emails_input.valid_email'\n                id={this.props.validAddressMessageId}\n                defaultMessage={this.props.validAddressMessageDefault}\n                values={{email: value}}\n                disableLinks={true}\n            />\n        </React.Fragment>\n    );\n\n    NoOptionsMessage = (props) => {\n        const inputValue = props.selectProps.inputValue;\n        if (!inputValue) {\n            return null;\n        }\n        return (\n            <div className='users-emails-input__option users-emails-input__option--no-matches'>\n                <FormattedMarkdownMessage\n                    id={this.props.noMatchMessageId}\n                    defaultMessage={this.props.noMatchMessageDefault}\n                    values={{text: inputValue}}\n                    disableLinks={true}\n                >\n                    {(message) => (\n                        <components.NoOptionsMessage {...props}>\n                            {message}\n                        </components.NoOptionsMessage>\n                    )}\n                </FormattedMarkdownMessage>\n            </div>\n        );\n    };\n\n    MultiValueRemove = ({children, innerProps}) => (\n        <div {...innerProps}>\n            {children || <CloseCircleSolidIcon/>}\n        </div>\n    );\n\n    components = {\n        NoOptionsMessage: this.NoOptionsMessage,\n        MultiValueRemove: this.MultiValueRemove,\n        IndicatorsContainer: () => null,\n    };\n\n    handleInputChange = (inputValue, action) => {\n        if (action.action === 'input-blur' && inputValue !== '') {\n            const values = this.props.value.map((v) => {\n                if (v.id) {\n                    return v;\n                }\n                return {label: v, value: v};\n            });\n\n            for (const option of this.state.options) {\n                if (this.props.inputValue === option.username || this.props.inputValue === ('@' + option.username)) {\n                    this.onChange([...values, option]);\n                    this.props.onInputChange('');\n                    return;\n                } else if (this.props.inputValue === option.email) {\n                    this.onChange([...values, option]);\n                    this.props.onInputChange('');\n                    return;\n                }\n            }\n\n            if (this.props.emailInvitationsEnabled && isEmail(this.props.inputValue)) {\n                const email = this.props.inputValue;\n                this.onChange([...values, {value: email, label: email}]);\n                this.props.onInputChange('');\n            }\n        }\n        if (action.action !== 'input-blur' && action.action !== 'menu-close') {\n            this.props.onInputChange(inputValue);\n        }\n    }\n\n    optionsLoader = (input, callback) => {\n        const customCallback = (options) => {\n            this.setState({options});\n            callback(options);\n        };\n        const result = this.props.usersLoader(this.props.inputValue, customCallback);\n        if (result && result.then) {\n            result.then(customCallback);\n        }\n    }\n\n    showAddEmail = (input, values, options) => {\n        return this.props.emailInvitationsEnabled && options.length === 0 && isEmail(input);\n    }\n\n    onFocus = () => {\n        this.selectRef.current.handleInputChange(this.props.inputValue, {action: 'custom'});\n    }\n\n    render() {\n        const values = this.props.value.map((v) => {\n            if (v.id) {\n                return v;\n            }\n            return {label: v, value: v};\n        });\n        return (\n            <AsyncSelect\n                ref={this.selectRef}\n                styles={this.customStyles}\n                onChange={this.onChange}\n                loadOptions={this.optionsLoader}\n                isValidNewOption={this.showAddEmail}\n                isMulti={true}\n                isClearable={false}\n                className={classNames('UsersEmailsInput', {empty: this.props.inputValue === ''})}\n                classNamePrefix='users-emails-input'\n                placeholder={this.props.placeholder}\n                components={this.components}\n                getOptionValue={this.getOptionValue}\n                formatOptionLabel={this.formatOptionLabel}\n                defaultOptions={false}\n                defaultMenuIsOpen={false}\n                openMenuOnClick={false}\n                loadingMessage={this.loadingMessage}\n                onInputChange={this.handleInputChange}\n                inputValue={this.props.inputValue}\n                openMenuOnFocus={true}\n                onFocus={this.onFocus}\n                tabSelectsValue={true}\n                value={values}\n                aria-label={this.props.ariaLabel}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class LinkIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.link'\n                    defaultMessage='Link Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='24px'\n                            height='24px'\n                            viewBox='0 0 24 24'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path d='M10.59,13.41C11,13.8 11,14.44 10.59,14.83C10.2,15.22 9.56,15.22 9.17,14.83C7.22,12.88 7.22,9.71 9.17,7.76V7.76L12.71,4.22C14.66,2.27 17.83,2.27 19.78,4.22C21.73,6.17 21.73,9.34 19.78,11.29L18.29,12.78C18.3,11.96 18.17,11.14 17.89,10.36L18.36,9.88C19.54,8.71 19.54,6.81 18.36,5.64C17.19,4.46 15.29,4.46 14.12,5.64L10.59,9.17C9.41,10.34 9.41,12.24 10.59,13.41M13.41,9.17C13.8,8.78 14.44,8.78 14.83,9.17C16.78,11.12 16.78,14.29 14.83,16.24V16.24L11.29,19.78C9.34,21.73 6.17,21.73 4.22,19.78C2.27,17.83 2.27,14.66 4.22,12.71L5.71,11.22C5.7,12.04 5.83,12.86 6.11,13.65L5.64,14.12C4.46,15.29 4.46,17.19 5.64,18.36C6.81,19.54 8.71,19.54 9.88,18.36L13.41,14.83C14.59,13.66 14.59,11.76 13.41,10.59C13,10.2 13,9.56 13.41,9.17Z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {injectIntl, FormattedMessage} from 'react-intl';\n\nimport {debounce} from 'mattermost-redux/actions/helpers';\nimport {isEmail} from 'mattermost-redux/utils/helpers';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\nimport InviteMembersIcon from 'components/widgets/icons/invite_members_icon';\nimport UsersEmailsInput from 'components/widgets/inputs/users_emails_input.jsx';\n\nimport LinkIcon from 'components/widgets/icons/link_icon';\n\nimport {getSiteURL} from 'utils/url';\nimport {t} from 'utils/i18n.jsx';\nimport {localizeMessage} from 'utils/utils.jsx';\n\nimport './invitation_modal_members_step.scss';\n\nclass InvitationModalMembersStep extends React.Component {\n    static propTypes = {\n        teamName: PropTypes.string.isRequired,\n        currentTeamId: PropTypes.string.isRequired,\n        intl: PropTypes.any,\n        inviteId: PropTypes.string.isRequired,\n        searchProfiles: PropTypes.func.isRequired,\n        emailInvitationsEnabled: PropTypes.bool.isRequired,\n        onEdit: PropTypes.func.isRequired,\n        onSubmit: PropTypes.func.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n        this.inviteLinkRef = React.createRef();\n        this.timeout = null;\n        this.state = {\n            usersAndEmails: [],\n            copiedLink: false,\n            termWithoutResults: null,\n            usersInputValue: '',\n        };\n    }\n\n    copyLink = () => {\n        const input = this.inviteLinkRef.current;\n\n        const textField = document.createElement('textarea');\n        textField.innerText = input.value;\n        textField.style.position = 'fixed';\n        textField.style.opacity = 0;\n\n        document.body.appendChild(textField);\n        textField.select();\n\n        try {\n            this.setState({copiedLink: document.execCommand('copy')});\n        } catch (err) {\n            this.setState({copiedLink: false});\n        }\n        textField.remove();\n\n        if (this.timeout) {\n            clearTimeout(this.timeout);\n        }\n        this.timeout = setTimeout(() => {\n            this.setState({copiedLink: false});\n        }, 3000);\n    }\n\n    debouncedSearchProfiles = debounce((term, callback) => {\n        this.props.searchProfiles(term, {not_in_team_id: this.props.currentTeamId}).then(({data}) => {\n            callback(data);\n            if (data.length === 0) {\n                this.setState({termWithoutResults: term});\n            } else {\n                this.setState({termWithoutResults: null});\n            }\n        }).catch(() => {\n            callback([]);\n        });\n    }, 150);\n\n    usersLoader = (term, callback) => {\n        if (this.state.termWithoutResults && term.startsWith(this.state.termWithoutResults)) {\n            callback([]);\n            return;\n        }\n        try {\n            this.debouncedSearchProfiles(term, callback);\n        } catch (error) {\n            callback([]);\n        }\n    }\n\n    onChange = (usersAndEmails) => {\n        this.setState({usersAndEmails});\n        this.props.onEdit(usersAndEmails.length > 0 || this.state.usersInputValue);\n    }\n\n    onUsersInputChange = (usersInputValue) => {\n        this.setState({usersInputValue});\n        this.props.onEdit(this.state.usersAndEmails.length > 0 || usersInputValue);\n    }\n\n    submit = () => {\n        const users = [];\n        const emails = [];\n        for (const userOrEmail of this.state.usersAndEmails) {\n            if (isEmail(userOrEmail)) {\n                emails.push(userOrEmail);\n            } else {\n                users.push(userOrEmail);\n            }\n        }\n        this.props.onSubmit(users, emails, this.state.usersInputValue);\n    }\n\n    render() {\n        const inviteUrl = getSiteURL() + '/signup_user_complete/?id=' + this.props.inviteId;\n\n        let placeholder = localizeMessage('invitation_modal.members.search-and-add.placeholder', 'Add members or email addresses');\n        let noMatchMessageId = t('invitation_modal.members.users_emails_input.no_user_found_matching');\n        let noMatchMessageDefault = 'No one found matching **{text}**, type email to invite';\n\n        if (!this.props.emailInvitationsEnabled) {\n            placeholder = localizeMessage('invitation_modal.members.search-and-add.placeholder-email-disabled', 'Add members');\n            noMatchMessageId = t('invitation_modal.members.users_emails_input.no_user_found_matching-email-disabled');\n            noMatchMessageDefault = 'No one found matching **{text}**';\n        }\n\n        return (\n            <div className='InvitationModalMembersStep'>\n                <div className='modal-icon'>\n                    <InviteMembersIcon/>\n                </div>\n                <h1 id='invitation_modal_title'>\n                    <FormattedMarkdownMessage\n                        id='invitation_modal.members.title'\n                        defaultMessage='Invite **Members** to {teamName}'\n                        values={{teamName: this.props.teamName}}\n                    />\n                </h1>\n                <div\n                    className='share-link'\n                    data-testid='shareLink'\n                >\n                    <h2>\n                        <FormattedMessage\n                            id='invitation_modal.members.share_link.title'\n                            defaultMessage='Share This Link'\n                        />\n                    </h2>\n                    <div className='share-link-input-block'>\n                        <input\n                            ref={this.inviteLinkRef}\n                            className='share-link-input'\n                            type='text'\n                            readOnly={true}\n                            value={inviteUrl}\n                            aria-label={this.props.intl.formatMessage({id: 'invitation_modal.members.share_link.input', defaultMessage: 'team invite link'})}\n                            data-testid='shareLinkInput'\n                        />\n                        <button\n                            className='share-link-input-button'\n                            onClick={this.copyLink}\n                            data-testid='shareLinkInputButton'\n                        >\n                            <LinkIcon/>\n                            {!this.state.copiedLink &&\n                                <FormattedMessage\n                                    id='invitation_modal.members.share_link.copy_button'\n                                    defaultMessage='Copy Link'\n                                />\n                            }\n                            {this.state.copiedLink &&\n                                <FormattedMessage\n                                    id='invitation_modal.members.share_link.link_copied'\n                                    defaultMessage='Link Copied'\n                                />\n                            }\n                        </button>\n                    </div>\n                    <div className='help-text'>\n                        <FormattedMessage\n                            id='invitation_modal.members.share_link.description'\n                            defaultMessage='Share this link to invite people to this team.'\n                        />\n                    </div>\n                </div>\n                <div className='invitation-modal-or'>\n                    <hr/>\n                    <div>\n                        <FormattedMessage\n                            id='invitation_modal.members.or'\n                            defaultMessage='OR'\n                        />\n                    </div>\n\n                </div>\n                <div\n                    className='search-and-add'\n                    data-testid='searchAdd'\n                >\n                    <h2>\n                        <FormattedMessage\n                            id='invitation_modal.members.search_and_add.title'\n                            defaultMessage='Add or Invite People'\n                        />\n                    </h2>\n                    <div data-testid='inputPlaceholder'>\n                        <UsersEmailsInput\n                            usersLoader={this.usersLoader}\n                            placeholder={placeholder}\n                            ariaLabel={localizeMessage('invitation_modal.members.search_and_add.title', 'Invite People')}\n                            onChange={this.onChange}\n                            value={this.state.usersAndEmails}\n                            validAddressMessageId={t('invitation_modal.members.users_emails_input.valid_email')}\n                            validAddressMessageDefault='Invite **{email}** as a team member'\n                            noMatchMessageId={noMatchMessageId}\n                            noMatchMessageDefault={noMatchMessageDefault}\n                            onInputChange={this.onUsersInputChange}\n                            inputValue={this.state.usersInputValue}\n                            emailInvitationsEnabled={this.props.emailInvitationsEnabled}\n                        />\n                    </div>\n                    <div className='help-text'>\n                        {this.props.emailInvitationsEnabled &&\n                        <FormattedMessage\n                            id='invitation_modal.members.search-and-add.description'\n                            defaultMessage='Add existing members or send email invites to new members.'\n                        />\n                        }\n                        {!this.props.emailInvitationsEnabled &&\n                        <FormattedMessage\n                            id='invitation_modal.members.search-and-add.description-email-disabled'\n                            defaultMessage='Add existing members to this team.'\n                        />\n                        }\n                    </div>\n                </div>\n                <div className='invite-members'>\n                    <button\n                        className={'btn ' + (this.state.usersAndEmails.length === 0 ? 'btn-inactive' : 'btn-primary')}\n                        onClick={this.submit}\n                        disabled={this.state.usersAndEmails.length === 0}\n                        id='inviteMembersButton'\n                    >\n                        <FormattedMessage\n                            id='invitation_modal.members.invite_button'\n                            defaultMessage='Invite Members'\n                        />\n                    </button>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default injectIntl(InvitationModalMembersStep);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class CloseCircleIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.close'\n                    defaultMessage='Close Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='24px'\n                            height='24px'\n                            viewBox='0 0 24 24'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path\n                                d='M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22C17.53,22 22,17.53 22,12C22,6.47 17.53,2 12,2M14.59,8L12,10.59L9.41,8L8,9.41L10.59,12L8,14.59L9.41,16L12,13.41L14.59,16L16,14.59L13.41,12L16,9.41L14.59,8Z'\n                            />\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport AsyncSelect from 'react-select/lib/Async';\nimport {components} from 'react-select';\nimport classNames from 'classnames';\n\nimport {Constants} from 'utils/constants';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\nimport PublicChannelIcon from 'components/widgets/icons/globe_icon.jsx';\nimport PrivateChannelIcon from 'components/widgets/icons/lock_icon.jsx';\nimport CloseCircleSolidIcon from 'components/widgets/icons/close_circle_solid_icon';\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\n\nimport {t} from 'utils/i18n.jsx';\n\nimport './channels_input.scss';\n\nexport default class ChannelsInput extends React.Component {\n    static propTypes = {\n        placeholder: PropTypes.string,\n        ariaLabel: PropTypes.string.isRequired,\n        channelsLoader: PropTypes.func,\n        onChange: PropTypes.func,\n        value: PropTypes.arrayOf(PropTypes.object),\n        onInputChange: PropTypes.func,\n        inputValue: PropTypes.string,\n        loadingMessageId: PropTypes.string,\n        loadingMessageDefault: PropTypes.string,\n        noOptionsMessageId: PropTypes.string,\n        noOptionsMessageDefault: PropTypes.string,\n    }\n\n    static defaultProps = {\n        loadingMessageId: t('widgets.channels_input.loading'),\n        loadingMessageDefault: 'Loading',\n        noOptionsMessageId: t('widgets.channels_input.empty'),\n        noOptionsMessageDefault: 'No channels found',\n    };\n\n    constructor(props) {\n        super(props);\n        this.selectRef = React.createRef();\n        this.state = {\n            options: [],\n        };\n    }\n\n    getOptionValue = (channel) => channel.id\n\n    handleInputChange = (inputValue, action) => {\n        if (action.action === 'input-blur' && inputValue !== '') {\n            for (const option of this.state.options) {\n                if (this.props.inputValue === option.name) {\n                    this.onChange([...this.props.value, option]);\n                    this.props.onInputChange('');\n                    return;\n                }\n            }\n        }\n        if (action.action !== 'input-blur' && action.action !== 'menu-close') {\n            this.props.onInputChange(inputValue);\n        }\n    }\n\n    optionsLoader = (input, callback) => {\n        const customCallback = (options) => {\n            this.setState({options});\n            callback(options);\n        };\n        const result = this.props.channelsLoader(this.props.inputValue, customCallback);\n        if (result && result.then) {\n            result.then(customCallback);\n        }\n    }\n\n    loadingMessage = () => {\n        const text = (\n            <FormattedMessage\n                id={this.props.loadingMessageId}\n                defaultMessage={this.props.loadingMessageDefault}\n            />\n        );\n\n        return (<LoadingSpinner text={text}/>);\n    }\n\n    NoOptionsMessage = (props) => {\n        const inputValue = props.selectProps.inputValue;\n        if (!inputValue) {\n            return null;\n        }\n        return (\n            <div className='channels-input__option channels-input__option--no-matches'>\n                <FormattedMarkdownMessage\n                    id={this.props.noOptionsMessageId}\n                    defaultMessage={this.props.noOptionsMessageDefault}\n                    values={{text: inputValue}}\n                >\n                    {(message) => (\n                        <components.NoOptionsMessage {...props}>\n                            {message}\n                        </components.NoOptionsMessage>\n                    )}\n                </FormattedMarkdownMessage>\n            </div>\n        );\n    };\n\n    formatOptionLabel = (channel) => {\n        let icon = <PublicChannelIcon className='public-channel-icon'/>;\n        if (channel.type === Constants.PRIVATE_CHANNEL) {\n            icon = <PrivateChannelIcon className='private-channel-icon'/>;\n        }\n        return (\n            <React.Fragment>\n                {icon}\n                {channel.display_name}\n                <span className='channel-name'>{channel.name}</span>\n            </React.Fragment>\n        );\n    }\n\n    onChange = (value) => {\n        if (this.props.onChange) {\n            this.props.onChange(value);\n        }\n    }\n\n    MultiValueRemove = ({children, innerProps}) => (\n        <div {...innerProps}>\n            {children || <CloseCircleSolidIcon/>}\n        </div>\n    );\n\n    components = {\n        NoOptionsMessage: this.NoOptionsMessage,\n        MultiValueRemove: this.MultiValueRemove,\n        IndicatorsContainer: () => null,\n    };\n\n    onFocus = () => {\n        this.selectRef.current.handleInputChange(this.props.inputValue, {action: 'custom'});\n    }\n\n    render() {\n        return (\n            <AsyncSelect\n                ref={this.selectRef}\n                styles={this.customStyles}\n                onChange={this.onChange}\n                loadOptions={this.optionsLoader}\n                isMulti={true}\n                isClearable={false}\n                className={classNames('ChannelsInput', {empty: this.props.inputValue === ''})}\n                classNamePrefix='channels-input'\n                placeholder={this.props.placeholder}\n                components={this.components}\n                getOptionValue={this.getOptionValue}\n                formatOptionLabel={this.formatOptionLabel}\n                noOptionsMessage={this.noOptionsMessage}\n                loadingMessage={this.loadingMessage}\n                defaultOptions={false}\n                defaultMenuIsOpen={false}\n                openMenuOnClick={false}\n                onInputChange={this.handleInputChange}\n                inputValue={this.props.inputValue}\n                openMenuOnFocus={true}\n                onFocus={this.onFocus}\n                tabSelectsValue={true}\n                value={this.props.value}\n                aria-label={this.props.ariaLabel}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport {isEmail} from 'mattermost-redux/utils/helpers';\nimport {debounce} from 'mattermost-redux/actions/helpers';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\nimport InviteIcon from 'components/widgets/icons/invite_icon';\nimport CloseCircleIcon from 'components/widgets/icons/close_circle_icon';\n\nimport ChannelsInput from 'components/widgets/inputs/channels_input.jsx';\nimport UsersEmailsInput from 'components/widgets/inputs/users_emails_input.jsx';\n\nimport './invitation_modal_guests_step.scss';\n\nimport {t} from 'utils/i18n.jsx';\nimport {localizeMessage} from 'utils/utils.jsx';\n\nexport default class InvitationModalGuestsStep extends React.Component {\n    static propTypes = {\n        teamName: PropTypes.string.isRequired,\n        myInvitableChannels: PropTypes.array.isRequired,\n        currentTeamId: PropTypes.string.isRequired,\n        searchProfiles: PropTypes.func.isRequired,\n        searchChannels: PropTypes.func.isRequired,\n        defaultChannels: PropTypes.array,\n        defaultMessage: PropTypes.string,\n        onEdit: PropTypes.func.isRequired,\n        onSubmit: PropTypes.func.isRequired,\n        emailInvitationsEnabled: PropTypes.bool.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n        this.textareaRef = React.createRef();\n        this.state = {\n            customMessageOpen: Boolean(props.defaultMessage),\n            customMessage: props.defaultMessage || '',\n            usersAndEmails: [],\n            channels: props.defaultChannels || [],\n            usersInputValue: '',\n            channelsInputValue: '',\n        };\n    }\n\n    onUsersEmailsChange = (usersAndEmails) => {\n        this.setState({usersAndEmails});\n        this.props.onEdit(usersAndEmails.length > 0 || this.state.channels.length > 0 || this.state.customMessage !== '' || this.state.usersInputValue || this.state.channelsInputValue);\n    }\n\n    onChannelsChange = (channels) => {\n        this.setState({channels});\n        this.props.onEdit(this.state.usersAndEmails.length > 0 || channels.length > 0 || this.state.customMessage !== '' || this.state.usersInputValue || this.state.channelsInputValue);\n    }\n\n    onMessageChange = (e) => {\n        this.setState({customMessage: e.target.value});\n        this.props.onEdit(this.state.usersAndEmails.length > 0 || this.state.channels.length > 0 || e.target.value !== '' || this.state.usersInputValue || this.state.channelsInputValue);\n    }\n\n    onUsersInputChange = (usersInputValue) => {\n        this.setState({usersInputValue});\n        this.props.onEdit(this.state.usersAndEmails.length > 0 || this.state.channels.length > 0 || this.state.customMessage !== '' || usersInputValue || this.state.channelsInputValue);\n    }\n\n    onChannelsInputChange = (channelsInputValue) => {\n        this.setState({channelsInputValue});\n        this.props.onEdit(this.state.usersAndEmails.length > 0 || this.state.channels.length > 0 || this.state.customMessage !== '' || this.state.usersInputValue || channelsInputValue);\n    }\n\n    debouncedSearchProfiles = debounce((term, callback) => {\n        this.props.searchProfiles(term).then(({data}) => {\n            callback(data);\n            if (data.length === 0) {\n                this.setState({termWithoutResults: term});\n            } else {\n                this.setState({termWithoutResults: null});\n            }\n        }).catch(() => {\n            callback([]);\n        });\n    }, 150);\n\n    usersLoader = (term, callback) => {\n        if (this.state.termWithoutResults && term.startsWith(this.state.termWithoutResults)) {\n            callback([]);\n            return;\n        }\n        try {\n            this.debouncedSearchProfiles(term, callback);\n        } catch (error) {\n            callback([]);\n        }\n    }\n\n    debouncedSearchChannels = debounce((term) => this.props.searchChannels(this.props.currentTeamId, term), 150);\n\n    channelsLoader = async (value) => {\n        if (!value) {\n            return this.props.myInvitableChannels;\n        }\n\n        this.debouncedSearchChannels(value);\n        return this.props.myInvitableChannels.filter((channel) => {\n            return channel.display_name.toLowerCase().startsWith(value.toLowerCase()) || channel.name.toLowerCase().startsWith(value.toLowerCase());\n        });\n    }\n\n    openCustomMessage = () => {\n        this.setState({customMessageOpen: true});\n        setTimeout(() => {\n            if (this.textareaRef.current) {\n                this.textareaRef.current.focus();\n            }\n        });\n    }\n\n    closeCustomMessage = () => {\n        this.setState({customMessageOpen: false});\n    }\n\n    sendInvites = () => {\n        const users = [];\n        const emails = [];\n        for (const userOrEmail of this.state.usersAndEmails) {\n            if (isEmail(userOrEmail)) {\n                emails.push(userOrEmail);\n            } else {\n                users.push(userOrEmail);\n            }\n        }\n        this.props.onSubmit(users, emails, this.state.channels, this.state.customMessageOpen ? this.state.customMessage : '', this.state.usersInputValue, this.state.channelsInputValue);\n    }\n\n    render() {\n        let inputPlaceholder = localizeMessage('invitation_modal.guests.search-and-add.placeholder', 'Add guests or email addresses');\n        let noMatchMessageId = t('invitation_modal.guests.users_emails_input.no_user_found_matching');\n        let noMatchMessageDefault = 'No one found matching **{text}**, type email to invite';\n\n        if (!this.props.emailInvitationsEnabled) {\n            inputPlaceholder = localizeMessage('invitation_modal.guests.search-and-add.placeholder-email-disabled', 'Add guests');\n            noMatchMessageId = t('invitation_modal.guests.users_emails_input.no_user_found_matching-email-disabled');\n            noMatchMessageDefault = 'No one found matching **{text}**';\n        }\n        return (\n            <div className='InvitationModalGuestsStep'>\n                <div className='modal-icon'>\n                    <InviteIcon/>\n                </div>\n                <h1 id='invitation_modal_title'>\n                    <FormattedMarkdownMessage\n                        id='invitation_modal.guests.title'\n                        defaultMessage='Invite **Guests** to {teamName}'\n                        values={{teamName: this.props.teamName}}\n                    />\n                </h1>\n                <div\n                    className='add-people'\n                    data-testid='addPeople'\n                >\n                    <h2>\n                        <FormattedMessage\n                            id='invitation_modal.guests.add_people.title'\n                            defaultMessage='Invite People'\n                        />\n                    </h2>\n                    <div data-testid='emailPlaceholder'>\n                        <UsersEmailsInput\n                            usersLoader={this.usersLoader}\n                            placeholder={inputPlaceholder}\n                            ariaLabel={localizeMessage('invitation_modal.guests.add_people.title', 'Invite People')}\n                            onChange={this.onUsersEmailsChange}\n                            value={this.state.usersAndEmails}\n                            onInputChange={this.onUsersInputChange}\n                            inputValue={this.state.usersInputValue}\n                            validAddressMessageId={t('invitation_modal.guests.users_emails_input.valid_email')}\n                            validAddressMessageDefault='Invite **{email}** as a guest'\n                            noMatchMessageId={noMatchMessageId}\n                            noMatchMessageDefault={noMatchMessageDefault}\n                            emailInvitationsEnabled={this.props.emailInvitationsEnabled}\n                        />\n                    </div>\n                    <div className='help-text'>\n\n                        {this.props.emailInvitationsEnabled &&\n                        <FormattedMessage\n                            id='invitation_modal.guests.add_people.description'\n                            defaultMessage='Add existing guests or send email invites to new guests.'\n                        />\n                        }\n                        {!this.props.emailInvitationsEnabled &&\n                        <FormattedMessage\n                            id='invitation_modal.guests.add_people.description-email-disabled'\n                            defaultMessage='Add existing guests.'\n                        />\n                        }\n                    </div>\n                </div>\n                <div\n                    className='add-channels'\n                    data-testid='channelPlaceholder'\n                >\n                    <h2>\n                        <FormattedMessage\n                            id='invitation_modal.guests.add_channels.title'\n                            defaultMessage='Search and Add Channels'\n                        />\n                    </h2>\n                    <div>\n                        <FormattedMessage\n                            id='invitation_modal.guests.add_channels.placeholder'\n                            defaultMessage='Search and add channels'\n                        >\n                            {(placeholder) => (\n                                <ChannelsInput\n                                    placeholder={placeholder}\n                                    ariaLabel={localizeMessage('invitation_modal.guests.add_channels.title', 'Search and Add Channels')}\n                                    channelsLoader={this.channelsLoader}\n                                    onChange={this.onChannelsChange}\n                                    onInputChange={this.onChannelsInputChange}\n                                    inputValue={this.state.channelsInputValue}\n                                    value={this.state.channels}\n                                />\n                            )}\n                        </FormattedMessage>\n                    </div>\n                    <div className='help-text'>\n                        <FormattedMessage\n                            id='invitation_modal.guests.add-channels.description'\n                            defaultMessage='Specify the channels the guests have access to.'\n                        />\n                    </div>\n                </div>\n                <div\n                    className='custom-message'\n                    data-testid='customMessage'\n                >\n                    {!this.state.customMessageOpen &&\n                        <a\n                            onClick={this.openCustomMessage}\n                            href='#'\n                        >\n                            <FormattedMessage\n                                id='invitation_modal.guests.custom-message.link'\n                                defaultMessage='Set a custom message'\n                            />\n                        </a>\n                    }\n                    {this.state.customMessageOpen &&\n                        <React.Fragment>\n                            <div>\n                                <FormattedMessage\n                                    id='invitation_modal.guests.custom-message.title'\n                                    defaultMessage='Custom message'\n                                />\n                                <CloseCircleIcon onClick={this.closeCustomMessage}/>\n                            </div>\n                            <textarea\n                                ref={this.textareaRef}\n                                onChange={this.onMessageChange}\n                                value={this.state.customMessage}\n                            />\n                        </React.Fragment>\n                    }\n                    <div className='help-text'>\n                        <FormattedMessage\n                            id='invitation_modal.guests.custom-message.description'\n                            defaultMessage='Create a custom message to make your invite more personal.'\n                        />\n                    </div>\n                </div>\n                <div className='invite-guests'>\n                    <button\n                        className={'btn ' + (this.state.channels.length === 0 || this.state.usersAndEmails.length === 0 ? 'btn-inactive' : 'btn-primary')}\n                        disabled={this.state.channels.length === 0 || this.state.usersAndEmails.length === 0}\n                        onClick={this.sendInvites}\n                        id='inviteGuestButton'\n                    >\n                        <FormattedMessage\n                            id='invitation_modal.guests.invite_button'\n                            defaultMessage='Invite Guests'\n                        />\n                    </button>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class AlertIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.alert'\n                    defaultMessage='Alert Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='24px'\n                            height='24px'\n                            viewBox='0 0 24 24'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path d='M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport {FormattedMessage} from 'react-intl';\n\nimport EmailIcon from 'components/widgets/icons/mail_icon';\nimport AlertIcon from 'components/widgets/icons/alert_icon';\nimport GuestBadge from 'components/widgets/badges/guest_badge';\nimport Avatar from 'components/widgets/users/avatar';\n\nimport {imageURLForUser, isGuest, getLongDisplayName} from 'utils/utils.jsx';\n\nimport './invitation_modal_confirm_step_row.scss';\n\nexport default class InvitationModalConfirmStepRow extends React.Component {\n    static propTypes = {\n        invitation: PropTypes.object.isRequired,\n    }\n\n    render() {\n        const {invitation} = this.props;\n        let icon;\n        let username;\n        let className;\n        let guestBadge;\n        if (invitation.user) {\n            className = 'name';\n            const profileImg = imageURLForUser(invitation.user.id, invitation.user.last_picture_update);\n            icon = (\n                <Avatar\n                    username={invitation.user.username}\n                    url={profileImg}\n                    size='lg'\n                />\n            );\n            username = getLongDisplayName(invitation.user);\n            if (isGuest(invitation.user)) {\n                guestBadge = <GuestBadge/>;\n            }\n        } else if (invitation.email) {\n            className = 'email';\n            icon = <EmailIcon className='mail-icon'/>;\n            username = invitation.email;\n        } else {\n            className = 'name';\n            icon = <AlertIcon className='alert-icon'/>;\n            username = invitation.text;\n        }\n\n        let reason = invitation.reason;\n        if (invitation.reason && invitation.reason.id) {\n            reason = (\n                <FormattedMessage\n                    id={invitation.reason.id}\n                    defaultMessage={invitation.reason.message}\n                    values={invitation.reason.values}\n                />\n            );\n        }\n\n        return (\n            <div className='InvitationModalConfirmStepRow'>\n                <div className='username-or-icon'>\n                    {icon}\n                    <span className={className}>\n                        {username}\n                        {guestBadge}\n                    </span>\n                </div>\n                <div className='reason'>\n                    {reason}\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport InvitationModalConfirmStepRow from 'components/invitation_modal/invitation_modal_confirm_step_row';\n\nimport './invitation_modal_confirm_step_table.scss';\n\nexport default class InvitationModalConfirmStepTable extends React.Component {\n    static propTypes = {\n        invites: PropTypes.arrayOf(PropTypes.object).isRequired,\n    }\n    render() {\n        return (\n            <div className='InvitationModalConfirmStepTable'>\n                <div className='table-header'>\n                    <div className='people-header'>\n                        <FormattedMessage\n                            id='invitation-modal.confirm.people-header'\n                            defaultMessage='People'\n                        />\n                    </div>\n                    <div className='details-header'>\n                        <FormattedMessage\n                            id='invitation-modal.confirm.details-header'\n                            defaultMessage='Details'\n                        />\n                    </div>\n                </div>\n                <div className='rows'>\n                    {this.props.invites.map((invitation) => (\n                        <InvitationModalConfirmStepRow\n                            key={invitation.text || invitation.email || invitation.user.id}\n                            invitation={invitation}\n                        />\n                    ))}\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\nimport InviteIcon from 'components/widgets/icons/invite_icon';\nimport InvitationModalConfirmStepTable from 'components/invitation_modal/invitation_modal_confirm_step_table';\n\nimport {InviteTypes} from 'utils/constants';\n\nimport './invitation_modal_confirm_step.scss';\n\nexport default class InvitationModalConfirmStep extends React.Component {\n    static propTypes = {\n        teamName: PropTypes.string.isRequired,\n        onDone: PropTypes.func.isRequired,\n        onInviteMore: PropTypes.func.isRequired,\n        invitesType: PropTypes.oneOf([InviteTypes.INVITE_MEMBER, InviteTypes.INVITE_GUEST]).isRequired,\n        invitesSent: PropTypes.array.isRequired,\n        invitesNotSent: PropTypes.array.isRequired,\n    }\n\n    getInvitesCountsMessage = (invitesSentCount, invitesNotSentCount) => {\n        if (invitesSentCount > 0 && invitesNotSentCount > 0) {\n            return (\n                <FormattedMarkdownMessage\n                    id='invitation_modal.confirm.members_subtitle'\n                    defaultMessage='**{sentCount, number} {sentCount, plural, one {person} other {people}}** {sentCount, plural, one {has} other {have}} been invited, and **{notSentCount, number} {notSentCount, plural, one {invitation} other {invitations}}** {notSentCount, plural, one {was} other {were}} not sent'\n                    values={{sentCount: invitesSentCount, notSentCount: invitesNotSentCount}}\n                />\n            );\n        }\n\n        if (invitesSentCount > 0 && invitesNotSentCount === 0) {\n            return (\n                <FormattedMarkdownMessage\n                    id='invitation_modal.confirm.members_subtitle_without_not_sent'\n                    defaultMessage='**{sentCount, number} {sentCount, plural, one {person} other {people}}** {sentCount, plural, one {has} other {have}} been invited'\n                    values={{sentCount: invitesSentCount}}\n                />\n            );\n        }\n        if (invitesSentCount === 0 && invitesNotSentCount > 0) {\n            return (\n                <FormattedMarkdownMessage\n                    id='invitation_modal.confirm.members_subtitle_without_sent'\n                    defaultMessage='**{notSentCount, number} {notSentCount, plural, one {invitation} other {invitations}}** {notSentCount, plural, one {was} other {were}} not sent'\n                    values={{notSentCount: invitesNotSentCount}}\n                />\n            );\n        }\n        return (\n            <FormattedMarkdownMessage\n                id='invitation_modal.confirm.members_subtitle_without_sent_and_not_sent'\n                defaultMessage='No invitation sent'\n            />\n        );\n    }\n\n    render() {\n        const {teamName, invitesType, invitesSent, invitesNotSent, onDone, onInviteMore} = this.props;\n        return (\n            <div className='InvitationModalConfirmStep'>\n                <div className='modal-icon'>\n                    <InviteIcon/>\n                </div>\n                {invitesType === InviteTypes.INVITE_MEMBER &&\n                    <h1 id='invitation_modal_title'>\n                        <FormattedMarkdownMessage\n                            id='invitation_modal.confirm.members_title'\n                            defaultMessage='**Members** Invited to **{teamName}**'\n                            values={{teamName}}\n                        />\n                    </h1>}\n                {invitesType === InviteTypes.INVITE_GUEST &&\n                    <h1 id='invitation_modal_title'>\n                        <FormattedMarkdownMessage\n                            id='invitation_modal.confirm.guests_title'\n                            defaultMessage='**Guests** Invited to **{teamName}**'\n                            values={{teamName}}\n                        />\n                    </h1>}\n                <h2 className='subtitle'>\n                    {this.getInvitesCountsMessage(invitesSent.length, invitesNotSent.length)}\n                </h2>\n                {invitesSent.length > 0 &&\n                    <div className='invitation-modal-confirm-sent'>\n                        <h2>\n                            <FormattedMessage\n                                id='invitation_modal.confirm.sent-header'\n                                defaultMessage='Successful Invites'\n                            />\n                        </h2>\n                        <InvitationModalConfirmStepTable invites={invitesSent}/>\n                    </div>}\n                {invitesNotSent.length > 0 &&\n                    <div className='invitation-modal-confirm-not-sent'>\n                        <h2>\n                            <FormattedMessage\n                                id='invitation_modal.confirm.not-sent-header'\n                                defaultMessage='Invitations Not Sent'\n                            />\n                        </h2>\n                        <InvitationModalConfirmStepTable invites={invitesNotSent}/>\n                    </div>}\n                <div className='button-input-block'>\n                    <button\n                        className='btn invite-more'\n                        onClick={onInviteMore}\n                    >\n                        <FormattedMessage\n                            id='invitation_modal.invite.more'\n                            defaultMessage='Invite More People'\n                        />\n                    </button>\n                    <button\n                        className='btn btn-primary confirm-done'\n                        onClick={onDone}\n                    >\n                        <FormattedMessage\n                            id='invitation_modal.confirm.done'\n                            defaultMessage='Done'\n                        />\n                    </button>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport FullScreenModal from 'components/widgets/modals/full_screen_modal';\nimport ConfirmModal from 'components/confirm_modal';\nimport RootPortal from 'components/root_portal';\n\nimport {InviteTypes} from 'utils/constants';\n\nimport InvitationModalInitialStep from './invitation_modal_initial_step.jsx';\nimport InvitationModalMembersStep from './invitation_modal_members_step.jsx';\nimport InvitationModalGuestsStep from './invitation_modal_guests_step.jsx';\nimport InvitationModalConfirmStep from './invitation_modal_confirm_step.jsx';\n\nimport './invitation_modal.scss';\n\nconst STEPS_INITIAL = 'initial';\nconst STEPS_INVITE_MEMBERS = 'members';\nconst STEPS_INVITE_GUESTS = 'guests';\nconst STEPS_INVITE_CONFIRM = 'confirm';\n\nexport default class InvitationModal extends React.Component {\n    static propTypes = {\n        show: PropTypes.bool,\n        currentTeam: PropTypes.object.isRequired,\n        invitableChannels: PropTypes.array.isRequired,\n        canInviteGuests: PropTypes.bool.isRequired,\n        canAddUsers: PropTypes.bool.isRequired,\n        emailInvitationsEnabled: PropTypes.bool.isRequired,\n        actions: PropTypes.shape({\n            closeModal: PropTypes.func.isRequired,\n            sendGuestsInvites: PropTypes.func.isRequired,\n            sendMembersInvites: PropTypes.func.isRequired,\n            searchProfiles: PropTypes.func.isRequired,\n            searchChannels: PropTypes.func.isRequired,\n            getTeam: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    modal = React.createRef();\n\n    constructor(props) {\n        super(props);\n        let step = STEPS_INITIAL;\n        if (!props.canInviteGuests) {\n            step = STEPS_INVITE_MEMBERS;\n        }\n\n        if (!props.canAddUsers) {\n            step = STEPS_INVITE_GUESTS;\n        }\n\n        this.state = {\n            step,\n            prevStep: null,\n            lastInviteChannels: [],\n            lastInviteMessage: '',\n            confirmModal: false,\n            confirmBack: false,\n            hasChanges: false,\n            invitesType: InviteTypes.INVITE_MEMBER,\n            invitesSent: [],\n            invitesNotSent: [],\n        };\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.state.step === STEPS_INVITE_MEMBERS && prevState.step !== STEPS_INVITE_MEMBERS && !this.props.currentTeam.invite_id) {\n            this.props.actions.getTeam(this.props.currentTeam.id);\n        }\n    }\n\n    goToFirstStep = () => {\n        if (this.props.canAddUsers && this.props.canInviteGuests) {\n            this.goToInitialStep();\n        } else if (this.props.canAddUsers) {\n            this.goToMembers();\n        } else if (this.props.canInviteGuests) {\n            this.goToGuests();\n        } else {\n            this.close();\n        }\n    }\n\n    goToInitialStep = () => {\n        if (this.state.hasChanges) {\n            this.setState({confirmBack: true});\n        } else {\n            this.setState({step: STEPS_INITIAL, hasChanges: false, lastInviteChannels: [], lastInviteMesssage: '', prevStep: this.state.step});\n        }\n        if (this.modal && this.modal.current) {\n            this.modal.current.enforceFocus();\n        }\n    }\n\n    goToMembers = () => {\n        this.setState({step: STEPS_INVITE_MEMBERS, prevStep: this.state.step, hasChanges: false, invitesSent: [], invitesNotSent: [], invitesType: InviteTypes.INVITE_MEMBER});\n        if (this.modal && this.modal.current) {\n            this.modal.current.enforceFocus();\n        }\n    }\n\n    goToGuests = () => {\n        this.setState({step: STEPS_INVITE_GUESTS, prevStep: this.state.step, hasChanges: false, invitesSent: [], invitesNotSent: [], invitesType: InviteTypes.INVITE_GUEST});\n        if (this.modal && this.modal.current) {\n            this.modal.current.enforceFocus();\n        }\n    }\n\n    goToPrevStep = () => {\n        if (this.state.prevStep === STEPS_INVITE_GUESTS) {\n            this.setState({step: STEPS_INVITE_GUESTS, prevStep: this.state.step, hasChanges: false, invitesSent: [], invitesNotSent: [], invitesType: InviteTypes.INVITE_GUEST});\n        } else if (this.state.prevStep === STEPS_INVITE_MEMBERS) {\n            this.setState({step: STEPS_INVITE_MEMBERS, prevStep: this.state.step, hasChanges: false, invitesSent: [], invitesNotSent: [], invitesType: InviteTypes.INVITE_MEMBER});\n        }\n        if (this.modal && this.modal.current) {\n            this.modal.current.enforceFocus();\n        }\n    }\n\n    getBackFunction = () => {\n        if (this.state.step === STEPS_INVITE_CONFIRM && this.state.invitesNotSent.length > 0) {\n            return this.goToPrevStep;\n        }\n        if ((this.state.step === STEPS_INVITE_MEMBERS || this.state.step === STEPS_INVITE_GUESTS) && this.props.canInviteGuests && this.props.canAddUsers) {\n            return this.goToInitialStep;\n        }\n        return null;\n    }\n\n    onEdit = (hasChanges) => {\n        this.setState({hasChanges});\n    }\n\n    close = () => {\n        if (this.state.hasChanges) {\n            this.setState({confirmModal: true});\n        } else {\n            this.props.actions.closeModal();\n        }\n    }\n\n    confirmBack = () => {\n        this.setState({step: STEPS_INITIAL, hasChanges: false, confirmBack: false});\n    }\n\n    cancelBack= () => {\n        this.setState({confirmBack: false});\n    }\n\n    confirmClose = () => {\n        this.props.actions.closeModal();\n        this.setState({confirmModal: false});\n    }\n\n    cancelClose = () => {\n        this.setState({confirmModal: false});\n    }\n\n    onMembersSubmit = async (users, emails, extraText) => {\n        const invites = await this.props.actions.sendMembersInvites(this.props.currentTeam.id, users, emails);\n\n        if (extraText !== '') {\n            invites.notSent.push({\n                text: extraText,\n                reason: (\n                    <FormattedMessage\n                        id='invitation-modal.confirm.not-valid-user-or-email'\n                        defaultMessage='Does not match a valid user or email.'\n                    />\n                ),\n            });\n        }\n\n        this.setState({step: STEPS_INVITE_CONFIRM, prevStep: this.state.step, invitesSent: invites.sent, invitesNotSent: invites.notSent, invitesType: InviteTypes.INVITE_MEMBER, hasChanges: false});\n    }\n\n    onGuestsSubmit = async (users, emails, channels, message, extraUserText, extraChannelText) => {\n        const invites = await this.props.actions.sendGuestsInvites(\n            this.props.currentTeam.id,\n            channels.map((c) => c.id),\n            users,\n            emails,\n            message,\n        );\n        if (extraUserText !== '') {\n            invites.notSent.push({\n                text: extraUserText,\n                reason: (\n                    <FormattedMessage\n                        id='invitation-modal.confirm.not-valid-user-or-email'\n                        defaultMessage='Does not match a valid user or email.'\n                    />\n                ),\n            });\n        }\n        if (extraChannelText !== '') {\n            invites.notSent.push({\n                text: extraChannelText,\n                reason: (\n                    <FormattedMessage\n                        id='invitation-modal.confirm.not-valid-channel'\n                        defaultMessage='Does not match a valid channel name.'\n                    />\n                ),\n            });\n        }\n        this.setState({step: STEPS_INVITE_CONFIRM, prevStep: this.state.step, lastInviteChannels: channels, lastInviteMessage: message, invitesSent: invites.sent, invitesNotSent: invites.notSent, invitesType: InviteTypes.INVITE_GUEST, hasChanges: false});\n    }\n\n    render() {\n        return (\n            <RootPortal>\n                <FullScreenModal\n                    show={Boolean(this.props.show)}\n                    onClose={this.close}\n                    onGoBack={this.getBackFunction()}\n                    ref={this.modal}\n                    ariaLabelledBy='invitation_modal_title'\n                >\n                    <div\n                        data-testid='invitationModal'\n                        className='InvitationModal'\n                    >\n                        <ConfirmModal\n                            show={this.state.confirmModal || this.state.confirmBack}\n                            title={\n                                <FormattedMessage\n                                    id='invitation-modal.discard-changes.title'\n                                    defaultMessage='Discard Changes'\n                                />\n                            }\n                            message={\n                                <FormattedMessage\n                                    id='invitation-modal.discard-changes.message'\n                                    defaultMessage='You have unsent invitations, are you sure you want to discard them?'\n                                />\n                            }\n                            confirmButtonText={\n                                <FormattedMessage\n                                    id='invitation-modal.discard-changes.button'\n                                    defaultMessage='Yes, Discard'\n                                />\n                            }\n                            modalClass='invitation-modal-confirm'\n                            onConfirm={this.state.confirmModal ? this.confirmClose : this.confirmBack}\n                            onCancel={this.state.confirmModal ? this.cancelClose : this.cancelBack}\n                        />\n                        {this.state.step === STEPS_INITIAL &&\n                            <InvitationModalInitialStep\n                                teamName={this.props.currentTeam.display_name}\n                                goToMembers={this.goToMembers}\n                                goToGuests={this.goToGuests}\n                                emailInvitationsEnabled={this.props.emailInvitationsEnabled}\n                            />\n                        }\n                        {this.state.step === STEPS_INVITE_MEMBERS &&\n                            <InvitationModalMembersStep\n                                teamName={this.props.currentTeam.display_name}\n                                currentTeamId={this.props.currentTeam.id}\n                                inviteId={this.props.currentTeam.invite_id}\n                                searchProfiles={this.props.actions.searchProfiles}\n                                emailInvitationsEnabled={this.props.emailInvitationsEnabled}\n                                onSubmit={this.onMembersSubmit}\n                                onEdit={this.onEdit}\n                            />\n                        }\n                        {this.state.step === STEPS_INVITE_GUESTS &&\n                            <InvitationModalGuestsStep\n                                teamName={this.props.currentTeam.display_name}\n                                currentTeamId={this.props.currentTeam.id}\n                                myInvitableChannels={this.props.invitableChannels}\n                                searchProfiles={this.props.actions.searchProfiles}\n                                searchChannels={this.props.actions.searchChannels}\n                                defaultChannels={this.state.lastInviteChannels}\n                                defaultMessage={this.state.lastInviteMessage}\n                                emailInvitationsEnabled={this.props.emailInvitationsEnabled}\n                                onSubmit={this.onGuestsSubmit}\n                                onEdit={this.onEdit}\n                            />\n                        }\n                        {this.state.step === STEPS_INVITE_CONFIRM &&\n                            <InvitationModalConfirmStep\n                                teamName={this.props.currentTeam.display_name}\n                                currentTeamId={this.props.currentTeam.id}\n                                onDone={this.close}\n                                onInviteMore={this.goToFirstStep}\n                                invitesType={this.state.invitesType}\n                                invitesSent={this.state.invitesSent}\n                                invitesNotSent={this.state.invitesNotSent}\n                            />\n                        }\n                    </div>\n                </FullScreenModal>\n            </RootPortal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {getChannelsInCurrentTeam} from 'mattermost-redux/selectors/entities/channels';\nimport {haveIChannelPermission, haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\nimport {getConfig, getLicense} from 'mattermost-redux/selectors/entities/general';\nimport {getProfiles, searchProfiles as reduxSearchProfiles} from 'mattermost-redux/actions/users';\nimport {searchChannels as reduxSearchChannels} from 'mattermost-redux/actions/channels';\nimport {getTeam} from 'mattermost-redux/actions/teams';\nimport {Permissions} from 'mattermost-redux/constants';\n\nimport {closeModal} from 'actions/views/modals';\nimport {isModalOpen} from 'selectors/views/modals';\nimport {ModalIdentifiers, Constants} from 'utils/constants';\nimport {sendMembersInvites, sendGuestsInvites} from 'actions/invite_actions';\n\nimport InvitationModal from './invitation_modal.jsx';\n\nconst searchProfiles = (term, options = {}) => {\n    if (!term) {\n        return getProfiles(0, 20, options);\n    }\n    return reduxSearchProfiles(term, options);\n};\n\nconst searchChannels = (teamId, term) => {\n    return reduxSearchChannels(teamId, term);\n};\n\nexport function mapStateToProps(state) {\n    const config = getConfig(state);\n    const license = getLicense(state);\n    const channels = getChannelsInCurrentTeam(state);\n    const currentTeam = getCurrentTeam(state);\n    const invitableChannels = channels.filter((channel) => {\n        if (channel.type === Constants.DM_CHANNEL || channel.type === Constants.GM_CHANNEL) {\n            return false;\n        }\n        if (channel.type === Constants.PRIVATE_CHANNEL) {\n            return haveIChannelPermission(state, {channel: channel.id, team: currentTeam.id, permission: Permissions.MANAGE_PRIVATE_CHANNEL_MEMBERS});\n        }\n        return haveIChannelPermission(state, {channel: channel.id, team: currentTeam.id, permission: Permissions.MANAGE_PUBLIC_CHANNEL_MEMBERS});\n    });\n    const guestAccountsEnabled = config.EnableGuestAccounts === 'true';\n    const emailInvitationsEnabled = config.EnableEmailInvitations === 'true';\n    const isLicensed = license && license.IsLicensed === 'true';\n    const isGroupConstrained = Boolean(currentTeam.group_constrained);\n    const canInviteGuests = !isGroupConstrained && isLicensed && guestAccountsEnabled && haveITeamPermission(state, {team: currentTeam.id, permission: Permissions.INVITE_GUEST});\n\n    const canAddUsers = haveITeamPermission(state, {team: currentTeam.id, permission: Permissions.ADD_USER_TO_TEAM});\n    return {\n        invitableChannels,\n        currentTeam,\n        canInviteGuests,\n        canAddUsers,\n        emailInvitationsEnabled,\n        show: isModalOpen(state, ModalIdentifiers.INVITATION),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            closeModal: () => closeModal(ModalIdentifiers.INVITATION),\n            sendGuestsInvites,\n            sendMembersInvites,\n            searchProfiles,\n            searchChannels,\n            getTeam,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(InvitationModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class LeaveTeamIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='navbar_dropdown.leave.icon'\n                    defaultMessage='Leave Team Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='100%'\n                            height='100%'\n                            viewBox='0 0 164 164'\n                            style={style}\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path d='M26.023,164L26.023,7.035L26.022,0.32L137.658,0.32L137.658,164L124.228,164L124.228, 13.749L39.452,13.749L39.452,164L26.023, 164ZM118.876,164L118.876,18.619L58.137,32.918L58.137,149.701L118.876,164Z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n\nconst style = {\n    fillRule: 'evenodd',\n    clipRule: 'evenodd',\n    strokeLinejoin: 'round',\n    strokeMiterlimit: 1.41421,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\nimport {ActionFunc} from 'mattermost-redux/types/actions';\n\nimport Constants from 'utils/constants';\nimport {isKeyPressed} from 'utils/utils';\n\ntype Props = {\n    currentUserId: string;\n    currentTeamId: string;\n    onHide: () => void;\n    show: boolean;\n    actions: {\n        leaveTeam: (teamId: string, userId: string) => ActionFunc;\n        toggleSideBarRightMenu: () => void;\n    };\n\n}\n\nexport default class LeaveTeamModal extends React.PureComponent<Props> {\n    componentDidMount() {\n        if (this.props.show) {\n            document.addEventListener('keypress', this.handleKeyPress);\n        }\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keypress', this.handleKeyPress);\n    }\n\n    handleKeyPress = (e: KeyboardEvent) => {\n        if (isKeyPressed(e, Constants.KeyCodes.ENTER)) {\n            this.handleSubmit();\n        }\n    };\n\n    handleSubmit = () => {\n        this.props.onHide();\n        this.props.actions.leaveTeam(this.props.currentTeamId, this.props.currentUserId);\n        this.props.actions.toggleSideBarRightMenu();\n    };\n\n    render() {\n        return (\n            <Modal\n                dialogClassName='a11y__modal'\n                className='modal-confirm'\n                show={this.props.show}\n                onHide={this.props.onHide}\n                id='leaveTeamModal'\n                role='dialog'\n                aria-labelledby='leaveTeamModalLabel'\n            >\n                <Modal.Header closeButton={false}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='leaveTeamModalLabel'\n                    >\n                        <FormattedMessage\n                            id='leave_team_modal.title'\n                            defaultMessage='Leave the team?'\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <FormattedMessage\n                        id='leave_team_modal.desc'\n                        defaultMessage='You will be removed from all public and private channels.  If the team is private you will not be able to rejoin the team.  Are you sure?'\n                    />\n                </Modal.Body>\n                <Modal.Footer>\n                    <button\n                        type='button'\n                        className='btn btn-link'\n                        onClick={this.props.onHide}\n                        id='leaveTeamNo'\n                    >\n                        <FormattedMessage\n                            id='leave_team_modal.no'\n                            defaultMessage='No'\n                        />\n                    </button>\n                    <button\n                        type='button'\n                        className='btn btn-danger'\n                        onClick={this.handleSubmit}\n                        id='leaveTeamYes'\n                    >\n                        <FormattedMessage\n                            id='leave_team_modal.yes'\n                            defaultMessage='Yes'\n                        />\n                    </button>\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch} from 'redux';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {removeUserFromTeam as leaveTeam} from 'mattermost-redux/actions/teams';\nimport {GenericAction} from 'mattermost-redux/types/actions';\n\nimport {toggleSideBarRightMenuAction} from 'actions/global_actions.jsx';\nimport {ModalIdentifiers} from 'utils/constants';\n\nimport {isModalOpen} from 'selectors/views/modals';\n\nimport {GlobalState} from 'types/store';\n\nimport LeaveTeamModal from './leave_team_modal';\n\nfunction mapStateToProps(state: GlobalState) {\n    const modalId = ModalIdentifiers.LEAVE_TEAM;\n    const currentUserId = getCurrentUserId(state);\n    const currentTeamId = getCurrentTeamId(state);\n    const show = isModalOpen(state, modalId);\n    return {\n        currentUserId,\n        currentTeamId,\n        show,\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<GenericAction>) {\n    return {\n        actions: bindActionCreators({\n            leaveTeam,\n            toggleSideBarRightMenu: toggleSideBarRightMenuAction,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(LeaveTeamModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport SearchableUserList from './searchable_user_list.jsx';\n\nexport default class SearchableUserListContainer extends React.Component {\n    static propTypes = {\n        users: PropTypes.arrayOf(PropTypes.object),\n        usersPerPage: PropTypes.number,\n        total: PropTypes.number,\n        extraInfo: PropTypes.object,\n        nextPage: PropTypes.func.isRequired,\n        search: PropTypes.func.isRequired,\n        actions: PropTypes.arrayOf(PropTypes.func),\n        actionProps: PropTypes.object,\n        actionUserProps: PropTypes.object,\n        focusOnMount: PropTypes.bool,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            term: '',\n            page: 0,\n        };\n    }\n\n    handleTermChange = (term) => {\n        this.setState({term});\n    }\n\n    nextPage = () => {\n        this.setState({page: this.state.page + 1});\n\n        this.props.nextPage(this.state.page + 1);\n    }\n\n    previousPage = () => {\n        this.setState({page: this.state.page - 1});\n    }\n\n    search = (term) => {\n        this.props.search(term);\n\n        if (term !== '') {\n            this.setState({page: 0});\n        }\n    }\n\n    render() {\n        return (\n            <SearchableUserList\n                {...this.props}\n                nextPage={this.nextPage}\n                previousPage={this.previousPage}\n                search={this.search}\n                page={this.state.page}\n                term={this.state.term}\n                onTermChange={this.handleTermChange}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {FormattedMessage} from 'react-intl';\n\nexport default class DropdownIcon extends React.PureComponent {\n    render() {\n        return (\n            <FormattedMessage\n                id='generic_icons.dropdown'\n                defaultMessage='Dropdown Icon'\n            >\n                {(title) => (\n                    <i\n                        className='fa fa-angle-down'\n                        title={title}\n                    />\n                )}\n            </FormattedMessage>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {browserHistory} from 'utils/browser_history';\nimport * as Utils from 'utils/utils.jsx';\nimport ConfirmModal from 'components/confirm_modal';\nimport DropdownIcon from 'components/widgets/icons/fa_dropdown_icon';\n\nimport Menu from 'components/widgets/menu/menu';\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\n\nconst ROWS_FROM_BOTTOM_TO_OPEN_UP = 3;\n\nexport default class TeamMembersDropdown extends React.Component {\n    static propTypes = {\n        user: PropTypes.object.isRequired,\n        currentUser: PropTypes.object.isRequired,\n        teamMember: PropTypes.object.isRequired,\n        teamUrl: PropTypes.string.isRequired,\n        currentTeam: PropTypes.object.isRequired,\n        index: PropTypes.number.isRequired,\n        totalUsers: PropTypes.number.isRequired,\n        actions: PropTypes.shape({\n            getMyTeamMembers: PropTypes.func.isRequired,\n            getMyTeamUnreads: PropTypes.func.isRequired,\n            getUser: PropTypes.func.isRequired,\n            getTeamMember: PropTypes.func.isRequired,\n            getTeamStats: PropTypes.func.isRequired,\n            getChannelStats: PropTypes.func.isRequired,\n            updateTeamMemberSchemeRoles: PropTypes.func.isRequired,\n            removeUserFromTeamAndGetStats: PropTypes.func.isRequired,\n            updateUserActive: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            serverError: null,\n            showDemoteModal: false,\n            user: null,\n            role: null,\n        };\n    }\n\n    handleMakeMember = async () => {\n        const me = this.props.currentUser;\n        if (this.props.user.id === me.id && me.roles.includes('system_admin')) {\n            this.handleDemote(this.props.user, 'team_user');\n        } else {\n            const {error} = await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id, this.props.user.id, true, false);\n            if (error) {\n                this.setState({serverError: error.message});\n            } else {\n                this.props.actions.getUser(this.props.user.id);\n                this.props.actions.getTeamMember(this.props.teamMember.team_id, this.props.user.id);\n                if (this.props.user.id === me.id) {\n                    await this.props.actions.getMyTeamMembers();\n                    this.props.actions.getMyTeamUnreads();\n                }\n            }\n        }\n    }\n\n    handleRemoveFromTeam = async () => {\n        const {error} = await this.props.actions.removeUserFromTeamAndGetStats(this.props.teamMember.team_id, this.props.user.id);\n        if (error) {\n            this.setState({serverError: error.message});\n        }\n    }\n\n    handleMakeAdmin = async () => {\n        const me = this.props.currentUser;\n        if (this.props.user.id === me.id && me.roles.includes('system_admin')) {\n            this.handleDemote(this.props.user, 'team_user team_admin');\n        } else {\n            const {error} = await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id, this.props.user.id, true, true);\n            if (error) {\n                this.setState({serverError: error.message});\n            } else {\n                this.props.actions.getUser(this.props.user.id);\n                this.props.actions.getTeamMember(this.props.teamMember.team_id, this.props.user.id);\n            }\n        }\n    }\n\n    handleDemote = (user, role, newRole) => {\n        this.setState({\n            serverError: this.state.serverError,\n            showDemoteModal: true,\n            user,\n            role,\n            newRole,\n        });\n    }\n\n    handleDemoteCancel = () => {\n        this.setState({\n            serverError: null,\n            showDemoteModal: false,\n            user: null,\n            role: null,\n            newRole: null,\n        });\n    }\n\n    handleDemoteSubmit = async () => {\n        const {error} = await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id, this.props.user.id, true, false);\n        if (error) {\n            this.setState({serverError: error.message});\n        } else {\n            this.props.actions.getUser(this.props.user.id);\n            browserHistory.push(this.props.teamUrl);\n        }\n    }\n\n    render() {\n        let serverError = null;\n        if (this.state.serverError) {\n            serverError = (\n                <div className='has-error'>\n                    <label className='has-error control-label'>{this.state.serverError}</label>\n                </div>\n            );\n        }\n\n        const {currentTeam, teamMember, user} = this.props;\n\n        let currentRoles = null;\n\n        if (Utils.isGuest(user)) {\n            currentRoles = (\n                <FormattedMessage\n                    id='team_members_dropdown.guest'\n                    defaultMessage='Guest'\n                />\n            );\n        } else if (user.roles.length > 0 && Utils.isSystemAdmin(user.roles)) {\n            currentRoles = (\n                <FormattedMessage\n                    id='team_members_dropdown.systemAdmin'\n                    defaultMessage='System Admin'\n                />\n            );\n        } else if ((teamMember.roles.length > 0 && Utils.isAdmin(teamMember.roles)) || teamMember.scheme_admin) {\n            currentRoles = (\n                <FormattedMessage\n                    id='team_members_dropdown.teamAdmin'\n                    defaultMessage='Team Admin'\n                />\n            );\n        } else {\n            currentRoles = (\n                <FormattedMessage\n                    id='team_members_dropdown.member'\n                    defaultMessage='Member'\n                />\n            );\n        }\n\n        const me = this.props.currentUser;\n        let showMakeMember = !Utils.isGuest(user) && (Utils.isAdmin(teamMember.roles) || teamMember.scheme_admin) && !Utils.isSystemAdmin(user.roles);\n        let showMakeAdmin = !Utils.isGuest(user) && !Utils.isAdmin(teamMember.roles) && !Utils.isSystemAdmin(user.roles) && !teamMember.scheme_admin;\n\n        if (user.delete_at > 0) {\n            currentRoles = (\n                <FormattedMessage\n                    id='team_members_dropdown.inactive'\n                    defaultMessage='Inactive'\n                />\n            );\n            showMakeMember = false;\n            showMakeAdmin = false;\n        }\n\n        const canRemoveFromTeam = user.id !== me.id && (!currentTeam.group_constrained || user.is_bot);\n\n        let makeDemoteModal = null;\n        if (user.id === me.id) {\n            const title = (\n                <FormattedMessage\n                    id='team_members_dropdown.confirmDemoteRoleTitle'\n                    defaultMessage='Confirm Demotion from System Admin Role'\n                />\n            );\n\n            const message = (\n                <div>\n                    <FormattedMessage\n                        id='team_members_dropdown.confirmDemoteDescription'\n                        defaultMessage=\"If you demote yourself from the System Admin role and there is not another user with System Admin privileges, you'll need to re-assign a System Admin by accessing the Mattermost server through a terminal and running the following command.\"\n                    />\n                    <br/>\n                    <br/>\n                    <FormattedMessage\n                        id='team_members_dropdown.confirmDemotionCmd'\n                        defaultMessage='platform roles system_admin {username}'\n                        vallues={{\n                            username: me.username,\n                        }}\n                    />\n                    {serverError}\n                </div>\n            );\n\n            const confirmButton = (\n                <FormattedMessage\n                    id='team_members_dropdown.confirmDemotion'\n                    defaultMessage='Confirm Demotion'\n                />\n            );\n\n            makeDemoteModal = (\n                <ConfirmModal\n                    show={this.state.showDemoteModal}\n                    title={title}\n                    message={message}\n                    confirmButtonText={confirmButton}\n                    onConfirm={this.handleDemoteSubmit}\n                    onCancel={this.handleDemoteCancel}\n                />\n            );\n        }\n\n        if (!canRemoveFromTeam && !showMakeAdmin && !showMakeMember) {\n            return <div>{currentRoles}</div>;\n        }\n\n        const {index, totalUsers} = this.props;\n        let openUp = false;\n        if (totalUsers > ROWS_FROM_BOTTOM_TO_OPEN_UP && totalUsers - index <= ROWS_FROM_BOTTOM_TO_OPEN_UP) {\n            openUp = true;\n        }\n\n        return (\n            <MenuWrapper>\n                <button\n                    id={`teamMembersDropdown_${user.username}`}\n                    className='dropdown-toggle theme color--link style--none'\n                    type='button'\n                    aria-expanded='true'\n                >\n                    <span>{currentRoles} </span>\n                    <DropdownIcon/>\n                </button>\n                <div>\n                    <Menu\n                        openLeft={true}\n                        openUp={openUp}\n                        ariaLabel={Utils.localizeMessage('team_members_dropdown.menuAriaLabel', 'Change the role of a team member')}\n                    >\n                        <Menu.ItemAction\n                            id='removeFromTeam'\n                            show={canRemoveFromTeam}\n                            onClick={this.handleRemoveFromTeam}\n                            text={Utils.localizeMessage('team_members_dropdown.leave_team', 'Remove From Team')}\n                        />\n                        <Menu.ItemAction\n                            show={showMakeAdmin}\n                            onClick={this.handleMakeAdmin}\n                            text={Utils.localizeMessage('team_members_dropdown.makeAdmin', 'Make Team Admin')}\n                        />\n                        <Menu.ItemAction\n                            show={showMakeMember}\n                            onClick={this.handleMakeMember}\n                            text={Utils.localizeMessage('team_members_dropdown.makeMember', 'Make Member')}\n                        />\n                    </Menu>\n                    {makeDemoteModal}\n                    {serverError}\n                </div>\n            </MenuWrapper>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getChannelStats} from 'mattermost-redux/actions/channels';\nimport {\n    getMyTeamMembers,\n    getMyTeamUnreads,\n    getTeamStats,\n    getTeamMember,\n    updateTeamMemberSchemeRoles,\n} from 'mattermost-redux/actions/teams';\nimport {getUser, updateUserActive} from 'mattermost-redux/actions/users';\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentRelativeTeamUrl, getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\n\nimport {removeUserFromTeamAndGetStats} from 'actions/team_actions.jsx';\n\nimport TeamMembersDropdown from './team_members_dropdown.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        currentUser: getCurrentUser(state),\n        currentChannelId: getCurrentChannelId(state),\n        teamUrl: getCurrentRelativeTeamUrl(state),\n        currentTeam: getCurrentTeam(state),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            getMyTeamMembers,\n            getMyTeamUnreads,\n            getUser,\n            getTeamMember,\n            getTeamStats,\n            getChannelStats,\n            updateUserActive,\n            updateTeamMemberSchemeRoles,\n            removeUserFromTeamAndGetStats,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TeamMembersDropdown);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {UserProfile} from 'mattermost-redux/types/users';\nimport {TeamMembership} from 'mattermost-redux/types/teams';\n\nimport Constants from 'utils/constants';\nimport * as UserAgent from 'utils/user_agent';\n\nimport SearchableUserList from 'components/searchable_user_list/searchable_user_list_container.jsx';\nimport TeamMembersDropdown from 'components/team_members_dropdown';\n\nconst USERS_PER_PAGE = 50;\n\ntype Props = {\n    searchTerm: string;\n    users: Array<UserProfile>;\n    teamMembers: {\n        [userId: string]: TeamMembership;\n    };\n    currentTeamId: string;\n    totalTeamMembers: number;\n    canManageTeamMembers?: boolean;\n    actions: {\n        getTeamMembers: (teamId: string) => Promise<{data: {}}>;\n        searchProfiles: (term: string, options?: {}) => Promise<{data: UserProfile[]}>;\n        getTeamStats: (teamId: string) => Promise<{data: {}}>;\n        loadProfilesAndTeamMembers: (page: number, perPage: number, teamId?: string, options?: {}) => Promise<{\n            data: boolean;\n        }>;\n        loadStatusesForProfilesList: (users: Array<UserProfile>) => Promise<{\n            data: boolean;\n        }>;\n        loadTeamMembersForProfilesList: (profiles: any, teamId: string) => Promise<{\n            data: boolean;\n        }>;\n        setModalSearchTerm: (term: string) => Promise<{\n            data: boolean;\n        }>;\n    };\n}\n\ntype State = {\n    loading: boolean;\n}\n\nexport default class MemberListTeam extends React.Component<Props, State> {\n    private searchTimeoutId: number;\n\n    constructor(props: Props) {\n        super(props);\n\n        this.searchTimeoutId = 0;\n\n        this.state = {\n            loading: true,\n        };\n    }\n\n    async componentDidMount() {\n        await Promise.all([\n            this.props.actions.loadProfilesAndTeamMembers(0, Constants.PROFILE_CHUNK_SIZE, this.props.currentTeamId),\n            this.props.actions.getTeamMembers(this.props.currentTeamId),\n            this.props.actions.getTeamStats(this.props.currentTeamId),\n        ]);\n        this.loadComplete();\n    }\n\n    componentWillUnmount() {\n        this.props.actions.setModalSearchTerm('');\n    }\n\n    componentDidUpdate(prevProps: Props) {\n        if (prevProps.searchTerm !== this.props.searchTerm) {\n            clearTimeout(this.searchTimeoutId);\n\n            const searchTerm = this.props.searchTerm;\n            if (searchTerm === '') {\n                this.loadComplete();\n                this.searchTimeoutId = 0;\n                return;\n            }\n\n            const searchTimeoutId = window.setTimeout(\n                async () => {\n                    const {\n                        loadStatusesForProfilesList,\n                        loadTeamMembersForProfilesList,\n                        searchProfiles,\n                    } = this.props.actions;\n                    const {data} = await searchProfiles(searchTerm, {team_id: this.props.currentTeamId});\n\n                    if (searchTimeoutId !== this.searchTimeoutId) {\n                        return;\n                    }\n\n                    this.setState({loading: true});\n\n                    loadStatusesForProfilesList(data);\n                    loadTeamMembersForProfilesList(data, this.props.currentTeamId).then(({data: membersLoaded}) => {\n                        if (membersLoaded) {\n                            this.loadComplete();\n                        }\n                    });\n                },\n                Constants.SEARCH_TIMEOUT_MILLISECONDS\n            );\n\n            this.searchTimeoutId = searchTimeoutId;\n        }\n    }\n\n    loadComplete = () => {\n        this.setState({loading: false});\n    }\n\n    nextPage = (page: number) => {\n        this.props.actions.loadProfilesAndTeamMembers(page + 1, USERS_PER_PAGE);\n    }\n\n    search = (term: string) => {\n        this.props.actions.setModalSearchTerm(term);\n    }\n\n    render() {\n        let teamMembersDropdown = null;\n        if (this.props.canManageTeamMembers) {\n            teamMembersDropdown = [TeamMembersDropdown];\n        }\n\n        const teamMembers = this.props.teamMembers;\n        const users = this.props.users;\n        const actionUserProps: {\n            [userId: string]: {\n                teamMember: TeamMembership;\n            };\n        } = {};\n\n        let usersToDisplay;\n        if (this.state.loading) {\n            usersToDisplay = null;\n        } else {\n            usersToDisplay = [];\n\n            for (let i = 0; i < users.length; i++) {\n                const user = users[i];\n\n                if (teamMembers[user.id] && user.delete_at === 0) {\n                    usersToDisplay.push(user);\n                    actionUserProps[user.id] = {\n                        teamMember: teamMembers[user.id],\n                    };\n                }\n            }\n        }\n\n        return (\n            <SearchableUserList\n                users={usersToDisplay}\n                usersPerPage={USERS_PER_PAGE}\n                total={this.props.totalTeamMembers}\n                nextPage={this.nextPage}\n                search={this.search}\n                actions={teamMembersDropdown}\n                actionUserProps={actionUserProps}\n                focusOnMount={!UserAgent.isMobile()}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch, ActionCreatorsMapObject} from 'redux';\n\nimport {getTeamStats, getTeamMembers} from 'mattermost-redux/actions/teams';\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\nimport {getMembersInCurrentTeam, getCurrentTeamStats} from 'mattermost-redux/selectors/entities/teams';\nimport {getProfilesInCurrentTeam, searchProfilesInCurrentTeam} from 'mattermost-redux/selectors/entities/users';\nimport {Permissions} from 'mattermost-redux/constants';\nimport {searchProfiles} from 'mattermost-redux/actions/users';\nimport {ActionFunc} from 'mattermost-redux/types/actions';\nimport {UserProfile} from 'mattermost-redux/types/users';\n\nimport {loadStatusesForProfilesList} from 'actions/status_actions.jsx';\nimport {loadProfilesAndTeamMembers, loadTeamMembersForProfilesList} from 'actions/user_actions.jsx';\nimport {setModalSearchTerm} from 'actions/views/search';\n\nimport {GlobalState} from 'types/store';\n\nimport MemberListTeam from './member_list_team';\n\ntype Props = {\n    teamId: string;\n}\n\ntype Actions = {\n    getTeamMembers: (teamId: string) => Promise<{data: {}}>;\n    searchProfiles: (term: string, options?: {}) => Promise<{data: UserProfile[]}>;\n    getTeamStats: (teamId: string) => Promise<{data: {}}>;\n    loadProfilesAndTeamMembers: (page: number, perPage: number, teamId?: string, options?: {}) => Promise<{\n        data: boolean;\n    }>;\n    loadStatusesForProfilesList: (users: Array<UserProfile>) => Promise<{\n        data: boolean;\n    }>;\n    loadTeamMembersForProfilesList: (profiles: any, teamId: string) => Promise<{\n        data: boolean;\n    }>;\n    setModalSearchTerm: (term: string) => Promise<{\n        data: boolean;\n    }>;\n}\n\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\n    const canManageTeamMembers = haveITeamPermission(state, {team: ownProps.teamId, permission: Permissions.MANAGE_TEAM_ROLES});\n\n    const searchTerm = state.views.search.modalSearch;\n\n    let users;\n    if (searchTerm) {\n        users = searchProfilesInCurrentTeam(state, searchTerm);\n    } else {\n        users = getProfilesInCurrentTeam(state);\n    }\n\n    const stats = getCurrentTeamStats(state) || {active_member_count: 0};\n\n    return {\n        searchTerm,\n        users,\n        teamMembers: getMembersInCurrentTeam(state) || {},\n        currentTeamId: state.entities.teams.currentTeamId,\n        totalTeamMembers: stats.active_member_count,\n        canManageTeamMembers,\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch) {\n    return {\n        actions: bindActionCreators<ActionCreatorsMapObject<ActionFunc>, Actions>({\n            searchProfiles,\n            getTeamStats,\n            getTeamMembers,\n            loadProfilesAndTeamMembers,\n            loadStatusesForProfilesList,\n            loadTeamMembersForProfilesList,\n            setModalSearchTerm,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MemberListTeam);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport Permissions from 'mattermost-redux/constants/permissions';\n\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\nimport MemberListTeam from 'components/member_list_team';\nimport InvitationModal from 'components/invitation_modal';\n\nimport {ModalIdentifiers} from 'utils/constants';\n\ntype Props = {\n    currentTeam: {\n        id: string;\n        display_name: string;\n    };\n    onHide: () => void;\n    onLoad?: () => void;\n    actions: {\n        openModal: (modalData: {modalId: string; dialogType: any}) => Promise<{\n            data: boolean;\n        }>;\n    };\n}\n\ntype State = {\n    show: boolean;\n}\n\nexport default class TeamMembersModal extends React.PureComponent<Props, State> {\n    constructor(props: Props) {\n        super(props);\n\n        this.state = {\n            show: true,\n        };\n    }\n\n    componentDidMount() {\n        if (this.props.onLoad) {\n            this.props.onLoad();\n        }\n    }\n\n    onHide = () => {\n        this.setState({show: false});\n    }\n\n    handleInvitePeople = () => {\n        const modalData = {\n            modalId: ModalIdentifiers.INVITATION,\n            dialogType: InvitationModal,\n        };\n        this.props.actions.openModal(modalData);\n        this.setState({show: false});\n    }\n\n    render() {\n        let teamDisplayName = '';\n        if (this.props.currentTeam) {\n            teamDisplayName = this.props.currentTeam.display_name;\n        }\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal more-modal'\n                show={this.state.show}\n                onHide={this.onHide}\n                onExited={this.props.onHide}\n                role='dialog'\n                aria-labelledby='teamMemberModalLabel'\n                id='teamMembersModal'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='teamMemberModalLabel'\n                    >\n                        <FormattedMessage\n                            id='team_member_modal.members'\n                            defaultMessage='{team} Members'\n                            values={{\n                                team: teamDisplayName,\n                            }}\n                        />\n                    </Modal.Title>\n                    <TeamPermissionGate\n                        teamId={this.props.currentTeam.id}\n                        permissions={[Permissions.ADD_USER_TO_TEAM, Permissions.INVITE_GUEST]}\n                    >\n                        <button\n                            id='invitePeople'\n                            type='button'\n                            className='btn btn-primary invite-people-btn'\n                            onClick={this.handleInvitePeople}\n                        >\n                            <FormattedMessage\n                                id='team_member_modal.invitePeople'\n                                defaultMessage='Invite People'\n                            />\n                        </button>\n                    </TeamPermissionGate>\n                </Modal.Header>\n                <Modal.Body>\n                    <MemberListTeam\n                        teamId={this.props.currentTeam.id}\n                    />\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch, ActionCreatorsMapObject} from 'redux';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {ActionFunc} from 'mattermost-redux/types/actions';\n\nimport {ModalIdentifiers} from 'utils/constants';\nimport {isModalOpen} from 'selectors/views/modals';\nimport {openModal} from 'actions/views/modals';\n\nimport {GlobalState} from 'types/store';\n\nimport TeamMembersModal from './team_members_modal';\n\ntype Actions = {\n    openModal: (modalData: {modalId: string; dialogType: React.Component }) => Promise<{\n        data: boolean;\n    }>;\n}\n\nfunction mapStateToProps(state: GlobalState) {\n    const modalId = ModalIdentifiers.TEAM_MEMBERS;\n    return {\n        currentTeam: getCurrentTeam(state),\n        show: isModalOpen(state, modalId),\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch) {\n    return {\n        actions: bindActionCreators<ActionCreatorsMapObject<ActionFunc>, Actions>({\n            openModal,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TeamMembersModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage, FormattedDate} from 'react-intl';\n\nimport Constants from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\nimport SettingItemMax from 'components/setting_item_max.jsx';\nimport SettingItemMin from 'components/setting_item_min';\nimport SettingPicture from 'components/setting_picture.jsx';\nimport BackIcon from 'components/widgets/icons/fa_back_icon';\nimport LocalizedInput from 'components/localized_input/localized_input';\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\n\nimport {t} from 'utils/i18n.jsx';\n\nconst ACCEPTED_TEAM_IMAGE_TYPES = ['image/jpeg', 'image/png', 'image/bmp'];\n\nexport default class GeneralTab extends React.Component {\n    static propTypes = {\n        updateSection: PropTypes.func.isRequired,\n        team: PropTypes.object.isRequired,\n        activeSection: PropTypes.string.isRequired,\n        closeModal: PropTypes.func.isRequired,\n        collapseModal: PropTypes.func.isRequired,\n        maxFileSize: PropTypes.number.isRequired,\n        actions: PropTypes.shape({\n            getTeam: PropTypes.func.isRequired,\n            patchTeam: PropTypes.func.isRequired,\n            regenerateTeamInviteId: PropTypes.func.isRequired,\n            removeTeamIcon: PropTypes.func.isRequired,\n            setTeamIcon: PropTypes.func.isRequired,\n        }).isRequired,\n        canInviteTeamMembers: PropTypes.bool.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n        this.state = this.setupInitialState(props);\n    }\n\n    updateSection = (section) => {\n        this.setState(this.setupInitialState(this.props));\n        this.props.updateSection(section);\n    }\n\n    setupInitialState(props) {\n        const team = props.team;\n\n        return {\n            name: team.display_name,\n            invite_id: team.invite_id,\n            allow_open_invite: team.allow_open_invite,\n            description: team.description,\n            allowed_domains: team.allowed_domains,\n            serverError: '',\n            clientError: '',\n            teamIconFile: null,\n            loadingIcon: false,\n            submitActive: false,\n            isInitialState: true,\n        };\n    }\n\n    static getDerivedStateFromProps(nextProps, prevState) {\n        const {team} = nextProps;\n        if (!prevState.isInitialState) {\n            return {\n                name: team.display_name,\n                description: team.description,\n                allowed_domains: team.allowed_domains,\n                invite_id: team.invite_id,\n                allow_open_invite: team.allow_open_invite,\n                isInitialState: false,\n            };\n        }\n        return null;\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (!prevState.shouldFetchTeam && this.state.shouldFetchTeam) {\n            this.fetchTeam();\n        }\n    }\n\n    fetchTeam() {\n        if (this.state.serverError) {\n            return;\n        }\n        this.props.actions.getTeam(this.props.team.id).then(({error}) => {\n            const state = {\n                shouldFetchTeam: false,\n            };\n            if (error) {\n                state.serverError = error.message;\n            }\n            this.setState(state);\n        });\n    }\n\n    handleOpenInviteRadio = (openInvite) => {\n        this.setState({allow_open_invite: openInvite});\n    }\n\n    handleAllowedDomainsSubmit = async () => {\n        var state = {serverError: '', clientError: ''};\n\n        var data = {...this.props.team};\n        data.allowed_domains = this.state.allowed_domains;\n\n        const {error} = await this.props.actions.patchTeam(data);\n\n        if (error) {\n            state.serverError = error.message;\n            this.setState(state);\n        } else {\n            this.updateSection('');\n        }\n    }\n\n    handleOpenInviteSubmit = async () => {\n        var state = {serverError: '', clientError: ''};\n\n        var data = {...this.props.team};\n        data.allow_open_invite = this.state.allow_open_invite;\n\n        const {error} = await this.props.actions.patchTeam(data);\n\n        if (error) {\n            state.serverError = error.message;\n            this.setState(state);\n        } else {\n            this.updateSection('');\n        }\n    }\n\n    handleNameSubmit = async () => {\n        var state = {serverError: '', clientError: ''};\n        let valid = true;\n\n        const name = this.state.name.trim();\n\n        if (!name) {\n            state.clientError = Utils.localizeMessage('general_tab.required', 'This field is required');\n            valid = false;\n        } else if (name.length < Constants.MIN_TEAMNAME_LENGTH) {\n            state.clientError = (\n                <FormattedMessage\n                    id='general_tab.teamNameRestrictions'\n                    defaultMessage='Team Name must be {min} or more characters up to a maximum of {max}. You can add a longer team description.'\n                    values={{\n                        min: Constants.MIN_TEAMNAME_LENGTH,\n                        max: Constants.MAX_TEAMNAME_LENGTH,\n                    }}\n                />\n            );\n\n            valid = false;\n        } else {\n            state.clientError = '';\n        }\n\n        this.setState(state);\n\n        if (!valid) {\n            return;\n        }\n\n        var data = {...this.props.team};\n        data.display_name = this.state.name;\n\n        const {error} = await this.props.actions.patchTeam(data);\n\n        if (error) {\n            state.serverError = error.message;\n            this.setState(state);\n        } else {\n            this.updateSection('');\n        }\n    }\n\n    handleInviteIdSubmit = async () => {\n        const state = {serverError: '', clientError: ''};\n        this.setState(state);\n\n        const {error} = await this.props.actions.regenerateTeamInviteId(this.props.team.id);\n\n        if (error) {\n            state.serverError = error.message;\n            this.setState(state);\n        } else {\n            this.updateSection('');\n        }\n    }\n\n    handleClose = () => {\n        this.updateSection('');\n    }\n\n    handleDescriptionSubmit = async () => {\n        var state = {serverError: '', clientError: ''};\n        let valid = true;\n\n        const description = this.state.description.trim();\n        if (description === this.props.team.description) {\n            state.clientError = Utils.localizeMessage('general_tab.chooseDescription', 'Please choose a new description for your team');\n            valid = false;\n        } else {\n            state.clientError = '';\n        }\n\n        this.setState(state);\n\n        if (!valid) {\n            return;\n        }\n\n        var data = {...this.props.team};\n        data.description = this.state.description;\n\n        const {error} = await this.props.actions.patchTeam(data);\n\n        if (error) {\n            state.serverError = error.message;\n            this.setState(state);\n        } else {\n            this.updateSection('');\n        }\n    }\n\n    handleTeamIconSubmit = async () => {\n        if (!this.state.teamIconFile) {\n            return;\n        }\n\n        if (!this.state.submitActive) {\n            return;\n        }\n\n        this.setState({\n            loadingIcon: true,\n            clientError: '',\n            serverError: '',\n        });\n\n        const {error} = await this.props.actions.setTeamIcon(this.props.team.id, this.state.teamIconFile);\n\n        if (error) {\n            this.setState({\n                loadingIcon: false,\n                serverError: error.message,\n            });\n        } else {\n            this.setState({\n                loadingIcon: false,\n                submitActive: false,\n            });\n            this.updateSection('');\n        }\n    }\n\n    handleTeamIconRemove = async () => {\n        this.setState({\n            loadingIcon: true,\n            clientError: '',\n            serverError: '',\n        });\n\n        const {error} = await this.props.actions.removeTeamIcon(this.props.team.id);\n\n        if (error) {\n            this.setState({\n                loadingIcon: false,\n                serverError: error.message,\n            });\n        } else {\n            this.setState({\n                loadingIcon: false,\n                submitActive: false,\n            });\n            this.updateSection('');\n        }\n    }\n\n    componentDidMount() {\n        $('#team_settings').on('hidden.bs.modal', this.handleClose);\n    }\n\n    componentWillUnmount() {\n        $('#team_settings').off('hidden.bs.modal', this.handleClose);\n    }\n\n    handleUpdateSection = (section) => {\n        if (section === 'invite_id' && this.props.activeSection !== section && !this.props.team.invite_id) {\n            this.setState({shouldFetchTeam: true}, () => {\n                this.updateSection(section);\n            });\n            return;\n        }\n\n        this.updateSection(section);\n    }\n\n    updateName = (e) => {\n        this.setState({name: e.target.value});\n    }\n\n    updateDescription = (e) => {\n        this.setState({description: e.target.value});\n    }\n\n    updateTeamIcon = (e) => {\n        if (e && e.target && e.target.files && e.target.files[0]) {\n            const file = e.target.files[0];\n\n            if (!ACCEPTED_TEAM_IMAGE_TYPES.includes(file.type)) {\n                this.setState({\n                    clientError: Utils.localizeMessage('general_tab.teamIconInvalidFileType', 'Only BMP, JPG or PNG images may be used for team icons'),\n                });\n            } else if (file.size > this.props.maxFileSize) {\n                this.setState({\n                    clientError: Utils.localizeMessage('general_tab.teamIconTooLarge', 'Unable to upload team icon. File is too large.'),\n                });\n            } else {\n                this.setState({\n                    teamIconFile: e.target.files[0],\n                    clientError: '',\n                    submitActive: true,\n                });\n            }\n        } else {\n            this.setState({\n                teamIconFile: null,\n                clientError: Utils.localizeMessage('general_tab.teamIconError', 'An error occurred while selecting the image.'),\n            });\n        }\n    }\n\n    updateAllowedDomains = (e) => {\n        this.setState({allowed_domains: e.target.value});\n    }\n\n    render() {\n        const team = this.props.team;\n\n        let clientError = null;\n        let serverError = null;\n\n        if (this.state.clientError) {\n            clientError = this.state.clientError;\n        }\n        if (this.state.serverError) {\n            serverError = this.state.serverError;\n        }\n\n        let openInviteSection;\n        if (this.props.activeSection === 'open_invite') {\n            let inputs;\n\n            if (team.group_constrained) {\n                inputs = [\n                    <div key='userOpenInviteOptions'>\n                        <div>\n                            <FormattedMarkdownMessage\n                                id='team_settings.openInviteDescription.groupConstrained'\n                                defaultMessage='No, members of this team are added and removed by linked groups. [Learn More](!https://mattermost.com/pl/default-ldap-group-constrained-team-channel.html)'\n                            />\n                        </div>\n                    </div>,\n                ];\n            } else {\n                inputs = [\n                    <fieldset key='userOpenInviteOptions'>\n                        <legend className='form-legend hidden-label'>\n                            <FormattedMessage\n                                id='team_settings.openInviteDescription.ariaLabel'\n                                defaultMessage='Invite Code'\n                            />\n                        </legend>\n                        <div className='radio'>\n                            <label>\n                                <input\n                                    id='teamOpenInvite'\n                                    name='userOpenInviteOptions'\n                                    type='radio'\n                                    defaultChecked={this.state.allow_open_invite}\n                                    onChange={this.handleOpenInviteRadio.bind(this, true)}\n                                />\n                                <FormattedMessage\n                                    id='general_tab.yes'\n                                    defaultMessage='Yes'\n                                />\n                            </label>\n                            <br/>\n                        </div>\n                        <div className='radio'>\n                            <label>\n                                <input\n                                    id='teamOpenInviteNo'\n                                    name='userOpenInviteOptions'\n                                    type='radio'\n                                    defaultChecked={!this.state.allow_open_invite}\n                                    onChange={this.handleOpenInviteRadio.bind(this, false)}\n                                />\n                                <FormattedMessage\n                                    id='general_tab.no'\n                                    defaultMessage='No'\n                                />\n                            </label>\n                            <br/>\n                        </div>\n                        <div className='mt-5'>\n                            <FormattedMessage\n                                id='general_tab.openInviteDesc'\n                                defaultMessage='When allowed, a link to this team will be included on the landing page allowing anyone with an account to join this team.'\n                            />\n                        </div>\n                    </fieldset>,\n                ];\n            }\n\n            openInviteSection = (\n                <SettingItemMax\n                    title={Utils.localizeMessage('general_tab.openInviteTitle', 'Allow any user with an account on this server to join this team')}\n                    inputs={inputs}\n                    submit={this.handleOpenInviteSubmit}\n                    serverError={serverError}\n                    updateSection={this.handleUpdateSection}\n                />\n            );\n        } else {\n            let describe = '';\n            if (this.state.allow_open_invite === true) {\n                describe = Utils.localizeMessage('general_tab.yes', 'Yes');\n            } else if (team.group_constrained) {\n                describe = Utils.localizeMessage('team_settings.openInviteSetting.groupConstrained', 'No, members of this team are added and removed by linked groups.');\n            } else {\n                describe = Utils.localizeMessage('general_tab.no', 'No');\n            }\n\n            openInviteSection = (\n                <SettingItemMin\n                    title={Utils.localizeMessage('general_tab.openInviteTitle', 'Allow any user with an account on this server to join this team')}\n                    describe={describe}\n                    updateSection={this.handleUpdateSection}\n                    section={'open_invite'}\n                />\n            );\n        }\n\n        let inviteSection;\n\n        if (this.props.activeSection === 'invite_id' && this.props.canInviteTeamMembers) {\n            const inputs = [];\n\n            inputs.push(\n                <div key='teamInviteSetting'>\n                    <div className='row'>\n                        <label className='col-sm-5 control-label visible-xs-block'/>\n                        <div className='col-sm-12'>\n                            <input\n                                id='teamInviteId'\n                                autoFocus={true}\n                                className='form-control'\n                                type='text'\n                                value={this.state.invite_id}\n                                maxLength='32'\n                                onFocus={Utils.moveCursorToEnd}\n                                readOnly={true}\n                            />\n                        </div>\n                    </div>\n                    <div className='setting-list__hint'>\n                        <FormattedMessage\n                            id='general_tab.codeLongDesc'\n                            defaultMessage='The Invite Code is part of the unique team invitation link which is sent to members youre inviting to this team. Regenerating the code creates a new invitation link and invalidates the previous link.'\n                            values={{\n                                getTeamInviteLink: (\n                                    <strong>\n                                        <FormattedMessage\n                                            id='general_tab.getTeamInviteLink'\n                                            defaultMessage='Get Team Invite Link'\n                                        />\n                                    </strong>\n                                ),\n                            }}\n                        />\n                    </div>\n                </div>\n            );\n\n            inviteSection = (\n                <SettingItemMax\n                    title={Utils.localizeMessage('general_tab.codeTitle', 'Invite Code')}\n                    inputs={inputs}\n                    submit={this.handleInviteIdSubmit}\n                    serverError={serverError}\n                    clientError={clientError}\n                    updateSection={this.handleUpdateSection}\n                    saveButtonText={Utils.localizeMessage('general_tab.regenerate', 'Regenerate')}\n                />\n            );\n        } else if (this.props.canInviteTeamMembers) {\n            inviteSection = (\n                <SettingItemMin\n                    title={Utils.localizeMessage('general_tab.codeTitle', 'Invite Code')}\n                    describe={Utils.localizeMessage('general_tab.codeDesc', \"Click 'Edit' to regenerate Invite Code.\")}\n                    updateSection={this.handleUpdateSection}\n                    section={'invite_id'}\n                />\n            );\n        }\n\n        let nameSection;\n\n        if (this.props.activeSection === 'name') {\n            const inputs = [];\n\n            let teamNameLabel = (\n                <FormattedMessage\n                    id='general_tab.teamName'\n                    defaultMessage='Team Name'\n                />\n            );\n            if (Utils.isMobile()) {\n                teamNameLabel = '';\n            }\n\n            inputs.push(\n                <div\n                    key='teamNameSetting'\n                    className='form-group'\n                >\n                    <label className='col-sm-5 control-label'>{teamNameLabel}</label>\n                    <div className='col-sm-7'>\n                        <input\n                            id='teamName'\n                            autoFocus={true}\n                            className='form-control'\n                            type='text'\n                            maxLength={Constants.MAX_TEAMNAME_LENGTH.toString()}\n                            onChange={this.updateName}\n                            value={this.state.name}\n                            onFocus={Utils.moveCursorToEnd}\n                        />\n                    </div>\n                </div>\n            );\n\n            const nameExtraInfo = <span>{Utils.localizeMessage('general_tab.teamNameInfo', 'Set the name of the team as it appears on your sign-in screen and at the top of the left-hand sidebar.')}</span>;\n\n            nameSection = (\n                <SettingItemMax\n                    title={Utils.localizeMessage('general_tab.teamName', 'Team Name')}\n                    inputs={inputs}\n                    submit={this.handleNameSubmit}\n                    serverError={serverError}\n                    clientError={clientError}\n                    updateSection={this.handleUpdateSection}\n                    extraInfo={nameExtraInfo}\n                />\n            );\n        } else {\n            var describe = this.state.name;\n\n            nameSection = (\n                <SettingItemMin\n                    title={Utils.localizeMessage('general_tab.teamName', 'Team Name')}\n                    describe={describe}\n                    updateSection={this.handleUpdateSection}\n                    section={'name'}\n                />\n            );\n        }\n\n        let descriptionSection;\n\n        if (this.props.activeSection === 'description') {\n            const inputs = [];\n\n            let teamDescriptionLabel = (\n                <FormattedMessage\n                    id='general_tab.teamDescription'\n                    defaultMessage='Team Description'\n                />\n            );\n            if (Utils.isMobile()) {\n                teamDescriptionLabel = '';\n            }\n\n            inputs.push(\n                <div\n                    key='teamDescriptionSetting'\n                    className='form-group'\n                >\n                    <label className='col-sm-5 control-label'>{teamDescriptionLabel}</label>\n                    <div className='col-sm-7'>\n                        <input\n                            id='teamDescription'\n                            autoFocus={true}\n                            className='form-control'\n                            type='text'\n                            maxLength={Constants.MAX_TEAMDESCRIPTION_LENGTH.toString()}\n                            onChange={this.updateDescription}\n                            value={this.state.description}\n                            onFocus={Utils.moveCursorToEnd}\n                        />\n                    </div>\n                </div>\n            );\n\n            const descriptionExtraInfo = <span>{Utils.localizeMessage('general_tab.teamDescriptionInfo', 'Team description provides additional information to help users select the right team. Maximum of 50 characters.')}</span>;\n\n            descriptionSection = (\n                <SettingItemMax\n                    title={Utils.localizeMessage('general_tab.teamDescription', 'Team Description')}\n                    inputs={inputs}\n                    submit={this.handleDescriptionSubmit}\n                    serverError={serverError}\n                    clientError={clientError}\n                    updateSection={this.handleUpdateSection}\n                    extraInfo={descriptionExtraInfo}\n                />\n            );\n        } else {\n            let describemsg = '';\n            if (this.state.description) {\n                describemsg = this.state.description;\n            } else {\n                describemsg = (\n                    <FormattedMessage\n                        id='general_tab.emptyDescription'\n                        defaultMessage=\"Click 'Edit' to add a team description.\"\n                    />\n                );\n            }\n            descriptionSection = (\n                <SettingItemMin\n                    title={Utils.localizeMessage('general_tab.teamDescription', 'Team Description')}\n                    describe={describemsg}\n                    updateSection={this.handleUpdateSection}\n                    section={'description'}\n                />\n            );\n        }\n\n        let teamIconSection;\n        if (this.props.activeSection === 'team_icon') {\n            teamIconSection = (\n                <SettingPicture\n                    imageContext='team'\n                    title={Utils.localizeMessage('general_tab.teamIcon', 'Team Icon')}\n                    src={Utils.imageURLForTeam(team)}\n                    file={this.state.teamIconFile}\n                    serverError={this.state.serverError}\n                    clientError={this.state.clientError}\n                    loadingPicture={this.state.loadingIcon}\n                    submitActive={this.state.submitActive}\n                    updateSection={(e) => {\n                        this.updateSection('');\n                        e.preventDefault();\n                    }}\n                    onFileChange={this.updateTeamIcon}\n                    onSubmit={this.handleTeamIconSubmit}\n                    onRemove={this.handleTeamIconRemove}\n                />\n            );\n        } else {\n            let minMessage;\n\n            if (team.last_team_icon_update) {\n                minMessage = (\n                    <FormattedMessage\n                        id='general_tab.teamIconLastUpdated'\n                        defaultMessage='Image last updated {date}'\n                        values={{\n                            date: (\n                                <FormattedDate\n                                    value={new Date(team.last_team_icon_update)}\n                                    day='2-digit'\n                                    month='short'\n                                    year='numeric'\n                                />\n                            ),\n                        }}\n                    />\n                );\n            } else {\n                minMessage = Utils.isMobile() ?\n                    Utils.localizeMessage('general_tab.teamIconEditHintMobile', 'Click to upload an image') :\n                    Utils.localizeMessage('general_tab.teamIconEditHint', 'Click \\'Edit\\' to upload an image.');\n            }\n\n            teamIconSection = (\n                <SettingItemMin\n                    title={Utils.localizeMessage('general_tab.teamIcon', 'Team Icon')}\n                    describe={minMessage}\n                    section={'team_icon'}\n                    updateSection={this.handleUpdateSection}\n                />\n            );\n        }\n\n        let allowedDomainsSection;\n\n        if (this.props.activeSection === 'allowed_domains') {\n            const inputs = [];\n\n            inputs.push(\n                <div\n                    key='allowedDomainsSetting'\n                    className='form-group'\n                >\n                    <div className='col-sm-12'>\n                        <LocalizedInput\n                            id='allowedDomains'\n                            autoFocus={true}\n                            className='form-control'\n                            type='text'\n                            onChange={this.updateAllowedDomains}\n                            value={this.state.allowed_domains}\n                            onFocus={Utils.moveCursorToEnd}\n                            placeholder={{id: t('general_tab.AllowedDomainsExample'), defaultMessage: 'corp.mattermost.com, mattermost.org'}}\n                            aria-label={Utils.localizeMessage('general_tab.allowedDomains.ariaLabel', 'Allowed Domains')}\n                        />\n                    </div>\n                </div>\n            );\n\n            const allowedDomainsInfo = <span>{Utils.localizeMessage('general_tab.AllowedDomainsInfo', 'Users can only join the team if their email matches a specific domain (e.g. \"mattermost.org\") or list of comma-separated domains (e.g. \"corp.mattermost.com, mattermost.org\").')}</span>;\n\n            allowedDomainsSection = (\n                <SettingItemMax\n                    title={Utils.localizeMessage('general_tab.allowedDomains', 'Allow only users with a specific email domain to join this team')}\n                    inputs={inputs}\n                    submit={this.handleAllowedDomainsSubmit}\n                    serverError={serverError}\n                    clientError={clientError}\n                    updateSection={this.handleUpdateSection}\n                    extraInfo={allowedDomainsInfo}\n                />\n            );\n        } else {\n            let describemsg = '';\n            if (this.state.allowed_domains) {\n                describemsg = this.state.allowed_domains;\n            } else {\n                describemsg = (\n                    <FormattedMessage\n                        id='general_tab.allowedDomainsEdit'\n                        defaultMessage=\"Click 'Edit' to add an email domain whitelist.\"\n                    />\n                );\n            }\n            allowedDomainsSection = (\n                <SettingItemMin\n                    title={Utils.localizeMessage('general_tab.allowedDomains', 'allowedDomains')}\n                    describe={describemsg}\n                    updateSection={this.handleUpdateSection}\n                    section={'allowed_domains'}\n                />\n            );\n        }\n\n        return (\n            <div>\n                <div className='modal-header'>\n                    <button\n                        id='closeButton'\n                        type='button'\n                        className='close'\n                        data-dismiss='modal'\n                        aria-label='Close'\n                        onClick={this.props.closeModal}\n                    >\n                        <span aria-hidden='true'>{''}</span>\n                    </button>\n                    <h4\n                        className='modal-title'\n                        ref='title'\n                    >\n                        <div className='modal-back'>\n                            <span onClick={this.props.collapseModal}>\n                                <BackIcon/>\n                            </span>\n                        </div>\n                        <FormattedMessage\n                            id='general_tab.title'\n                            defaultMessage='General Settings'\n                        />\n                    </h4>\n                </div>\n                <div\n                    ref='wrapper'\n                    className='user-settings'\n                >\n                    <h3 className='tab-header'>\n                        <FormattedMessage\n                            id='general_tab.title'\n                            defaultMessage='General Settings'\n                        />\n                    </h3>\n                    <div className='divider-dark first'/>\n                    {nameSection}\n                    <div className='divider-light'/>\n                    {descriptionSection}\n                    <div className='divider-light'/>\n                    {teamIconSection}\n                    {!team.group_constrained &&\n                        <>\n                            <div className='divider-light'/>\n                            {allowedDomainsSection}\n                        </>\n                    }\n                    <div className='divider-light'/>\n                    {openInviteSection}\n                    {!team.group_constrained &&\n                        <>\n                            <div className='divider-light'/>\n                            {inviteSection}\n                        </>\n                    }\n                    <div className='divider-dark'/>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\n\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getTeam, patchTeam, removeTeamIcon, setTeamIcon, regenerateTeamInviteId} from 'mattermost-redux/actions/teams';\nimport {Permissions} from 'mattermost-redux/constants';\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\n\nimport TeamGeneralTab from './team_general_tab.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    const config = getConfig(state);\n    const maxFileSize = parseInt(config.MaxFileSize, 10);\n\n    const canInviteTeamMembers = haveITeamPermission(state, {team: ownProps.team.id, permission: Permissions.INVITE_USER});\n\n    return {\n        maxFileSize,\n        canInviteTeamMembers,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            getTeam,\n            patchTeam,\n            regenerateTeamInviteId,\n            removeTeamIcon,\n            setTeamIcon,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TeamGeneralTab);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class SettingsUpload extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.uploadinput = React.createRef();\n\n        this.state = {\n            clientError: '',\n            serverError: '',\n            filename: '',\n        };\n    }\n\n    doFileSelect = (e) => {\n        e.preventDefault();\n        var filename = $(e.target).val();\n        if (filename.substring(3, 11) === 'fakepath') {\n            filename = filename.substring(12);\n        }\n        this.setState({\n            clientError: '',\n            serverError: '',\n            filename,\n        });\n    }\n\n    openFileSelect = () => {\n        this.uploadinput.current.value = '';\n        this.uploadinput.current.click();\n    }\n\n    doSubmit = (e) => {\n        e.preventDefault();\n        var inputnode = ReactDOM.findDOMNode(this.uploadinput.current);\n        if (inputnode.files && inputnode.files[0]) {\n            this.props.submit(inputnode.files[0]);\n        } else {\n            this.setState({clientError: true});\n        }\n    }\n\n    render() {\n        let clientError = null;\n        if (this.state.clientError) {\n            clientError = (\n                <div className='file-status'>\n                    <FormattedMessage\n                        id='setting_upload.noFile'\n                        defaultMessage='No file selected.'\n                    />\n                </div>\n            );\n        }\n        let serverError = null;\n        if (this.state.serverError) {\n            serverError = (\n                <div className='file-status'>{this.state.serverError}</div>\n            );\n        }\n        let fileNameText = null;\n        let submitButtonClass = 'btn btn-sm btn-primary disabled';\n        if (this.state.filename) {\n            fileNameText = (\n                <div className='file-status file-name'>{this.state.filename}</div>\n            );\n            submitButtonClass = 'btn btn-sm btn-primary';\n        }\n\n        return (\n            <ul className='section-max'>\n                <li className='col-sm-12 section-title'>{this.props.title}</li>\n                <li className='col-sm-offset-3 col-sm-9'>{this.props.helpText}</li>\n                <li className='col-sm-offset-3 col-sm-9'>\n                    <ul className='setting-list'>\n                        <li className='setting-list-item'>\n                            <input\n                                ref={this.uploadinput}\n                                accept={this.props.fileTypesAccepted}\n                                type='file'\n                                onChange={this.doFileSelect}\n                                tabIndex='-1'\n                                aria-hidden={true}\n                            />\n                            <button\n                                onClick={this.openFileSelect}\n                                className='btn btn-sm btn-primary btn-file sel-btn'\n                            >\n                                <FormattedMessage\n                                    id='setting_upload.select'\n                                    defaultMessage='Select file'\n                                />\n                            </button>\n                            <a\n                                className={submitButtonClass}\n                                onClick={this.doSubmit}\n                            >\n                                <FormattedMessage\n                                    id='setting_upload.import'\n                                    defaultMessage='Import'\n                                />\n                            </a>\n                            {fileNameText}\n                            {serverError}\n                            {clientError}\n                        </li>\n                    </ul>\n                </li>\n            </ul>\n        );\n    }\n}\n\nSettingsUpload.propTypes = {\n    title: PropTypes.node.isRequired,\n    submit: PropTypes.func.isRequired,\n    fileTypesAccepted: PropTypes.string.isRequired,\n    helpText: PropTypes.object,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {defineMessages, FormattedMessage, injectIntl} from 'react-intl';\n\nimport * as utils from 'utils/utils.jsx';\nimport {t} from 'utils/i18n';\n\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\n\nimport BackIcon from 'components/widgets/icons/fa_back_icon';\nimport SettingUpload from 'components/setting_upload.jsx';\nimport SuccessIcon from 'components/widgets/icons/fa_success_icon';\nimport WarningIcon from 'components/widgets/icons/fa_warning_icon';\n\nconst holders = defineMessages({\n    importSlack: {\n        id: t('team_import_tab.importSlack'),\n        defaultMessage: 'Import from Slack (Beta)',\n    },\n});\n\nclass TeamImportTab extends React.Component {\n    static propTypes = {\n        closeModal: PropTypes.func.isRequired,\n        collapseModal: PropTypes.func.isRequired,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            status: 'ready',\n            link: '',\n        };\n    }\n\n    onImportFailure = () => {\n        this.setState({status: 'fail'});\n    }\n\n    onImportSuccess = (data) => {\n        this.setState({status: 'done', link: 'data:application/octet-stream;charset=utf-8,' + encodeURIComponent(atob(data.results))});\n    }\n\n    doImportSlack = (file) => {\n        this.setState({status: 'in-progress', link: ''});\n        utils.importSlack(this.props.team.id, file, this.onImportSuccess, this.onImportFailure);\n    }\n\n    render() {\n        const uploadDocsLink = (\n            <a\n                href='https://docs.mattermost.com/administration/migrating.html#migrating-from-slack'\n                target='_blank'\n                rel='noopener noreferrer'\n            >\n                <FormattedMessage\n                    id='team_import_tab.importHelpDocsLink'\n                    defaultMessage='documentation'\n                />\n            </a>\n        );\n\n        const uploadExportInstructions = (\n            <strong>\n                <FormattedMessage\n                    id='team_import_tab.importHelpExportInstructions'\n                    defaultMessage='Slack > Administration > Workspace settings > Import/Export Data > Export > Start Export'\n                />\n            </strong>\n        );\n\n        const uploadExporterLink = (\n            <a\n                href='https://github.com/grundleborg/slack-advanced-exporter'\n                target='_blank'\n                rel='noopener noreferrer'\n            >\n                <FormattedMessage\n                    id='team_import_tab.importHelpExporterLink'\n                    defaultMessage='Slack Advanced Exporter'\n                />\n            </a>\n        );\n\n        const importCliLink = (\n            <a\n                href='https://docs.mattermost.com/administration/migrating.html#migrating-from-slack-using-the-mattermost-cli'\n                target='_blank'\n                rel='noopener noreferrer'\n            >\n                <FormattedMessage\n                    id='team_import_tab.importHelpCliDocsLink'\n                    defaultMessage='CLI tool for Slack import'\n                />\n            </a>\n        );\n\n        const uploadHelpText = (\n            <div>\n                <p>\n                    <FormattedMessage\n                        id='team_import_tab.importHelpLine1'\n                        defaultMessage=\"Slack import to Mattermost supports importing of messages in your Slack team's public channels.\"\n                    />\n                </p>\n                <p>\n                    <FormattedMessage\n                        id='team_import_tab.importHelpLine2'\n                        defaultMessage='To import a team from Slack, go to {exportInstructions}. See {uploadDocsLink} to learn more.'\n                        values={{\n                            exportInstructions: uploadExportInstructions,\n                            uploadDocsLink,\n                        }}\n                    />\n                </p>\n                <p>\n                    <FormattedMessage\n                        id='team_import_tab.importHelpLine3'\n                        defaultMessage='To import posts with attached files, see {slackAdvancedExporterLink} for details.'\n                        values={{\n                            slackAdvancedExporterLink: uploadExporterLink,\n                        }}\n                    />\n                </p>\n                <p>\n                    <FormattedMessage\n                        id='team_import_tab.importHelpLine4'\n                        defaultMessage='For Slack teams with over 10,000 messages, we recommend using the {cliLink}.'\n                        values={{\n                            cliLink: importCliLink,\n                        }}\n                    />\n                </p>\n            </div>\n        );\n\n        const uploadSection = (\n            <SettingUpload\n                title={<FormattedMessage {...holders.importSlack}/>}\n                submit={this.doImportSlack}\n                helpText={uploadHelpText}\n                fileTypesAccepted='.zip'\n            />\n        );\n\n        let messageSection;\n        switch (this.state.status) {\n        case 'ready':\n            messageSection = '';\n            break;\n        case 'in-progress':\n            messageSection = (\n                <p className='confirm-import alert alert-warning'>\n                    <LoadingSpinner text={utils.localizeMessage('team_import_tab.importing', 'Importing...')}/>\n                </p>\n            );\n            break;\n        case 'done':\n            messageSection = (\n                <p className='confirm-import alert alert-success'>\n                    <SuccessIcon/>\n                    <FormattedMessage\n                        id='team_import_tab.successful'\n                        defaultMessage=' Import successful: '\n                    />\n                    <a\n                        href={this.state.link}\n                        download='MattermostImportSummary.txt'\n                    >\n                        <FormattedMessage\n                            id='team_import_tab.summary'\n                            defaultMessage='View Summary'\n                        />\n                    </a>\n                </p>\n            );\n            break;\n        case 'fail':\n            messageSection = (\n                <p className='confirm-import alert alert-warning'>\n                    <WarningIcon/>\n                    <FormattedMessage\n                        id='team_import_tab.failure'\n                        defaultMessage=' Import failure: '\n                    />\n                    <a\n                        href={this.state.link}\n                        download='MattermostImportSummary.txt'\n                    >\n                        <FormattedMessage\n                            id='team_import_tab.summary'\n                            defaultMessage='View Summary'\n                        />\n                    </a>\n                </p>\n            );\n            break;\n        }\n\n        return (\n            <div>\n                <div className='modal-header'>\n                    <button\n                        type='button'\n                        className='close'\n                        data-dismiss='modal'\n                        aria-label='Close'\n                        onClick={this.props.closeModal}\n                    >\n                        <span aria-hidden='true'>{''}</span>\n                    </button>\n                    <h4\n                        className='modal-title'\n                        ref='title'\n                    >\n                        <div className='modal-back'>\n                            <span onClick={this.props.collapseModal}>\n                                <BackIcon/>\n                            </span>\n                        </div>\n                        <FormattedMessage\n                            id='team_import_tab.import'\n                            defaultMessage='Import'\n                        />\n                    </h4>\n                </div>\n                <div\n                    ref='wrapper'\n                    className='user-settings'\n                >\n                    <h3 className='tab-header'>\n                        <FormattedMessage\n                            id='team_import_tab.import'\n                            defaultMessage='Import'\n                        />\n                    </h3>\n                    <div className='divider-dark first'/>\n                    {uploadSection}\n                    <div className='divider-dark'/>\n                    {messageSection}\n                </div>\n            </div>\n        );\n    }\n}\n\nTeamImportTab.propTypes = {\n    closeModal: PropTypes.func.isRequired,\n    collapseModal: PropTypes.func.isRequired,\n    team: PropTypes.object.isRequired,\n};\n\nexport default injectIntl(TeamImportTab);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport GeneralTab from 'components/team_general_tab';\nimport ImportTab from 'components/team_import_tab.jsx';\n\nconst TeamSettings = ({activeTab, activeSection, updateSection, closeModal, collapseModal, team}) => {\n    if (!team) {\n        return null;\n    }\n\n    let result;\n    switch (activeTab) {\n    case 'general':\n        result = (\n            <div>\n                <GeneralTab\n                    team={team}\n                    activeSection={activeSection}\n                    updateSection={updateSection}\n                    closeModal={closeModal}\n                    collapseModal={collapseModal}\n                />\n            </div>\n        );\n        break;\n    case 'import':\n        result = (\n            <div>\n                <ImportTab\n                    team={team}\n                    activeSection={activeSection}\n                    updateSection={updateSection}\n                    closeModal={closeModal}\n                    collapseModal={collapseModal}\n                />\n            </div>\n        );\n        break;\n    default:\n        result = (\n            <div/>\n        );\n        break;\n    }\n\n    return result;\n};\n\nTeamSettings.defaultProps = {\n    activeTab: '',\n    activeSection: '',\n};\n\nTeamSettings.propTypes = {\n    activeTab: PropTypes.string.isRequired,\n    activeSection: PropTypes.string.isRequired,\n    updateSection: PropTypes.func.isRequired,\n    closeModal: PropTypes.func.isRequired,\n    collapseModal: PropTypes.func.isRequired,\n    team: PropTypes.object.isRequired,\n};\n\nexport default TeamSettings;","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\n\nimport TeamSettings from './team_settings.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        team: getCurrentTeam(state),\n    };\n}\n\nexport default connect(mapStateToProps)(TeamSettings);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDOM from 'react-dom';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport * as Utils from 'utils/utils.jsx';\nconst SettingsSidebar = React.lazy(() => import('components/settings_sidebar.tsx'));\n\nimport TeamSettings from 'components/team_settings';\n\nexport default class TeamSettingsModal extends React.Component {\n    static propTypes = {\n        onHide: PropTypes.func,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            activeTab: 'general',\n            activeSection: '',\n            show: true,\n        };\n\n        this.modalBodyRef = React.createRef();\n    }\n\n    updateTab = (tab) => {\n        this.setState({\n            activeTab: tab,\n            activeSection: '',\n        });\n    }\n\n    updateSection = (section) => {\n        this.setState({activeSection: section});\n    }\n\n    collapseModal = () => {\n        $(ReactDOM.findDOMNode(this.modalBodyRef.current)).closest('.modal-dialog').removeClass('display--content');\n\n        this.setState({\n            active_tab: '',\n            active_section: '',\n        });\n    }\n\n    handleHide = () => {\n        this.setState({show: false});\n    }\n\n    // called after the dialog is fully hidden and faded out\n    handleHidden = () => {\n        this.setState({\n            activeTab: 'general',\n            activeSection: '',\n        });\n        this.props.onHide();\n    }\n\n    render() {\n        const tabs = [];\n        tabs.push({name: 'general', uiName: Utils.localizeMessage('team_settings_modal.generalTab', 'General'), icon: 'icon fa fa-cog', iconTitle: Utils.localizeMessage('generic_icons.settings', 'Settings Icon')});\n        tabs.push({name: 'import', uiName: Utils.localizeMessage('team_settings_modal.importTab', 'Import'), icon: 'icon fa fa-upload', iconTitle: Utils.localizeMessage('generic_icons.upload', 'Upload Icon')});\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal settings-modal settings-modal--action'\n                show={this.state.show}\n                onHide={this.handleHide}\n                onExited={this.handleHidden}\n                role='dialog'\n                aria-labelledby='teamSettingsModalLabel'\n                id='teamSettingsModal'\n            >\n                <Modal.Header\n                    id='teamSettingsModalLabel'\n                    closeButton={true}\n                >\n                    <Modal.Title componentClass='h1'>\n                        <FormattedMessage\n                            id='team_settings_modal.title'\n                            defaultMessage='Team Settings'\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body ref={this.modalBodyRef}>\n                    <div className='settings-table'>\n                        <div className='settings-links'>\n                            <React.Suspense fallback={null}>\n                                <SettingsSidebar\n                                    tabs={tabs}\n                                    activeTab={this.state.activeTab}\n                                    updateTab={this.updateTab}\n                                />\n                            </React.Suspense>\n                        </div>\n                        <div className='settings-content minimize-settings'>\n                            <TeamSettings\n                                activeTab={this.state.activeTab}\n                                activeSection={this.state.activeSection}\n                                updateSection={this.updateSection}\n                                closeModal={this.handleHide}\n                                collapseModal={this.collapseModal}\n                            />\n                        </div>\n                    </div>\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {ModalIdentifiers} from 'utils/constants';\nimport {isModalOpen} from 'selectors/views/modals';\n\nimport TeamSettingsModal from './team_settings_modal.jsx';\n\nfunction mapStateToProps(state) {\n    const modalId = ModalIdentifiers.TEAM_SETTINGS;\n    return {\n        show: isModalOpen(state, modalId),\n    };\n}\n\nexport default connect(mapStateToProps)(TeamSettingsModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport const getPlugins = (state) => state.views.marketplace.plugins;\n\nexport const getInstalledPlugins = (state) =>\n    Object.values(getPlugins(state)).filter((p) => p.installed_version !== '');\n\nexport const getPlugin = (state, id) =>\n    getPlugins(state).find(((p) => p.manifest && p.manifest.id === id));\n\nexport const getFilter = (state) => state.views.marketplace.filter;\n\nexport const getInstalling = (state, id) => Boolean(state.views.marketplace.installing[id]);\n\nexport const getError = (state, id) => state.views.marketplace.errors[id];\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {Client4} from 'mattermost-redux/client';\n\nimport {getFilter, getPlugin} from 'selectors/views/marketplace';\nimport {ActionTypes} from 'utils/constants';\n\n// fetchPlugins fetches the latest marketplace plugins, subject to any existing search filter.\nexport function fetchPlugins(localOnly = false) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const filter = getFilter(state);\n\n        try {\n            const plugins = await Client4.getMarketplacePlugins(filter, localOnly);\n\n            dispatch({\n                type: ActionTypes.RECEIVED_MARKETPLACE_PLUGINS,\n                plugins,\n            });\n\n            return {plugins};\n        } catch (error) {\n            // If the marketplace server is unreachable, try to get the local plugins only.\n            if (error.server_error_id === 'app.plugin.marketplace_client.failed_to_fetch' && !localOnly) {\n                await dispatch(fetchPlugins(true));\n            }\n            return {error};\n        }\n    };\n}\n\n// installPlugin installs the latest version of the given plugin from the marketplace.\n//\n// On success, it also requests the current state of the plugins to reflect the newly installed plugin.\nexport function installPlugin(id, version) {\n    return async (dispatch, getState) => {\n        dispatch({\n            type: ActionTypes.INSTALLING_MARKETPLACE_PLUGIN,\n            id,\n        });\n\n        const state = getState();\n\n        const marketplacePlugin = getPlugin(state, id);\n        if (!marketplacePlugin) {\n            dispatch({\n                type: ActionTypes.INSTALLING_MARKETPLACE_PLUGIN_FAILED,\n                id,\n                error: 'Unknown plugin: ' + id,\n            });\n            return;\n        }\n\n        try {\n            await Client4.installMarketplacePlugin(id, version);\n        } catch (error) {\n            dispatch({\n                type: ActionTypes.INSTALLING_MARKETPLACE_PLUGIN_FAILED,\n                id,\n                error: error.message,\n            });\n            return;\n        }\n\n        await dispatch(fetchPlugins());\n        dispatch({\n            type: ActionTypes.INSTALLING_MARKETPLACE_PLUGIN_SUCCEEDED,\n            id,\n        });\n    };\n}\n\n// filterPlugins sets a search filter for marketplace plugins, fetching the latest data.\nexport function filterPlugins(filter) {\n    return async (dispatch) => {\n        dispatch({\n            type: ActionTypes.FILTER_MARKETPLACE_PLUGINS,\n            filter,\n        });\n\n        return dispatch(fetchPlugins());\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class PluginIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.plugin'\n                    defaultMessage='Plugin Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='61px'\n                            height='61px'\n                            viewBox='0 0 61 61'\n                            aria-label={ariaLabel}\n                        >\n                            <g\n                                stroke='none'\n                                strokeWidth='1'\n                                fill='inherit'\n                                fillRule='evenodd'\n                            >\n                                <g\n                                    transform='translate(-347.000000, -211.000000)'\n                                    fill='inherit'\n                                >\n                                    <g transform='translate(377.585786, 241.500000) rotate(-315.000000) translate(-377.585786, -241.500000) translate(358.585786, 200.000000)'>\n                                        <g transform='translate(0.000000, -0.000000)'>\n                                            <path\n                                                d='M3.28846154,6.10822511 L3.05411255,6.10822511 C1.36737277,6.10822511 2.06566048e-16,4.74085234 0,3.05411255 C-2.06566048e-16,1.36737277 1.36737277,-7.78498519e-14 3.05411255,-7.81597009e-14 L34.9458874,-7.81597009e-14 C36.6326272,-8.16905472e-14 38,1.36737277 38,3.05411255 C38,4.74085234 36.6326272,6.10822511 34.9458874,6.10822511 L34.7115385,6.10822511 L34.7115385,14.7316017 C34.7115385,20.9798931 29.0184395,26.1638765 21.5576923,27.1415606 L21.5576923,33.1964286 C21.5576923,34.5081049 20.4943686,35.5714286 19.1826923,35.5714286 C17.871016,35.5714286 16.8076923,34.5081049 16.8076923,33.1964286 L16.8076923,27.1859094 C9.16823824,26.3322077 3.28846154,21.0815081 3.28846154,14.7316017 L3.28846154,6.10822511 Z M19.1431901,14.7316017 C17.8533303,14.7316017 16.8076923,15.7772397 16.8076923,17.0670996 C16.8076923,18.3569594 17.8533303,19.4025974 19.1431901,19.4025974 L19.2221945,19.4025974 C20.5120543,19.4025974 21.5576923,18.3569594 21.5576923,17.0670996 C21.5576923,15.7772397 20.5120543,14.7316017 19.2221945,14.7316017 L19.1431901,14.7316017 Z'\n                                                transform='translate(19.000000, 17.785714) rotate(-180.000000) translate(-19.000000, -17.785714) '\n                                            />\n                                            <path\n                                                d='M32.1538462,53.5367965 L34.7115385,53.5367965 L34.7115385,62.1601732 C34.7115385,68.4084646 29.0184395,73.592448 21.5576923,74.5701321 L21.5576923,80.625 C21.5576923,81.9366763 20.4943686,83 19.1826923,83 C17.871016,83 16.8076923,81.9366763 16.8076923,80.625 L16.8076923,74.6144809 C9.16823824,73.7607791 3.28846154,68.5100796 3.28846154,62.1601732 L3.28846154,53.5367965 L3.05411255,53.5367965 C1.36737277,53.5367965 2.06566048e-16,52.1694238 0,50.482684 C-2.06566048e-16,48.7959442 1.36737277,47.4285714 3.05411255,47.4285714 L8.40384615,47.4285714 L8.40384615,42.2581169 C8.40384615,40.9464406 9.46716987,39.8831169 10.7788462,39.8831169 C12.0905224,39.8831169 13.1538462,40.9464406 13.1538462,42.2581169 L13.1538462,47.4285714 L24.8461538,47.4285714 L24.8461538,42.2581169 C24.8461538,40.9464406 25.9094776,39.8831169 27.2211538,39.8831169 C28.5328301,39.8831169 29.5961538,40.9464406 29.5961538,42.2581169 L29.5961538,47.4285714 L34.9458874,47.4285714 C36.6326272,47.4285714 38,48.7959442 38,50.482684 C38,52.1694238 36.6326272,53.5367965 34.9458874,53.5367965 L32.1538462,53.5367965 Z M19.1431901,62.1601732 C17.8533303,62.1601732 16.8076923,63.2058112 16.8076923,64.495671 C16.8076923,65.7855308 17.8533303,66.8311688 19.1431901,66.8311688 L19.2221945,66.8311688 C20.5120543,66.8311688 21.5576923,65.7855308 21.5576923,64.495671 C21.5576923,63.2058112 20.5120543,62.1601732 19.2221945,62.1601732 L19.1431901,62.1601732 Z'\n                                                transform='translate(19.000000, 61.441558) rotate(-360.000000) translate(-19.000000, -61.441558) '\n                                            />\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport {Tooltip} from 'react-bootstrap';\nimport semver from 'semver';\n\nimport {FormattedMessage, FormattedHTMLMessage} from 'react-intl';\n\nimport {Link} from 'react-router-dom';\n\nimport ConfirmModal from 'components/confirm_modal';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport LoadingWrapper from 'components/widgets/loading/loading_wrapper.tsx';\nimport PluginIcon from 'components/widgets/icons/plugin_icon.jsx';\n\nimport {localizeMessage} from 'utils/utils';\nimport {Constants} from 'utils/constants';\n\n// UpdateVersion renders the version text in the update details, linking out to release notes if available.\nexport const UpdateVersion = ({version, releaseNotesUrl}) => {\n    if (!releaseNotesUrl) {\n        return version;\n    }\n\n    return (\n        <a\n            target='_blank'\n            rel='noopener noreferrer'\n            href={releaseNotesUrl}\n        >\n            {version}\n        </a>\n    );\n};\n\nUpdateVersion.propTypes = {\n    version: PropTypes.string.isRequired,\n    releaseNotesUrl: PropTypes.string,\n};\n\n// Label renders a tag showing a name and a description in a tooltip.\n// If a URL is provided, clicking on the tag will open the URL in a new tab.\nexport const Label = ({name, description, url, color}) => {\n    const tag = (\n        <span\n            className='tag'\n            style={{backgroundColor: color || ''}}\n        >\n            {name.toUpperCase()}\n        </span>\n    );\n\n    let label;\n    if (description) {\n        label = (\n            <OverlayTrigger\n                delayShow={Constants.OVERLAY_TIME_DELAY}\n                placement='top'\n                overlay={\n                    <Tooltip id={'plugin-marketplace_label_' + name.toLowerCase() + '-tooltip'}>\n                        {description}\n                    </Tooltip>\n                }\n            >\n                {tag}\n            </OverlayTrigger>\n        );\n    } else {\n        label = tag;\n    }\n\n    if (url) {\n        return (\n            <a\n                aria-label={name.toLowerCase()}\n                className='style--none more-modal__row--link'\n                target='_blank'\n                rel='noopener noreferrer'\n                href={url}\n            >\n                {label}\n            </a>\n        );\n    }\n\n    return label;\n};\n\nLabel.propTypes = {\n    name: PropTypes.string.isRequired,\n    description: PropTypes.string,\n    url: PropTypes.string,\n    color: PropTypes.string,\n};\n\n// UpdateDetails renders an inline update prompt for plugins, when available.\nexport const UpdateDetails = ({version, releaseNotesUrl, installedVersion, isInstalling, onUpdate}) => {\n    if (!installedVersion || isInstalling) {\n        return null;\n    }\n\n    var isUpdate = false;\n    try {\n        isUpdate = semver.gt(version, installedVersion);\n    } catch (e) {\n        // If we fail to parse the version, assume not an update;\n    }\n\n    if (!isUpdate) {\n        return null;\n    }\n\n    return (\n        <div className={classNames('update')}>\n            <FormattedMessage\n                id='marketplace_modal.list.update_available'\n                defaultMessage='Update available:'\n            />\n            {' '}\n            <UpdateVersion\n                version={version}\n                releaseNotesUrl={releaseNotesUrl}\n            />\n            {' - '}\n            <b>\n                <a onClick={onUpdate}>\n                    <FormattedMessage\n                        id='marketplace_modal.list.update'\n                        defaultMessage='Update'\n                    />\n                </a>\n            </b>\n        </div>\n    );\n};\n\nUpdateDetails.propTypes = {\n    version: PropTypes.string.isRequired,\n    releaseNotesUrl: PropTypes.string,\n    installedVersion: PropTypes.string,\n    isInstalling: PropTypes.bool.isRequired,\n    onUpdate: PropTypes.func.isRequired,\n};\n\n// UpdateConfirmationModal prompts before allowing upgrade, specially handling major version changes.\nexport const UpdateConfirmationModal = ({show, name, version, installedVersion, releaseNotesUrl, onUpdate, onCancel}) => {\n    if (!installedVersion) {\n        return null;\n    }\n\n    var isUpdate = false;\n    try {\n        isUpdate = semver.gt(version, installedVersion);\n    } catch (e) {\n        // If we fail to parse the version, assume not an update;\n    }\n\n    if (!isUpdate) {\n        return null;\n    }\n\n    const messages = [(\n        <p key='intro'>\n            <FormattedMessage\n                id='marketplace_modal.list.update_confirmation.message.intro'\n                defaultMessage={`Are you sure you want to update the ${name} plugin to ${version}?`}\n                values={{name, version}}\n            />\n        </p>\n    )];\n\n    if (releaseNotesUrl) {\n        messages.push(\n            <p key='current'>\n                <FormattedHTMLMessage\n                    id='marketplace_modal.list.update_confirmation.message.current_with_release_notes'\n                    defaultMessage={`You currently have ${installedVersion} installed. View the <a href=\"${releaseNotesUrl}\" target='_blank' rel='noopener noreferrer'>release notes</a> to learn about the changes included in this update.`}\n                    values={{installedVersion, releaseNotesUrl}}\n                />\n            </p>\n        );\n    } else {\n        messages.push(\n            <p key='current'>\n                <FormattedMessage\n                    id='marketplace_modal.list.update_confirmation.message.current'\n                    defaultMessage={`You currently have ${installedVersion} installed.`}\n                    values={{installedVersion}}\n                />\n            </p>\n        );\n    }\n\n    let sameMajorVersion = false;\n    try {\n        sameMajorVersion = semver.major(version) === semver.major(installedVersion);\n    } catch (e) {\n        // If we fail to parse the version, assume a potentially breaking change.\n        // In practice, this won't happen since we already tried to parse the version above.\n    }\n\n    if (!sameMajorVersion) {\n        if (releaseNotesUrl) {\n            messages.push(\n                <p\n                    className='alert alert-warning'\n                    key='warning'\n                >\n                    <FormattedHTMLMessage\n                        id='marketplace_modal.list.update_confirmation.message.warning_major_version_with_release_notes'\n                        defaultMessage={`This update may contain breaking changes. Consult the <a href=\"${releaseNotesUrl}\" target='_blank' rel='noopener noreferrer'>release notes</a> before upgrading.`}\n                        values={{releaseNotesUrl}}\n                    />\n                </p>\n            );\n        } else {\n            messages.push(\n                <p\n                    className='alert alert-warning'\n                    key='warning'\n                >\n                    <FormattedMessage\n                        id='marketplace_modal.list.update_confirmation.message.warning_major_version'\n                        defaultMessage={'This update may contain breaking changes.'}\n                    />\n                </p>\n            );\n        }\n    }\n\n    return (\n        <ConfirmModal\n            show={show}\n            title={\n                <FormattedMessage\n                    id='marketplace_modal.list.update_confirmation.title'\n                    defaultMessage={'Confirm Plugin Update'}\n                />\n            }\n            message={messages}\n            confirmButtonText={\n                <FormattedMessage\n                    id='marketplace_modal.list.update_confirmation.confirm_button'\n                    defaultMessage='Update'\n                />\n            }\n            onConfirm={onUpdate}\n            onCancel={onCancel}\n        />\n    );\n};\n\nUpdateConfirmationModal.propTypes = {\n    show: PropTypes.bool.isRequired,\n    name: PropTypes.string.isRequired,\n    version: PropTypes.string.isRequired,\n    releaseNotesUrl: PropTypes.string,\n    installedVersion: PropTypes.string,\n    onUpdate: PropTypes.func.isRequired,\n    onCancel: PropTypes.func.isRequired,\n};\n\nexport default class MarketplaceItem extends React.Component {\n    static propTypes = {\n        id: PropTypes.string.isRequired,\n        name: PropTypes.string.isRequired,\n        description: PropTypes.string.isRequired,\n        version: PropTypes.string.isRequired,\n        downloadUrl: PropTypes.string,\n        homepageUrl: PropTypes.string,\n        releaseNotesUrl: PropTypes.string,\n        labels: PropTypes.array,\n        iconData: PropTypes.string,\n        installedVersion: PropTypes.string.isRequired,\n        installing: PropTypes.bool.isRequired,\n        error: PropTypes.string,\n        isDefaultMarketplace: PropTypes.bool.isRequired,\n        trackEvent: PropTypes.func.isRequired,\n        actions: PropTypes.shape({\n            installPlugin: PropTypes.func.isRequired,\n            closeMarketplaceModal: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    constructor() {\n        super();\n\n        this.state = {\n            showUpdateConfirmationModal: false,\n        };\n    }\n\n    trackEvent = (eventName, allowDetail = true) => {\n        if (this.props.isDefaultMarketplace && allowDetail) {\n            this.props.trackEvent('plugins', eventName, {\n                plugin_id: this.props.id,\n                version: this.props.version,\n                installed_version: this.props.installedVersion,\n            });\n        } else {\n            this.props.trackEvent('plugins', eventName);\n        }\n    }\n\n    onInstall = () => {\n        this.trackEvent('ui_marketplace_download');\n        this.props.actions.installPlugin(this.props.id, this.props.version);\n    }\n\n    showUpdateConfirmationModal = () => {\n        this.setState({showUpdateConfirmationModal: true});\n    }\n\n    hideUpdateConfirmationModal = () => {\n        this.setState({showUpdateConfirmationModal: false});\n    }\n\n    onUpdate = () => {\n        this.trackEvent('ui_marketplace_download_update');\n\n        this.hideUpdateConfirmationModal();\n        this.props.actions.installPlugin(this.props.id, this.props.version);\n    }\n\n    onConfigure = () => {\n        this.trackEvent('ui_marketplace_configure', false);\n\n        this.props.actions.closeMarketplaceModal();\n    }\n\n    getItemButton() {\n        let actionButton = (\n            <FormattedMessage\n                id='marketplace_modal.list.Install'\n                defaultMessage='Install'\n            />\n        );\n        if (this.props.error) {\n            actionButton = (\n                <FormattedMessage\n                    id='marketplace_modal.list.try_again'\n                    defaultMessage='Try Again'\n                />\n            );\n        }\n\n        let button = (\n            <button\n                onClick={this.onInstall}\n                className='btn btn-primary'\n                disabled={this.props.installing}\n            >\n                <LoadingWrapper\n                    loading={this.props.installing}\n                    text={localizeMessage('marketplace_modal.installing', 'Installing...')}\n                >\n                    {actionButton}\n                </LoadingWrapper>\n\n            </button>\n        );\n\n        if (this.props.installedVersion !== '' && !this.props.installing && !this.props.error) {\n            button = (\n                <Link\n                    to={'/admin_console/plugins/plugin_' + this.props.id}\n                >\n                    <button\n                        onClick={this.onConfigure}\n                        className='btn btn-outline'\n                    >\n                        <FormattedMessage\n                            id='marketplace_modal.list.configure'\n                            defaultMessage='Configure'\n                        />\n                    </button>\n                </Link>\n            );\n        }\n\n        return button;\n    }\n\n    render() {\n        const ariaLabel = `${this.props.name}, ${this.props.description}`.toLowerCase();\n        let versionLabel = `(${this.props.version})`;\n        if (this.props.installedVersion !== '') {\n            versionLabel = `(${this.props.installedVersion})`;\n        }\n\n        let pluginIcon;\n        if (this.props.iconData) {\n            pluginIcon = (\n                <div className='icon__plugin icon__plugin--background'>\n                    <img src={this.props.iconData}/>\n                </div>\n            );\n        } else {\n            pluginIcon = <PluginIcon className='icon__plugin icon__plugin--background'/>;\n        }\n\n        let labels;\n        if (this.props.labels && this.props.labels.length !== 0) {\n            labels = this.props.labels.map((label) => (\n                <Label\n                    key={label.name}\n                    name={label.name}\n                    description={label.description}\n                    url={label.url}\n                    color={label.color}\n                />\n            )\n            );\n        }\n\n        const pluginDetailsInner = (\n            <>\n                {this.props.name}\n                <span className='light subtitle'>{versionLabel}</span>\n                {labels}\n                <p className={classNames('more-modal__description', {error_text: this.props.error})}>\n                    {this.props.error ? this.props.error : this.props.description}\n                </p>\n            </>\n        );\n\n        let pluginDetails;\n        if (this.props.homepageUrl) {\n            pluginDetails = (\n                <a\n                    aria-label={ariaLabel}\n                    className='style--none more-modal__row--link'\n                    target='_blank'\n                    rel='noopener noreferrer'\n                    href={this.props.homepageUrl}\n                >\n                    {pluginDetailsInner}\n                </a>\n            );\n        } else {\n            pluginDetails = (\n                <span\n                    aria-label={ariaLabel}\n                    className='style--none'\n                >\n                    {pluginDetailsInner}\n                </span>\n            );\n        }\n\n        return (\n            <>\n                <div\n                    className={classNames('more-modal__row', 'more-modal__row--link', {item_error: this.props.error})}\n                    key={this.props.id}\n                    id={'marketplace-plugin-' + this.props.id}\n                >\n                    {pluginIcon}\n                    <div className='more-modal__details'>\n                        {pluginDetails}\n                        <UpdateDetails\n                            version={this.props.version}\n                            installedVersion={this.props.installedVersion}\n                            releaseNotesUrl={this.props.releaseNotesUrl}\n                            isInstalling={this.props.installing}\n                            onUpdate={this.showUpdateConfirmationModal}\n                        />\n                    </div>\n                    <div className='more-modal__actions'>\n                        {this.getItemButton()}\n                    </div>\n                    <UpdateConfirmationModal\n                        show={this.state.showUpdateConfirmationModal}\n                        name={this.props.name}\n                        version={this.props.version}\n                        installedVersion={this.props.installedVersion}\n                        releaseNotesUrl={this.props.releaseNotesUrl}\n                        onUpdate={this.onUpdate}\n                        onCancel={this.hideUpdateConfirmationModal}\n                    />\n                </div>\n            </>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport {installPlugin} from 'actions/marketplace';\nimport {closeModal} from 'actions/views/modals';\nimport {ModalIdentifiers} from 'utils/constants';\nimport {getInstalling, getError} from 'selectors/views/marketplace';\nimport {trackEvent} from 'actions/diagnostics_actions.jsx';\n\nimport MarketplaceItem from './marketplace_item';\n\nfunction mapStateToProps(state, props) {\n    const installing = getInstalling(state, props.id);\n    const error = getError(state, props.id);\n    const isDefaultMarketplace = getConfig(state).IsDefaultMarketplace === 'true';\n\n    return {\n        installing,\n        error,\n        isDefaultMarketplace,\n        trackEvent,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            installPlugin,\n            closeMarketplaceModal: () => closeModal(ModalIdentifiers.PLUGIN_MARKETPLACE),\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MarketplaceItem);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class NavigationButton extends React.PureComponent {\n    static propTypes = {\n        onClick: PropTypes.func.isRequired,\n        messageId: PropTypes.string.isRequired,\n        defaultMessage: PropTypes.string.isRequired,\n    };\n\n    onClick = (e) => {\n        e.preventDefault();\n        this.props.onClick();\n    };\n\n    render() {\n        const {onClick, messageId, defaultMessage} = this.props;\n        return (\n            <button\n                className='btn btn-link'\n                onClick={onClick}\n            >\n                <FormattedMessage\n                    id={messageId}\n                    defaultMessage={defaultMessage}\n                />\n            </button>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport PropTypes from 'prop-types';\nimport {changeOpacity, makeStyleFromTheme} from 'mattermost-redux/utils/theme_utils';\n\nimport NavigationButton from './navigation_button';\n\nexport default class NavigationRow extends React.PureComponent {\n    static propTypes = {\n        page: PropTypes.number.isRequired,\n        total: PropTypes.number.isRequired,\n        maximumPerPage: PropTypes.number.isRequired,\n        onNextPageButtonClick: PropTypes.func.isRequired,\n        onPreviousPageButtonClick: PropTypes.func.isRequired,\n        theme: PropTypes.object.isRequired,\n    };\n\n    canShowNextButton = () => {\n        const {page, maximumPerPage, total} = this.props;\n        const totalPages = Math.trunc((total - 1) / maximumPerPage);\n\n        return totalPages > page;\n    };\n\n    renderCount = () => {\n        const {page, total, maximumPerPage} = this.props;\n        const startCount = page * maximumPerPage;\n        const endCount = Math.min(startCount + maximumPerPage, total);\n\n        return (\n            <FormattedMessage\n                id='marketplace_list.count_total_page'\n                defaultMessage='{startCount, number} - {endCount, number} {total, plural, one {plugin} other {plugins}} of {total, number} total'\n                values={{\n                    startCount: startCount + 1,\n                    endCount,\n                    total,\n                }}\n            />\n        );\n    };\n\n    render() {\n        const style = getStyle(this.props.theme);\n\n        return (\n            <div className='navigation-row'>\n                <div className='col-xs-2'>\n                    {(this.props.page > 0) && (\n                        <NavigationButton\n                            onClick={this.props.onPreviousPageButtonClick}\n                            messageId={'more_channels.prev'}\n                            defaultMessage={'Previous'}\n                        />\n                    )}\n                </div>\n                <div\n                    className='col-xs-8 count'\n                    style={style.count}\n                >\n                    {this.renderCount()}\n                </div>\n                <div className='col-xs-2'>\n                    {this.canShowNextButton() && (\n                        <NavigationButton\n                            onClick={this.props.onNextPageButtonClick}\n                            messageId={'more_channels.next'}\n                            defaultMessage={'Next'}\n                        />\n                    )}\n                </div>\n            </div>\n        );\n    }\n}\n\nconst getStyle = makeStyleFromTheme((theme) => {\n    return {\n        count: {\n            color: changeOpacity(theme.centerChannelColor, 0.6),\n        },\n    };\n});\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {getTheme} from 'mattermost-redux/selectors/entities/preferences';\nimport {connect} from 'react-redux';\n\nimport NavigationRow from './navigation_row';\n\nfunction mapStateToProps(state) {\n    return {\n        theme: getTheme(state),\n    };\n}\n\nexport default connect(mapStateToProps)(NavigationRow);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport MarketplaceItem from '../marketplace_item';\n\nimport NavigationRow from './navigation_row';\n\nconst PLUGINS_PER_PAGE = 15;\n\nexport default class MarketplaceList extends React.PureComponent {\n    static propTypes = {\n        plugins: PropTypes.array.isRequired,\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        if (state.page > 0 && props.plugins.length < PLUGINS_PER_PAGE) {\n            return {page: 0};\n        }\n\n        return null;\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            page: 0,\n        };\n    }\n\n    nextPage = () => {\n        this.setState((state) => ({\n            page: state.page + 1\n        }));\n    };\n\n    previousPage = () => {\n        this.setState((state) => ({\n            page: state.page - 1\n        }));\n    };\n\n    render() {\n        const pageStart = this.state.page * PLUGINS_PER_PAGE;\n        const pageEnd = pageStart + PLUGINS_PER_PAGE;\n        const pluginsToDisplay = this.props.plugins.slice(pageStart, pageEnd);\n\n        return (\n            <div className='more-modal__list'>\n                {pluginsToDisplay.map((p) => (\n                    <MarketplaceItem\n                        key={p.manifest.id}\n                        id={p.manifest.id}\n                        name={p.manifest.name}\n                        description={p.manifest.description}\n                        version={p.manifest.version}\n                        isPrepackaged={false}\n                        downloadUrl={p.download_url}\n                        homepageUrl={p.homepage_url}\n                        releaseNotesUrl={p.release_notes_url}\n                        labels={p.labels}\n                        iconData={p.icon_data}\n                        installedVersion={p.installed_version}\n                    />\n                ))}\n                <NavigationRow\n                    page={this.state.page}\n                    total={this.props.plugins.length}\n                    maximumPerPage={PLUGINS_PER_PAGE}\n                    onNextPageButtonClick={this.nextPage}\n                    onPreviousPageButtonClick={this.previousPage}\n                />\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport debounce from 'lodash/debounce';\nimport {Tabs, Tab} from 'react-bootstrap';\n\nimport FullScreenModal from 'components/widgets/modals/full_screen_modal';\nimport RootPortal from 'components/root_portal';\nimport QuickInput from 'components/quick_input';\nimport LocalizedInput from 'components/localized_input/localized_input';\nimport PluginIcon from 'components/widgets/icons/plugin_icon.jsx';\nimport LoadingScreen from 'components/loading_screen';\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message.jsx';\n\nimport {trackEvent} from 'actions/diagnostics_actions.jsx';\nimport {t} from 'utils/i18n';\nimport {localizeMessage} from 'utils/utils';\n\nimport './marketplace_modal.scss';\nimport MarketplaceList from './marketplace_list/marketplace_list';\n\nconst MarketplaceTabs = {\n    ALL_PLUGINS: 'allPlugins',\n    INSTALLED_PLUGINS: 'installed',\n};\n\nconst SEARCH_TIMEOUT_MILLISECONDS = 200;\n\n// AllPlugins renders the contents of the all plugins tab.\nexport const AllPlugins = ({plugins}) => {\n    if (plugins.length === 0) {\n        return (\n            <div className='no_plugins_div'>\n                <br/>\n                <PluginIcon className='icon__plugin'/>\n                <div className='mt-3 light'>\n                    <FormattedMessage\n                        id='marketplace_modal.no_plugins'\n                        defaultMessage='There are no plugins available at this time.'\n                    />\n                </div>\n            </div>\n        );\n    }\n\n    return <MarketplaceList plugins={plugins}/>;\n};\n\nAllPlugins.propTypes = {\n    plugins: PropTypes.array.isRequired,\n};\n\n// InstalledPlugins renders the contents of the installed plugins tab.\nexport const InstalledPlugins = ({installedPlugins, changeTab}) => {\n    if (installedPlugins.length === 0) {\n        return (\n            <div className='no_plugins_div'>\n                <br/>\n                <PluginIcon className='icon__plugin'/>\n                <div className='mt-3 light'>\n                    <FormattedMessage\n                        id='marketplace_modal.no_plugins_installed'\n                        defaultMessage='You do not have any plugins installed.'\n                    />\n                </div>\n                <button\n                    className='mt-5 style--none color--link'\n                    onClick={() => changeTab(MarketplaceTabs.ALL_PLUGINS)}\n                    data-testid='Install-Plugins-button'\n                >\n                    <FormattedMessage\n                        id='marketplace_modal.install_plugins'\n                        defaultMessage='Install Plugins'\n                    />\n                </button>\n            </div>\n        );\n    }\n\n    return <MarketplaceList plugins={installedPlugins}/>;\n};\n\nInstalledPlugins.propTypes = {\n    installedPlugins: PropTypes.array.isRequired,\n    changeTab: PropTypes.func,\n};\n\n// MarketplaceModal is the plugin marketplace.\nexport class MarketplaceModal extends React.Component {\n    static propTypes = {\n        show: PropTypes.bool,\n        plugins: PropTypes.array.isRequired,\n        installedPlugins: PropTypes.array.isRequired,\n        siteURL: PropTypes.string.isRequired,\n        pluginStatuses: PropTypes.object.isRequired,\n        actions: PropTypes.shape({\n            closeModal: PropTypes.func.isRequired,\n            fetchPlugins: PropTypes.func.isRequired,\n            filterPlugins: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            tabKey: MarketplaceTabs.ALL_PLUGINS,\n            loading: true,\n            serverError: null,\n            filter: '',\n        };\n    }\n\n    componentDidMount() {\n        trackEvent('plugins', 'ui_marketplace_opened');\n\n        this.fetchPlugins();\n\n        if (this.refs.filter) {\n            this.refs.filter.focus();\n        }\n    }\n\n    componentDidUpdate(prevProps) {\n        // Automatically refresh the component when a plugin is installed or uninstalled.\n        if (this.props.pluginStatuses !== prevProps.pluginStatuses) {\n            this.fetchPlugins();\n        }\n    }\n\n    fetchPlugins = async () => {\n        const {error} = await this.props.actions.fetchPlugins();\n\n        this.setState({loading: false, serverError: error});\n    }\n\n    close = () => {\n        trackEvent('plugins', 'ui_marketplace_closed');\n        this.props.actions.closeModal();\n    }\n\n    changeTab = (tabKey) => {\n        this.setState({tabKey});\n    }\n\n    onInput = () => {\n        this.setState({filter: this.refs.filter.value});\n\n        this.debouncedSearch();\n    }\n\n    handleClearSearch = () => {\n        this.refs.filter.value = '';\n        this.setState({filter: this.refs.filter.value}, this.doSearch);\n    }\n\n    doSearch = async () => {\n        trackEvent('plugins', 'ui_marketplace_search');\n\n        const {error} = await this.props.actions.filterPlugins(this.state.filter);\n\n        this.setState({serverError: error});\n    }\n\n    debouncedSearch = debounce(this.doSearch, SEARCH_TIMEOUT_MILLISECONDS);\n\n    render() {\n        const input = (\n            <div className='filter-row filter-row--full'>\n                <div className='col-sm-12'>\n                    <QuickInput\n                        id='searchMarketplaceTextbox'\n                        ref='filter'\n                        className='form-control filter-textbox search_input'\n                        placeholder={{id: t('marketplace_modal.search'), defaultMessage: 'Search Plugins'}}\n                        inputComponent={LocalizedInput}\n                        onInput={this.onInput}\n                        value={this.state.filter}\n                        clearable={true}\n                        onClear={this.handleClearSearch}\n                    />\n                </div>\n            </div>\n        );\n\n        let errorBanner = null;\n        if (this.state.serverError) {\n            errorBanner = (\n                <div\n                    className='error-bar'\n                    id='error_bar'\n                >\n                    <div className='error-bar__content'>\n                        <FormattedMarkdownMessage\n                            id='app.plugin.marketplace_plugins.app_error'\n                            defaultMessage='Error connecting to the marketplace server. Please check your settings in the [System Console]({siteURL}/admin_console/plugins/plugin_management).'\n                            values={{siteURL: this.props.siteURL}}\n                        />\n                    </div>\n                </div>\n            );\n        }\n\n        return (\n            <RootPortal>\n                <FullScreenModal\n                    show={this.props.show}\n                    onClose={this.close}\n                    ariaLabel={localizeMessage('marketplace_modal.title', 'Plugin Marketplace')}\n                >\n                    {errorBanner}\n                    <div\n                        className='modal-marketplace'\n                        id='modal_marketplace'\n                    >\n                        <h1>\n                            <strong>\n                                <FormattedMessage\n                                    id='marketplace_modal.title'\n                                    defaultMessage='Plugin Marketplace'\n                                />\n                            </strong>\n                        </h1>\n                        {input}\n                        <Tabs\n                            id='marketplaceTabs'\n                            className='tabs'\n                            defaultActiveKey='allPlugins'\n                            activeKey={this.state.tabKey}\n                            onSelect={this.changeTab}\n                            unmountOnExit={true}\n                        >\n                            <Tab\n                                eventKey={MarketplaceTabs.ALL_PLUGINS}\n                                title={localizeMessage('marketplace_modal.tabs.all_plugins', 'All Plugins')}\n                            >\n                                {this.state.loading ? <LoadingScreen/> : <AllPlugins plugins={this.props.plugins}/>}\n                            </Tab>\n                            <Tab\n                                eventKey={MarketplaceTabs.INSTALLED_PLUGINS}\n                                title={localizeMessage('marketplace_modal.tabs.installed_plugins', 'Installed') + ` (${this.props.installedPlugins.length})`}\n                            >\n                                <InstalledPlugins\n                                    installedPlugins={this.props.installedPlugins}\n                                    changeTab={this.changeTab}\n                                />\n                            </Tab>\n                        </Tabs>\n                    </div>\n                </FullScreenModal>\n            </RootPortal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getPlugins, getInstalledPlugins} from 'selectors/views/marketplace';\n\nimport {isModalOpen} from 'selectors/views/modals';\nimport {ModalIdentifiers} from 'utils/constants';\nimport {getSiteURL} from 'utils/url';\n\nimport {closeModal} from 'actions/views/modals';\nimport {fetchPlugins, filterPlugins} from 'actions/marketplace';\n\nimport {MarketplaceModal} from './marketplace_modal';\n\nfunction mapStateToProps(state) {\n    return {\n        show: isModalOpen(state, ModalIdentifiers.PLUGIN_MARKETPLACE),\n        plugins: getPlugins(state),\n        installedPlugins: getInstalledPlugins(state),\n        siteURL: getSiteURL(state),\n        pluginStatuses: state.entities.admin.pluginStatuses,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            closeModal: () => closeModal(ModalIdentifiers.PLUGIN_MARKETPLACE),\n            fetchPlugins,\n            filterPlugins,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MarketplaceModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport LoadingScreen from 'components/loading_screen';\n\nexport const DEFAULT_NUM_PER_PAGE = 50;\n\nexport default class ListModal extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * loadItems is a function that receives the params (pageNumber, searchTerm) and should return an object\n         * with the shape {items: [], totalCount: 0}.\n         * items: an array of objects that are passed to each renderRow function.\n         * totalCount: an integer representing the total number of items as displayed in the pagination text.\n         *\n         * Example:\n         *     const loadItems = async (pageNumber, searchTerm) => {\n         *         const {data} = await loadFromServer(searchTerm, pageNumber, PER_PAGE);\n         *         return {\n         *             items: data.users,\n         *             totalCount: data.total,\n         *         };\n         *     };\n         */\n        loadItems: PropTypes.func.isRequired,\n\n        /**\n         * renderRow is a function that receives the params (item, listModal) and should return JSX.\n         * item: an object as returned by each entry in the loadItems function's 'items' array.\n         * listModal: the instance of the ListModal component class.\n         *\n         * Example:\n         *     const renderRow = (item, listModal) => <div>{item.id}</div>;\n         */\n        renderRow: PropTypes.func.isRequired,\n\n        /**\n         * onHide (optional) a function to be invoked when the modal is closed.\n         */\n        onHide: PropTypes.func,\n\n        /**\n         * titleText (optional) a string to show at the top bar of the modal.\n         */\n        titleText: PropTypes.string,\n\n        /**\n         * searchPlaceholderText (optional) a string to show as a placeholder in the search input.\n         */\n        searchPlaceholderText: PropTypes.string,\n\n        /**\n         * titleBarButtonText (optional) a string representing a title bar button text.\n         */\n        titleBarButtonText: PropTypes.string,\n\n        /**\n         * titleBarButtonOnClick (optional) a func to handle title button bar clicks.\n         */\n        titleBarButtonOnClick: PropTypes.func,\n\n        /**\n         * numPerPage (optional) a number setting how many items per page should be displayed. Defaults to\n         * DEFAULT_NUM_PER_PAGE.\n         */\n        numPerPage: PropTypes.number,\n\n        /**\n         * show (optional) a boolean setting to hide the modal via props rather then unmounting it.\n         */\n        show: PropTypes.bool,\n    };\n\n    static defaultProps = {\n        show: true,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.numPerPage = props.numPerPage || DEFAULT_NUM_PER_PAGE;\n\n        this.state = {\n            show: true,\n            page: 0,\n            items: [],\n            totalCount: 0,\n            loading: true,\n            searchTerm: '',\n        };\n    }\n\n    async componentDidMount() {\n        const {totalCount, items} = await this.props.loadItems(0, '');\n        this.setState({totalCount, items, loading: false}); // eslint-disable-line react/no-did-mount-set-state\n    }\n\n    handleHide = () => {\n        this.setState({show: false});\n    }\n\n    handleExit = () => {\n        if (this.props.onHide) {\n            this.props.onHide();\n        }\n    }\n\n    renderRows() {\n        if (this.state.loading) {\n            return (\n                <div>\n                    <LoadingScreen\n                        position='absolute'\n                        key='loading'\n                    />\n                </div>\n            );\n        }\n        return this.state.items.map((item) => (\n            this.props.renderRow(item, this)\n        ));\n    }\n\n    onNext = () => {\n        const nextPage = this.state.page + 1;\n        this.onPageChange(nextPage);\n    }\n\n    onPrev = () => {\n        const prevPage = this.state.page - 1;\n        this.onPageChange(prevPage);\n    }\n\n    onPageChange = async (page) => {\n        this.setState({loading: true});\n        const result = await this.props.loadItems(page, this.state.searchTerm);\n        this.setState({page, items: result.items, loading: false});\n    }\n\n    onSearchInput = async (event) => {\n        const {target} = event;\n        const searchTerm = target.value;\n        this.setState({loading: true, searchTerm});\n        const result = await this.props.loadItems(0, searchTerm);\n        const {items, totalCount} = result;\n        this.setState({loading: false, items, totalCount});\n    }\n\n    paginationRange() {\n        let startCount = (this.state.page * this.numPerPage) + 1;\n        const endCount = (startCount + this.state.items.length) - 1;\n        if (endCount === 0) {\n            startCount = 0;\n        }\n        return {startCount, endCount};\n    }\n\n    render() {\n        if (!this.props.show) {\n            return null;\n        }\n        const {endCount, startCount} = this.paginationRange();\n        return (\n            <div>\n                <Modal\n                    dialogClassName='a11y__modal more-modal more-modal--action'\n                    show={this.state.show}\n                    onHide={this.handleHide}\n                    onExited={this.handleExit}\n                >\n                    <Modal.Header closeButton={true}>\n                        <Modal.Title componentClass='h1'>\n                            <span className='name'>{this.props.titleText}</span>\n                        </Modal.Title>\n                        {this.props.titleBarButtonText && this.props.titleBarButtonOnClick &&\n                            <a\n                                className='btn btn-md btn-primary'\n                                href='#'\n                                onClick={this.props.titleBarButtonOnClick}\n                            >\n                                {this.props.titleBarButtonText}\n                            </a>}\n                    </Modal.Header>\n                    <Modal.Body>\n                        <div className='filtered-user-list'>\n                            <div className='filter-row'>\n                                <div className='col-xs-12'>\n                                    <label\n                                        className='hidden-label'\n                                        htmlFor='searchUsersInput'\n                                    >\n                                        {this.props.searchPlaceholderText}\n                                    </label>\n                                    <input\n                                        id='searchUsersInput'\n                                        className='form-control filter-textbox'\n                                        placeholder={this.props.searchPlaceholderText}\n                                        onChange={this.onSearchInput}\n                                    />\n                                </div>\n                                <div className='col-sm-12'>\n                                    <span className='member-count pull-left'>\n                                        <FormattedMessage\n                                            id='list_modal.paginatorCount'\n                                            defaultMessage='{startCount, number} - {endCount, number} of {total, number} total'\n                                            values={{\n                                                startCount,\n                                                endCount,\n                                                total: this.state.totalCount,\n                                            }}\n                                        />\n                                    </span>\n                                </div>\n                            </div>\n                            <div className='more-modal__list'>\n                                <div>\n                                    {this.renderRows()}\n                                </div>\n                            </div>\n                            <div className='filter-controls'>\n                                {this.state.page > 0 &&\n                                <button\n                                    onClick={this.onPrev}\n                                    className='btn btn-link filter-control filter-control__prev'\n                                >\n                                    <FormattedMessage\n                                        id='filtered_user_list.prev'\n                                        defaultMessage='Previous'\n                                    />\n                                </button>}\n                                {(this.state.items.length >= this.props.numPerPage) && endCount !== this.state.totalCount &&\n                                <button\n                                    onClick={this.onNext}\n                                    className='btn btn-link filter-control filter-control__next'\n                                >\n                                    <FormattedMessage\n                                        id='filtered_user_list.next'\n                                        defaultMessage='Next'\n                                    />\n                                </button>}\n                            </div>\n                        </div>\n                    </Modal.Body>\n                </Modal>\n            </div >\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage, injectIntl} from 'react-intl';\n\nimport {Groups} from 'mattermost-redux/constants';\n\nimport ConfirmModal from 'components/confirm_modal';\n\nimport AddGroupsToTeamModal from 'components/add_groups_to_team_modal';\n\nimport {ModalIdentifiers} from 'utils/constants';\nimport {intlShape} from 'utils/react_intl';\n\nimport ListModal, {DEFAULT_NUM_PER_PAGE} from 'components/list_modal.jsx';\n\nimport DropdownIcon from 'components/widgets/icons/fa_dropdown_icon';\n\nimport groupsAvatar from 'images/groups-avatar.png';\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\nimport Menu from 'components/widgets/menu/menu';\n\nimport * as Utils from 'utils/utils.jsx';\n\nclass TeamGroupsManageModal extends React.PureComponent {\n    static propTypes = {\n        intl: intlShape.isRequired,\n        team: PropTypes.object.isRequired,\n        actions: PropTypes.shape({\n            getGroupsAssociatedToTeam: PropTypes.func.isRequired,\n            unlinkGroupSyncable: PropTypes.func.isRequired,\n            patchGroupSyncable: PropTypes.func.isRequired,\n            getMyTeamMembers: PropTypes.func.isRequired,\n            closeModal: PropTypes.func.isRequired,\n            openModal: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    state = {\n        showConfirmModal: false,\n        item: {member_count: 0},\n        listModal: null,\n    };\n\n    loadItems = async (pageNumber, searchTerm) => {\n        const {data} = await this.props.actions.getGroupsAssociatedToTeam(this.props.team.id, searchTerm, pageNumber, DEFAULT_NUM_PER_PAGE, true);\n\n        return {\n            items: data.groups,\n            totalCount: data.totalGroupCount,\n        };\n    };\n\n    handleDeleteCanceled = () => {\n        this.setState({showConfirmModal: false});\n    };\n\n    handleDeleteConfirmed = () => {\n        this.setState({showConfirmModal: false});\n        const {item, listModal} = this.state;\n        this.props.actions.unlinkGroupSyncable(item.id, this.props.team.id, Groups.SYNCABLE_TYPE_TEAM).then(async () => {\n            listModal.setState({loading: true});\n            const {items, totalCount} = await listModal.props.loadItems(listModal.setState.page, listModal.state.searchTerm);\n\n            listModal.setState({loading: false, items, totalCount});\n        });\n    };\n\n    onClickRemoveGroup = (item, listModal) => {\n        this.setState({showConfirmModal: true, item, listModal});\n    };\n\n    onClickConfirmRemoveGroup = (item, listModal) => this.props.actions.unlinkGroupSyncable(item.id, this.props.team.id, Groups.SYNCABLE_TYPE_TEAM).then(async () => {\n        listModal.setState({loading: true});\n        const {items, totalCount} = await listModal.props.loadItems(listModal.setState.page, listModal.state.searchTerm);\n        listModal.setState({loading: false, items, totalCount});\n    });\n\n    onHide = () => {\n        this.props.actions.closeModal(ModalIdentifiers.MANAGE_TEAM_GROUPS);\n    };\n\n    titleButtonOnClick = () => {\n        this.onHide();\n        this.props.actions.openModal({modalId: ModalIdentifiers.ADD_GROUPS_TO_TEAM, dialogType: AddGroupsToTeamModal});\n    };\n\n    setTeamMemberStatus = async (item, listModal, isTeamAdmin) => {\n        this.props.actions.patchGroupSyncable(item.id, this.props.team.id, Groups.SYNCABLE_TYPE_TEAM, {scheme_admin: isTeamAdmin}).then(async () => {\n            listModal.setState({loading: true});\n            const {items, totalCount} = await listModal.props.loadItems(listModal.setState.page, listModal.state.searchTerm);\n\n            this.props.actions.getMyTeamMembers();\n\n            listModal.setState({loading: false, items, totalCount});\n        });\n    };\n\n    renderRow = (item, listModal) => {\n        let title;\n        if (item.scheme_admin) {\n            title = Utils.localizeMessage('team_members_dropdown.teamAdmins', 'Team Admins');\n        } else {\n            title = Utils.localizeMessage('team_members_dropdown.teamMembers', 'Team Members');\n        }\n\n        return (\n            <div\n                key={item.id}\n                className='more-modal__row'\n            >\n                <img\n                    className='more-modal__image'\n                    src={groupsAvatar}\n                    alt='group picture'\n                    width='32'\n                    height='32'\n                />\n                <div className='more-modal__details'>\n                    <div className='more-modal__name'>{item.display_name} {'-'} &nbsp;\n                        <span className='more-modal__name_count'>\n                            <FormattedMessage\n                                id='numMembers'\n                                defaultMessage='{num, number} {num, plural, one {member} other {members}}'\n                                values={{\n                                    num: item.member_count,\n                                }}\n                            />\n                        </span>\n                    </div>\n                </div>\n                <div className='more-modal__actions'>\n                    <MenuWrapper>\n                        <button\n                            id={`teamGroupsDropdown_${item.display_name}`}\n                            className='dropdown-toggle theme color--link style--none'\n                            type='button'\n                            aria-expanded='true'\n                        >\n                            <span>{title} </span>\n                            <DropdownIcon/>\n                        </button>\n                        <Menu\n                            openLeft={true}\n                            ariaLabel={Utils.localizeMessage('team_members_dropdown.menuAriaLabel', 'Change the role of a team member')}\n                        >\n                            <Menu.ItemAction\n                                show={!item.scheme_admin}\n                                onClick={() => this.setTeamMemberStatus(item, listModal, true)}\n                                text={Utils.localizeMessage('team_members_dropdown.makeTeamAdmins', 'Make Team Admins')}\n                            />\n                            <Menu.ItemAction\n                                show={Boolean(item.scheme_admin)}\n                                onClick={() => this.setTeamMemberStatus(item, listModal, false)}\n                                text={Utils.localizeMessage('team_members_dropdown.makeTeamMembers', 'Make Team Members')}\n                            />\n                            <Menu.ItemAction\n                                onClick={() => this.onClickRemoveGroup(item, listModal)}\n                                text={Utils.localizeMessage('group_list_modal.removeGroupButton', 'Remove Group')}\n                            />\n                        </Menu>\n                    </MenuWrapper>\n                </div>\n            </div>\n        );\n    };\n\n    render() {\n        const {formatMessage} = this.props.intl;\n        const memberCount = this.state.item.member_count;\n        return (\n            <>\n                <ListModal\n                    show={!this.state.showConfirmModal}\n                    titleText={formatMessage({id: 'groups', defaultMessage: '{team} Groups'}, {team: this.props.team.display_name})}\n                    searchPlaceholderText={formatMessage({id: 'manage_team_groups_modal.search_placeholder', defaultMessage: 'Search groups'})}\n                    renderRow={this.renderRow}\n                    loadItems={this.loadItems}\n                    onHide={this.onHide}\n                    titleBarButtonText={formatMessage({id: 'group_list_modal.addGroupButton', defaultMessage: 'Add Groups'})}\n                    titleBarButtonOnClick={this.titleButtonOnClick}\n                />\n                <ConfirmModal\n                    show={this.state.showConfirmModal}\n                    title={formatMessage({id: 'remove_group_confirm_title', defaultMessage: 'Remove Group and {memberCount, number} {memberCount, plural, one {Member} other {Members}}'}, {memberCount})}\n                    message={formatMessage({id: 'remove_group_confirm_message', defaultMessage: '{memberCount, number} {memberCount, plural, one {member} other {members}} associated to this group will be removed from the team. Are you sure you wish to remove this group and {memberCount} {memberCount, plural, one {member} other {members}}?'}, {memberCount})}\n                    confirmButtonText={formatMessage({id: 'remove_group_confirm_button', defaultMessage: 'Yes, Remove Group and {memberCount, plural, one {Member} other {Members}}'}, {memberCount})}\n                    onConfirm={this.handleDeleteConfirmed}\n                    onCancel={this.handleDeleteCanceled}\n                />\n            </>\n        );\n    }\n}\n\nexport default injectIntl(TeamGroupsManageModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {getGroupsAssociatedToTeam, unlinkGroupSyncable, patchGroupSyncable} from 'mattermost-redux/actions/groups';\nimport {getMyTeamMembers} from 'mattermost-redux/actions/teams';\n\nimport {closeModal, openModal} from 'actions/views/modals';\n\nimport TeamGroupsManageModal from './team_groups_manage_modal';\n\nconst mapStateToProps = (state, ownProps) => {\n    return {\n        team: state.entities.teams.teams[ownProps.teamID],\n    };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({\n        getGroupsAssociatedToTeam,\n        closeModal,\n        openModal,\n        unlinkGroupSyncable,\n        patchGroupSyncable,\n        getMyTeamMembers,\n    }, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TeamGroupsManageModal);","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {injectIntl} from 'react-intl';\nimport {Permissions} from 'mattermost-redux/constants';\n\nimport * as GlobalActions from 'actions/global_actions.jsx';\nimport {Constants, ModalIdentifiers} from 'utils/constants';\nimport {intlShape} from 'utils/react_intl';\nimport {cmdOrCtrlPressed, isKeyPressed} from 'utils/utils';\nimport {useSafeUrl} from 'utils/url';\nimport * as UserAgent from 'utils/user_agent';\nimport InvitationModal from 'components/invitation_modal';\n\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\nimport SystemPermissionGate from 'components/permissions_gates/system_permission_gate';\n\nimport LeaveTeamIcon from 'components/widgets/icons/leave_team_icon';\n\nimport LeaveTeamModal from 'components/leave_team_modal';\nimport UserSettingsModal from 'components/user_settings/modal';\nimport TeamMembersModal from 'components/team_members_modal';\nimport TeamSettingsModal from 'components/team_settings_modal';\nimport AboutBuildModal from 'components/about_build_modal';\nimport AddGroupsToTeamModal from 'components/add_groups_to_team_modal';\nimport MarketplaceModal from 'components/plugin_marketplace';\n\nimport Menu from 'components/widgets/menu/menu';\nimport TeamGroupsManageModal from 'components/team_groups_manage_modal';\n\nclass MainMenu extends React.PureComponent {\n    static propTypes = {\n        mobile: PropTypes.bool.isRequired,\n        id: PropTypes.string,\n        teamId: PropTypes.string,\n        teamType: PropTypes.string,\n        teamName: PropTypes.string,\n        siteName: PropTypes.string,\n        currentUser: PropTypes.object,\n        appDownloadLink: PropTypes.string,\n        enableCommands: PropTypes.bool.isRequired,\n        enableCustomEmoji: PropTypes.bool.isRequired,\n        canCreateOrDeleteCustomEmoji: PropTypes.bool.isRequired,\n        enableIncomingWebhooks: PropTypes.bool.isRequired,\n        enableOAuthServiceProvider: PropTypes.bool.isRequired,\n        enableOutgoingWebhooks: PropTypes.bool.isRequired,\n        enableUserCreation: PropTypes.bool.isRequired,\n        enableEmailInvitations: PropTypes.bool.isRequired,\n        enablePluginMarketplace: PropTypes.bool.isRequired,\n        experimentalPrimaryTeam: PropTypes.string,\n        helpLink: PropTypes.string,\n        reportAProblemLink: PropTypes.string,\n        moreTeamsToJoin: PropTypes.bool.isRequired,\n        pluginMenuItems: PropTypes.arrayOf(PropTypes.object),\n        isMentionSearch: PropTypes.bool,\n        teamIsGroupConstrained: PropTypes.bool.isRequired,\n        isLicensedForLDAPGroups: PropTypes.bool,\n        intl: intlShape.isRequired,\n        actions: PropTypes.shape({\n            openModal: PropTypes.func.isRequred,\n            showMentions: PropTypes.func,\n            showFlaggedPosts: PropTypes.func,\n            closeRightHandSide: PropTypes.func.isRequired,\n            closeRhsMenu: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    static defaultProps = {\n        teamType: '',\n        mobile: false,\n        pluginMenuItems: [],\n    };\n\n    toggleShortcutsModal = (e) => {\n        e.preventDefault();\n        GlobalActions.toggleShortcutsModal();\n    }\n\n    componentDidMount() {\n        document.addEventListener('keydown', this.handleKeyDown);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleKeyDown);\n    }\n\n    handleKeyDown = (e) => {\n        if (cmdOrCtrlPressed(e) && e.shiftKey && isKeyPressed(e, Constants.KeyCodes.A)) {\n            this.props.actions.openModal({ModalId: ModalIdentifiers.USER_SETTINGS, dialogType: UserSettingsModal});\n        }\n    }\n\n    handleEmitUserLoggedOutEvent = () => {\n        GlobalActions.emitUserLoggedOutEvent();\n    }\n\n    getFlagged = (e) => {\n        e.preventDefault();\n        this.props.actions.showFlaggedPosts();\n        this.props.actions.closeRhsMenu();\n    }\n\n    searchMentions = (e) => {\n        e.preventDefault();\n\n        if (this.props.isMentionSearch) {\n            this.props.actions.closeRightHandSide();\n        } else {\n            this.props.actions.closeRhsMenu();\n            this.props.actions.showMentions();\n        }\n    }\n\n    render() {\n        const {currentUser, teamIsGroupConstrained, isLicensedForLDAPGroups} = this.props;\n\n        if (!currentUser) {\n            return null;\n        }\n\n        const pluginItems = this.props.pluginMenuItems.map((item) => {\n            return (\n                <Menu.ItemAction\n                    id={item.id + '_pluginmenuitem'}\n                    key={item.id + '_pluginmenuitem'}\n                    onClick={() => {\n                        if (item.action) {\n                            item.action();\n                        }\n                    }}\n                    text={item.text}\n                    icon={this.props.mobile && item.mobileIcon}\n                />\n            );\n        });\n\n        const {formatMessage} = this.props.intl;\n\n        return (\n            <Menu\n                mobile={this.props.mobile}\n                id={this.props.id}\n                ariaLabel={formatMessage({id: 'navbar_dropdown.menuAriaLabel', defaultMessage: 'main menu'})}\n            >\n                <Menu.Group>\n                    <Menu.ItemAction\n                        id='recentMentions'\n                        show={this.props.mobile}\n                        onClick={this.searchMentions}\n                        icon={this.props.mobile && <i className='mentions'>{'@'}</i>}\n                        text={formatMessage({id: 'sidebar_right_menu.recentMentions', defaultMessage: 'Recent Mentions'})}\n                    />\n                    <Menu.ItemAction\n                        id='flaggedPosts'\n                        show={this.props.mobile}\n                        onClick={this.getFlagged}\n                        icon={this.props.mobile && <i className='fa fa-flag'/>}\n                        text={formatMessage({id: 'sidebar_right_menu.flagged', defaultMessage: 'Flagged Posts'})}\n                    />\n                </Menu.Group>\n                <Menu.Group>\n                    <Menu.ItemToggleModalRedux\n                        id='accountSettings'\n                        modalId={ModalIdentifiers.USER_SETTINGS}\n                        dialogType={UserSettingsModal}\n                        text={formatMessage({id: 'navbar_dropdown.accountSettings', defaultMessage: 'Account Settings'})}\n                        icon={this.props.mobile && <i className='fa fa-cog'/>}\n                    />\n                </Menu.Group>\n                <Menu.Group>\n                    <TeamPermissionGate\n                        teamId={this.props.teamId}\n                        permissions={[Permissions.MANAGE_TEAM]}\n                    >\n                        <Menu.ItemToggleModalRedux\n                            id='addGroupsToTeam'\n                            show={teamIsGroupConstrained && isLicensedForLDAPGroups}\n                            modalId={ModalIdentifiers.ADD_GROUPS_TO_TEAM}\n                            dialogType={AddGroupsToTeamModal}\n                            text={formatMessage({id: 'navbar_dropdown.addGroupsToTeam', defaultMessage: 'Add Groups to Team'})}\n                            icon={this.props.mobile && <i className='fa fa-user-plus'/>}\n                        />\n                    </TeamPermissionGate>\n                    <TeamPermissionGate\n                        teamId={this.props.teamId}\n                        permissions={[Permissions.ADD_USER_TO_TEAM, Permissions.INVITE_GUEST]}\n                    >\n                        <Menu.ItemToggleModalRedux\n                            id='invitePeople'\n                            modalId={ModalIdentifiers.INVITATION}\n                            dialogType={InvitationModal}\n                            text={formatMessage({id: 'navbar_dropdown.invitePeople', defaultMessage: 'Invite People'})}\n                            extraText={formatMessage({id: 'navbar_dropdown.invitePeopleExtraText', defaultMessage: 'Add or invite people to the team'})}\n                            icon={this.props.mobile && <i className='fa fa-user-plus'/>}\n                        />\n                    </TeamPermissionGate>\n                </Menu.Group>\n                <Menu.Group>\n                    <TeamPermissionGate\n                        teamId={this.props.teamId}\n                        permissions={[Permissions.MANAGE_TEAM]}\n                    >\n                        <Menu.ItemToggleModalRedux\n                            id='teamSettings'\n                            modalId={ModalIdentifiers.TEAM_SETTINGS}\n                            dialogType={TeamSettingsModal}\n                            text={formatMessage({id: 'navbar_dropdown.teamSettings', defaultMessage: 'Team Settings'})}\n                            icon={this.props.mobile && <i className='fa fa-globe'/>}\n                        />\n                    </TeamPermissionGate>\n                    <TeamPermissionGate\n                        teamId={this.props.teamId}\n                        permissions={[Permissions.MANAGE_TEAM]}\n                    >\n                        <Menu.ItemToggleModalRedux\n                            id='manageGroups'\n                            show={teamIsGroupConstrained && isLicensedForLDAPGroups}\n                            modalId={ModalIdentifiers.MANAGE_TEAM_GROUPS}\n                            dialogProps={{\n                                teamID: this.props.teamId,\n                            }}\n                            dialogType={TeamGroupsManageModal}\n                            text={formatMessage({id: 'navbar_dropdown.manageGroups', defaultMessage: 'Manage Groups'})}\n                            icon={this.props.mobile && <i className='fa fa-user-plus'/>}\n                        />\n                    </TeamPermissionGate>\n                    <TeamPermissionGate\n                        teamId={this.props.teamId}\n                        permissions={[Permissions.REMOVE_USER_FROM_TEAM, Permissions.MANAGE_TEAM_ROLES]}\n                    >\n                        <Menu.ItemToggleModalRedux\n                            id='manageMembers'\n                            modalId={ModalIdentifiers.TEAM_MEMBERS}\n                            dialogType={TeamMembersModal}\n                            text={formatMessage({id: 'navbar_dropdown.manageMembers', defaultMessage: 'Manage Members'})}\n                            icon={this.props.mobile && <i className='fa fa-users'/>}\n                        />\n                    </TeamPermissionGate>\n                    <TeamPermissionGate\n                        teamId={this.props.teamId}\n                        permissions={[Permissions.REMOVE_USER_FROM_TEAM, Permissions.MANAGE_TEAM_ROLES]}\n                        invert={true}\n                    >\n                        <Menu.ItemToggleModalRedux\n                            id='viewMembers'\n                            modalId={ModalIdentifiers.TEAM_MEMBERS}\n                            dialogType={TeamMembersModal}\n                            text={formatMessage({id: 'navbar_dropdown.viewMembers', defaultMessage: 'View Members'})}\n                            icon={this.props.mobile && <i className='fa fa-users'/>}\n                        />\n                    </TeamPermissionGate>\n                </Menu.Group>\n                <Menu.Group>\n                    <SystemPermissionGate permissions={[Permissions.CREATE_TEAM]}>\n                        <Menu.ItemLink\n                            id='createTeam'\n                            to='/create_team'\n                            text={formatMessage({id: 'navbar_dropdown.create', defaultMessage: 'Create a Team'})}\n                            icon={this.props.mobile && <i className='fa fa-plus-square'/>}\n                        />\n                    </SystemPermissionGate>\n                    <Menu.ItemLink\n                        id='joinTeam'\n                        show={!this.props.experimentalPrimaryTeam && this.props.moreTeamsToJoin}\n                        to='/select_team'\n                        text={formatMessage({id: 'navbar_dropdown.join', defaultMessage: 'Join Another Team'})}\n                        icon={this.props.mobile && <i className='fa fa-plus-square'/>}\n                    />\n                    <Menu.ItemToggleModalRedux\n                        id='leaveTeam'\n                        show={!teamIsGroupConstrained && this.props.experimentalPrimaryTeam !== this.props.teamName}\n                        modalId={ModalIdentifiers.LEAVE_TEAM}\n                        dialogType={LeaveTeamModal}\n                        text={formatMessage({id: 'navbar_dropdown.leave', defaultMessage: 'Leave Team'})}\n                        icon={this.props.mobile && <LeaveTeamIcon/>}\n                    />\n                </Menu.Group>\n                <Menu.Group>\n                    {pluginItems}\n                </Menu.Group>\n                <Menu.Group>\n                    <TeamPermissionGate\n                        teamId={this.props.teamId}\n                        permissions={[Permissions.MANAGE_SLASH_COMMANDS, Permissions.MANAGE_OAUTH, Permissions.MANAGE_INCOMING_WEBHOOKS, Permissions.MANAGE_OUTGOING_WEBHOOKS]}\n                    >\n                        <Menu.ItemLink\n                            id='integrations'\n                            show={!this.props.mobile && (this.props.enableIncomingWebhooks || this.props.enableOutgoingWebhooks || this.props.enableCommands || this.props.enableOAuthServiceProvider)}\n                            to={'/' + this.props.teamName + '/integrations'}\n                            text={formatMessage({id: 'navbar_dropdown.integrations', defaultMessage: 'Integrations'})}\n                        />\n                    </TeamPermissionGate>\n                    <TeamPermissionGate\n                        teamId={this.props.teamId}\n                        permissions={[Permissions.MANAGE_SYSTEM]}\n                    >\n                        <Menu.ItemToggleModalRedux\n                            id='marketplaceModal'\n                            modalId={ModalIdentifiers.PLUGIN_MARKETPLACE}\n                            show={!this.props.mobile && this.props.enablePluginMarketplace}\n                            dialogType={MarketplaceModal}\n                            text={formatMessage({id: 'navbar_dropdown.marketplace', defaultMessage: 'Plugin Marketplace'})}\n                        />\n                    </TeamPermissionGate>\n                    <Menu.ItemLink\n                        id='customEmojis'\n                        show={!this.props.mobile && this.props.enableCustomEmoji && this.props.canCreateOrDeleteCustomEmoji}\n                        to={'/' + this.props.teamName + '/emoji'}\n                        text={formatMessage({id: 'navbar_dropdown.emoji', defaultMessage: 'Custom Emoji'})}\n                    />\n                </Menu.Group>\n                <Menu.Group>\n                    <SystemPermissionGate permissions={[Permissions.MANAGE_SYSTEM]}>\n                        <Menu.ItemLink\n                            id='systemConsole'\n                            show={!this.props.mobile}\n                            to='/admin_console'\n                            text={formatMessage({id: 'navbar_dropdown.console', defaultMessage: 'System Console'})}\n                            icon={this.props.mobile && <i className='fa fa-wrench'/>}\n                        />\n                    </SystemPermissionGate>\n                </Menu.Group>\n                <Menu.Group>\n                    <Menu.ItemExternalLink\n                        id='helpLink'\n                        show={Boolean(this.props.helpLink)}\n                        url={this.props.helpLink}\n                        text={formatMessage({id: 'navbar_dropdown.help', defaultMessage: 'Help'})}\n                        icon={this.props.mobile && <i className='fa fa-question'/>}\n                    />\n                    <Menu.ItemAction\n                        id='keyboardShortcuts'\n                        show={!this.props.mobile}\n                        onClick={this.toggleShortcutsModal}\n                        text={formatMessage({id: 'navbar_dropdown.keyboardShortcuts', defaultMessage: 'Keyboard Shortcuts'})}\n                    />\n                    <Menu.ItemExternalLink\n                        id='reportLink'\n                        show={Boolean(this.props.reportAProblemLink)}\n                        url={this.props.reportAProblemLink}\n                        text={formatMessage({id: 'navbar_dropdown.report', defaultMessage: 'Report a Problem'})}\n                        icon={this.props.mobile && <i className='fa fa-phone'/>}\n                    />\n                    <Menu.ItemExternalLink\n                        id='nativeAppLink'\n                        show={this.props.appDownloadLink && !UserAgent.isMobileApp()}\n                        url={useSafeUrl(this.props.appDownloadLink)}\n                        text={formatMessage({id: 'navbar_dropdown.nativeApps', defaultMessage: 'Download Apps'})}\n                        icon={this.props.mobile && <i className='fa fa-mobile'/>}\n                    />\n                    <Menu.ItemToggleModalRedux\n                        id='about'\n                        modalId={ModalIdentifiers.ABOUT}\n                        dialogType={AboutBuildModal}\n                        text={formatMessage({id: 'navbar_dropdown.about', defaultMessage: 'About {appTitle}'}, {appTitle: this.props.siteName || 'Mattermost'})}\n                        icon={this.props.mobile && <i className='fa fa-info'/>}\n                    />\n                </Menu.Group>\n                <Menu.Group>\n                    <Menu.ItemAction\n                        id='logout'\n                        onClick={this.handleEmitUserLoggedOutEvent}\n                        text={formatMessage({id: 'navbar_dropdown.logout', defaultMessage: 'Log Out'})}\n                        icon={this.props.mobile && <i className='fa fa-sign-out'/>}\n                    />\n                </Menu.Group>\n            </Menu>\n        );\n    }\n}\n\nexport default injectIntl(MainMenu);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getMyTeams, getJoinableTeamIds, getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\nimport {haveITeamPermission, haveISystemPermission} from 'mattermost-redux/selectors/entities/roles';\nimport {Permissions} from 'mattermost-redux/constants';\n\nimport {RHSStates} from 'utils/constants';\n\nimport {showMentions, showFlaggedPosts, closeRightHandSide, closeMenu as closeRhsMenu} from 'actions/views/rhs';\nimport {openModal} from 'actions/views/modals';\nimport {getRhsState} from 'selectors/rhs';\n\nimport MainMenu from './main_menu.jsx';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n    const currentTeam = getCurrentTeam(state);\n    const currentUser = getCurrentUser(state);\n\n    const appDownloadLink = config.AppDownloadLink;\n    const enableCommands = config.EnableCommands === 'true';\n    const enableCustomEmoji = config.EnableCustomEmoji === 'true';\n    const siteName = config.SiteName;\n    const enableIncomingWebhooks = config.EnableIncomingWebhooks === 'true';\n    const enableOAuthServiceProvider = config.EnableOAuthServiceProvider === 'true';\n    const enableOutgoingWebhooks = config.EnableOutgoingWebhooks === 'true';\n    const enableUserCreation = config.EnableUserCreation === 'true';\n    const enableEmailInvitations = config.EnableEmailInvitations === 'true';\n    const enablePluginMarketplace = config.PluginsEnabled === 'true' && config.EnableMarketplace === 'true';\n    const experimentalPrimaryTeam = config.ExperimentalPrimaryTeam;\n    const helpLink = config.HelpLink;\n    const reportAProblemLink = config.ReportAProblemLink;\n\n    let canCreateOrDeleteCustomEmoji = (haveISystemPermission(state, {permission: Permissions.CREATE_EMOJIS}) || haveISystemPermission(state, {permission: Permissions.DELETE_EMOJIS}));\n    if (!canCreateOrDeleteCustomEmoji) {\n        for (const team of getMyTeams(state)) {\n            if (haveITeamPermission(state, {team: team.id, permission: Permissions.CREATE_EMOJIS}) || haveITeamPermission(state, {team: team.id, permission: Permissions.DELETE_EMOJIS})) {\n                canCreateOrDeleteCustomEmoji = true;\n\n                break;\n            }\n        }\n    }\n\n    const joinableTeams = getJoinableTeamIds(state);\n    const moreTeamsToJoin = joinableTeams && joinableTeams.length > 0;\n    const rhsState = getRhsState(state);\n\n    return {\n        appDownloadLink,\n        enableCommands,\n        enableCustomEmoji,\n        enableIncomingWebhooks,\n        enableOAuthServiceProvider,\n        enableOutgoingWebhooks,\n        enableUserCreation,\n        enableEmailInvitations,\n        enablePluginMarketplace,\n        experimentalPrimaryTeam,\n        helpLink,\n        reportAProblemLink,\n        pluginMenuItems: state.plugins.components.MainMenu,\n        canCreateOrDeleteCustomEmoji,\n        moreTeamsToJoin,\n        siteName,\n        teamId: currentTeam.id,\n        teamName: currentTeam.name,\n        teamType: currentTeam.type,\n        currentUser,\n        isMentionSearch: rhsState === RHSStates.MENTION,\n        teamIsGroupConstrained: Boolean(currentTeam.group_constrained),\n        isLicensedForLDAPGroups: state.entities.general.license.LDAPGroups === 'true',\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            openModal,\n            showMentions,\n            showFlaggedPosts,\n            closeRightHandSide,\n            closeRhsMenu,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MainMenu);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Link} from 'react-router-dom';\nimport classNames from 'classnames';\nimport {CSSTransition} from 'react-transition-group';\n\nimport * as GlobalActions from 'actions/global_actions.jsx';\nimport {Constants} from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\nimport MenuTutorialTip from 'components/tutorial/menu_tutorial_tip';\n\nimport MainMenu from 'components/main_menu';\n\nconst ANIMATION_DURATION = 500;\n\nexport default class SidebarRightMenu extends React.PureComponent {\n    static propTypes = {\n        isOpen: PropTypes.bool.isRequired,\n        teamDisplayName: PropTypes.string,\n        showTutorialTip: PropTypes.bool.isRequired,\n        siteName: PropTypes.string,\n        actions: PropTypes.shape({\n            openRhsMenu: PropTypes.func.isRequired,\n        }),\n    };\n\n    handleEmitUserLoggedOutEvent = () => {\n        GlobalActions.emitUserLoggedOutEvent();\n    }\n\n    render() {\n        var siteName = '';\n        if (this.props.siteName != null) {\n            siteName = this.props.siteName;\n        }\n        var teamDisplayName = siteName;\n        if (this.props.teamDisplayName) {\n            teamDisplayName = this.props.teamDisplayName;\n        }\n\n        let tutorialTip = null;\n        if (this.props.showTutorialTip) {\n            tutorialTip = <MenuTutorialTip onBottom={true}/>;\n            this.props.actions.openRhsMenu();\n        }\n\n        return (\n            <div\n                className={classNames('sidebar--menu', {'move--left': this.props.isOpen && Utils.isMobile()})}\n                id='sidebar-menu'\n            >\n                <div className='team__header theme'>\n                    <Link\n                        className='team__name'\n                        to={`/channels/${Constants.DEFAULT_CHANNEL}`}\n                    >\n                        {teamDisplayName}\n                    </Link>\n                </div>\n\n                <div className='nav-pills__container mobile-main-menu'>\n                    {tutorialTip}\n                    <CSSTransition\n                        in={this.props.isOpen && Utils.isMobile()}\n                        classNames='MobileRightSidebarMenu'\n                        enter={true}\n                        exit={true}\n                        mountOnEnter={true}\n                        unmountOnExit={true}\n                        timeout={{\n                            enter: ANIMATION_DURATION,\n                            exit: ANIMATION_DURATION,\n                        }}\n                    >\n                        <MainMenu mobile={true}/>\n                    </CSSTransition>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {getInt} from 'mattermost-redux/selectors/entities/preferences';\n\nimport {openMenu as openRhsMenu} from 'actions/views/rhs';\nimport {getIsRhsMenuOpen} from 'selectors/rhs';\nimport {Preferences, TutorialSteps} from 'utils/constants';\nimport {isMobile} from 'utils/utils.jsx';\n\nimport SidebarRightMenu from './sidebar_right_menu.jsx';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n    const currentTeam = getCurrentTeam(state);\n\n    const enableTutorial = config.EnableTutorial === 'true';\n    const tutorialStep = getInt(state, Preferences.TUTORIAL_STEP, getCurrentUserId(state), TutorialSteps.FINISHED);\n\n    const siteName = config.SiteName;\n\n    return {\n        teamDisplayName: currentTeam && currentTeam.display_name,\n        isOpen: getIsRhsMenuOpen(state),\n        showTutorialTip: enableTutorial && isMobile() && tutorialStep === TutorialSteps.MENU_POPOVER,\n        siteName,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            openRhsMenu,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SidebarRightMenu);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport {setThemeDefaults} from 'mattermost-redux/utils/theme_utils';\n\nimport ModalStore from 'stores/modal_store.jsx';\nimport Constants from 'utils/constants';\n\nconst ActionTypes = Constants.ActionTypes;\n\nexport default class ImportThemeModal extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            value: '',\n            inputError: '',\n            show: false,\n            callback: null,\n        };\n    }\n\n    componentDidMount() {\n        ModalStore.addModalListener(ActionTypes.TOGGLE_IMPORT_THEME_MODAL, this.updateShow);\n    }\n\n    componentWillUnmount() {\n        ModalStore.removeModalListener(ActionTypes.TOGGLE_IMPORT_THEME_MODAL, this.updateShow);\n    }\n\n    updateShow = (show, args) => {\n        this.setState({\n            show,\n            callback: args.callback,\n        });\n    }\n\n    handleSubmit = (e) => {\n        e.preventDefault();\n\n        const text = this.state.value;\n\n        if (!this.isInputValid(text)) {\n            this.setState({\n                inputError: (\n                    <FormattedMessage\n                        id='user.settings.import_theme.submitError'\n                        defaultMessage='Invalid format, please try copying and pasting in again.'\n                    />\n                ),\n            });\n            return;\n        }\n\n        const colors = text.split(',');\n        const theme = {type: 'custom'};\n\n        theme.sidebarBg = colors[0];\n        theme.sidebarText = colors[5];\n        theme.sidebarUnreadText = colors[5];\n        theme.sidebarTextHoverBg = colors[4];\n        theme.sidebarTextActiveBorder = colors[2];\n        theme.sidebarTextActiveColor = colors[3];\n        theme.sidebarHeaderBg = colors[1];\n        theme.sidebarHeaderTextColor = colors[5];\n        theme.onlineIndicator = colors[6];\n        theme.mentionBg = colors[7];\n        setThemeDefaults(theme);\n\n        this.state.callback(theme);\n        this.setState({\n            show: false,\n            callback: null,\n        });\n    }\n\n    isInputValid(text) {\n        if (text.length === 0) {\n            return false;\n        }\n\n        if (text.indexOf(' ') !== -1) {\n            return false;\n        }\n\n        if (text.length > 0 && text.indexOf(',') === -1) {\n            return false;\n        }\n\n        if (text.length > 0) {\n            const colors = text.split(',');\n\n            if (colors.length !== 8) {\n                return false;\n            }\n\n            for (let i = 0; i < colors.length; i++) {\n                if (colors[i].length !== 7 && colors[i].length !== 4) {\n                    return false;\n                }\n\n                if (colors[i].charAt(0) !== '#') {\n                    return false;\n                }\n            }\n        }\n\n        return true;\n    }\n\n    handleChange = (e) => {\n        const value = e.target.value;\n        this.setState({value});\n\n        if (this.isInputValid(value)) {\n            this.setState({inputError: null});\n        } else {\n            this.setState({\n                inputError: (\n                    <FormattedMessage\n                        id='user.settings.import_theme.submitError'\n                        defaultMessage='Invalid format, please try copying and pasting in again.'\n                    />\n                ),\n            });\n        }\n    }\n\n    handleOnHide = () => {\n        this.setState({show: false});\n    }\n\n    render() {\n        return (\n            <span>\n                <Modal\n                    dialogClassName='a11y__modal'\n                    show={this.state.show}\n                    onHide={this.handleOnHide}\n                    role='dialog'\n                    aria-labelledby='importThemeModalLabel'\n                >\n                    <Modal.Header closeButton={true}>\n                        <Modal.Title\n                            componentClass='h1'\n                            id='importThemeModalLabel'\n                        >\n                            <FormattedMessage\n                                id='user.settings.import_theme.importHeader'\n                                defaultMessage='Import Slack Theme'\n                            />\n                        </Modal.Title>\n                    </Modal.Header>\n                    <form\n                        role='form'\n                        className='form-horizontal'\n                    >\n                        <Modal.Body>\n                            <p>\n                                <FormattedMessage\n                                    id='user.settings.import_theme.importBody'\n                                    defaultMessage='To import a theme, go to a Slack team and look for \"Preferences -> Sidebar Theme\". Open the custom theme option, copy the theme color values and paste them here:'\n                                />\n                            </p>\n                            <div className='form-group less'>\n                                <div className='col-sm-12'>\n                                    <input\n                                        id='themeVector'\n                                        type='text'\n                                        className='form-control'\n                                        value={this.state.value}\n                                        onChange={this.handleChange}\n                                    />\n                                    <div className='input__help'>\n                                        {this.state.inputError}\n                                    </div>\n                                </div>\n                            </div>\n                        </Modal.Body>\n                        <Modal.Footer>\n                            <button\n                                id='cancelButton'\n                                type='button'\n                                className='btn btn-link'\n                                onClick={this.handleOnHide}\n                            >\n                                <FormattedMessage\n                                    id='user.settings.import_theme.cancel'\n                                    defaultMessage='Cancel'\n                                />\n                            </button>\n                            <button\n                                id='submitButton'\n                                onClick={this.handleSubmit}\n                                type='submit'\n                                className='btn btn-primary'\n                            >\n                                <FormattedMessage\n                                    id='user.settings.import_theme.submit'\n                                    defaultMessage='Submit'\n                                />\n                            </button>\n                        </Modal.Footer>\n                    </form>\n                </Modal>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nexport function getIsLhsOpen(state) {\n    return state.views.lhs.isOpen;\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {ContextMenu, ContextMenuTrigger, MenuItem} from 'react-contextmenu';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class CopyUrlContextMenu extends React.Component {\n    static propTypes = {\n\n        // The child component that will be right-clicked on to show the context menu\n        children: PropTypes.element,\n\n        // The link to copy to the user's clipboard when the 'Copy' option is selected from the context menu\n        link: PropTypes.string.isRequired,\n\n        // A unique id differentiating this instance of context menu from others on the page.\n        menuId: PropTypes.string.isRequired,\n\n        siteURL: PropTypes.string.isRequired,\n\n        actions: PropTypes.shape({\n            copyToClipboard: PropTypes.func.isRequired,\n        }),\n    };\n\n    copy = () => {\n        let link = this.props.link;\n\n        // Transform relative links to absolute ones for copy and paste.\n        if (link.indexOf('http://') === -1 && link.indexOf('https://') === -1) {\n            link = this.props.siteURL + link;\n        }\n\n        this.props.actions.copyToClipboard(link);\n    }\n\n    render() {\n        const contextMenu = (\n            <ContextMenu id={'copy-url-context-menu' + this.props.menuId}>\n                <MenuItem\n                    onClick={this.copy}\n                >\n                    <FormattedMessage\n                        id='copy_url_context_menu.getChannelLink'\n                        defaultMessage='Copy Link'\n                    />\n                </MenuItem>\n            </ContextMenu>\n        );\n\n        const contextMenuTrigger = (\n            <ContextMenuTrigger\n                id={'copy-url-context-menu' + this.props.menuId}\n                holdToDisplay={-1}\n            >\n                {this.props.children}\n            </ContextMenuTrigger>\n        );\n\n        return (\n            <span>\n                {contextMenu}\n                {contextMenuTrigger}\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport {copyToClipboard} from 'utils/utils';\n\nimport CopyUrlContextMenu from './copy_url_context_menu.jsx';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n\n    return {\n        siteURL: config.SiteURL,\n    };\n}\n\nfunction mapDispatchToProps() {\n    return {\n        actions: {\n            copyToClipboard,\n        },\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CopyUrlContextMenu);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {injectIntl} from 'react-intl';\nimport {Link} from 'react-router-dom';\nimport {Draggable} from 'react-beautiful-dnd';\nimport classNames from 'classnames';\n\nimport {mark, trackEvent} from 'actions/diagnostics_actions.jsx';\nimport Constants from 'utils/constants';\nimport {intlShape} from 'utils/react_intl';\nimport {isDesktopApp} from 'utils/user_agent';\nimport {localizeMessage, isMac} from 'utils/utils.jsx';\nimport CopyUrlContextMenu from 'components/copy_url_context_menu';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport TeamIcon from '../../widgets/team_icon/team_icon';\n\n// eslint-disable-next-line react/require-optimization\nclass TeamButton extends React.Component {\n    static propTypes = {\n        btnClass: PropTypes.string,\n        url: PropTypes.string.isRequired,\n        displayName: PropTypes.string,\n        content: PropTypes.node,\n        tip: PropTypes.node.isRequired,\n        order: PropTypes.number,\n        showOrder: PropTypes.bool.isRequired,\n        active: PropTypes.bool,\n        disabled: PropTypes.bool,\n        unread: PropTypes.bool,\n        mentions: PropTypes.number,\n        placement: PropTypes.oneOf(['left', 'right', 'top', 'bottom']),\n        teamIconUrl: PropTypes.string,\n        switchTeam: PropTypes.func.isRequired,\n        intl: intlShape.isRequired,\n        isDraggable: PropTypes.bool,\n        teamIndex: PropTypes.number,\n        teamId: PropTypes.string,\n    };\n\n    static defaultProps = {\n        btnClass: '',\n        tip: '',\n        showOrder: false,\n        placement: 'right',\n        active: false,\n        disabled: false,\n        unread: false,\n        mentions: 0,\n    };\n\n    handleSwitch = (e) => {\n        e.preventDefault();\n        mark('TeamLink#click');\n        trackEvent('ui', 'ui_team_sidebar_switch_team');\n        this.props.switchTeam(this.props.url);\n    }\n\n    handleDisabled = (e) => {\n        e.preventDefault();\n    }\n\n    render() {\n        const {teamIconUrl, displayName, btnClass, mentions, unread, isDraggable = false, teamIndex, teamId} = this.props;\n        const {formatMessage} = this.props.intl;\n\n        let teamClass = this.props.active ? 'active' : '';\n        const disabled = this.props.disabled ? 'team-disabled' : '';\n        const isNotCreateTeamButton = !this.props.url.endsWith('create_team') && !this.props.url.endsWith('select_team');\n        const handleClick = (this.props.active || this.props.disabled) ? this.handleDisabled : this.handleSwitch;\n        let badge;\n\n        let ariaLabel = formatMessage({\n            id: 'team.button.ariaLabel',\n            defaultMessage: '{teamName} team',\n        },\n        {\n            teamName: displayName,\n        });\n\n        if (!teamClass) {\n            if (unread) {\n                teamClass = 'unread';\n            } else if (isNotCreateTeamButton) {\n                teamClass = '';\n            } else {\n                teamClass = 'special';\n            }\n            ariaLabel = formatMessage({\n                id: 'team.button.unread.ariaLabel',\n                defaultMessage: '{teamName} team unread',\n            },\n            {\n                teamName: displayName,\n            });\n\n            if (mentions) {\n                ariaLabel = formatMessage({\n                    id: 'team.button.mentions.ariaLabel',\n                    defaultMessage: '{teamName} team, {mentionCount} mentions',\n                },\n                {\n                    teamName: displayName,\n                    mentionCount: mentions,\n                });\n\n                badge = (\n                    <span className={'badge pull-right small'}>{mentions}</span>\n                );\n            }\n        }\n\n        ariaLabel = ariaLabel.toLowerCase();\n\n        const content = (\n            <TeamIcon\n                withHover={true}\n                name={this.props.content || displayName}\n                url={teamIconUrl}\n            />\n        );\n\n        let toolTip = this.props.tip || localizeMessage('team.button.name_undefined', 'Name undefined');\n        let orderIndicator;\n        if (typeof this.props.order !== 'undefined' && this.props.order < 10) {\n            let toolTipHelp;\n            if (isMac()) {\n                toolTipHelp = formatMessage({\n                    id: 'team.button.tooltip.mac',\n                    defaultMessage: '  {order}',\n                },\n                {\n                    order: this.props.order,\n                });\n            } else {\n                toolTipHelp = formatMessage({\n                    id: 'team.button.tooltip',\n                    defaultMessage: 'Ctrl+Alt+{order}',\n                },\n                {\n                    order: this.props.order,\n                });\n            }\n\n            toolTip = (\n                <>\n                    {toolTip}\n                    <div className='tooltip-help'>{toolTipHelp}</div>\n                </>\n            );\n\n            if (this.props.showOrder) {\n                orderIndicator = (\n                    <div className='order-indicator'>\n                        {this.props.order}\n                    </div>\n                );\n            }\n        }\n\n        const btn = (\n            <OverlayTrigger\n                delayShow={Constants.OVERLAY_TIME_DELAY}\n                placement={this.props.placement}\n                overlay={\n                    <Tooltip id={`tooltip-${this.props.url}`}>\n                        {toolTip}\n                    </Tooltip>\n                }\n            >\n                <div className={'team-btn ' + btnClass}>\n                    {badge}\n                    {content}\n                </div>\n            </OverlayTrigger>\n        );\n\n        let teamButton = (\n            <Link\n                id={`${this.props.url.slice(1)}TeamButton`}\n                aria-label={ariaLabel}\n                className={disabled}\n                to={this.props.url}\n                onClick={handleClick}\n            >\n                {btn}\n            </Link>\n        );\n\n        if (isDesktopApp()) {\n            // if this is not a \"special\" team button, give it a context menu\n            if (isNotCreateTeamButton) {\n                teamButton = (\n                    <CopyUrlContextMenu\n                        link={this.props.url}\n                        menuId={this.props.url}\n                    >\n                        {teamButton}\n                    </CopyUrlContextMenu>\n                );\n            }\n        }\n\n        return isDraggable ? (\n            <Draggable\n                draggableId={teamId}\n                index={teamIndex}\n            >\n                {(provided, snapshot) => {\n                    return (\n                        <div\n                            ref={provided.innerRef}\n                            {...provided.draggableProps}\n                            {...provided.dragHandleProps}\n                            className={classNames([`team-container ${teamClass}`, {isDragging: snapshot.isDragging}])}\n                        >\n                            {teamButton}\n                            {orderIndicator}\n                        </div>\n                    );\n                }}\n            </Draggable>\n        ) : (\n            <div className={`team-container ${teamClass}`}>\n                {teamButton}\n                {orderIndicator}\n            </div>\n        );\n    }\n}\n\nexport default injectIntl(TeamButton);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport Scrollbars from 'react-custom-scrollbars';\nimport {FormattedMessage} from 'react-intl';\nimport Permissions from 'mattermost-redux/constants/permissions';\nimport classNames from 'classnames';\nimport {DragDropContext, Droppable} from 'react-beautiful-dnd';\n\nimport {Constants} from 'utils/constants.jsx';\nimport {filterAndSortTeamsByDisplayName} from 'utils/team_utils.jsx';\nimport * as Utils from 'utils/utils.jsx';\n\nimport SystemPermissionGate from 'components/permissions_gates/system_permission_gate';\nimport Pluggable from 'plugins/pluggable';\n\nimport TeamButton from './components/team_button.jsx';\n\nexport function renderView(props) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--view'\n        />);\n}\n\nexport function renderThumbHorizontal(props) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--horizontal'\n        />);\n}\n\nexport function renderThumbVertical(props) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--vertical'\n        />);\n}\n\nexport default class LegacyTeamSidebar extends React.Component {\n    static propTypes = {\n        myTeams: PropTypes.array.isRequired,\n        currentTeamId: PropTypes.string.isRequired,\n        moreTeamsToJoin: PropTypes.bool.isRequired,\n        myTeamMembers: PropTypes.object.isRequired,\n        isOpen: PropTypes.bool.isRequired,\n        experimentalPrimaryTeam: PropTypes.string,\n        locale: PropTypes.string.isRequired,\n        actions: PropTypes.shape({\n            getTeams: PropTypes.func.isRequired,\n            switchTeam: PropTypes.func.isRequired,\n            updateTeamsOrderForUser: PropTypes.func.isRequired,\n        }).isRequired,\n        userTeamsOrderPreference: PropTypes.string,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            showOrder: false,\n        };\n    }\n\n    switchToPrevOrNextTeam = (e, currentTeamId, teams) => {\n        if (Utils.isKeyPressed(e, Constants.KeyCodes.UP) || Utils.isKeyPressed(e, Constants.KeyCodes.DOWN)) {\n            e.preventDefault();\n            const delta = Utils.isKeyPressed(e, Constants.KeyCodes.DOWN) ? 1 : -1;\n            const pos = teams.findIndex((team) => team.id === currentTeamId);\n            const newPos = pos + delta;\n\n            let team;\n            if (newPos === -1) {\n                team = teams[teams.length - 1];\n            } else if (newPos === teams.length) {\n                team = teams[0];\n            } else {\n                team = teams[newPos];\n            }\n\n            this.props.actions.switchTeam(`/${team.name}`);\n            return true;\n        }\n        return false;\n    }\n\n    switchToTeamByNumber = (e, currentTeamId, teams) => {\n        const digits = [\n            Constants.KeyCodes.ONE,\n            Constants.KeyCodes.TWO,\n            Constants.KeyCodes.THREE,\n            Constants.KeyCodes.FOUR,\n            Constants.KeyCodes.FIVE,\n            Constants.KeyCodes.SIX,\n            Constants.KeyCodes.SEVEN,\n            Constants.KeyCodes.EIGHT,\n            Constants.KeyCodes.NINE,\n            Constants.KeyCodes.ZERO,\n        ];\n\n        for (const idx in digits) {\n            if (Utils.isKeyPressed(e, digits[idx]) && idx < teams.length) {\n                e.preventDefault();\n\n                // prevents reloading the current team, while still capturing the keyboard shortcut\n                if (teams[idx].id === currentTeamId) {\n                    return false;\n                }\n                const team = teams[idx];\n                this.props.actions.switchTeam(`/${team.name}`);\n                return true;\n            }\n        }\n        return false;\n    }\n\n    handleKeyDown = (e) => {\n        if ((e.ctrlKey || e.metaKey) && e.altKey) {\n            const {currentTeamId} = this.props;\n            const teams = filterAndSortTeamsByDisplayName(this.props.myTeams, this.props.locale, this.props.userTeamsOrderPreference);\n\n            if (this.switchToPrevOrNextTeam(e, currentTeamId, teams)) {\n                return;\n            }\n\n            if (this.switchToTeamByNumber(e, currentTeamId, teams)) {\n                return;\n            }\n\n            this.setState({showOrder: true});\n        }\n    }\n\n    handleKeyUp = (e) => {\n        if (!((e.ctrlKey || e.metaKey) && e.altKey)) {\n            this.setState({showOrder: false});\n        }\n    }\n\n    componentDidMount() {\n        this.props.actions.getTeams(0, 200);\n        document.addEventListener('keydown', this.handleKeyDown);\n        document.addEventListener('keyup', this.handleKeyUp);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleKeyDown);\n        document.removeEventListener('keyup', this.handleKeyUp);\n    }\n\n    onDragEnd = (result) => {\n        const {\n            updateTeamsOrderForUser,\n        } = this.props.actions;\n\n        if (!result.destination) {\n            return;\n        }\n\n        const teams = filterAndSortTeamsByDisplayName(this.props.myTeams, this.props.locale, this.props.userTeamsOrderPreference);\n\n        const sourceIndex = result.source.index;\n        const destinationIndex = result.destination.index;\n\n        // Positioning the dropped Team button\n        const popElement = (list, idx) => {\n            return [...list.slice(0, idx), ...list.slice(idx + 1, list.length)];\n        };\n\n        const pushElement = (list, idx, itemId) => {\n            return [\n                ...list.slice(0, idx),\n                teams.find((team) => team.id === itemId),\n                ...list.slice(idx, list.length),\n            ];\n        };\n\n        const newTeamsOrder = pushElement(\n            popElement(teams, sourceIndex),\n            destinationIndex,\n            result.draggableId\n        );\n        updateTeamsOrderForUser(newTeamsOrder.map((o) => o.id));\n        this.setState({teamsOrder: newTeamsOrder});\n    }\n\n    render() {\n        const root = document.querySelector('#root');\n        if (this.props.myTeams.length <= 1) {\n            root.classList.remove('multi-teams');\n            return null;\n        }\n        root.classList.add('multi-teams');\n\n        const plugins = [];\n        const sortedTeams = filterAndSortTeamsByDisplayName(this.props.myTeams, this.props.locale, this.props.userTeamsOrderPreference);\n\n        const teams = sortedTeams.map((team, index) => {\n            const member = this.props.myTeamMembers[team.id];\n            return (\n                <TeamButton\n                    key={'switch_team_' + team.name}\n                    url={`/${team.name}`}\n                    tip={team.display_name}\n                    active={team.id === this.props.currentTeamId}\n                    displayName={team.display_name}\n                    unread={member.msg_count > 0}\n                    order={index + 1}\n                    showOrder={this.state.showOrder}\n                    mentions={member.mention_count}\n                    teamIconUrl={Utils.imageURLForTeam(team)}\n                    switchTeam={this.props.actions.switchTeam}\n                    isDraggable={true}\n                    teamId={team.id}\n                    teamIndex={index}\n                />\n            );\n        });\n\n        const joinableTeams = [];\n\n        if (this.props.moreTeamsToJoin && !this.props.experimentalPrimaryTeam) {\n            joinableTeams.push(\n                <TeamButton\n                    btnClass='team-btn__add'\n                    key='more_teams'\n                    url='/select_team'\n                    tip={\n                        <FormattedMessage\n                            id='team_sidebar.join'\n                            defaultMessage='Other teams you can join.'\n                        />\n                    }\n                    content={'+'}\n                    switchTeam={this.props.actions.switchTeam}\n                />\n            );\n        } else {\n            joinableTeams.push(\n                <SystemPermissionGate\n                    permissions={[Permissions.CREATE_TEAM]}\n                    key='more_teams'\n                >\n                    <TeamButton\n                        btnClass='team-btn__add'\n                        url='/create_team'\n                        tip={\n                            <FormattedMessage\n                                id='navbar_dropdown.create'\n                                defaultMessage='Create a Team'\n                            />\n                        }\n                        content={'+'}\n                        switchTeam={this.props.actions.switchTeam}\n                    />\n                </SystemPermissionGate>\n            );\n        }\n\n        plugins.push(\n            <div\n                key='team-sidebar-bottom-plugin'\n                className='team-sidebar-bottom-plugin is-empty'\n            >\n                <Pluggable pluggableName='BottomTeamSidebar'/>\n            </div>\n        );\n\n        return (\n            <div\n                className={classNames('team-sidebar', {'move--right': this.props.isOpen})}\n                role='navigation'\n                aria-labelledby='teamSidebarWrapper'\n            >\n                <div\n                    className='team-wrapper'\n                    id='teamSidebarWrapper'\n                >\n                    <Scrollbars\n                        autoHide={true}\n                        autoHideTimeout={500}\n                        autoHideDuration={500}\n                        renderThumbHorizontal={renderThumbHorizontal}\n                        renderThumbVertical={renderThumbVertical}\n                        renderView={renderView}\n                        onScroll={this.handleScroll}\n                    >\n                        <DragDropContext\n                            onDragEnd={this.onDragEnd}\n                        >\n                            <Droppable\n                                droppableId='my_teams'\n                                type='TEAM_BUTTON'\n                            >\n                                {(provided) => {\n                                    return (\n                                        <div\n                                            ref={provided.innerRef}\n                                            {...provided.droppableProps}\n                                        >\n                                            {teams}\n                                            {provided.placeholder}\n                                        </div>\n                                    );\n                                }}\n                            </Droppable>\n                        </DragDropContext>\n                        {joinableTeams}\n                    </Scrollbars>\n                </div>\n                {plugins}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {getTeams} from 'mattermost-redux/actions/teams';\nimport {withRouter} from 'react-router-dom';\n\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getMyTeams, getJoinableTeamIds, getTeamMemberships, getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {get} from 'mattermost-redux/selectors/entities/preferences';\n\nimport {getCurrentLocale} from 'selectors/i18n';\nimport {getIsLhsOpen} from 'selectors/lhs';\nimport {switchTeam, updateTeamsOrderForUser} from 'actions/team_actions.jsx';\nimport {Preferences} from 'utils/constants.jsx';\n\nimport LegacyTeamSidebar from './legacy_team_sidebar_controller.jsx';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n\n    const experimentalPrimaryTeam = config.ExperimentalPrimaryTeam;\n    const joinableTeams = getJoinableTeamIds(state);\n    const moreTeamsToJoin = joinableTeams && joinableTeams.length > 0;\n\n    return {\n        currentTeamId: getCurrentTeamId(state),\n        myTeams: getMyTeams(state),\n        myTeamMembers: getTeamMemberships(state),\n        isOpen: getIsLhsOpen(state),\n        experimentalPrimaryTeam,\n        locale: getCurrentLocale(state),\n        moreTeamsToJoin,\n        userTeamsOrderPreference: get(state, Preferences.TEAMS_ORDER, '', ''),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            getTeams,\n            switchTeam,\n            updateTeamsOrderForUser,\n        }, dispatch),\n    };\n}\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(LegacyTeamSidebar));\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport {FormattedMessage} from 'react-intl';\n\nimport LoadingScreen from 'components/loading_screen';\nimport LoadingWrapper from 'components/widgets/loading/loading_wrapper';\nimport QuickInput from 'components/quick_input';\nimport * as UserAgent from 'utils/user_agent';\nimport {localizeMessage} from 'utils/utils.jsx';\nimport LocalizedInput from 'components/localized_input/localized_input';\n\nimport ArchiveIcon from 'components/widgets/icons/archive_icon';\n\nimport {t} from 'utils/i18n';\n\nimport MenuWrapper from './widgets/menu/menu_wrapper';\nimport Menu from './widgets/menu/menu';\n\nconst NEXT_BUTTON_TIMEOUT_MILLISECONDS = 500;\n\nexport default class SearchableChannelList extends React.Component {\n    static getDerivedStateFromProps(props, state) {\n        return {isSearch: props.isSearch, page: props.isSearch && !state.isSearch ? 0 : state.page};\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.nextTimeoutId = 0;\n\n        this.state = {\n            joiningChannel: '',\n            page: 0,\n            nextDisabled: false,\n        };\n    }\n\n    componentDidMount() {\n        // only focus the search box on desktop so that we don't cause the keyboard to open on mobile\n        if (!UserAgent.isMobile() && this.refs.filter) {\n            this.refs.filter.focus();\n        }\n    }\n\n    handleJoin(channel) {\n        this.setState({joiningChannel: channel.id});\n        this.props.handleJoin(\n            channel,\n            () => {\n                this.setState({joiningChannel: ''});\n            }\n        );\n    }\n\n    createChannelRow = (channel) => {\n        const ariaLabel = `${channel.display_name}, ${channel.purpose}`.toLowerCase();\n        let archiveIcon;\n        const {shouldShowArchivedChannels} = this.props;\n\n        if (shouldShowArchivedChannels) {\n            archiveIcon = (\n                <div className='more-modal__icon-container'>\n                    <ArchiveIcon className='icon icon__archive'/>\n                </div>\n            );\n        }\n\n        return (\n            <div\n                className='more-modal__row'\n                key={channel.id}\n                id={`ChannelRow-${channel.name}`}\n            >\n                <div className='more-modal__details'>\n                    <button\n                        onClick={this.handleJoin.bind(this, channel)}\n                        aria-label={ariaLabel}\n                        className='style--none more-modal__name'\n                    >\n                        {archiveIcon}\n                        {channel.display_name}\n                    </button>\n                    <p className='more-modal__description'>{channel.purpose}</p>\n                </div>\n                <div className='more-modal__actions'>\n                    <button\n                        onClick={this.handleJoin.bind(this, channel)}\n                        className='btn btn-primary'\n                        disabled={this.state.joiningChannel}\n                    >\n                        <LoadingWrapper\n                            loading={this.state.joiningChannel === channel.id}\n                            text={localizeMessage('more_channels.joining', 'Joining...')}\n                        >\n                            <FormattedMessage\n                                id={shouldShowArchivedChannels ? 'more_channels.view' : 'more_channels.join'}\n                                defaultMessage={shouldShowArchivedChannels ? 'View' : 'Join'}\n                            />\n                        </LoadingWrapper>\n                    </button>\n                </div>\n            </div>\n        );\n    }\n\n    nextPage = (e) => {\n        e.preventDefault();\n        this.setState({page: this.state.page + 1, nextDisabled: true});\n        this.nextTimeoutId = setTimeout(() => this.setState({nextDisabled: false}), NEXT_BUTTON_TIMEOUT_MILLISECONDS);\n        this.props.nextPage(this.state.page + 1);\n        $(ReactDOM.findDOMNode(this.refs.channelListScroll)).scrollTop(0);\n    }\n\n    previousPage = (e) => {\n        e.preventDefault();\n        this.setState({page: this.state.page - 1});\n        $(ReactDOM.findDOMNode(this.refs.channelListScroll)).scrollTop(0);\n    }\n\n    doSearch = () => {\n        const term = this.refs.filter.value;\n        this.props.search(term);\n        if (term === '') {\n            this.setState({page: 0});\n        }\n    }\n    toggleArchivedChannelsOn = () => {\n        this.props.toggleArchivedChannels(true);\n    }\n    toggleArchivedChannelsOff = () => {\n        this.props.toggleArchivedChannels(false);\n    }\n\n    render() {\n        const channels = this.props.channels;\n        let listContent;\n        let nextButton;\n        let previousButton;\n\n        if (this.props.loading && channels.length === 0) {\n            listContent = <LoadingScreen style={{marginTop: '50%'}}/>;\n        } else if (channels.length === 0) {\n            listContent = (\n                <div className='no-channel-message'>\n                    <p className='primary-message'>\n                        <FormattedMessage\n                            id='more_channels.noMore'\n                            defaultMessage='No more channels to join'\n                        />\n                    </p>\n                    {this.props.noResultsText}\n                </div>\n            );\n        } else {\n            const pageStart = this.state.page * this.props.channelsPerPage;\n            const pageEnd = pageStart + this.props.channelsPerPage;\n            const channelsToDisplay = this.props.channels.slice(pageStart, pageEnd);\n            listContent = channelsToDisplay.map(this.createChannelRow);\n\n            if (channelsToDisplay.length >= this.props.channelsPerPage && pageEnd < this.props.channels.length) {\n                nextButton = (\n                    <button\n                        className='btn btn-link filter-control filter-control__next'\n                        onClick={this.nextPage}\n                        disabled={this.state.nextDisabled}\n                    >\n                        <FormattedMessage\n                            id='more_channels.next'\n                            defaultMessage='Next'\n                        />\n                    </button>\n                );\n            }\n\n            if (this.state.page > 0) {\n                previousButton = (\n                    <button\n                        className='btn btn-link filter-control filter-control__prev'\n                        onClick={this.previousPage}\n                    >\n                        <FormattedMessage\n                            id='more_channels.prev'\n                            defaultMessage='Previous'\n                        />\n                    </button>\n                );\n            }\n        }\n\n        let input = (\n            <div className='filter-row filter-row--full'>\n                <div className='col-sm-12'>\n                    <QuickInput\n                        id='searchChannelsTextbox'\n                        ref='filter'\n                        className='form-control filter-textbox'\n                        placeholder={{id: t('filtered_channels_list.search'), defaultMessage: 'Search channels'}}\n                        inputComponent={LocalizedInput}\n                        onInput={this.doSearch}\n                    />\n                </div>\n            </div>\n        );\n\n        if (this.props.createChannelButton) {\n            input = (\n                <div className='channel_search'>\n                    <div className='search_input'>\n                        <QuickInput\n                            id='searchChannelsTextbox'\n                            ref='filter'\n                            className='form-control filter-textbox'\n                            placeholder={{id: t('filtered_channels_list.search'), defaultMessage: 'Search channels'}}\n                            inputComponent={LocalizedInput}\n                            onInput={this.doSearch}\n                        />\n                    </div>\n                    <div className='create_button'>\n                        {this.props.createChannelButton}\n                    </div>\n                </div>\n            );\n        }\n\n        let channelDropdown;\n\n        if (this.props.canShowArchivedChannels) {\n            channelDropdown = (\n                <div className='more-modal__dropdown'>\n                    <MenuWrapper id='channelsMoreDropdown'>\n                        <a>\n                            <span>{this.props.shouldShowArchivedChannels ? localizeMessage('more_channels.show_archived_channels', 'Show: Archived Channels') : localizeMessage('more_channels.show_public_channels', 'Show: Public Channels')}</span>\n                            <span className='caret'/>\n                        </a>\n                        <Menu\n                            openLeft={false}\n                            ariaLabel={localizeMessage('team_members_dropdown.menuAriaLabel', 'Change the role of a team member')}\n                        >\n                            <Menu.ItemAction\n                                id='channelsMoreDropdownPublic'\n                                onClick={this.toggleArchivedChannelsOff}\n                                text={localizeMessage('suggestion.search.public', 'Public Channels')}\n                            />\n                            <Menu.ItemAction\n                                id='channelsMoreDropdownArchived'\n                                onClick={this.toggleArchivedChannelsOn}\n                                text={localizeMessage('suggestion.archive', 'Archived Channels')}\n                            />\n                        </Menu>\n                    </MenuWrapper>\n                </div>\n            );\n        }\n\n        return (\n            <div className='filtered-user-list'>\n                {input}\n                {channelDropdown}\n                <div\n                    role='application'\n                    ref='channelList'\n                    className='more-modal__list'\n                >\n                    <div\n                        id='moreChannelsList'\n                        ref='channelListScroll'\n                    >\n                        {listContent}\n                    </div>\n                </div>\n                <div className='filter-controls'>\n                    {previousButton}\n                    {nextButton}\n                </div>\n            </div>\n        );\n    }\n}\n\nSearchableChannelList.defaultProps = {\n    channels: [],\n    isSearch: false,\n};\n\nSearchableChannelList.propTypes = {\n    channels: PropTypes.arrayOf(PropTypes.object),\n    channelsPerPage: PropTypes.number,\n    nextPage: PropTypes.func.isRequired,\n    isSearch: PropTypes.bool,\n    search: PropTypes.func.isRequired,\n    handleJoin: PropTypes.func.isRequired,\n    noResultsText: PropTypes.object,\n    loading: PropTypes.bool,\n    createChannelButton: PropTypes.element,\n    toggleArchivedChannels: PropTypes.func.isRequired,\n    shouldShowArchivedChannels: PropTypes.bool.isRequired,\n    canShowArchivedChannels: PropTypes.bool.isRequired,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\nimport Permissions from 'mattermost-redux/constants/permissions';\n\nimport {browserHistory} from 'utils/browser_history';\n\nimport {getRelativeChannelURL} from 'utils/url';\n\nimport SearchableChannelList from 'components/searchable_channel_list.jsx';\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\n\nconst CHANNELS_CHUNK_SIZE = 50;\nconst CHANNELS_PER_PAGE = 50;\nconst SEARCH_TIMEOUT_MILLISECONDS = 100;\n\nexport default class MoreChannels extends React.Component {\n    static propTypes = {\n        channels: PropTypes.array.isRequired,\n        archivedChannels: PropTypes.array.isRequired,\n        currentUserId: PropTypes.string.isRequired,\n        teamId: PropTypes.string.isRequired,\n        teamName: PropTypes.string.isRequired,\n        onModalDismissed: PropTypes.func,\n        handleNewChannel: PropTypes.func,\n        channelsRequestStarted: PropTypes.bool,\n        bodyOnly: PropTypes.bool,\n        canShowArchivedChannels: PropTypes.bool,\n        morePublicChannelsModalType: PropTypes.string,\n        actions: PropTypes.shape({\n            getChannels: PropTypes.func.isRequired,\n            getArchivedChannels: PropTypes.func.isRequired,\n            joinChannel: PropTypes.func.isRequired,\n            searchMoreChannels: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.searchTimeoutId = 0;\n\n        this.state = {\n            show: true,\n            shouldShowArchivedChannels: this.props.morePublicChannelsModalType === 'private',\n            search: false,\n            searchedChannels: [],\n            serverError: null,\n            searching: false,\n            searchTerm: '',\n        };\n    }\n\n    componentDidMount() {\n        this.props.actions.getChannels(this.props.teamId, 0, CHANNELS_CHUNK_SIZE * 2);\n        if (this.props.canShowArchivedChannels) {\n            this.props.actions.getArchivedChannels(this.props.teamId, 0, CHANNELS_CHUNK_SIZE * 2);\n        }\n    }\n\n    handleHide = () => {\n        this.setState({show: false});\n\n        if (this.props.bodyOnly) {\n            this.handleExit();\n        }\n    }\n\n    handleExit = () => {\n        if (this.props.onModalDismissed) {\n            this.props.onModalDismissed();\n        }\n    }\n\n    onChange = (force) => {\n        if (this.state.search && !force) {\n            return;\n        }\n\n        this.setState({\n            searchedChannels: [],\n            serverError: null,\n        });\n    }\n\n    nextPage = (page) => {\n        this.props.actions.getChannels(this.props.teamId, page + 1, CHANNELS_PER_PAGE);\n    }\n\n    handleJoin = (channel, done) => {\n        const {actions, currentUserId, teamId, teamName} = this.props;\n        actions.joinChannel(currentUserId, teamId, channel.id).then((result) => {\n            if (result.error) {\n                this.setState({serverError: result.error.message});\n            } else {\n                browserHistory.push(getRelativeChannelURL(teamName, channel.name));\n                this.handleHide();\n            }\n\n            if (done) {\n                done();\n            }\n        });\n    };\n\n    search = (term) => {\n        clearTimeout(this.searchTimeoutId);\n\n        if (term === '') {\n            this.onChange(true);\n            this.setState({search: false, searchedChannels: [], searching: false, searchTerm: term});\n            this.searchTimeoutId = '';\n            return;\n        }\n        this.setState({search: true, searching: true, searchTerm: term});\n\n        const searchTimeoutId = setTimeout(\n            () => {\n                this.props.actions.searchMoreChannels(term, this.state.shouldShowArchivedChannels).\n                    then((result) => {\n                        if (searchTimeoutId !== this.searchTimeoutId) {\n                            return;\n                        }\n\n                        if (result.data) {\n                            this.setSearchResults(result.data);\n                        } else {\n                            this.setState({searchedChannels: [], searching: false});\n                        }\n                    }).\n                    catch(() => {\n                        this.setState({searchedChannels: [], searching: false});\n                    });\n            },\n            SEARCH_TIMEOUT_MILLISECONDS\n        );\n\n        this.searchTimeoutId = searchTimeoutId;\n    };\n\n    setSearchResults = (channels) => {\n        this.setState({searchedChannels: this.state.shouldShowArchivedChannels ? channels.filter((c) => c.delete_at !== 0) : channels.filter((c) => c.delete_at === 0), searching: false});\n    };\n\n    toggleArchivedChannels = (shouldShowArchivedChannels) => {\n        // search again when switching channels to update search results\n        this.search(this.state.searchTerm);\n        this.setState({shouldShowArchivedChannels});\n    };\n\n    render() {\n        const {\n            channels,\n            archivedChannels,\n            teamId,\n            channelsRequestStarted,\n            bodyOnly,\n        } = this.props;\n\n        const {\n            search,\n            searchedChannels,\n            serverError: serverErrorState,\n            show,\n            searching,\n            shouldShowArchivedChannels,\n        } = this.state;\n\n        let activeChannels;\n\n        if (shouldShowArchivedChannels) {\n            activeChannels = search ? searchedChannels : archivedChannels;\n        } else {\n            activeChannels = search ? searchedChannels : channels;\n        }\n\n        let serverError;\n        if (serverErrorState) {\n            serverError = <div className='form-group has-error'><label className='control-label'>{serverErrorState}</label></div>;\n        }\n\n        const createNewChannelButton = (\n            <TeamPermissionGate\n                teamId={teamId}\n                permissions={[Permissions.CREATE_PUBLIC_CHANNEL]}\n            >\n                <button\n                    id='createNewChannel'\n                    type='button'\n                    className='btn btn-primary channel-create-btn'\n                    onClick={this.props.handleNewChannel}\n                >\n                    <FormattedMessage\n                        id='more_channels.create'\n                        defaultMessage='Create Channel'\n                    />\n                </button>\n            </TeamPermissionGate>\n        );\n\n        const createChannelHelpText = (\n            <TeamPermissionGate\n                teamId={teamId}\n                permissions={[Permissions.CREATE_PUBLIC_CHANNEL, Permissions.CREATE_PRIVATE_CHANNEL]}\n            >\n                <p className='secondary-message'>\n                    <FormattedMessage\n                        id='more_channels.createClick'\n                        defaultMessage=\"Click 'Create New Channel' to make a new one\"\n                    />\n                </p>\n            </TeamPermissionGate>\n        );\n\n        const body = (\n            <React.Fragment>\n                <SearchableChannelList\n                    channels={activeChannels}\n                    channelsPerPage={CHANNELS_PER_PAGE}\n                    nextPage={this.nextPage}\n                    isSearch={search}\n                    search={this.search}\n                    handleJoin={this.handleJoin}\n                    noResultsText={createChannelHelpText}\n                    loading={search ? searching : channelsRequestStarted}\n                    createChannelButton={bodyOnly && createNewChannelButton}\n                    toggleArchivedChannels={this.toggleArchivedChannels}\n                    shouldShowArchivedChannels={this.state.shouldShowArchivedChannels}\n                    canShowArchivedChannels={this.props.canShowArchivedChannels}\n                />\n                {serverError}\n            </React.Fragment>\n        );\n\n        if (bodyOnly) {\n            return body;\n        }\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal more-modal more-modal--action'\n                show={show}\n                onHide={this.handleHide}\n                onExited={this.handleExit}\n                role='dialog'\n                id='moreChannelsModal'\n                aria-labelledby='moreChannelsModalLabel'\n            >\n                <Modal.Header\n                    id='moreChannelsModalHeader'\n                    closeButton={true}\n                >\n                    <Modal.Title\n                        componentClass='h1'\n                        id='moreChannelsModalLabel'\n                    >\n                        <FormattedMessage\n                            id='more_channels.title'\n                            defaultMessage='More Channels'\n                        />\n                    </Modal.Title>\n                    {createNewChannelButton}\n                </Modal.Header>\n                <Modal.Body>\n                    {body}\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {createSelector} from 'reselect';\n\nimport {getChannels, getArchivedChannels, joinChannel} from 'mattermost-redux/actions/channels';\nimport {getOtherChannels, getChannelsInCurrentTeam} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {RequestStatus} from 'mattermost-redux/constants';\n\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport {searchMoreChannels} from 'actions/channel_actions.jsx';\n\nimport MoreChannels from './more_channels.jsx';\n\nconst getNotArchivedOtherChannels = createSelector(\n    getOtherChannels,\n    (channels) => channels && channels.filter((c) => c.delete_at === 0)\n);\n\nconst getArchivedOtherChannels = createSelector(\n    getChannelsInCurrentTeam,\n    (channels) => channels && channels.filter((c) => c.delete_at !== 0)\n);\n\nfunction mapStateToProps(state) {\n    const team = getCurrentTeam(state) || {};\n\n    return {\n        channels: getNotArchivedOtherChannels(state) || [],\n        archivedChannels: getArchivedOtherChannels(state) || [],\n        currentUserId: getCurrentUserId(state),\n        teamId: team.id,\n        teamName: team.name,\n        channelsRequestStarted: state.requests.channels.getChannels.status === RequestStatus.STARTED,\n        canShowArchivedChannels: (getConfig(state).ExperimentalViewArchivedChannels === 'true'),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            getChannels,\n            getArchivedChannels,\n            joinChannel,\n            searchMoreChannels,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MoreChannels);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\nimport React from 'react';\nimport {Channel} from 'mattermost-redux/types/channels';\nimport {UserProfile} from 'mattermost-redux/types/users';\n\nimport {Value} from 'components/multiselect/multiselect';\n\nimport AddIcon from 'components/widgets/icons/fa_add_icon';\n\ntype Props = {\n    channel: (Channel & Value & {profiles: UserProfile[]});\n    isSelected: boolean;\n    onAdd: (users: UserProfile[]) => void;\n}\n\nexport default class GroupMessageOption extends React.Component<Props> {\n    static propTypes = {\n\n    };\n\n    getStyle() {\n        let className = 'mentions__name';\n        if (this.props.isSelected) {\n            className += ' suggestion--selected';\n        }\n        return className;\n    }\n\n    displayName() {\n        return this.props.channel.profiles.map((profile) => '@' + profile.username).join(', ');\n    }\n\n    addValue = () => {\n        this.props.onAdd(this.props.channel.profiles);\n    }\n\n    render() {\n        return (\n            <div\n                key={this.props.channel.id}\n                className={'more-modal__row clickable ' + this.getStyle()}\n                onClick={this.addValue}\n            >\n                <div className='more-modal__gm-icon bg-text-200'>\n                    {this.props.channel.profiles.length}\n                </div>\n                <div className='more-modal__details'>\n                    <div className='more-modal__name'>\n                        {this.displayName()}\n                    </div>\n                </div>\n                <div className='more-modal__actions'>\n                    <div className='more-modal__actions--round'>\n                        <AddIcon/>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport {Client4} from 'mattermost-redux/client';\nimport {Channel} from 'mattermost-redux/types/channels';\nimport {RelationOneToOne} from 'mattermost-redux/types/utilities';\nimport {UserProfile} from 'mattermost-redux/types/users';\n\nimport {browserHistory} from 'utils/browser_history';\nimport Constants from 'utils/constants';\nimport {displayEntireNameForUser, localizeMessage, isGuest} from 'utils/utils.jsx';\nimport MultiSelect, {Value} from 'components/multiselect/multiselect';\nimport ProfilePicture from 'components/profile_picture';\nimport AddIcon from 'components/widgets/icons/fa_add_icon';\nimport GuestBadge from 'components/widgets/badges/guest_badge';\nimport BotBadge from 'components/widgets/badges/bot_badge';\n\nimport GroupMessageOption from './group_message_option';\n\nconst USERS_PER_PAGE = 50;\nconst MAX_SELECTABLE_VALUES = Constants.MAX_USERS_IN_GM - 1;\n\ntype UserProfileValue = (UserProfile & Value);\ntype GroupChannelValue = (Channel & Value & {profiles: UserProfile[]});\n\ntype OptionType = UserProfileValue | GroupChannelValue;\n\ntype Props = {\n    currentUserId: string;\n    currentTeamId: string;\n    currentTeamName: string;\n    searchTerm: string;\n    users: UserProfile[];\n    groupChannels: Array<{profiles: UserProfile[]} & Channel>;\n    myDirectChannels: Channel[];\n    statuses: RelationOneToOne<UserProfile, string>;\n    totalCount?: number;\n\n    /*\n    * List of current channel members of existing channel\n    */\n    currentChannelMembers: UserProfile[];\n\n    /*\n    * Whether the modal is for existing channel or not\n    */\n    isExistingChannel: boolean;\n\n    /*\n    * The mode by which direct messages are restricted, if at all.\n    */\n    restrictDirectMessage?: string;\n    onModalDismissed: () => void;\n    onHide?: () => void;\n    bodyOnly?: boolean;\n    actions: {\n        getProfiles: (page?: number | undefined, perPage?: number | undefined, options?: any) => Promise<any>;\n        getProfilesInTeam: (teamId: string, page: number, perPage?: number | undefined, sort?: string | undefined, options?: any) => Promise<any>;\n        getStatusesByIds: (userIds: string[]) => void;\n        getTotalUsersStats: () => void;\n        loadStatusesForProfilesList: (users: any) => {\n            data: boolean;\n        };\n        loadProfilesForGroupChannels: (groupChannels: any) => void;\n        openDirectChannelToUserId: (userId: any) => Promise<any>;\n        openGroupChannelToUserIds: (userIds: any) => Promise<any>;\n        searchProfiles: (term: string, options?: any) => Promise<any>;\n        searchGroupChannels: (term: string) => Promise<any>;\n        setModalSearchTerm: (term: any) => Promise<{\n            data: boolean;\n        }>;\n    };\n}\n\ntype State = {\n    values: OptionType[];\n    show: boolean;\n    search: boolean;\n    saving: boolean;\n    loadingUsers: boolean;\n}\n\nexport default class MoreDirectChannels extends React.Component<Props, State> {\n    searchTimeoutId: any;\n    exitToChannel?: string;\n    multiselect: React.RefObject<MultiSelect<OptionType>>;\n\n    constructor(props: Props) {\n        super(props);\n\n        this.searchTimeoutId = 0;\n        this.multiselect = React.createRef();\n\n        const values: (OptionType | UserProfile)[] = [];\n\n        if (props.currentChannelMembers) {\n            for (let i = 0; i < props.currentChannelMembers.length; i++) {\n                const user = Object.assign({}, props.currentChannelMembers[i]);\n\n                if (user.id === props.currentUserId) {\n                    continue;\n                }\n\n                values.push(user);\n            }\n        }\n\n        this.state = {\n            values: values as OptionType[],\n            show: true,\n            search: false,\n            saving: false,\n            loadingUsers: true,\n        };\n    }\n\n    componentDidMount() {\n        this.getUserProfiles();\n        this.props.actions.getTotalUsersStats();\n        this.loadProfilesMissingStatus(this.props.users, this.props.statuses);\n    }\n\n    updateFromProps(prevProps: Props) {\n        if (prevProps.searchTerm !== this.props.searchTerm) {\n            clearTimeout(this.searchTimeoutId);\n\n            const searchTerm = this.props.searchTerm;\n            if (searchTerm === '') {\n                this.resetPaging();\n            } else {\n                const teamId = this.props.restrictDirectMessage === 'any' ? '' : this.props.currentTeamId;\n\n                this.searchTimeoutId = setTimeout(\n                    async () => {\n                        this.setUsersLoadingState(true);\n                        const [{data: profilesData}, {data: groupChannelsData}] = await Promise.all([\n                            this.props.actions.searchProfiles(searchTerm, {team_id: teamId}),\n                            this.props.actions.searchGroupChannels(searchTerm),\n                        ]);\n                        if (profilesData) {\n                            this.props.actions.loadStatusesForProfilesList(profilesData);\n                        }\n                        if (groupChannelsData) {\n                            this.props.actions.loadProfilesForGroupChannels(groupChannelsData);\n                        }\n                        this.resetPaging();\n                        this.setUsersLoadingState(false);\n                    },\n                    Constants.SEARCH_TIMEOUT_MILLISECONDS\n                );\n            }\n        }\n\n        if (\n            prevProps.users.length !== this.props.users.length ||\n            Object.keys(prevProps.statuses).length !== Object.keys(this.props.statuses).length\n        ) {\n            this.loadProfilesMissingStatus(this.props.users, this.props.statuses);\n        }\n    }\n\n    componentDidUpdate(prevProps: Props) {\n        this.updateFromProps(prevProps);\n    }\n\n    public loadProfilesMissingStatus = (users: UserProfile[] = [], statuses: RelationOneToOne<UserProfile, string> = {}) => {\n        const missingStatusByIds = users.\n            filter((user) => !statuses[user.id]).\n            map((user) => user.id);\n\n        if (missingStatusByIds.length > 0) {\n            this.props.actions.getStatusesByIds(missingStatusByIds);\n        }\n    }\n\n    handleHide = () => {\n        this.props.actions.setModalSearchTerm('');\n        this.setState({show: false});\n\n        if (this.props.bodyOnly) {\n            this.handleExit();\n        }\n    }\n\n    setUsersLoadingState = (loadingState: boolean) => {\n        this.setState({\n            loadingUsers: loadingState,\n        });\n    }\n\n    handleExit = () => {\n        if (this.exitToChannel) {\n            browserHistory.push(this.exitToChannel);\n        }\n\n        if (this.props.onModalDismissed) {\n            this.props.onModalDismissed();\n        }\n\n        if (this.props.onHide) {\n            this.props.onHide();\n        }\n    }\n\n    handleSubmit = (values = this.state.values) => {\n        const {actions} = this.props;\n        if (this.state.saving) {\n            return;\n        }\n\n        const userIds = values.map((v) => v.id);\n        if (userIds.length === 0) {\n            return;\n        }\n\n        this.setState({saving: true});\n\n        const done = (result: any) => {\n            const {data, error} = result;\n            this.setState({saving: false});\n\n            if (!error) {\n                this.exitToChannel = '/' + this.props.currentTeamName + '/channels/' + data.name;\n                this.handleHide();\n            }\n        };\n\n        if (userIds.length === 1) {\n            actions.openDirectChannelToUserId(userIds[0]).then(done);\n        } else {\n            actions.openGroupChannelToUserIds(userIds).then(done);\n        }\n    };\n\n    addValue = (value: OptionType) => {\n        if (Array.isArray(value)) {\n            this.addUsers(value);\n        } else if ('profiles' in value) {\n            this.addUsers(value.profiles);\n        } else {\n            const values = Object.assign([], this.state.values);\n\n            if (values.indexOf(value) === -1) {\n                values.push(value);\n            }\n\n            this.setState({values});\n        }\n    };\n\n    addUsers = (users: UserProfile[]) => {\n        const values: OptionType[] = Object.assign([], this.state.values);\n        const existingUserIds = values.map((user) => user.id);\n        for (const user of users) {\n            if (existingUserIds.indexOf(user.id) !== -1) {\n                continue;\n            }\n            values.push(user as OptionType);\n        }\n\n        this.setState({values});\n    };\n\n    getUserProfiles = (page?: number) => {\n        const pageNum = page ? page + 1 : 0;\n        if (this.props.restrictDirectMessage === 'any') {\n            this.props.actions.getProfiles(pageNum, USERS_PER_PAGE * 2).then(() => {\n                this.setUsersLoadingState(false);\n            });\n        } else {\n            this.props.actions.getProfilesInTeam(this.props.currentTeamId, pageNum, USERS_PER_PAGE * 2).then(() => {\n                this.setUsersLoadingState(false);\n            });\n        }\n    }\n\n    handlePageChange = (page: number, prevPage: number) => {\n        if (page > prevPage) {\n            this.setUsersLoadingState(true);\n            this.getUserProfiles(page);\n        }\n    }\n\n    resetPaging = () => {\n        if (this.multiselect.current) {\n            this.multiselect.current.resetPaging();\n        }\n    }\n\n    search = (term: string) => {\n        this.props.actions.setModalSearchTerm(term);\n    }\n\n    handleDelete = (values: OptionType[]) => {\n        this.setState({values});\n    }\n\n    renderAriaLabel = (option: OptionType) => {\n        if (!option) {\n            return '';\n        }\n        return (option as UserProfile).username;\n    }\n\n    renderOption = (option: OptionType, isSelected: boolean, onAdd: (value: OptionType) => void, onMouseMove: (value: OptionType) => void) => {\n        // Special case typing for Group Channels\n        if ((option as GroupChannelValue).type && (option as GroupChannelValue).type === 'G') {\n            return (\n                <GroupMessageOption\n                    key={option.id}\n                    channel={(option as GroupChannelValue)}\n                    isSelected={isSelected}\n                    onAdd={(value: UserProfile[]) => onAdd(value as any)}\n                />\n            );\n        }\n\n        const displayName = displayEntireNameForUser(option);\n\n        let modalName: string | React.ReactElement = displayName;\n        if (option.id === this.props.currentUserId) {\n            modalName = (\n                <FormattedMessage\n                    id='more_direct_channels.directchannel.you'\n                    defaultMessage='{displayname} (you)'\n                    values={{\n                        displayname: displayName,\n                    }}\n                />\n            );\n        } else if (option.delete_at) {\n            modalName = (\n                <FormattedMessage\n                    id='more_direct_channels.directchannel.deactivated'\n                    defaultMessage='{displayname} - Deactivated'\n                    values={{\n                        displayname: displayName,\n                    }}\n                />\n            );\n        }\n\n        let rowSelected = '';\n        if (isSelected) {\n            rowSelected = 'more-modal__row--selected';\n        }\n\n        const status = option.delete_at || (option as UserProfileValue).is_bot ? null : this.props.statuses[option.id];\n        const email = (option as UserProfileValue).is_bot ? null : (option as UserProfileValue).email;\n\n        return (\n            <div\n                key={option.id}\n                ref={isSelected ? 'selected' : option.id}\n                className={'more-modal__row clickable ' + rowSelected}\n                onClick={() => onAdd(option)}\n                onMouseMove={() => onMouseMove(option)}\n            >\n                <ProfilePicture\n                    src={Client4.getProfilePictureUrl(option.id, (option as UserProfileValue).last_picture_update)}\n                    status={status as string | undefined}\n                    size='md'\n                />\n                <div\n                    className='more-modal__details'\n                >\n                    <div className='more-modal__name'>\n                        {modalName}\n                        <BotBadge\n                            show={Boolean((option as UserProfileValue).is_bot)}\n                            className='badge-popoverlist'\n                        />\n                        <GuestBadge\n                            show={isGuest(option)}\n                            className='badge-popoverlist'\n                        />\n                    </div>\n                    <div className='more-modal__description'>\n                        {email}\n                    </div>\n                </div>\n                <div className='more-modal__actions'>\n                    <div className='more-modal__actions--round'>\n                        <AddIcon/>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    renderValue(props: {data: OptionType}) {\n        return (props.data as UserProfileValue).username;\n    }\n\n    handleSubmitImmediatelyOn = (value: OptionType) => {\n        return value.id === this.props.currentUserId || Boolean(value.delete_at);\n    }\n\n    render() {\n        let note;\n        if (this.props.currentChannelMembers) {\n            if (this.state.values && this.state.values.length >= MAX_SELECTABLE_VALUES) {\n                note = (\n                    <FormattedMessage\n                        id='more_direct_channels.new_convo_note.full'\n                        defaultMessage={'You\\'ve reached the maximum number of people for this conversation. Consider creating a private channel instead.'}\n                    />\n                );\n            } else if (this.props.isExistingChannel) {\n                note = (\n                    <FormattedMessage\n                        id='more_direct_channels.new_convo_note'\n                        defaultMessage={'This will start a new conversation. If you\\'re adding a lot of people, consider creating a private channel instead.'}\n                    />\n                );\n            }\n        }\n\n        const buttonSubmitText = localizeMessage('multiselect.go', 'Go');\n        const buttonSubmitLoadingText = localizeMessage('multiselect.loading', 'Loading..');\n\n        const numRemainingText = (\n            <FormattedMessage\n                id='multiselect.numPeopleRemaining'\n                defaultMessage='Use  to browse,  to select. You can add {num, number} more {num, plural, one {person} other {people}}. '\n                values={{\n                    num: MAX_SELECTABLE_VALUES - this.state.values.length,\n                }}\n            />\n        );\n\n        let users = this.props.users || [];\n\n        if (this.state.values.length) {\n            users = users.filter((user) => user.delete_at === 0 && user.id !== this.props.currentUserId);\n        } else {\n            const active: UserProfile[] = [];\n            const inactive: UserProfile[] = [];\n            for (const user of users) {\n                (user.delete_at ? inactive : active).push(user);\n            }\n            users = active.concat(inactive);\n        }\n\n        users = users.filter((user) => {\n            if (user.delete_at === 0) {\n                return true;\n            }\n            for (const channel of this.props.myDirectChannels) {\n                if (channel.name.indexOf(user.id) >= 0) {\n                    return true;\n                }\n            }\n            return false;\n        });\n\n        const usersValues = users.map((user) => {\n            return {label: user.username, value: user.id, ...user};\n        });\n\n        const groupChannels = this.props.groupChannels || [];\n        const groupChannelsValues = groupChannels.map((group) => {\n            return {label: group.display_name, value: group.id, ...group};\n        });\n\n        const options: OptionType[] = [...usersValues, ...groupChannelsValues];\n        const body = (\n            <MultiSelect<OptionType>\n                key='moreDirectChannelsList'\n                ref={this.multiselect}\n                options={options}\n                optionRenderer={this.renderOption}\n                values={this.state.values}\n                valueRenderer={this.renderValue}\n                ariaLabelRenderer={this.renderAriaLabel}\n                perPage={USERS_PER_PAGE}\n                handlePageChange={this.handlePageChange}\n                handleInput={this.search}\n                handleDelete={this.handleDelete}\n                handleAdd={this.addValue}\n                handleSubmit={this.handleSubmit}\n                noteText={note}\n                maxValues={MAX_SELECTABLE_VALUES}\n                numRemainingText={numRemainingText}\n                buttonSubmitText={buttonSubmitText}\n                buttonSubmitLoadingText={buttonSubmitLoadingText}\n                submitImmediatelyOn={this.handleSubmitImmediatelyOn}\n                saving={this.state.saving}\n                loading={this.state.loadingUsers}\n                users={this.props.users}\n                totalCount={this.props.totalCount}\n                placeholderText={localizeMessage('multiselect.placeholder', 'Search and add members')}\n            />\n        );\n\n        if (this.props.bodyOnly) {\n            return body;\n        }\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal more-modal more-direct-channels'\n                show={this.state.show}\n                onHide={this.handleHide}\n                onExited={this.handleExit}\n                role='dialog'\n                aria-labelledby='moreDmModalLabel'\n                id='moreDmModal'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='moreDmModalLabel'\n                    >\n                        <FormattedMessage\n                            id='more_direct_channels.title'\n                            defaultMessage='Direct Messages'\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body\n                    role='application'\n                >\n                    {body}\n                </Modal.Body>\n                <Modal.Footer className='modal-footer--invisible'>\n                    <button\n                        id='closeModalButton'\n                        type='button'\n                        className='btn btn-link'\n                    >\n                        <FormattedMessage\n                            id='general_button.close'\n                            defaultMessage='Close'\n                        />\n                    </button>\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, ActionCreatorsMapObject, Dispatch} from 'redux';\nimport {\n    getProfiles,\n    getProfilesInTeam,\n    getStatusesByIds,\n    getTotalUsersStats,\n    searchProfiles,\n} from 'mattermost-redux/actions/users';\nimport {searchGroupChannels} from 'mattermost-redux/actions/channels';\nimport {\n    getCurrentUserId,\n    getProfiles as selectProfiles,\n    getProfilesInCurrentChannel,\n    getProfilesInCurrentTeam, searchProfiles as searchProfilesSelector,\n    searchProfilesInCurrentTeam,\n    getTotalUsersStats as getTotalUsersStatsSelector,\n} from 'mattermost-redux/selectors/entities/users';\nimport {getChannelsWithUserProfiles, getAllChannels} from 'mattermost-redux/selectors/entities/channels';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {ActionFunc} from 'mattermost-redux/types/actions';\nimport {Channel} from 'mattermost-redux/types/channels';\nimport {UserProfile} from 'mattermost-redux/types/users';\nimport {sortByUsername, filterProfilesMatchingTerm} from 'mattermost-redux/utils/user_utils';\nimport {memoizeResult} from 'mattermost-redux/utils/helpers';\n\nimport {openDirectChannelToUserId, openGroupChannelToUserIds} from 'actions/channel_actions';\nimport {loadStatusesForProfilesList} from 'actions/status_actions.jsx';\nimport {loadProfilesForGroupChannels} from 'actions/user_actions.jsx';\nimport {setModalSearchTerm} from 'actions/views/search';\n\nimport {GlobalState} from 'types/store';\n\nimport MoreDirectChannels from './more_direct_channels';\n\ntype OwnProps = {\n    isExistingChannel: boolean;\n}\n\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\n    const currentUserId = getCurrentUserId(state);\n    let currentChannelMembers: UserProfile[] = [];\n    if (ownProps.isExistingChannel) {\n        currentChannelMembers = getProfilesInCurrentChannel(state);\n    }\n\n    const config = getConfig(state);\n    const restrictDirectMessage = config.RestrictDirectMessage;\n\n    const searchTerm = state.views.search.modalSearch;\n\n    let users;\n    if (searchTerm) {\n        if (restrictDirectMessage === 'any') {\n            users = searchProfilesSelector(state, searchTerm, false);\n        } else {\n            users = searchProfilesInCurrentTeam(state, searchTerm, false);\n        }\n    } else if (restrictDirectMessage === 'any') {\n        users = selectProfiles(state, {});\n    } else {\n        users = getProfilesInCurrentTeam(state);\n    }\n\n    const filteredGroupChannels = filterGroupChannels(getChannelsWithUserProfiles(state), searchTerm);\n    const myDirectChannels = filterDirectChannels(getAllChannels(state), currentUserId);\n\n    const team = getCurrentTeam(state);\n    const stats = getTotalUsersStatsSelector(state) || {total_users_count: 0};\n\n    return {\n        currentTeamId: team.id,\n        currentTeamName: team.name,\n        searchTerm,\n        users: users.sort(sortByUsername),\n        myDirectChannels,\n        groupChannels: filteredGroupChannels,\n        statuses: state.entities.users.statuses,\n        currentChannelMembers,\n        currentUserId,\n        restrictDirectMessage,\n        totalCount: stats.total_users_count,\n    };\n}\n\nconst filterGroupChannels = memoizeResult((channels: Array<{profiles: Array<UserProfile>} & Channel>, term: string) => {\n    return channels.filter((channel) => {\n        const matches = filterProfilesMatchingTerm(channel.profiles, term);\n        return matches.length > 0;\n    });\n});\n\nconst filterDirectChannels = memoizeResult((channels: Channel[], userId: string) => {\n    return Object.values(channels).filter((channel) => {\n        if (channel.type !== 'D') {\n            return false;\n        }\n        if (channel.name && channel.name.indexOf(userId) < 0) {\n            return false;\n        }\n        return true;\n    });\n});\n\ntype Actions = {\n    getProfiles: (page?: number | undefined, perPage?: number | undefined, options?: any) => Promise<any>;\n    getProfilesInTeam: (teamId: string, page: number, perPage?: number | undefined, sort?: string | undefined, options?: any) => Promise<any>;\n    getStatusesByIds: (userIds: string[]) => ActionFunc;\n    getTotalUsersStats: () => ActionFunc;\n    loadStatusesForProfilesList: (users: any) => {\n        data: boolean;\n    };\n    loadProfilesForGroupChannels: (groupChannels: any) => Promise<any>;\n    openDirectChannelToUserId: (userId: any) => Promise<any>;\n    openGroupChannelToUserIds: (userIds: any) => Promise<any>;\n    searchProfiles: (term: string, options?: any) => Promise<any>;\n    searchGroupChannels: (term: string) => Promise<any>;\n    setModalSearchTerm: (term: any) => Promise<{\n        data: boolean;\n    }>;\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch) {\n    return {\n        actions: bindActionCreators<ActionCreatorsMapObject<ActionFunc>, Actions>({\n            getProfiles,\n            getProfilesInTeam,\n            getStatusesByIds,\n            getTotalUsersStats,\n            loadStatusesForProfilesList,\n            loadProfilesForGroupChannels,\n            openDirectChannelToUserId,\n            openGroupChannelToUserIds,\n            searchProfiles,\n            searchGroupChannels,\n            setModalSearchTerm,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MoreDirectChannels);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class DraftIcon extends React.PureComponent {\n    render() {\n        return (\n            <span\n                {...this.props}\n                id='draftIcon'\n            >\n                <FormattedMessage\n                    id='generic_icons.channel.draft'\n                    defaultMessage='Channel Draft Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='14px'\n                            height='14px'\n                            viewBox='0 0 50 51'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g\n                                stroke='none'\n                                strokeWidth='1'\n                                fillRule='evenodd'\n                            >\n                                <path d='M11.980198,46.7136356 L14.9834983,43.7103353 L7.22772277,35.9545597 L4.22442244,38.95786 L4.22442244,42.4892132 L8.44884488,42.4892132 L8.44884488,46.7136356 L11.980198,46.7136356 Z M29.2409241,16.0865729 C29.2409241,15.6025221 28.9989023,15.3605003 28.5148515,15.3605003 C28.2948284,15.3605003 28.1078116,15.4375072 27.9537954,15.5915234 L10.0660066,33.4793122 C9.91199043,33.6333283 9.8349835,33.8203452 9.8349835,34.0403683 C9.8349835,34.5244191 10.0770053,34.7664409 10.5610561,34.7664409 C10.7810792,34.7664409 10.968096,34.6894339 11.1221122,34.5354178 L29.009901,16.647629 C29.1639172,16.4936128 29.2409241,16.306596 29.2409241,16.0865729 Z M27.4587459,9.74993922 L41.1881188,23.4793122 L13.7293729,50.938058 L0,50.938058 L0,37.2086851 L27.4587459,9.74993922 Z M50,12.9182561 C50,14.0843785 49.5929634,15.0744676 48.7788779,15.8885531 L43.30033,21.3671009 L29.5709571,7.637728 L35.049505,2.19218345 C35.8415881,1.35609566 36.8316772,0.938058036 38.019802,0.938058036 C39.1859244,0.938058036 40.1870145,1.35609566 41.0231023,2.19218345 L48.7788779,9.91495573 C49.5929634,10.7730458 50,11.7741359 50,12.9182561 Z'/>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {connect} from 'react-redux';\nimport {UserTypes} from 'mattermost-redux/action_types';\nimport {Client4} from 'mattermost-redux/client';\nimport {Preferences} from 'mattermost-redux/constants';\nimport {\n    getChannelsInCurrentTeam,\n    getDirectAndGroupChannels,\n    getSortedUnreadChannelIds,\n    makeGetChannel,\n    getMyChannelMemberships,\n} from 'mattermost-redux/selectors/entities/channels';\nimport {getBool, getMyPreferences} from 'mattermost-redux/selectors/entities/preferences';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getLastPostPerChannel} from 'mattermost-redux/selectors/entities/posts';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {\n    getCurrentUserId,\n    getUserIdsInChannels,\n    getUser,\n    searchProfiles,\n} from 'mattermost-redux/selectors/entities/users';\nimport * as ChannelActions from 'mattermost-redux/actions/channels';\nimport {logError} from 'mattermost-redux/actions/errors';\n\nimport {\n    sortChannelsByTypeAndDisplayName,\n    isDirectChannelVisible,\n    isGroupChannelVisible,\n    isUnreadChannel,\n} from 'mattermost-redux/utils/channel_utils';\n\nimport BotBadge from 'components/widgets/badges/bot_badge';\nimport GuestBadge from 'components/widgets/badges/guest_badge';\nimport Avatar from 'components/widgets/users/avatar';\n\nimport DraftIcon from 'components/widgets/icons/draft_icon';\nimport GlobeIcon from 'components/widgets/icons/globe_icon';\nimport LockIcon from 'components/widgets/icons/lock_icon';\nimport ArchiveIcon from 'components/widgets/icons/archive_icon';\nimport {getPostDraft} from 'selectors/rhs';\nimport store from 'stores/redux_store.jsx';\nimport {Constants, StoragePrefixes} from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\n\nimport Provider from './provider.jsx';\nimport Suggestion from './suggestion.jsx';\n\nconst getState = store.getState;\n\nclass SwitchChannelSuggestion extends Suggestion {\n    static get propTypes() {\n        return {\n            ...super.propTypes,\n            channelMember: PropTypes.object,\n            hasDraft: PropTypes.bool,\n            userImageUrl: PropTypes.string,\n            dmChannelTeammate: PropTypes.object,\n        };\n    }\n\n    render() {\n        const {item, isSelection, userImageUrl} = this.props;\n        const channel = item.channel;\n        const channelIsArchived = channel.delete_at && channel.delete_at !== 0;\n\n        const member = this.props.channelMember;\n        let badge = null;\n        if (member) {\n            if (member.notify_props && member.mention_count > 0) {\n                badge = <span className='badge'>{member.mention_count}</span>;\n            }\n        }\n\n        let className = 'mentions__name';\n        if (isSelection) {\n            className += ' suggestion--selected';\n        }\n\n        const displayName = channel.display_name;\n        let icon = null;\n        if (channelIsArchived) {\n            icon = (\n                <ArchiveIcon className='icon icon__archive'/>\n            );\n        } else if (this.props.hasDraft) {\n            icon = (\n                <DraftIcon className='icon icon__draft icon--body'/>\n            );\n        } else if (channel.type === Constants.OPEN_CHANNEL) {\n            icon = (\n                <GlobeIcon className='icon icon__globe icon--body'/>\n            );\n        } else if (channel.type === Constants.PRIVATE_CHANNEL) {\n            icon = (\n                <LockIcon className='icon icon__lock icon--body'/>\n            );\n        } else if (channel.type === Constants.GM_CHANNEL) {\n            icon = <div className='status status--group'>{'G'}</div>;\n        } else {\n            icon = (\n                <div className='pull-left'>\n                    <Avatar\n                        size='xs'\n                        url={userImageUrl}\n                    />\n                </div>\n            );\n        }\n\n        let tag = null;\n        if (channel.type === Constants.DM_CHANNEL) {\n            const teammate = this.props.dmChannelTeammate;\n            tag = (\n                <React.Fragment>\n                    <BotBadge\n                        show={Boolean(teammate && teammate.is_bot)}\n                        className='badge-autocomplete'\n                    />\n                    <GuestBadge\n                        show={Boolean(teammate && Utils.isGuest(teammate))}\n                        className='badge-autocomplete'\n                    />\n                </React.Fragment>\n            );\n        }\n\n        return (\n            <div\n                onClick={this.handleClick}\n                onMouseMove={this.handleMouseMove}\n                className={className}\n                ref={(node) => {\n                    this.node = node;\n                }}\n                id={`switchChannel_${channel.name}`}\n                data-testid={channel.name}\n                {...Suggestion.baseProps}\n            >\n                {icon}\n                <span>{displayName}</span>\n                {tag}\n                {badge}\n            </div>\n        );\n    }\n}\n\nfunction mapStateToPropsForSwitchChannelSuggestion(state, ownProps) {\n    const channel = ownProps.item && ownProps.item.channel;\n    const channelId = channel ? channel.id : '';\n    const draft = channelId ? getPostDraft(state, StoragePrefixes.DRAFT, channelId) : false;\n    const user = channel && getUser(state, channel.userId);\n    const userImageUrl = user && Utils.imageURLForUser(user.id, user.last_picture_update);\n    let dmChannelTeammate = channel && channel.type === Constants.DM_CHANNEL && Utils.getDirectTeammate(state, channel.id);\n    if (channel && Utils.isEmptyObject(dmChannelTeammate)) {\n        dmChannelTeammate = getUser(state, channel.userId);\n    }\n\n    return {\n        channelMember: getMyChannelMemberships(state)[channelId],\n        hasDraft: draft && Boolean(draft.message.trim() || draft.fileInfos.length || draft.uploadsInProgress.length),\n        userImageUrl,\n        dmChannelTeammate,\n    };\n}\n\nconst ConnectedSwitchChannelSuggestion = connect(mapStateToPropsForSwitchChannelSuggestion)(SwitchChannelSuggestion);\n\nlet prefix = '';\n\nfunction quickSwitchSorter(wrappedA, wrappedB) {\n    const aIsArchived = wrappedA.channel.delete_at ? wrappedA.channel.delete_at !== 0 : false;\n    const bIsArchived = wrappedB.channel.delete_at ? wrappedB.channel.delete_at !== 0 : false;\n    if (aIsArchived && !bIsArchived) {\n        return 1;\n    } else if (!aIsArchived && bIsArchived) {\n        return -1;\n    } else if (wrappedA.type === Constants.MENTION_CHANNELS && wrappedB.type === Constants.MENTION_MORE_CHANNELS) {\n        return -1;\n    } else if (wrappedB.type === Constants.MENTION_CHANNELS && wrappedA.type === Constants.MENTION_MORE_CHANNELS) {\n        return 1;\n    }\n\n    if (wrappedA.deactivated && !wrappedB.deactivated) {\n        return 1;\n    } else if (wrappedB.deactivated && !wrappedA.deactivated) {\n        return -1;\n    }\n\n    const a = wrappedA.channel;\n    const b = wrappedB.channel;\n\n    let aDisplayName = a.display_name.toLowerCase();\n    let bDisplayName = b.display_name.toLowerCase();\n\n    if (a.type === Constants.DM_CHANNEL) {\n        aDisplayName = aDisplayName.substring(1);\n    }\n\n    if (b.type === Constants.DM_CHANNEL) {\n        bDisplayName = bDisplayName.substring(1);\n    }\n\n    const aStartsWith = aDisplayName.startsWith(prefix);\n    const bStartsWith = bDisplayName.startsWith(prefix);\n    if ((aStartsWith && bStartsWith) || (!aStartsWith && !bStartsWith)) {\n        //\n        // MM-12677 When this is migrated this needs to be fixed to pull the user's locale\n        //\n        return sortChannelsByTypeAndDisplayName('en', a, b);\n    } else if (aStartsWith) {\n        return -1;\n    }\n\n    return 1;\n}\n\nfunction makeChannelSearchFilter(channelPrefix) {\n    const channelPrefixLower = channelPrefix.toLowerCase();\n    const curState = getState();\n    const usersInChannels = getUserIdsInChannels(curState);\n    const userSearchStrings = {};\n\n    return (channel) => {\n        let searchString = channel.display_name;\n\n        if (channel.type === Constants.GM_CHANNEL || channel.type === Constants.DM_CHANNEL) {\n            const usersInChannel = usersInChannels[channel.id] || new Set([]);\n\n            // In case the channel is a DM and the profilesInChannel is not populated\n            if (!usersInChannel.size && channel.type === Constants.DM_CHANNEL) {\n                const userId = Utils.getUserIdFromChannelId(channel.name);\n                const user = getUser(curState, userId);\n                if (user) {\n                    usersInChannel.add(userId);\n                }\n            }\n\n            for (const userId of usersInChannel) {\n                let userString = userSearchStrings[userId];\n\n                if (!userString) {\n                    const user = getUser(curState, userId);\n                    if (!user) {\n                        continue;\n                    }\n                    const {nickname, username} = user;\n                    userString = `${nickname}${username}${Utils.getFullName(user)}`;\n                    userSearchStrings[userId] = userString;\n                }\n                searchString += userString;\n            }\n        }\n\n        return searchString.toLowerCase().includes(channelPrefixLower);\n    };\n}\n\nexport default class SwitchChannelProvider extends Provider {\n    handlePretextChanged(channelPrefix, resultsCallback) {\n        if (channelPrefix) {\n            prefix = channelPrefix;\n            this.startNewRequest(channelPrefix);\n\n            // Dispatch suggestions for local data\n            const channels = getChannelsInCurrentTeam(getState()).concat(getDirectAndGroupChannels(getState()));\n            const users = Object.assign([], searchProfiles(getState(), channelPrefix, false));\n            this.formatChannelsAndDispatch(channelPrefix, resultsCallback, channels, users, true);\n\n            // Fetch data from the server and dispatch\n            this.fetchUsersAndChannels(channelPrefix, resultsCallback);\n        } else {\n            this.formatUnreadChannelsAndDispatch(resultsCallback);\n        }\n\n        return true;\n    }\n\n    async fetchUsersAndChannels(channelPrefix, resultsCallback) {\n        const state = getState();\n        const teamId = getCurrentTeamId(state);\n        if (!teamId) {\n            return;\n        }\n\n        const config = getConfig(state);\n        let usersAsync;\n        if (config.RestrictDirectMessage === 'team') {\n            usersAsync = Client4.autocompleteUsers(channelPrefix, teamId, '');\n        } else {\n            usersAsync = Client4.autocompleteUsers(channelPrefix, '', '');\n        }\n\n        const channelsAsync = ChannelActions.searchChannels(teamId, channelPrefix)(store.dispatch, store.getState);\n\n        let usersFromServer = [];\n        let channelsFromServer = [];\n        try {\n            usersFromServer = await usersAsync;\n            const {data} = await channelsAsync;\n            channelsFromServer = data;\n        } catch (err) {\n            store.dispatch(logError(err));\n        }\n\n        if (this.shouldCancelDispatch(channelPrefix)) {\n            return;\n        }\n\n        const users = Object.assign([], searchProfiles(state, channelPrefix, false)).concat(usersFromServer.users);\n        const currentUserId = getCurrentUserId(state);\n        store.dispatch({\n            type: UserTypes.RECEIVED_PROFILES_LIST,\n            data: users.filter((user) => user.id !== currentUserId),\n        });\n\n        const channels = getChannelsInCurrentTeam(state).concat(getDirectAndGroupChannels(state)).concat(channelsFromServer);\n        this.formatChannelsAndDispatch(channelPrefix, resultsCallback, channels, users);\n    }\n\n    userWrappedChannel(user, channel) {\n        let displayName = `@${user.username}`;\n\n        if ((user.first_name || user.last_name) && user.nickname) {\n            displayName += ` - ${Utils.getFullName(user)} (${user.nickname})`;\n        } else if (user.nickname) {\n            displayName += ` - (${user.nickname})`;\n        } else if (user.first_name || user.last_name) {\n            displayName += ` - ${Utils.getFullName(user)}`;\n        }\n\n        if (user.delete_at) {\n            displayName += ' - ' + Utils.localizeMessage('channel_switch_modal.deactivated', 'Deactivated');\n        }\n\n        return {\n            channel: {\n                display_name: displayName,\n                name: user.username,\n                id: channel ? channel.id : user.id,\n                userId: user.id,\n                update_at: user.update_at,\n                type: Constants.DM_CHANNEL,\n                last_picture_update: user.last_picture_update || 0,\n            },\n            name: user.username,\n            deactivated: user.delete_at,\n        };\n    }\n\n    formatChannelsAndDispatch(channelPrefix, resultsCallback, allChannels, users, skipNotInChannel = false) {\n        const channels = [];\n\n        const members = getMyChannelMemberships(getState());\n\n        if (this.shouldCancelDispatch(channelPrefix)) {\n            return;\n        }\n\n        const completedChannels = {};\n\n        const channelFilter = makeChannelSearchFilter(channelPrefix);\n\n        const state = getState();\n        const config = getConfig(state);\n        const viewArchivedChannels = config.ExperimentalViewArchivedChannels === 'true';\n\n        for (const id of Object.keys(allChannels)) {\n            const channel = allChannels[id];\n\n            if (completedChannels[channel.id]) {\n                continue;\n            }\n\n            if (channelFilter(channel)) {\n                const newChannel = Object.assign({}, channel);\n                const channelIsArchived = channel.delete_at !== 0;\n\n                let wrappedChannel = {channel: newChannel, name: newChannel.name, deactivated: false};\n                if (!viewArchivedChannels && channelIsArchived) {\n                    continue;\n                } else if (channelIsArchived && members[channel.id]) {\n                    wrappedChannel.type = Constants.ARCHIVED_CHANNEL;\n                } else if (channelIsArchived && !members[channel.id]) {\n                    continue;\n                } else if (newChannel.type === Constants.GM_CHANNEL) {\n                    newChannel.name = newChannel.display_name;\n                    wrappedChannel.name = newChannel.name;\n                    const isGMVisible = isGroupChannelVisible(config, getMyPreferences(state), channel, getLastPostPerChannel(state)[channel.id], isUnreadChannel(getMyChannelMemberships(state), channel));\n                    if (isGMVisible) {\n                        wrappedChannel.type = Constants.MENTION_CHANNELS;\n                    } else {\n                        wrappedChannel.type = Constants.MENTION_MORE_CHANNELS;\n                        if (skipNotInChannel) {\n                            continue;\n                        }\n                    }\n                } else if (newChannel.type === Constants.DM_CHANNEL) {\n                    const userId = Utils.getUserIdFromChannelId(newChannel.name);\n                    const user = users.find((u) => u.id === userId);\n\n                    if (user) {\n                        completedChannels[user.id] = true;\n                        wrappedChannel = this.userWrappedChannel(\n                            user,\n                            newChannel\n                        );\n                        const isDMVisible = isDirectChannelVisible(user.id, config, getMyPreferences(state), channel, getLastPostPerChannel(state)[channel.id], isUnreadChannel(getMyChannelMemberships(state), channel));\n                        if (isDMVisible) {\n                            wrappedChannel.type = Constants.MENTION_CHANNELS;\n                        } else {\n                            wrappedChannel.type = Constants.MENTION_MORE_CHANNELS;\n                            if (skipNotInChannel) {\n                                continue;\n                            }\n                        }\n                    } else {\n                        continue;\n                    }\n                } else if (members[channel.id]) {\n                    wrappedChannel.type = Constants.MENTION_CHANNELS;\n                } else {\n                    wrappedChannel.type = Constants.MENTION_MORE_CHANNELS;\n                    if (skipNotInChannel || !newChannel.display_name.toLowerCase().startsWith(channelPrefix)) {\n                        continue;\n                    }\n                }\n\n                completedChannels[channel.id] = true;\n                channels.push(wrappedChannel);\n            }\n        }\n\n        for (let i = 0; i < users.length; i++) {\n            const user = users[i];\n\n            if (completedChannels[user.id]) {\n                continue;\n            }\n\n            const isDMVisible = getBool(getState(), Preferences.CATEGORY_DIRECT_CHANNEL_SHOW, user.id, false);\n\n            const wrappedChannel = this.userWrappedChannel(user);\n\n            if (isDMVisible) {\n                wrappedChannel.type = Constants.MENTION_CHANNELS;\n            } else {\n                wrappedChannel.type = Constants.MENTION_MORE_CHANNELS;\n                if (skipNotInChannel) {\n                    continue;\n                }\n            }\n\n            completedChannels[user.id] = true;\n            channels.push(wrappedChannel);\n        }\n\n        const channelNames = channels.\n            sort(quickSwitchSorter).\n            map((wrappedChannel) => wrappedChannel.channel.id);\n\n        if (skipNotInChannel) {\n            channels.push({\n                type: Constants.MENTION_MORE_CHANNELS,\n                loading: true,\n            });\n        }\n\n        resultsCallback({\n            matchedPretext: channelPrefix,\n            terms: channelNames,\n            items: channels,\n            component: ConnectedSwitchChannelSuggestion,\n        });\n    }\n\n    formatUnreadChannelsAndDispatch(resultsCallback) {\n        const getChannel = makeGetChannel();\n\n        const unreadChannelIds = getSortedUnreadChannelIds(getState(), false);\n\n        const channels = [];\n        for (let i = 0; i < unreadChannelIds.length; i++) {\n            const channel = getChannel(getState(), {id: unreadChannelIds[i]}) || {};\n\n            let wrappedChannel = {channel, name: channel.name, deactivated: false};\n            if (channel.type === Constants.GM_CHANNEL) {\n                wrappedChannel.name = channel.display_name;\n            } else if (channel.type === Constants.DM_CHANNEL) {\n                const user = getUser(getState(), Utils.getUserIdFromChannelId(channel.name));\n\n                if (!user) {\n                    continue;\n                }\n\n                wrappedChannel = this.userWrappedChannel(\n                    user,\n                    channel\n                );\n            }\n            wrappedChannel.type = Constants.MENTION_UNREAD_CHANNELS;\n            channels.push(wrappedChannel);\n        }\n\n        const channelNames = channels.map((wrappedChannel) => wrappedChannel.channel.id);\n\n        resultsCallback({\n            matchedPretext: '',\n            terms: channelNames,\n            items: channels,\n            component: ConnectedSwitchChannelSuggestion,\n        });\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport * as Selectors from 'mattermost-redux/selectors/entities/teams';\nimport {FormattedMessage} from 'react-intl';\n\nimport {getCurrentLocale} from 'selectors/i18n';\nimport store from 'stores/redux_store.jsx';\n\nimport Provider from './provider.jsx';\nimport Suggestion from './suggestion.jsx';\n\nconst getState = store.getState;\n\nclass SwitchTeamSuggestion extends Suggestion {\n    render() {\n        const {item, isSelection} = this.props;\n\n        let className = 'mentions__name';\n        if (isSelection) {\n            className += ' suggestion--selected';\n        }\n\n        return (\n            <div\n                onClick={this.handleClick}\n                className={className}\n                onMouseMove={this.handleMouseMove}\n                ref={(node) => {\n                    this.node = node;\n                }}\n                {...Suggestion.baseProps}\n            >\n                <div className='status'>\n                    <FormattedMessage\n                        id='general_tab.teamIcon'\n                        defaultMessage='Team Icon'\n                    >\n                        {(title) => (\n                            <i\n                                className='fa fa-group'\n                                title={title}\n                            />\n                        )}\n                    </FormattedMessage>\n                </div>\n                {item.display_name}\n            </div>\n        );\n    }\n}\n\nlet prefix = '';\n\nfunction quickSwitchSorter(a, b) {\n    const aDisplayName = a.display_name.toLowerCase();\n    const bDisplayName = b.display_name.toLowerCase();\n    const aStartsWith = aDisplayName.startsWith(prefix);\n    const bStartsWith = bDisplayName.startsWith(prefix);\n\n    if (aStartsWith && bStartsWith) {\n        const locale = getCurrentLocale(getState());\n\n        if (aDisplayName !== bDisplayName) {\n            return aDisplayName.localeCompare(bDisplayName, locale, {numeric: true});\n        }\n\n        return a.name.localeCompare(b.name, locale, {numeric: true});\n    } else if (aStartsWith) {\n        return -1;\n    }\n\n    return 1;\n}\n\nexport default class SwitchTeamProvider extends Provider {\n    handlePretextChanged(teamPrefix, resultsCallback) {\n        if (teamPrefix) {\n            prefix = teamPrefix;\n            this.startNewRequest(teamPrefix);\n\n            const allTeams = Selectors.getMyTeams(getState());\n\n            const teams = allTeams.filter((team) => {\n                return team.display_name.toLowerCase().indexOf(teamPrefix) !== -1 ||\n                    team.name.indexOf(teamPrefix) !== -1;\n            });\n\n            const teamNames = teams.\n                sort(quickSwitchSorter).\n                map((team) => team.name);\n\n            resultsCallback({\n                matchedPretext: teamPrefix,\n                terms: teamNames,\n                items: teams,\n                component: SwitchTeamSuggestion,\n            });\n\n            return true;\n        }\n\n        return false;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport {browserHistory} from 'utils/browser_history';\nimport Constants from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\nimport * as UserAgent from 'utils/user_agent';\nimport {t} from 'utils/i18n';\nimport SuggestionBox from 'components/suggestion/suggestion_box.jsx';\nimport SuggestionList from 'components/suggestion/suggestion_list.jsx';\nimport SwitchChannelProvider from 'components/suggestion/switch_channel_provider.jsx';\nimport SwitchTeamProvider from 'components/suggestion/switch_team_provider.jsx';\n\nconst CHANNEL_MODE = 'channel';\nconst TEAM_MODE = 'team';\n\nexport default class QuickSwitchModal extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * The function called to hide the modal\n         */\n        onHide: PropTypes.func.isRequired,\n\n        /**\n         * Set to show team switcher\n         */\n        showTeamSwitcher: PropTypes.bool,\n\n        actions: PropTypes.shape({\n            joinChannelById: PropTypes.func.isRequired,\n            switchToChannel: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.channelProviders = [new SwitchChannelProvider()];\n        this.teamProviders = [new SwitchTeamProvider()];\n\n        this.switchBox = null;\n\n        this.state = {\n            text: '',\n            mode: CHANNEL_MODE,\n        };\n    }\n\n    focusTextbox = () => {\n        if (this.switchBox == null) {\n            return;\n        }\n\n        const textbox = this.switchBox.getTextbox();\n        if (document.activeElement !== textbox) {\n            textbox.focus();\n            Utils.placeCaretAtEnd(textbox);\n        }\n    };\n\n    setSwitchBoxRef = (input) => {\n        this.switchBox = input;\n        this.focusTextbox();\n    };\n\n    onShow = () => {\n        this.setState({\n            text: '',\n        });\n    };\n\n    onHide = () => {\n        this.focusPostTextbox();\n        this.setState({\n            text: '',\n        });\n        this.props.onHide();\n    };\n\n    focusPostTextbox = () => {\n        if (!UserAgent.isMobile()) {\n            setTimeout(() => {\n                const textbox = document.querySelector('#post_textbox');\n                if (textbox) {\n                    textbox.focus();\n                }\n            });\n        }\n    };\n\n    onChange = (e) => {\n        this.setState({text: e.target.value});\n    };\n\n    handleKeyDown = (e) => {\n        if (Utils.isKeyPressed(e, Constants.KeyCodes.TAB)) {\n            e.preventDefault();\n            this.switchMode();\n        }\n    };\n\n    handleSubmit = async (selected) => {\n        if (!selected) {\n            return;\n        }\n\n        if (this.state.mode === CHANNEL_MODE) {\n            const {joinChannelById, switchToChannel} = this.props.actions;\n            const selectedChannel = selected.channel;\n\n            if (selected.type === Constants.MENTION_MORE_CHANNELS && selectedChannel.type === Constants.OPEN_CHANNEL) {\n                await joinChannelById(selectedChannel.id);\n            }\n            switchToChannel(selectedChannel).then((result) => {\n                if (result.data) {\n                    this.onHide();\n                }\n            });\n        } else {\n            browserHistory.push('/' + selected.name);\n            this.onHide();\n        }\n    };\n\n    enableChannelProvider = () => {\n        this.channelProviders[0].disableDispatches = false;\n        this.teamProviders[0].disableDispatches = true;\n    };\n\n    enableTeamProvider = () => {\n        this.teamProviders[0].disableDispatches = false;\n        this.channelProviders[0].disableDispatches = true;\n    };\n\n    switchMode = () => {\n        if (this.state.mode === CHANNEL_MODE && this.props.showTeamSwitcher) {\n            this.enableTeamProvider();\n            this.setState({mode: TEAM_MODE});\n        } else if (this.state.mode === TEAM_MODE) {\n            this.enableChannelProvider();\n            this.setState({mode: CHANNEL_MODE});\n        }\n    };\n\n    handleOnClick = (e) => {\n        e.preventDefault();\n        const mode = e.currentTarget.getAttribute('data-mode');\n        this.enableChannelProvider();\n        this.setState({mode});\n        this.focusTextbox();\n    }\n\n    render() {\n        let providers = this.channelProviders;\n        let header;\n        let renderDividers = true;\n\n        let channelShortcut = t('quick_switch_modal.channelsShortcut.windows');\n        let defaultChannelShortcut = 'CTRL+K';\n        if (Utils.isMac()) {\n            channelShortcut = t('quick_switch_modal.channelsShortcut.mac');\n            defaultChannelShortcut = 'CMD+K';\n        }\n\n        let teamShortcut = t('quick_switch_modal.teamsShortcut.windows');\n        let defaultTeamShortcut = 'CTRL+ALT+K';\n        if (Utils.isMac()) {\n            teamShortcut = t('quick_switch_modal.teamsShortcut.mac');\n            defaultTeamShortcut = 'CMD+ALT+K';\n        }\n\n        if (this.props.showTeamSwitcher) {\n            let channelsActiveClass = '';\n            let teamsActiveClass = '';\n            if (this.state.mode === TEAM_MODE) {\n                providers = this.teamProviders;\n                renderDividers = false;\n                teamsActiveClass = 'active';\n            } else {\n                channelsActiveClass = 'active';\n            }\n\n            header = (\n                <div className='nav nav-tabs'>\n                    <li className={channelsActiveClass}>\n                        <a\n                            data-mode={'channel'}\n                            href='#'\n                            onClick={this.handleOnClick}\n                        >\n                            <FormattedMessage\n                                id='quick_switch_modal.channels'\n                                defaultMessage='Channels'\n                            />\n                            <span className='small'>\n                                <FormattedMessage\n                                    id={channelShortcut}\n                                    defaultMessage={defaultChannelShortcut}\n                                />\n                            </span>\n                        </a>\n                    </li>\n                    <li className={teamsActiveClass}>\n                        <a\n                            data-mode={'team'}\n                            href='#'\n                            onClick={this.handleOnClick}\n                        >\n                            <FormattedMessage\n                                id='quick_switch_modal.teams'\n                                defaultMessage='Teams'\n                            />\n                            <span className='small'>\n                                <FormattedMessage\n                                    id={teamShortcut}\n                                    defaultMessage={defaultTeamShortcut}\n                                />\n                            </span>\n                        </a>\n                    </li>\n                </div>\n            );\n        }\n\n        let help;\n        if (Utils.isMobile()) {\n            help = (\n                <FormattedMessage\n                    id='quick_switch_modal.help_mobile'\n                    defaultMessage='Type to find a channel.'\n                />\n            );\n        } else if (this.props.showTeamSwitcher) {\n            help = (\n                <FormattedMessage\n                    id='quick_switch_modal.help'\n                    defaultMessage='Start typing then use TAB to toggle channels/teams,  to browse,  to select, and ESC to dismiss.'\n                />\n            );\n        } else {\n            help = (\n                <FormattedMessage\n                    id='quick_switch_modal.help_no_team'\n                    defaultMessage='Type to find a channel. Use  to browse,  to select, ESC to dismiss.'\n                />\n            );\n        }\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal channel-switch__modal'\n                ref='modal'\n                show={true}\n                onHide={this.onHide}\n                enforceFocus={false}\n                restoreFocus={false}\n                role='dialog'\n                aria-labelledby='quickSwitchModalLabel'\n                animation={false}\n            >\n                <Modal.Header\n                    id='quickSwitchModalLabel'\n                    closeButton={true}\n                />\n                <Modal.Body>\n                    {header}\n                    <div\n                        id='quickSwitchHint'\n                        className='modal__hint'\n                    >\n                        {help}\n                    </div>\n                    <div className='channel-switch__suggestion-box'>\n                        <SuggestionBox\n                            id='quickSwitchInput'\n                            ref={this.setSwitchBoxRef}\n                            className='form-control focused'\n                            onChange={this.onChange}\n                            value={this.state.text}\n                            onKeyDown={this.handleKeyDown}\n                            onItemSelected={this.handleSubmit}\n                            listComponent={SuggestionList}\n                            maxLength='64'\n                            providers={providers}\n                            listStyle='bottom'\n                            completeOnTab={false}\n                            spellCheck='false'\n                            renderDividers={renderDividers}\n                            delayInputUpdate={true}\n                            openWhenEmpty={true}\n                        />\n                    </div>\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {joinChannelById, switchToChannel} from 'actions/views/channel';\n\nimport QuickSwitchModal from './quick_switch_modal.jsx';\n\nfunction mapStateToProps() {\n    return {\n        showTeamSwitcher: false,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            joinChannelById,\n            switchToChannel,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(QuickSwitchModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport GlobeIcon from 'components/widgets/icons/globe_icon';\nimport LockIcon from 'components/widgets/icons/lock_icon';\nimport LocalizedInput from 'components/localized_input/localized_input';\nimport Constants from 'utils/constants.jsx';\nimport {getShortenedURL} from 'utils/url';\nimport * as UserAgent from 'utils/user_agent';\nimport * as Utils from 'utils/utils.jsx';\nimport {t} from 'utils/i18n.jsx';\n\nexport default class NewChannelModal extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * Set whether to show the modal or not\n         */\n        show: PropTypes.bool.isRequired,\n\n        /**\n         * Id of the active team\n         */\n        currentTeamId: PropTypes.string.isRequired,\n\n        /**\n         * The type of channel to create, 'O' or 'P'\n         */\n        channelType: PropTypes.string.isRequired,\n\n        /**\n         * The data needed to create the channel\n         */\n        channelData: PropTypes.object.isRequired,\n\n        /**\n         * Set to force form submission on CTRL/CMD + ENTER instead of ENTER\n         */\n        ctrlSend: PropTypes.bool,\n\n        /**\n         * Server error from failed channel creation\n         */\n        serverError: PropTypes.node,\n\n        /**\n         * Function used to submit the channel\n         */\n        onSubmitChannel: PropTypes.func.isRequired,\n\n        /**\n         * Function to call when modal is dimissed\n         */\n        onModalDismissed: PropTypes.func.isRequired,\n\n        /**\n         * Function to call when modal has exited\n         */\n        onModalExited: PropTypes.func,\n\n        /**\n         * Function to call to switch channel type\n         */\n        onTypeSwitched: PropTypes.func.isRequired,\n\n        /**\n         * Function to call when edit URL button is pressed\n         */\n        onChangeURLPressed: PropTypes.func.isRequired,\n\n        /**\n         * Function to call when channel data is modified\n         */\n        onDataChanged: PropTypes.func.isRequired,\n\n        /**\n         * Permission to create public channel\n         */\n        canCreatePublicChannel: PropTypes.bool.isRequired,\n\n        /**\n         * Permission to create private channel\n         */\n        canCreatePrivateChannel: PropTypes.bool.isRequired,\n    }\n\n    static getDerivedStateFromProps(props) {\n        if (props.show === false) {\n            return {displayNameError: ''};\n        }\n\n        return null;\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            displayNameError: '',\n        };\n\n        this.channelHeaderInput = React.createRef();\n        this.channelPurposeInput = React.createRef();\n        this.displayNameInput = React.createRef();\n    }\n\n    componentDidMount() {\n        // ???\n        if (UserAgent.isInternetExplorer() || UserAgent.isEdge()) {\n            $('body').addClass('browser--ie');\n        }\n    }\n\n    onEnterKeyDown = (e) => {\n        const enterPressed = Utils.isKeyPressed(e, Constants.KeyCodes.ENTER);\n        const {ctrlSend} = this.props;\n\n        // Enter pressed alone without required cmd or ctrl key\n        if (ctrlSend && enterPressed && !e.ctrlKey) {\n            e.preventDefault();\n        } else if ((ctrlSend && enterPressed && e.ctrlKey) || (!ctrlSend && enterPressed && !e.shiftKey && !e.altKey)) {\n            this.handleSubmit(e);\n        }\n    }\n\n    handleSubmit = (e) => {\n        e.preventDefault();\n\n        const displayName = this.displayNameInput.current.value.trim();\n        if (displayName.length < Constants.MIN_CHANNELNAME_LENGTH) {\n            this.setState({displayNameError: true});\n            return;\n        }\n\n        this.props.onSubmitChannel();\n    }\n\n    handleChange = () => {\n        const newData = {\n            displayName: this.displayNameInput.current.value,\n            header: this.channelHeaderInput.current.value,\n            purpose: this.channelPurposeInput.current.value,\n        };\n        this.props.onDataChanged(newData);\n    }\n\n    handleOnURLChange = (e) => {\n        e.preventDefault();\n        if (this.props.onChangeURLPressed) {\n            this.props.onChangeURLPressed();\n        }\n    }\n\n    handlePublicTypeSelect = () => {\n        this.props.onTypeSwitched('O');\n    }\n\n    handlePrivateTypeSelect = () => {\n        this.props.onTypeSwitched('P');\n    }\n\n    render() {\n        const {canCreatePublicChannel, canCreatePrivateChannel} = this.props;\n\n        const enableTypeSelection = canCreatePublicChannel && canCreatePrivateChannel;\n        var displayNameError = null;\n        var serverError = null;\n        var displayNameClass = 'form-group';\n\n        if (this.state.displayNameError) {\n            displayNameError = (\n                <p className='input__help error'>\n                    <FormattedMessage\n                        id='channel_modal.displayNameError'\n                        defaultMessage='Channel name must be 2 or more characters'\n                    />\n                    {this.state.displayNameError}\n                </p>\n            );\n            displayNameClass += ' has-error';\n        }\n\n        if (this.props.serverError) {\n            serverError = (\n                <div className='form-group has-error'>\n                    <div className='col-sm-12'>\n                        <p\n                            id='createChannelError'\n                            className='input__help error'\n                        >\n                            {this.props.serverError}\n                        </p>\n                    </div>\n                </div>\n            );\n        }\n\n        const publicChannelDesc = (\n            <div className='flex-parent'>\n                <GlobeIcon className='icon icon__globe icon--body type-icon'/>\n                <FormattedMessage\n                    id='channel_modal.publicName'\n                    defaultMessage='Public'\n                />\n                <FormattedMessage\n                    id='channel_modal.publicHint'\n                    defaultMessage=' - Anyone can join this channel'\n                />\n            </div>\n        );\n\n        const privateChannelDesc = (\n            <div className='flex-parent'>\n                <LockIcon className='icon icon__lock icon--body type-icon'/>\n                <FormattedMessage\n                    id='channel_modal.privateName'\n                    defaultMessage='Private'\n                />\n                <FormattedMessage\n                    id='channel_modal.privateHint'\n                    defaultMessage=' - Only invited members can join this channel'\n                />\n            </div>\n        );\n\n        let typeOptions = null;\n        if (enableTypeSelection) {\n            typeOptions = (\n                <fieldset\n                    key='channelType'\n                    className='multi-select__radio'\n                >\n                    <div className='radio'>\n                        <label>\n                            <input\n                                id='public'\n                                type='radio'\n                                name='channelType'\n                                checked={this.props.channelType === 'O'}\n                                onChange={this.handlePublicTypeSelect}\n                                aria-labelledby='channelModalTypeLabel'\n                            />\n                            {publicChannelDesc}\n                        </label>\n                    </div>\n                    <div className='radio'>\n                        <label>\n                            <input\n                                id='private'\n                                type='radio'\n                                name='channelType'\n                                checked={this.props.channelType === 'P'}\n                                onChange={this.handlePrivateTypeSelect}\n                                aria-labelledby='channelModalTypeLabel'\n                            />\n                            {privateChannelDesc}\n                        </label>\n                    </div>\n                </fieldset>\n            );\n        } else {\n            typeOptions = (\n                <div className='type-container multi-select__radio'>\n                    <div className='radio'>\n                        {canCreatePublicChannel ? publicChannelDesc : null}\n                        {canCreatePrivateChannel ? privateChannelDesc : null}\n                    </div>\n                </div>\n            );\n        }\n\n        const prettyTeamURL = getShortenedURL();\n\n        return (\n            <span>\n                <Modal\n                    dialogClassName='a11y__modal new-channel__modal new-channel'\n                    show={this.props.show}\n                    bsSize='large'\n                    onHide={this.props.onModalDismissed}\n                    onExited={this.props.onModalExited}\n                    autoFocus={true}\n                    restoreFocus={true}\n                    role='dialog'\n                    aria-labelledby='newChannelModalLabel'\n                >\n                    <Modal.Header>\n                        <button\n                            type='button'\n                            className='close'\n                            onClick={this.props.onModalDismissed}\n                            aria-label='Close'\n                            title='Close'\n                        >\n                            <span aria-hidden='true'>{''}</span>\n                        </button>\n                        <Modal.Title\n                            componentClass='h1'\n                            id='newChannelModalLabel'\n                        >\n                            <FormattedMessage\n                                id='channel_modal.modalTitle'\n                                defaultMessage='New Channel'\n                            />\n                        </Modal.Title>\n                    </Modal.Header>\n                    <form\n                        role='form'\n                        className='form-horizontal'\n                    >\n                        <Modal.Body>\n                            <div className='form-group'>\n                                <label\n                                    className='col-sm-3 form__label control-label'\n                                    id='channelModalTypeLabel'\n                                >\n                                    <FormattedMessage\n                                        id='channel_modal.type'\n                                        defaultMessage='Type'\n                                    />\n                                </label>\n                                <div className='col-sm-9'>\n                                    {typeOptions}\n                                </div>\n                            </div>\n                            <div className={displayNameClass}>\n                                <label\n                                    className='col-sm-3 form__label control-label'\n                                    htmlFor='newChannelName'\n                                >\n                                    <FormattedMessage\n                                        id='channel_modal.name'\n                                        defaultMessage='Name'\n                                    />\n                                </label>\n                                <div className='col-sm-9'>\n                                    <LocalizedInput\n                                        id='newChannelName'\n                                        onChange={this.handleChange}\n                                        type='text'\n                                        ref={this.displayNameInput}\n                                        className='form-control'\n                                        placeholder={{id: t('channel_modal.nameEx'), defaultMessage: 'E.g.: \"Bugs\", \"Marketing\", \"\"'}}\n                                        maxLength={Constants.MAX_CHANNELNAME_LENGTH}\n                                        value={this.props.channelData.displayName}\n                                        autoFocus={true}\n                                        onKeyDown={this.onEnterKeyDown}\n                                    />\n                                    {displayNameError}\n                                    <p className='input__help dark'>\n                                        {'URL: ' + prettyTeamURL + this.props.channelData.name + ' ('}\n                                        <button\n                                            className='color--link style--none'\n                                            onClick={this.handleOnURLChange}\n                                        >\n                                            <FormattedMessage\n                                                id='channel_modal.edit'\n                                                defaultMessage='Edit'\n                                            />\n                                        </button>\n                                        {')'}\n                                    </p>\n                                </div>\n                            </div>\n                            <div className='form-group'>\n                                <div className='col-sm-3'>\n                                    <label\n                                        className='form__label control-label'\n                                        htmlFor='newChannelPurpose'\n                                    >\n                                        <FormattedMessage\n                                            id='channel_modal.purpose'\n                                            defaultMessage='Purpose'\n                                        />\n                                    </label>\n                                    <label className='form__label light'>\n                                        <FormattedMessage\n                                            id='channel_modal.optional'\n                                            defaultMessage='(optional)'\n                                        />\n                                    </label>\n                                </div>\n                                <div className='col-sm-9'>\n                                    <textarea\n                                        id='newChannelPurpose'\n                                        className='form-control no-resize'\n                                        ref={this.channelPurposeInput}\n                                        rows='4'\n                                        placeholder={Utils.localizeMessage('channel_modal.purposeEx', 'E.g.: \"A channel to file bugs and improvements\"')}\n                                        maxLength='250'\n                                        value={this.props.channelData.purpose}\n                                        onChange={this.handleChange}\n                                    />\n                                    <p className='input__help'>\n                                        <FormattedMessage\n                                            id='channel_modal.descriptionHelp'\n                                            defaultMessage='Describe how this channel should be used.'\n                                        />\n                                    </p>\n                                </div>\n                            </div>\n                            <div className='form-group less'>\n                                <div className='col-sm-3'>\n                                    <label\n                                        className='form__label control-label'\n                                        htmlFor='newChannelHeader'\n                                    >\n                                        <FormattedMessage\n                                            id='channel_modal.header'\n                                            defaultMessage='Header'\n                                        />\n                                    </label>\n                                    <label className='form__label light'>\n                                        <FormattedMessage\n                                            id='channel_modal.optional'\n                                            defaultMessage='(optional)'\n                                        />\n                                    </label>\n                                </div>\n                                <div className='col-sm-9'>\n                                    <textarea\n                                        id='newChannelHeader'\n                                        className='form-control no-resize'\n                                        ref={this.channelHeaderInput}\n                                        rows='4'\n                                        placeholder={Utils.localizeMessage('channel_modal.headerEx', 'E.g.: \"[Link Title](http://example.com)\"')}\n                                        maxLength='1024'\n                                        value={this.props.channelData.header}\n                                        onChange={this.handleChange}\n                                    />\n                                    <p className='input__help'>\n                                        <FormattedMessage\n                                            id='channel_modal.headerHelp'\n                                            defaultMessage='Set text that will appear in the header of the channel beside the channel name. For example, include frequently used links by typing [Link Title](http://example.com).'\n                                        />\n                                    </p>\n                                    {serverError}\n                                </div>\n                            </div>\n                        </Modal.Body>\n                        <Modal.Footer>\n                            <button\n                                id='cancelNewChannel'\n                                type='button'\n                                className='btn btn-link'\n                                onClick={this.props.onModalDismissed}\n                                onBlur={() => document.getElementById('newChannelName').focus()}\n                            >\n                                <FormattedMessage\n                                    id='channel_modal.cancel'\n                                    defaultMessage='Cancel'\n                                />\n                            </button>\n                            <button\n                                id='submitNewChannel'\n                                onClick={this.handleSubmit}\n                                type='submit'\n                                className='btn btn-primary'\n                            >\n                                <FormattedMessage\n                                    id='channel_modal.createNew'\n                                    defaultMessage='Create Channel'\n                                />\n                            </button>\n                        </Modal.Footer>\n                    </form>\n                </Modal>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {Preferences} from 'mattermost-redux/constants';\nimport {getBool} from 'mattermost-redux/selectors/entities/preferences';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\n\nimport NewChannelModal from './new_channel_modal.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        ctrlSend: getBool(state, Preferences.CATEGORY_ADVANCED_SETTINGS, 'send_on_ctrl_enter'),\n        currentTeamId: getCurrentTeamId(state),\n    };\n}\n\nexport default connect(mapStateToProps)(NewChannelModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal, Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport OverlayTrigger from 'components/overlay_trigger';\n\nimport Constants from 'utils/constants';\nimport {getShortenedURL, cleanUpUrlable} from 'utils/url';\nimport {t} from 'utils/i18n';\n\nexport default class ChangeURLModal extends React.PureComponent {\n    static propTypes = {\n\n        /**\n        * Set whether to show the modal or not\n        */\n        show: PropTypes.bool.isRequired,\n\n        /**\n        * Set to change the title of the modal\n        */\n        title: PropTypes.node,\n\n        /**\n        * Set to change the submit button text\n        */\n        submitButtonText: PropTypes.node,\n\n        /**\n        * Set to change the current URL\n        */\n        currentURL: PropTypes.string,\n\n        /**\n        * Set to the current team URL\n        */\n        currentTeamURL: PropTypes.string.isRequired,\n\n        /**\n        * Server error from failed channel creation\n        */\n        serverError: PropTypes.node,\n\n        /**\n         * Function to call when modal is submitted\n         */\n        onModalSubmit: PropTypes.func.isRequired,\n\n        /**\n         * Function to call when modal is exited\n         */\n        onModalExited: PropTypes.func,\n\n        /**\n         * Function to call when modal is dimissed\n         */\n        onModalDismissed: PropTypes.func.isRequired,\n    }\n\n    static defaultProps = {\n        show: false,\n        title: 'Change URL',\n        submitButtonText: 'Save',\n        currentURL: '',\n        serverError: null,\n    }\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            currentURL: props.currentURL,\n            urlError: '',\n            userEdit: false,\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        // This check prevents the url being deleted when we re-render\n        // because of user status check\n        if (!state.userEdit) {\n            return {currentURL: props.currentURL};\n        }\n\n        return null;\n    }\n\n    onURLChanged = (e) => {\n        const url = e.target.value.trim();\n        this.setState({currentURL: url.replace(/[^A-Za-z0-9-_]/g, '').toLowerCase(), userEdit: true});\n    }\n\n    formattedError = (key, id, message) => {\n        return (<span key={key}>\n            <FormattedMessage\n                id={id}\n                defaultMessage={message}\n            />\n            <br/>\n        </span>);\n    }\n\n    getURLError = (url) => {\n        let error = []; //eslint-disable-line prefer-const\n\n        if (url.length < 2) {\n            error.push(\n                this.formattedError('error1', t('change_url.longer'), 'URL must be two or more characters.')\n            );\n        }\n        if (url.charAt(0) === '-' || url.charAt(0) === '_') {\n            error.push(\n                this.formattedError('error2', t('change_url.startWithLetter'), 'URL must start with a letter or number.')\n            );\n        }\n        if (url.length > 1 && (url.charAt(url.length - 1) === '-' || url.charAt(url.length - 1) === '_')) {\n            error.push(\n                this.formattedError('error3', t('change_url.endWithLetter'), 'URL must end with a letter or number.')\n            );\n        }\n        if (url.indexOf('__') > -1) {\n            error.push(\n                this.formattedError('error4', t('change_url.noUnderscore'), 'URL can not contain two underscores in a row.')\n            );\n        }\n\n        // In case of error we don't detect\n        if (error.length === 0) {\n            error.push(\n                this.formattedError('errorlast', t('change_url.invalidUrl'), 'Invalid URL')\n            );\n        }\n        return error;\n    }\n\n    onSubmit = (e) => {\n        e.preventDefault();\n        const url = this.refs.urlinput.value;\n        const cleanedURL = cleanUpUrlable(url);\n        if (cleanedURL !== url || url.length < 2 || url.indexOf('__') > -1) {\n            this.setState({urlError: this.getURLError(url)});\n            return;\n        }\n        this.setState({urlError: '', userEdit: false});\n        this.props.onModalSubmit(url);\n    }\n\n    onCancel = () => {\n        this.setState({urlError: '', userEdit: false});\n        this.props.onModalDismissed();\n    }\n\n    render() {\n        let urlClass = 'input-group input-group--limit';\n        let error = null;\n\n        if (this.state.urlError) {\n            urlClass += ' has-error';\n        }\n\n        if (this.props.serverError || this.state.urlError) {\n            error = (\n                <div className='has-error'>\n                    <p className='input__help error'>\n                        {this.state.urlError || this.props.serverError}\n                    </p>\n                </div>\n            );\n        }\n\n        const fullURL = this.props.currentTeamURL + '/channels';\n        const shortURL = getShortenedURL(fullURL);\n        const urlTooltip = (\n            <Tooltip id='urlTooltip'>{fullURL}</Tooltip>\n        );\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal'\n                show={this.props.show}\n                onHide={this.onCancel}\n                onExited={this.props.onModalExited}\n                role='dialog'\n                aria-labelledby='changeUrlModalLabel'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='changeUrlModalLabel'\n                    >\n                        {this.props.title}\n                    </Modal.Title>\n                </Modal.Header>\n                <form\n                    role='form'\n                    className='form-horizontal'\n                >\n                    <Modal.Body>\n                        <div className='modal-intro'>\n                            <FormattedMessage\n                                id='channel_flow.changeUrlDescription'\n                                defaultMessage='Some characters are now allowed in URLs and may be removed.'\n                            />\n                        </div>\n                        <div className='form-group'>\n                            <label className='col-sm-3 form__label control-label'>\n                                <FormattedMessage\n                                    id='change_url.urlLabel'\n                                    defaultMessage='Channel URL'\n                                />\n                            </label>\n                            <div className='col-sm-9'>\n                                <div className={urlClass}>\n                                    <OverlayTrigger\n                                        delayShow={Constants.OVERLAY_TIME_DELAY}\n                                        placement='top'\n                                        overlay={urlTooltip}\n                                    >\n                                        <span className='input-group-addon'>{shortURL}</span>\n                                    </OverlayTrigger>\n                                    <input\n                                        type='text'\n                                        ref='urlinput'\n                                        className='form-control'\n                                        maxLength={Constants.MAX_CHANNELNAME_LENGTH}\n                                        onChange={this.onURLChanged}\n                                        value={this.state.currentURL}\n                                        autoFocus={true}\n                                    />\n                                </div>\n                                {error}\n                            </div>\n                        </div>\n                    </Modal.Body>\n                    <Modal.Footer>\n                        <button\n                            type='button'\n                            className='btn btn-link'\n                            onClick={this.onCancel}\n                        >\n                            <FormattedMessage\n                                id='change_url.close'\n                                defaultMessage='Close'\n                            />\n                        </button>\n                        <button\n                            onClick={this.onSubmit}\n                            type='submit'\n                            className='btn btn-primary'\n                        >\n                            {this.props.submitButtonText}\n                        </button>\n                    </Modal.Footer>\n                </form>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\n\nimport {getSiteURL} from 'utils/url';\n\nimport ChangeURLModal from './change_url_modal';\n\nfunction mapStateToProps(state) {\n    const currentTeam = getCurrentTeam(state);\n    const currentTeamURL = `${getSiteURL()}/${currentTeam.name}`;\n    return {\n        currentTeamURL,\n    };\n}\n\nexport default connect(mapStateToProps)(ChangeURLModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {ChannelType, Channel} from 'mattermost-redux/types/channels';\nimport {Error} from 'mattermost-redux/types/errors';\n\nimport Constants from 'utils/constants';\nimport * as Utils from 'utils/utils';\nimport {cleanUpUrlable} from 'utils/url';\n\nimport NewChannelModal from 'components/new_channel_modal';\nimport ChangeURLModal from 'components/change_url_modal';\n\nexport const SHOW_NEW_CHANNEL = 1;\nexport const SHOW_EDIT_URL = 2;\nexport const SHOW_EDIT_URL_THEN_COMPLETE = 3;\n\nexport function getChannelTypeFromProps(props: Props): ChannelType {\n    let channelType = props.channelType || Constants.OPEN_CHANNEL;\n    if (!props.canCreatePublicChannel && channelType === Constants.OPEN_CHANNEL) {\n        channelType = Constants.PRIVATE_CHANNEL as ChannelType;\n    }\n    if (!props.canCreatePrivateChannel && channelType === Constants.PRIVATE_CHANNEL) {\n        channelType = Constants.OPEN_CHANNEL as ChannelType;\n    }\n    return channelType;\n}\n\nexport type Props = {\n\n    /**\n     * Set whether to show the modal or not\n     */\n    show: boolean;\n\n    /**\n     * Set to Constants.OPEN_CHANNEL or Constants.PRIVATE_CHANNEL depending on which modal we should show first\n     */\n    channelType: ChannelType;\n\n    /**\n     * Function to call when modal is dimissed\n     */\n    onModalDismissed: () => void;\n\n    /**\n     * The current team ID\n     */\n    currentTeamId: string;\n\n    /**\n     * Permission to create public channel\n     */\n    canCreatePublicChannel: boolean;\n\n    /**\n     * Permission to create private channel\n     */\n    canCreatePrivateChannel: boolean;\n\n    actions: {\n        createChannel: (channel: Channel) => Promise<{data: Channel; error?: Error}>;\n        switchToChannel: (channel: Channel) => Promise<{}>;\n    };\n};\n\ntype State = {\n    serverError: JSX.Element | string | null;\n    channelType: ChannelType;\n    flowState: number;\n    channelDisplayName: string;\n    channelName: string;\n    channelPurpose: string;\n    channelHeader: string;\n    nameModified: boolean;\n    show: boolean;\n}\n\ntype NewChannelData = {\n    displayName: string;\n    purpose: string;\n    header: string;\n}\n\nexport default class NewChannelFlow extends React.Component<Props, State> {\n    public static defaultProps = {\n        show: false,\n        channelType: Constants.OPEN_CHANNEL as ChannelType,\n    };\n\n    static getDerivedStateFromProps(props: Props, state: State) {\n        // If we are being shown, grab channel type from props and clear\n        if (props.show && !state.show) {\n            return {\n                serverError: '',\n                channelType: getChannelTypeFromProps(props),\n                flowState: SHOW_NEW_CHANNEL,\n                channelDisplayName: '',\n                channelName: '',\n                channelPurpose: '',\n                channelHeader: '',\n                nameModified: false,\n                show: props.show,\n            };\n        }\n\n        return {show: props.show};\n    }\n\n    public constructor(props: Props) {\n        super(props);\n\n        this.state = {\n            serverError: '',\n            channelType: getChannelTypeFromProps(props),\n            flowState: SHOW_NEW_CHANNEL,\n            channelDisplayName: '',\n            channelName: '',\n            channelPurpose: '',\n            channelHeader: '',\n            nameModified: false,\n            show: props.show,\n        };\n    }\n\n    onSubmit = () => {\n        if (!this.state.channelDisplayName) {\n            this.setState({serverError: Utils.localizeMessage('channel_flow.invalidName', 'Invalid Channel Name')});\n            return;\n        }\n\n        if (this.state.channelName.length < 2) {\n            this.setState({flowState: SHOW_EDIT_URL_THEN_COMPLETE});\n            return;\n        }\n\n        const {actions, currentTeamId} = this.props;\n        const channel: Channel = {\n            team_id: currentTeamId,\n            name: this.state.channelName,\n            display_name: this.state.channelDisplayName,\n            purpose: this.state.channelPurpose,\n            header: this.state.channelHeader,\n            type: this.state.channelType,\n            create_at: 0,\n            creator_id: '',\n            delete_at: 0,\n            extra_update_at: 0,\n            group_constrained: false,\n            id: '',\n            last_post_at: 0,\n            scheme_id: '',\n            total_msg_count: 0,\n            update_at: 0,\n        };\n\n        actions.createChannel(channel).then((result: {data: Channel; error?: Error}) => {\n            if (result.error) {\n                this.onCreateChannelError(result.error);\n                return;\n            }\n\n            this.props.onModalDismissed();\n            actions.switchToChannel(result.data);\n        });\n    };\n\n    onCreateChannelError = (err: Error) => {\n        if (err.server_error_id === 'model.channel.is_valid.2_or_more.app_error') {\n            this.setState({\n                flowState: SHOW_EDIT_URL_THEN_COMPLETE,\n                serverError: (\n                    <FormattedMessage\n                        id='channel_flow.handleTooShort'\n                        defaultMessage='Channel URL must be 2 or more lowercase alphanumeric characters'\n                    />\n                ),\n            });\n        } else if (err.server_error_id === 'store.sql_channel.update.exists.app_error') {\n            this.setState({serverError: Utils.localizeMessage('channel_flow.alreadyExist', 'A channel with that URL already exists')});\n        } else {\n            this.setState({serverError: err.message});\n        }\n    };\n\n    typeSwitched = (channelType: ChannelType) => {\n        this.setState({\n            channelType,\n            serverError: '',\n        });\n    };\n\n    urlChangeRequested = (e: React.MouseEvent) => {\n        if (e) {\n            e.preventDefault();\n        }\n        this.setState({flowState: SHOW_EDIT_URL});\n    };\n\n    urlChangeSubmitted = (newURL: string) => {\n        if (this.state.flowState === SHOW_EDIT_URL_THEN_COMPLETE) {\n            this.setState({channelName: newURL, nameModified: true}, this.onSubmit);\n        } else {\n            this.setState({flowState: SHOW_NEW_CHANNEL, serverError: null, channelName: newURL, nameModified: true});\n        }\n    };\n\n    urlChangeDismissed = () => {\n        this.setState({flowState: SHOW_NEW_CHANNEL});\n    };\n\n    channelDataChanged = (data: NewChannelData) => {\n        this.setState({\n            channelDisplayName: data.displayName,\n            channelPurpose: data.purpose,\n            channelHeader: data.header,\n        });\n        if (!this.state.nameModified) {\n            this.setState({channelName: cleanUpUrlable(data.displayName.trim())});\n        }\n    };\n\n    render() {\n        const channelData = {\n            name: this.state.channelName,\n            displayName: this.state.channelDisplayName,\n            purpose: this.state.channelPurpose,\n            header: this.state.channelHeader,\n        };\n\n        let showChannelModal = false;\n        let showChangeURLModal = false;\n\n        let changeURLTitle: string | JSX.Element = '';\n        let changeURLSubmitButtonText: string | JSX.Element = '';\n\n        // Only listen to flow state if we are being shown\n        if (this.props.show) {\n            switch (this.state.flowState) {\n            case SHOW_NEW_CHANNEL:\n                showChannelModal = true;\n                break;\n            case SHOW_EDIT_URL:\n                showChangeURLModal = true;\n                changeURLTitle = (\n                    <FormattedMessage\n                        id='channel_flow.changeUrlTitle'\n                        defaultMessage='Change Channel URL'\n                    />\n                );\n                changeURLSubmitButtonText = changeURLTitle;\n                break;\n            case SHOW_EDIT_URL_THEN_COMPLETE:\n                showChangeURLModal = true;\n                changeURLTitle = (\n                    <FormattedMessage\n                        id='channel_flow.set_url_title'\n                        defaultMessage='Set Channel URL'\n                    />\n                );\n                changeURLSubmitButtonText = (\n                    <FormattedMessage\n                        id='channel_flow.create'\n                        defaultMessage='Create Channel'\n                    />\n                );\n                break;\n            }\n        }\n\n        return (\n            <span>\n                <NewChannelModal\n                    show={showChannelModal}\n                    channelType={this.state.channelType}\n                    canCreatePublicChannel={this.props.canCreatePublicChannel}\n                    canCreatePrivateChannel={this.props.canCreatePrivateChannel}\n                    channelData={channelData}\n                    serverError={this.state.serverError}\n                    onSubmitChannel={this.onSubmit}\n                    onModalDismissed={this.props.onModalDismissed}\n                    onTypeSwitched={this.typeSwitched}\n                    onChangeURLPressed={this.urlChangeRequested}\n                    onDataChanged={this.channelDataChanged}\n                />\n                <ChangeURLModal\n                    show={showChangeURLModal}\n                    title={changeURLTitle}\n                    submitButtonText={changeURLSubmitButtonText}\n                    currentURL={this.state.channelName}\n                    serverError={this.state.serverError}\n                    onModalSubmit={this.urlChangeSubmitted}\n                    onModalDismissed={this.urlChangeDismissed}\n                />\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch, ActionCreatorsMapObject} from 'redux';\n\nimport {ActionFunc, GenericAction} from 'mattermost-redux/types/actions';\nimport {Channel} from 'mattermost-redux/types/channels';\nimport {Error} from 'mattermost-redux/types/errors';\nimport {createChannel} from 'mattermost-redux/actions/channels';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {GlobalState} from 'mattermost-redux/types/store';\n\nimport {switchToChannel} from 'actions/views/channel';\n\nimport NewChannelFlow from './new_channel_flow';\n\ntype Actions = {\n    createChannel: (channel: Channel) => Promise<{data: Channel; error?: Error}>;\n    switchToChannel: (channel: Channel) => Promise<{}>;\n}\n\nfunction mapStateToProps(state: GlobalState) {\n    return {\n        currentTeamId: getCurrentTeamId(state),\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<GenericAction>) {\n    return {\n        actions: bindActionCreators<ActionCreatorsMapObject<ActionFunc>, Actions>({\n            createChannel,\n            switchToChannel,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NewChannelFlow);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class UnreadBelowIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.arrow.down'\n                    defaultMessage='Down Arrow Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            xmlns='http://www.w3.org/2000/svg'\n                            width='24px'\n                            height='24px'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path d='M6 12l1.058-1.057 4.192 4.184V6h1.5v9.127l4.185-4.192L18 12l-6 6z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {ReactNode} from 'react';\n\nimport UnreadBelowIcon from 'components/widgets/icons/unread_below_icon';\n\ntype Props = {\n\n    /**\n     * Function to call when the indicator is clicked\n     */\n    onClick: (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n\n    /**\n     * Set whether to show the indicator or not\n     */\n    show?: boolean;\n\n    /**\n     * The additional CSS class for the indicator\n     */\n    extraClass?: string;\n\n    /**\n     * The content of the indicator\n     */\n    content?: ReactNode;\n\n    /**\n     * The name of the indicator\n     */\n    name?: string;\n}\n\nexport default class UnreadChannelIndicator extends React.PureComponent<Props> {\n    public static defaultProps: Partial<Props> = {\n        show: false,\n        extraClass: '',\n        content: '',\n    };\n\n    public render(): JSX.Element {\n        let classes = 'nav-pills__unread-indicator ';\n        if (this.props.show) {\n            classes += 'nav-pills__unread-indicator--visible ';\n        }\n\n        return (\n            <div\n                id={'unreadIndicator' + this.props.name}\n                className={classes + this.props.extraClass}\n                onClick={this.props.onClick}\n            >\n                {this.props.content}\n                <UnreadBelowIcon className='icon icon__unread'/>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {UserStatuses, ModalIdentifiers} from 'utils/constants';\nimport {localizeMessage} from 'utils/utils.jsx';\nimport ResetStatusModal from 'components/reset_status_modal';\nimport StatusIcon from 'components/status_icon.jsx';\n\nimport Avatar from 'components/widgets/users/avatar';\nimport Menu from 'components/widgets/menu/menu';\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\n\nexport default class StatusDropdown extends React.Component {\n    static propTypes = {\n        style: PropTypes.object,\n        status: PropTypes.string,\n        userId: PropTypes.string.isRequired,\n        profilePicture: PropTypes.string,\n        autoResetPref: PropTypes.string,\n        actions: PropTypes.shape({\n            openModal: PropTypes.func.isRequired,\n            setStatus: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    static defaultProps = {\n        userId: '',\n        profilePicture: '',\n        status: UserStatuses.OFFLINE,\n    }\n\n    isUserOutOfOffice = () => {\n        return this.props.status === UserStatuses.OUT_OF_OFFICE;\n    }\n\n    setStatus = (status) => {\n        this.props.actions.setStatus({\n            user_id: this.props.userId,\n            status,\n        });\n    }\n\n    setOnline = (event) => {\n        event.preventDefault();\n        this.setStatus(UserStatuses.ONLINE);\n    }\n\n    setOffline = (event) => {\n        event.preventDefault();\n        this.setStatus(UserStatuses.OFFLINE);\n    }\n\n    setAway = (event) => {\n        event.preventDefault();\n        this.setStatus(UserStatuses.AWAY);\n    }\n\n    setDnd = (event) => {\n        event.preventDefault();\n        this.setStatus(UserStatuses.DND);\n    }\n\n    showStatusChangeConfirmation = (status) => {\n        const resetStatusModalData = {\n            ModalId: ModalIdentifiers.RESET_STATUS,\n            dialogType: ResetStatusModal,\n            dialogProps: {newStatus: status},\n        };\n\n        this.props.actions.openModal(resetStatusModalData);\n    };\n\n    renderProfilePicture = () => {\n        if (!this.props.profilePicture) {\n            return null;\n        }\n        return (\n            <Avatar\n                size='lg'\n                url={this.props.profilePicture}\n            />\n        );\n    }\n\n    renderDropdownIcon = () => {\n        return (\n            <FormattedMessage\n                id='generic_icons.dropdown'\n                defaultMessage='Dropdown Icon'\n            >\n                { (title) => (\n                    <i\n                        className={'fa fa-caret-down'}\n                        title={title}\n                    />)\n                }\n            </FormattedMessage>\n        );\n    }\n\n    render() {\n        const needsConfirm = this.isUserOutOfOffice() && this.props.autoResetPref === '';\n        const profilePicture = this.renderProfilePicture();\n        const dropdownIcon = this.renderDropdownIcon();\n\n        const setOnline = needsConfirm ? () => this.showStatusChangeConfirmation('online') : this.setOnline;\n        const setDnd = needsConfirm ? () => this.showStatusChangeConfirmation('dnd') : this.setDnd;\n        const setAway = needsConfirm ? () => this.showStatusChangeConfirmation('away') : this.setAway;\n        const setOffline = needsConfirm ? () => this.showStatusChangeConfirmation('offline') : this.setOffline;\n\n        return (\n            <MenuWrapper\n                onToggle={this.onToggle}\n                style={this.props.style}\n            >\n                <div className='status-wrapper status-selector'>\n                    {profilePicture}\n                    <button\n                        className='status style--none'\n                        aria-label={localizeMessage('status_dropdown.menuAriaLabel', 'Set a status')}\n                    >\n                        <StatusIcon\n                            status={this.props.status}\n                            button={true}\n                        />\n                    </button>\n                    <span className={'status status-edit edit'}>\n                        {dropdownIcon}\n                    </span>\n                </div>\n                <Menu\n                    ariaLabel={localizeMessage('status_dropdown.menuAriaLabel', 'Set a status')}\n                    id='statusDropdownMenu'\n                >\n                    <Menu.Group>\n                        <Menu.ItemAction\n                            show={this.isUserOutOfOffice()}\n                            onClick={() => null}\n                            ariaLabel={localizeMessage('status_dropdown.set_ooo', 'Out of office').toLowerCase()}\n                            text={localizeMessage('status_dropdown.set_ooo', 'Out of office')}\n                            extraText={localizeMessage('status_dropdown.set_ooo.extra', 'Automatic Replies are enabled')}\n                        />\n                    </Menu.Group>\n                    <Menu.Group>\n                        <Menu.ItemAction\n                            onClick={setOnline}\n                            ariaLabel={localizeMessage('status_dropdown.set_online', 'Online').toLowerCase()}\n                            text={localizeMessage('status_dropdown.set_online', 'Online')}\n                        />\n                        <Menu.ItemAction\n                            onClick={setAway}\n                            ariaLabel={localizeMessage('status_dropdown.set_away', 'Away').toLowerCase()}\n                            text={localizeMessage('status_dropdown.set_away', 'Away')}\n                        />\n                        <Menu.ItemAction\n                            onClick={setDnd}\n                            ariaLabel={`${localizeMessage('status_dropdown.set_dnd', 'Do not disturb').toLowerCase()}. ${localizeMessage('status_dropdown.set_dnd.extra', 'Disables desktop, email and push notifications').toLowerCase()}`}\n                            text={localizeMessage('status_dropdown.set_dnd', 'Do not disturb')}\n                            extraText={localizeMessage('status_dropdown.set_dnd.extra', 'Disables desktop, email and push notifications')}\n                        />\n                        <Menu.ItemAction\n                            onClick={setOffline}\n                            ariaLabel={localizeMessage('status_dropdown.set_offline', 'Offline').toLowerCase()}\n                            text={localizeMessage('status_dropdown.set_offline', 'Offline')}\n                        />\n                    </Menu.Group>\n                </Menu>\n            </MenuWrapper>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {setStatus} from 'mattermost-redux/actions/users';\nimport {Client4} from 'mattermost-redux/client';\nimport {getCurrentUser, getStatusForUserId} from 'mattermost-redux/selectors/entities/users';\nimport {Preferences} from 'mattermost-redux/constants';\nimport {get} from 'mattermost-redux/selectors/entities/preferences';\n\nimport {openModal} from 'actions/views/modals';\n\nimport StatusDropdown from 'components/status_dropdown/status_dropdown.jsx';\n\nfunction mapStateToProps(state) {\n    const currentUser = getCurrentUser(state);\n\n    if (!currentUser) {\n        return {};\n    }\n\n    const userId = currentUser.id;\n    return {\n        userId,\n        profilePicture: Client4.getProfilePictureUrl(userId, currentUser.last_picture_update),\n        autoResetPref: get(state, Preferences.CATEGORY_AUTO_RESET_MANUAL_STATUS, userId, ''),\n        status: getStatusForUserId(state, userId),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            openModal,\n            setStatus,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(StatusDropdown);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport {localizeMessage} from 'utils/utils.jsx';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport MenuIcon from 'components/widgets/icons/menu_icon';\nimport Constants from 'utils/constants';\n\nimport MenuTutorialTip from 'components/tutorial/menu_tutorial_tip';\n\nexport default class SidebarHeaderDropdownButton extends React.PureComponent {\n    static propTypes = {\n        showTutorialTip: PropTypes.bool.isRequired,\n        teamDescription: PropTypes.string.isRequired,\n        teamId: PropTypes.string.isRequired,\n        currentUser: PropTypes.object.isRequired,\n        teamDisplayName: PropTypes.string.isRequired,\n    };\n\n    render() {\n        const mainMenuToolTip = (\n            <Tooltip id='main-menu__tooltip'>\n                <FormattedMessage\n                    id='sidebar.mainMenu'\n                    defaultMessage='Main menu'\n                />\n            </Tooltip>\n        );\n\n        let tutorialTip = null;\n        if (this.props.showTutorialTip) {\n            tutorialTip = (\n                <MenuTutorialTip onBottom={false}/>\n            );\n        }\n\n        let teamNameWithToolTip = (\n            <h1\n                id='headerTeamName'\n                className='team__name'\n                data-teamid={this.props.teamId}\n            >\n                {this.props.teamDisplayName}\n            </h1>\n        );\n        if (this.props.teamDescription) {\n            teamNameWithToolTip = (\n                <OverlayTrigger\n                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                    placement='bottom'\n                    overlay={<Tooltip id='team-name__tooltip'>{this.props.teamDescription}</Tooltip>}\n                >\n                    {teamNameWithToolTip}\n                </OverlayTrigger>\n            );\n        }\n\n        return (\n            <div\n                className='SidebarHeaderDropdownButton'\n                id='sidebarHeaderDropdownButton'\n            >\n                {tutorialTip}\n                <OverlayTrigger\n                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                    placement='right'\n                    overlay={mainMenuToolTip}\n                >\n                    <div\n                        id='headerInfo'\n                        className='header__info'\n                    >\n                        {teamNameWithToolTip}\n                        <div\n                            id='headerUsername'\n                            className='user__name'\n                        >\n                            {'@' + this.props.currentUser.username}\n                        </div>\n                        <button\n                            className='style--none sidebar-header-dropdown__icon'\n                            aria-label={localizeMessage('navbar_dropdown.menuAriaLabel', 'main menu')}\n                        >\n                            <MenuIcon/>\n                        </button>\n                    </div>\n                </OverlayTrigger>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport * as GlobalActions from 'actions/global_actions.jsx';\nimport {Constants, ModalIdentifiers} from 'utils/constants';\nimport {cmdOrCtrlPressed, isKeyPressed} from 'utils/utils';\n\nimport SidebarHeaderDropdownButton from '../sidebar_header_dropdown_button.jsx';\n\nimport UserSettingsModal from 'components/user_settings/modal';\n\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\n\nimport MainMenu from 'components/main_menu';\n\nexport default class SidebarHeaderDropdown extends React.PureComponent {\n    static propTypes = {\n        teamDescription: PropTypes.string.isRequired,\n        teamDisplayName: PropTypes.string.isRequired,\n        teamId: PropTypes.string.isRequired,\n        currentUser: PropTypes.object,\n        showTutorialTip: PropTypes.bool.isRequired,\n        actions: PropTypes.shape({\n            openModal: PropTypes.func.isRequred,\n        }).isRequired,\n    };\n\n    static defaultProps = {\n        teamType: '',\n        pluginMenuItems: [],\n    };\n\n    toggleShortcutsModal = (e) => {\n        e.preventDefault();\n        GlobalActions.toggleShortcutsModal();\n    }\n\n    componentDidMount() {\n        document.addEventListener('keydown', this.handleKeyDown);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleKeyDown);\n    }\n\n    handleKeyDown = (e) => {\n        if (cmdOrCtrlPressed(e) && e.shiftKey && isKeyPressed(e, Constants.KeyCodes.A)) {\n            this.props.actions.openModal({ModalId: ModalIdentifiers.USER_SETTINGS, dialogType: UserSettingsModal});\n        }\n    }\n\n    handleEmitUserLoggedOutEvent = () => {\n        GlobalActions.emitUserLoggedOutEvent();\n    }\n\n    render() {\n        const currentUser = this.props.currentUser;\n\n        if (!currentUser) {\n            return null;\n        }\n\n        return (\n            <MenuWrapper>\n                <SidebarHeaderDropdownButton\n                    showTutorialTip={this.props.showTutorialTip}\n                    teamDescription={this.props.teamDescription}\n                    currentUser={this.props.currentUser}\n                    teamDisplayName={this.props.teamDisplayName}\n                    teamId={this.props.teamId}\n                />\n                <MainMenu id='sidebarDropdownMenu'/>\n            </MenuWrapper>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\nimport {getInt} from 'mattermost-redux/selectors/entities/preferences';\n\nimport {openModal} from 'actions/views/modals';\n\nimport {Preferences, TutorialSteps} from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\n\nimport SidebarHeaderDropdown from './sidebar_header_dropdown.jsx';\n\nfunction mapStateToProps(state) {\n    const currentTeam = getCurrentTeam(state);\n    const currentUser = getCurrentUser(state);\n    const showTutorialTip = getInt(state, Preferences.TUTORIAL_STEP, currentUser.id) === TutorialSteps.MENU_POPOVER && !Utils.isMobile();\n    return {\n        currentUser,\n        teamDescription: currentTeam.description,\n        teamDisplayName: currentTeam.display_name,\n        teamId: currentTeam.id,\n        showTutorialTip,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            openModal,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SidebarHeaderDropdown);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport * as Utils from 'utils/utils.jsx';\nimport StatusDropdown from 'components/status_dropdown/index.jsx';\n\nimport SidebarHeaderDropdown from './dropdown';\n\nexport default class SidebarHeader extends React.PureComponent {\n    constructor(props) {\n        super(props);\n        this.state = {\n            isMobile: Utils.isMobile(),\n        };\n    }\n\n    componentDidMount() {\n        window.addEventListener('resize', this.handleResize);\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.handleResize);\n    }\n\n    handleResize = () => {\n        const isMobile = Utils.isMobile();\n        this.setState({isMobile});\n    }\n\n    render() {\n        const ariaLabel = Utils.localizeMessage('accessibility.sections.lhsHeader', 'team menu region');\n\n        return (\n            <div\n                id='lhsHeader'\n                aria-label={ariaLabel}\n                tabIndex='-1'\n                role='application'\n                className='SidebarHeader team__header theme a11y__region'\n                data-a11y-sort-order='5'\n            >\n                <div\n                    className='d-flex'\n                >\n                    {!this.state.isMobile && <StatusDropdown/>}\n                    <SidebarHeaderDropdown/>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\nimport {getInt} from 'mattermost-redux/selectors/entities/preferences';\n\nimport {Preferences, TutorialSteps} from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\n\nimport SidebarHeader from './sidebar_header.jsx';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n    const currentUser = getCurrentUser(state);\n\n    const enableTutorial = config.EnableTutorial === 'true';\n\n    const showTutorialTip = getInt(state, Preferences.TUTORIAL_STEP, currentUser.id) === TutorialSteps.MENU_POPOVER && !Utils.isMobile();\n\n    return {\n        enableTutorial,\n        showTutorialTip,\n    };\n}\n\nexport default connect(mapStateToProps)(SidebarHeader);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class BotIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.bot'\n                    defaultMessage='Bot Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='16'\n                            height='13'\n                            viewBox='0 0 36 30'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path d='M0,15.7391304 L0,23.0434783 C0,24.0535326 0.786888587,24.8695652 1.76086957,24.8695652 L3.52173913,24.8695652 L3.52173913,13.9130435 L1.76086957,13.9130435 C0.786888587,13.9130435 0,14.7290761 0,15.7391304 Z M26.0496894,6.50271739 L19.7888199,6.50271739 L19.7888199,2.83423913 C19.7888199,1.81967561 18.989441,1 18,1 C17.010559,1 16.2111801,1.81967561 16.2111801,2.83423913 L16.2111801,6.50271739 L9.95031056,6.50271739 C7.47950311,6.50271739 5.47826087,8.55477242 5.47826087,11.0883152 L5.47826087,26.6793478 C5.47826087,28.7027429 7.0826087,30.3478261 9.05590062,30.3478261 L26.9440994,30.3478261 C28.9173913,30.3478261 30.5217391,28.7027429 30.5217391,26.6793478 L30.5217391,11.0883152 C30.5217391,8.55477242 28.5204969,6.50271739 26.0496894,6.50271739 Z M14.4782609,24.8695652 L10.9565217,24.8695652 L10.9565217,22.9130435 L14.4782609,22.9130435 L14.4782609,24.8695652 Z M12.5217391,17.826087 C11.2245652,17.826087 10.173913,16.7754348 10.173913,15.4782609 C10.173913,14.181087 11.2245652,13.1304348 12.5217391,13.1304348 C13.818913,13.1304348 14.8695652,14.181087 14.8695652,15.4782609 C14.8695652,16.7754348 13.818913,17.826087 12.5217391,17.826087 Z M19.9565217,24.8695652 L16.4347826,24.8695652 L16.4347826,22.9130435 L19.9565217,22.9130435 L19.9565217,24.8695652 Z M25.0434783,24.8695652 L21.5217391,24.8695652 L21.5217391,22.9130435 L25.0434783,22.9130435 L25.0434783,24.8695652 Z M23.2826087,17.826087 C22.0935326,17.826087 21.1304348,16.7754348 21.1304348,15.4782609 C21.1304348,14.181087 22.0935326,13.1304348 23.2826087,13.1304348 C24.4716848,13.1304348 25.4347826,14.181087 25.4347826,15.4782609 C25.4347826,16.7754348 24.4716848,17.826087 23.2826087,17.826087 Z M34.2391304,13.9130435 L32.4782609,13.9130435 L32.4782609,24.8695652 L34.2391304,24.8695652 C35.2131114,24.8695652 36,24.0535326 36,23.0434783 L36,15.7391304 C36,14.7290761 35.2131114,13.9130435 34.2391304,13.9130435 Z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport Svg from 'react-inlinesvg';\n\nimport {Constants} from 'utils/constants';\n\nimport ArchiveIcon from 'components/widgets/icons/archive_icon';\nimport DraftIcon from 'components/widgets/icons/draft_icon';\nimport GlobeIcon from 'components/widgets/icons/globe_icon';\nimport LockIcon from 'components/widgets/icons/lock_icon';\nimport StatusIcon from 'components/status_icon.jsx';\nimport BotIcon from 'components/widgets/icons/bot_icon.jsx';\n\nexport default class SidebarChannelButtonOrLinkIcon extends React.PureComponent {\n    static propTypes = {\n        botIconUrl: PropTypes.string,\n        channelIsArchived: PropTypes.bool.isRequired,\n        channelType: PropTypes.string.isRequired,\n        channelStatus: PropTypes.string,\n        hasDraft: PropTypes.bool.isRequired,\n        membersCount: PropTypes.number,\n        teammateId: PropTypes.string,\n        teammateDeletedAt: PropTypes.number,\n        teammateIsBot: PropTypes.bool,\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            svgErrorUrl: null,\n        };\n    }\n\n    onSvgLoadError = () => {\n        this.setState({\n            svgErrorUrl: this.props.botIconUrl,\n        });\n    }\n\n    onSvgLoad = () => {\n        this.setState({\n            svgErrorUrl: null,\n        });\n    }\n\n    render() {\n        let icon = null;\n        if (this.props.channelIsArchived) {\n            icon = (\n                <ArchiveIcon className='icon icon__archive'/>\n            );\n        } else if (this.props.hasDraft) {\n            icon = (\n                <DraftIcon className='icon icon__draft'/>\n            );\n        } else if (this.props.channelType === Constants.OPEN_CHANNEL) {\n            icon = (\n                <GlobeIcon className='icon icon__globe'/>\n            );\n        } else if (this.props.channelType === Constants.PRIVATE_CHANNEL) {\n            icon = (\n                <LockIcon className='icon icon__lock'/>\n            );\n        } else if (this.props.channelType === Constants.GM_CHANNEL) {\n            icon = <div className='status status--group'>{this.props.membersCount}</div>;\n        } else if (this.props.channelType === Constants.DM_CHANNEL) {\n            if (this.props.teammateId && this.props.teammateDeletedAt) {\n                icon = (\n                    <ArchiveIcon className='icon icon__archive'/>\n                );\n            } else if (this.props.teammateId && this.props.teammateIsBot) {\n                // Use default bot icon\n                icon = (<BotIcon className='icon icon__bot'/>);\n\n                // Attempt to display custom icon if botIconUrl has changed\n                // or if there was no error when loading custom svg\n                if (this.props.botIconUrl &&\n                    this.props.botIconUrl !== this.state.svgErrorUrl) {\n                    icon = (\n                        <Svg\n                            className='icon icon__bot'\n                            src={this.props.botIconUrl}\n                            onLoad={this.onSvgLoad}\n                            onError={this.onSvgLoadError}\n                        />\n                    );\n                }\n            } else {\n                icon = (\n                    <StatusIcon\n                        type='avatar'\n                        status={this.props.channelStatus}\n                    />\n                );\n            }\n        }\n        return icon;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\nimport PropTypes from 'prop-types';\n\nimport OverlayTrigger from 'components/overlay_trigger';\n\nimport {Constants} from 'utils/constants';\n\nexport default class SidebarChannelButtonOrLinkCloseButton extends React.PureComponent {\n    static propTypes = {\n        handleClose: PropTypes.func,\n        channelId: PropTypes.string.isRequired,\n        channelType: PropTypes.string.isRequired,\n        teammateId: PropTypes.string,\n        badge: PropTypes.bool,\n    }\n\n    handleClose = (e) => {\n        e.stopPropagation();\n        e.preventDefault();\n        this.props.handleClose();\n    }\n\n    render() {\n        let closeButton = null;\n\n        if (this.props.handleClose && !this.props.badge) {\n            let removeTooltip = (\n                <Tooltip id='remove-dm-tooltip'>\n                    <FormattedMessage\n                        id='sidebar.removeList'\n                        defaultMessage='Remove from list'\n                    />\n                </Tooltip>\n            );\n\n            if (this.props.channelType === Constants.OPEN_CHANNEL || this.props.channelType === Constants.PRIVATE_CHANNEL) {\n                removeTooltip = (\n                    <Tooltip id='remove-dm-tooltip'>\n                        <FormattedMessage\n                            id='sidebar.leave'\n                            defaultMessage='Leave channel'\n                        />\n                    </Tooltip>\n                );\n            }\n\n            closeButton = (\n                <OverlayTrigger\n                    delayShow={1000}\n                    placement='top'\n                    overlay={removeTooltip}\n                >\n                    <span\n                        onClick={this.handleClose}\n                        className='btn-close'\n                    >\n                        {''}\n                    </span>\n                </OverlayTrigger>\n            );\n        }\n        return closeButton;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {Link} from 'react-router-dom';\nimport {Tooltip} from 'react-bootstrap';\n\nimport {localizeMessage} from 'utils/utils.jsx';\nimport {browserHistory} from 'utils/browser_history';\nimport {mark, trackEvent} from 'actions/diagnostics_actions.jsx';\nimport {isDesktopApp} from 'utils/user_agent';\nimport Constants from 'utils/constants';\nimport CopyUrlContextMenu from 'components/copy_url_context_menu';\nimport OverlayTrigger from 'components/overlay_trigger';\n\nimport SidebarChannelButtonOrLinkIcon from './sidebar_channel_button_or_link_icon.jsx';\nimport SidebarChannelButtonOrLinkCloseButton from './sidebar_channel_button_or_link_close_button.jsx';\n\nexport default class SidebarChannelButtonOrLink extends React.PureComponent {\n    static propTypes = {\n        link: PropTypes.string.isRequired,\n        rowClass: PropTypes.string.isRequired,\n        channelType: PropTypes.string.isRequired,\n        channelId: PropTypes.string.isRequired,\n        channelName: PropTypes.string.isRequired,\n        displayName: PropTypes.string.isRequired,\n        botIconUrl: PropTypes.string,\n        channelStatus: PropTypes.string,\n        handleClose: PropTypes.func,\n        hasDraft: PropTypes.bool.isRequired,\n        badge: PropTypes.bool,\n        membersCount: PropTypes.number.isRequired,\n        showUnreadForMsgs: PropTypes.bool.isRequired,\n        unreadMsgs: PropTypes.number.isRequired,\n        unreadMentions: PropTypes.number.isRequired,\n        teammateId: PropTypes.string,\n        teammateDeletedAt: PropTypes.number,\n        teammateIsBot: PropTypes.bool,\n        channelIsArchived: PropTypes.bool.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n        this.gmItemRef = React.createRef();\n        this.displayNameRef = React.createRef();\n    }\n\n    state = {\n        showTooltip: false,\n    }\n\n    componentDidMount() {\n        this.enableToolTipIfNeeded();\n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.displayName !== this.props.displayName) {\n            this.enableToolTipIfNeeded();\n        }\n    }\n\n    enableToolTipIfNeeded = () => {\n        const element = this.displayNameRef.current;\n        if (element && element.offsetWidth < element.scrollWidth) {\n            this.setState({showTooltip: true});\n        } else {\n            this.setState({showTooltip: false});\n        }\n    }\n\n    trackChannelSelectedEvent = () => {\n        mark('SidebarChannelLink#click');\n        trackEvent('ui', 'ui_channel_selected');\n    }\n\n    handleClick = () => {\n        this.trackChannelSelectedEvent();\n        browserHistory.push(this.props.link);\n    }\n\n    removeTooltipLink = () => {\n        // Bootstrap adds the attr dynamically, removing it to prevent a11y readout\n        this.gmItemRef.current.removeAttribute('aria-describedby');\n    }\n\n    render = () => {\n        let badge = null;\n        if (this.props.badge) {\n            badge = (\n                <span\n                    id='unreadMentions'\n                    className='badge'\n                >\n                    {this.props.unreadMentions}\n                </span>\n            );\n        }\n\n        const content = (\n            <React.Fragment>\n                <SidebarChannelButtonOrLinkIcon\n                    channelStatus={this.props.channelStatus}\n                    channelType={this.props.channelType}\n                    botIconUrl={this.props.botIconUrl}\n                    channelIsArchived={this.props.channelIsArchived}\n                    hasDraft={this.props.hasDraft}\n                    membersCount={this.props.membersCount}\n                    teammateId={this.props.teammateId}\n                    teammateDeletedAt={this.props.teammateDeletedAt}\n                    teammateIsBot={this.props.teammateIsBot}\n                />\n                <span className='sidebar-item__name'>\n                    <span ref={this.displayNameRef}>\n                        {this.props.displayName}\n                    </span>\n                </span>\n                {badge}\n                <SidebarChannelButtonOrLinkCloseButton\n                    handleClose={this.props.handleClose}\n                    channelId={this.props.channelId}\n                    channelType={this.props.channelType}\n                    teammateId={this.props.teammateId}\n                    badge={this.props.badge}\n                />\n            </React.Fragment>\n        );\n\n        let element;\n        let ariaLabel = this.props.displayName;\n\n        if (this.props.channelType === Constants.OPEN_CHANNEL) {\n            ariaLabel += ` ${localizeMessage('accessibility.sidebar.types.public', 'public channel')}`;\n        } else if (this.props.channelType === Constants.PRIVATE_CHANNEL) {\n            ariaLabel += ` ${localizeMessage('accessibility.sidebar.types.private', 'private channel')}`;\n        }\n\n        if (this.props.unreadMentions === 1) {\n            ariaLabel += ` ${this.props.unreadMentions} ${localizeMessage('accessibility.sidebar.types.mention', 'mention')}`;\n        } else if (this.props.unreadMentions > 1) {\n            ariaLabel += ` ${this.props.unreadMentions} ${localizeMessage('accessibility.sidebar.types.mentions', 'mentions')}`;\n        }\n\n        if (this.props.unreadMsgs > 0 && this.props.showUnreadForMsgs && this.props.unreadMentions === 0) {\n            ariaLabel += ` ${localizeMessage('accessibility.sidebar.types.unread', 'unread')}`;\n        }\n\n        ariaLabel = ariaLabel.toLowerCase();\n\n        if (isDesktopApp()) {\n            element = (\n                <div>\n                    <CopyUrlContextMenu\n                        link={this.props.link}\n                        menuId={this.props.channelId}\n                    >\n                        <button\n                            className={'btn btn-link ' + this.props.rowClass}\n                            aria-label={ariaLabel}\n                            onClick={this.handleClick}\n                        >\n                            {content}\n                        </button>\n                    </CopyUrlContextMenu>\n                </div>\n            );\n        } else {\n            element = (\n                <Link\n                    id={`sidebarItem_${this.props.channelName}`}\n                    aria-label={ariaLabel}\n                    to={this.props.link}\n                    className={this.props.rowClass}\n                    onClick={this.trackChannelSelectedEvent}\n                >\n                    {content}\n                </Link>\n            );\n        }\n\n        if (this.state.showTooltip) {\n            const displayNameToolTip = (\n                <Tooltip\n                    id='channel-displayname__tooltip'\n                    style={style.channelTooltip}\n                >\n                    {this.props.displayName}\n                </Tooltip>\n            );\n            element = (\n                <OverlayTrigger\n                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                    placement='top'\n                    overlay={displayNameToolTip}\n                    onEntering={this.removeTooltipLink}\n                >\n                    <div ref={this.gmItemRef}>\n                        {element}\n                    </div>\n                </OverlayTrigger>\n            );\n        }\n        return element;\n    }\n}\n\nconst style = {\n    channelTooltip: {\n        paddingLeft: '8px',\n        maxWidth: '228px'},\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {FormattedMessage} from 'react-intl';\n\nimport {Constants} from 'utils/constants';\nimport TutorialTip from 'components/tutorial/tutorial_tip';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message.jsx';\n\nexport default class SidebarTutorialTip extends React.PureComponent {\n    static propTypes = {\n        townSquareDisplayName: PropTypes.string,\n        offTopicDisplayName: PropTypes.string,\n        openLhs: PropTypes.func\n    }\n\n    componentDidMount() {\n        if (this.props.townSquareDisplayName || this.props.offTopicDisplayName) {\n            this.props.openLhs();\n        }\n    }\n\n    render = () => {\n        const screens = [];\n\n        let townSquareDisplayName = Constants.DEFAULT_CHANNEL_UI_NAME;\n        if (this.props.townSquareDisplayName) {\n            townSquareDisplayName = this.props.townSquareDisplayName;\n        }\n\n        let offTopicDisplayName = Constants.OFFTOPIC_CHANNEL_UI_NAME;\n        if (this.props.offTopicDisplayName) {\n            offTopicDisplayName = this.props.offTopicDisplayName;\n        }\n\n        screens.push(\n            <div>\n                <h4>\n                    <FormattedMessage\n                        id='sidebar.tutorialScreen1.title'\n                        defaultMessage='Channels'\n                    />\n                </h4>\n                <p>\n                    <FormattedMarkdownMessage\n                        id='sidebar.tutorialScreen1.body'\n                        defaultMessage={'**Channels** organize conversations across different topics. They\\'re open to everyone on your team. To send private communications use **Direct Messages** for a single person or **Private Channels** for multiple people.'}\n                    />\n                </p>\n            </div>\n        );\n\n        screens.push(\n            <div>\n                <h4>\n                    <FormattedMessage\n                        id='sidebar.tutorialScreen2.title'\n                        defaultMessage='\"{townsquare}\" and \"{offtopic}\" channels'\n                        values={{\n                            townsquare: townSquareDisplayName,\n                            offtopic: offTopicDisplayName,\n                        }}\n                    />\n                </h4>\n                <p>\n                    <FormattedMessage\n                        id='sidebar.tutorialScreen2.body1'\n                        defaultMessage='Here are two public channels to start:'\n                    />\n                </p>\n                <p>\n                    <FormattedMarkdownMessage\n                        id='sidebar.tutorialScreen2.body2'\n                        defaultMessage='**{townsquare}** is a place for team-wide communication. Everyone in your team is a member of this channel.'\n                        values={{\n                            townsquare: townSquareDisplayName,\n                        }}\n                    />\n                </p>\n                <p>\n                    <FormattedMarkdownMessage\n                        id='sidebar.tutorialScreen2.body3'\n                        defaultMessage='**{offtopic}** is a place for fun and humor outside of work-related channels. You and your team can decide what other channels to create.'\n                        values={{\n                            offtopic: offTopicDisplayName,\n                        }}\n                    />\n                </p>\n            </div>\n        );\n\n        screens.push(\n            <div>\n                <h4>\n                    <FormattedMessage\n                        id='sidebar.tutorialScreen3.title'\n                        defaultMessage='Creating and Joining Channels'\n                    />\n                </h4>\n                <p>\n                    <FormattedMarkdownMessage\n                        id='sidebar.tutorialScreen3.body1'\n                        defaultMessage='Click **\"More...\"** to create a new channel or join an existing one.'\n                    />\n                </p>\n                <p>\n                    <FormattedMarkdownMessage\n                        id='sidebar.tutorialScreen3.body2'\n                        defaultMessage='You can also create a new channel by clicking the **\"+\" symbol** next to the public or private channel header.'\n                    />\n                </p>\n            </div>\n        );\n\n        return (\n            <TutorialTip\n                placement='right'\n                screens={screens}\n                overlayClass='tip-overlay--sidebar'\n                diagnosticsTag='tutorial_tip_2_channels'\n            />\n        );\n    }\n}\n\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {injectIntl} from 'react-intl';\n\nimport {browserHistory} from 'utils/browser_history';\nimport {Constants} from 'utils/constants';\nimport {intlShape} from 'utils/react_intl';\nimport {trackEvent} from 'actions/diagnostics_actions.jsx';\nimport * as GlobalActions from 'actions/global_actions.jsx';\nimport SidebarChannelButtonOrLink from '../sidebar_channel_button_or_link/sidebar_channel_button_or_link.jsx';\nimport SidebarTutorialTip from '../sidebar_tutorial_tip.jsx';\n\nclass SidebarChannel extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * Global config object\n         */\n        config: PropTypes.object.isRequired,\n\n        /**\n         * Channel id\n         */\n        channelId: PropTypes.string.isRequired,\n\n        /**\n         * Channel name\n         */\n        channelName: PropTypes.string.isRequired,\n\n        /**\n         * Channel display name\n         */\n        channelDisplayName: PropTypes.string.isRequired,\n\n        /**\n         * LHS bot icon image url\n         */\n        botIconUrl: PropTypes.string,\n\n        /**\n         * Channel is muted\n         */\n        channelMuted: PropTypes.bool,\n\n        /**\n         * Channel type\n         */\n        channelType: PropTypes.string.isRequired,\n\n        /**\n         * Channel status\n         */\n        channelStatus: PropTypes.string,\n\n        /**\n         * Channel is fake\n         */\n        channelFake: PropTypes.bool,\n\n        /**\n         * Serialized channel information (for fake channels)\n         */\n        channelStringified: PropTypes.string,\n\n        /**\n         * Teammate id (for direct messages)\n         */\n        channelTeammateId: PropTypes.string,\n\n        /**\n         * Teammate username (for direct messages)\n         */\n        channelTeammateUsername: PropTypes.string,\n\n        /**\n         * Teammate delete at date (for direct messages)\n         */\n        channelTeammateDeletedAt: PropTypes.number,\n\n        /**\n         * Teammate is_bot (for direct messages)\n         */\n        channelTeammateIsBot: PropTypes.bool,\n\n        /**\n         * Whether the channel contains a draft in the center channel\n         */\n        hasDraft: PropTypes.bool.isRequired,\n\n        intl: intlShape.isRequired,\n\n        /**\n         * Whether or not to mark the channel as unread when it has unread messages and no mentions\n         */\n        showUnreadForMsgs: PropTypes.bool.isRequired,\n\n        /**\n         * Number of unread messages\n         */\n        unreadMsgs: PropTypes.number.isRequired,\n\n        /**\n         * Number of unread mentions\n         */\n        unreadMentions: PropTypes.number.isRequired,\n\n        /**\n         * Set if the channel is the current active channel\n         */\n        active: PropTypes.bool.isRequired,\n\n        /**\n         * Current team name\n         */\n        currentTeamName: PropTypes.string.isRequired,\n\n        /**\n         * Current user id\n         */\n        currentUserId: PropTypes.string.isRequired,\n\n        /**\n         * Set if the tutorial must be shown\n         */\n        showTutorialTip: PropTypes.bool.isRequired,\n\n        /**\n         * TownSquare (default channel) display name\n         */\n        townSquareDisplayName: PropTypes.string,\n\n        /**\n         * OffTopic (default channel) display name\n         */\n        offTopicDisplayName: PropTypes.string,\n\n        /**\n         * Number of members\n         */\n        membersCount: PropTypes.number.isRequired,\n\n        /**\n         * Flag if channel should be hidden in sidebar\n         */\n        shouldHideChannel: PropTypes.bool.isRequired,\n\n        channelIsArchived: PropTypes.bool.isRequired,\n\n        redirectChannel: PropTypes.string.isRequired,\n\n        actions: PropTypes.shape({\n            savePreferences: PropTypes.func.isRequired,\n            leaveChannel: PropTypes.func.isRequired,\n            openLhs: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    isLeaving = false;\n\n    handleLeavePublicChannel = () => {\n        this.props.actions.leaveChannel(this.props.channelId);\n        trackEvent('ui', 'ui_public_channel_x_button_clicked');\n    }\n\n    handleLeavePrivateChannel = () => {\n        GlobalActions.showLeavePrivateChannelModal({id: this.props.channelId, display_name: this.props.channelDisplayName});\n        trackEvent('ui', 'ui_private_channel_x_button_clicked');\n    }\n\n    handleLeaveDirectChannel = () => {\n        if (!this.isLeaving) {\n            this.isLeaving = true;\n\n            let id;\n            let category;\n            if (this.props.channelType === Constants.DM_CHANNEL) {\n                id = this.props.channelTeammateId;\n                category = Constants.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW;\n            } else {\n                id = this.props.channelId;\n                category = Constants.Preferences.CATEGORY_GROUP_CHANNEL_SHOW;\n            }\n\n            const currentUserId = this.props.currentUserId;\n            this.props.actions.savePreferences(currentUserId, [{user_id: currentUserId, category, name: id, value: 'false'}]).then(\n                () => {\n                    this.isLeaving = false;\n                }\n            );\n\n            trackEvent('ui', 'ui_direct_channel_x_button_clicked');\n        }\n\n        if (this.props.active) {\n            browserHistory.push(`/${this.props.currentTeamName}/channels/${this.props.redirectChannel}`);\n        }\n    }\n\n    showChannelAsUnread = () => {\n        return this.props.unreadMentions > 0 || (this.props.unreadMsgs > 0 && this.props.showUnreadForMsgs);\n    };\n\n    render = () => {\n        if (this.props.channelIsArchived && !this.props.active) {\n            return null;\n        }\n        if (!this.props.channelDisplayName || !this.props.channelType) {\n            return (<div/>);\n        }\n\n        let closeHandler = null;\n        if (!this.showChannelAsUnread()) {\n            if (this.props.shouldHideChannel) {\n                return '';\n            }\n            if (this.props.channelType === Constants.DM_CHANNEL || this.props.channelType === Constants.GM_CHANNEL) {\n                closeHandler = this.handleLeaveDirectChannel;\n            } else if (this.props.config.EnableXToLeaveChannelsFromLHS === 'true') {\n                if (this.props.channelType === Constants.OPEN_CHANNEL && this.props.channelName !== Constants.DEFAULT_CHANNEL) {\n                    closeHandler = this.handleLeavePublicChannel;\n                } else if (this.props.channelType === Constants.PRIVATE_CHANNEL) {\n                    closeHandler = this.handleLeavePrivateChannel;\n                }\n            }\n        }\n\n        let linkClass = '';\n        if (this.props.active) {\n            linkClass = 'active';\n        }\n\n        let rowClass = 'sidebar-item';\n        let badge = false;\n        if (this.showChannelAsUnread()) {\n            rowClass += ' unread-title';\n        }\n\n        if (this.props.unreadMentions > 0) {\n            rowClass += ' has-badge';\n\n            badge = true;\n        }\n\n        if (this.props.channelMuted) {\n            rowClass += ' muted';\n        }\n\n        if (closeHandler && !badge) {\n            rowClass += ' has-close';\n        }\n\n        let tutorialTip = null;\n        if (this.props.showTutorialTip && this.props.channelName === Constants.DEFAULT_CHANNEL) {\n            tutorialTip = (\n                <SidebarTutorialTip\n                    townSquareDisplayName={this.props.townSquareDisplayName}\n                    offTopicDisplayName={this.props.offTopicDisplayName}\n                    openLhs={this.props.actions.openLhs}\n                />\n            );\n        }\n\n        let link = '';\n        if (this.props.channelFake) {\n            link = `/${this.props.currentTeamName}/channels/${this.props.channelName}?fakechannel=${encodeURIComponent(this.props.channelStringified)}`;\n        } else if (this.props.channelType === Constants.DM_CHANNEL) {\n            link = `/${this.props.currentTeamName}/messages/@${this.props.channelTeammateUsername}`;\n        } else if (this.props.channelType === Constants.GM_CHANNEL) {\n            link = `/${this.props.currentTeamName}/messages/${this.props.channelName}`;\n        } else {\n            link = `/${this.props.currentTeamName}/channels/${this.props.channelName}`;\n        }\n\n        let displayName = '';\n        if (this.props.currentUserId === this.props.channelTeammateId) {\n            displayName = this.props.intl.formatMessage({\n                id: 'sidebar.directchannel.you',\n                defaultMessage: '{displayname} (you)',\n            }, {\n                displayname: this.props.channelDisplayName,\n            });\n        } else {\n            displayName = this.props.channelDisplayName;\n        }\n\n        return (\n            <li\n                key={this.props.channelName}\n                ref={'channel'}\n                className={linkClass}\n            >\n                <SidebarChannelButtonOrLink\n                    link={link}\n                    rowClass={rowClass}\n                    channelId={this.props.channelId}\n                    channelName={this.props.channelName}\n                    botIconUrl={this.props.botIconUrl}\n                    channelStatus={this.props.channelStatus}\n                    channelType={this.props.channelType}\n                    displayName={displayName}\n                    handleClose={closeHandler}\n                    hasDraft={this.props.hasDraft}\n                    badge={badge}\n                    showUnreadForMsgs={this.props.showUnreadForMsgs}\n                    unreadMentions={this.props.unreadMentions}\n                    unreadMsgs={this.props.unreadMsgs}\n                    membersCount={this.props.membersCount}\n                    teammateId={this.props.channelTeammateId}\n                    teammateDeletedAt={this.props.channelTeammateDeletedAt}\n                    teammateIsBot={this.props.channelTeammateIsBot}\n                    channelIsArchived={this.props.channelIsArchived}\n                />\n                {tutorialTip}\n            </li>\n        );\n    }\n}\n\nconst wrappedComponent = injectIntl(SidebarChannel, {forwardRef: true});\nwrappedComponent.displayName = 'injectIntl(SidebarChannel)';\nexport default wrappedComponent;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {Client4} from 'mattermost-redux/client';\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\n\nimport {\n    getCurrentChannelId,\n    getChannelsNameMapInCurrentTeam,\n    makeGetChannel,\n    shouldHideDefaultChannel,\n    getRedirectChannelNameForTeam,\n} from 'mattermost-redux/selectors/entities/channels';\nimport {getMyChannelMemberships} from 'mattermost-redux/selectors/entities/common';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {getUserIdsInChannels, getUser} from 'mattermost-redux/selectors/entities/users';\nimport {getInt, getTeammateNameDisplaySetting} from 'mattermost-redux/selectors/entities/preferences';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {isChannelMuted, isFavoriteChannel} from 'mattermost-redux/utils/channel_utils';\n\nimport {displayUsername} from 'mattermost-redux/utils/user_utils';\n\nimport {Constants, NotificationLevels, StoragePrefixes} from 'utils/constants';\n\nimport {leaveChannel} from 'actions/views/channel';\nimport {open as openLhs} from 'actions/views/lhs.js';\nimport {getPostDraft} from 'selectors/rhs';\n\nimport SidebarChannel from './sidebar_channel.jsx';\n\nfunction makeMapStateToProps() {\n    const getChannel = makeGetChannel();\n\n    return (state, ownProps) => {\n        const channelId = ownProps.channelId;\n\n        const config = getConfig(state);\n        const currentChannelId = getCurrentChannelId(state);\n        const channel = getChannel(state, {id: channelId}) || {};\n        const draft = channel.id ? getPostDraft(state, StoragePrefixes.DRAFT, channel.id) : false;\n\n        const enableTutorial = config.EnableTutorial === 'true';\n        const tutorialStep = getInt(state, Constants.Preferences.TUTORIAL_STEP, ownProps.currentUserId, Constants.TutorialSteps.FINISHED);\n        const channelsByName = getChannelsNameMapInCurrentTeam(state);\n        const memberIds = getUserIdsInChannels(state);\n\n        let membersCount = 0;\n        if (memberIds && memberIds[channel.id]) {\n            membersCount = memberIds[channel.id].size;\n            if (memberIds[channel.id].has(ownProps.currentUserId)) {\n                membersCount--;\n            }\n        }\n\n        const member = getMyChannelMemberships(state)[channelId];\n\n        let unreadMentions = 0;\n        let unreadMsgs = 0;\n        let showUnreadForMsgs = true;\n        if (member) {\n            unreadMentions = member.mention_count;\n\n            if (channel) {\n                unreadMsgs = Math.max(channel.total_msg_count - member.msg_count, 0);\n            }\n\n            if (member.notify_props) {\n                showUnreadForMsgs = member.notify_props.mark_unread !== NotificationLevels.MENTION;\n            }\n        }\n\n        const teammateNameDisplay = getTeammateNameDisplaySetting(state);\n        let teammate = null;\n        let channelTeammateId = '';\n        let channelTeammateDeletedAt = 0;\n        let channelTeammateUsername = '';\n        let channelTeammateIsBot = false;\n        let botLastIconUpdate = 0;\n        let channelDisplayName = channel.display_name;\n        let botIconUrl = null;\n        if (channel.type === Constants.DM_CHANNEL) {\n            teammate = getUser(state, channel.teammate_id);\n            if (teammate) {\n                channelTeammateId = teammate.id;\n                channelTeammateDeletedAt = teammate.delete_at;\n                channelTeammateUsername = teammate.username;\n                channelTeammateIsBot = teammate.is_bot;\n                botLastIconUpdate = teammate.bot_last_icon_update;\n                botLastIconUpdate = (typeof botLastIconUpdate === 'undefined') ? 0 : botLastIconUpdate;\n            }\n            if (channelTeammateIsBot) {\n                if (botLastIconUpdate !== 0) {\n                    botIconUrl = botIconImageUrl(teammate);\n                }\n            }\n            channelDisplayName = displayUsername(teammate, teammateNameDisplay, false);\n        }\n\n        let shouldHideChannel = false;\n        if (\n            channel.name === Constants.DEFAULT_CHANNEL &&\n            !ownProps.active &&\n            shouldHideDefaultChannel(state, channel) &&\n            !isFavoriteChannel(state.entities.preferences.myPreferences, channel.id)\n        ) {\n            shouldHideChannel = true;\n        }\n\n        return {\n            config,\n            channelId,\n            channelName: channel.name,\n            channelDisplayName,\n            botIconUrl,\n            channelType: channel.type,\n            channelStatus: channel.status,\n            channelFake: channel.fake,\n            channelMuted: isChannelMuted(member),\n            channelStringified: channel.fake && JSON.stringify(channel),\n            channelTeammateId,\n            channelTeammateUsername,\n            channelTeammateDeletedAt,\n            channelTeammateIsBot,\n            hasDraft: draft && Boolean(draft.message.trim() || draft.fileInfos.length || draft.uploadsInProgress.length) && currentChannelId !== channel.id,\n            showTutorialTip: enableTutorial && tutorialStep === Constants.TutorialSteps.CHANNEL_POPOVER,\n            townSquareDisplayName: channelsByName[Constants.DEFAULT_CHANNEL] && channelsByName[Constants.DEFAULT_CHANNEL].display_name,\n            offTopicDisplayName: channelsByName[Constants.OFFTOPIC_CHANNEL] && channelsByName[Constants.OFFTOPIC_CHANNEL].display_name,\n            showUnreadForMsgs,\n            unreadMsgs,\n            unreadMentions,\n            membersCount,\n            shouldHideChannel,\n            channelIsArchived: channel.delete_at !== 0,\n            redirectChannel: getRedirectChannelNameForTeam(state, getCurrentTeamId(state)),\n        };\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            savePreferences,\n            leaveChannel,\n            openLhs,\n        }, dispatch),\n    };\n}\n\n/**\n * Gets the LHS bot icon url for a given botUser.\n */\nfunction botIconImageUrl(botUser) {\n    return `${Client4.getBotRoute(botUser.id)}/icon?_=${(botUser.bot_last_icon_update || 0)}`;\n}\n\nexport default connect(makeMapStateToProps, mapDispatchToProps, null, {withRef: true})(SidebarChannel);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\nimport {PropTypes} from 'prop-types';\n\nimport OverlayTrigger from 'components/overlay_trigger';\n\nimport * as Utils from 'utils/utils.jsx';\n\nexport default class ChannelCreate extends React.PureComponent {\n    static propTypes = {\n        sectionType: PropTypes.string.isRequired,\n        createPublicChannel: PropTypes.func.isRequired,\n        createPrivateChannel: PropTypes.func.isRequired,\n        createDirectMessage: PropTypes.func.isRequired,\n        createPublicDirectChannel: PropTypes.func.isRequired,\n        canCreatePublicChannel: PropTypes.bool.isRequired,\n        canCreatePrivateChannel: PropTypes.bool.isRequired,\n    };\n\n    renderPublic = () => {\n        if (!this.props.canCreatePublicChannel) {\n            return null;\n        }\n\n        const ariaLabelPublic = `${Utils.localizeMessage('sidebar.createChannel', 'Create new public channel').toLowerCase()}`;\n\n        const tooltip = (\n            <Tooltip id='new-channel-tooltip' >\n                <FormattedMessage\n                    id='sidebar.createChannel'\n                    defaultMessage='Create new public channel'\n                />\n            </Tooltip>\n        );\n\n        return (\n            <button\n                id='createPublicChannel'\n                aria-label={ariaLabelPublic}\n                type='button'\n                className='add-channel-btn cursor--pointer style--none'\n                onClick={this.props.createPublicChannel}\n            >\n                <OverlayTrigger\n                    delayShow={500}\n                    placement='top'\n                    overlay={tooltip}\n                >\n                    <span>{'+'}</span>\n                </OverlayTrigger>\n            </button>\n        );\n    };\n\n    renderPrivate = () => {\n        if (!this.props.canCreatePrivateChannel) {\n            return null;\n        }\n\n        const ariaLabelPrivate = `${Utils.localizeMessage('sidebar.createGroup', 'Create new private channel').toLowerCase()}`;\n\n        const tooltip = (\n            <Tooltip id='new-group-tooltip'>\n                <FormattedMessage\n                    id='sidebar.createGroup'\n                    defaultMessage='Create new private channel'\n                />\n            </Tooltip>\n        );\n\n        return (\n            <button\n                id='createPrivateChannel'\n                aria-label={ariaLabelPrivate}\n                type='button'\n                className='add-channel-btn cursor--pointer style--none'\n                onClick={this.props.createPrivateChannel}\n            >\n                <OverlayTrigger\n                    delayShow={500}\n                    placement='top'\n                    overlay={tooltip}\n                >\n                    <span>{'+'}</span>\n                </OverlayTrigger>\n            </button>\n        );\n    };\n\n    renderDirect = () => {\n        const ariaLabelDM = Utils.localizeMessage('sidebar.createDirectMessage', 'Create new direct message').toLowerCase();\n        const tooltip = (\n            <Tooltip\n                id='new-group-tooltip'\n                className='hidden-xs'\n            >\n                <FormattedMessage\n                    id='sidebar.createDirectMessage'\n                    defaultMessage='Create new direct message'\n                />\n            </Tooltip>\n        );\n\n        return (\n            <button\n                id='addDirectChannel'\n                aria-label={ariaLabelDM}\n                className='add-channel-btn cursor--pointer style--none'\n                onClick={this.props.createDirectMessage}\n            >\n                <OverlayTrigger\n                    className='hidden-xs'\n                    delayShow={500}\n                    placement='top'\n                    overlay={tooltip}\n                >\n                    <span>{'+'}</span>\n                </OverlayTrigger>\n            </button>\n        );\n    };\n\n    renderCombined = () => {\n        const {canCreatePublicChannel, canCreatePrivateChannel} = this.props;\n\n        if (canCreatePublicChannel && !canCreatePrivateChannel) {\n            return this.renderPublic();\n        }\n\n        if (canCreatePrivateChannel && !canCreatePublicChannel) {\n            return this.renderPrivate();\n        }\n\n        if (!canCreatePublicChannel && !canCreatePrivateChannel) {\n            return null;\n        }\n\n        const tooltip = (\n            <Tooltip\n                id='new-group-tooltip'\n                className='hidden-xs'\n            >\n                <FormattedMessage\n                    id='sidebar.createPublicPrivateChannel'\n                    defaultMessage='Create new public or private channel'\n                />\n            </Tooltip>\n        );\n\n        return (\n            <button\n                type='button'\n                className='add-channel-btn cursor--pointer style--none'\n                onClick={this.props.createPublicDirectChannel}\n            >\n                <OverlayTrigger\n                    className='hidden-xs'\n                    delayShow={500}\n                    placement='top'\n                    overlay={tooltip}\n                >\n                    <span>{'+'}</span>\n                </OverlayTrigger>\n            </button>\n        );\n    };\n\n    render() {\n        const {sectionType} = this.props;\n\n        switch (sectionType) {\n        case 'public':\n            return this.renderPublic();\n        case 'private':\n            return this.renderPrivate();\n        case 'direct':\n            return this.renderDirect();\n        case 'recent':\n        case 'alpha':\n            return this.renderCombined();\n        }\n\n        return null;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage, injectIntl} from 'react-intl';\nimport {PropTypes} from 'prop-types';\nimport {Permissions} from 'mattermost-redux/constants';\n\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\nimport {intlShape} from 'utils/react_intl';\n\nclass ChannelMore extends React.PureComponent {\n    static propTypes = {\n        currentTeamId: PropTypes.string.isRequired,\n        intl: intlShape.isRequired,\n        sectionType: PropTypes.string.isRequired,\n        moreChannels: PropTypes.func.isRequired,\n        moreDirectMessages: PropTypes.func.isRequired,\n        browsePublicDirectChannels: PropTypes.func.isRequired,\n        viewArchivedChannels: PropTypes.bool,\n    };\n\n    moreChannelsPublic = () => {\n        this.props.moreChannels('public');\n    }\n    moreChannelsPrivate = () => {\n        this.props.moreChannels('private');\n    }\n\n    render() {\n        const {\n            sectionType,\n            moreDirectMessages,\n            browsePublicDirectChannels,\n            viewArchivedChannels,\n        } = this.props;\n\n        const {formatMessage} = this.props.intl;\n\n        switch (sectionType) {\n        case 'public':\n            return (\n                <TeamPermissionGate\n                    teamId={this.props.currentTeamId}\n                    permissions={[Permissions.JOIN_PUBLIC_CHANNELS]}\n                >\n                    <li\n                        key='public-channel-more'\n                        data-testid='morePublicButton'\n                    >\n                        <button\n                            id='sidebarPublicChannelsMore'\n                            aria-label={formatMessage({id: 'sidebar.morePublicAria', defaultMessage: 'more public channels'})}\n                            className='nav-more cursor--pointer style--none btn--block'\n                            onClick={this.moreChannelsPublic}\n                        >\n                            <FormattedMessage\n                                id='sidebar.moreElips'\n                                defaultMessage='More...'\n                            />\n                        </button>\n                    </li>\n                </TeamPermissionGate>\n            );\n        case 'private':\n            if (viewArchivedChannels) {\n                return (\n                    <TeamPermissionGate\n                        teamId={this.props.currentTeamId}\n                        permissions={[Permissions.JOIN_PUBLIC_CHANNELS]}\n                    >\n                        <li\n                            key='public-channel-more'\n                            data-testid='morePublicButton'\n                        >\n                            <button\n                                id='sidebarPrivateChannelsMore'\n                                aria-label={formatMessage({id: 'sidebar.morePublicAria', defaultMessage: 'more public channels'})}\n                                className='nav-more cursor--pointer style--none btn--block'\n                                onClick={this.moreChannelsPrivate}\n                            >\n                                <FormattedMessage\n                                    id='sidebar.moreElips'\n                                    defaultMessage='More...'\n                                />\n                            </button>\n                        </li>\n                    </TeamPermissionGate>\n                );\n            }\n            return null;\n        case 'direct':\n            return (\n                <li\n                    key='dm-more'\n                    id='moreDMButton'\n                >\n                    <button\n                        id='moreDirectMessage'\n                        aria-label={formatMessage({id: 'sidebar.moreDmAria', defaultMessage: 'more direct messages'})}\n                        className='nav-more cursor--pointer style--none btn--block'\n                        onClick={moreDirectMessages}\n                    >\n                        <FormattedMessage\n                            id='sidebar.moreElips'\n                            defaultMessage='More...'\n                        />\n                    </button>\n                </li>\n            );\n        case 'recent':\n        case 'alpha':\n            return (\n                <li\n                    key='public-dm-more'\n                    id='moreRecentAlphaButton'\n                >\n                    <button\n                        id='morePublicDirectChannels'\n                        aria-label={formatMessage({id: 'sidebar.morePublicDmAria', defaultMessage: 'more public channels direct messages'})}\n                        className='nav-more cursor--pointer style--none btn--block'\n                        onClick={browsePublicDirectChannels}\n                    >\n                        <FormattedMessage\n                            id='sidebar.moreElips'\n                            defaultMessage='More...'\n                        />\n                    </button>\n                </li>\n            );\n        }\n\n        return null;\n    }\n}\n\nexport default injectIntl(ChannelMore);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport {Tooltip} from 'react-bootstrap';\nimport {PropTypes} from 'prop-types';\n\nimport OverlayTrigger from 'components/overlay_trigger';\n\nimport * as Utils from 'utils/utils.jsx';\nimport {t} from 'utils/i18n';\n\nconst clickableChannelHeader = ['recent', 'alpha'];\n\nexport default class ChannelName extends React.PureComponent {\n    static propTypes = {\n        sectionType: PropTypes.string.isRequired,\n        channelName: PropTypes.string.isRequired,\n        browsePublicDirectChannels: PropTypes.func.isRequired,\n    };\n\n    sectionTypeFormatMessageId = (sectionType) => {\n        switch (sectionType) {\n        case 'public':\n            return t('sidebar.types.public');\n        case 'private':\n            return t('sidebar.types.private');\n        case 'direct':\n            return t('sidebar.types.direct');\n        case 'favorite':\n            return t('sidebar.types.favorite');\n        case 'unreads':\n            return t('sidebar.types.unreads');\n        case 'recent':\n            return t('sidebar.types.recent');\n        default:\n            return t('sidebar.types.alpha');\n        }\n    }\n\n    render() {\n        const {sectionType, channelName, browsePublicDirectChannels} = this.props;\n\n        let tooltipTriggers = ['hover', 'focus'];\n\n        if (Utils.isMobile()) {\n            tooltipTriggers = [];\n        }\n\n        const formattedMessageId = this.sectionTypeFormatMessageId(sectionType);\n        let name = (\n            <FormattedMessage\n                id={formattedMessageId}\n                defaultMessage={channelName}\n            />\n        );\n\n        if (clickableChannelHeader.indexOf(sectionType) !== -1) {\n            const createPublicDirectChannelTooltip = (\n                <Tooltip\n                    id='new-group-tooltip'\n                    className='hidden-xs'\n                >\n                    <FormattedMessage\n                        id='sidebar.browseChannelDirectChannel'\n                        defaultMessage='Browse Channels and Direct Messages'\n                    />\n                </Tooltip>\n            );\n\n            name = (\n                <OverlayTrigger\n                    trigger={tooltipTriggers}\n                    delayShow={500}\n                    placement='top'\n                    overlay={createPublicDirectChannelTooltip}\n                >\n                    <div\n                        role='presentation'\n                        className='public_direct_name'\n                        onClick={browsePublicDirectChannels}\n                    >\n                        {name}\n                    </div>\n                </OverlayTrigger>\n            );\n        }\n\n        return name;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal, Tabs, Tab} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport MorePublicChannels from 'components/more_channels';\nimport MoreDirectMessages from 'components/more_direct_channels';\n\nimport {localizeMessage} from 'utils/utils';\n\nexport default class MorePublicDirectChannels extends React.PureComponent {\n    static propTypes = {\n        handleNewChannel: PropTypes.func,\n        onModalDismissed: PropTypes.func,\n    };\n\n    state = {\n        show: true,\n        key: 'channels',\n    };\n\n    handleHide = () => {\n        this.setState({show: false});\n    };\n\n    handleExit = () => {\n        if (this.props.onModalDismissed) {\n            this.props.onModalDismissed();\n        }\n    };\n\n    handleSelect = (key) => {\n        this.setState({key});\n    }\n\n    render() {\n        return (\n            <Modal\n                dialogClassName='a11y__modal more-modal more-direct-channels more-public-direct-channels'\n                show={this.state.show}\n                onHide={this.handleHide}\n                onExited={this.handleExit}\n                role='dialog'\n                aria-labelledby='morePublicModalLabel'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='morePublicModalLabel'\n                    >\n                        <FormattedMessage\n                            id='more_public_direct_channels.title'\n                            defaultMessage='Channels and Direct Messages'\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <Tabs\n                        id='morePublicDirectChannelTabs'\n                        className='modal-tabs'\n                        defaultActiveKey='channels'\n                        activeKey={this.state.key}\n                        onSelect={this.handleSelect}\n                        unmountOnExit={true}\n                    >\n                        <Tab\n                            eventKey='channels'\n                            title={localizeMessage('more_public_direct_channels.channels', 'Channels')}\n                        >\n                            <MorePublicChannels\n                                handleNewChannel={this.props.handleNewChannel}\n                                onModalDismissed={this.handleHide}\n                                bodyOnly={true}\n                            />\n                        </Tab>\n                        <Tab\n                            eventKey='dm'\n                            title={localizeMessage('more_public_direct_channels.direct_messages', 'Direct Messages')}\n                        >\n                            <MoreDirectMessages\n                                onModalDismissed={this.handleHide}\n                                isExistingChannel={false}\n                                bodyOnly={true}\n                            />\n                        </Tab>\n                    </Tabs>\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport {FormattedMessage, injectIntl} from 'react-intl';\nimport {PropTypes} from 'prop-types';\nimport classNames from 'classnames';\n\nimport Scrollbars from 'react-custom-scrollbars';\nimport {SpringSystem, MathUtil} from 'rebound';\n\nimport {trackEvent} from 'actions/diagnostics_actions.jsx';\nimport {redirectUserToDefaultTeam} from 'actions/global_actions';\nimport * as ChannelUtils from 'utils/channel_utils.jsx';\nimport {Constants, ModalIdentifiers, SidebarChannelGroups} from 'utils/constants';\nimport {intlShape} from 'utils/react_intl';\nimport * as Utils from 'utils/utils.jsx';\nimport {t} from 'utils/i18n';\n\nimport MoreChannels from 'components/more_channels';\nimport MoreDirectChannels from 'components/more_direct_channels';\nimport QuickSwitchModal from 'components/quick_switch_modal';\nimport NewChannelFlow from 'components/new_channel_flow';\nimport UnreadChannelIndicator from 'components/unread_channel_indicator';\nimport Pluggable from 'plugins/pluggable';\n\nimport SidebarHeader from './header';\nimport SidebarChannel from './sidebar_channel';\nimport ChannelCreate from './channel_create';\nimport ChannelMore from './channel_more';\nimport ChannelName from './channel_name';\nimport MorePublicDirectChannels from './more_public_direct_channels';\n\nexport function renderView(props) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--view'\n        />);\n}\n\nexport function renderThumbHorizontal(props) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--horizontal'\n        />);\n}\n\nexport function renderThumbVertical(props) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--vertical'\n        />);\n}\n\n// scrollMargin is the margin at the edge of the channel list that we leave when scrolling to a channel.\nconst scrollMargin = 15;\n\n// scrollMarginWithUnread is the margin that we leave at the edge of the channel list when scrolling to a channel so\n// that the channel is not under the unread indicator.\nconst scrollMarginWithUnread = 60;\n\nclass LegacySidebar extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * Global config object\n         */\n        config: PropTypes.object.isRequired,\n\n        isOpen: PropTypes.bool.isRequired,\n\n        /**\n         * List of unread channels (ids)\n         */\n        unreadChannelIds: PropTypes.array,\n\n        /**\n         * List of ordered channels (ids)\n         */\n        orderedChannelIds: PropTypes.arrayOf(PropTypes.shape({\n\n            /**\n             * Type of channel\n             */\n            type: PropTypes.string.isRequired,\n\n            /**\n             * Displayed name in sidebar\n             */\n            name: PropTypes.string.isRequired,\n\n            /**\n             * List of ids for the channels (ids)\n             */\n            items: PropTypes.array.isRequired,\n        })),\n\n        /**\n         * Current channel object\n         */\n        currentChannel: PropTypes.object,\n\n        /**\n         * Current channel teammeat (for direct messages)\n         */\n        currentTeammate: PropTypes.object,\n\n        /**\n         * Current team object\n         */\n        currentTeam: PropTypes.object,\n\n        /**\n         * Current user object\n         */\n        currentUser: PropTypes.object,\n\n        intl: intlShape.isRequired,\n\n        /**\n         * Number of unread mentions/messages\n         */\n        unreads: PropTypes.object.isRequired,\n\n        /**\n         * Permission to create public channel\n         */\n        canCreatePublicChannel: PropTypes.bool.isRequired,\n\n        /**\n         * Permission to create private channel\n         */\n        canCreatePrivateChannel: PropTypes.bool.isRequired,\n\n        /**\n         * Flag to display the Switch channel shortcut\n         */\n        channelSwitcherOption: PropTypes.bool.isRequired,\n\n        /**\n         * Setting that enables user to view archived channels\n         */\n        viewArchivedChannels: PropTypes.bool,\n\n        actions: PropTypes.shape({\n            close: PropTypes.func.isRequired,\n            switchToChannelById: PropTypes.func.isRequired,\n            openModal: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    static defaultProps = {\n        currentChannel: {},\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.badgesActive = false;\n        this.firstUnreadChannel = null;\n        this.lastUnreadChannel = null;\n\n        this.isLeaving = new Map();\n        this.isSwitchingChannel = false;\n        this.closedDirectChannel = false;\n\n        this.state = {\n            newChannelModalType: '',\n            orderedChannelIds: props.orderedChannelIds,\n            showDirectChannelsModal: false,\n            showMoreChannelsModal: false,\n            showMorePublicChannelsModal: false,\n            morePublicChannelsModalType: 'public',\n        };\n\n        this.animate = new SpringSystem();\n        this.scrollAnimation = this.animate.createSpring();\n        this.scrollAnimation.setOvershootClampingEnabled(true); // disables the spring action at the end of animation\n        this.scrollAnimation.addListener({onSpringUpdate: this.handleScrollAnimationUpdate});\n    }\n\n    static getDerivedStateFromProps(nextProps, prevState) {\n        if (nextProps.orderedChannelIds[0].type === SidebarChannelGroups.UNREADS &&\n            prevState.orderedChannelIds[0].type === SidebarChannelGroups.UNREADS &&\n            prevState.orderedChannelIds[0].items.length === nextProps.orderedChannelIds[0].items.length &&\n            prevState.orderedChannelIds[0].items.includes(nextProps.currentChannel.id)\n        ) {\n            return null;\n        }\n\n        if (nextProps.orderedChannelIds !== prevState.orderedChannelIds) {\n            return {orderedChannelIds: nextProps.orderedChannelIds};\n        }\n\n        return null;\n    }\n\n    componentDidMount() {\n        this.updateUnreadIndicators();\n        document.addEventListener('keydown', this.navigateChannelShortcut);\n        document.addEventListener('keydown', this.navigateUnreadChannelShortcut);\n    }\n\n    componentDidUpdate(prevProps) {\n        // if the active channel disappeared (which can happen when dm channels\n        // autoclose), go to user default channel in team\n        if (this.props.currentTeam === prevProps.currentTeam &&\n            this.props.currentChannel.id === prevProps.currentChannel.id &&\n            !this.channelIdIsDisplayedForProps(this.props.orderedChannelIds, this.props.currentChannel.id) &&\n            this.channelIdIsDisplayedForProps(prevProps.orderedChannelIds, this.props.currentChannel.id)\n        ) {\n            this.closedDirectChannel = true;\n            redirectUserToDefaultTeam();\n            return;\n        }\n\n        // reset the scrollbar upon switching teams\n        if (this.props.currentTeam !== prevProps.currentTeam) {\n            this.refs.scrollbar.scrollToTop();\n        }\n\n        // Scroll to selected channel so it's in view\n        if (this.props.currentChannel.id !== prevProps.currentChannel.id) {\n            // This will be re-enabled when we can avoid animating the scroll on first load and team switch\n            // this.scrollToChannel(this.props.currentChannel.id);\n        }\n\n        // close the LHS on mobile when you change channels\n        if (this.props.currentChannel.id !== prevProps.currentChannel.id) {\n            if (this.closedDirectChannel) {\n                this.closedDirectChannel = false;\n            } else {\n                this.props.actions.close();\n            }\n        }\n\n        this.setFirstAndLastUnreadChannels();\n        this.updateUnreadIndicators();\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.navigateChannelShortcut);\n        document.removeEventListener('keydown', this.navigateUnreadChannelShortcut);\n\n        this.animate.deregisterSpring(this.scrollAnimation);\n        this.animate.removeAllListeners();\n        this.scrollAnimation.destroy();\n    }\n\n    setFirstAndLastUnreadChannels() {\n        const {currentChannel, unreadChannelIds} = this.props;\n        const {orderedChannelIds} = this.state;\n\n        this.getDisplayedChannels(orderedChannelIds).map((channelId) => {\n            if (channelId !== currentChannel.id && unreadChannelIds.includes(channelId)) {\n                if (!this.firstUnreadChannel) {\n                    this.firstUnreadChannel = channelId;\n                }\n                this.lastUnreadChannel = channelId;\n            }\n            return null;\n        });\n    }\n\n    handleOpenMoreDirectChannelsModal = (e) => {\n        e.preventDefault();\n        if (this.state.showDirectChannelsModal) {\n            this.hideMoreDirectChannelsModal();\n        } else {\n            this.showMoreDirectChannelsModal();\n        }\n    }\n\n    onScroll = () => {\n        this.updateUnreadIndicators();\n    }\n\n    handleScrollAnimationUpdate = (spring) => {\n        const {scrollbar} = this.refs;\n        const val = spring.getCurrentValue();\n        scrollbar.scrollTop(val);\n    }\n\n    scrollToFirstUnreadChannel = () => {\n        this.scrollToChannel(this.firstUnreadChannel, true);\n    }\n\n    scrollToLastUnreadChannel = () => {\n        this.scrollToChannel(this.lastUnreadChannel, true);\n    }\n\n    scrollToChannel = (channelId, scrollingToUnread = false) => {\n        const element = $(ReactDOM.findDOMNode(this.refs[channelId]));\n        if (!element) {\n            return;\n        }\n\n        const position = element.position();\n        if (!position) {\n            return;\n        }\n\n        const top = position.top;\n        const bottom = top + element.height();\n\n        const scrollTop = this.refs.scrollbar.getScrollTop();\n        const scrollHeight = this.refs.scrollbar.getClientHeight();\n\n        if (top < scrollTop) {\n            // Scroll up to the item\n            const margin = (scrollingToUnread || !this.state.showTopUnread) ? scrollMargin : scrollMarginWithUnread;\n\n            let scrollEnd;\n            const displayedChannels = this.getDisplayedChannels(this.state.orderedChannelIds);\n            if (displayedChannels.length > 0 && displayedChannels[0] === channelId) {\n                // This is the first channel, so scroll right to the top\n                scrollEnd = MathUtil.mapValueInRange(0, 0, 1, 0, 1);\n            } else {\n                scrollEnd = MathUtil.mapValueInRange(top - margin, 0, 1, 0, 1);\n            }\n\n            this.scrollToPosition(scrollEnd);\n        } else if (bottom > scrollTop + scrollHeight) {\n            // Scroll down to the item\n            const margin = (scrollingToUnread || !this.state.showBottomUnread) ? scrollMargin : scrollMarginWithUnread;\n            const scrollEnd = (bottom - scrollHeight) + margin;\n\n            this.scrollToPosition(scrollEnd);\n        }\n    }\n\n    scrollToPosition = (scrollEnd) => {\n        // Stop the current animation before scrolling\n        this.scrollAnimation.setCurrentValue(this.refs.scrollbar.getScrollTop()).setAtRest();\n\n        this.scrollAnimation.setEndValue(scrollEnd);\n    }\n\n    updateUnreadIndicators = () => {\n        let showTopUnread = false;\n        let showBottomUnread = false;\n\n        // Consider partially obscured channels as above/below\n\n        if (this.firstUnreadChannel) {\n            const firstUnreadElement = $(ReactDOM.findDOMNode(this.refs[this.firstUnreadChannel]));\n            const firstUnreadPosition = firstUnreadElement ? firstUnreadElement.position() : null;\n\n            if (firstUnreadPosition && ((firstUnreadPosition.top + firstUnreadElement.height()) - scrollMargin) < this.refs.scrollbar.getScrollTop()) {\n                showTopUnread = true;\n            }\n        }\n\n        if (this.lastUnreadChannel) {\n            const lastUnreadElement = $(ReactDOM.findDOMNode(this.refs[this.lastUnreadChannel]));\n            const lastUnreadPosition = lastUnreadElement ? lastUnreadElement.position() : null;\n\n            if (lastUnreadPosition && (lastUnreadPosition.top + scrollMargin) > (this.refs.scrollbar.getScrollTop() + this.refs.scrollbar.getClientHeight())) {\n                showBottomUnread = true;\n            }\n        }\n        if (showTopUnread !== this.state.showTopUnread || showBottomUnread !== this.state.showBottomUnread) {\n            this.setState({\n                showTopUnread,\n                showBottomUnread,\n            });\n        }\n    }\n\n    navigateChannelShortcut = (e) => {\n        if (e.altKey && !e.shiftKey && !e.ctrlKey && !e.metaKey && (Utils.isKeyPressed(e, Constants.KeyCodes.UP) || Utils.isKeyPressed(e, Constants.KeyCodes.DOWN))) {\n            e.preventDefault();\n\n            if (this.isSwitchingChannel) {\n                return;\n            }\n\n            this.isSwitchingChannel = true;\n            const allChannelIds = this.getDisplayedChannels(this.state.orderedChannelIds);\n            const curChannelId = this.props.currentChannel.id;\n            let curIndex = -1;\n            for (let i = 0; i < allChannelIds.length; i++) {\n                if (allChannelIds[i] === curChannelId) {\n                    curIndex = i;\n                }\n            }\n            let nextIndex = curIndex;\n            if (Utils.isKeyPressed(e, Constants.KeyCodes.DOWN)) {\n                nextIndex = curIndex + 1;\n            } else {\n                nextIndex = curIndex - 1;\n            }\n            const nextChannelId = allChannelIds[Utils.mod(nextIndex, allChannelIds.length)];\n            this.props.actions.switchToChannelById(nextChannelId);\n            this.scrollToChannel(nextChannelId);\n\n            this.isSwitchingChannel = false;\n        } else if (Utils.cmdOrCtrlPressed(e) && e.shiftKey && Utils.isKeyPressed(e, Constants.KeyCodes.K)) {\n            this.handleOpenMoreDirectChannelsModal(e);\n        }\n    };\n\n    navigateUnreadChannelShortcut = (e) => {\n        if (e.altKey && e.shiftKey && !e.ctrlKey && !e.metaKey && (Utils.isKeyPressed(e, Constants.KeyCodes.UP) || Utils.isKeyPressed(e, Constants.KeyCodes.DOWN))) {\n            e.preventDefault();\n\n            if (this.isSwitchingChannel) {\n                return;\n            }\n\n            this.isSwitchingChannel = true;\n\n            const allChannelIds = this.getDisplayedChannels(this.state.orderedChannelIds);\n\n            let direction = 0;\n            if (Utils.isKeyPressed(e, Constants.KeyCodes.UP)) {\n                direction = -1;\n            } else {\n                direction = 1;\n            }\n\n            const nextIndex = ChannelUtils.findNextUnreadChannelId(\n                this.props.currentChannel.id,\n                allChannelIds,\n                this.props.unreadChannelIds,\n                direction\n            );\n\n            if (nextIndex !== -1) {\n                const nextChannelId = allChannelIds[nextIndex];\n                this.props.actions.switchToChannelById(nextChannelId);\n                this.scrollToChannel(nextChannelId);\n            }\n\n            this.isSwitchingChannel = false;\n        }\n    };\n\n    getDisplayedChannels = (orderedChannelIds = []) => {\n        return orderedChannelIds.reduce((allChannelIds, section) => {\n            allChannelIds.push(...section.items);\n            return allChannelIds;\n        }, []);\n    };\n\n    channelIdIsDisplayedForProps = (orderedChannelIds = [], id) => {\n        const allChannels = this.getDisplayedChannels(orderedChannelIds);\n        for (let i = 0; i < allChannels.length; i++) {\n            if (allChannels[i] === id) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    showMorePublicDirectChannelsModal = () => {\n        this.setState({showMorePublicChannelsModal: true});\n        trackEvent('ui', 'ui_channels_more_public_direct');\n    }\n\n    hideMorePublicDirectChannelsModal = () => {\n        this.setState({showMorePublicChannelsModal: false});\n    }\n\n    onHandleNewChannel = () => {\n        this.hideMorePublicDirectChannelsModal();\n        this.showNewChannelModal(Constants.OPEN_CHANNEL);\n    }\n\n    showMoreChannelsModal = (type) => {\n        this.setState({showMoreChannelsModal: true, morePublicChannelsModalType: type});\n        trackEvent('ui', 'ui_channels_more_public');\n    }\n\n    hideMoreChannelsModal = () => {\n        this.setState({showMoreChannelsModal: false});\n    }\n\n    showNewPublicChannelModal = () => {\n        trackEvent('ui', 'ui_channels_create_channel_public_v1');\n        this.showNewChannelModal(Constants.OPEN_CHANNEL);\n    }\n\n    showNewPrivateChannelModal = () => {\n        trackEvent('ui', 'ui_channels_create_channel_private_v1');\n        this.showNewChannelModal(Constants.PRIVATE_CHANNEL);\n    }\n\n    showNewChannelModal = (type) => {\n        this.setState({newChannelModalType: type});\n    }\n\n    hideNewChannelModal = () => {\n        this.setState({newChannelModalType: ''});\n    }\n\n    showMoreDirectChannelsModal = () => {\n        trackEvent('ui', 'ui_channels_more_direct');\n        this.setState({showDirectChannelsModal: true});\n    }\n\n    hideMoreDirectChannelsModal = () => {\n        this.setState({showDirectChannelsModal: false});\n    }\n\n    openQuickSwitcher = (e) => {\n        e.preventDefault();\n\n        trackEvent('ui', 'ui_sidebar_open_channel_switcher_v1');\n\n        this.props.actions.openModal({\n            modalId: ModalIdentifiers.QUICK_SWITCH,\n            dialogType: QuickSwitchModal,\n        });\n    }\n\n    createSidebarChannel = (channelId) => {\n        return (\n            <SidebarChannel\n                key={channelId}\n                ref={channelId}\n                channelId={channelId}\n                active={channelId === this.props.currentChannel.id}\n                currentTeamName={this.props.currentTeam.name}\n                currentUserId={this.props.currentUser.id}\n            />\n        );\n    }\n\n    renderOrderedChannels = () => {\n        const {orderedChannelIds} = this.state;\n\n        const sectionsToHide = [SidebarChannelGroups.UNREADS, SidebarChannelGroups.FAVORITE];\n\n        return (\n            <Scrollbars\n                ref='scrollbar'\n                autoHide={true}\n                autoHideTimeout={500}\n                autoHideDuration={500}\n                renderThumbHorizontal={renderThumbHorizontal}\n                renderThumbVertical={renderThumbVertical}\n                renderView={renderView}\n                onScroll={this.onScroll}\n                style={{position: 'absolute'}}\n            >\n                <div\n                    id='sidebarChannelContainer'\n                    className='nav-pills__container'\n                >\n                    {orderedChannelIds.map((sec) => {\n                        const section = {\n                            type: sec.type,\n                            name: sec.name,\n                            items: sec.items.map(this.createSidebarChannel),\n                        };\n\n                        if (sectionsToHide.indexOf(section.type) !== -1 && section.items.length === 0) {\n                            return null;\n                        }\n\n                        const sectionId = `${section.type}Channel`;\n                        const ariaLabel = section.name.toLowerCase();\n\n                        return (\n                            <ul\n                                key={section.type}\n                                aria-label={ariaLabel}\n                                className='nav nav-pills nav-stacked a11y__section'\n                                id={sectionId + 'List'}\n                                tabIndex='-1'\n                            >\n                                <li className='sidebar-section__header'>\n                                    <h4\n                                        role='presentation'\n                                        id={sectionId}\n                                    >\n                                        <ChannelName\n                                            sectionType={section.type}\n                                            channelName={section.name}\n                                            browsePublicDirectChannels={this.showMorePublicDirectChannelsModal}\n                                        />\n                                    </h4>\n                                    <ChannelCreate\n                                        sectionType={section.type}\n                                        canCreatePublicChannel={this.props.canCreatePublicChannel}\n                                        canCreatePrivateChannel={this.props.canCreatePrivateChannel}\n                                        createPublicChannel={this.showNewPublicChannelModal}\n                                        createPrivateChannel={this.showNewPrivateChannelModal}\n                                        createDirectMessage={this.handleOpenMoreDirectChannelsModal}\n                                        createPublicDirectChannel={this.showNewPublicChannelModal}\n                                    />\n                                </li>\n                                {section.items}\n                                <ChannelMore\n                                    currentTeamId={this.props.currentTeam.id}\n                                    sectionType={section.type}\n                                    moreChannels={this.showMoreChannelsModal}\n                                    moreDirectMessages={this.handleOpenMoreDirectChannelsModal}\n                                    browsePublicDirectChannels={this.showMorePublicDirectChannelsModal}\n                                    viewArchivedChannels={this.props.viewArchivedChannels}\n                                />\n                            </ul>\n                        );\n                    })}\n                </div>\n            </Scrollbars>\n        );\n    };\n\n    render() {\n        const {channelSwitcherOption} = this.props;\n        const ariaLabel = Utils.localizeMessage('accessibility.sections.lhsList', 'channel sidebar region');\n\n        // Check if we have all info needed to render\n        if (this.props.currentTeam == null || this.props.currentUser == null) {\n            return (<div/>);\n        }\n\n        // keep track of the first and last unread channels so we can use them to set the unread indicators\n        this.firstUnreadChannel = null;\n        this.lastUnreadChannel = null;\n\n        let showChannelModal = false;\n        if (this.state.newChannelModalType !== '') {\n            showChannelModal = true;\n        }\n\n        const above = (\n            <FormattedMessage\n                id='sidebar.unreads'\n                defaultMessage='More unreads'\n            />\n        );\n\n        const below = (\n            <FormattedMessage\n                id='sidebar.unreads'\n                defaultMessage='More unreads'\n            />\n        );\n\n        let moreDirectChannelsModal;\n        if (this.state.showDirectChannelsModal) {\n            moreDirectChannelsModal = (\n                <MoreDirectChannels\n                    onModalDismissed={this.hideMoreDirectChannelsModal}\n                    isExistingChannel={false}\n                />\n            );\n        }\n\n        let moreChannelsModal;\n        if (this.state.showMoreChannelsModal) {\n            moreChannelsModal = (\n                <MoreChannels\n                    onModalDismissed={this.hideMoreChannelsModal}\n                    handleNewChannel={() => {\n                        this.hideMoreChannelsModal();\n                        this.showNewChannelModal(Constants.OPEN_CHANNEL);\n                    }}\n                    morePublicChannelsModalType={this.state.morePublicChannelsModalType}\n                />\n            );\n        }\n\n        let quickSwitchText = null;\n        if (channelSwitcherOption) {\n            let quickSwitchTextShortcutId = t('quick_switch_modal.channelsShortcut.windows');\n            let quickSwitchTextShortcutDefault = '- CTRL+K';\n            if (Utils.isMac()) {\n                quickSwitchTextShortcutId = t('quick_switch_modal.channelsShortcut.mac');\n                quickSwitchTextShortcutDefault = '- K';\n            }\n\n            const quickSwitchTextShortcut = (\n                <span className='switch__shortcut hidden-xs'>\n                    <FormattedMessage\n                        id={quickSwitchTextShortcutId}\n                        defaultMessage={quickSwitchTextShortcutDefault}\n                    />\n                </span>\n            );\n\n            quickSwitchText = (\n                <div className='sidebar__switcher'>\n                    <button\n                        id='sidebarSwitcherButton'\n                        className='btn btn-link'\n                        onClick={this.openQuickSwitcher}\n                    >\n                        <FormattedMessage\n                            id={'channel_switch_modal.title'}\n                            defaultMessage='Switch Channels'\n                        />\n                        {quickSwitchTextShortcut}\n                    </button>\n                </div>\n            );\n        }\n\n        let morePublicDirectChannelsModal;\n        if (this.state.showMorePublicChannelsModal) {\n            morePublicDirectChannelsModal = (\n                <MorePublicDirectChannels\n                    onModalDismissed={this.hideMorePublicDirectChannelsModal}\n                    handleNewChannel={this.onHandleNewChannel}\n                    isExistingChannel={false}\n                />\n            );\n        }\n\n        return (\n            <div\n                className={classNames('sidebar--left', {'move--right': this.props.isOpen && Utils.isMobile()})}\n                id='sidebar-left'\n                key='sidebar-left'\n                role='navigation'\n                aria-labelledby='sidebar-left'\n            >\n                <NewChannelFlow\n                    show={showChannelModal}\n                    canCreatePublicChannel={this.props.canCreatePublicChannel}\n                    canCreatePrivateChannel={this.props.canCreatePrivateChannel}\n                    channelType={this.state.newChannelModalType}\n                    onModalDismissed={this.hideNewChannelModal}\n                />\n                {morePublicDirectChannelsModal}\n                {moreDirectChannelsModal}\n                {moreChannelsModal}\n\n                <SidebarHeader/>\n\n                <div className='sidebar--left__icons'>\n                    <Pluggable pluggableName='LeftSidebarHeader'/>\n                </div>\n\n                <div\n                    id='lhsList'\n                    role='application'\n                    aria-label={ariaLabel}\n                    tabIndex='-1'\n                    className='sidebar--left__list a11y__region'\n                    data-a11y-sort-order='6'\n                >\n                    <UnreadChannelIndicator\n                        name='Top'\n                        show={this.state.showTopUnread}\n                        onClick={this.scrollToFirstUnreadChannel}\n                        extraClass='nav-pills__unread-indicator-top'\n                        content={above}\n                    />\n                    <UnreadChannelIndicator\n                        name='Bottom'\n                        show={this.state.showBottomUnread}\n                        onClick={this.scrollToLastUnreadChannel}\n                        extraClass='nav-pills__unread-indicator-bottom'\n                        content={below}\n                    />\n\n                    {this.renderOrderedChannels()}\n                </div>\n                {quickSwitchText}\n            </div>\n        );\n    }\n}\n\nexport default injectIntl(LegacySidebar);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {Preferences} from 'mattermost-redux/constants/index';\nimport {\n    getCurrentChannel,\n    getSortedUnreadChannelIds,\n    getOrderedChannelIds,\n    getUnreads,\n} from 'mattermost-redux/selectors/entities/channels';\n\nimport Permissions from 'mattermost-redux/constants/permissions';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getBool as getBoolPreference, getSidebarPreferences} from 'mattermost-redux/selectors/entities/preferences';\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\n\nimport {switchToChannelById} from 'actions/views/channel';\nimport {openModal} from 'actions/views/modals';\nimport {close} from 'actions/views/lhs';\nimport {getIsLhsOpen} from 'selectors/lhs';\n\nimport Sidebar from './sidebar.jsx';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n    const currentChannel = getCurrentChannel(state);\n    const currentTeammate = currentChannel && currentChannel.teammate_id && getCurrentChannel(state, currentChannel.teammate_id);\n    const currentTeam = getCurrentTeam(state);\n\n    let canCreatePublicChannel = false;\n    let canCreatePrivateChannel = false;\n\n    if (currentTeam) {\n        canCreatePublicChannel = haveITeamPermission(state, {team: currentTeam.id, permission: Permissions.CREATE_PUBLIC_CHANNEL});\n        canCreatePrivateChannel = haveITeamPermission(state, {team: currentTeam.id, permission: Permissions.CREATE_PRIVATE_CHANNEL});\n    }\n\n    const sidebarPrefs = getSidebarPreferences(state);\n    const lastUnreadChannel = state.views.channel.keepChannelIdAsUnread;\n    const unreadChannelIds = getSortedUnreadChannelIds(state, lastUnreadChannel);\n    const orderedChannelIds = getOrderedChannelIds(\n        state,\n        lastUnreadChannel,\n        sidebarPrefs.grouping,\n        sidebarPrefs.sorting,\n        sidebarPrefs.unreads_at_top === 'true',\n        sidebarPrefs.favorite_at_top === 'true',\n    );\n\n    const channelSwitcherOption = getBoolPreference(\n        state,\n        Preferences.CATEGORY_SIDEBAR_SETTINGS,\n        'channel_switcher_section',\n        'true'\n    );\n\n    return {\n        config,\n        unreadChannelIds,\n        orderedChannelIds,\n        channelSwitcherOption,\n        currentChannel,\n        currentTeammate,\n        currentTeam,\n        currentUser: getCurrentUser(state),\n        canCreatePublicChannel,\n        canCreatePrivateChannel,\n        isOpen: getIsLhsOpen(state),\n        unreads: getUnreads(state),\n        viewArchivedChannels: (getConfig(state).ExperimentalViewArchivedChannels === 'true')\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            close,\n            switchToChannelById,\n            openModal,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Sidebar);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage, IntlShape, injectIntl} from 'react-intl';\n\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\nimport Menu from 'components/widgets/menu/menu';\nimport OverlayTrigger from 'components/overlay_trigger';\n\ntype Props = {\n    intl: IntlShape;\n    canCreateChannel: boolean;\n    canJoinPublicChannel: boolean;\n    showMoreChannelsModal: () => void;\n    showNewChannelModal: () => void;\n};\n\ntype State = {\n\n};\n\nclass AddChannelDropdown extends React.PureComponent<Props, State> {\n    renderDropdownItems = () => {\n        const {intl, canCreateChannel, canJoinPublicChannel} = this.props;\n\n        let joinPublicChannel;\n        if (canJoinPublicChannel) {\n            joinPublicChannel = (\n                <Menu.ItemAction\n                    id='showMoreChannels'\n                    onClick={this.props.showMoreChannelsModal}\n                    icon={<i className='icon-globe'/>}\n                    text={intl.formatMessage({id: 'sidebar_left.add_channel_dropdown.browseChannels', defaultMessage: 'Browse Channels'})}\n                />\n            );\n        }\n\n        let createChannel;\n        if (canCreateChannel) {\n            createChannel = (\n                <Menu.ItemAction\n                    id='showNewChannel'\n                    onClick={this.props.showNewChannelModal}\n                    icon={<i className='icon-plus'/>}\n                    text={intl.formatMessage({id: 'sidebar_left.add_channel_dropdown.createNewChannel', defaultMessage: 'Create New Channel'})}\n                />\n            );\n        }\n\n        return (\n            <Menu.Group>\n                {joinPublicChannel}\n                {createChannel}\n            </Menu.Group>\n        );\n    }\n\n    render() {\n        const {intl, canCreateChannel, canJoinPublicChannel} = this.props;\n\n        if (!(canCreateChannel || canJoinPublicChannel)) {\n            return null;\n        }\n\n        const tooltip = (\n            <Tooltip\n                id='new-group-tooltip'\n                className='hidden-xs'\n            >\n                <FormattedMessage\n                    id={'sidebar_left.add_channel_dropdown.browseOrCreateChannels'}\n                    defaultMessage='Browse or create channels'\n                />\n            </Tooltip>\n        );\n\n        return (\n            <MenuWrapper className='AddChannelDropdown'>\n                <button\n                    className='AddChannelDropdown_dropdownButton'\n                    aria-label={intl.formatMessage({id: 'sidebar_left.add_channel_dropdown.dropdownAriaLabel', defaultMessage: 'Add Channel Dropdown'})}\n                >\n                    <OverlayTrigger\n                        delayShow={500}\n                        placement='top'\n                        overlay={tooltip}\n                    >\n                        <i className='icon-plus'/>\n                    </OverlayTrigger>\n                </button>\n                <Menu\n                    id='AddChannelDropdown'\n                    ariaLabel={intl.formatMessage({id: 'sidebar_left.add_channel_dropdown.dropdownAriaLabel', defaultMessage: 'Add Channel Dropdown'})}\n                >\n                    {this.renderDropdownItems()}\n                </Menu>\n            </MenuWrapper>\n        );\n    }\n}\n\nexport default injectIntl(AddChannelDropdown);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport * as Utils from 'utils/utils.jsx';\nimport StatusDropdown from 'components/status_dropdown/index.jsx';\n\nimport SidebarHeaderDropdown from 'components/legacy_sidebar/header/dropdown';\n\ntype State = {\n    isMobile: boolean;\n}\n\nexport default class SidebarHeader extends React.PureComponent<any, State> {\n    constructor(props: any) {\n        super(props);\n        this.state = {\n            isMobile: Utils.isMobile(),\n        };\n    }\n\n    componentDidMount() {\n        window.addEventListener('resize', this.handleResize);\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.handleResize);\n    }\n\n    handleResize = () => {\n        const isMobile = Utils.isMobile();\n        this.setState({isMobile});\n    }\n\n    render() {\n        const ariaLabel = Utils.localizeMessage('accessibility.sections.lhsHeader', 'team menu region');\n\n        return (\n            <div\n                id='lhsHeader'\n                aria-label={ariaLabel}\n                tabIndex={-1}\n                role='application'\n                className='SidebarHeader team__header theme a11y__region'\n                data-a11y-sort-order='5'\n            >\n                <div\n                    className='d-flex'\n                >\n                    {!this.state.isMobile && <StatusDropdown/>}\n                    <SidebarHeaderDropdown/>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\nimport {getInt} from 'mattermost-redux/selectors/entities/preferences';\n\nimport {GlobalState} from 'types/store';\nimport {Preferences, TutorialSteps} from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\n\nimport SidebarHeader from './sidebar_header';\n\nfunction mapStateToProps(state: GlobalState) {\n    const config = getConfig(state);\n    const currentUser = getCurrentUser(state);\n\n    const enableTutorial = config.EnableTutorial === 'true';\n\n    const showTutorialTip = getInt(state, Preferences.TUTORIAL_STEP, currentUser.id) === TutorialSteps.MENU_POPOVER && !Utils.isMobile();\n\n    return {\n        enableTutorial,\n        showTutorialTip,\n    };\n}\n\nexport default connect(mapStateToProps)(SidebarHeader);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport classNames from 'classnames';\n\nimport {trackEvent} from 'actions/diagnostics_actions';\nimport {ModalIdentifiers} from 'utils/constants';\nimport QuickSwitchModal from 'components/quick_switch_modal';\nimport * as Utils from 'utils/utils';\nimport {isDesktopApp} from 'utils/user_agent';\n\ntype Props = {\n    canGoForward: boolean;\n    canGoBack: boolean;\n    actions: {\n        openModal: (modalData: any) => Promise<{data: boolean}>;\n        goBack: () => void;\n        goForward: () => void;\n    };\n};\n\ntype State = {\n\n};\n\nexport default class ChannelNavigator extends React.PureComponent<Props, State> {\n    openQuickSwitcher = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\n        e.preventDefault();\n\n        trackEvent('ui', 'ui_sidebar_open_channel_switcher_v2');\n\n        this.props.actions.openModal({\n            modalId: ModalIdentifiers.QUICK_SWITCH,\n            dialogType: QuickSwitchModal,\n        });\n    }\n\n    goBack = () => {\n        trackEvent('ui', 'ui_history_back');\n        this.props.actions.goBack();\n    }\n\n    goForward = () => {\n        trackEvent('ui', 'ui_history_forward');\n        this.props.actions.goForward();\n    }\n\n    render() {\n        let channelSwitchTextShortcutDefault = 'Ctrl+K';\n        if (Utils.isMac()) {\n            channelSwitchTextShortcutDefault = 'K';\n        }\n\n        let historyArrows;\n        if (isDesktopApp()) {\n            historyArrows = (\n                <React.Fragment>\n                    <button\n                        className={classNames('SidebarChannelNavigator_backButton', {disabled: !this.props.canGoBack})}\n                        disabled={!this.props.canGoBack}\n                        onClick={this.goBack}\n                        aria-label={Utils.localizeMessage('sidebar_left.channel_navigator.goBackLabel', 'Back')}\n                    >\n                        <i className='icon icon-arrow-left'/>\n                    </button>\n                    <button\n                        className={classNames('SidebarChannelNavigator_forwardButton', {disabled: !this.props.canGoForward})}\n                        disabled={!this.props.canGoForward}\n                        onClick={this.goForward}\n                        aria-label={Utils.localizeMessage('sidebar_left.channel_navigator.goForwardLabel', 'Forward')}\n                    >\n                        <i className='icon icon-arrow-right'/>\n                    </button>\n                </React.Fragment>\n            );\n        }\n\n        return (\n            <div className={'SidebarChannelNavigator'}>\n                <button\n                    className={'SidebarChannelNavigator_jumpToButton'}\n                    onClick={this.openQuickSwitcher}\n                    aria-label={Utils.localizeMessage('sidebar_left.channel_navigator.channelSwitcherLabel', 'Channel Switcher')}\n                >\n                    <FormattedMessage\n                        id='sidebar_left.channel_navigator.jumpTo'\n                        defaultMessage='Jump to...'\n                    />\n                    <div className={'SidebarChannelNavigator_shortcutText'}>\n                        {channelSwitchTextShortcutDefault}\n                    </div>\n                </button>\n                {historyArrows}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch, ActionCreatorsMapObject} from 'redux';\n\nimport {GlobalState} from 'mattermost-redux/types/store';\nimport {ActionFunc} from 'mattermost-redux/types/actions';\n\nimport {openModal} from 'actions/views/modals';\nimport {browserHistory} from 'utils/browser_history';\n\nimport ChannelNavigator from './channel_navigator';\n\n// TODO: For Phase 1. Will revisit history in Phase 2\nfunction goBack() {\n    return (dispatch: any, getState: any) => {\n        browserHistory.goBack();\n        return {data: null};\n    };\n}\n\nfunction goForward() {\n    return (dispatch: any, getState: any) => {\n        browserHistory.goForward();\n        return {data: null};\n    };\n}\n\nfunction mapStateToProps(state: GlobalState) {\n    return {\n        canGoBack: true, // TODO: Phase 1 only\n        canGoForward: true,\n    };\n}\n\ntype Actions = {\n    openModal: (modalData: any) => Promise<{data: boolean}>;\n    goBack: () => void;\n    goForward: () => void;\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch) {\n    return {\n        actions: bindActionCreators<ActionCreatorsMapObject<ActionFunc>, Actions>({\n            openModal,\n            goBack,\n            goForward,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelNavigator);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {setItem} from 'actions/storage';\n\nimport {ActionTypes, StoragePrefixes} from 'utils/constants';\n\nexport function collapseCategory(categoryId: string) {\n    return setItem(StoragePrefixes.CHANNEL_CATEGORY_COLLAPSED + categoryId, true);\n}\n\nexport function expandCategory(categoryId: string) {\n    // You should be able to use removeItem here, but removeItem was not working at all\n    return setItem(StoragePrefixes.CHANNEL_CATEGORY_COLLAPSED + categoryId, false);\n}\n\nexport function setCategoryCollapsed(categoryId: string, collapsed: boolean) {\n    if (collapsed) {\n        return collapseCategory(categoryId);\n    }\n\n    return expandCategory(categoryId);\n}\n\nexport function setUnreadFilterEnabled(enabled: boolean) {\n    return {\n        type: ActionTypes.SET_UNREAD_FILTER_ENABLED,\n        enabled,\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {createSelector} from 'reselect';\n\nimport {getUnreadChannelIds, getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {makeGetChannelsByCategory, makeGetCategoriesForTeam} from 'mattermost-redux/selectors/entities/channel_categories';\nimport {Channel} from 'mattermost-redux/types/channels';\nimport {ChannelCategory} from 'mattermost-redux/types/channel_categories';\nimport {RelationOneToOne} from 'mattermost-redux/types/utilities';\n\nimport {getItemFromStorage} from 'selectors/storage';\nimport {GlobalState} from 'types/store';\nimport {StoragePrefixes} from 'utils/constants';\nimport {getPrefix} from 'utils/storage_utils';\n\nexport function isCategoryCollapsedFromStorage(prefix: string, storage: {[key: string]: any}, categoryId: string) {\n    return getItemFromStorage(storage, prefix + StoragePrefixes.CHANNEL_CATEGORY_COLLAPSED + categoryId, false);\n}\n\nexport function isCategoryCollapsed(state: GlobalState, categoryId: string) {\n    return isUnreadFilterEnabled(state) || isCategoryCollapsedFromStorage(getPrefix(state), state.storage.storage, categoryId);\n}\n\nexport function isUnreadFilterEnabled(state: GlobalState) {\n    return state.views.channelSidebar.unreadFilterEnabled;\n}\n\nfunction makeGetCollapsedStateForAllCategoriesByTeam(): (state: GlobalState, teamId: string) => Record<string, boolean> {\n    const getCategoriesForTeam = makeGetCategoriesForTeam();\n\n    return createSelector(\n        getPrefix,\n        getCategoriesForTeam,\n        (state: GlobalState) => isUnreadFilterEnabled(state),\n        (state: GlobalState) => state.storage.storage,\n        (prefix: string, categories: ChannelCategory[], unreadFilterEnabled: boolean, storage: {[key: string]: any}) => {\n            return categories.reduce((map: Record<string, boolean>, category: ChannelCategory) => {\n                map[category.id] = isCategoryCollapsedFromStorage(prefix, storage, category.id) || unreadFilterEnabled;\n                return map;\n            }, {});\n        }\n    );\n}\n\nexport function makeGetCurrentlyDisplayedChannelsForTeam(): (state: GlobalState, teamId: string) => Channel[] {\n    const getCategoriesForTeam = makeGetCategoriesForTeam();\n    const getChannelsByCategory = makeGetChannelsByCategory();\n    const getCollapsedStateForAllCategoriesByTeam = makeGetCollapsedStateForAllCategoriesByTeam();\n\n    return createSelector(\n        getCollapsedStateForAllCategoriesByTeam,\n        getCategoriesForTeam,\n        getChannelsByCategory,\n        (state: GlobalState) => getCurrentChannel(state),\n        (state: GlobalState) => getUnreadChannelIds(state),\n        (collapsedState: Record<string, boolean>, categories: ChannelCategory[], channelsByCategory: RelationOneToOne<ChannelCategory, Channel[]>, currentChannel: Channel, unreadChannelIds: string[]) => {\n            return categories.map((category) => {\n                const channels = channelsByCategory[category.id];\n                const isCollapsed = collapsedState[category.id];\n\n                if (isCollapsed) {\n                    const filter = (channel: Channel) => {\n                        const filterByUnread = (channelId: string) => channel.id === channelId;\n                        const isUnread = unreadChannelIds.some(filterByUnread);\n                        if (currentChannel) {\n                            return isUnread || currentChannel.id === channel.id;\n                        }\n\n                        return isUnread;\n                    };\n                    return channels.filter(filter);\n                }\n\n                return channels;\n            }).flat();\n        }\n    );\n}","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\nimport classNames from 'classnames';\n\nimport {trackEvent} from 'actions/diagnostics_actions';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport {localizeMessage} from 'utils/utils';\n\ntype Props = {\n    unreadFilterEnabled: boolean;\n    actions: {\n        setUnreadFilterEnabled: (enabled: boolean) => void;\n    };\n};\n\ntype State = {\n\n};\n\nexport default class ChannelFilter extends React.PureComponent<Props, State> {\n    toggleUnreadFilter = () => {\n        const {unreadFilterEnabled} = this.props;\n\n        if (unreadFilterEnabled) {\n            trackEvent('ui', 'ui_sidebar_unread_filter_disabled');\n        } else {\n            trackEvent('ui', 'ui_sidebar_unread_filter_enabled');\n        }\n\n        this.props.actions.setUnreadFilterEnabled(!unreadFilterEnabled);\n    }\n\n    render() {\n        const {unreadFilterEnabled} = this.props;\n\n        let filterTitle = (\n            <FormattedMessage\n                id='sidebar_left.channel_filter.viewing'\n                defaultMessage='VIEWING:'\n            />\n        );\n\n        let filterDescription = (\n            <FormattedMessage\n                id='sidebar_left.channel_filter.allChannels'\n                defaultMessage='All channels'\n            />\n        );\n\n        let tooltipMessage = localizeMessage('sidebar_left.channel_filter.filterByUnread', 'Filter by unread');\n\n        if (unreadFilterEnabled) {\n            filterTitle = (\n                <FormattedMessage\n                    id='sidebar_left.channel_filter.filteredBy'\n                    defaultMessage='FILTERED BY:'\n                />\n            );\n\n            filterDescription = (\n                <FormattedMessage\n                    id='sidebar_left.channel_filter.unread'\n                    defaultMessage='Unread'\n                />\n            );\n\n            tooltipMessage = localizeMessage('sidebar_left.channel_filter.showAllChannels', 'Show all channels');\n        }\n\n        const tooltip = (\n            <Tooltip\n                id='new-group-tooltip'\n                className='hidden-xs'\n            >\n                {tooltipMessage}\n            </Tooltip>\n        );\n\n        return (\n            <div className='SidebarFilters'>\n                <a\n                    href='#'\n                    className={classNames('SidebarFilters_filterButton', {\n                        active: unreadFilterEnabled,\n                    })}\n                    onClick={this.toggleUnreadFilter}\n                    aria-label={tooltipMessage}\n                >\n                    <OverlayTrigger\n                        delayShow={500}\n                        placement='top'\n                        overlay={tooltip}\n                    >\n                        <i className='icon icon-filter-variant'/>\n                    </OverlayTrigger>\n                </a>\n                <div>\n                    <div className='SidebarFilters_filterTitle'>\n                        {filterTitle}\n                    </div>\n                    <div className='SidebarFilters_filterDescription'>\n                        {filterDescription}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch} from 'redux';\n\nimport {GenericAction} from 'mattermost-redux/types/actions';\n\nimport {setUnreadFilterEnabled} from 'actions/views/channel_sidebar';\nimport {isUnreadFilterEnabled} from 'selectors/views/channel_sidebar';\nimport {GlobalState} from 'types/store';\n\nimport ChannelFilter from './channel_filter';\n\nfunction mapStateToProps(state: GlobalState) {\n    return {\n        unreadFilterEnabled: isUnreadFilterEnabled(state),\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<GenericAction>) {\n    return {\n        actions: bindActionCreators({\n            setUnreadFilterEnabled,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelFilter);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\ntype Props = {\n    channelId: string;\n    unreadMentions: number;\n};\n\ntype State = {\n\n};\n\nexport default class ChannelMentionBadge extends React.PureComponent<Props, State> {\n    render() {\n        if (this.props.unreadMentions > 0) {\n            return (\n                <span\n                    id='unreadMentions'\n                    className='badge'\n                >\n                    {this.props.unreadMentions}\n                </span>\n            );\n        }\n\n        return null;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport {Channel} from 'mattermost-redux/types/channels';\n\nimport Constants from 'utils/constants';\nimport OverlayTrigger from 'components/overlay_trigger';\n\ntype Props = {\n    channel: Channel;\n    show: boolean;\n    closeHandler?: (callback: () => void) => void;\n};\n\nexport default class SidebarChannelClose extends React.PureComponent<Props> {\n    isLeaving: boolean;\n\n    constructor(props: Props) {\n        super(props);\n\n        this.isLeaving = false;\n    }\n\n    handleLeaveChannel = (e: React.MouseEvent<HTMLSpanElement, MouseEvent>) => {\n        e.preventDefault();\n        e.stopPropagation();\n        if (this.isLeaving || !this.props.closeHandler) {\n            return;\n        }\n\n        this.isLeaving = true;\n\n        this.props.closeHandler(() => {\n            this.isLeaving = false;\n        });\n    }\n\n    render() {\n        const {channel, closeHandler} = this.props;\n\n        if (!(this.props.show && closeHandler)) {\n            return null;\n        }\n\n        let removeTooltipMessage = (\n            <FormattedMessage\n                id='sidebar.removeList'\n                defaultMessage='Remove from list'\n            />\n        );\n\n        if (channel.type === Constants.OPEN_CHANNEL || channel.type === Constants.PRIVATE_CHANNEL) {\n            removeTooltipMessage = (\n                <FormattedMessage\n                    id='sidebar.leave'\n                    defaultMessage='Leave channel'\n                />\n            );\n        }\n\n        const closeButton = (\n            <OverlayTrigger\n                delayShow={1000}\n                placement='top'\n                overlay={(\n                    <Tooltip id='remove-dm-tooltip'>\n                        {removeTooltipMessage}\n                    </Tooltip>\n                )}\n            >\n                <span\n                    onClick={this.handleLeaveChannel}\n                    className='btn-close'\n                >\n                    {''}\n                </span>\n            </OverlayTrigger>\n        );\n\n        return closeButton;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {Channel} from 'mattermost-redux/types/channels';\n\nimport ArchiveIcon from 'components/widgets/icons/archive_icon';\nimport DraftIcon from 'components/widgets/icons/draft_icon';\n\ntype Props = {\n    icon: JSX.Element | null;\n    channel: Channel;\n    hasDraft: boolean;\n};\n\nexport default class SidebarChannelIcon extends React.PureComponent<Props> {\n    render() {\n        if (this.props.channel.delete_at !== 0) {\n            return (\n                <i className='icon icon-archive-outline'/>\n            );\n        } else if (this.props.hasDraft) {\n            return (\n                <i className='icon icon-pencil-outline'/>\n            );\n        }\n\n        return this.props.icon;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch} from 'redux';\n\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/channels';\nimport {GlobalState} from 'mattermost-redux/types/store';\nimport {GenericAction} from 'mattermost-redux/types/actions';\nimport {Channel} from 'mattermost-redux/types/channels';\n\nimport {getPostDraft} from 'selectors/rhs';\nimport {StoragePrefixes} from 'utils/constants';\n\nimport SidebarChannelIcon from './sidebar_channel_icon';\n\ntype OwnProps = {\n    channel: Channel;\n}\n\nfunction hasDraft(draft: any, currentChannelId: string, channelId: string) {\n    return draft && Boolean(draft.message.trim() || draft.fileInfos.length || draft.uploadsInProgress.length) && currentChannelId !== channelId;\n}\n\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\n    const currentChannelId = getCurrentChannelId(state);\n    const draft = ownProps.channel.id ? getPostDraft(state, StoragePrefixes.DRAFT, ownProps.channel.id) : false;\n\n    return {\n        hasDraft: hasDraft(draft, currentChannelId, ownProps.channel.id),\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<GenericAction>) {\n    return {\n        actions: bindActionCreators({\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SidebarChannelIcon);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport {Link} from 'react-router-dom';\nimport classNames from 'classnames';\n\nimport {Channel} from 'mattermost-redux/types/channels';\n\nimport CopyUrlContextMenu from 'components/copy_url_context_menu';\nimport OverlayTrigger from 'components/overlay_trigger';\n\nimport {mark, trackEvent} from 'actions/diagnostics_actions';\nimport {localizeMessage} from 'utils/utils';\nimport {isDesktopApp} from 'utils/user_agent';\nimport Constants from 'utils/constants';\nimport {browserHistory} from 'utils/browser_history';\n\nimport ChannelMentionBadge from '../channel_mention_badge';\nimport SidebarChannelClose from '../sidebar_channel_close';\nimport SidebarChannelIcon from '../sidebar_channel_icon';\n\ntype Props = {\n    channel: Channel;\n    link: string;\n    label: string;\n    ariaLabelPrefix?: string;\n    closeHandler?: (callback: () => void) => void;\n    icon: JSX.Element | null;\n\n    /**\n     * Number of unread mentions in this channel\n     */\n    unreadMentions: number;\n\n    /**\n     * Number of unread messages in this channel\n     */\n    unreadMsgs: number;\n\n    /**\n     * User preference of whether the channel can be marked unread\n     */\n    showUnreadForMsgs: boolean;\n\n    /**\n     * Checks if the current channel is muted\n     */\n    isMuted: boolean;\n};\n\ntype State = {\n    showTooltip: boolean;\n};\n\nexport default class SidebarChannelLink extends React.PureComponent<Props, State> {\n    labelRef: React.RefObject<HTMLSpanElement>;\n\n    constructor(props: Props) {\n        super(props);\n\n        this.labelRef = React.createRef();\n        this.state = {\n            showTooltip: false,\n        };\n    }\n\n    componentDidMount() {\n        this.enableToolTipIfNeeded();\n    }\n\n    componentDidUpdate(prevProps: Props) {\n        if (prevProps.label !== this.props.label) {\n            this.enableToolTipIfNeeded();\n        }\n    }\n\n    // TODO: Is there a better way to do this?\n    enableToolTipIfNeeded = () => {\n        const element = this.labelRef.current;\n        if (element && element.offsetWidth < element.scrollWidth) {\n            this.setState({showTooltip: true});\n        } else {\n            this.setState({showTooltip: false});\n        }\n    }\n\n    getAriaLabel = () => {\n        const {label, ariaLabelPrefix, unreadMentions} = this.props;\n\n        let ariaLabel = label;\n\n        if (ariaLabelPrefix) {\n            ariaLabel += ` ${ariaLabelPrefix}`;\n        }\n\n        if (unreadMentions === 1) {\n            ariaLabel += ` ${unreadMentions} ${localizeMessage('accessibility.sidebar.types.mention', 'mention')}`;\n        } else if (unreadMentions > 1) {\n            ariaLabel += ` ${unreadMentions} ${localizeMessage('accessibility.sidebar.types.mentions', 'mentions')}`;\n        }\n\n        if (this.showChannelAsUnread() && unreadMentions === 0) {\n            ariaLabel += ` ${localizeMessage('accessibility.sidebar.types.unread', 'unread')}`;\n        }\n\n        return ariaLabel.toLowerCase();\n    }\n\n    trackChannelSelectedEvent = () => {\n        mark('SidebarLink#click');\n        trackEvent('ui', 'ui_channel_selected_v2');\n    }\n\n    handleClick = () => {\n        this.trackChannelSelectedEvent();\n        browserHistory.push(this.props.link);\n    }\n\n    /**\n     * Show as unread if you have unread mentions\n     * OR if you have unread messages and the channel can be marked unread by preferences\n     */\n    showChannelAsUnread = () => {\n        return this.props.unreadMentions > 0 || (this.props.unreadMsgs > 0 && this.props.showUnreadForMsgs);\n    };\n\n    render() {\n        const {link, label, channel, unreadMentions, icon, isMuted} = this.props;\n        const content = (\n            <React.Fragment>\n                <SidebarChannelIcon\n                    channel={channel}\n                    icon={icon}\n                />\n                <span\n                    className={'SidebarChannelLinkLabel'}\n                    ref={this.labelRef}\n                >\n                    {label}\n                </span>\n                <ChannelMentionBadge\n                    channelId={channel.id}\n                    unreadMentions={unreadMentions}\n                />\n                <SidebarChannelClose\n                    channel={channel}\n                    show={!this.showChannelAsUnread()}\n                    closeHandler={this.props.closeHandler}\n                />\n            </React.Fragment>\n        );\n\n        let element;\n\n        // NOTE: class added to temporarily support the desktop app's at-mention DOM scraping of the old sidebar\n        const oldUnreadClass = this.showChannelAsUnread() ? 'unread-title' : '';\n        if (isDesktopApp()) {\n            element = (\n                <CopyUrlContextMenu\n                    link={this.props.link}\n                    menuId={channel.id}\n                >\n                    <button\n                        className={classNames(['btn btn-link SidebarLink', {muted: isMuted}, oldUnreadClass])}\n                        aria-label={this.getAriaLabel()}\n                        onClick={this.handleClick}\n                    >\n                        {content}\n                    </button>\n                </CopyUrlContextMenu>\n            );\n        } else {\n            element = (\n                <Link\n                    className={classNames(['SidebarLink', {muted: isMuted}, oldUnreadClass])}\n                    id={`sidebarItem_${channel.name}`}\n                    aria-label={this.getAriaLabel()}\n                    to={link}\n                    onClick={this.trackChannelSelectedEvent}\n                >\n                    {content}\n                </Link>\n            );\n        }\n\n        if (this.state.showTooltip) {\n            const displayNameToolTip = (\n                <Tooltip id='channel-displayname__tooltip'>\n                    {label}\n                </Tooltip>\n            );\n            element = (\n                <OverlayTrigger\n                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                    placement='top'\n                    overlay={displayNameToolTip}\n                >\n                    {element}\n                </OverlayTrigger>\n            );\n        }\n\n        return element;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch} from 'redux';\n\nimport {getMyChannelMemberships} from 'mattermost-redux/selectors/entities/common';\nimport {Channel} from 'mattermost-redux/types/channels';\nimport {GlobalState} from 'mattermost-redux/types/store';\nimport {GenericAction} from 'mattermost-redux/types/actions';\nimport {isChannelMuted} from 'mattermost-redux/utils/channel_utils';\n\nimport {NotificationLevels} from 'utils/constants';\n\nimport SidebarChannelLink from './sidebar_channel_link';\n\ntype OwnProps = {\n    channel: Channel;\n}\n\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\n    const member = getMyChannelMemberships(state)[ownProps.channel.id];\n\n    // Unread counts\n    let unreadMentions = 0;\n    let unreadMsgs = 0;\n    let showUnreadForMsgs = true;\n    if (member) {\n        unreadMentions = member.mention_count;\n\n        if (ownProps.channel) {\n            unreadMsgs = Math.max(ownProps.channel.total_msg_count - member.msg_count, 0);\n        }\n\n        if (member.notify_props) {\n            showUnreadForMsgs = member.notify_props.mark_unread !== NotificationLevels.MENTION;\n        }\n    }\n\n    return {\n        unreadMentions,\n        unreadMsgs,\n        showUnreadForMsgs,\n        isMuted: isChannelMuted(member),\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<GenericAction>) {\n    return {\n        actions: bindActionCreators({\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SidebarChannelLink);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {Channel} from 'mattermost-redux/types/channels';\n\nimport {trackEvent} from 'actions/diagnostics_actions';\nimport * as GlobalActions from 'actions/global_actions';\n\nimport GlobeIcon from 'components/widgets/icons/globe_icon';\nimport LockIcon from 'components/widgets/icons/lock_icon';\n\nimport SidebarChannelLink from 'components/sidebar/sidebar_channel/sidebar_channel_link';\nimport {localizeMessage} from 'utils/utils';\nimport Constants from 'utils/constants';\n\ntype Props = {\n    channel: Channel;\n    currentTeamName: string;\n    enableXToLeaveChannelsFromLHS?: string;\n    actions: {\n        leaveChannel: (channelId: any) => void;\n    };\n};\n\ntype State = {\n\n};\n\nexport default class SidebarBaseChannel extends React.PureComponent<Props, State> {\n    handleLeavePublicChannel = () => {\n        this.props.actions.leaveChannel(this.props.channel.id);\n        trackEvent('ui', 'ui_public_channel_x_button_clicked');\n    }\n\n    handleLeavePrivateChannel = () => {\n        GlobalActions.showLeavePrivateChannelModal({id: this.props.channel.id, display_name: this.props.channel.display_name});\n        trackEvent('ui', 'ui_private_channel_x_button_clicked');\n    }\n\n    getCloseHandler = () => {\n        const {channel, enableXToLeaveChannelsFromLHS} = this.props;\n\n        if (enableXToLeaveChannelsFromLHS === 'true') {\n            if (channel.type === Constants.OPEN_CHANNEL && channel.name !== Constants.DEFAULT_CHANNEL) {\n                return this.handleLeavePublicChannel;\n            } else if (channel.type === Constants.PRIVATE_CHANNEL) {\n                return this.handleLeavePrivateChannel;\n            }\n        }\n\n        return null;\n    }\n\n    getIcon = () => {\n        const {channel} = this.props;\n\n        if (channel.type === Constants.OPEN_CHANNEL) {\n            return (\n                <i className='icon icon-globe'/>\n            );\n        } else if (channel.type === Constants.PRIVATE_CHANNEL) {\n            return (\n                <i className='icon icon-lock-outline'/>\n            );\n        }\n\n        return null;\n    }\n\n    render() {\n        const {channel, currentTeamName} = this.props;\n\n        let ariaLabelPrefix;\n        if (channel.type === Constants.OPEN_CHANNEL) {\n            ariaLabelPrefix = localizeMessage('accessibility.sidebar.types.public', 'public channel');\n        } else if (channel.type === Constants.PRIVATE_CHANNEL) {\n            ariaLabelPrefix = localizeMessage('accessibility.sidebar.types.private', 'private channel');\n        }\n\n        return (\n            <SidebarChannelLink\n                channel={channel}\n                link={`/${currentTeamName}/channels/${channel.name}`}\n                label={channel.display_name}\n                ariaLabelPrefix={ariaLabelPrefix}\n                closeHandler={this.getCloseHandler()!}\n                icon={this.getIcon()!}\n            />\n        );\n    }\n}\n","\n// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch, ActionCreatorsMapObject} from 'redux';\n\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {GlobalState} from 'mattermost-redux/types/store';\nimport {ActionFunc} from 'mattermost-redux/types/actions';\n\nimport {leaveChannel} from 'actions/views/channel';\n\nimport SidebarBaseChannel from './sidebar_base_channel';\n\nfunction mapStateToProps(state: GlobalState) {\n    const config = getConfig(state);\n\n    return {\n        enableXToLeaveChannelsFromLHS: config.EnableXToLeaveChannelsFromLHS,\n    };\n}\n\ntype Actions = {\n    leaveChannel: (channelId: any) => Promise<{\n        error: any;\n        data?: undefined;\n    } | {\n        data: boolean;\n        error?: undefined;\n    }>;\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch) {\n    return {\n        actions: bindActionCreators<ActionCreatorsMapObject<ActionFunc>, Actions>({\n            leaveChannel,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SidebarBaseChannel);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\ntype Props = {\n    className: string;\n    status: string;\n}\n\nexport default class StatusIconNew extends React.PureComponent<Props> {\n    static defaultProps: Props = {\n        className: '',\n        status: '',\n    };\n\n    render() {\n        const {status, className} = this.props;\n\n        if (!status) {\n            return null;\n        }\n\n        let iconName = 'icon-circle-outline';\n        if (status === 'online') {\n            iconName = 'icon-check-circle';\n        } else if (status === 'away') {\n            iconName = 'icon-clock';\n        } else if (status === 'dnd') {\n            iconName = 'icon-minus-circle';\n        }\n\n        return <i className={`${iconName} ${className}`}/>;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {IntlShape, injectIntl} from 'react-intl';\nimport Svg from 'react-inlinesvg';\n\nimport {Channel} from 'mattermost-redux/types/channels';\nimport {UserProfile} from 'mattermost-redux/types/users';\nimport {PreferenceType} from 'mattermost-redux/types/preferences';\n\nimport {trackEvent} from 'actions/diagnostics_actions';\nimport {browserHistory} from 'utils/browser_history';\nimport {Constants} from 'utils/constants';\n\nimport StatusIconNew from 'components/status_icon_new';\nimport SidebarChannelLink from '../sidebar_channel_link';\n\ntype Props = {\n    intl: IntlShape;\n    channel: Channel;\n    teammate?: UserProfile;\n    currentTeamName: string;\n    currentUserId: string;\n    redirectChannel: string;\n    active: boolean;\n    botIconUrl: string | null;\n    actions: {\n        savePreferences: (userId: string, preferences: PreferenceType[]) => Promise<{data: boolean}>;\n    };\n};\n\ntype State = {\n    svgErrorUrl: string | null;\n};\n\nclass SidebarDirectChannel extends React.PureComponent<Props, State> {\n    constructor(props: Props) {\n        super(props);\n\n        this.state = {\n            svgErrorUrl: null,\n        };\n    }\n\n    handleLeaveChannel = (callback: () => void) => {\n        const id = this.props.channel.teammate_id;\n        const category = Constants.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW;\n\n        const currentUserId = this.props.currentUserId;\n        this.props.actions.savePreferences(currentUserId, [{user_id: currentUserId, category, name: id!, value: 'false'}]).then(callback);\n\n        trackEvent('ui', 'ui_direct_channel_x_button_clicked');\n\n        if (this.props.active) {\n            browserHistory.push(`/${this.props.currentTeamName}/channels/${this.props.redirectChannel}`);\n        }\n    }\n\n    onSvgLoadError = () => {\n        this.setState({\n            svgErrorUrl: this.props.botIconUrl,\n        });\n    }\n\n    onSvgLoad = () => {\n        this.setState({\n            svgErrorUrl: null,\n        });\n    }\n\n    getIcon = () => {\n        const {channel, teammate} = this.props;\n\n        if (!teammate) {\n            return null;\n        }\n\n        if (teammate.id && teammate.delete_at) {\n            return (\n                <i className='icon icon-archive-outline'/>\n            );\n        } else if (teammate.id && teammate.is_bot) {\n            // Use default bot icon\n            let icon = (<i className='icon icon-robot-happy'/>);\n\n            // Attempt to display custom icon if botIconUrl has changed\n            // or if there was no error when loading custom svg\n            if (this.props.botIconUrl &&\n                this.props.botIconUrl !== this.state.svgErrorUrl) {\n                icon = (\n                    <Svg\n                        className='icon icon-robot-happy'\n                        src={this.props.botIconUrl}\n                        onLoad={this.onSvgLoad}\n                        onError={this.onSvgLoadError}\n                    />\n                );\n            }\n            return icon;\n        }\n\n        let className = '';\n        if (channel.status === 'online') {\n            className = 'status-online';\n        } else if (channel.status === 'away') {\n            className = 'status-away';\n        } else if (channel.status === 'dnd') {\n            className = 'status-dnd';\n        }\n\n        return (\n            <StatusIconNew\n                status={channel.status}\n                className={className}\n            />\n        );\n    }\n\n    render() {\n        const {channel, teammate, currentTeamName} = this.props;\n\n        if (!teammate) {\n            return null;\n        }\n\n        let displayName = channel.display_name;\n        if (this.props.currentUserId === teammate.id) {\n            displayName = this.props.intl.formatMessage({\n                id: 'sidebar.directchannel.you',\n                defaultMessage: '{displayname} (you)',\n            }, {\n                displayname: channel.display_name,\n            });\n        }\n\n        return (\n            <SidebarChannelLink\n                channel={channel}\n                link={`/${currentTeamName}/messages/@${teammate.username}`}\n                label={displayName}\n                closeHandler={this.handleLeaveChannel}\n                icon={this.getIcon()}\n            />\n        );\n    }\n}\n\nexport default injectIntl(SidebarDirectChannel);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch, ActionCreatorsMapObject} from 'redux';\n\nimport {Client4} from 'mattermost-redux/client';\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\nimport {ActionFunc} from 'mattermost-redux/types/actions';\nimport {PreferenceType} from 'mattermost-redux/types/preferences';\nimport {GlobalState} from 'mattermost-redux/types/store';\nimport {Channel} from 'mattermost-redux/types/channels';\nimport {UserProfile} from 'mattermost-redux/types/users';\nimport {getCurrentChannelId, getRedirectChannelNameForTeam} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentUser, getUser} from 'mattermost-redux/selectors/entities/users';\n\nimport SidebarDirectChannel from './sidebar_direct_channel';\n\ntype OwnProps = {\n    channel: Channel;\n    currentTeamName: string;\n}\n\n/**\n * Gets the LHS bot icon url for a given botUser.\n */\nfunction botIconImageUrl(botUser: UserProfile & {bot_last_icon_update?: number}) {\n    if (!botUser) {\n        return null;\n    }\n\n    if (!(botUser.is_bot && botUser.bot_last_icon_update)) {\n        return null;\n    }\n\n    return `${Client4.getBotRoute(botUser.id)}/icon?_=${(botUser.bot_last_icon_update || 0)}`;\n}\n\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\n    const teammate = getUser(state, ownProps.channel.teammate_id!);\n    const currentUser = getCurrentUser(state);\n    const currentTeam = getCurrentTeam(state);\n    const redirectChannel = getRedirectChannelNameForTeam(state, currentTeam.id);\n    const currentChannelId = getCurrentChannelId(state);\n    const active = ownProps.channel.id === currentChannelId;\n\n    return {\n        teammate,\n        currentUserId: currentUser.id,\n        redirectChannel,\n        active,\n        botIconUrl: botIconImageUrl(teammate),\n    };\n}\n\ntype Actions = {\n    savePreferences: (userId: string, preferences: PreferenceType[]) => Promise<{\n        data: boolean;\n    }>;\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch) {\n    return {\n        actions: bindActionCreators<ActionCreatorsMapObject<ActionFunc>, Actions>({\n            savePreferences,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SidebarDirectChannel);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {Channel} from 'mattermost-redux/types/channels';\nimport {PreferenceType} from 'mattermost-redux/types/preferences';\n\nimport {trackEvent} from 'actions/diagnostics_actions';\nimport {browserHistory} from 'utils/browser_history';\nimport Constants from 'utils/constants';\n\nimport SidebarChannelLink from 'components/sidebar/sidebar_channel/sidebar_channel_link';\n\ntype Props = {\n    channel: Channel;\n    currentTeamName: string;\n    currentUserId: string;\n    redirectChannel: string;\n    active: boolean;\n    membersCount: number;\n    actions: {\n        savePreferences: (userId: string, preferences: PreferenceType[]) => Promise<{data: boolean}>;\n    };\n};\n\ntype State = {\n\n};\n\nexport default class SidebarGroupChannel extends React.PureComponent<Props, State> {\n    handleLeaveChannel = (callback: () => void) => {\n        const id = this.props.channel.id;\n        const category = Constants.Preferences.CATEGORY_GROUP_CHANNEL_SHOW;\n\n        const currentUserId = this.props.currentUserId;\n        this.props.actions.savePreferences(currentUserId, [{user_id: currentUserId, category, name: id, value: 'false'}]).then(callback);\n\n        trackEvent('ui', 'ui_direct_channel_x_button_clicked');\n\n        if (this.props.active) {\n            browserHistory.push(`/${this.props.currentTeamName}/channels/${this.props.redirectChannel}`);\n        }\n    }\n\n    getIcon = () => {\n        return (\n            <div className='status status--group'>{this.props.membersCount}</div>\n        );\n    }\n\n    render() {\n        const {channel, currentTeamName} = this.props;\n\n        return (\n            <SidebarChannelLink\n                channel={channel}\n                link={`/${currentTeamName}/messages/${channel.name}`}\n                label={channel.display_name}\n                closeHandler={this.handleLeaveChannel}\n                icon={this.getIcon()}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch, ActionCreatorsMapObject} from 'redux';\n\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\nimport {ActionFunc} from 'mattermost-redux/types/actions';\nimport {PreferenceType} from 'mattermost-redux/types/preferences';\nimport {GlobalState} from 'mattermost-redux/types/store';\nimport {Channel} from 'mattermost-redux/types/channels';\nimport {getCurrentChannelId, getRedirectChannelNameForTeam} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {getUserIdsInChannels, getCurrentUser} from 'mattermost-redux/selectors/entities/users';\n\nimport SidebarGroupChannel from './sidebar_group_channel';\n\ntype OwnProps = {\n    channel: Channel;\n}\n\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\n    const currentUser = getCurrentUser(state);\n    const currentTeam = getCurrentTeam(state);\n    const redirectChannel = getRedirectChannelNameForTeam(state, currentTeam.id);\n    const currentChannelId = getCurrentChannelId(state);\n    const active = ownProps.channel.id === currentChannelId;\n\n    const memberIds = getUserIdsInChannels(state);\n\n    let membersCount = 0;\n    if (memberIds && memberIds[ownProps.channel.id]) {\n        const groupMemberIds: Set<string> = memberIds[ownProps.channel.id] as unknown as Set<string>;\n        membersCount = groupMemberIds.size;\n        if (groupMemberIds.has(currentUser.id)) {\n            membersCount--;\n        }\n    }\n\n    return {\n        currentUserId: currentUser.id,\n        redirectChannel,\n        active,\n        membersCount,\n    };\n}\n\ntype Actions = {\n    savePreferences: (userId: string, preferences: PreferenceType[]) => Promise<{\n        data: boolean;\n    }>;\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch) {\n    return {\n        actions: bindActionCreators<ActionCreatorsMapObject<ActionFunc>, Actions>({\n            savePreferences,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SidebarGroupChannel);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport classNames from 'classnames';\n\nimport {Channel} from 'mattermost-redux/types/channels';\n\nimport Constants from 'utils/constants';\n\nimport SidebarBaseChannel from './sidebar_base_channel';\nimport SidebarDirectChannel from './sidebar_direct_channel';\nimport SidebarGroupChannel from './sidebar_group_channel';\n\ntype Props = {\n\n    /**\n     * The channel object for this channel list item\n     */\n    channel: Channel;\n\n    /**\n     * If in a DM, the name of the user your DM is with\n     */\n    teammateUsername?: string;\n\n    /**\n     * The current team you are on\n     */\n    currentTeamName: string;\n\n    /**\n     * Number of unread mentions in this channel\n     */\n    unreadMentions: number;\n\n    /**\n     * Number of unread messages in this channel\n     */\n    unreadMsgs: number;\n\n    /**\n     * User preference of whether the channel can be marked unread\n     */\n    showUnreadForMsgs: boolean;\n\n    /**\n     * Gets the ref for a given channel id\n     */\n    getChannelRef: (channelId: string) => HTMLLIElement | undefined;\n\n    /**\n     * Sets the ref for the sidebar channel div element, so that it can be used by parent components\n     */\n    setChannelRef: (channelId: string, ref: HTMLLIElement) => void;\n\n    /**\n     * If category is collapsed\n     */\n    isCategoryCollapsed: boolean;\n\n    /**\n     * Is the channel the currently focused channel\n     */\n    isCurrentChannel: boolean;\n};\n\ntype State = {\n\n};\n\nexport default class SidebarChannel extends React.PureComponent<Props, State> {\n    isUnread = () => {\n        return this.props.unreadMentions > 0 || (this.props.unreadMsgs > 0 && this.props.showUnreadForMsgs);\n    }\n\n    isCollapsed = (props: Props) => {\n        return props.isCategoryCollapsed && !this.isUnread() && !props.isCurrentChannel;\n    }\n\n    componentDidUpdate(prevProps: Props) {\n        if (this.isCollapsed(this.props) !== this.isCollapsed(prevProps)) {\n            const channelElement = this.getRef();\n            if (channelElement) {\n                channelElement.classList.add('animating');\n            }\n        }\n    }\n\n    removeAnimation = () => {\n        const channelElement = this.getRef();\n        if (channelElement) {\n            channelElement.classList.remove('animating');\n        }\n    }\n\n    getRef = () => {\n        return this.props.getChannelRef(this.props.channel.id);\n    }\n\n    setRef = (ref: HTMLLIElement) => {\n        this.props.setChannelRef(this.props.channel.id, ref);\n    }\n\n    render() {\n        const {channel, currentTeamName} = this.props;\n\n        let ChannelComponent: React.ComponentType<{channel: Channel; currentTeamName: string}> = SidebarBaseChannel;\n        if (channel.type === Constants.DM_CHANNEL) {\n            ChannelComponent = SidebarDirectChannel;\n        } else if (channel.type === Constants.GM_CHANNEL) {\n            ChannelComponent = SidebarGroupChannel;\n        }\n\n        return (\n            <li\n                role='listitem'\n                draggable='false'\n                ref={this.setRef}\n                className={classNames('SidebarChannel', {\n                    collapsed: this.isCollapsed(this.props),\n                    unread: this.isUnread(),\n                    active: this.props.isCurrentChannel,\n                })}\n                onTransitionEnd={this.removeAnimation}\n            >\n                <ChannelComponent\n                    channel={channel}\n                    currentTeamName={currentTeamName}\n                />\n            </li>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {GlobalState} from 'mattermost-redux/types/store';\n\nimport {getMyChannelMemberships} from 'mattermost-redux/selectors/entities/common';\nimport {getCurrentChannelId, makeGetChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\n\nimport {NotificationLevels} from 'utils/constants';\n\nimport SidebarChannel from './sidebar_channel';\n\ntype OwnProps = {\n    channelId: string;\n}\n\nfunction makeMapStateToProps() {\n    const getChannel = makeGetChannel();\n\n    return (state: GlobalState, ownProps: OwnProps) => {\n        const channel = getChannel(state, {id: ownProps.channelId});\n        const currentTeam = getCurrentTeam(state);\n\n        const member = getMyChannelMemberships(state)[ownProps.channelId];\n        const currentChannelId = getCurrentChannelId(state);\n\n        // Unread counts\n        let unreadMentions = 0;\n        let unreadMsgs = 0;\n        let showUnreadForMsgs = true;\n        if (member) {\n            unreadMentions = member.mention_count;\n\n            if (channel) {\n                unreadMsgs = Math.max(channel.total_msg_count - member.msg_count, 0);\n            }\n\n            if (member.notify_props) {\n                showUnreadForMsgs = member.notify_props.mark_unread !== NotificationLevels.MENTION;\n            }\n        }\n\n        return {\n            channel,\n            isCurrentChannel: channel.id === currentChannelId,\n            currentTeamName: currentTeam.name,\n            unreadMentions,\n            unreadMsgs,\n            showUnreadForMsgs,\n        };\n    };\n}\n\nexport default connect(makeMapStateToProps)(SidebarChannel);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Tooltip} from 'react-bootstrap';\nimport classNames from 'classnames';\n\nimport {CategoryTypes} from 'mattermost-redux/constants/channel_categories';\nimport {Channel} from 'mattermost-redux/types/channels';\nimport {ChannelCategory} from 'mattermost-redux/types/channel_categories';\nimport {localizeMessage} from 'mattermost-redux/utils/i18n_utils';\n\nimport {trackEvent} from 'actions/diagnostics_actions';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport Constants, {A11yCustomEventTypes} from 'utils/constants';\nimport {isKeyPressed} from 'utils/utils';\n\nimport SidebarChannel from '../sidebar_channel';\n\ntype Props = {\n    category: ChannelCategory;\n    channels: Channel[];\n    setChannelRef: (channelId: string, ref: HTMLLIElement) => void;\n    handleOpenMoreDirectChannelsModal: (e: Event) => void;\n    getChannelRef: (channelId: string) => HTMLLIElement | undefined;\n    isCollapsed: boolean;\n    actions: {\n        setCategoryCollapsed: (categoryId: string, collapsed: boolean) => void;\n    };\n};\n\nexport default class SidebarCategory extends React.PureComponent<Props> {\n    categoryTitleRef: React.RefObject<HTMLButtonElement>;\n\n    constructor(props: Props) {\n        super(props);\n\n        this.categoryTitleRef = React.createRef();\n    }\n\n    componentDidMount() {\n        // Refs can be null when this component is shallowly rendered for testing\n        if (this.categoryTitleRef.current) {\n            this.categoryTitleRef.current.addEventListener(A11yCustomEventTypes.ACTIVATE, this.handleA11yActivateEvent);\n            this.categoryTitleRef.current.addEventListener(A11yCustomEventTypes.DEACTIVATE, this.handleA11yDeactivateEvent);\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.categoryTitleRef.current) {\n            this.categoryTitleRef.current.removeEventListener(A11yCustomEventTypes.ACTIVATE, this.handleA11yActivateEvent);\n            this.categoryTitleRef.current.removeEventListener(A11yCustomEventTypes.DEACTIVATE, this.handleA11yDeactivateEvent);\n        }\n    }\n\n    handleA11yActivateEvent = () => {\n        if (this.categoryTitleRef.current) {\n            this.categoryTitleRef.current.addEventListener('keydown', this.handleA11yKeyDown);\n        }\n    }\n\n    handleA11yDeactivateEvent = () => {\n        if (this.categoryTitleRef.current) {\n            this.categoryTitleRef.current.removeEventListener('keydown', this.handleA11yKeyDown);\n        }\n    }\n\n    handleA11yKeyDown = (e: KeyboardEvent) => {\n        if (isKeyPressed(e, Constants.KeyCodes.ENTER)) {\n            this.handleCollapse();\n        }\n    }\n\n    renderChannel = (channel: Channel) => {\n        const {isCollapsed, setChannelRef, getChannelRef} = this.props;\n\n        return (\n            <SidebarChannel\n                key={channel.id}\n                channelId={channel.id}\n                setChannelRef={setChannelRef}\n                getChannelRef={getChannelRef}\n                isCategoryCollapsed={isCollapsed}\n            />\n        );\n    }\n\n    handleCollapse = () => {\n        const {category, isCollapsed} = this.props;\n\n        if (isCollapsed) {\n            trackEvent('ui', 'ui_sidebar_expand_category');\n        } else {\n            trackEvent('ui', 'ui_sidebar_collapse_category');\n        }\n\n        this.props.actions.setCategoryCollapsed(category.id, !isCollapsed);\n    }\n\n    handleOpenDirectMessagesModal = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\n        e.stopPropagation();\n        this.props.handleOpenMoreDirectChannelsModal(e.nativeEvent);\n    }\n\n    render() {\n        const {category, isCollapsed, channels} = this.props;\n        if (!category) {\n            return null;\n        }\n\n        if (category.type !== CategoryTypes.DIRECT_MESSAGES && (!channels || !channels.length)) {\n            return null;\n        }\n\n        const renderedChannels = channels.map(this.renderChannel);\n\n        let directMessagesModalButton;\n        let hideArrow = false;\n        if (category.type === CategoryTypes.DIRECT_MESSAGES) {\n            const helpLabel = localizeMessage('sidebar.createDirectMessage', 'Create new direct message');\n\n            const tooltip = (\n                <Tooltip\n                    id='new-group-tooltip'\n                    className='hidden-xs'\n                >\n                    {helpLabel}\n                </Tooltip>\n            );\n\n            directMessagesModalButton = (\n                <button\n                    className='SidebarChannelGroupHeader_addButton'\n                    onClick={this.handleOpenDirectMessagesModal}\n                    aria-label={helpLabel}\n                >\n                    <OverlayTrigger\n                        delayShow={500}\n                        placement='top'\n                        overlay={tooltip}\n                    >\n                        <i className='icon-plus'/>\n                    </OverlayTrigger>\n                </button>\n            );\n\n            if (!channels || !channels.length) {\n                hideArrow = true;\n            }\n        }\n\n        let displayName = category.display_name;\n        if (category.type !== CategoryTypes.CUSTOM) {\n            displayName = localizeMessage(`sidebar.types.${category.type}`, category.display_name);\n        }\n\n        return (\n            <div className='SidebarChannelGroup a11y__section'>\n                <div className='SidebarChannelGroupHeader'>\n                    <button\n                        ref={this.categoryTitleRef}\n                        className={classNames('SidebarChannelGroupHeader_groupButton', {favorites: category.type === CategoryTypes.FAVORITES})}\n                        onClick={this.handleCollapse}\n                        aria-label={displayName}\n                    >\n                        <i\n                            className={classNames('icon icon-chevron-down', {\n                                'icon-rotate-minus-90': isCollapsed,\n                                'hide-arrow': hideArrow,\n                            })}\n                        />\n                        <div>\n                            {displayName}\n                        </div>\n                        {directMessagesModalButton}\n                    </button>\n                </div>\n                <div className='SidebarChannelGroup_content'>\n                    <ul\n                        role='list'\n                        className='NavGroupContent'\n                    >\n                        {renderedChannels}\n                    </ul>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch} from 'redux';\n\nimport {makeGetChannelsForCategory} from 'mattermost-redux/selectors/entities/channel_categories';\nimport {GenericAction} from 'mattermost-redux/types/actions';\nimport {ChannelCategory} from 'mattermost-redux/types/channel_categories';\n\nimport {setCategoryCollapsed} from 'actions/views/channel_sidebar';\nimport {isCategoryCollapsed} from 'selectors/views/channel_sidebar';\nimport {GlobalState} from 'types/store';\n\nimport SidebarCategory from './sidebar_category';\n\ntype OwnProps = {\n    category: ChannelCategory;\n}\n\nfunction makeMapStateToProps() {\n    const getChannelsForCategory = makeGetChannelsForCategory();\n\n    return (state: GlobalState, ownProps: OwnProps) => {\n        return {\n            isCollapsed: isCategoryCollapsed(state, ownProps.category.id),\n            channels: getChannelsForCategory(state, ownProps.category),\n        };\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<GenericAction>) {\n    return {\n        actions: bindActionCreators({\n            setCategoryCollapsed,\n        }, dispatch),\n    };\n}\n\nexport default connect(makeMapStateToProps, mapDispatchToProps)(SidebarCategory);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport Scrollbars from 'react-custom-scrollbars';\nimport {Spring, SpringSystem} from 'rebound';\nimport classNames from 'classnames';\nimport debounce from 'lodash/debounce';\n\nimport {Channel} from 'mattermost-redux/types/channels';\nimport {ChannelCategory} from 'mattermost-redux/types/channel_categories';\nimport {Team} from 'mattermost-redux/types/teams';\nimport {RelationOneToOne} from 'mattermost-redux/types/utilities';\n\nimport UnreadChannelIndicator from 'components/unread_channel_indicator';\nimport {Constants} from 'utils/constants';\nimport * as Utils from 'utils/utils';\nimport * as ChannelUtils from 'utils/channel_utils.jsx';\n\nimport SidebarCategory from '../sidebar_category';\n\nexport function renderView(props: any) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--view'\n        />);\n}\n\nexport function renderThumbHorizontal(props: any) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--horizontal'\n        />);\n}\n\nexport function renderThumbVertical(props: any) {\n    return (\n        <div\n            {...props}\n            className='scrollbar--vertical'\n        />);\n}\n\ntype Props = {\n    currentTeam: Team;\n    currentChannel: Channel;\n    categories: ChannelCategory[];\n    unreadChannelIds: string[];\n    isUnreadFilterEnabled: boolean;\n    handleOpenMoreDirectChannelsModal: (e: Event) => void;\n    displayedChannels: Channel[];\n    actions: {\n        switchToChannelById: (channelId: string) => void;\n        close: () => void;\n    };\n};\n\ntype State = {\n    showTopUnread: boolean;\n    showBottomUnread: boolean;\n};\n\n// scrollMargin is the margin at the edge of the channel list that we leave when scrolling to a channel.\nconst scrollMargin = 10;\n\n// categoryHeaderHeight is the height of the category header\nconst categoryHeaderHeight = 32;\n\n// scrollMarginWithUnread is the margin that we leave at the edge of the channel list when scrolling to a channel so\n// that the channel is not under the unread indicator.\nconst scrollMarginWithUnread = 55;\n\nexport default class SidebarCategoryList extends React.PureComponent<Props, State> {\n    channelRefs: Map<string, HTMLLIElement>;\n    scrollbar: React.RefObject<Scrollbars>;\n    animate: SpringSystem;\n    scrollAnimation: Spring;\n\n    constructor(props: Props) {\n        super(props);\n\n        this.channelRefs = new Map();\n        this.state = {\n            showTopUnread: false,\n            showBottomUnread: false,\n        };\n        this.scrollbar = React.createRef();\n\n        this.animate = new SpringSystem();\n        this.scrollAnimation = this.animate.createSpring();\n        this.scrollAnimation.setOvershootClampingEnabled(true); // disables the spring action at the end of animation\n        this.scrollAnimation.addListener({onSpringUpdate: this.handleScrollAnimationUpdate});\n    }\n\n    componentDidMount() {\n        document.addEventListener('keydown', this.navigateChannelShortcut);\n        document.addEventListener('keydown', this.navigateUnreadChannelShortcut);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.navigateChannelShortcut);\n        document.removeEventListener('keydown', this.navigateUnreadChannelShortcut);\n    }\n\n    componentDidUpdate(prevProps: Props) {\n        if (!this.props.currentChannel || !prevProps.currentChannel) {\n            return;\n        }\n\n        // reset the scrollbar upon switching teams\n        if (this.props.currentTeam !== prevProps.currentTeam) {\n            this.scrollbar.current!.scrollToTop();\n        }\n\n        // Scroll to selected channel so it's in view\n        if (this.props.currentChannel.id !== prevProps.currentChannel.id) {\n            // This will be re-enabled when we can avoid animating the scroll on first load and team switch\n            // this.scrollToChannel(this.props.currentChannel.id);\n        }\n\n        // TODO: Copying over so it doesn't get lost, but we don't have a design for the sidebar on mobile yet\n        // close the LHS on mobile when you change channels\n        if (this.props.currentChannel.id !== prevProps.currentChannel.id) {\n            this.props.actions.close();\n        }\n\n        this.updateUnreadIndicators();\n    }\n\n    getDisplayedChannelIds = () => {\n        return this.props.displayedChannels.map((channel) => channel.id);\n    }\n\n    getChannelRef = (channelId: string) => {\n        return this.channelRefs.get(channelId);\n    }\n\n    setChannelRef = (channelId: string, ref: HTMLLIElement) => {\n        if (ref) {\n            this.channelRefs.set(channelId, ref);\n        } else {\n            this.channelRefs.delete(channelId);\n        }\n    }\n\n    getFirstUnreadChannelFromChannelIdArray = (channelIds: string[]) => {\n        if (!this.props.currentChannel) {\n            return null;\n        }\n\n        return channelIds.find((channelId) => {\n            return channelId !== this.props.currentChannel!.id && this.props.unreadChannelIds.includes(channelId);\n        });\n    }\n\n    handleScrollAnimationUpdate = (spring: Spring) => {\n        const val = spring.getCurrentValue();\n        this.scrollbar.current!.scrollTop(val);\n    }\n\n    scrollToFirstUnreadChannel = () => {\n        this.scrollToChannel(this.getFirstUnreadChannel(), true);\n    }\n\n    scrollToLastUnreadChannel = () => {\n        this.scrollToChannel(this.getLastUnreadChannel(), true);\n    }\n\n    scrollToChannel = (channelId: string | null | undefined, scrollingToUnread = false) => {\n        if (!channelId) {\n            return;\n        }\n\n        const element = this.channelRefs.get(channelId);\n        if (!element) {\n            return;\n        }\n\n        const top = element.offsetTop;\n        const bottom = top + element.offsetHeight;\n\n        const scrollTop = this.scrollbar.current!.getScrollTop();\n        const scrollHeight = this.scrollbar.current!.getClientHeight();\n\n        if (top < (scrollTop + categoryHeaderHeight)) {\n            // Scroll up to the item\n            const margin = (scrollingToUnread || !this.state.showTopUnread) ? scrollMargin : scrollMarginWithUnread;\n\n            let scrollEnd;\n            const displayedChannels = this.getDisplayedChannelIds();\n            if (displayedChannels.length > 0 && displayedChannels[0] === channelId) {\n                // This is the first channel, so scroll right to the top\n                scrollEnd = 0;\n            } else {\n                scrollEnd = top - margin - categoryHeaderHeight;\n            }\n\n            this.scrollToPosition(scrollEnd);\n        } else if (bottom > scrollTop + scrollHeight) {\n            // Scroll down to the item\n            const margin = (scrollingToUnread || !this.state.showBottomUnread) ? scrollMargin : scrollMarginWithUnread;\n            const scrollEnd = (bottom - scrollHeight) + margin;\n\n            this.scrollToPosition(scrollEnd);\n        }\n    }\n\n    scrollToPosition = (scrollEnd: number) => {\n        // Stop the current animation before scrolling\n        this.scrollAnimation.setCurrentValue(this.scrollbar.current!.getScrollTop()).setAtRest();\n\n        this.scrollAnimation.setEndValue(scrollEnd);\n    }\n\n    updateUnreadIndicators = () => {\n        let showTopUnread = false;\n        let showBottomUnread = false;\n\n        // Consider partially obscured channels as above/below\n        const firstUnreadChannel = this.getFirstUnreadChannel();\n        const lastUnreadChannel = this.getLastUnreadChannel();\n\n        if (firstUnreadChannel) {\n            const firstUnreadElement = this.channelRefs.get(firstUnreadChannel);\n            const firstUnreadPosition = firstUnreadElement ? firstUnreadElement.offsetTop : null;\n\n            if (firstUnreadPosition && ((firstUnreadPosition + firstUnreadElement!.offsetHeight) - scrollMargin - categoryHeaderHeight) < this.scrollbar.current!.getScrollTop()) {\n                showTopUnread = true;\n            }\n        }\n\n        if (lastUnreadChannel) {\n            const lastUnreadElement = this.channelRefs.get(lastUnreadChannel);\n            const lastUnreadPosition = lastUnreadElement ? lastUnreadElement.offsetTop : null;\n\n            if (lastUnreadPosition && (lastUnreadPosition + scrollMargin) > (this.scrollbar.current!.getScrollTop() + this.scrollbar.current!.getClientHeight())) {\n                showBottomUnread = true;\n            }\n        }\n        if (showTopUnread !== this.state.showTopUnread || showBottomUnread !== this.state.showBottomUnread) {\n            this.setState({\n                showTopUnread,\n                showBottomUnread,\n            });\n        }\n    }\n\n    getFirstUnreadChannel = () => {\n        return this.getFirstUnreadChannelFromChannelIdArray(this.getDisplayedChannelIds());\n    }\n\n    getLastUnreadChannel = () => {\n        return this.getFirstUnreadChannelFromChannelIdArray(this.getDisplayedChannelIds().reverse());\n    }\n\n    navigateChannelShortcut = (e: KeyboardEvent) => {\n        if (e.altKey && !e.shiftKey && (Utils.isKeyPressed(e, Constants.KeyCodes.UP) || Utils.isKeyPressed(e, Constants.KeyCodes.DOWN))) {\n            e.preventDefault();\n\n            const allChannelIds = this.getDisplayedChannelIds();\n            const curChannelId = this.props.currentChannel!.id;\n            let curIndex = -1;\n            for (let i = 0; i < allChannelIds.length; i++) {\n                if (allChannelIds[i] === curChannelId) {\n                    curIndex = i;\n                }\n            }\n            let nextIndex = curIndex;\n            if (Utils.isKeyPressed(e, Constants.KeyCodes.DOWN)) {\n                nextIndex = curIndex + 1;\n            } else {\n                nextIndex = curIndex - 1;\n            }\n            const nextChannelId = allChannelIds[Utils.mod(nextIndex, allChannelIds.length)];\n            this.props.actions.switchToChannelById(nextChannelId);\n            this.scrollToChannel(nextChannelId);\n        } else if (Utils.cmdOrCtrlPressed(e) && e.shiftKey && Utils.isKeyPressed(e, Constants.KeyCodes.K)) {\n            this.props.handleOpenMoreDirectChannelsModal(e);\n        }\n    };\n\n    navigateUnreadChannelShortcut = (e: KeyboardEvent) => {\n        if (e.altKey && e.shiftKey && (Utils.isKeyPressed(e, Constants.KeyCodes.UP) || Utils.isKeyPressed(e, Constants.KeyCodes.DOWN))) {\n            e.preventDefault();\n\n            const allChannelIds = this.getDisplayedChannelIds();\n\n            let direction = 0;\n            if (Utils.isKeyPressed(e, Constants.KeyCodes.UP)) {\n                direction = -1;\n            } else {\n                direction = 1;\n            }\n\n            const nextIndex = ChannelUtils.findNextUnreadChannelId(\n                this.props.currentChannel!.id,\n                allChannelIds,\n                this.props.unreadChannelIds,\n                direction\n            );\n\n            if (nextIndex !== -1) {\n                const nextChannelId = allChannelIds[nextIndex];\n                this.props.actions.switchToChannelById(nextChannelId);\n                this.scrollToChannel(nextChannelId);\n            }\n        }\n    };\n\n    renderCategory = (category: ChannelCategory) => {\n        return (\n            <SidebarCategory\n                key={category.id}\n                category={category}\n                setChannelRef={this.setChannelRef}\n                handleOpenMoreDirectChannelsModal={this.props.handleOpenMoreDirectChannelsModal}\n                getChannelRef={this.getChannelRef}\n            />\n        );\n    }\n\n    onScroll = () => {\n        this.updateUnreadIndicators();\n    }\n\n    onTransitionEnd = debounce(() => {\n        this.updateUnreadIndicators();\n    }, 100);\n\n    render() {\n        const {categories} = this.props;\n        const renderedCategories = categories.map(this.renderCategory);\n\n        const above = (\n            <FormattedMessage\n                id='sidebar.unreads'\n                defaultMessage='More unreads'\n            />\n        );\n\n        const below = (\n            <FormattedMessage\n                id='sidebar.unreads'\n                defaultMessage='More unreads'\n            />\n        );\n\n        return (\n\n            // NOTE: id attribute added to temporarily support the desktop app's at-mention DOM scraping of the old sidebar\n            <div\n                id='sidebar-left'\n                className={classNames('SidebarNavContainer a11y__region', {disabled: this.props.isUnreadFilterEnabled})}\n                data-a11y-sort-order='7'\n                onTransitionEnd={this.onTransitionEnd}\n            >\n                <UnreadChannelIndicator\n                    name='Top'\n                    show={this.state.showTopUnread}\n                    onClick={this.scrollToFirstUnreadChannel}\n                    extraClass='nav-pills__unread-indicator-top'\n                    content={above}\n                />\n                <UnreadChannelIndicator\n                    name='Bottom'\n                    show={this.state.showBottomUnread}\n                    onClick={this.scrollToLastUnreadChannel}\n                    extraClass='nav-pills__unread-indicator-bottom'\n                    content={below}\n                />\n                <Scrollbars\n                    ref={this.scrollbar}\n                    autoHide={true}\n                    autoHideTimeout={500}\n                    autoHideDuration={500}\n                    renderThumbHorizontal={renderThumbHorizontal}\n                    renderThumbVertical={renderThumbVertical}\n                    renderView={renderView}\n                    onScroll={this.onScroll}\n                    style={{position: 'absolute'}}\n                >\n                    {renderedCategories}\n                </Scrollbars>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch} from 'redux';\n\nimport {getSortedUnreadChannelIds, getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {makeGetCategoriesForTeam} from 'mattermost-redux/selectors/entities/channel_categories';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {GenericAction} from 'mattermost-redux/types/actions';\n\nimport {switchToChannelById} from 'actions/views/channel';\nimport {close} from 'actions/views/lhs';\nimport {isUnreadFilterEnabled, makeGetCurrentlyDisplayedChannelsForTeam} from 'selectors/views/channel_sidebar';\nimport {GlobalState} from 'types/store';\n\nimport SidebarCategoryList from './sidebar_category_list';\n\nfunction makeMapStateToProps() {\n    const getCategoriesForTeam = makeGetCategoriesForTeam();\n    const getCurrentlyDisplayedChannelsForTeam = makeGetCurrentlyDisplayedChannelsForTeam();\n\n    return (state: GlobalState) => {\n        const lastUnreadChannel = state.views.channel.keepChannelIdAsUnread;\n        const currentTeam = getCurrentTeam(state);\n\n        return {\n            currentTeam,\n            currentChannel: getCurrentChannel(state),\n            categories: getCategoriesForTeam(state, currentTeam.id),\n            isUnreadFilterEnabled: isUnreadFilterEnabled(state),\n            unreadChannelIds: getSortedUnreadChannelIds(state, lastUnreadChannel, false, false, 'alpha'),\n            displayedChannels: getCurrentlyDisplayedChannelsForTeam(state, currentTeam.id),\n        };\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<GenericAction>) {\n    return {\n        actions: bindActionCreators({\n            close,\n            switchToChannelById,\n        }, dispatch),\n    };\n}\n\nexport default connect(makeMapStateToProps, mapDispatchToProps)(SidebarCategoryList);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport classNames from 'classnames';\n\nimport {ChannelType} from 'mattermost-redux/types/channels';\n\nimport {trackEvent} from 'actions/diagnostics_actions';\nimport MoreDirectChannels from 'components/more_direct_channels';\nimport MoreChannels from 'components/more_channels';\nimport NewChannelFlow from 'components/new_channel_flow';\nimport Pluggable from 'plugins/pluggable';\nimport {Constants} from 'utils/constants';\nimport * as Utils from 'utils/utils';\n\nimport AddChannelDropdown from './add_channel_dropdown';\nimport SidebarHeader from './sidebar_header';\nimport ChannelNavigator from './channel_navigator';\nimport ChannelFilter from './channel_filter';\nimport SidebarCategoryList from './sidebar_category_list';\n\ntype Props = {\n    canCreatePublicChannel: boolean;\n    canCreatePrivateChannel: boolean;\n    canJoinPublicChannel: boolean;\n    isOpen: boolean;\n};\n\ntype State = {\n    showDirectChannelsModal: boolean;\n    showMoreChannelsModal: boolean;\n    showNewChannelModal: boolean;\n};\n\nexport default class Sidebar extends React.PureComponent<Props, State> {\n    constructor(props: Props) {\n        super(props);\n        this.state = {\n            showDirectChannelsModal: false,\n            showMoreChannelsModal: false,\n            showNewChannelModal: false,\n        };\n    }\n\n    showMoreDirectChannelsModal = () => {\n        this.setState({showDirectChannelsModal: true});\n        trackEvent('ui', 'ui_channels_more_direct_v2');\n    }\n\n    hideMoreDirectChannelsModal = () => {\n        this.setState({showDirectChannelsModal: false});\n    }\n\n    showMoreChannelsModal = () => {\n        this.setState({showMoreChannelsModal: true});\n        trackEvent('ui', 'ui_channels_more_public_v2');\n    }\n\n    hideMoreChannelsModal = () => {\n        this.setState({showMoreChannelsModal: false});\n    }\n\n    showNewChannelModal = () => {\n        this.setState({showNewChannelModal: true});\n        trackEvent('ui', 'ui_channels_create_channel_v2');\n    }\n\n    hideNewChannelModal = () => {\n        this.setState({showNewChannelModal: false});\n    }\n\n    handleOpenMoreDirectChannelsModal = (e: Event) => {\n        e.preventDefault();\n        if (this.state.showDirectChannelsModal) {\n            this.hideMoreDirectChannelsModal();\n        } else {\n            this.showMoreDirectChannelsModal();\n        }\n    }\n\n    handleNewChannelForMoreChannelsModal = () => {\n        this.hideMoreChannelsModal();\n        this.showNewChannelModal();\n    }\n\n    renderModals = () => {\n        let moreDirectChannelsModal;\n        if (this.state.showDirectChannelsModal) {\n            moreDirectChannelsModal = (\n                <MoreDirectChannels\n                    onModalDismissed={this.hideMoreDirectChannelsModal}\n                    isExistingChannel={false}\n                />\n            );\n        }\n\n        let moreChannelsModal;\n        if (this.state.showMoreChannelsModal) {\n            moreChannelsModal = (\n                <MoreChannels\n                    onModalDismissed={this.hideMoreChannelsModal}\n                    handleNewChannel={this.handleNewChannelForMoreChannelsModal}\n                    morePublicChannelsModalType={'public'} // TODO: need to incorporate 'private' when showing archived channels: (getConfig(state).ExperimentalViewArchivedChannels === 'true')\n                />\n            );\n        }\n\n        return (\n            <React.Fragment>\n                <NewChannelFlow\n                    show={this.state.showNewChannelModal}\n                    canCreatePublicChannel={this.props.canCreatePublicChannel}\n                    canCreatePrivateChannel={this.props.canCreatePrivateChannel}\n                    channelType={Constants.OPEN_CHANNEL as ChannelType}\n                    onModalDismissed={this.hideNewChannelModal}\n                />\n                {moreDirectChannelsModal}\n                {moreChannelsModal}\n            </React.Fragment>\n        );\n    }\n\n    render() {\n        return (\n            <div\n                id='SidebarContainer'\n                className={classNames({\n                    'move--right': this.props.isOpen && Utils.isMobile(),\n                })}\n            >\n                <SidebarHeader/>\n                <div\n                    className='a11y__region'\n                    data-a11y-sort-order='6'\n                >\n                    <ChannelNavigator/>\n                    <div className='SidebarContainer_filterAddChannel'>\n                        <ChannelFilter/>\n                        <AddChannelDropdown\n                            showNewChannelModal={this.showNewChannelModal}\n                            showMoreChannelsModal={this.showMoreChannelsModal}\n                            canCreateChannel={this.props.canCreatePrivateChannel || this.props.canCreatePublicChannel}\n                            canJoinPublicChannel={this.props.canJoinPublicChannel}\n                        />\n                    </div>\n                </div>\n                <Pluggable pluggableName='LeftSidebarHeader'/>\n                <SidebarCategoryList handleOpenMoreDirectChannelsModal={this.handleOpenMoreDirectChannelsModal}/>\n                {this.renderModals()}\n            </div>\n        );\n    }\n}\n","\n// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch} from 'redux';\n\nimport Permissions from 'mattermost-redux/constants/permissions';\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {GlobalState} from 'mattermost-redux/types/store';\nimport {GenericAction} from 'mattermost-redux/types/actions';\n\nimport {getIsLhsOpen} from 'selectors/lhs';\n\nimport Sidebar from './sidebar';\n\nfunction mapStateToProps(state: GlobalState) {\n    const currentTeam = getCurrentTeam(state);\n\n    let canCreatePublicChannel = false;\n    let canCreatePrivateChannel = false;\n    let canJoinPublicChannel = false;\n\n    if (currentTeam) {\n        canCreatePublicChannel = haveITeamPermission(state, {team: currentTeam.id, permission: Permissions.CREATE_PUBLIC_CHANNEL});\n        canCreatePrivateChannel = haveITeamPermission(state, {team: currentTeam.id, permission: Permissions.CREATE_PRIVATE_CHANNEL});\n        canJoinPublicChannel = haveITeamPermission(state, {team: currentTeam.id, permission: Permissions.JOIN_PUBLIC_CHANNELS});\n    }\n\n    return {\n        canCreatePrivateChannel,\n        canCreatePublicChannel,\n        canJoinPublicChannel,\n        isOpen: getIsLhsOpen(state),\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<GenericAction>) {\n    return {\n        actions: bindActionCreators({\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Sidebar);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {getChannel, selectChannel, joinChannel, getChannelStats} from 'mattermost-redux/actions/channels';\nimport {getPostThread} from 'mattermost-redux/actions/posts';\nimport {getCurrentTeamId, getTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {getUser} from 'mattermost-redux/selectors/entities/users';\n\nimport {loadChannelsForCurrentUser} from 'actions/channel_actions.jsx';\nimport {loadNewDMIfNeeded, loadNewGMIfNeeded} from 'actions/user_actions.jsx';\nimport {browserHistory} from 'utils/browser_history';\nimport {ActionTypes, Constants, ErrorPageTypes} from 'utils/constants';\nimport {getUserIdFromChannelId} from 'utils/utils';\n\nexport function focusPost(postId, returnTo = '', currentUserId) {\n    return async (dispatch, getState) => {\n        const {data} = await dispatch(getPostThread(postId));\n\n        if (!data) {\n            browserHistory.replace(`/error?type=${ErrorPageTypes.PERMALINK_NOT_FOUND}&returnTo=${returnTo}`);\n            return;\n        }\n\n        const state = getState();\n        const channelId = data.posts[data.order[0]].channel_id;\n        let channel = state.entities.channels.channels[channelId];\n        const teamId = getCurrentTeamId(state);\n\n        if (!channel) {\n            const {data: channelData} = await dispatch(getChannel(channelId));\n\n            if (!channelData) {\n                browserHistory.replace(`/error?type=${ErrorPageTypes.PERMALINK_NOT_FOUND}&returnTo=${returnTo}`);\n                return;\n            }\n\n            channel = channelData;\n        }\n\n        const myMember = state.entities.channels.myMembers[channelId];\n\n        if (!myMember) {\n            // If it's a DM or GM channel and we don't have a channel member for it already, user is not a member\n            if (channel.type === Constants.DM_CHANNEL || channel.type === Constants.GM_CHANNEL) {\n                browserHistory.replace(`/error?type=${ErrorPageTypes.PERMALINK_NOT_FOUND}&returnTo=${returnTo}`);\n                return;\n            }\n\n            await dispatch(joinChannel(currentUserId, null, channelId));\n        }\n\n        if (channel.team_id && channel.team_id !== teamId) {\n            browserHistory.replace(`/error?type=${ErrorPageTypes.PERMALINK_NOT_FOUND}&returnTo=${returnTo}`);\n            return;\n        }\n\n        if (channel && channel.type === Constants.DM_CHANNEL) {\n            loadNewDMIfNeeded(channel.id);\n        } else if (channel && channel.type === Constants.GM_CHANNEL) {\n            loadNewGMIfNeeded(channel.id);\n        }\n\n        dispatch(selectChannel(channelId));\n        dispatch({\n            type: ActionTypes.RECEIVED_FOCUSED_POST,\n            data: postId,\n            channelId,\n        });\n\n        const team = getTeam(state, channel.team_id || teamId);\n\n        if (channel.type === Constants.DM_CHANNEL) {\n            const userId = getUserIdFromChannelId(channel.name);\n            const user = getUser(state, userId);\n            browserHistory.replace(`/${team.name}/messages/@${user.username}/${postId}`);\n        } else if (channel.type === Constants.GM_CHANNEL) {\n            browserHistory.replace(`/${team.name}/messages/${channel.name}/${postId}`);\n        } else {\n            browserHistory.replace(`/${team.name}/channels/${channel.name}/${postId}`);\n        }\n\n        dispatch(loadChannelsForCurrentUser());\n        dispatch(getChannelStats(channelId));\n    };\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport Constants from 'utils/constants.jsx';\nimport * as Utils from 'utils/utils.jsx';\n\nexport default class PermalinkView extends React.PureComponent {\n    static propTypes = {\n        channelId: PropTypes.string,\n\n        /*\n         * Object from react-router\n         */\n        match: PropTypes.shape({\n            params: PropTypes.shape({\n                postid: PropTypes.string.isRequired,\n            }).isRequired,\n        }).isRequired,\n        returnTo: PropTypes.string.isRequired,\n        teamName: PropTypes.string,\n        actions: PropTypes.shape({\n            focusPost: PropTypes.func.isRequired,\n        }).isRequired,\n        currentUserId: PropTypes.string.isRequired,\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        let updatedState = {postid: props.match.params.postid};\n        if (state.postid !== props.match.params.postid) {\n            updatedState = {...updatedState, valid: false};\n        }\n\n        return updatedState;\n    }\n\n    constructor(props) {\n        super(props);\n        this.state = {valid: false};\n    }\n\n    componentDidMount() {\n        this.mounted = true;\n        this.doPermalinkEvent(this.props);\n        document.body.classList.add('app__body');\n    }\n\n    componentDidUpdate() {\n        if (!this.state.valid) {\n            this.doPermalinkEvent(this.props);\n        }\n    }\n\n    componentWillUnmount() {\n        this.mounted = false;\n    }\n\n    doPermalinkEvent = async (props) => {\n        const postId = props.match.params.postid;\n        await this.props.actions.focusPost(postId, this.props.returnTo, this.props.currentUserId);\n        if (this.mounted) {\n            this.setState({valid: true});\n        }\n    }\n\n    isStateValid = () => {\n        return this.state.valid && this.props.channelId && this.props.teamName;\n    }\n\n    onShortcutKeyDown = (e) => {\n        if (e.shiftKey && Utils.cmdOrCtrlPressed(e) && Utils.isKeyPressed(e, Constants.KeyCodes.L) && this.permalink.current) {\n            this.permalink.current.focus();\n        }\n    }\n\n    render() {\n        if (!this.isStateValid()) {\n            return (\n                <div\n                    id='app-content'\n                    className='app__content'\n                />\n            );\n        }\n\n        return null;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\n\nimport {focusPost} from './actions';\nimport PermalinkView from './permalink_view.jsx';\n\nfunction mapStateToProps(state) {\n    const team = getCurrentTeam(state);\n    const channel = getCurrentChannel(state);\n    const currentUserId = getCurrentUserId(state);\n    let channelId = '';\n    if (channel) {\n        channelId = channel.id;\n    }\n\n    let teamName = '';\n    if (team) {\n        teamName = team.name;\n    }\n\n    return {\n        channelId,\n        teamName,\n        currentUserId,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            focusPost,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PermalinkView);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\nimport {localizeMessage} from 'utils/utils';\nimport {ChannelHeaderDropdownItems} from 'components/channel_header_dropdown';\nimport Menu from 'components/widgets/menu/menu';\n\nexport default class ChannelHeaderDropdown extends React.PureComponent {\n    render() {\n        return (\n            <Menu\n                id='channelHeaderDropdownMenu'\n                ariaLabel={localizeMessage('channel_header.menuAriaLabel', 'Channel Menu').toLowerCase()}\n            >\n                <ChannelHeaderDropdownItems isMobile={false}/>\n            </Menu>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nexport default class MobileChannelHeaderPlug extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * Components or actions to add as channel header buttons\n         */\n        components: PropTypes.array,\n\n        /*\n         * Set to true if the plug is in the dropdown\n         */\n        isDropdown: PropTypes.bool.isRequired,\n\n        channel: PropTypes.object.isRequired,\n        channelMember: PropTypes.object.isRequired,\n\n        /*\n         * Logged in user's theme\n         */\n        theme: PropTypes.object.isRequired,\n    }\n\n    createButton = (plug) => {\n        const onClick = () => this.fireAction(plug);\n\n        if (this.props.isDropdown) {\n            return (\n                <li\n                    key={'mobileChannelHeaderItem' + plug.id}\n                    role='presentation'\n                    className='MenuItem'\n                >\n                    <a\n                        role='menuitem'\n                        href='#'\n                        onClick={onClick}\n                    >\n                        {plug.dropdownText}\n                    </a>\n                </li>\n            );\n        }\n\n        return (\n            <li className='flex-parent--center'>\n                <button\n                    className='navbar-toggle navbar-right__icon'\n                    onClick={onClick}\n                >\n                    <span className='icon navbar-plugin-button'>\n                        {plug.icon}\n                    </span>\n                </button>\n            </li>\n        );\n    }\n\n    createList(plugs) {\n        return plugs.map(this.createButton);\n    }\n\n    fireAction(plug) {\n        return plug.action(this.props.channel, this.props.channelMember);\n    }\n\n    render() {\n        const components = this.props.components || [];\n\n        if (components.length === 0) {\n            return null;\n        } else if (components.length === 1) {\n            return this.createButton(components[0]);\n        }\n\n        if (!this.props.isDropdown) {\n            return null;\n        }\n\n        return this.createList(components);\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getTheme} from 'mattermost-redux/selectors/entities/preferences';\nimport {getMyCurrentChannelMembership} from 'mattermost-redux/selectors/entities/channels';\n\nimport MobileChannelHeaderPlug from './mobile_channel_header_plug.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        channelMember: getMyCurrentChannelMembership(state),\n        components: state.plugins.components.MobileChannelHeaderButton,\n        theme: getTheme(state),\n    };\n}\n\nexport default connect(mapStateToProps)(MobileChannelHeaderPlug);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {IgnoreChannelMentions, NotificationLevels, NotificationSections} from 'utils/constants';\nimport {t} from 'utils/i18n';\n\nexport default function Describe({section, isCollapsed, memberNotifyLevel, globalNotifyLevel, ignoreChannelMentions}) {\n    if (memberNotifyLevel === NotificationLevels.DEFAULT && globalNotifyLevel) {\n        t('channel_notifications.levels.default');\n        t('channel_notifications.levels.all');\n        t('channel_notifications.levels.mention');\n        t('channel_notifications.levels.none');\n        const levelsFormattedMessageId = 'channel_notifications.levels.' + globalNotifyLevel;\n        const notifyLevel = (\n            <FormattedMessage\n                id={levelsFormattedMessageId}\n                defaultMessage={globalNotifyLevel}\n            />\n        );\n        return (\n            <FormattedMessage\n                id='channel_notifications.globalDefault'\n                defaultMessage='Global default ({notifyLevel})'\n                values={{notifyLevel}}\n            />\n        );\n    } else if (memberNotifyLevel === NotificationLevels.MENTION && section === NotificationSections.MARK_UNREAD) {\n        if (isCollapsed) {\n            return (\n                <FormattedMessage\n                    id='channel_notifications.muteChannel.on.title.collapse'\n                    defaultMessage='Mute is enabled. Desktop, email and push notifications will not be sent for this channel.'\n                />\n            );\n        }\n        return (\n            <FormattedMessage\n                id='channel_notifications.muteChannel.on.title'\n                defaultMessage='On'\n            />\n        );\n    } else if (\n        section === NotificationSections.IGNORE_CHANNEL_MENTIONS &&\n        ignoreChannelMentions === IgnoreChannelMentions.ON\n    ) {\n        return (\n            <FormattedMessage\n                id='channel_notifications.ignoreChannelMentions.on.title'\n                defaultMessage='On'\n            />\n        );\n    } else if (\n        section === NotificationSections.IGNORE_CHANNEL_MENTIONS &&\n        ignoreChannelMentions === IgnoreChannelMentions.OFF\n    ) {\n        return (\n            <FormattedMessage\n                id='channel_notifications.ignoreChannelMentions.off.title'\n                defaultMessage='Off'\n            />\n        );\n    } else if (memberNotifyLevel === NotificationLevels.MENTION) {\n        return (\n            <FormattedMessage\n                id='channel_notifications.onlyMentions'\n                defaultMessage='Only for mentions'\n            />\n        );\n    } else if (\n        (section === NotificationSections.DESKTOP || section === NotificationSections.PUSH) &&\n        memberNotifyLevel === NotificationLevels.ALL\n    ) {\n        return (\n            <FormattedMessage\n                id='channel_notifications.allActivity'\n                defaultMessage='For all activity'\n            />\n        );\n    } else if (\n        section === NotificationSections.MARK_UNREAD &&\n        memberNotifyLevel === NotificationLevels.ALL\n    ) {\n        return (\n            <FormattedMessage\n                id='channel_notifications.muteChannel.off.title'\n                defaultMessage='Off'\n            />\n        );\n    }\n\n    return (\n        <FormattedMessage\n            id='channel_notifications.never'\n            defaultMessage='Never'\n        />\n    );\n}\n\nDescribe.propTypes = {\n    globalNotifyLevel: PropTypes.string,\n    ignoreChannelMentions: PropTypes.string,\n    memberNotifyLevel: PropTypes.string.isRequired,\n    section: PropTypes.string.isRequired,\n    isCollapsed: PropTypes.bool,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {NotificationSections} from 'utils/constants';\n\nexport default function SectionTitle({section}) {\n    if (section === NotificationSections.DESKTOP) {\n        return (\n            <FormattedMessage\n                id='channel_notifications.sendDesktop'\n                defaultMessage='Send desktop notifications'\n            />\n        );\n    } else if (section === NotificationSections.PUSH) {\n        return (\n            <FormattedMessage\n                id='channel_notifications.push'\n                defaultMessage='Send mobile push notifications'\n            />\n        );\n    } else if (section === NotificationSections.MARK_UNREAD) {\n        return (\n            <FormattedMessage\n                id='channel_notifications.muteChannel.settings'\n                defaultMessage='Mute Channel'\n            />\n        );\n    } else if (section === NotificationSections.IGNORE_CHANNEL_MENTIONS) {\n        return (\n            <FormattedMessage\n                id='channel_notifications.ignoreChannelMentions'\n                defaultMessage='Ignore mentions for @channel, @here and @all'\n            />\n        );\n    }\n\n    return null;\n}\n\nSectionTitle.propTypes = {\n    section: PropTypes.string.isRequired,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport SettingItemMin from 'components/setting_item_min';\n\nimport Describe from './describe.jsx';\nimport SectionTitle from './section_title.jsx';\n\nexport default function CollapseView({onExpandSection, globalNotifyLevel, memberNotifyLevel, section, ignoreChannelMentions}) {\n    return (\n        <SettingItemMin\n            title={<SectionTitle section={section}/>}\n            describe={\n                <Describe\n                    section={section}\n                    ignoreChannelMentions={ignoreChannelMentions}\n                    memberNotifyLevel={memberNotifyLevel}\n                    globalNotifyLevel={globalNotifyLevel}\n                    isCollapsed={true}\n                />\n            }\n            updateSection={onExpandSection}\n            section={section}\n        />\n    );\n}\n\nCollapseView.propTypes = {\n    ignoreChannelMentions: PropTypes.string,\n    onExpandSection: PropTypes.func.isRequired,\n    globalNotifyLevel: PropTypes.string,\n    memberNotifyLevel: PropTypes.string.isRequired,\n    section: PropTypes.string.isRequired,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {NotificationSections} from 'utils/constants';\n\nexport default function ExtraInfo({section}) {\n    switch (section) {\n    case NotificationSections.DESKTOP:\n        return (\n            <span>\n                <FormattedMessage\n                    id='channel_notifications.override'\n                    defaultMessage='Selecting an option other than \"Default\" will override the global notification settings. Desktop notifications are available on Firefox, Safari, and Chrome.'\n                />\n            </span>\n        );\n    case NotificationSections.PUSH:\n        return (\n            <span>\n                <FormattedMessage\n                    id='channel_notifications.overridePush'\n                    defaultMessage='Selecting an option other than \"Global default\" will override the global notification settings for mobile push notifications in account settings. Push notifications must be enabled by the System Admin.'\n                />\n            </span>\n        );\n    case NotificationSections.MARK_UNREAD:\n        return (\n            <span>\n                <FormattedMessage\n                    id='channel_notifications.muteChannel.help'\n                    defaultMessage='Muting turns off desktop, email and push notifications for this channel. The channel will not be marked as unread unless you are mentioned.'\n                />\n            </span>\n        );\n    case NotificationSections.IGNORE_CHANNEL_MENTIONS:\n        return (\n            <span>\n                <FormattedMessage\n                    id='channel_notifications.ignoreChannelMentions.help'\n                    defaultMessage='When enabled, @channel, @here and @all will not trigger mentions or mention notifications in this channel.'\n                />\n            </span>\n        );\n    default:\n        return null;\n    }\n}\n\nExtraInfo.propTypes = {\n    section: PropTypes.string.isRequired,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport {IgnoreChannelMentions, NotificationLevels, NotificationSections} from 'utils/constants';\n\nimport SettingItemMax from 'components/setting_item_max.jsx';\n\nimport Describe from './describe.jsx';\nimport ExtraInfo from './extra_info.jsx';\nimport SectionTitle from './section_title.jsx';\n\nexport default function ExpandView({\n    section,\n    memberNotifyLevel,\n    globalNotifyLevel,\n    onChange,\n    onSubmit,\n    serverError,\n    onCollapseSection,\n    ignoreChannelMentions,\n}) {\n    const inputs = [(\n        <div key='channel-notification-level-radio'>\n            {(section === NotificationSections.DESKTOP || section === NotificationSections.PUSH) &&\n            <fieldset>\n                <div className='radio'>\n                    <label className=''>\n                        <input\n                            id='channelNotificationGlobalDefault'\n                            name='channelDesktopNotifications'\n                            type='radio'\n                            value={NotificationLevels.DEFAULT}\n                            checked={memberNotifyLevel === NotificationLevels.DEFAULT}\n                            onChange={onChange}\n                        />\n                        <Describe\n                            section={section}\n                            memberNotifyLevel={NotificationLevels.DEFAULT}\n                            globalNotifyLevel={globalNotifyLevel}\n                        />\n                    </label>\n                </div>\n                <div className='radio'>\n                    <label className=''>\n                        <input\n                            id='channelNotificationAllActivity'\n                            name='channelDesktopNotifications'\n                            type='radio'\n                            value={NotificationLevels.ALL}\n                            checked={memberNotifyLevel === NotificationLevels.ALL}\n                            onChange={onChange}\n                        />\n                        <Describe\n                            section={section}\n                            memberNotifyLevel={NotificationLevels.ALL}\n                        />\n                    </label>\n                </div>\n                <div className='radio'>\n                    <label className=''>\n                        <input\n                            id='channelNotificationMentions'\n                            name='channelDesktopNotifications'\n                            type='radio'\n                            value={NotificationLevels.MENTION}\n                            checked={memberNotifyLevel === NotificationLevels.MENTION}\n                            onChange={onChange}\n                        />\n                        <Describe\n                            section={section}\n                            memberNotifyLevel={NotificationLevels.MENTION}\n                        />\n                    </label>\n                </div>\n                <div className='radio'>\n                    <label>\n                        <input\n                            id='channelNotificationNever'\n                            name='channelDesktopNotifications'\n                            type='radio'\n                            value={NotificationLevels.NONE}\n                            checked={memberNotifyLevel === NotificationLevels.NONE}\n                            onChange={onChange}\n                        />\n                        <Describe\n                            section={section}\n                            memberNotifyLevel={NotificationLevels.NONE}\n                        />\n                    </label>\n                </div>\n            </fieldset>\n            }\n            {section === NotificationSections.IGNORE_CHANNEL_MENTIONS &&\n                <fieldset>\n                    <div className='radio'>\n                        <label>\n                            <input\n                                id='ignoreChannelMentionsOn'\n                                name='ignoreChannelMentions'\n                                type='radio'\n                                value={IgnoreChannelMentions.ON}\n                                checked={ignoreChannelMentions === IgnoreChannelMentions.ON}\n                                onChange={onChange}\n                            />\n                            <Describe\n                                section={section}\n                                ignoreChannelMentions={IgnoreChannelMentions.ON}\n                                memberNotifyLevel={memberNotifyLevel}\n                                globalNotifyLevel={globalNotifyLevel}\n                            />\n                        </label>\n                    </div>\n                    <div className='radio'>\n                        <label>\n                            <input\n                                id='ignoreChannelMentionsOff'\n                                name='ignoreChannelMentions'\n                                type='radio'\n                                value={IgnoreChannelMentions.OFF}\n                                checked={ignoreChannelMentions === IgnoreChannelMentions.OFF}\n                                onChange={onChange}\n                            />\n                            <Describe\n                                section={section}\n                                ignoreChannelMentions={IgnoreChannelMentions.OFF}\n                                memberNotifyLevel={memberNotifyLevel}\n                                globalNotifyLevel={globalNotifyLevel}\n                            />\n                        </label>\n                    </div>\n                </fieldset>\n            }\n            {section === NotificationSections.MARK_UNREAD &&\n            <fieldset>\n                <div className='radio'>\n                    <label className=''>\n                        <input\n                            id='channelNotificationUnmute'\n                            name='channelNotificationMute'\n                            type='radio'\n                            value={NotificationLevels.MENTION}\n                            checked={memberNotifyLevel === NotificationLevels.MENTION}\n                            onChange={onChange}\n                        />\n                        <Describe\n                            section={section}\n                            memberNotifyLevel={NotificationLevels.MENTION}\n                        />\n                    </label>\n                </div>\n                <div className='radio'>\n                    <label className=''>\n                        <input\n                            id='channelNotificationMute'\n                            name='channelNotificationMute'\n                            type='radio'\n                            value={NotificationLevels.ALL}\n                            checked={memberNotifyLevel === NotificationLevels.ALL}\n                            onChange={onChange}\n                        />\n                        <Describe\n                            section={section}\n                            memberNotifyLevel={NotificationLevels.ALL}\n                        />\n                    </label>\n                </div>\n            </fieldset>\n            }\n        </div>\n    )];\n\n    return (\n        <SettingItemMax\n            title={<SectionTitle section={section}/>}\n            inputs={inputs}\n            submit={onSubmit}\n            server_error={serverError}\n            updateSection={onCollapseSection}\n            extraInfo={<ExtraInfo section={section}/>}\n        />\n    );\n}\n\nExpandView.propTypes = {\n    ignoreChannelMentions: PropTypes.string,\n    onChange: PropTypes.func.isRequired,\n    onCollapseSection: PropTypes.func.isRequired,\n    onSubmit: PropTypes.func.isRequired,\n    globalNotifyLevel: PropTypes.string,\n    memberNotifyLevel: PropTypes.string.isRequired,\n    section: PropTypes.string.isRequired,\n    serverError: PropTypes.string,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport {NotificationSections} from 'utils/constants';\n\nimport CollapseView from './collapse_view.jsx';\nimport ExpandView from './expand_view.jsx';\n\nexport default class NotificationSection extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * Notification section\n         */\n        section: PropTypes.string.isRequired,\n\n        /**\n         * Expand if true, else collapse the section\n         */\n        expand: PropTypes.bool.isRequired,\n\n        /**\n         * Member's desktop notification level\n         */\n        memberNotificationLevel: PropTypes.string.isRequired,\n\n        /**\n         * Ignore channel-wide mentions @channel, @here and @all\n         */\n        ignoreChannelMentions: PropTypes.string,\n\n        /**\n         * User's global notification level\n         */\n        globalNotificationLevel: PropTypes.string,\n\n        /**\n         * onChange handles update of desktop notification level\n         */\n        onChange: PropTypes.func.isRequired,\n\n        /**\n         * Submit function to save notification level\n         */\n        onSubmit: PropTypes.func.isRequired,\n\n        /**\n         * Update function to to expand or collapse a section\n         */\n        onUpdateSection: PropTypes.func.isRequired,\n\n        /**\n         * Error string from the server\n         */\n        serverError: PropTypes.string,\n    }\n\n    handleOnChange = (e) => {\n        this.props.onChange(e.target.value);\n    }\n\n    handleExpandSection = () => {\n        this.props.onUpdateSection(this.props.section);\n    }\n\n    handleCollapseSection = () => {\n        this.props.onUpdateSection(NotificationSections.NONE);\n    }\n\n    render() {\n        const {\n            expand,\n            globalNotificationLevel,\n            memberNotificationLevel,\n            ignoreChannelMentions,\n            onSubmit,\n            section,\n            serverError,\n        } = this.props;\n\n        if (expand) {\n            return (\n                <ExpandView\n                    section={section}\n                    memberNotifyLevel={memberNotificationLevel}\n                    globalNotifyLevel={globalNotificationLevel}\n                    ignoreChannelMentions={ignoreChannelMentions}\n                    onChange={this.handleOnChange}\n                    onSubmit={onSubmit}\n                    serverError={serverError}\n                    onCollapseSection={this.handleCollapseSection}\n                />\n            );\n        }\n\n        return (\n            <CollapseView\n                section={section}\n                onExpandSection={this.handleExpandSection}\n                memberNotifyLevel={memberNotificationLevel}\n                globalNotifyLevel={globalNotificationLevel}\n                ignoreChannelMentions={ignoreChannelMentions}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport {isChannelMuted} from 'mattermost-redux/utils/channel_utils';\n\nimport {IgnoreChannelMentions, NotificationLevels, NotificationSections} from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\n\nimport NotificationSection from 'components/channel_notifications_modal/components/notification_section.jsx';\n\nexport default class ChannelNotificationsModal extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * Function that is called when modal is hidden\n         */\n        onHide: PropTypes.func.isRequired,\n\n        /**\n         * Object with info about current channel\n         */\n        channel: PropTypes.object.isRequired,\n\n        /**\n         * Object with info about current channel membership\n         */\n        channelMember: PropTypes.object.isRequired,\n\n        /**\n         * Object with info about current user\n         */\n        currentUser: PropTypes.object.isRequired,\n\n        /**\n         * Boolean whether server sends push notifications\n         */\n        sendPushNotifications: PropTypes.bool.isRequired,\n\n        /*\n         * Object with redux action creators\n         */\n        actions: PropTypes.shape({\n\n            /*\n             * Action creator to update channel notify props\n             */\n            updateChannelNotifyProps: PropTypes.func.isRequired,\n        }),\n    };\n\n    constructor(props) {\n        super(props);\n\n        const channelNotifyProps = props.channelMember && props.channelMember.notify_props;\n\n        this.state = {\n            show: true,\n            activeSection: NotificationSections.NONE,\n            serverError: null,\n            ...this.getStateFromNotifyProps(channelNotifyProps, props.currentUser.notify_props),\n        };\n    }\n\n    componentDidUpdate(prevProps) {\n        const prevChannelNotifyProps = prevProps.channelMember && prevProps.channelMember.notify_props;\n        const channelNotifyProps = this.props.channelMember && this.props.channelMember.notify_props;\n\n        if (!Utils.areObjectsEqual(channelNotifyProps, prevChannelNotifyProps)) {\n            this.resetStateFromNotifyProps(channelNotifyProps, this.props.currentUser.notify_props);\n        }\n    }\n\n    resetStateFromNotifyProps(channelMemberNotifyProps, currentUserNotifyProps) {\n        this.setState(this.getStateFromNotifyProps(channelMemberNotifyProps, currentUserNotifyProps));\n    }\n\n    getStateFromNotifyProps(channelMemberNotifyProps, currentUserNotifyProps) {\n        let ignoreChannelMentionsDefault = IgnoreChannelMentions.OFF;\n\n        if (currentUserNotifyProps.channel && currentUserNotifyProps.channel === 'false') {\n            ignoreChannelMentionsDefault = IgnoreChannelMentions.ON;\n        }\n\n        let ignoreChannelMentions = channelMemberNotifyProps.ignore_channel_mentions;\n        if (!ignoreChannelMentions || ignoreChannelMentions === IgnoreChannelMentions.DEFAULT) {\n            ignoreChannelMentions = ignoreChannelMentionsDefault;\n        }\n\n        return {\n            desktopNotifyLevel: channelMemberNotifyProps.desktop || NotificationLevels.DEFAULT,\n            markUnreadNotifyLevel: channelMemberNotifyProps.mark_unread || NotificationLevels.ALL,\n            pushNotifyLevel: channelMemberNotifyProps.push || NotificationLevels.DEFAULT,\n            ignoreChannelMentions,\n        };\n    }\n\n    handleHide = () => {\n        this.setState({\n            show: false,\n        });\n    }\n\n    handleExit = () => {\n        this.updateSection(NotificationSections.NONE);\n        this.props.onHide();\n    }\n\n    updateSection = (section = NotificationSections.NONE) => {\n        this.setState({activeSection: section});\n\n        if (section === NotificationSections.NONE) {\n            const channelNotifyProps = this.props.channelMember && this.props.channelMember.notify_props;\n            this.resetStateFromNotifyProps(channelNotifyProps, this.props.currentUser.notify_props);\n        }\n    }\n\n    handleUpdateChannelNotifyProps = async (props) => {\n        const {\n            actions,\n            channel,\n            currentUser,\n        } = this.props;\n\n        const {error} = await actions.updateChannelNotifyProps(currentUser.id, channel.id, props);\n        if (error) {\n            this.setState({serverError: error.message});\n        } else {\n            this.updateSection(NotificationSections.NONE);\n        }\n    }\n\n    handleSubmitDesktopNotifyLevel = () => {\n        const channelNotifyProps = this.props.channelMember && this.props.channelMember.notify_props;\n        const {desktopNotifyLevel} = this.state;\n\n        if (channelNotifyProps.desktop === desktopNotifyLevel) {\n            this.updateSection(NotificationSections.NONE);\n            return;\n        }\n\n        const props = {desktop: desktopNotifyLevel};\n        this.handleUpdateChannelNotifyProps(props);\n    }\n\n    handleUpdateDesktopNotifyLevel = (desktopNotifyLevel) => {\n        this.setState({desktopNotifyLevel});\n    }\n\n    handleSubmitMarkUnreadLevel = () => {\n        const channelNotifyProps = this.props.channelMember && this.props.channelMember.notify_props;\n        const {markUnreadNotifyLevel} = this.state;\n\n        if (channelNotifyProps.mark_unread === markUnreadNotifyLevel) {\n            this.updateSection(NotificationSections.NONE);\n            return;\n        }\n\n        const props = {mark_unread: markUnreadNotifyLevel};\n        this.handleUpdateChannelNotifyProps(props);\n    }\n\n    handleUpdateMarkUnreadLevel = (markUnreadNotifyLevel) => {\n        this.setState({markUnreadNotifyLevel});\n    }\n\n    handleSubmitPushNotificationLevel = () => {\n        const channelNotifyProps = this.props.channelMember && this.props.channelMember.notify_props;\n        const {pushNotifyLevel} = this.state;\n\n        if (channelNotifyProps.push === pushNotifyLevel) {\n            this.updateSection(NotificationSections.NONE);\n            return;\n        }\n\n        const props = {push: pushNotifyLevel};\n        this.handleUpdateChannelNotifyProps(props);\n    }\n\n    handleUpdatePushNotificationLevel = (pushNotifyLevel) => {\n        this.setState({pushNotifyLevel});\n    }\n\n    handleUpdateIgnoreChannelMentions = (ignoreChannelMentions) => {\n        this.setState({ignoreChannelMentions});\n    }\n\n    handleSubmitIgnoreChannelMentions = () => {\n        const channelNotifyProps = this.props.channelMember && this.props.channelMember.notify_props;\n        const {ignoreChannelMentions} = this.state;\n\n        if (channelNotifyProps.ignore_channel_mentions === ignoreChannelMentions) {\n            this.updateSection('');\n            return;\n        }\n\n        const props = {ignore_channel_mentions: ignoreChannelMentions};\n        this.handleUpdateChannelNotifyProps(props);\n    }\n\n    render() {\n        const {\n            activeSection,\n            desktopNotifyLevel,\n            markUnreadNotifyLevel,\n            pushNotifyLevel,\n            ignoreChannelMentions,\n            serverError,\n        } = this.state;\n\n        const {\n            channel,\n            channelMember,\n            currentUser,\n            sendPushNotifications,\n        } = this.props;\n\n        let serverErrorTag = null;\n        if (serverError) {\n            serverErrorTag = <div className='form-group has-error'><label className='control-label'>{serverError}</label></div>;\n        }\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal settings-modal settings-modal--tabless'\n                show={this.state.show}\n                onHide={this.handleHide}\n                onExited={this.handleExit}\n                role='dialog'\n                aria-labelledby='channelNotificationModalLabel'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='channelNotificationModalLabel'\n                    >\n                        <FormattedMessage\n                            id='channel_notifications.preferences'\n                            defaultMessage='Notification Preferences for '\n                        />\n                        <span className='name'>{channel.display_name}</span>\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <div className='settings-table'>\n                        <div className='settings-content'>\n                            <div\n                                ref='wrapper'\n                                className='user-settings'\n                            >\n                                <br/>\n                                <div className='divider-dark first'/>\n                                <NotificationSection\n                                    section={NotificationSections.MARK_UNREAD}\n                                    expand={activeSection === NotificationSections.MARK_UNREAD}\n                                    memberNotificationLevel={markUnreadNotifyLevel}\n                                    onChange={this.handleUpdateMarkUnreadLevel}\n                                    onSubmit={this.handleSubmitMarkUnreadLevel}\n                                    onUpdateSection={this.updateSection}\n                                    serverError={serverError}\n                                />\n                                <div className='divider-light'/>\n                                <NotificationSection\n                                    section={NotificationSections.IGNORE_CHANNEL_MENTIONS}\n                                    expand={activeSection === NotificationSections.IGNORE_CHANNEL_MENTIONS}\n                                    memberNotificationLevel={markUnreadNotifyLevel}\n                                    ignoreChannelMentions={ignoreChannelMentions}\n                                    onChange={this.handleUpdateIgnoreChannelMentions}\n                                    onSubmit={this.handleSubmitIgnoreChannelMentions}\n                                    onUpdateSection={this.updateSection}\n                                    serverError={serverError}\n                                />\n                                {!isChannelMuted(channelMember) &&\n                                <div>\n                                    <div className='divider-light'/>\n                                    <NotificationSection\n                                        section={NotificationSections.DESKTOP}\n                                        expand={activeSection === NotificationSections.DESKTOP}\n                                        memberNotificationLevel={desktopNotifyLevel}\n                                        globalNotificationLevel={currentUser.notify_props ? currentUser.notify_props.desktop : NotificationLevels.ALL}\n                                        onChange={this.handleUpdateDesktopNotifyLevel}\n                                        onSubmit={this.handleSubmitDesktopNotifyLevel}\n                                        onUpdateSection={this.updateSection}\n                                        serverError={serverError}\n                                    />\n                                    <div className='divider-light'/>\n                                    {sendPushNotifications &&\n                                    <NotificationSection\n                                        section={NotificationSections.PUSH}\n                                        expand={activeSection === NotificationSections.PUSH}\n                                        memberNotificationLevel={pushNotifyLevel}\n                                        globalNotificationLevel={currentUser.notify_props ? currentUser.notify_props.push : NotificationLevels.ALL}\n                                        onChange={this.handleUpdatePushNotificationLevel}\n                                        onSubmit={this.handleSubmitPushNotificationLevel}\n                                        onUpdateSection={this.updateSection}\n                                        serverError={serverError}\n                                    />\n                                    }\n                                </div>\n                                }\n                                <div className='divider-dark'/>\n                            </div>\n                        </div>\n                    </div>\n                    {serverErrorTag}\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {updateChannelNotifyProps} from 'mattermost-redux/actions/channels';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getMyCurrentChannelMembership} from 'mattermost-redux/selectors/entities/channels';\n\nimport ChannelNotificationsModal from './channel_notifications_modal.jsx';\n\nconst mapStateToProps = (state) => ({\n    channelMember: getMyCurrentChannelMembership(state),\n    sendPushNotifications: getConfig(state).SendPushNotifications === 'true',\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({\n        updateChannelNotifyProps,\n    }, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelNotificationsModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\nimport {Client4} from 'mattermost-redux/client';\n\nimport {filterProfilesMatchingTerm} from 'mattermost-redux/utils/user_utils';\n\nimport {displayEntireNameForUser, localizeMessage, isGuest} from 'utils/utils.jsx';\nimport ProfilePicture from 'components/profile_picture';\nimport MultiSelect from 'components/multiselect/multiselect';\nimport AddIcon from 'components/widgets/icons/fa_add_icon';\nimport GuestBadge from 'components/widgets/badges/guest_badge';\nimport BotBadge from 'components/widgets/badges/bot_badge';\n\nimport Constants from 'utils/constants';\n\nconst USERS_PER_PAGE = 50;\nconst MAX_SELECTABLE_VALUES = 20;\n\nexport default class ChannelInviteModal extends React.Component {\n    static propTypes = {\n        profilesNotInCurrentChannel: PropTypes.array.isRequired,\n        profilesNotInCurrentTeam: PropTypes.array.isRequired,\n        onHide: PropTypes.func.isRequired,\n        channel: PropTypes.object.isRequired,\n        actions: PropTypes.shape({\n            addUsersToChannel: PropTypes.func.isRequired,\n            getProfilesNotInChannel: PropTypes.func.isRequired,\n            getTeamStats: PropTypes.func.isRequired,\n            searchProfiles: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.searchTimeoutId = 0;\n\n        this.state = {\n            values: [],\n            term: '',\n            show: true,\n            saving: false,\n            loadingUsers: true,\n        };\n    }\n\n    addValue = (value) => {\n        const values = Object.assign([], this.state.values);\n        if (values.indexOf(value) === -1) {\n            values.push(value);\n        }\n\n        this.setState({values});\n    };\n\n    componentDidMount() {\n        this.props.actions.getProfilesNotInChannel(this.props.channel.team_id, this.props.channel.id, this.props.channel.group_constrained, 0).then(() => {\n            this.setUsersLoadingState(false);\n        });\n        this.props.actions.getTeamStats(this.props.channel.team_id);\n    }\n\n    onHide = () => {\n        this.setState({show: false});\n    };\n\n    handleInviteError = (err) => {\n        if (err) {\n            this.setState({\n                saving: false,\n                inviteError: err.message,\n            });\n        }\n    };\n\n    handleDelete = (values) => {\n        this.setState({values});\n    };\n\n    setUsersLoadingState = (loadingState) => {\n        this.setState({\n            loadingUsers: loadingState,\n        });\n    };\n\n    handlePageChange = (page, prevPage) => {\n        if (page > prevPage) {\n            this.setUsersLoadingState(true);\n            this.props.actions.getProfilesNotInChannel(this.props.channel.team_id, this.props.channel.id, this.props.channel.group_constrained, page + 1, USERS_PER_PAGE).then(() => {\n                this.setUsersLoadingState(false);\n            });\n        }\n    };\n\n    handleSubmit = (e) => {\n        const {actions, channel} = this.props;\n        if (e) {\n            e.preventDefault();\n        }\n\n        const userIds = this.state.values.map((v) => v.id);\n        if (userIds.length === 0) {\n            return;\n        }\n\n        this.setState({saving: true});\n\n        actions.addUsersToChannel(channel.id, userIds).then((result) => {\n            if (result.error) {\n                this.handleInviteError(result.error);\n            } else {\n                this.setState({\n                    saving: false,\n                    inviteError: null,\n                });\n                this.onHide();\n            }\n        });\n    };\n\n    search = (searchTerm) => {\n        const term = searchTerm.trim();\n        clearTimeout(this.searchTimeoutId);\n        this.setState({\n            term,\n        });\n\n        this.searchTimeoutId = setTimeout(\n            async () => {\n                this.setUsersLoadingState(true);\n                const options = {\n                    team_id: this.props.channel.team_id,\n                    not_in_channel_id: this.props.channel.id,\n                    group_constrained: this.props.channel.group_constrained,\n                };\n                await this.props.actions.searchProfiles(term, options);\n                this.setUsersLoadingState(false);\n            },\n            Constants.SEARCH_TIMEOUT_MILLISECONDS\n        );\n    };\n\n    renderAriaLabel = (option) => {\n        if (!option) {\n            return null;\n        }\n        return option.username;\n    }\n\n    renderOption = (option, isSelected, onAdd, onMouseMove) => {\n        var rowSelected = '';\n        if (isSelected) {\n            rowSelected = 'more-modal__row--selected';\n        }\n\n        return (\n            <div\n                key={option.id}\n                ref={isSelected ? 'selected' : option.id}\n                className={'more-modal__row clickable ' + rowSelected}\n                onClick={() => onAdd(option)}\n                onMouseMove={() => onMouseMove(option)}\n            >\n                <ProfilePicture\n                    src={Client4.getProfilePictureUrl(option.id, option.last_picture_update)}\n                    size='md'\n                />\n                <div className='more-modal__details'>\n                    <div className='more-modal__name'>\n                        {displayEntireNameForUser(option)}\n                        <BotBadge\n                            show={Boolean(option.is_bot)}\n                            className='badge-popoverlist'\n                        />\n                        <GuestBadge\n                            show={isGuest(option)}\n                            className='popoverlist'\n                        />\n                    </div>\n                </div>\n                <div className='more-modal__actions'>\n                    <div className='more-modal__actions--round'>\n                        <AddIcon/>\n                    </div>\n                </div>\n            </div>\n        );\n    };\n\n    renderValue(props) {\n        return props.data.username;\n    }\n\n    render() {\n        let inviteError = null;\n        if (this.state.inviteError) {\n            inviteError = (<label className='has-error control-label'>{this.state.inviteError}</label>);\n        }\n\n        const numRemainingText = (\n            <FormattedMessage\n                id='multiselect.numPeopleRemaining'\n                defaultMessage='Use  to browse,  to select. You can add {num, number} more {num, plural, one {person} other {people}}. '\n                values={{\n                    num: MAX_SELECTABLE_VALUES - this.state.values.length,\n                }}\n            />\n        );\n\n        const buttonSubmitText = localizeMessage('multiselect.add', 'Add');\n        const buttonSubmitLoadingText = localizeMessage('multiselect.adding', 'Adding...');\n\n        const users = filterProfilesMatchingTerm(this.props.profilesNotInCurrentChannel, this.state.term).filter((user) => {\n            return user.delete_at === 0 && !this.props.profilesNotInCurrentTeam.includes(user);\n        });\n\n        const content = (\n            <MultiSelect\n                key='addUsersToChannelKey'\n                options={users}\n                optionRenderer={this.renderOption}\n                values={this.state.values}\n                valueRenderer={this.renderValue}\n                ariaLabelRenderer={this.renderAriaLabel}\n                perPage={USERS_PER_PAGE}\n                handlePageChange={this.handlePageChange}\n                handleInput={this.search}\n                handleDelete={this.handleDelete}\n                handleAdd={this.addValue}\n                handleSubmit={this.handleSubmit}\n                maxValues={MAX_SELECTABLE_VALUES}\n                numRemainingText={numRemainingText}\n                buttonSubmitText={buttonSubmitText}\n                buttonSubmitLoadingText={buttonSubmitLoadingText}\n                saving={this.state.saving}\n                loading={this.state.loadingUsers}\n                placeholderText={localizeMessage('multiselect.placeholder', 'Search and add members')}\n            />\n        );\n\n        return (\n            <Modal\n                id='addUsersToChannelModal'\n                dialogClassName='a11y__modal more-modal'\n                show={this.state.show}\n                onHide={this.onHide}\n                onExited={this.props.onHide}\n                role='dialog'\n                aria-labelledby='channelInviteModalLabel'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='channelInviteModalLabel'\n                    >\n                        <FormattedMessage\n                            id='channel_invite.addNewMembers'\n                            defaultMessage='Add New Members to '\n                        />\n                        <span className='name'>{this.props.channel.display_name}</span>\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body\n                    role='application'\n                >\n                    {inviteError}\n                    {content}\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getTeamStats} from 'mattermost-redux/actions/teams';\nimport {getProfilesNotInChannel, searchProfiles} from 'mattermost-redux/actions/users';\nimport {getProfilesNotInCurrentChannel, getProfilesNotInCurrentTeam} from 'mattermost-redux/selectors/entities/users';\n\nimport {addUsersToChannel} from 'actions/channel_actions';\n\nimport ChannelInviteModal from './channel_invite_modal.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        profilesNotInCurrentChannel: getProfilesNotInCurrentChannel(state),\n        profilesNotInCurrentTeam: getProfilesNotInCurrentTeam(state),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            addUsersToChannel,\n            getProfilesNotInChannel,\n            getTeamStats,\n            searchProfiles,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelInviteModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {Constants} from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\n\nimport DropdownIcon from 'components/widgets/icons/fa_dropdown_icon';\nimport Menu from 'components/widgets/menu/menu';\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\n\nconst ROWS_FROM_BOTTOM_TO_OPEN_UP = 3;\n\nexport default class ChannelMembersDropdown extends React.Component {\n    static propTypes = {\n        channel: PropTypes.object.isRequired,\n        user: PropTypes.object.isRequired,\n        currentUserId: PropTypes.string.isRequired,\n        channelMember: PropTypes.object.isRequired,\n        isLicensed: PropTypes.bool.isRequired,\n        canChangeMemberRoles: PropTypes.bool.isRequired,\n        canRemoveMember: PropTypes.bool.isRequired,\n        index: PropTypes.number.isRequired,\n        totalUsers: PropTypes.number.isRequired,\n        actions: PropTypes.shape({\n            getChannelStats: PropTypes.func.isRequired,\n            updateChannelMemberSchemeRoles: PropTypes.func.isRequired,\n            removeChannelMember: PropTypes.func.isRequired,\n            getChannelMember: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            serverError: null,\n            removing: false,\n        };\n    }\n\n    handleRemoveFromChannel = () => {\n        if (this.state.removing) {\n            return;\n        }\n\n        const {actions, channel, user} = this.props;\n        this.setState({removing: true});\n\n        actions.removeChannelMember(channel.id, user.id).then((result) => {\n            if (result.error) {\n                this.setState({\n                    serverError: result.error.message,\n                    removing: false,\n                });\n                return;\n            }\n\n            this.setState({removing: false});\n            actions.getChannelStats(channel.id);\n        });\n    };\n\n    handleMakeChannelMember = async () => {\n        const {error} = await this.props.actions.updateChannelMemberSchemeRoles(this.props.channel.id, this.props.user.id, true, false);\n        if (error) {\n            this.setState({serverError: error.message});\n        } else {\n            this.props.actions.getChannelStats(this.props.channel.id);\n            this.props.actions.getChannelMember(this.props.channel.id, this.props.user.id);\n        }\n    };\n\n    handleMakeChannelAdmin = async () => {\n        const {error} = await this.props.actions.updateChannelMemberSchemeRoles(this.props.channel.id, this.props.user.id, true, true);\n        if (error) {\n            this.setState({serverError: error.message});\n        } else {\n            this.props.actions.getChannelStats(this.props.channel.id);\n            this.props.actions.getChannelMember(this.props.channel.id, this.props.user.id);\n        }\n    };\n\n    renderRole(isChannelAdmin, isGuest) {\n        if (isChannelAdmin) {\n            return (\n                <FormattedMessage\n                    id='channel_members_dropdown.channel_admin'\n                    defaultMessage='Channel Admin'\n                />\n            );\n        } else if (isGuest) {\n            return (\n                <FormattedMessage\n                    id='channel_members_dropdown.channel_guest'\n                    defaultMessage='Channel Guest'\n                />\n            );\n        }\n        return (\n            <FormattedMessage\n                id='channel_members_dropdown.channel_member'\n                defaultMessage='Channel Member'\n            />\n        );\n    }\n\n    render() {\n        const {index, totalUsers, isLicensed, channelMember, user, channel, currentUserId, canChangeMemberRoles, canRemoveMember} = this.props;\n        const {serverError} = this.state;\n\n        const isChannelAdmin = Utils.isChannelAdmin(isLicensed, channelMember.roles, channelMember.scheme_admin);\n        const isGuest = Utils.isGuest(user);\n        const isMember = !isChannelAdmin && !isGuest;\n        const isDefaultChannel = channel.name === Constants.DEFAULT_CHANNEL;\n        const currentRole = this.renderRole(isChannelAdmin, isGuest);\n\n        if (user.id === currentUserId) {\n            return null;\n        }\n        const canMakeUserChannelMember = canChangeMemberRoles && isChannelAdmin;\n        const canMakeUserChannelAdmin = canChangeMemberRoles && isLicensed && isMember;\n        const canRemoveUserFromChannel = canRemoveMember && (!channel.group_constrained || user.is_bot) && (!isDefaultChannel || isGuest);\n\n        if (canMakeUserChannelMember || canMakeUserChannelAdmin || canRemoveUserFromChannel) {\n            return (\n                <MenuWrapper>\n                    <button\n                        className='dropdown-toggle theme color--link style--none'\n                        type='button'\n                    >\n                        <span className='sr-only'>{user.username}</span>\n                        <span>{currentRole} </span>\n                        <DropdownIcon/>\n                    </button>\n                    <Menu\n                        openLeft={true}\n                        openUp={totalUsers > ROWS_FROM_BOTTOM_TO_OPEN_UP && totalUsers - index <= ROWS_FROM_BOTTOM_TO_OPEN_UP}\n                        ariaLabel={Utils.localizeMessage('channel_members_dropdown.menuAriaLabel', 'Change the role of channel member')}\n                    >\n                        <Menu.ItemAction\n                            id={`${user.username}-make-channel-member`}\n                            show={canMakeUserChannelMember}\n                            onClick={this.handleMakeChannelMember}\n                            text={Utils.localizeMessage('channel_members_dropdown.make_channel_member', 'Make Channel Member')}\n                        />\n                        <Menu.ItemAction\n                            id={`${user.username}-make-channel-admin`}\n                            show={canMakeUserChannelAdmin}\n                            onClick={this.handleMakeChannelAdmin}\n                            text={Utils.localizeMessage('channel_members_dropdown.make_channel_admin', 'Make Channel Admin')}\n                        />\n                        <Menu.ItemAction\n                            show={canRemoveUserFromChannel}\n                            onClick={this.handleRemoveFromChannel}\n                            text={Utils.localizeMessage('channel_members_dropdown.remove_from_channel', 'Remove from Channel')}\n                        />\n                        {serverError && (\n                            <div className='has-error'>\n                                <label className='has-error control-label'>{serverError}</label>\n                            </div>\n                        )}\n                    </Menu>\n                </MenuWrapper>\n            );\n        }\n\n        if (isDefaultChannel) {\n            return (\n                <div/>\n            );\n        }\n\n        return (\n            <div>\n                {currentRole}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {getChannelStats, updateChannelMemberSchemeRoles, removeChannelMember, getChannelMember} from 'mattermost-redux/actions/channels';\nimport {haveIChannelPermission} from 'mattermost-redux/selectors/entities/roles';\nimport {getLicense} from 'mattermost-redux/selectors/entities/general';\nimport {Permissions} from 'mattermost-redux/constants';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\n\nimport {canManageMembers} from 'utils/channel_utils.jsx';\n\nimport ChannelMembersDropdown from './channel_members_dropdown.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    const {channel} = ownProps;\n    const canChangeMemberRoles = haveIChannelPermission(\n        state,\n        {\n            channel: channel.id,\n            team: channel.team_id,\n            permission: Permissions.MANAGE_CHANNEL_ROLES,\n        }\n    );\n    const license = getLicense(state);\n    const isLicensed = license.IsLicensed === 'true';\n    const canRemoveMember = canManageMembers(state, channel);\n\n    return {\n        currentUserId: getCurrentUserId(state),\n        isLicensed,\n        canChangeMemberRoles,\n        canRemoveMember,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            getChannelMember,\n            getChannelStats,\n            updateChannelMemberSchemeRoles,\n            removeChannelMember,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelMembersDropdown);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {UserProfile} from 'mattermost-redux/types/users';\nimport {Channel, ChannelMembership} from 'mattermost-redux/types/channels';\n\nimport Constants from 'utils/constants';\nimport * as UserAgent from 'utils/user_agent';\n\nimport ChannelMembersDropdown from 'components/channel_members_dropdown';\nimport SearchableUserList from 'components/searchable_user_list/searchable_user_list_container.jsx';\nimport LoadingScreen from 'components/loading_screen';\n\nconst USERS_PER_PAGE = 50;\n\ntype Props = {\n    currentTeamId: string;\n    currentChannelId: string;\n    searchTerm: string;\n    usersToDisplay: Array<UserProfile>;\n    actionUserProps: {\n        [userId: string]: {\n            channel: Channel;\n            teamMember: any;\n            channelMember: ChannelMembership;\n        };\n    };\n    totalChannelMembers: number;\n    channel: Channel;\n    actions: {\n        searchProfiles: (term: string, options?: {}) => Promise<{data: UserProfile[]}>;\n        getChannelMembers: (channelId: string) => Promise<{data: ChannelMembership[]}>;\n        getChannelStats: (channelId: string) => Promise<{data: {}}>;\n        setModalSearchTerm: (term: string) => Promise<{\n            data: boolean;\n        }>;\n        loadProfilesAndTeamMembersAndChannelMembers: (page: number, perPage: number, teamId?: string, channelId?: string) => Promise<{\n            data: boolean;\n        }>;\n        loadStatusesForProfilesList: (users: Array<UserProfile>) => Promise<{\n            data: boolean;\n        }>;\n        loadTeamMembersAndChannelMembersForProfilesList: (profiles: any, teamId: string, channelId: string) => Promise<{\n            data: boolean;\n        }>;\n    };\n}\n\ntype State = {\n    loading: boolean;\n}\n\nexport default class MemberListChannel extends React.PureComponent<Props, State> {\n    private searchTimeoutId: number;\n\n    constructor(props: Props) {\n        super(props);\n\n        this.searchTimeoutId = 0;\n\n        this.state = {\n            loading: true,\n        };\n    }\n\n    async componentDidMount() {\n        const {\n            actions,\n            currentChannelId,\n            currentTeamId,\n        } = this.props;\n\n        await Promise.all([\n            actions.loadProfilesAndTeamMembersAndChannelMembers(0, Constants.PROFILE_CHUNK_SIZE, currentTeamId, currentChannelId),\n            actions.getChannelMembers(currentChannelId),\n            actions.getChannelStats(currentChannelId),\n        ]);\n        this.loadComplete();\n    }\n\n    componentWillUnmount() {\n        this.props.actions.setModalSearchTerm('');\n    }\n\n    componentDidUpdate(prevProps: Props) {\n        if (prevProps.searchTerm !== this.props.searchTerm) {\n            clearTimeout(this.searchTimeoutId);\n            const searchTerm = this.props.searchTerm;\n\n            if (searchTerm === '') {\n                this.loadComplete();\n                this.searchTimeoutId = 0;\n                return;\n            }\n\n            const searchTimeoutId = window.setTimeout(\n                async () => {\n                    const {data} = await prevProps.actions.searchProfiles(searchTerm, {team_id: this.props.currentTeamId, in_channel_id: this.props.currentChannelId});\n\n                    if (searchTimeoutId !== this.searchTimeoutId) {\n                        return;\n                    }\n\n                    this.props.actions.loadStatusesForProfilesList(data);\n                    this.props.actions.loadTeamMembersAndChannelMembersForProfilesList(data, this.props.currentTeamId, this.props.currentChannelId).then(({data: membersLoaded}) => {\n                        if (membersLoaded) {\n                            this.loadComplete();\n                        }\n                    });\n                },\n                Constants.SEARCH_TIMEOUT_MILLISECONDS\n            );\n\n            this.searchTimeoutId = searchTimeoutId;\n        }\n    }\n\n    loadComplete = () => {\n        this.setState({loading: false});\n    }\n\n    nextPage = (page: number) => {\n        this.props.actions.loadProfilesAndTeamMembersAndChannelMembers(page + 1, USERS_PER_PAGE);\n    }\n\n    handleSearch = (term: string) => {\n        this.props.actions.setModalSearchTerm(term);\n    }\n\n    render() {\n        if (this.state.loading) {\n            return (<LoadingScreen/>);\n        }\n        const channelIsArchived = this.props.channel.delete_at !== 0;\n        return (\n            <SearchableUserList\n                users={this.props.usersToDisplay}\n                usersPerPage={USERS_PER_PAGE}\n                total={this.props.totalChannelMembers}\n                nextPage={this.nextPage}\n                search={this.handleSearch}\n                actions={channelIsArchived ? [] : [ChannelMembersDropdown]}\n                actionUserProps={this.props.actionUserProps}\n                focusOnMount={!UserAgent.isMobile()}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch, ActionCreatorsMapObject} from 'redux';\nimport {createSelector} from 'reselect';\nimport {searchProfilesInCurrentChannel, getProfilesInCurrentChannel} from 'mattermost-redux/selectors/entities/users';\nimport {getMembersInCurrentChannel, getCurrentChannelStats, getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getMembersInCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {getChannelStats, getChannelMembers} from 'mattermost-redux/actions/channels';\nimport {searchProfiles} from 'mattermost-redux/actions/users';\nimport {sortByUsername} from 'mattermost-redux/utils/user_utils';\nimport {UserProfile} from 'mattermost-redux/types/users';\nimport {Channel, ChannelMembership} from 'mattermost-redux/types/channels';\nimport {ActionFunc} from 'mattermost-redux/types/actions';\n\nimport {\n    loadProfilesAndTeamMembersAndChannelMembers,\n    loadTeamMembersAndChannelMembersForProfilesList,\n} from 'actions/user_actions.jsx';\nimport {loadStatusesForProfilesList} from 'actions/status_actions.jsx';\nimport {setModalSearchTerm} from 'actions/views/search';\n\nimport {GlobalState} from 'types/store';\n\nimport MemberListChannel from './member_list_channel';\n\nconst getUsersAndActionsToDisplay = createSelector(\n    (state: GlobalState, users: Array<UserProfile>) => users,\n    getMembersInCurrentTeam,\n    getMembersInCurrentChannel,\n    getCurrentChannel,\n    (users = [], teamMembers = {}, channelMembers = {}, channel) => {\n        const actionUserProps: {\n            [userId: string]: {\n                channel: Channel;\n                teamMember: any;\n                channelMember: ChannelMembership;\n            };\n        } = {};\n        const usersToDisplay = [];\n\n        for (let i = 0; i < users.length; i++) {\n            const user = users[i];\n\n            if (teamMembers[user.id] && channelMembers[user.id] && user.delete_at === 0) {\n                usersToDisplay.push(user);\n\n                actionUserProps[user.id] = {\n                    channel,\n                    teamMember: teamMembers[user.id],\n                    channelMember: channelMembers[user.id],\n                };\n            }\n        }\n\n        return {\n            usersToDisplay: usersToDisplay.sort(sortByUsername),\n            actionUserProps,\n        };\n    }\n);\n\nfunction mapStateToProps(state: GlobalState) {\n    const searchTerm = state.views.search.modalSearch;\n\n    let users;\n    if (searchTerm) {\n        users = searchProfilesInCurrentChannel(state, searchTerm);\n    } else {\n        users = getProfilesInCurrentChannel(state);\n    }\n\n    const stats = getCurrentChannelStats(state) || {member_count: 0};\n\n    return {\n        ...getUsersAndActionsToDisplay(state, users),\n        currentTeamId: state.entities.teams.currentTeamId,\n        currentChannelId: state.entities.channels.currentChannelId,\n        searchTerm,\n        totalChannelMembers: stats.member_count,\n    };\n}\n\ntype Actions = {\n    searchProfiles: (term: string, options?: {}) => Promise<{data: UserProfile[]}>;\n    getChannelMembers: (channelId: string) => Promise<{data: ChannelMembership[]}>;\n    getChannelStats: (channelId: string) => Promise<{data: {}}>;\n    setModalSearchTerm: (term: string) => Promise<{\n        data: boolean;\n    }>;\n    loadProfilesAndTeamMembersAndChannelMembers: (page: number, perPage: number, teamId?: string, channelId?: string) => Promise<{\n        data: boolean;\n    }>;\n    loadStatusesForProfilesList: (users: Array<UserProfile>) => Promise<{\n        data: boolean;\n    }>;\n    loadTeamMembersAndChannelMembersForProfilesList: (profiles: any, teamId: string, channelId: string) => Promise<{\n        data: boolean;\n    }>;\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch) {\n    return {\n        actions: bindActionCreators<ActionCreatorsMapObject<ActionFunc>, Actions>({\n            getChannelMembers,\n            searchProfiles,\n            getChannelStats,\n            setModalSearchTerm,\n            loadProfilesAndTeamMembersAndChannelMembers,\n            loadStatusesForProfilesList,\n            loadTeamMembersAndChannelMembersForProfilesList,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MemberListChannel);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\nimport {Channel} from 'mattermost-redux/types/channels';\n\nimport MemberListChannel from 'components/member_list_channel';\nimport ChannelInviteModal from 'components/channel_invite_modal';\nimport {ModalIdentifiers} from 'utils/constants';\n\ntype Props = {\n\n    /**\n     * Bool whether user has permission to manage current channel\n     */\n    canManageChannelMembers: boolean;\n\n    /**\n     * Object with info about current channel\n     */\n    channel: Channel;\n\n    /**\n     * Function that is called when modal is hidden\n     */\n    onHide: () => void;\n\n    actions: {\n        openModal: (modalData: {\n            modalId: string;\n            dialogProps: {};\n            dialogType: (props: {}) => React.ReactElement | null;\n        }) => Promise<{data: boolean}>;\n    };\n}\n\ntype State = {\n    show: boolean;\n}\n\nexport default class ChannelMembersModal extends React.PureComponent<Props, State> {\n    constructor(props: Props) {\n        super(props);\n\n        this.state = {\n            show: true,\n        };\n    }\n\n    handleHide = () => {\n        this.setState({\n            show: false,\n        });\n    }\n\n    handleExit = () => {\n        this.props.onHide();\n    }\n\n    onAddNewMembersButton = () => {\n        const {channel, actions} = this.props;\n\n        actions.openModal({\n            modalId: ModalIdentifiers.CHANNEL_INVITE,\n            dialogType: ChannelInviteModal,\n            dialogProps: {channel},\n        });\n\n        this.handleExit();\n    }\n\n    render() {\n        const channelIsArchived = this.props.channel.delete_at !== 0;\n        return (\n            <div>\n                <Modal\n                    dialogClassName='a11y__modal more-modal more-modal--action'\n                    show={this.state.show}\n                    onHide={this.handleHide}\n                    onExited={this.handleExit}\n                    role='dialog'\n                    aria-labelledby='channelMembersModalLabel'\n                    id='channelMembersModal'\n                >\n                    <Modal.Header closeButton={true}>\n                        <Modal.Title\n                            componentClass='h1'\n                            id='channelMembersModalLabel'\n                        >\n                            <span className='name'>{this.props.channel.display_name}</span>\n                            <FormattedMessage\n                                id='channel_members_modal.members'\n                                defaultMessage=' Members'\n                            />\n                        </Modal.Title>\n                        {this.props.canManageChannelMembers && !channelIsArchived &&\n                            <a\n                                id='showInviteModal'\n                                className='btn btn-md btn-primary'\n                                href='#'\n                                onClick={this.onAddNewMembersButton}\n                            >\n                                <FormattedMessage\n                                    id='channel_members_modal.addNew'\n                                    defaultMessage=' Add Members'\n                                />\n                            </a>\n                        }\n                    </Modal.Header>\n                    <Modal.Body>\n                        <MemberListChannel\n                            channel={this.props.channel}\n                        />\n                    </Modal.Body>\n                </Modal>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators, Dispatch, ActionCreatorsMapObject} from 'redux';\nimport {connect} from 'react-redux';\n\nimport {canManageChannelMembers} from 'mattermost-redux/selectors/entities/channels';\nimport {ActionFunc} from 'mattermost-redux/types/actions';\n\nimport {openModal} from 'actions/views/modals';\n\nimport {GlobalState} from 'types/store';\n\nimport ChannelMembersModal from './channel_members_modal';\n\nconst mapStateToProps = (state: GlobalState) => ({\n    canManageChannelMembers: canManageChannelMembers(state),\n});\n\ntype Actions = {\n    openModal: (modalData: {\n        modalId: string;\n        dialogProps: {};\n        dialogType: (props: {}) => React.ReactElement | null;\n    }) => Promise<{data: boolean}>;\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\n    actions: bindActionCreators<ActionCreatorsMapObject<ActionFunc>, Actions>({openModal}, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelMembersModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\nimport {memoizeResult} from 'mattermost-redux/utils/helpers';\n\nimport Markdown from 'components/markdown';\nimport GlobeIcon from 'components/widgets/icons/globe_icon';\nimport LockIcon from 'components/widgets/icons/lock_icon';\nimport ArchiveIcon from 'components/widgets/icons/archive_icon';\n\nimport Constants from 'utils/constants.jsx';\nimport {getSiteURL} from 'utils/url';\nimport * as Utils from 'utils/utils.jsx';\n\nconst headerMarkdownOptions = {singleline: false, mentionHighlight: false};\n\nexport default class ChannelInfoModal extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * Function that is called when modal is hidden\n         */\n        onHide: PropTypes.func.isRequired,\n\n        /**\n         * Channel object\n         */\n        channel: PropTypes.object.isRequired,\n\n        /**\n         * Current team object\n         */\n        currentTeam: PropTypes.object.isRequired,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {show: true};\n\n        this.getHeaderMarkdownOptions = memoizeResult((channelNamesMap) => (\n            {...headerMarkdownOptions, channelNamesMap}\n        ));\n    }\n\n    onHide = () => {\n        this.setState({show: false});\n    }\n\n    render() {\n        let channel = this.props.channel;\n        const channelIsArchived = channel.delete_at !== 0;\n        let channelIcon;\n\n        if (!channel) {\n            const notFound = Utils.localizeMessage('channel_info.notFound', 'No Channel Found');\n\n            channel = {\n                display_name: notFound,\n                name: notFound,\n                purpose: notFound,\n                header: notFound,\n                id: notFound,\n            };\n        }\n\n        const channelNamesMap = this.props.channel.props && this.props.channel.props.channel_mentions;\n\n        if (channelIsArchived) {\n            channelIcon = (\n                <ArchiveIcon className='icon icon__archive'/>\n            );\n        } else if (channel.type === 'O') {\n            channelIcon = (\n                <GlobeIcon className='icon icon__globe icon--body'/>\n            );\n        } else if (channel.type === 'P') {\n            channelIcon = (\n                <LockIcon className='icon icon__globe icon--body'/>\n            );\n        }\n\n        const channelURL = getSiteURL() + '/' + this.props.currentTeam.name + '/channels/' + channel.name;\n\n        let channelPurpose;\n        if (channel.purpose) {\n            channelPurpose = channel.purpose;\n        } else if (channel.name === Constants.DEFAULT_CHANNEL) {\n            channelPurpose = (\n                <FormattedMessage\n                    id='default_channel.purpose'\n                    defaultMessage='Post messages here that you want everyone to see. Everyone automatically becomes a permanent member of this channel when they join the team.'\n                />\n            );\n        }\n\n        let channelPurposeElement;\n        if (channelPurpose) {\n            channelPurposeElement = (\n                <div className='form-group'>\n                    <div className='info__label'>\n                        <FormattedMessage\n                            id='channel_info.purpose'\n                            defaultMessage='Purpose:'\n                        />\n                    </div>\n                    <div className='info__value'>{channelPurpose}</div>\n                </div>\n            );\n        }\n\n        let channelHeader = null;\n        if (channel.header) {\n            channelHeader = (\n                <div className='form-group'>\n                    <div className='info__label'>\n                        <FormattedMessage\n                            id='channel_info.header'\n                            defaultMessage='Header:'\n                        />\n                    </div>\n                    <div className='info__value'>\n                        <Markdown\n                            message={channel.header}\n                            options={this.getHeaderMarkdownOptions(channelNamesMap)}\n                        />\n                    </div>\n                </div>\n            );\n        }\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal about-modal'\n                show={this.state.show}\n                onHide={this.onHide}\n                onExited={this.props.onHide}\n                role='dialog'\n                aria-labelledby='channelInfoModalLabel'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='channelInfoModalLabel'\n                    >\n                        <FormattedMessage\n                            id='channel_info.about'\n                            defaultMessage='About'\n                        />\n                        <strong>{channelIcon}{channel.display_name}</strong>\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    {channelPurposeElement}\n                    {channelHeader}\n                    <div className='form-group'>\n                        <div className='info__label'>\n                            <FormattedMessage\n                                id='channel_info.url'\n                                defaultMessage='URL:'\n                            />\n                        </div>\n                        <div className='info__value'>{channelURL}</div>\n                    </div>\n                    <div className='about-modal__hash form-group pt-3'>\n                        <p>\n                            <FormattedMessage\n                                id='channel_info.id'\n                                defaultMessage='ID: '\n                            />\n                            {channel.id}\n                        </p>\n                    </div>\n                </Modal.Body>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\n\nimport ChannelInfoModal from './channel_info_modal.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        currentTeam: getCurrentTeam(state),\n    };\n}\n\nexport default connect(mapStateToProps)(ChannelInfoModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {Modal} from 'react-bootstrap';\nimport {defineMessages, FormattedMessage, injectIntl} from 'react-intl';\n\nimport Textbox from 'components/textbox';\nimport TextboxLinks from 'components/textbox/textbox_links';\nimport Constants, {ModalIdentifiers} from 'utils/constants';\nimport {intlShape} from 'utils/react_intl';\nimport {isMobile} from 'utils/user_agent';\nimport {isKeyPressed, localizeMessage} from 'utils/utils.jsx';\nimport {t} from 'utils/i18n';\n\nconst KeyCodes = Constants.KeyCodes;\n\nconst holders = defineMessages({\n    error: {\n        id: t('edit_channel_header_modal.error'),\n        defaultMessage: 'This channel header is too long, please enter a shorter one',\n    },\n});\n\nclass EditChannelHeaderModal extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * react-intl helper object\n         */\n        intl: intlShape.isRequired,\n\n        /*\n         * Object with info about current channel ,\n         */\n        channel: PropTypes.object.isRequired,\n\n        /**\n         * Set whether to show the modal or not\n         */\n        show: PropTypes.bool.isRequired,\n\n        /*\n         * boolean should be `ctrl` button pressed to send\n         */\n        ctrlSend: PropTypes.bool.isRequired,\n\n        /*\n         * Collection of redux actions\n         */\n        actions: PropTypes.shape({\n\n            closeModal: PropTypes.func.isRequired,\n\n            /*\n             * patch channel redux-action\n             */\n            patchChannel: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            preview: false,\n            header: props.channel.header,\n            saving: false,\n        };\n    }\n\n    handleModalKeyDown = (e) => {\n        if (isKeyPressed(e, KeyCodes.ESCAPE)) {\n            this.hideModal();\n        }\n    }\n\n    updatePreview = (newState) => {\n        this.setState({preview: newState});\n    }\n\n    handleChange = (e) => {\n        this.setState({\n            header: e.target.value,\n        });\n    }\n\n    handleSave = async () => {\n        const {header} = this.state;\n        if (header === this.props.channel.header) {\n            this.hideModal();\n            return;\n        }\n\n        this.setState({saving: true});\n\n        const {channel, actions} = this.props;\n        const {error} = await actions.patchChannel(channel.id, {header});\n        if (error) {\n            this.setState({serverError: error, saving: false});\n        } else {\n            this.hideModal();\n        }\n    }\n\n    hideModal = () => {\n        this.props.actions.closeModal(ModalIdentifiers.EDIT_CHANNEL_HEADER);\n    }\n\n    focusTextbox = () => {\n        if (this.refs.editChannelHeaderTextbox) {\n            this.refs.editChannelHeaderTextbox.getWrappedInstance().focus();\n        }\n    }\n\n    blurTextbox = () => {\n        if (this.refs.editChannelHeaderTextbox) {\n            this.refs.editChannelHeaderTextbox.getWrappedInstance().blur();\n        }\n    }\n\n    handleEntering = () => {\n        this.focusTextbox();\n    }\n\n    handleKeyDown = (e) => {\n        const {ctrlSend} = this.props;\n        if (ctrlSend && isKeyPressed(e, KeyCodes.ENTER) && e.ctrlKey === true) {\n            this.handleKeyPress(e);\n        }\n    }\n\n    handleKeyPress = (e) => {\n        const {ctrlSend} = this.props;\n        if (!isMobile() && ((ctrlSend && e.ctrlKey) || !ctrlSend)) {\n            if (isKeyPressed(e, KeyCodes.ENTER) && !e.shiftKey && !e.altKey) {\n                e.preventDefault();\n                this.blurTextbox();\n                this.handleSave(e);\n            }\n        }\n    }\n\n    renderError = () => {\n        const {serverError} = this.state;\n        if (!serverError) {\n            return null;\n        }\n\n        let errorMsg;\n        if (serverError.server_error_id === 'model.channel.is_valid.header.app_error') {\n            errorMsg = this.props.intl.formatMessage(holders.error);\n        } else {\n            errorMsg = serverError.message;\n        }\n\n        return (\n            <div className='form-group has-error'>\n                <br/>\n                <label className='control-label'>\n                    {errorMsg}\n                </label>\n            </div>\n        );\n    }\n\n    render() {\n        let headerTitle = null;\n        if (this.props.channel.type === Constants.DM_CHANNEL) {\n            headerTitle = (\n                <FormattedMessage\n                    id='edit_channel_header_modal.title_dm'\n                    defaultMessage='Edit Header'\n                />\n            );\n        } else {\n            headerTitle = (\n                <FormattedMessage\n                    id='edit_channel_header_modal.title'\n                    defaultMessage='Edit Header for {channel}'\n                    values={{\n                        channel: this.props.channel.display_name,\n                    }}\n                />\n            );\n        }\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal'\n                show={this.props.show}\n                keyboard={false}\n                onKeyDown={this.handleModalKeyDown}\n                onHide={this.hideModal}\n                onEntering={this.handleEntering}\n                onExited={this.hideModal}\n                role='dialog'\n                aria-labelledby='editChannelHeaderModalLabel'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='editChannelHeaderModalLabel'\n                    >\n                        {headerTitle}\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body bsClass='modal-body edit-modal-body'>\n                    <div>\n                        <p>\n                            <FormattedMessage\n                                id='edit_channel_header_modal.description'\n                                defaultMessage='Edit the text appearing next to the channel name in the channel header.'\n                            />\n                        </p>\n                        <div className='textarea-wrapper'>\n                            <Textbox\n                                value={this.state.header}\n                                onChange={this.handleChange}\n                                onKeyPress={this.handleKeyPress}\n                                onKeyDown={this.handleKeyDown}\n                                supportsCommands={false}\n                                suggestionListStyle='bottom'\n                                createMessage={localizeMessage('edit_channel_header.editHeader', 'Edit the Channel Header...')}\n                                previewMessageLink={localizeMessage('edit_channel_header.previewHeader', 'Edit Header')}\n                                handlePostError={this.handlePostError}\n                                id='edit_textbox'\n                                ref='editChannelHeaderTextbox'\n                                characterLimit={1024}\n                                preview={this.state.preview}\n                            />\n                        </div>\n                        <div className='post-create-footer'>\n                            <TextboxLinks\n                                characterLimit={1024}\n                                showPreview={this.state.preview}\n                                ref={this.setTextboxLinksRef}\n                                updatePreview={this.updatePreview}\n                                message={this.state.header}\n                            />\n                        </div>\n                        <br/>\n                        {this.renderError()}\n                    </div>\n                </Modal.Body>\n                <Modal.Footer>\n                    <button\n                        type='button'\n                        className='btn btn-link cancel-button'\n                        onClick={this.hideModal}\n                    >\n                        <FormattedMessage\n                            id='edit_channel_header_modal.cancel'\n                            defaultMessage='Cancel'\n                        />\n                    </button>\n                    <button\n                        disabled={this.state.saving}\n                        type='button'\n                        className='btn btn-primary save-button'\n                        onClick={this.handleSave}\n                    >\n                        <FormattedMessage\n                            id='edit_channel_header_modal.save'\n                            defaultMessage='Save'\n                        />\n                    </button>\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n\nexport default injectIntl(EditChannelHeaderModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\n\nimport {getBool} from 'mattermost-redux/selectors/entities/preferences';\nimport {patchChannel} from 'mattermost-redux/actions/channels';\nimport {Preferences} from 'mattermost-redux/constants';\n\nimport {closeModal} from 'actions/views/modals';\n\nimport {isModalOpen} from '../../selectors/views/modals';\nimport {ModalIdentifiers} from '../../utils/constants';\n\nimport EditChannelHeaderModal from './edit_channel_header_modal.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        show: isModalOpen(state, ModalIdentifiers.EDIT_CHANNEL_HEADER),\n        ctrlSend: getBool(state, Preferences.CATEGORY_ADVANCED_SETTINGS, 'send_on_ctrl_enter'),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            closeModal,\n            patchChannel,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(EditChannelHeaderModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage, injectIntl} from 'react-intl';\n\nimport Constants from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\n\nclass EditChannelPurposeModal extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * callback to call when modal will hide\n         */\n        onHide: PropTypes.func.isRequired,\n\n        /*\n         * Channel info object\n         */\n        channel: PropTypes.object,\n\n        /*\n         * Check should we send purpose on CTRL + ENTER\n         */\n        ctrlSend: PropTypes.bool.isRequired,\n\n        intl: PropTypes.any,\n\n        /*\n         * Object with redux action creators\n         */\n        actions: PropTypes.shape({\n\n            /*\n             * Action creator to patch current channel\n             */\n            patchChannel: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            purpose: props.channel.purpose || '',\n            serverError: '',\n            show: true,\n            submitted: false,\n            requestStarted: false,\n        };\n    }\n\n    setError = (err) => {\n        if (err.id === 'api.context.invalid_param.app_error') {\n            this.setState({\n                serverError: Utils.localizeMessage(\n                    'edit_channel_purpose_modal.error',\n                    'This channel purpose is too long, please enter a shorter one'\n                ),\n            });\n        } else {\n            this.setState({serverError: err.message});\n        }\n    }\n\n    unsetError = () => {\n        this.setState({serverError: ''});\n    }\n\n    handleEntering = () => {\n        Utils.placeCaretAtEnd(this.purpose);\n    }\n\n    onHide = () => {\n        this.setState({show: false});\n    }\n\n    handleKeyDown = (e) => {\n        const {ctrlSend} = this.props;\n\n        if (ctrlSend && Utils.isKeyPressed(e, Constants.KeyCodes.ENTER) && e.ctrlKey) {\n            e.preventDefault();\n            this.handleSave(e);\n        } else if (!ctrlSend && Utils.isKeyPressed(e, Constants.KeyCodes.ENTER) && !e.shiftKey && !e.altKey) {\n            e.preventDefault();\n            this.handleSave(e);\n        }\n    }\n\n    handleSave = async () => {\n        const {channel, actions: {patchChannel}} = this.props;\n        const {purpose} = this.state;\n        if (!channel) {\n            return;\n        }\n\n        this.setState({requestStarted: true});\n        const {data, error} = await patchChannel(channel.id, {purpose});\n        this.setState({requestStarted: false});\n\n        if (data) {\n            this.unsetError();\n            this.onHide();\n        } else if (error) {\n            this.setError(error);\n        }\n    }\n\n    handleChange = (e) => {\n        e.preventDefault();\n        this.setState({purpose: e.target.value});\n    }\n\n    getPurpose = (node) => {\n        this.purpose = node;\n    };\n\n    render() {\n        let serverError = null;\n        const {formatMessage} = this.props.intl;\n\n        if (this.state.serverError) {\n            serverError = (\n                <div className='form-group has-error'>\n                    <br/>\n                    <label className='control-label'>{this.state.serverError}</label>\n                </div>\n            );\n        }\n\n        let title = (\n            <span>\n                <FormattedMessage\n                    id='edit_channel_purpose_modal.title1'\n                    defaultMessage='Edit Purpose'\n                />\n            </span>\n        );\n        if (this.props.channel.display_name) {\n            title = (\n                <span>\n                    <FormattedMessage\n                        id='edit_channel_purpose_modal.title2'\n                        defaultMessage='Edit Purpose for '\n                    />\n                    <span className='name'>{this.props.channel.display_name}</span>\n                </span>\n            );\n        }\n\n        let channelPurposeModal = (\n            <FormattedMessage\n                id='edit_channel_purpose_modal.body'\n                defaultMessage='Describe how this channel should be used. This text appears in the channel list in the \"More...\" menu and helps others decide whether to join.'\n            />\n        );\n        if (this.props.channel.type === 'P') {\n            channelPurposeModal = (\n                <FormattedMessage\n                    id='edit_channel_private_purpose_modal.body'\n                    defaultMessage='This text appears in the \\\"View Info\\\" modal of the private channel.'\n                />\n            );\n        }\n\n        const ariaLabelForTitle = formatMessage({id: 'edit_channel_purpose_modal.title1', defaultMessage: 'Edit Purpose'}).toLowerCase();\n        return (\n            <Modal\n                dialogClassName='a11y__modal'\n                show={this.state.show}\n                onHide={this.onHide}\n                onEntering={this.handleEntering}\n                onExited={this.props.onHide}\n                role='dialog'\n                aria-labelledby='editChannelPurposeModalLabel'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='editChannelPurposeModalLabel'\n                    >\n                        {title}\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <p>\n                        {channelPurposeModal}\n                    </p>\n                    <textarea\n                        ref={this.getPurpose}\n                        className='form-control no-resize'\n                        rows='6'\n                        maxLength='250'\n                        value={this.state.purpose}\n                        onKeyDown={this.handleKeyDown}\n                        onChange={this.handleChange}\n                        aria-label={ariaLabelForTitle}\n                    />\n                    {serverError}\n                </Modal.Body>\n                <Modal.Footer>\n                    <button\n                        type='button'\n                        className='btn btn-link cancel-button'\n                        onClick={this.onHide}\n                    >\n                        <FormattedMessage\n                            id='edit_channel_purpose_modal.cancel'\n                            defaultMessage='Cancel'\n                        />\n                    </button>\n                    <button\n                        type='button'\n                        className='btn btn-primary save-button'\n                        disabled={this.state.requestStarted}\n                        onClick={this.handleSave}\n                    >\n                        <FormattedMessage\n                            id='edit_channel_purpose_modal.save'\n                            defaultMessage='Save'\n                        />\n                    </button>\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n\nexport default injectIntl(EditChannelPurposeModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {getBool} from 'mattermost-redux/selectors/entities/preferences';\nimport {patchChannel} from 'mattermost-redux/actions/channels';\n\nimport Constants from 'utils/constants';\n\nimport EditChannelPurposeModal from './edit_channel_purpose_modal.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        ctrlSend: getBool(state, Constants.Preferences.CATEGORY_ADVANCED_SETTINGS, 'send_on_ctrl_enter'),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: {\n            patchChannel: bindActionCreators(patchChannel, dispatch),\n        },\n    };\n}\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps,\n)(EditChannelPurposeModal);\n\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal, Tooltip} from 'react-bootstrap';\nimport {defineMessages, FormattedMessage, injectIntl} from 'react-intl';\n\nimport LocalizedInput from 'components/localized_input/localized_input';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport {browserHistory} from 'utils/browser_history';\nimport Constants from 'utils/constants.jsx';\nimport {intlShape} from 'utils/react_intl';\nimport {cleanUpUrlable, getShortenedURL} from 'utils/url';\nimport * as Utils from 'utils/utils.jsx';\nimport {t} from 'utils/i18n';\n\nconst holders = defineMessages({\n    required: {\n        id: t('rename_channel.required'),\n        defaultMessage: 'This field is required',\n    },\n    maxLength: {\n        id: t('rename_channel.maxLength'),\n        defaultMessage: 'This field must be less than {maxLength, number} characters',\n    },\n    lowercase: {\n        id: t('rename_channel.lowercase'),\n        defaultMessage: 'Must be lowercase alphanumeric characters',\n    },\n    url: {\n        id: t('rename_channel.url'),\n        defaultMessage: 'URL',\n    },\n    defaultError: {\n        id: t('rename_channel.defaultError'),\n        defaultMessage: ' - Cannot be changed for the default channel',\n    },\n    displayNameHolder: {\n        id: t('rename_channel.displayNameHolder'),\n        defaultMessage: 'Enter display name',\n    },\n    handleHolder: {\n        id: t('rename_channel.handleHolder'),\n        defaultMessage: 'lowercase alphanumeric characters',\n    },\n});\n\nexport class RenameChannelModal extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * react-intl helper object\n         */\n        intl: intlShape.isRequired,\n\n        /**\n         * Function that is called when modal is hidden\n         */\n        onHide: PropTypes.func.isRequired,\n\n        /**\n         * Object with info about current channel\n         */\n        channel: PropTypes.object.isRequired,\n\n        /**\n         * Object with info about current team\n         */\n        team: PropTypes.object.isRequired,\n\n        /**\n         * String with the current team URL\n         */\n        currentTeamUrl: PropTypes.string.isRequired,\n\n        /*\n         * Object with redux action creators\n         */\n        actions: PropTypes.shape({\n\n            /*\n             * Action creator to patch current channel\n             */\n            patchChannel: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            displayName: props.channel.display_name,\n            channelName: props.channel.name,\n            serverError: '',\n            nameError: '',\n            displayNameError: '',\n            invalid: false,\n            show: true,\n        };\n    }\n\n    setError = (err) => {\n        this.setState({serverError: err.message});\n    }\n\n    unsetError = () => {\n        this.setState({serverError: ''});\n    }\n\n    handleEntering = () => {\n        Utils.placeCaretAtEnd(this.textbox);\n    }\n\n    handleHide = (e) => {\n        if (e) {\n            e.preventDefault();\n        }\n\n        this.setState({\n            serverError: '',\n            nameError: '',\n            displayNameError: '',\n            invalid: false,\n            show: false,\n        });\n    }\n\n    handleSubmit = async (e) => {\n        if (e) {\n            e.preventDefault();\n        }\n\n        const channel = Object.assign({}, this.props.channel);\n        const oldName = channel.name;\n        const oldDisplayName = channel.display_name;\n        const state = {serverError: ''};\n        const {formatMessage} = this.props.intl;\n        const {actions: {patchChannel}} = this.props;\n\n        channel.display_name = this.state.displayName.trim();\n        if (!channel.display_name) {\n            state.displayNameError = formatMessage(holders.required);\n            state.invalid = true;\n        } else if (channel.display_name.length > Constants.MAX_CHANNELNAME_LENGTH) {\n            state.displayNameError = formatMessage(holders.maxLength, {maxLength: Constants.MAX_CHANNELNAME_LENGTH});\n            state.invalid = true;\n        } else if (channel.display_name.length < Constants.MIN_CHANNELNAME_LENGTH) {\n            state.displayNameError = (\n                <FormattedMessage\n                    id='rename_channel.minLength'\n                    defaultMessage='Channel name must be {minLength, number} or more characters'\n                    values={{\n                        minLength: Constants.MIN_CHANNELNAME_LENGTH,\n                    }}\n                />\n            );\n            state.invalid = true;\n        } else {\n            state.displayNameError = '';\n        }\n\n        channel.name = this.state.channelName.trim();\n        if (!channel.name) {\n            state.nameError = formatMessage(holders.required);\n            state.invalid = true;\n        } else if (channel.name.length > Constants.MAX_CHANNELNAME_LENGTH) {\n            state.nameError = formatMessage(holders.maxLength, {maxLength: Constants.MAX_CHANNELNAME_LENGTH});\n            state.invalid = true;\n        } else {\n            const cleanedName = cleanUpUrlable(channel.name);\n            if (cleanedName === channel.name) {\n                state.nameError = '';\n            } else {\n                state.nameError = formatMessage(holders.lowercase);\n                state.invalid = true;\n            }\n        }\n\n        this.setState(state);\n\n        if (state.invalid) {\n            return;\n        }\n        if (oldName === channel.name && oldDisplayName === channel.display_name) {\n            this.onSaveSuccess();\n            return;\n        }\n\n        const {data, error} = await patchChannel(channel.id, channel);\n\n        if (data) {\n            this.onSaveSuccess();\n        } else if (error) {\n            this.setError(error);\n        }\n    }\n\n    onSaveSuccess = () => {\n        this.handleHide();\n        this.unsetError();\n        browserHistory.push('/' + this.props.team.name + '/channels/' + this.state.channelName);\n    }\n\n    handleCancel = (e) => {\n        this.setState({\n            displayName: this.props.channel.display_name,\n            channelName: this.props.channel.name,\n        });\n\n        this.handleHide(e);\n    }\n\n    onNameChange = (e) => {\n        this.setState({channelName: e.target.value});\n    }\n\n    onDisplayNameChange = (e) => {\n        this.setState({displayName: e.target.value});\n    }\n\n    getTextbox = (node) => {\n        this.textbox = node;\n    }\n\n    render() {\n        let displayNameError = null;\n        let displayNameClass = 'form-group';\n        if (this.state.displayNameError) {\n            displayNameError = <label className='control-label'>{this.state.displayNameError}</label>;\n            displayNameClass += ' has-error';\n        }\n\n        let nameError = null;\n        let nameClass = 'form-group';\n        if (this.state.nameError) {\n            nameError = <label className='control-label'>{this.state.nameError}</label>;\n            nameClass += ' has-error';\n        }\n\n        let serverError = null;\n        if (this.state.serverError) {\n            serverError = <div className='form-group has-error'><label className='control-label'>{this.state.serverError}</label></div>;\n        }\n\n        const {formatMessage} = this.props.intl;\n\n        let urlInputLabel = formatMessage(holders.url);\n        const handleInputClass = 'form-control';\n        let readOnlyHandleInput = false;\n        if (this.props.channel.name === Constants.DEFAULT_CHANNEL) {\n            urlInputLabel += formatMessage(holders.defaultError);\n            readOnlyHandleInput = true;\n        }\n\n        const fullUrl = this.props.currentTeamUrl + '/channels';\n        const shortUrl = getShortenedURL(fullUrl, 35);\n        const urlTooltip = (\n            <Tooltip id='urlTooltip'>{fullUrl}</Tooltip>\n        );\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal'\n                show={this.state.show}\n                onHide={this.handleCancel}\n                onEntering={this.handleEntering}\n                onExited={this.props.onHide}\n                role='dialog'\n                aria-labelledby='renameChannelModalLabel'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='renameChannelModalLabel'\n                    >\n                        <FormattedMessage\n                            id='rename_channel.title'\n                            defaultMessage='Rename Channel'\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <form role='form'>\n                    <Modal.Body>\n                        <div className={displayNameClass}>\n                            <label className='control-label'>\n                                <FormattedMessage\n                                    id='rename_channel.displayName'\n                                    defaultMessage='Display Name'\n                                />\n                            </label>\n                            <LocalizedInput\n                                onChange={this.onDisplayNameChange}\n                                type='text'\n                                ref={this.getTextbox}\n                                id='display_name'\n                                className='form-control'\n                                placeholder={holders.displayNameHolder}\n                                value={this.state.displayName}\n                                maxLength={Constants.MAX_CHANNELNAME_LENGTH}\n                                aria-label={formatMessage({id: 'rename_channel.displayName', defaultMessage: 'Display Name'}).toLowerCase()}\n                            />\n                            {displayNameError}\n                        </div>\n                        <div className={nameClass}>\n                            <label className='control-label'>{urlInputLabel}</label>\n\n                            <div className='input-group input-group--limit'>\n                                <OverlayTrigger\n                                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                                    placement='top'\n                                    overlay={urlTooltip}\n                                >\n                                    <span className='input-group-addon'>{shortUrl}</span>\n                                </OverlayTrigger>\n                                <LocalizedInput\n                                    onChange={this.onNameChange}\n                                    type='text'\n                                    className={handleInputClass}\n                                    id='channel_name'\n                                    placeholder={holders.handleHolder}\n                                    value={this.state.channelName}\n                                    maxLength={Constants.MAX_CHANNELNAME_LENGTH}\n                                    readOnly={readOnlyHandleInput}\n                                    aria-label={formatMessage({id: 'rename_channel.title', defaultMessage: 'Rename Channel'}).toLowerCase()}\n                                />\n                            </div>\n                            {nameError}\n                        </div>\n                        {serverError}\n                    </Modal.Body>\n                    <Modal.Footer>\n                        <button\n                            type='button'\n                            className='btn btn-link'\n                            onClick={this.handleCancel}\n                        >\n                            <FormattedMessage\n                                id='rename_channel.cancel'\n                                defaultMessage='Cancel'\n                            />\n                        </button>\n                        <button\n                            onClick={this.handleSubmit}\n                            type='submit'\n                            id='save-button'\n                            className='btn btn-primary'\n                        >\n                            <FormattedMessage\n                                id='rename_channel.save'\n                                defaultMessage='Save'\n                            />\n                        </button>\n                    </Modal.Footer>\n                </form>\n            </Modal>\n        );\n    }\n}\n\nexport default injectIntl(RenameChannelModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {createSelector} from 'reselect';\nimport {patchChannel} from 'mattermost-redux/actions/channels';\nimport {getTeam} from 'mattermost-redux/selectors/entities/teams';\n\nimport {getSiteURL} from 'utils/url';\n\nimport RenameChannelModal from './rename_channel_modal.jsx';\n\nconst mapStateToProps = createSelector(\n    (state) => {\n        const currentTeamId = state.entities.teams.currentTeamId;\n        const team = getTeam(state, currentTeamId);\n        const currentTeamUrl = `${getSiteURL()}/${team.name}`;\n        return {\n            currentTeamUrl,\n            team,\n        };\n    },\n    (teamInfo) => ({...teamInfo})\n);\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: {\n            patchChannel: bindActionCreators(patchChannel, dispatch),\n        },\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(RenameChannelModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedHTMLMessage, FormattedMessage} from 'react-intl';\n\nimport {trackEvent} from 'actions/diagnostics_actions.jsx';\nimport Constants from 'utils/constants';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message.jsx';\n\nexport default class ConvertChannelModal extends React.PureComponent {\n    static propTypes = {\n\n        /**\n        * Function called when modal is dismissed\n        */\n        onHide: PropTypes.func.isRequired,\n        channelId: PropTypes.string.isRequired,\n        channelDisplayName: PropTypes.string.isRequired,\n\n        actions: PropTypes.shape({\n\n            /**\n            * Function called for converting channel to private,\n            */\n            convertChannelToPrivate: PropTypes.func.isRequired,\n        }),\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {show: true};\n    }\n\n    handleConvert = () => {\n        const {actions, channelId} = this.props;\n        if (channelId.length !== Constants.CHANNEL_ID_LENGTH) {\n            return;\n        }\n\n        actions.convertChannelToPrivate(channelId);\n        trackEvent('actions', 'convert_to_private_channel', {channel_id: channelId});\n        this.onHide();\n    }\n\n    onHide = () => {\n        this.setState({show: false});\n    }\n\n    render() {\n        const {\n            channelDisplayName,\n            onHide,\n        } = this.props;\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal'\n                show={this.state.show}\n                onHide={this.onHide}\n                onExited={onHide}\n                role='dialog'\n                aria-labelledby='convertChannelModalLabel'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='convertChannelModalLabel'\n                    >\n                        <FormattedMessage\n                            id='convert_channel.title'\n                            defaultMessage='Convert {display_name} to a Private Channel?'\n                            values={{\n                                display_name: channelDisplayName,\n                            }}\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <p>\n                        <FormattedMarkdownMessage\n                            id='convert_channel.question1'\n                            defaultMessage='When you convert **{display_name}** to a private channel, history and membership are preserved. Publicly shared files remain accessible to anyone with the link. Membership in a private channel is by invitation only.'\n                            values={{\n                                display_name: channelDisplayName,\n                            }}\n                        />\n                    </p>\n                    <p>\n                        <FormattedHTMLMessage\n                            id='convert_channel.question2'\n                            defaultMessage='The change is permanent and cannot be undone.'\n                        />\n                    </p>\n                    <p>\n                        <FormattedMarkdownMessage\n                            id='convert_channel.question3'\n                            defaultMessage='Are you sure you want to convert **{display_name}** to a private channel?'\n                            values={{\n                                display_name: channelDisplayName,\n                            }}\n                        />\n                    </p>\n                </Modal.Body>\n                <Modal.Footer>\n                    <button\n                        type='button'\n                        className='btn btn-link'\n                        onClick={this.onHide}\n                    >\n                        <FormattedMessage\n                            id='convert_channel.cancel'\n                            defaultMessage='No, cancel'\n                        />\n                    </button>\n                    <button\n                        type='button'\n                        className='btn btn-primary'\n                        data-dismiss='modal'\n                        onClick={this.handleConvert}\n                        autoFocus={true}\n                    >\n                        <FormattedMessage\n                            id='convert_channel.confirm'\n                            defaultMessage='Yes, convert to private channel'\n                        />\n                    </button>\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\n\nimport {convertChannelToPrivate} from 'mattermost-redux/actions/channels';\n\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\n\nimport ConvertChannelModal from './convert_channel_modal.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        currentTeamDetails: getCurrentTeam(state),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            convertChannelToPrivate,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ConvertChannelModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport {browserHistory} from 'utils/browser_history';\nimport Constants from 'utils/constants';\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\n\nexport default class DeleteChannelModal extends React.PureComponent {\n    static propTypes = {\n\n        /**\n        * Function called when modal is dismissed\n        */\n        onHide: PropTypes.func.isRequired,\n\n        /**\n         * channel data\n         */\n        channel: PropTypes.object.isRequired,\n\n        /**\n         * currentTeamDetails used for redirection after deleting channel\n         */\n        currentTeamDetails: PropTypes.object.isRequired,\n\n        canViewArchivedChannels: PropTypes.bool,\n        penultimateViewedChannelName: PropTypes.string.isRequired,\n\n        actions: PropTypes.shape({\n\n            /**\n            * Function called for deleting channel,\n            */\n\n            deleteChannel: PropTypes.func.isRequired,\n        }),\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {show: true};\n    }\n\n    handleDelete = () => {\n        if (this.props.channel.id.length !== Constants.CHANNEL_ID_LENGTH) {\n            return;\n        }\n        if (!this.props.canViewArchivedChannels) {\n            const {penultimateViewedChannelName} = this.props;\n            browserHistory.push('/' + this.props.currentTeamDetails.name + '/channels/' + penultimateViewedChannelName);\n        }\n        this.props.actions.deleteChannel(this.props.channel.id);\n        this.onHide();\n    }\n\n    onHide = () => {\n        this.setState({show: false});\n    }\n\n    render() {\n        const {canViewArchivedChannels} = this.props;\n        return (\n            <Modal\n                dialogClassName='a11y__modal'\n                show={this.state.show}\n                onHide={this.onHide}\n                onExited={this.props.onHide}\n                role='dialog'\n                aria-labelledby='deleteChannelModalLabel'\n                id='deleteChannelModal'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='deleteChannelModalLabel'\n                    >\n                        <FormattedMessage\n                            id='delete_channel.confirm'\n                            defaultMessage='Confirm ARCHIVE Channel'\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <div className='alert alert-danger'>\n                        {!canViewArchivedChannels &&\n                            <FormattedMarkdownMessage\n                                id='delete_channel.question'\n                                defaultMessage='This will archive the channel from the team and make its contents inaccessible for all users. \\n \\nAre you sure you wish to archive the **{display_name}** channel?'\n                                values={{\n                                    display_name: this.props.channel.display_name,\n                                }}\n                            />}\n                        {canViewArchivedChannels &&\n                            <FormattedMarkdownMessage\n                                id='delete_channel.viewArchived.question'\n                                defaultMessage={'This will archive the channel from the team. Channel contents will still be accessible by channel members.\\n \\nAre you sure you wish to archive the **{display_name}** channel?'}\n                                values={{\n                                    display_name: this.props.channel.display_name,\n                                }}\n                            />}\n                    </div>\n                </Modal.Body>\n                <Modal.Footer>\n                    <button\n                        type='button'\n                        className='btn btn-link'\n                        onClick={this.onHide}\n                    >\n                        <FormattedMessage\n                            id='delete_channel.cancel'\n                            defaultMessage='Cancel'\n                        />\n                    </button>\n                    <button\n                        type='button'\n                        className='btn btn-danger'\n                        data-dismiss='modal'\n                        onClick={this.handleDelete}\n                        autoFocus={true}\n                        id='deleteChannelModalDeleteButton'\n                    >\n                        <FormattedMessage\n                            id='delete_channel.del'\n                            defaultMessage='Archive'\n                        />\n                    </button>\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {deleteChannel} from 'mattermost-redux/actions/channels';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport DeleteChannelModal from './delete_channel_modal.jsx';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n\n    return {\n        canViewArchivedChannels: config.ExperimentalViewArchivedChannels === 'true',\n        currentTeamDetails: getCurrentTeam(state),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            deleteChannel,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DeleteChannelModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport Constants from 'utils/constants';\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\n\nexport default class UnarchiveChannelModal extends React.PureComponent {\n    static propTypes = {\n\n        /**\n        * Function called when modal is dismissed\n        */\n        onHide: PropTypes.func.isRequired,\n\n        /**\n         * channel data\n         */\n        channel: PropTypes.object.isRequired,\n\n        actions: PropTypes.shape({\n\n            /**\n            * Function called for deleting channel,\n            */\n\n            unarchiveChannel: PropTypes.func.isRequired,\n        }),\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {show: true};\n    }\n\n    handleUnarchive = () => {\n        if (this.props.channel.id.length !== Constants.CHANNEL_ID_LENGTH) {\n            return;\n        }\n        this.props.actions.unarchiveChannel(this.props.channel.id);\n        this.onHide();\n    }\n\n    onHide = () => {\n        this.setState({show: false});\n    }\n\n    render() {\n        return (\n            <Modal\n                dialogClassName='a11y__modal'\n                show={this.state.show}\n                onHide={this.onHide}\n                onExited={this.props.onHide}\n                role='dialog'\n                aria-labelledby='unarchiveChannelModalLabel'\n                id='unarchiveChannelModal'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='unarchiveChannelModalLabel'\n                    >\n                        <FormattedMessage\n                            id='unarchive_channel.confirm'\n                            defaultMessage='Confirm UNARCHIVE Channel'\n                        />\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <div className='alert alert-danger'>\n                        <FormattedMarkdownMessage\n                            id='unarchive_channel.viewArchived.question'\n                            defaultMessage={'Are you sure you wish to unarchive the **{display_name}** channel?'}\n                            values={{\n                                display_name: this.props.channel.display_name,\n                            }}\n                        />\n                    </div>\n                </Modal.Body>\n                <Modal.Footer>\n                    <button\n                        type='button'\n                        className='btn btn-link'\n                        onClick={this.onHide}\n                    >\n                        <FormattedMessage\n                            id='unarchive_channel.cancel'\n                            defaultMessage='Cancel'\n                        />\n                    </button>\n                    <button\n                        type='button'\n                        className='btn btn-danger'\n                        data-dismiss='modal'\n                        onClick={this.handleUnarchive}\n                        autoFocus={true}\n                        id='unarchiveChannelModalDeleteButton'\n                    >\n                        <FormattedMessage\n                            id='unarchive_channel.del'\n                            defaultMessage='Unarchive'\n                        />\n                    </button>\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {unarchiveChannel} from 'mattermost-redux/actions/channels';\n\nimport UnarchiveChannelModal from './unarchive_channel_modal.jsx';\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            unarchiveChannel,\n        }, dispatch),\n    };\n}\n\nexport default connect(null, mapDispatchToProps)(UnarchiveChannelModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage, injectIntl, IntlShape} from 'react-intl';\n\nimport Groups from 'mattermost-redux/constants/groups';\n\nimport {Group, SyncableType} from 'mattermost-redux/types/groups';\n\nimport {Channel} from 'mattermost-redux/types/channels';\n\nimport AddGroupsToChannelModal from 'components/add_groups_to_channel_modal';\n\nimport {ModalIdentifiers} from 'utils/constants';\nimport {intlShape} from 'utils/react_intl';\n\nimport ListModal, {DEFAULT_NUM_PER_PAGE} from 'components/list_modal.jsx';\n\nimport DropdownIcon from 'components/widgets/icons/fa_dropdown_icon';\n\nimport groupsAvatar from 'images/groups-avatar.png';\n\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\nimport Menu from 'components/widgets/menu/menu';\n\nimport * as Utils from 'utils/utils.jsx';\n\ntype Props = {\n    channel: Channel;\n    intl: IntlShape;\n    actions: {\n        getGroupsAssociatedToChannel: (channelId: string, searchTerm: string, pageNumber: number, DEFAULT_NUM_PER_PAGE: number) => any;\n        unlinkGroupSyncable: (itemId: string, channelId: string, groupsSyncableTypeChannel: string) => any;\n        patchGroupSyncable: (itemId: string, channelId: string, groupsSyncableTypeChannel: string, params: {schemeAdmin: boolean}) => any;\n        getMyChannelMember: (channelId: string) => any;\n        closeModal: (modalIdentifiersManageChannelGroups: string) => any;\n        openModal: (params: {modalId: string; dialogType: any}) => any;\n    };\n};\n\nclass ChannelGroupsManageModal extends React.PureComponent<Props> {\n    public loadItems = async (pageNumber: number, searchTerm: string) => {\n        const {data} = await this.props.actions.getGroupsAssociatedToChannel(this.props.channel.id, searchTerm, pageNumber, DEFAULT_NUM_PER_PAGE);\n        return {\n            items: data.groups,\n            totalCount: data.totalGroupCount,\n        };\n    };\n\n    public onClickRemoveGroup = (item: Group, listModal: any) => this.props.actions.unlinkGroupSyncable(item.id, this.props.channel.id, Groups.SYNCABLE_TYPE_CHANNEL).then(async () => {\n        listModal.setState({loading: true});\n        const {items, totalCount} = await listModal.props.loadItems(listModal.setState.page, listModal.state.searchTerm);\n        listModal.setState({loading: false, items, totalCount});\n    });\n\n    public onHide = () => {\n        this.props.actions.closeModal(ModalIdentifiers.MANAGE_CHANNEL_GROUPS);\n    };\n\n    public titleButtonOnClick = () => {\n        this.onHide();\n        this.props.actions.openModal({modalId: ModalIdentifiers.ADD_GROUPS_TO_TEAM, dialogType: AddGroupsToChannelModal});\n    };\n\n    public setChannelMemberStatus = async (item: Group, listModal: any, isChannelAdmin: boolean) => {\n        this.props.actions.patchGroupSyncable(item.id, this.props.channel.id, Groups.SYNCABLE_TYPE_CHANNEL, {schemeAdmin: isChannelAdmin}).then(async () => {\n            listModal.setState({loading: true});\n            const {items, totalCount} = await listModal.props.loadItems(listModal.setState.page, listModal.state.searchTerm);\n            await this.props.actions.getMyChannelMember(this.props.channel.id);\n\n            listModal.setState({loading: false, items, totalCount});\n        });\n    };\n\n    public renderRow = (item: Group, listModal: any) => {\n        let title;\n        if (item.scheme_admin) {\n            title = Utils.localizeMessage('channel_members_dropdown.channel_admins', 'Channel Admins');\n        } else {\n            title = Utils.localizeMessage('channel_members_dropdown.channel_members', 'Channel Members');\n        }\n\n        return (\n            <div\n                key={item.id}\n                className='more-modal__row'\n            >\n                <img\n                    className='more-modal__image'\n                    src={groupsAvatar}\n                    alt='group picture'\n                    width='32'\n                    height='32'\n                />\n                <div className='more-modal__details'>\n                    <div className='more-modal__name'>{item.display_name} {'-'}{' '}\n                        <span className='more-modal__name_count'>\n                            <FormattedMessage\n                                id='numMembers'\n                                defaultMessage='{num, number} {num, plural, one {member} other {members}}'\n                                values={{\n                                    num: item.member_count,\n                                }}\n                            />\n                        </span>\n                    </div>\n                </div>\n                <div className='more-modal__actions'>\n                    <MenuWrapper>\n                        <button\n                            id={`teamGroupsDropdown_${item.display_name}`}\n                            className='dropdown-toggle theme color--link style--none'\n                            type='button'\n                            aria-expanded='true'\n                        >\n                            <span>{title} </span>\n                            <DropdownIcon/>\n                        </button>\n                        <Menu\n                            openLeft={true}\n                            ariaLabel={Utils.localizeMessage('channel_members_dropdown.menuAriaLabel', 'Change the role of channel member')}\n                        >\n                            <Menu.ItemAction\n                                show={!item.scheme_admin}\n                                onClick={() => this.setChannelMemberStatus(item, listModal, true)}\n                                text={Utils.localizeMessage('channel_members_dropdown.make_channel_admins', 'Make Channel Admins')}\n                            />\n                            <Menu.ItemAction\n                                show={Boolean(item.scheme_admin)}\n                                onClick={() => this.setChannelMemberStatus(item, listModal, false)}\n                                text={Utils.localizeMessage('channel_members_dropdown.make_channel_members', 'Make Channel Members')}\n                            />\n                            <Menu.ItemAction\n                                onClick={() => this.onClickRemoveGroup(item, listModal)}\n                                text={Utils.localizeMessage('group_list_modal.removeGroupButton', 'Remove Group')}\n                            />\n                        </Menu>\n                    </MenuWrapper>\n                </div>\n            </div>\n        );\n    };\n\n    render() {\n        const {formatMessage} = this.props.intl;\n        return (\n            <ListModal\n                titleText={formatMessage({id: 'groups', defaultMessage: '{channel} Groups'}, {channel: this.props.channel.display_name})}\n                searchPlaceholderText={formatMessage({id: 'manage_channel_groups_modal.search_placeholder', defaultMessage: 'Search groups'})}\n                renderRow={this.renderRow}\n                loadItems={this.loadItems}\n                onHide={this.onHide}\n                titleBarButtonText={formatMessage({id: 'group_list_modal.addGroupButton', defaultMessage: 'Add Groups'})}\n                titleBarButtonOnClick={this.titleButtonOnClick}\n            />\n        );\n    }\n}\n\nexport default injectIntl(ChannelGroupsManageModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators, Dispatch, ActionCreatorsMapObject} from 'redux';\nimport {connect} from 'react-redux';\nimport {getGroupsAssociatedToChannel, unlinkGroupSyncable, patchGroupSyncable} from 'mattermost-redux/actions/groups';\nimport {getMyChannelMember} from 'mattermost-redux/actions/channels';\nimport {GlobalState} from 'mattermost-redux/types/store';\nimport {ActionFunc} from 'mattermost-redux/types/actions';\n\nimport {SyncableType} from 'mattermost-redux/types/groups';\n\nimport {closeModal, openModal} from 'actions/views/modals';\n\nimport ChannelGroupsManageModal from './channel_groups_manage_modal';\n\nconst mapStateToProps = (state: GlobalState, ownProps: any) => {\n    return {\n        channel: state.entities.channels.channels[ownProps.channelID],\n    };\n};\n\ntype Actions = {\n    getGroupsAssociatedToChannel: (channelId: string, searchTerm: string, pageNumber: number, DEFAULT_NUM_PER_PAGE: number) => Promise<{\n        data: boolean;\n    }>;\n    unlinkGroupSyncable: (itemId: string, channelId: string, type: string) => Promise<{\n        data: boolean;\n    }>;\n    patchGroupSyncable: (itemId: string, channelId: string, groupsSyncableTypeChannel: string, params: {schemeAdmin: boolean}) => Promise<{\n        data: boolean;\n    }>;\n    getMyChannelMember: (channelId: string) => Promise<{\n        data: boolean;\n    }>;\n    closeModal: (modalIdentifiersManageChannelGroups: any) => Promise<{\n        data: boolean;\n    }>;\n    openModal: (params: {modalId: any; dialogType: any}) => Promise<{\n        data: boolean;\n    }>;\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\n    actions: bindActionCreators<ActionCreatorsMapObject<ActionFunc>, Actions>(\n        {\n            getGroupsAssociatedToChannel,\n            closeModal,\n            openModal,\n            unlinkGroupSyncable,\n            patchGroupSyncable,\n            getMyChannelMember\n        },\n        dispatch\n    )\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelGroupsManageModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {showLeavePrivateChannelModal} from 'actions/global_actions';\nimport {Constants} from 'utils/constants';\nimport {localizeMessage} from 'utils/utils';\n\nimport Menu from 'components/widgets/menu/menu';\n\nexport default class LeaveChannel extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * Object with info about user\n         */\n        channel: PropTypes.object.isRequired,\n\n        /**\n         * Boolean whether the channel is default\n         */\n        isDefault: PropTypes.bool.isRequired,\n\n        /**\n         * Boolean whether the user is a guest or no\n         */\n        isGuestUser: PropTypes.bool.isRequired,\n\n        /**\n         * Use for test selector\n         */\n        id: PropTypes.string,\n\n        /**\n         * Object with action creators\n         */\n        actions: PropTypes.shape({\n\n            /**\n             * Action creator to leave channel\n             */\n            leaveChannel: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    static defaultProps = {\n        isGuestUser: false,\n    }\n\n    handleLeave = (e) => {\n        e.preventDefault();\n\n        const {\n            channel,\n            actions: {\n                leaveChannel,\n            },\n        } = this.props;\n\n        if (channel.type === Constants.PRIVATE_CHANNEL) {\n            showLeavePrivateChannelModal(channel);\n        } else {\n            leaveChannel(channel.id);\n        }\n    }\n\n    render() {\n        const {channel, isDefault, isGuestUser, id} = this.props;\n\n        return (\n            <Menu.ItemAction\n                id={id}\n                show={(!isDefault || isGuestUser) && channel.type !== Constants.DM_CHANNEL && channel.type !== Constants.GM_CHANNEL}\n                onClick={this.handleLeave}\n                text={localizeMessage('channel_header.leave', 'Leave Channel')}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\n\nimport {leaveChannel} from 'actions/views/channel';\n\nimport LeaveChannel from './leave_channel';\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({leaveChannel}, dispatch),\n});\n\nexport default connect(null, mapDispatchToProps)(LeaveChannel);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {localizeMessage} from 'utils/utils';\n\nimport Menu from 'components/widgets/menu/menu';\n\nexport default class CloseChannel extends React.PureComponent {\n    static propTypes = {\n        isArchived: PropTypes.bool.isRequired,\n        actions: PropTypes.shape({\n            goToLastViewedChannel: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    handleClose = () => {\n        this.props.actions.goToLastViewedChannel();\n    }\n\n    render() {\n        return (\n            <Menu.ItemAction\n                show={this.props.isArchived}\n                onClick={this.handleClose}\n                text={localizeMessage('center_panel.archived.closeChannel', 'Close Channel')}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\n\nimport {goToLastViewedChannel} from 'actions/views/channel';\n\nimport CloseChannel from './close_channel';\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({\n        goToLastViewedChannel,\n    }, dispatch),\n});\n\nexport default connect(null, mapDispatchToProps)(CloseChannel);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {localizeMessage} from 'utils/utils';\nimport {Constants} from 'utils/constants';\nimport {browserHistory} from 'utils/browser_history';\nimport Menu from 'components/widgets/menu/menu';\n\nexport default class CloseMessage extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * Object with info about currentUser\n         */\n        currentUser: PropTypes.object.isRequired,\n\n        /**\n         * Object with info about currentTeam\n         */\n        currentTeam: PropTypes.object.isRequired,\n\n        /**\n         * String with info about redirect\n         */\n        redirectChannel: PropTypes.string.isRequired,\n\n        /**\n         * Object with info about channel\n         */\n        channel: PropTypes.object.isRequired,\n\n        /**\n         * Use for test selector\n         */\n        id: PropTypes.string,\n\n        /**\n         * Object with action creators\n         */\n        actions: PropTypes.shape({\n\n            /**\n             * Action creator to update user preferences\n             */\n            savePreferences: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    handleClose = (e) => {\n        e.preventDefault();\n\n        const {\n            channel,\n            currentUser,\n            currentTeam,\n            redirectChannel,\n            actions: {\n                savePreferences,\n            },\n        } = this.props;\n\n        let name;\n        let category;\n        if (channel.type === Constants.DM_CHANNEL) {\n            category = Constants.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW;\n            name = channel.teammate_id;\n        } else {\n            category = Constants.Preferences.CATEGORY_GROUP_CHANNEL_SHOW;\n            name = channel.id;\n        }\n\n        savePreferences(currentUser.id, [{user_id: currentUser.id, category, name, value: 'false'}]);\n\n        browserHistory.push(`/${currentTeam.name}/channels/${redirectChannel}`);\n    }\n\n    render() {\n        const {id, channel} = this.props;\n\n        let text;\n        if (channel.type === Constants.DM_CHANNEL) {\n            text = localizeMessage('center_panel.direct.closeDirectMessage', 'Close Direct Message');\n        } else if (channel.type === Constants.GM_CHANNEL) {\n            text = localizeMessage('center_panel.direct.closeGroupMessage', 'Close Group Message');\n        }\n\n        return (\n            <Menu.ItemAction\n                id={id}\n                show={channel.type === Constants.DM_CHANNEL || channel.type === Constants.GM_CHANNEL}\n                onClick={this.handleClose}\n                text={text}\n            />\n        );\n    }\n}","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\n\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\nimport {getCurrentTeam, getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {getRedirectChannelNameForTeam} from 'mattermost-redux/selectors/entities/channels';\n\nimport CloseMessage from './close_message';\n\nconst mapStateToProps = (state) => {\n    return {\n        currentTeam: getCurrentTeam(state),\n        redirectChannel: getRedirectChannelNameForTeam(state, getCurrentTeamId(state)),\n    };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({savePreferences}, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CloseMessage);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {NotificationLevels} from 'utils/constants';\n\nimport {localizeMessage} from 'utils/utils';\n\nimport Menu from 'components/widgets/menu/menu';\n\nexport default class MenuItemToggleMuteChannel extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * Object with info about the current user\n         */\n        user: PropTypes.object.isRequired,\n\n        /**\n         * Object with info about the current channel\n         */\n        channel: PropTypes.object.isRequired,\n\n        /**\n         * Boolean whether the current channel is muted\n         */\n        isMuted: PropTypes.bool.isRequired,\n\n        /**\n         * Use for test selector\n         */\n        id: PropTypes.string,\n\n        /**\n         * Object with action creators\n         */\n        actions: PropTypes.shape({\n            updateChannelNotifyProps: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    handleClick = () => {\n        const {\n            user,\n            channel,\n            isMuted,\n            actions: {\n                updateChannelNotifyProps,\n            },\n        } = this.props;\n\n        updateChannelNotifyProps(user.id, channel.id, {\n            mark_unread: isMuted ? NotificationLevels.ALL : NotificationLevels.MENTION,\n        });\n    }\n\n    render() {\n        const {\n            id,\n            isMuted,\n        } = this.props;\n\n        let text;\n        if (isMuted) {\n            text = localizeMessage('channel_header.unmute', 'Unmute Channel');\n        } else {\n            text = localizeMessage('channel_header.mute', 'Mute Channel');\n        }\n\n        return (\n            <Menu.ItemAction\n                id={id}\n                onClick={this.handleClick}\n                text={text}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {updateChannelNotifyProps} from 'mattermost-redux/actions/channels';\n\nimport MenuItemToggleMuteChannel from './toggle_mute_channel';\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({\n        updateChannelNotifyProps,\n    }, dispatch),\n});\n\nexport default connect(null, mapDispatchToProps)(MenuItemToggleMuteChannel);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {localizeMessage} from 'utils/utils';\n\nimport Menu from 'components/widgets/menu/menu';\n\nexport default class ToggleFavoriteChannel extends React.PureComponent {\n    static propTypes = {\n        show: PropTypes.bool.isRequired,\n        channel: PropTypes.object.isRequired,\n        isFavorite: PropTypes.bool.isRequired,\n        actions: PropTypes.shape({\n            favoriteChannel: PropTypes.func.isRequired,\n            unfavoriteChannel: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    static defaultProps = {\n        show: true,\n    }\n\n    toggleFavoriteChannel = (channelId) => {\n        const {\n            isFavorite,\n            actions: {\n                favoriteChannel,\n                unfavoriteChannel,\n            },\n        } = this.props;\n\n        return isFavorite ? unfavoriteChannel(channelId) : favoriteChannel(channelId);\n    }\n\n    handleClick = (e) => {\n        e.preventDefault();\n        this.toggleFavoriteChannel(this.props.channel.id);\n    }\n\n    render() {\n        let text;\n        if (this.props.isFavorite) {\n            text = localizeMessage('channelHeader.removeFromFavorites', 'Remove from Favorites');\n        } else {\n            text = localizeMessage('channelHeader.addToFavorites', 'Add to Favorites');\n        }\n        return (\n            <Menu.ItemAction\n                show={this.props.show}\n                onClick={this.handleClick}\n                text={text}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {favoriteChannel, unfavoriteChannel} from 'mattermost-redux/actions/channels';\n\nimport ToggleFavoriteChannel from './toggle_favorite_channel';\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({\n        favoriteChannel,\n        unfavoriteChannel,\n    }, dispatch),\n});\n\nexport default connect(null, mapDispatchToProps)(ToggleFavoriteChannel);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {localizeMessage} from 'utils/utils';\n\nimport Menu from 'components/widgets/menu/menu';\n\nexport default class ViewPinnedPosts extends React.PureComponent {\n    static propTypes = {\n        show: PropTypes.bool,\n        channel: PropTypes.object.isRequired,\n        hasPinnedPosts: PropTypes.bool.isRequired,\n        actions: PropTypes.shape({\n            closeRightHandSide: PropTypes.func.isRequired,\n            showPinnedPosts: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    handleClick = (e) => {\n        e.preventDefault();\n\n        const {\n            channel,\n            hasPinnedPosts,\n            actions: {\n                closeRightHandSide,\n                showPinnedPosts,\n            },\n        } = this.props;\n\n        if (hasPinnedPosts) {\n            closeRightHandSide();\n        } else {\n            showPinnedPosts(channel.id);\n        }\n    }\n\n    render() {\n        return (\n            <Menu.ItemAction\n                show={this.props.show}\n                onClick={this.handleClick}\n                text={localizeMessage('navbar.viewPinnedPosts', 'View Pinned Posts')}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\n\nimport {closeRightHandSide, showPinnedPosts} from 'actions/views/rhs';\nimport {getRhsState} from 'selectors/rhs';\nimport {RHSStates} from 'utils/constants';\n\nimport ViewPinnedPosts from './view_pinned_posts';\n\nconst mapStateToProps = (state) => ({\n    hasPinnedPosts: getRhsState(state) === RHSStates.PIN,\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({\n        closeRightHandSide,\n        showPinnedPosts,\n    }, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ViewPinnedPosts);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {Permissions} from 'mattermost-redux/constants';\n\nimport {Constants, ModalIdentifiers} from 'utils/constants';\nimport {localizeMessage, isGuest} from 'utils/utils';\n\nimport MobileChannelHeaderPlug from 'plugins/mobile_channel_header_plug';\n\nimport ChannelNotificationsModal from 'components/channel_notifications_modal';\nimport ChannelInviteModal from 'components/channel_invite_modal';\nimport ChannelMembersModal from 'components/channel_members_modal';\nimport ChannelInfoModal from 'components/channel_info_modal';\nimport EditChannelHeaderModal from 'components/edit_channel_header_modal';\nimport EditChannelPurposeModal from 'components/edit_channel_purpose_modal';\nimport RenameChannelModal from 'components/rename_channel_modal';\nimport ConvertChannelModal from 'components/convert_channel_modal';\nimport DeleteChannelModal from 'components/delete_channel_modal';\nimport UnarchiveChannelModal from 'components/unarchive_channel_modal';\nimport MoreDirectChannels from 'components/more_direct_channels';\nimport AddGroupsToChannelModal from 'components/add_groups_to_channel_modal';\nimport ChannelGroupsManageModal from 'components/channel_groups_manage_modal';\n\nimport ChannelPermissionGate from 'components/permissions_gates/channel_permission_gate';\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\n\nimport Menu from 'components/widgets/menu/menu';\n\nimport MenuItemLeaveChannel from './menu_items/leave_channel';\nimport MenuItemCloseChannel from './menu_items/close_channel';\nimport MenuItemCloseMessage from './menu_items/close_message';\nimport MenuItemToggleMuteChannel from './menu_items/toggle_mute_channel';\nimport MenuItemToggleFavoriteChannel from './menu_items/toggle_favorite_channel';\nimport MenuItemViewPinnedPosts from './menu_items/view_pinned_posts';\n\nexport default class ChannelHeaderDropdown extends React.PureComponent {\n    static propTypes = {\n        user: PropTypes.object.isRequired,\n        channel: PropTypes.object.isRequired,\n        isDefault: PropTypes.bool.isRequired,\n        isFavorite: PropTypes.bool.isRequired,\n        isReadonly: PropTypes.bool.isRequired,\n        isMuted: PropTypes.bool.isRequired,\n        isArchived: PropTypes.bool.isRequired,\n        isMobile: PropTypes.bool.isRequired,\n        penultimateViewedChannelName: PropTypes.string.isRequired,\n        pluginMenuItems: PropTypes.arrayOf(PropTypes.object),\n        isLicensedForLDAPGroups: PropTypes.bool,\n    }\n\n    render() {\n        const {\n            user,\n            channel,\n            isDefault,\n            isFavorite,\n            isMuted,\n            isReadonly,\n            isArchived,\n            isMobile,\n            penultimateViewedChannelName,\n            isLicensedForLDAPGroups,\n        } = this.props;\n\n        const isPrivate = channel.type === Constants.PRIVATE_CHANNEL;\n        const isGroupConstrained = channel.group_constrained === true;\n        const channelMembersPermission = isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_MEMBERS : Permissions.MANAGE_PUBLIC_CHANNEL_MEMBERS;\n        const channelPropertiesPermission = isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES : Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES;\n        const channelDeletePermission = isPrivate ? Permissions.DELETE_PRIVATE_CHANNEL : Permissions.DELETE_PUBLIC_CHANNEL;\n        const channelUnarchivePermission = Permissions.MANAGE_TEAM;\n\n        let divider;\n        if (isMobile) {\n            divider = (\n                <li className='MenuGroup mobile-menu-divider'>\n                    <hr/>\n                </li>\n            );\n        }\n\n        const pluginItems = this.props.pluginMenuItems.map((item) => {\n            return (\n                <Menu.ItemAction\n                    id={item.id + '_pluginmenuitem'}\n                    key={item.id + '_pluginmenuitem'}\n                    onClick={() => {\n                        if (item.action) {\n                            item.action(this.props.channel.id);\n                        }\n                    }}\n                    text={item.text}\n                />\n            );\n        });\n\n        return (\n            <React.Fragment>\n                <Menu.Group divider={divider}>\n                    <Menu.ItemToggleModalRedux\n                        id='channelViewInfo'\n                        show={channel.type !== Constants.DM_CHANNEL && channel.type !== Constants.GM_CHANNEL}\n                        modalId={ModalIdentifiers.CHANNEL_INFO}\n                        dialogType={ChannelInfoModal}\n                        dialogProps={{channel}}\n                        text={localizeMessage('navbar.viewInfo', 'View Info')}\n                    />\n                    <MenuItemToggleFavoriteChannel\n                        id='channelToggleFavorite'\n                        show={isMobile}\n                        channel={channel}\n                        isFavorite={isFavorite}\n                    />\n                    <MenuItemViewPinnedPosts\n                        id='channelViewPinnedPosts'\n                        show={isMobile}\n                        channel={channel}\n                    />\n                    <Menu.ItemToggleModalRedux\n                        id='channelNotificationPreferences'\n                        show={channel.type !== Constants.DM_CHANNEL && !isArchived}\n                        modalId={ModalIdentifiers.CHANNEL_NOTIFICATIONS}\n                        dialogType={ChannelNotificationsModal}\n                        dialogProps={{\n                            channel,\n                            currentUser: user,\n                        }}\n                        text={localizeMessage('navbar.preferences', 'Notification Preferences')}\n                    />\n                    <MenuItemToggleMuteChannel\n                        id='channelToggleMuteChannel'\n                        user={user}\n                        channel={channel}\n                        isMuted={isMuted}\n                        isArchived={isArchived}\n                    />\n                </Menu.Group>\n\n                <Menu.Group divider={divider}>\n                    <ChannelPermissionGate\n                        channelId={channel.id}\n                        teamId={channel.team_id}\n                        permissions={[channelMembersPermission]}\n                    >\n                        <Menu.ItemToggleModalRedux\n                            id='channelAddMembers'\n                            show={channel.type !== Constants.DM_CHANNEL && channel.type !== Constants.GM_CHANNEL && !isArchived && !isDefault && !isGroupConstrained}\n                            modalId={ModalIdentifiers.CHANNEL_INVITE}\n                            dialogType={ChannelInviteModal}\n                            dialogProps={{channel}}\n                            text={localizeMessage('navbar.addMembers', 'Add Members')}\n                        />\n                        <Menu.ItemToggleModalRedux\n                            id='channelAddMembers'\n                            show={channel.type === Constants.GM_CHANNEL && !isArchived && !isGroupConstrained}\n                            modalId={ModalIdentifiers.CREATE_DM_CHANNEL}\n                            dialogType={MoreDirectChannels}\n                            dialogProps={{isExistingChannel: true}}\n                            text={localizeMessage('navbar.addMembers', 'Add Members')}\n                        />\n                    </ChannelPermissionGate>\n                    <Menu.ItemToggleModalRedux\n                        id='channelViewMembers'\n                        show={channel.type !== Constants.DM_CHANNEL && channel.type !== Constants.GM_CHANNEL && (isArchived || isDefault)}\n                        modalId={ModalIdentifiers.CHANNEL_MEMBERS}\n                        dialogType={ChannelMembersModal}\n                        dialogProps={{channel}}\n                        text={localizeMessage('channel_header.viewMembers', 'View Members')}\n                    />\n                    <ChannelPermissionGate\n                        channelId={channel.id}\n                        teamId={channel.team_id}\n                        permissions={[channelMembersPermission]}\n                    >\n                        <Menu.ItemToggleModalRedux\n                            id='channelAddGroups'\n                            show={channel.type !== Constants.DM_CHANNEL && channel.type !== Constants.GM_CHANNEL && !isArchived && !isDefault && isGroupConstrained && isLicensedForLDAPGroups}\n                            modalId={ModalIdentifiers.ADD_GROUPS_TO_CHANNEL}\n                            dialogType={AddGroupsToChannelModal}\n                            text={localizeMessage('navbar.addGroups', 'Add Groups')}\n                        />\n                        <Menu.ItemToggleModalRedux\n                            id='channelManageGroups'\n                            show={channel.type !== Constants.DM_CHANNEL && channel.type !== Constants.GM_CHANNEL && !isArchived && !isDefault && isGroupConstrained && isLicensedForLDAPGroups}\n                            modalId={ModalIdentifiers.MANAGE_CHANNEL_GROUPS}\n                            dialogType={ChannelGroupsManageModal}\n                            dialogProps={{channelID: channel.id}}\n                            text={localizeMessage('navbar_dropdown.manageGroups', 'Manage Groups')}\n                        />\n                        <Menu.ItemToggleModalRedux\n                            id='channelManageMembers'\n                            show={channel.type !== Constants.DM_CHANNEL && channel.type !== Constants.GM_CHANNEL && !isArchived && !isDefault}\n                            modalId={ModalIdentifiers.CHANNEL_MEMBERS}\n                            dialogType={ChannelMembersModal}\n                            dialogProps={{channel}}\n                            text={localizeMessage('channel_header.manageMembers', 'Manage Members')}\n                        />\n                    </ChannelPermissionGate>\n                    <ChannelPermissionGate\n                        channelId={channel.id}\n                        teamId={channel.team_id}\n                        permissions={[channelMembersPermission]}\n                        invert={true}\n                    >\n                        <Menu.ItemToggleModalRedux\n                            id='channelViewMembers'\n                            show={channel.type !== Constants.DM_CHANNEL && channel.type !== Constants.GM_CHANNEL && !isArchived && !isDefault}\n                            modalId={ModalIdentifiers.CHANNEL_MEMBERS}\n                            dialogType={ChannelMembersModal}\n                            dialogProps={{channel}}\n                            text={localizeMessage('channel_header.viewMembers', 'View Members')}\n                        />\n                    </ChannelPermissionGate>\n                </Menu.Group>\n\n                <Menu.Group divider={divider}>\n                    <Menu.ItemToggleModalRedux\n                        id='channelEditHeader'\n                        show={(channel.type === Constants.DM_CHANNEL || channel.type === Constants.GM_CHANNEL) && !isArchived && !isReadonly}\n                        modalId={ModalIdentifiers.EDIT_CHANNEL_HEADER}\n                        dialogType={EditChannelHeaderModal}\n                        dialogProps={{channel}}\n                        text={localizeMessage('channel_header.setHeader', 'Edit Channel Header')}\n                    />\n                    <ChannelPermissionGate\n                        channelId={channel.id}\n                        teamId={channel.team_id}\n                        permissions={[channelPropertiesPermission]}\n                    >\n                        <Menu.ItemToggleModalRedux\n                            id='channelEditHeader'\n                            show={channel.type !== Constants.DM_CHANNEL && channel.type !== Constants.GM_CHANNEL && !isArchived && !isReadonly}\n                            modalId={ModalIdentifiers.EDIT_CHANNEL_HEADER}\n                            dialogType={EditChannelHeaderModal}\n                            dialogProps={{channel}}\n                            text={localizeMessage('channel_header.setHeader', 'Edit Channel Header')}\n                        />\n                        <Menu.ItemToggleModalRedux\n                            id='channelEditPurpose'\n                            show={!isArchived && !isReadonly && channel.type !== Constants.DM_CHANNEL && channel.type !== Constants.GM_CHANNEL}\n                            modalId={ModalIdentifiers.EDIT_CHANNEL_PURPOSE}\n                            dialogType={EditChannelPurposeModal}\n                            dialogProps={{channel}}\n                            text={localizeMessage('channel_header.setPurpose', 'Edit Channel Purpose')}\n                        />\n                        <Menu.ItemToggleModalRedux\n                            id='channelRename'\n                            show={!isArchived && channel.type !== Constants.DM_CHANNEL && channel.type !== Constants.GM_CHANNEL}\n                            modalId={ModalIdentifiers.RENAME_CHANNEL}\n                            dialogType={RenameChannelModal}\n                            dialogProps={{channel}}\n                            text={localizeMessage('channel_header.rename', 'Rename Channel')}\n                        />\n                    </ChannelPermissionGate>\n                    <TeamPermissionGate\n                        teamId={channel.team_id}\n                        permissions={[Permissions.MANAGE_TEAM]}\n                    >\n                        <Menu.ItemToggleModalRedux\n                            id='channelCovertToPrivate'\n                            show={!isArchived && !isDefault && channel.type === Constants.OPEN_CHANNEL}\n                            modalId={ModalIdentifiers.CONVERT_CHANNEL}\n                            dialogType={ConvertChannelModal}\n                            dialogProps={{\n                                channelId: channel.id,\n                                channelDisplayName: channel.display_name,\n                            }}\n                            text={localizeMessage('channel_header.convert', 'Convert to Private Channel')}\n                        />\n                    </TeamPermissionGate>\n                    <ChannelPermissionGate\n                        channelId={channel.id}\n                        teamId={channel.team_id}\n                        permissions={[channelDeletePermission]}\n                    >\n                        <Menu.ItemToggleModalRedux\n                            id='channelArchiveChannel'\n                            show={!isArchived && !isDefault && channel.type !== Constants.DM_CHANNEL && channel.type !== Constants.GM_CHANNEL}\n                            modalId={ModalIdentifiers.DELETE_CHANNEL}\n                            dialogType={DeleteChannelModal}\n                            dialogProps={{\n                                channel,\n                                penultimateViewedChannelName,\n                            }}\n                            text={localizeMessage('channel_header.delete', 'Archive Channel')}\n                        />\n                    </ChannelPermissionGate>\n                </Menu.Group>\n                <Menu.Group>\n                    {pluginItems}\n                </Menu.Group>\n                <Menu.Group divider={divider}>\n                    {isMobile &&\n                        <MobileChannelHeaderPlug\n                            channel={channel}\n                            isDropdown={true}\n                        />}\n                    <MenuItemLeaveChannel\n                        id='channelLeaveChannel'\n                        channel={channel}\n                        isDefault={isDefault}\n                        isGuestUser={isGuest(user)}\n                    />\n                    <MenuItemCloseMessage\n                        id='channelCloseMessage'\n                        channel={channel}\n                        currentUser={user}\n                    />\n                    <MenuItemCloseChannel\n                        id='channelCloseChannel'\n                        isArchived={isArchived}\n                    />\n                </Menu.Group>\n\n                <Menu.Group divider={divider}>\n                    <ChannelPermissionGate\n                        channelId={channel.id}\n                        teamId={channel.team_id}\n                        permissions={[channelUnarchivePermission]}\n                    >\n                        <Menu.ItemToggleModalRedux\n                            id='channelUnarchiveChannel'\n                            show={isArchived && !isDefault && channel.type !== Constants.DM_CHANNEL && channel.type !== Constants.GM_CHANNEL}\n                            modalId={ModalIdentifiers.UNARCHIVE_CHANNEL}\n                            dialogType={UnarchiveChannelModal}\n                            dialogProps={{\n                                channel,\n                            }}\n                            text={localizeMessage('channel_header.unarchive', 'Unarchive Channel')}\n                        />\n                    </ChannelPermissionGate>\n                </Menu.Group>\n            </React.Fragment>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {CSSTransition} from 'react-transition-group';\n\nconst ANIMATION_DURATION = 350;\n\nexport default class MobileChannelHeaderDropdownAnimation extends React.PureComponent {\n    static propTypes = {\n        children: PropTypes.node,\n        show: PropTypes.bool.isRequired,\n    };\n\n    render() {\n        return (\n            <CSSTransition\n                in={this.props.show}\n                classNames='mobile-channel-header-dropdown'\n                enter={true}\n                exit={true}\n                mountOnEnter={true}\n                unmountOnExit={true}\n                timeout={{\n                    enter: ANIMATION_DURATION,\n                    exit: ANIMATION_DURATION,\n                }}\n            >\n                {this.props.children}\n            </CSSTransition>\n        );\n    }\n}\n\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {FormattedMessage} from 'react-intl';\n\nimport StatusIcon from 'components/status_icon';\n\nimport {Constants} from 'utils/constants';\n\nimport {ChannelHeaderDropdownItems} from 'components/channel_header_dropdown';\n\nimport Menu from 'components/widgets/menu/menu';\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\n\nimport MobileChannelHeaderDropdownAnimation from './mobile_channel_header_dropdown_animation.jsx';\n\nexport default class MobileChannelHeaderDropdown extends React.PureComponent {\n    static propTypes = {\n        user: PropTypes.object.isRequired,\n        channel: PropTypes.object.isRequired,\n        teammateId: PropTypes.string,\n        teammateIsBot: PropTypes.bool,\n        teammateStatus: PropTypes.string,\n        displayName: PropTypes.string.isRequired,\n    }\n\n    getChannelTitle = () => {\n        const {user, channel, teammateId, displayName} = this.props;\n\n        if (channel.type === Constants.DM_CHANNEL) {\n            if (user.id === teammateId) {\n                return (\n                    <FormattedMessage\n                        id='channel_header.directchannel.you'\n                        defaultMessage='{displayname} (you)'\n                        values={{displayname: displayName}}\n                    />\n                );\n            }\n            return displayName;\n        }\n        return channel.display_name;\n    }\n\n    render() {\n        const {teammateIsBot, teammateStatus} = this.props;\n        let dmHeaderIconStatus;\n\n        if (!teammateIsBot) {\n            dmHeaderIconStatus = (\n                <StatusIcon status={teammateStatus}/>\n            );\n        }\n\n        return (\n            <MenuWrapper animationComponent={MobileChannelHeaderDropdownAnimation}>\n                <a>\n                    <span className='heading'>\n                        {dmHeaderIconStatus}\n                        {this.getChannelTitle()}\n                    </span>\n                    <FormattedMessage\n                        id='generic_icons.dropdown'\n                        defaultMessage='Dropdown Icon'\n                    >\n                        {(title) => (\n                            <span\n                                className='fa fa-angle-down header-dropdown__icon'\n                                title={title}\n                            />\n                        )}\n                    </FormattedMessage>\n                </a>\n\n                <FormattedMessage\n                    id='channel_header.menuAriaLabel'\n                    defaultMessage='Channel Menu'\n                >\n                    {(ariaLabel) => (\n                        <Menu ariaLabel={ariaLabel}>\n                            <ChannelHeaderDropdownItems isMobile={true}/>\n                            <div className='Menu__close visible-xs-block'>\n                                {''}\n                            </div>\n                        </Menu>\n                    )}\n                </FormattedMessage>\n            </MenuWrapper>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {createSelector} from 'reselect';\nimport {\n    getUser,\n    getCurrentUser,\n    getUserStatuses,\n    getCurrentUserId,\n} from 'mattermost-redux/selectors/entities/users';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {\n    getCurrentChannel,\n    isCurrentChannelDefault,\n    isCurrentChannelFavorite,\n    isCurrentChannelMuted,\n    isCurrentChannelArchived,\n    isCurrentChannelReadOnly,\n    getRedirectChannelNameForTeam,\n} from 'mattermost-redux/selectors/entities/channels';\n\nimport {getPenultimateViewedChannelName} from 'selectors/local_storage';\n\nimport {Constants} from 'utils/constants';\nimport * as Utils from 'utils/utils';\n\nimport Desktop from './channel_header_dropdown';\nimport Items from './channel_header_dropdown_items';\nimport Mobile from './mobile_channel_header_dropdown';\n\nconst getTeammateId = createSelector(\n    getCurrentChannel,\n    getCurrentUserId,\n    (channel, currentUserId) => {\n        if (channel.type !== Constants.DM_CHANNEL) {\n            return null;\n        }\n\n        return Utils.getUserIdFromChannelId(channel.name, currentUserId);\n    },\n);\n\nconst getTeammateStatus = createSelector(\n    getUserStatuses,\n    getTeammateId,\n    (userStatuses, teammateId) => {\n        if (!teammateId) {\n            return null;\n        }\n\n        return userStatuses[teammateId];\n    }\n);\n\nconst mapStateToProps = (state) => ({\n    user: getCurrentUser(state),\n    channel: getCurrentChannel(state),\n    isDefault: isCurrentChannelDefault(state),\n    isFavorite: isCurrentChannelFavorite(state),\n    isMuted: isCurrentChannelMuted(state),\n    isReadonly: isCurrentChannelReadOnly(state),\n    isArchived: isCurrentChannelArchived(state),\n    penultimateViewedChannelName: getPenultimateViewedChannelName(state) || getRedirectChannelNameForTeam(state, getCurrentTeamId(state)),\n    pluginMenuItems: state.plugins.components.ChannelHeader || [],\n    isLicensedForLDAPGroups: state.entities.general.license.LDAPGroups === 'true',\n});\n\nconst mobileMapStateToProps = (state) => {\n    const user = getCurrentUser(state);\n    const channel = getCurrentChannel(state);\n    const teammateId = getTeammateId(state);\n\n    let teammateIsBot = false;\n    let displayName = '';\n    if (teammateId) {\n        const teammate = getUser(state, teammateId);\n        teammateIsBot = teammate && teammate.is_bot;\n        displayName = Utils.getDisplayNameByUser(state, teammate);\n    }\n\n    return {\n        user,\n        channel,\n        teammateId,\n        teammateIsBot,\n        teammateStatus: getTeammateStatus(state),\n        displayName,\n    };\n};\n\nexport const ChannelHeaderDropdown = Desktop;\nexport const ChannelHeaderDropdownItems = connect(mapStateToProps)(Items);\nexport const MobileChannelHeaderDropdown = connect(mobileMapStateToProps)(Mobile);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\n\ntype Props = {\n    mentionCount: number;\n    messageCount: number;\n}\n\nexport default class NotifyCounts extends React.PureComponent<Props> {\n    render() {\n        if (this.props.mentionCount) {\n            return <span className='badge badge-notify'>{this.props.mentionCount}</span>;\n        } else if (this.props.messageCount) {\n            return <span className='badge badge-notify'>{''}</span>;\n        }\n        return null;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getUnreadsInCurrentTeam} from 'mattermost-redux/selectors/entities/channels';\n\nimport {GlobalState} from 'types/store';\n\nimport NotifyCounts from './notify_counts';\n\nfunction mapStateToProps(state: GlobalState) {\n    const {mentionCount, messageCount} = getUnreadsInCurrentTeam(state);\n    return {\n        mentionCount,\n        messageCount,\n    };\n}\n\nexport default connect(mapStateToProps)(NotifyCounts);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {FormattedMessage} from 'react-intl';\n\nimport NotifyCounts from 'components/notify_counts';\nimport MenuIcon from 'components/widgets/icons/menu_icon';\n\nconst CollapseLhsButton = ({\n    actions: {\n        toggleLhs,\n    },\n}) => (\n    <button\n        key='navbar-toggle-sidebar'\n        type='button'\n        className='navbar-toggle'\n        data-toggle='collapse'\n        data-target='#sidebar-nav'\n        onClick={toggleLhs}\n    >\n        <span className='sr-only'>\n            <FormattedMessage\n                id='navbar.toggle2'\n                defaultMessage='Toggle sidebar'\n            />\n        </span>\n        <MenuIcon className='style--none icon icon__menu icon--sidebarHeaderTextColor'/>\n        <NotifyCounts/>\n    </button>\n);\n\nCollapseLhsButton.propTypes = {\n    actions: PropTypes.shape({\n        toggleLhs: PropTypes.func.isRequired,\n    }).isRequired,\n};\n\nexport default CollapseLhsButton;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\n\nimport {toggle as toggleLhs} from 'actions/views/lhs';\n\nimport CollapseLhsButton from './collapse_lhs_button';\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({\n        toggleLhs,\n    }, dispatch),\n});\n\nexport default connect(null, mapDispatchToProps)(CollapseLhsButton);\n\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport MenuIcon from 'components/widgets/icons/menu_icon';\n\nconst CollapseRhsButton = ({\n    actions: {\n        toggleRhsMenu,\n    },\n}) => (\n    <button\n        key='navbar-toggle-menu'\n        type='button'\n        className='navbar-toggle navbar-right__icon menu-toggle pull-right'\n        data-toggle='collapse'\n        data-target='#sidebar-nav'\n        onClick={toggleRhsMenu}\n    >\n        <MenuIcon/>\n    </button>\n);\n\nCollapseRhsButton.propTypes = {\n    actions: PropTypes.shape({\n        toggleRhsMenu: PropTypes.func.isRequired,\n    }).isRequired,\n};\n\nexport default CollapseRhsButton;\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\n\nimport {toggleMenu as toggleRhsMenu} from 'actions/views/rhs';\n\nimport CollapseRhsButton from './collapse_rhs_button';\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({\n        toggleRhsMenu,\n    }, dispatch),\n});\n\nexport default connect(null, mapDispatchToProps)(CollapseRhsButton);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class InfoIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.info'\n                    defaultMessage='Info Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='18px'\n                            height='18px'\n                            viewBox='0 0 22 22'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g\n                                stroke='none'\n                                strokeWidth='1'\n                                fill='inherit'\n                                fillRule='evenodd'\n                            >\n                                <g\n                                    transform='translate(-388.000000, -18.000000)'\n                                    fill='inherit'\n                                >\n                                    <g>\n                                        <g transform='translate(381.000000, 11.000000)'>\n                                            <g transform='translate(7.000000, 7.000000)'>\n                                                <path d='M11,22 C4.92486775,22 0,17.0751322 0,11 C0,4.92486775 4.92486775,0 11,0 C17.0751322,0 22,4.92486775 22,11 C22,17.0751322 17.0751322,22 11,22 Z M11,20.7924685 C16.408231,20.7924685 20.7924685,16.408231 20.7924685,11 C20.7924685,5.59176898 16.408231,1.20753149 11,1.20753149 C5.59176898,1.20753149 1.20753149,5.59176898 1.20753149,11 C1.20753149,16.408231 5.59176898,20.7924685 11,20.7924685 Z M10.1572266,16.0625 L10.1572266,8.69335938 L11.3466797,8.69335938 L11.3466797,16.0625 L10.1572266,16.0625 Z M10.7519531,7.50390625 C10.3417969,7.50390625 10,7.16210938 10,6.75195312 C10,6.33496094 10.3417969,6 10.7519531,6 C11.1689453,6 11.5039062,6.33496094 11.5039062,6.75195312 C11.5039062,7.16210938 11.1689453,7.50390625 10.7519531,7.50390625 Z'/>\n                                            </g>\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {ModalIdentifiers} from 'utils/constants';\nimport {localizeMessage} from 'utils/utils.jsx';\n\nimport EditChannelHeaderModal from 'components/edit_channel_header_modal';\nimport Markdown from 'components/markdown';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport InfoIcon from 'components/widgets/icons/info_icon';\nimport Popover from 'components/widgets/popover';\nconst headerMarkdownOptions = {mentionHighlight: false};\n\nexport default class NavbarInfoButton extends React.PureComponent {\n    static propTypes = {\n        channel: PropTypes.object.isRequired,\n        isReadOnly: PropTypes.bool.isRequired,\n        actions: PropTypes.shape({\n            openModal: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    showEditChannelHeaderModal = () => {\n        if (this.refs.headerOverlay) {\n            this.refs.headerOverlay.hide();\n        }\n\n        const {actions, channel} = this.props;\n        const modalData = {\n            modalId: ModalIdentifiers.EDIT_CHANNEL_HEADER,\n            dialogType: EditChannelHeaderModal,\n            dialogProps: {channel},\n        };\n\n        actions.openModal(modalData);\n    }\n\n    hide = () => {\n        if (this.refs.headerOverlay) {\n            this.refs.headerOverlay.hide();\n        }\n    }\n\n    render() {\n        const {channel, isReadOnly} = this.props;\n\n        let popoverContent = null;\n        if (channel.header) {\n            popoverContent = (\n                <Markdown\n                    message={channel.header}\n                    options={headerMarkdownOptions}\n                />\n            );\n        } else {\n            let addOne;\n            if (!isReadOnly) {\n                const link = (\n                    <a\n                        href='#'\n                        onClick={this.showEditChannelHeaderModal}\n                    >\n                        <FormattedMessage\n                            id='navbar.click'\n                            defaultMessage='Click here'\n                        />\n                    </a>\n                );\n                addOne = (\n                    <React.Fragment>\n                        <br/>\n                        <FormattedMessage\n                            id='navbar.clickToAddHeader'\n                            defaultMessage='{clickHere} to add one.'\n                            values={{clickHere: link}}\n                        />\n                    </React.Fragment>\n                );\n            }\n\n            popoverContent = (\n                <div>\n                    <FormattedMessage\n                        id='navbar.noHeader'\n                        defaultMessage='No channel header yet.'\n                    />\n                    {addOne}\n                </div>\n            );\n        }\n\n        const popover = (\n            <Popover\n                popoverStyle='info'\n                placement='bottom'\n                className='navbar__popover'\n                id='header-popover'\n            >\n                {popoverContent}\n                <div\n                    className='close visible-xs-block'\n                    onClick={this.hide}\n                >\n                    {''}\n                </div>\n            </Popover>\n        );\n\n        return (\n            <OverlayTrigger\n                ref='headerOverlay'\n                trigger='click'\n                placement='bottom'\n                overlay={popover}\n                className='description'\n                rootClose={true}\n            >\n                <button\n                    className='navbar-toggle navbar-right__icon navbar-info-button pull-right'\n                    aria-label={localizeMessage('accessibility.button.Info', 'Info')}\n                >\n                    <InfoIcon\n                        className='icon icon__info'\n                        aria-hidden='true'\n                    />\n                </button>\n            </OverlayTrigger>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {openModal} from 'actions/views/modals';\n\nimport ChannelInfoButton from './channel_info_button';\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            openModal,\n        }, dispatch),\n    };\n}\n\nexport default connect(null, mapDispatchToProps)(ChannelInfoButton);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {localizeMessage} from 'utils/utils.jsx';\n\nimport SearchIcon from 'components/widgets/icons/search_icon';\n\nexport default class ShowSearchButton extends React.PureComponent {\n    static propTypes = {\n        actions: PropTypes.shape({\n            openRHSSearch: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    handleClick = () => {\n        this.props.actions.openRHSSearch();\n    }\n\n    render() {\n        return (\n            <button\n                type='button'\n                className='navbar-toggle navbar-right__icon navbar-search pull-right'\n                onClick={this.handleClick}\n                aria-label={localizeMessage('accessibility.button.Search', 'Search')}\n            >\n                <SearchIcon\n                    className='icon icon__search'\n                    aria-hidden='true'\n                />\n            </button>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\n\nimport {openRHSSearch} from 'actions/views/rhs';\n\nimport ShowSearchButton from './show_search_button';\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({\n        openRHSSearch,\n    }, dispatch),\n});\n\nexport default connect(null, mapDispatchToProps)(ShowSearchButton);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {NotificationLevels} from 'utils/constants';\n\nexport default class UnmuteChannelButton extends React.PureComponent {\n    static propTypes = {\n        user: PropTypes.shape({\n            id: PropTypes.string.isRequired,\n        }).isRequired,\n\n        channel: PropTypes.shape({\n            id: PropTypes.string.isRequired,\n        }).isRequired,\n\n        actions: PropTypes.shape({\n            updateChannelNotifyProps: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    handleClick = () => {\n        const {\n            user,\n            channel,\n            actions: {\n                updateChannelNotifyProps,\n            },\n        } = this.props;\n\n        updateChannelNotifyProps(user.id, channel.id, {mark_unread: NotificationLevels.ALL});\n    }\n\n    render() {\n        return (\n            <button\n                type='button'\n                className='navbar-toggle icon icon__mute'\n                onClick={this.handleClick}\n            >\n                <span className='fa fa-bell-slash-o icon'/>\n            </button>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {updateChannelNotifyProps} from 'mattermost-redux/actions/channels';\n\nimport UnmuteChannelButton from './unmute_channel_button';\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({\n        updateChannelNotifyProps,\n    }, dispatch),\n});\n\nexport default connect(null, mapDispatchToProps)(UnmuteChannelButton);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {MobileChannelHeaderDropdown} from 'components/channel_header_dropdown';\nimport MobileChannelHeaderPlug from 'plugins/mobile_channel_header_plug';\n\nimport * as Utils from 'utils/utils';\n\nimport CollapseLhsButton from './collapse_lhs_button';\nimport CollapseRhsButton from './collapse_rhs_button';\nimport ChannelInfoButton from './channel_info_button';\nimport ShowSearchButton from './show_search_button';\nimport UnmuteChannelButton from './unmute_channel_button';\n\nexport default class ChannelHeaderMobile extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         *\n         */\n        user: PropTypes.object.isRequired,\n\n        /**\n         * Object with info about current channel\n         */\n        channel: PropTypes.object,\n\n        /**\n         * Bool whether the current channel is read only\n         */\n        isReadOnly: PropTypes.bool,\n\n        /**\n         * Bool whether the current channel is muted\n         */\n        isMuted: PropTypes.bool,\n\n        /**\n         * Object with action creators\n         */\n        actions: PropTypes.shape({\n            closeLhs: PropTypes.func.isRequired,\n            closeRhs: PropTypes.func.isRequired,\n            closeRhsMenu: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    componentDidMount() {\n        document.querySelector('.inner-wrap').addEventListener('click', this.hideSidebars);\n    }\n\n    componentWillUnmount() {\n        document.querySelector('.inner-wrap').removeEventListener('click', this.hideSidebars);\n    }\n\n    hideSidebars = (e) => {\n        if (Utils.isMobile()) {\n            this.props.actions.closeRhs();\n\n            if (e.target.className !== 'navbar-toggle' && e.target.className !== 'icon-bar') {\n                this.props.actions.closeLhs();\n                this.props.actions.closeRhsMenu();\n            }\n        }\n    }\n\n    render() {\n        const {user, channel, isMuted} = this.props;\n\n        return (\n            <nav\n                id='navbar'\n                className='navbar navbar-default navbar-fixed-top'\n                role='navigation'\n            >\n                <div className='container-fluid theme'>\n                    <div className='navbar-header'>\n                        <CollapseLhsButton/>\n                        {channel && (\n                            <React.Fragment>\n                                <div className='navbar-brand'>\n                                    <MobileChannelHeaderDropdown/>\n                                    {isMuted && (\n                                        <UnmuteChannelButton\n                                            user={user}\n                                            channel={channel}\n                                        />\n                                    )}\n                                </div>\n                                <ChannelInfoButton\n                                    ref='headerOverlay'\n                                    channel={channel}\n                                    isReadOnly={this.props.isReadOnly}\n                                />\n                                <ShowSearchButton/>\n                                <MobileChannelHeaderPlug\n                                    channel={channel}\n                                    isDropdown={false}\n                                />\n                            </React.Fragment>\n                        )}\n                        <CollapseRhsButton/>\n                    </div>\n                </div>\n            </nav>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {createSelector} from 'reselect';\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\nimport {\n    getCurrentChannel,\n    getMyCurrentChannelMembership,\n    isCurrentChannelReadOnly,\n} from 'mattermost-redux/selectors/entities/channels';\nimport {isChannelMuted} from 'mattermost-redux/utils/channel_utils';\n\nimport {\n    closeRightHandSide as closeRhs,\n    closeMenu as closeRhsMenu,\n} from 'actions/views/rhs';\nimport {close as closeLhs} from 'actions/views/lhs';\n\nimport ChannelHeaderMobile from './channel_header_mobile';\n\nconst isCurrentChannelMuted = createSelector(\n    getMyCurrentChannelMembership,\n    (membership) => isChannelMuted(membership),\n);\n\nconst mapStateToProps = (state) => ({\n    user: getCurrentUser(state),\n    channel: getCurrentChannel(state),\n    isMuted: isCurrentChannelMuted(state),\n    isReadOnly: isCurrentChannelReadOnly(state),\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({\n        closeLhs,\n        closeRhs,\n        closeRhsMenu,\n    }, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelHeaderMobile);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {joinChannel, getChannelByNameAndTeamName, markGroupChannelOpen, fetchMyChannelsAndMembers} from 'mattermost-redux/actions/channels';\nimport {getUser, getUserByUsername, getUserByEmail} from 'mattermost-redux/actions/users';\nimport {getTeamByName} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentUserId, getUserByUsername as selectUserByUsername, getUser as selectUser, getUserByEmail as selectUserByEmail} from 'mattermost-redux/selectors/entities/users';\nimport {getChannelByName, getOtherChannels, getChannel, getChannelsNameMapInTeam, getRedirectChannelNameForTeam} from 'mattermost-redux/selectors/entities/channels';\n\nimport {Constants} from 'utils/constants';\nimport {openDirectChannelToUserId} from 'actions/channel_actions';\nimport * as GlobalActions from 'actions/global_actions.jsx';\nimport * as Utils from 'utils/utils.jsx';\n\nconst LENGTH_OF_ID = 26;\nconst LENGTH_OF_GROUP_ID = 40;\nconst LENGTH_OF_USER_ID_PAIR = 54;\nconst USER_ID_PAIR_REGEXP = new RegExp(`^[a-zA-Z0-9]{${LENGTH_OF_ID}}__[a-zA-Z0-9]{${LENGTH_OF_ID}}$`);\n\nexport function onChannelByIdentifierEnter({match, history}) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const {path, identifier, team} = match.params;\n\n        if (!identifier) {\n            return;\n        }\n\n        const teamObj = getTeamByName(state, team);\n        if (!teamObj) {\n            return;\n        }\n\n        const channelPath = getPathFromIdentifier(state, path, identifier);\n\n        switch (channelPath) {\n        case 'channel_name':\n            dispatch(goToChannelByChannelName(match, history));\n            break;\n        case 'channel_id':\n            dispatch(goToChannelByChannelId(match, history));\n            break;\n        case 'group_channel_group_id':\n            dispatch(goToGroupChannelByGroupId(match, history));\n            break;\n        case 'direct_channel_username':\n            dispatch(goToDirectChannelByUsername(match, history));\n            break;\n        case 'direct_channel_email':\n            dispatch(goToDirectChannelByEmail(match, history));\n            break;\n        case 'direct_channel_user_ids':\n            dispatch(goToDirectChannelByUserIds(match, history));\n            break;\n        case 'direct_channel_user_id':\n            dispatch(goToDirectChannelByUserId(match, history, identifier));\n            break;\n        case 'error':\n            await dispatch(fetchMyChannelsAndMembers(teamObj.id));\n            handleError(match, history, getRedirectChannelNameForTeam(state, teamObj.id));\n            break;\n        }\n    };\n}\n\nexport function getPathFromIdentifier(state, path, identifier) {\n    if (path === 'channels') {\n        // It's hard to tell an ID apart from a channel name of the same length, so check first if\n        // the identifier matches a channel that we have\n        const channelsByName = getChannelByName(state, identifier);\n        const moreChannelsByName = getOtherChannels(state).find((chan) => chan.name === identifier);\n\n        if (identifier.length === LENGTH_OF_ID) {\n            return channelsByName || moreChannelsByName ? 'channel_name' : 'channel_id';\n        } else if (\n            (!channelsByName && !moreChannelsByName && identifier.length === LENGTH_OF_GROUP_ID) ||\n            (\n                (channelsByName && channelsByName.type === Constants.GM_CHANNEL) ||\n                (moreChannelsByName && moreChannelsByName.type === Constants.GM_CHANNEL)\n            )\n        ) {\n            return 'group_channel_group_id';\n        } else if (isDirectChannelIdentifier(identifier)) {\n            return 'direct_channel_user_ids';\n        }\n        return 'channel_name';\n    } else if (path === 'messages') {\n        if (identifier.indexOf('@') === 0) {\n            return 'direct_channel_username';\n        } else if (identifier.indexOf('@') > 0) {\n            return 'direct_channel_email';\n        } else if (identifier.length === LENGTH_OF_ID) {\n            return 'direct_channel_user_id';\n        } else if (identifier.length === LENGTH_OF_GROUP_ID) {\n            return 'group_channel_group_id';\n        }\n        return 'error';\n    }\n\n    return 'error';\n}\n\nexport function goToChannelByChannelId(match, history) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const {team, identifier} = match.params;\n        const channelId = identifier.toLowerCase();\n\n        let channel = getChannel(state, channelId);\n        const member = state.entities.channels.myMembers[channelId];\n        const teamObj = getTeamByName(state, team);\n        if (!channel || !member) {\n            const {data, error} = await dispatch(joinChannel(getCurrentUserId(state), teamObj.id, channelId, null));\n            if (error) {\n                await dispatch(fetchMyChannelsAndMembers(teamObj.id));\n                handleChannelJoinError(match, history, getRedirectChannelNameForTeam(state, teamObj.id));\n                return;\n            }\n            channel = data.channel;\n        }\n\n        if (channel.type === Constants.DM_CHANNEL) {\n            dispatch(goToDirectChannelByUserId(match, history, Utils.getUserIdFromChannelId(channel.name, getCurrentUserId(state))));\n        } else if (channel.type === Constants.GM_CHANNEL) {\n            history.replace(`/${team}/messages/${channel.name}`);\n        } else {\n            history.replace(`/${team}/channels/${channel.name}`);\n        }\n    };\n}\n\nexport function goToChannelByChannelName(match, history) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const {team, identifier} = match.params;\n        const channelName = identifier.toLowerCase();\n\n        const teamObj = getTeamByName(state, team);\n        if (!teamObj) {\n            return;\n        }\n\n        let channel = getChannelsNameMapInTeam(state, teamObj.id)[channelName];\n        let member;\n        if (channel) {\n            member = state.entities.channels.myMembers[channel.id];\n        }\n\n        if (!channel || !member) {\n            const {data, error: joinError} = await dispatch(joinChannel(getCurrentUserId(state), teamObj.id, null, channelName));\n            if (joinError) {\n                const {data: data2, error: getChannelError} = await dispatch(getChannelByNameAndTeamName(team, channelName, true));\n                if (getChannelError || data2.delete_at === 0) {\n                    await dispatch(fetchMyChannelsAndMembers(teamObj.id));\n                    handleChannelJoinError(match, history, getRedirectChannelNameForTeam(state, teamObj.id));\n                    return;\n                }\n                channel = data2;\n            } else {\n                channel = data.channel;\n            }\n        }\n\n        if (channel.type === Constants.DM_CHANNEL) {\n            dispatch(goToDirectChannelByUserIds(match, history));\n        } else if (channel.type === Constants.GM_CHANNEL) {\n            history.replace(`/${team}/messages/${channel.name}`);\n        } else {\n            doChannelChange(channel);\n        }\n    };\n}\n\nfunction goToDirectChannelByUsername(match, history) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const {team, identifier} = match.params;\n        const username = identifier.slice(1, identifier.length).toLowerCase();\n        const teamObj = getTeamByName(state, team);\n\n        let user = selectUserByUsername(state, username);\n        if (!user) {\n            const {data, error} = await dispatch(getUserByUsername(username));\n            if (error) {\n                await dispatch(fetchMyChannelsAndMembers(teamObj.id));\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj.id));\n                return;\n            }\n            user = data;\n        }\n\n        const {error, data} = await dispatch(openDirectChannelToUserId(user.id));\n        if (error) {\n            await dispatch(fetchMyChannelsAndMembers(teamObj.id));\n            handleError(match, history, getRedirectChannelNameForTeam(state, teamObj.id));\n            return;\n        }\n\n        doChannelChange(data);\n    };\n}\n\nexport function goToDirectChannelByUserId(match, history, userId) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const {team} = match.params;\n        const teamObj = getTeamByName(state, team);\n\n        let user = selectUser(state, userId);\n        if (!user) {\n            const {data, error} = await dispatch(getUser(userId));\n            if (error) {\n                await dispatch(fetchMyChannelsAndMembers(teamObj.id));\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj.id));\n                return;\n            }\n            user = data;\n        }\n\n        history.replace(`/${team}/messages/@${user.username}`);\n    };\n}\n\nexport function goToDirectChannelByUserIds(match, history) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const {team, identifier} = match.params;\n        const userId = Utils.getUserIdFromChannelId(identifier.toLowerCase(), getCurrentUserId(getState()));\n        const teamObj = getTeamByName(state, team);\n\n        let user = selectUser(state, userId);\n        if (!user) {\n            const {data, error} = await dispatch(getUser(userId));\n            if (error) {\n                await dispatch(fetchMyChannelsAndMembers(teamObj.id));\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj.id));\n                return;\n            }\n            user = data;\n        }\n\n        history.replace(`/${team}/messages/@${user.username}`);\n    };\n}\n\nexport function goToDirectChannelByEmail(match, history) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const {team, identifier} = match.params;\n        const email = identifier.toLowerCase();\n        const teamObj = getTeamByName(state, team);\n\n        let user = selectUserByEmail(state, email);\n        if (!user) {\n            const {data, error} = await dispatch(getUserByEmail(email));\n            if (error) {\n                await dispatch(fetchMyChannelsAndMembers(teamObj.id));\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj.id));\n                return;\n            }\n            user = data;\n        }\n\n        history.replace(`/${team}/messages/@${user.username}`);\n    };\n}\n\nfunction goToGroupChannelByGroupId(match, history) {\n    return async (dispatch, getState) => {\n        const state = getState();\n        const {identifier, team} = match.params;\n        const groupId = identifier.toLowerCase();\n\n        history.replace(match.url.replace('/channels/', '/messages/'));\n\n        let channel = getChannelByName(state, groupId);\n        const teamObj = getTeamByName(state, team);\n        if (!channel) {\n            const {data, error} = await dispatch(joinChannel(getCurrentUserId(state), teamObj.id, null, groupId));\n            if (error) {\n                await dispatch(fetchMyChannelsAndMembers(teamObj.id));\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj.id));\n                return;\n            }\n            channel = data.channel;\n        }\n\n        dispatch(markGroupChannelOpen(channel.id));\n\n        doChannelChange(channel);\n    };\n}\n\nfunction doChannelChange(channel) {\n    GlobalActions.emitChannelClickEvent(channel);\n}\n\nfunction handleError(match, history, defaultChannel) {\n    const {team} = match.params;\n    history.push(team ? `/${team}/channels/${defaultChannel}` : '/');\n}\n\nfunction isDirectChannelIdentifier(identifier) {\n    return identifier.length === LENGTH_OF_USER_ID_PAIR && USER_ID_PAIR_REGEXP.test(identifier);\n}\n\nasync function handleChannelJoinError(match, history, defaultChannel) {\n    const {team} = match.params;\n    history.push(team ? `/error?type=channel_not_found&returnTo=/${team}/channels/${defaultChannel}` : '/');\n}","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class MemberIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.member'\n                    defaultMessage='Member Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='14px'\n                            height='14px'\n                            viewBox='0 0 16 16'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g\n                                stroke='none'\n                                strokeWidth='1'\n                                fill='inherit'\n                                fillRule='evenodd'\n                            >\n                                <g\n                                    transform='translate(-725.000000, -32.000000)'\n                                    fillRule='nonzero'\n                                    fill='inherit'\n                                >\n                                    <g>\n                                        <g\n                                            transform='translate(676.000000, 22.000000)'\n                                        >\n                                            <path\n                                                d='M64.9481342,24 C64.6981342,20.955 63.2551342,19.076 60.6731342,18.354 C61.4831342,17.466 61.9881342,16.296 61.9881342,15 C61.9881342,12.238 59.7501342,10 56.9881342,10 C54.2261342,10 51.9881342,12.238 51.9881342,15 C51.9881342,16.297 52.4941342,17.467 53.3031342,18.354 C50.7221342,19.076 49.2771342,20.955 49.0271342,24 C49.0161342,24.146 49.0061342,24.577 49.0001342,25.001 C48.9911342,25.553 49.4361342,26 49.9881342,26 L63.9881342,26 C64.5411342,26 64.9851342,25.553 64.9761342,25.001 C64.9701342,24.577 64.9601342,24.146 64.9481342,24 Z M56.9881342,12 C58.6421342,12 59.9881342,13.346 59.9881342,15 C59.9881342,16.654 58.6421342,18 56.9881342,18 C55.3341342,18 53.9881342,16.654 53.9881342,15 C53.9881342,13.346 55.3341342,12 56.9881342,12 Z M51.0321342,24 C51.2981342,21.174 52.7911342,20 55.9881342,20 L57.9881342,20 C61.1851342,20 62.6781342,21.174 62.9441342,24 L51.0321342,24 Z'\n                                                id='User_4_x2C__Profile_5-Copy-9'\n                                            />\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {localizeMessage} from 'utils/utils.jsx';\n\nexport default class MessageIcon extends React.PureComponent {\n    render() {\n        return (\n            <button\n                {...this.props}\n                aria-label={localizeMessage('members_popover.button.message', 'message')}\n                className='style--none icon icon__message'\n                tabIndex='-1'\n            >\n                <FormattedMessage\n                    id='generic_icons.message'\n                    defaultMessage='Message Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='18px'\n                            height='16px'\n                            viewBox='0 0 18 16'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g\n                                stroke='none'\n                                strokeWidth='1'\n                                fill='inherit'\n                                fillRule='evenodd'\n                            >\n                                <g\n                                    transform='translate(-200.000000, -174.000000)'\n                                    fill='inherit'\n                                >\n                                    <g transform='translate(200.000000, 174.000000)'>\n                                        <path d='M7.2546625,1.42801356 C10.458475,1.42801356 12.999475,3.24528136 12.999475,5.52023729 C12.9895,8.04188475 10.6062625,9.89326102 7.40245,9.89326102 C7.40245,9.89326102 6.9134125,9.91229831 6.4115125,9.83747119 L5.82535,9.79622373 L5.15335,10.3586169 C4.997425,10.5397356 4.3199125,11.1095322 3.736375,11.4794373 C4.0915375,10.4598847 4.07605,10.1370441 4.07605,10.1370441 L4.1251375,9.49004068 L3.55315,9.19549153 C2.0986375,8.44616271 1.4444875,6.88616271 1.4444875,5.52023729 C1.4444875,3.24528136 4.05085,1.42801356 7.2546625,1.42801356 M7.2546625,0.370386441 C3.465475,0.370386441 0.3944875,2.65829831 0.3944875,5.52023729 C0.3944875,7.3028678 1.2623125,9.20342373 3.0751375,10.1370441 C3.0751375,10.1478847 3.07225,10.1560814 3.07225,10.1679797 C3.07225,10.9426915 2.43175,12.0048136 2.1794875,12.4429356 L2.1805375,12.4429356 C2.1605875,12.4902644 2.148775,12.5420881 2.148775,12.5973492 C2.148775,12.8141627 2.322025,12.9881424 2.5375375,12.9881424 C2.5693,12.9881424 2.6210125,12.9815322 2.6393875,12.9815322 C2.6446375,12.9815322 2.6467375,12.9815322 2.6462125,12.9831186 C3.986275,12.762339 5.9642125,11.2435864 6.2576875,10.8837288 C6.5585125,10.928678 6.761425,10.9358169 7.0136875,10.9358169 C7.120525,10.9358169 7.2347125,10.9342305 7.3696375,10.9342305 C11.1583,10.9342305 14.094625,8.75446102 14.049475,5.52023729 C14.049475,2.65829831 11.0435875,0.370386441 7.2546625,0.370386441'/>\n                                        <path d='M17.2055125,9.79172881 C17.2055125,8.35811525 16.6498,7.26532203 15.2624875,6.4451322 C15.228625,6.82614237 15.120475,7.23517966 15.0031375,7.59477288 C15.8998375,8.21903729 16.1555125,8.85995932 16.1555125,9.79172881 C16.1555125,10.9323797 15.62815,11.7597085 14.40175,12.3919051 L13.879375,12.653139 C13.879375,12.653139 13.9337125,14.0082237 14.0140375,14.3511593 C12.9895,13.5946915 12.6374875,12.9630237 12.6374875,12.9630237 L12.08545,13.0486915 C11.86705,13.0809492 11.276425,13.0812136 11.276425,13.0812136 C9.85,13.0812136 8.7929125,12.7388068 7.8909625,12.0278169 C8.135875,12.0124814 6.42805,12.0132746 6.3899875,12.0468542 C7.4326375,13.3297559 9.1373125,14.1388407 11.276425,14.1388407 C11.3927125,14.1388407 11.49115,14.1398983 11.58355,14.1398983 C11.801425,14.1398983 11.9773,14.1338169 12.237175,14.095478 C12.491275,14.4058915 13.914025,15.7728746 15.0724375,15.9629831 C15.0719125,15.9619254 15.073225,15.9619254 15.078475,15.9619254 C15.0939625,15.9619254 15.13885,15.967478 15.16615,15.967478 C15.3522625,15.967478 15.5024125,15.8167661 15.5024125,15.6293017 C15.5024125,15.5817085 15.49165,15.5367593 15.47485,15.4960407 L15.4759,15.4960407 C15.258025,15.117939 14.9159875,14.0129831 14.9159875,13.3435051 C14.9159875,13.3331932 14.9128375,13.3260542 14.9128375,13.3168 C16.4797,12.5095661 17.2055125,11.3321627 17.2055125,9.79172881'/>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </button>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport {Client4} from 'mattermost-redux/client';\n\nimport ProfilePicture from 'components/profile_picture';\nimport MessageIcon from 'components/widgets/icons/message_icon';\nimport {UserStatuses} from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\nimport BotBadge from 'components/widgets/badges/bot_badge';\nimport GuestBadge from 'components/widgets/badges/guest_badge';\n\nexport default class PopoverListMembersItem extends React.PureComponent {\n    static propTypes = {\n        showMessageIcon: PropTypes.bool.isRequired,\n        onItemClick: PropTypes.func.isRequired,\n        status: PropTypes.string.isRequired,\n        user: PropTypes.object.isRequired,\n        displayName: PropTypes.string.isRequired,\n    };\n\n    static defaultProps = {\n        status: UserStatuses.OFFLINE,\n    };\n\n    handleClick = () => {\n        this.props.onItemClick(this.props.user);\n    };\n\n    render() {\n        if (!this.props.user) {\n            return null;\n        }\n\n        if (!this.props.displayName) {\n            return null;\n        }\n\n        let messageIcon;\n        if (this.props.showMessageIcon) {\n            messageIcon = (\n                <MessageIcon aria-hidden='true'/>\n            );\n        }\n\n        const botClass = this.props.user.is_bot ? ' more-modal__row--bot' : '';\n\n        const status = this.props.user.is_bot ? null : this.props.status;\n\n        return (\n            <div\n                data-testid='popoverListMembersItem'\n                tabIndex='0'\n                aria-label={this.props.displayName.toLowerCase()}\n                className={'more-modal__row' + botClass}\n                onClick={this.handleClick}\n            >\n                <ProfilePicture\n                    src={Client4.getProfilePictureUrl(this.props.user.id, this.props.user.last_picture_update)}\n                    status={status}\n                    size='md'\n                />\n                <div className='more-modal__details d-flex whitespace--nowrap'>\n                    <div className='more-modal__name'>\n                        {this.props.displayName}\n                    </div>\n                    <BotBadge\n                        show={Boolean(this.props.user.is_bot)}\n                        className='badge-popoverlist'\n                    />\n                    <GuestBadge\n                        show={Utils.isGuest(this.props.user)}\n                        className='badge-popoverlist'\n                    />\n                </div>\n                <div className='more-modal__actions'>\n                    {messageIcon}\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\nimport {connect} from 'react-redux';\n\nimport {getDisplayNameByUser} from 'utils/utils.jsx';\n\nimport PopoverListMembersItem from './popover_list_members_item.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    return {\n        displayName: getDisplayNameByUser(state, ownProps.user),\n    };\n}\n\nexport default connect(mapStateToProps)(PopoverListMembersItem);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Overlay, Tooltip} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\nimport {browserHistory} from 'utils/browser_history';\nimport {Constants} from 'utils/constants';\nimport * as Utils from 'utils/utils.jsx';\nimport ChannelInviteModal from 'components/channel_invite_modal';\nimport ChannelMembersModal from 'components/channel_members_modal';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport MemberIcon from 'components/widgets/icons/member_icon';\nimport Popover from 'components/widgets/popover';\nimport TeamMembersModal from 'components/team_members_modal';\n\nimport PopoverListMembersItem from 'components/popover_list_members/popover_list_members_item';\n\nexport default class PopoverListMembers extends React.Component {\n    static propTypes = {\n        channel: PropTypes.object.isRequired,\n        statuses: PropTypes.object.isRequired,\n        users: PropTypes.array.isRequired,\n        memberCount: PropTypes.number,\n        currentUserId: PropTypes.string.isRequired,\n        teamUrl: PropTypes.string,\n        manageMembers: PropTypes.bool.isRequired,\n        actions: PropTypes.shape({\n            openModal: PropTypes.func.isRequired,\n            loadProfilesAndStatusesInChannel: PropTypes.func.isRequired,\n            openDirectChannelToUserId: PropTypes.func.isRequired,\n        }).isRequired,\n        sortedUsers: PropTypes.array,\n    };\n\n    constructor(props) {\n        super(props);\n        this.membersList = React.createRef();\n\n        this.state = {\n            showPopover: false,\n            showTeamMembersModal: false,\n            showChannelMembersModal: false,\n            showChannelInviteModal: false,\n            users: props.users,\n            statuses: props.statuses,\n        };\n    }\n\n    static getDerivedStateFromProps(nextProps, prevState) {\n        if (nextProps.users !== prevState.users || nextProps.statuses !== prevState.statuses) {\n            return {\n                users: nextProps.users,\n                statuses: nextProps.statuses,\n            };\n        }\n        return null;\n    }\n\n    handleShowDirectChannel = (user) => {\n        const {actions} = this.props;\n        const teammateId = user.id;\n\n        if (teammateId) {\n            actions.openDirectChannelToUserId(teammateId).then(({data}) => {\n                if (data) {\n                    browserHistory.push(this.props.teamUrl + '/channels/' + data.name);\n                }\n                this.closePopover();\n            });\n        }\n    };\n\n    closePopover = () => {\n        this.setState({showPopover: false});\n    };\n\n    showMembersModal = (e) => {\n        e.preventDefault();\n\n        this.setState({\n            showPopover: false,\n            showChannelMembersModal: true,\n        });\n    };\n\n    hideChannelMembersModal = () => {\n        this.setState({showChannelMembersModal: false});\n    };\n\n    showChannelInviteModal = () => {\n        this.setState({showChannelInviteModal: true});\n    };\n\n    hideChannelInviteModal = () => {\n        this.setState({showChannelInviteModal: false});\n    };\n\n    hideTeamMembersModal = () => {\n        this.setState({showTeamMembersModal: false});\n    };\n\n    handleGetProfilesInChannel = (e) => {\n        this.setState({popoverTarget: e.target, showPopover: !this.state.showPopover});\n        this.props.actions.loadProfilesAndStatusesInChannel(this.props.channel.id, 0, undefined, 'status'); // eslint-disable-line no-undefined\n    };\n\n    getTargetPopover = () => {\n        this.membersList.current.focus();\n        return this.state.popoverTarget;\n    };\n\n    render() {\n        const isDirectChannel = this.props.channel.type === Constants.DM_CHANNEL;\n\n        const items = this.props.sortedUsers.map((user) => (\n            <PopoverListMembersItem\n                key={user.id}\n                onItemClick={this.handleShowDirectChannel}\n                showMessageIcon={this.props.currentUserId !== user.id && !isDirectChannel}\n                status={this.props.statuses[user.id]}\n                user={user}\n            />\n        ));\n\n        const channelIsArchived = this.props.channel.delete_at !== 0;\n        let popoverButton;\n        if (this.props.channel.type !== Constants.GM_CHANNEL && !channelIsArchived) {\n            let membersName = (\n                <FormattedMessage\n                    id='members_popover.manageMembers'\n                    defaultMessage='Manage Members'\n                />\n            );\n\n            const isDefaultChannel = this.props.channel.name === Constants.DEFAULT_CHANNEL;\n\n            if (isDefaultChannel || !this.props.manageMembers) {\n                membersName = (\n                    <FormattedMessage\n                        id='members_popover.viewMembers'\n                        defaultMessage='View Members'\n                    />\n                );\n            }\n\n            popoverButton = (\n                <div\n                    className='more-modal__button'\n                    key={'popover-member-more'}\n                >\n                    <button\n                        className='btn btn-link'\n                        data-testid='membersModal'\n                        onClick={this.showMembersModal}\n                    >\n                        {membersName}\n                    </button>\n                </div>\n            );\n        }\n\n        const count = this.props.memberCount;\n        let countText = '-';\n        if (count > 0) {\n            countText = count.toString();\n        }\n\n        const title = (\n            <FormattedMessage\n                id='members_popover.title'\n                defaultMessage='Channel Members'\n            />\n        );\n\n        let channelMembersModal;\n        if (this.state.showChannelMembersModal) {\n            channelMembersModal = (\n                <ChannelMembersModal\n                    onHide={this.hideChannelMembersModal}\n                    showInviteModal={this.showChannelInviteModal}\n                    channel={this.props.channel}\n                />\n            );\n        }\n\n        let teamMembersModal;\n        if (this.state.showTeamMembersModal) {\n            teamMembersModal = (\n                <TeamMembersModal\n                    onHide={this.hideTeamMembersModal}\n                />\n            );\n        }\n\n        let channelInviteModal;\n        if (this.state.showChannelInviteModal) {\n            channelInviteModal = (\n                <ChannelInviteModal\n                    onHide={this.hideChannelInviteModal}\n                    channel={this.props.channel}\n                />\n            );\n        }\n\n        const channelMembersTooltip = (\n            <Tooltip id='channelMembersTooltip'>\n                <FormattedMessage\n                    id='channel_header.channelMembers'\n                    defaultMessage='Members'\n                />\n            </Tooltip>\n        );\n\n        const ariaLabel = `${Utils.localizeMessage('channel_header.channelMembers', 'Members')}`.toLowerCase();\n\n        return (\n            <div id='channelMember'>\n                <button\n                    id='member_popover'\n                    aria-label={ariaLabel}\n                    className={'style--none member-popover__trigger channel-header__icon wide ' + (this.state.showPopover ? 'active' : '')}\n                    ref='member_popover_target'\n                    onClick={this.handleGetProfilesInChannel}\n                >\n                    <OverlayTrigger\n                        delayShow={Constants.OVERLAY_TIME_DELAY}\n                        placement='bottom'\n                        overlay={this.state.showPopover ? <></> : channelMembersTooltip}\n                    >\n                        <div>\n                            <span\n                                id='channelMemberCountText'\n                                className='icon__text'\n                            >\n                                {countText}\n                            </span>\n                            <MemberIcon\n                                id='channelMemberIcon'\n                                className='icon icon__members'\n                                aria-hidden='true'\n                            />\n                        </div>\n                    </OverlayTrigger>\n                </button>\n                <Overlay\n                    rootClose={true}\n                    onHide={this.closePopover}\n                    show={this.state.showPopover}\n                    target={this.getTargetPopover}\n                    placement='bottom'\n                >\n                    <Popover\n                        className='member-list__popover'\n                        id='member-list-popover'\n                    >\n                        <div\n                            className='more-modal__header'\n                        >\n                            {title}\n                            {this.props.channel.group_constrained && <div className='subhead'>\n                                <FormattedMessage\n                                    id='channel_header.groupConstrained'\n                                    defaultMessage='Members managed by linked groups.'\n                                />\n                            </div>}\n                        </div>\n                        <div className='more-modal__body'>\n                            <div\n                                tabIndex='-1'\n                                role='presentation'\n                                ref={this.membersList}\n                                className='more-modal__list'\n                            >\n                                {items}\n                            </div>\n                        </div>\n                        {popoverButton}\n                    </Popover>\n                </Overlay>\n                {channelMembersModal}\n                {teamMembersModal}\n                {channelInviteModal}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {createSelector} from 'reselect';\nimport {bindActionCreators} from 'redux';\nimport {getAllChannelStats} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentRelativeTeamUrl} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentUserId, getUserStatuses, makeGetProfilesInChannel} from 'mattermost-redux/selectors/entities/users';\nimport {getTeammateNameDisplaySetting} from 'mattermost-redux/selectors/entities/preferences';\n\nimport {openDirectChannelToUserId} from 'actions/channel_actions.jsx';\nimport {loadProfilesAndStatusesInChannel} from 'actions/user_actions.jsx';\nimport {openModal} from 'actions/views/modals';\nimport {canManageMembers} from 'utils/channel_utils.jsx';\nimport {sortUsersByStatusAndDisplayName} from 'utils/utils.jsx';\n\nimport PopoverListMembers from './popover_list_members.jsx';\n\nconst makeSortUsersByStatusAndDisplayName = (doGetProfilesInChannel) => {\n    return createSelector(\n        (state, channelId) => doGetProfilesInChannel(state, channelId, true),\n        getUserStatuses,\n        getTeammateNameDisplaySetting,\n        (users, statuses, teammateNameDisplay) => sortUsersByStatusAndDisplayName(users, statuses, teammateNameDisplay)\n    );\n};\n\nfunction makeMapStateToProps() {\n    const doGetProfilesInChannel = makeGetProfilesInChannel();\n    const doSortUsersByStatusAndDisplayName = makeSortUsersByStatusAndDisplayName(doGetProfilesInChannel);\n\n    return function mapStateToProps(state, ownProps) {\n        const stats = getAllChannelStats(state)[ownProps.channel.id] || {};\n        const users = doGetProfilesInChannel(state, ownProps.channel.id, true);\n        const statuses = getUserStatuses(state);\n\n        return {\n            currentUserId: getCurrentUserId(state),\n            memberCount: stats.member_count,\n            users,\n            statuses,\n            teamUrl: getCurrentRelativeTeamUrl(state),\n            manageMembers: canManageMembers(state, ownProps.channel),\n            sortedUsers: doSortUsersByStatusAndDisplayName(state, ownProps.channel.id),\n        };\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            openModal,\n            loadProfilesAndStatusesInChannel,\n            openDirectChannelToUserId,\n        }, dispatch),\n    };\n}\n\nexport default connect(makeMapStateToProps, mapDispatchToProps)(PopoverListMembers);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class PinIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.pin'\n                    defaultMessage='Pin Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='14px'\n                            height='14px'\n                            viewBox='0 0 16 16'\n                            version='1.1'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <g\n                                stroke='inherit'\n                                strokeWidth='1'\n                                fill='inherit'\n                                fillRule='evenodd'\n                            >\n                                <g\n                                    transform='translate(-775.000000, -32.000000)'\n                                    fillRule='nonzero'\n                                    fill='inherit'\n                                >\n                                    <g>\n                                        <g transform='translate(764.000000, 22.000000)'>\n                                            <g transform='translate(10.000000, 10.000000)'>\n                                                <path d='M16.456,7.291 L9.483,0.25 C9.31,0.078 9.178,0 9.08,0 C8.896,0 8.831,0.276 8.831,0.732 L8.831,3.044 L5.831,5.96 L2.578,6.268 C1.887,6.405 1.668,6.917 2.167,7.41 L4.781,10.011 L3.83,10.961 L1.05,15.511 C0.93,15.761 1.03,15.862 1.28,15.74 L5.83,12.961 L6.786,12.005 L9.359,14.565 C9.556,14.76 9.754,14.854 9.929,14.854 C10.197,14.854 10.413,14.634 10.497,14.219 L10.83,10.961 L13.746,7.961 L16.082,7.961 C16.788,7.961 16.955,7.785 16.456,7.291 Z M12.312,6.567 L9.396,9.567 L8.911,10.065 L8.84,10.757 L8.797,11.184 L5.589,7.992 L6.018,7.952 L6.72,7.886 L7.225,7.396 L10.225,4.48 L10.547,4.167 L12.616,6.256 L12.312,6.567 Z'/>\n                                            </g>\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class PluginChannelHeaderIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.plugins'\n                    defaultMessage='Plugins'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            width='14px'\n                            height='14px'\n                            viewBox='0 0 16 16'\n                            version='1.1'\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path\n                                fillRule='evenodd'\n                                d='M10.2500542,0.707106781 C10.6987855,0.707106781 11.0625542,1.07087542 11.0625542,1.51960678 L11.0615542,3.50610678 L12.8042208,3.50710678 C13.4301435,3.50710678 13.9375542,4.0145174 13.9375542,4.64044011 C13.9375542,5.26636283 13.4301435,5.77377345 12.8042208,5.77377345 L12.8125542,5.77377345 L12.8125542,8.97377345 L12.8125542,8.97377345 C12.8125542,11.2921636 10.8653399,13.2156919 8.31338929,13.5787961 L8.31255416,15.8946068 C8.31255416,16.3433381 7.94878552,16.7071068 7.50005416,16.7071068 C7.0513228,16.7071068 6.68755416,16.3433381 6.68755416,15.8946068 L6.68783265,13.5954057 C4.14942691,13.2878302 2.17885387,11.4410225 2.06752014,9.17620376 L2.06255416,8.97377345 L2.06255416,8.97377345 L2.06255416,5.77377345 L2.07088749,5.77377345 C1.44496478,5.77377345 0.937554159,5.26636283 0.937554159,4.64044011 C0.937554159,4.0145174 1.44496478,3.50710678 2.07088749,3.50710678 L3.81155416,3.50610678 L3.81255416,1.51960678 C3.81255416,1.07087542 4.1763228,0.707106781 4.62505416,0.707106781 C5.07378552,0.707106781 5.43755416,1.07087542 5.43755416,1.51960678 L5.43655416,3.50610678 L9.43655416,3.50610678 L9.43755416,1.51960678 C9.43755416,1.07087542 9.8013228,0.707106781 10.2500542,0.707106781 Z M11,6 L4,6 L4,9.3 L4.07019791,9.30071649 C4.39483943,10.5555917 5.80705165,11.5 7.5,11.5 C9.19294835,11.5 10.6051606,10.5555917 10.9298021,9.30071649 L10.9298021,9.30071649 L11,9.3 L11,6 Z'\n                                transform='rotate(45 7.707 6.793)'\n                            />\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\n/* eslint-disable react/no-multi-comp */\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Dropdown, Tooltip} from 'react-bootstrap';\nimport {RootCloseWrapper} from 'react-overlays';\nimport {FormattedMessage} from 'react-intl';\n\nimport HeaderIconWrapper from 'components/channel_header/components/header_icon_wrapper';\nimport PluginChannelHeaderIcon from '../../components/widgets/icons/plugin_channel_header_icon';\nimport {Constants} from 'utils/constants';\nimport OverlayTrigger from 'components/overlay_trigger';\n\nclass CustomMenu extends React.PureComponent {\n    static propTypes = {\n        open: PropTypes.bool,\n        children: PropTypes.node,\n        onClose: PropTypes.func.isRequired,\n        rootCloseEvent: PropTypes.oneOf(['click', 'mousedown']),\n    }\n\n    handleRootClose = () => {\n        this.props.onClose();\n    }\n\n    render() {\n        const {\n            open,\n            rootCloseEvent,\n            children,\n        } = this.props;\n\n        return (\n            <RootCloseWrapper\n                disabled={!open}\n                onRootClose={this.handleRootClose}\n                event={rootCloseEvent}\n            >\n                <ul\n                    role='menu'\n                    className='dropdown-menu channel-header_plugin-dropdown'\n                >\n                    {children}\n                </ul>\n            </RootCloseWrapper>\n        );\n    }\n}\n\nclass CustomToggle extends React.PureComponent {\n    static propTypes = {\n        children: PropTypes.element,\n        dropdownOpen: PropTypes.bool,\n        onClick: PropTypes.func,\n    }\n\n    handleClick = (e) => {\n        this.props.onClick(e);\n    }\n\n    render() {\n        const {children} = this.props;\n\n        let activeClass = '';\n        if (this.props.dropdownOpen) {\n            activeClass = ' active';\n        }\n\n        return (\n            <button\n                id='pluginChannelHeaderButtonDropdown'\n                className={'wide channel-header__icon style--none' + activeClass}\n                type='button'\n                onClick={this.handleClick}\n            >\n                {children}\n            </button>\n        );\n    }\n}\n\nexport default class ChannelHeaderPlug extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * Components or actions to add as channel header buttons\n         */\n        components: PropTypes.array,\n\n        channel: PropTypes.object.isRequired,\n        channelMember: PropTypes.object.isRequired,\n\n        /*\n         * Logged in user's theme\n         */\n        theme: PropTypes.object.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            dropdownOpen: false,\n        };\n    }\n\n    toggleDropdown = (dropdownOpen) => {\n        this.setState({dropdownOpen});\n    }\n\n    onClose = () => {\n        this.toggleDropdown(false);\n    }\n\n    fireActionAndClose = (action) => {\n        action(this.props.channel, this.props.channelMember);\n        this.onClose();\n    }\n\n    createButton = (plug) => {\n        return (\n            <HeaderIconWrapper\n                buttonClass='channel-header__icon style--none'\n                iconComponent={plug.icon}\n                onClick={() => plug.action(this.props.channel, this.props.channelMember)}\n                buttonId={plug.id}\n                tooltipKey={'plugin'}\n                tooltipText={plug.tooltipText ? plug.tooltipText : plug.dropdownText}\n            />\n        );\n    }\n\n    createDropdown = (plugs) => {\n        const items = plugs.map((plug) => {\n            return (\n                <li\n                    key={'channelHeaderPlug' + plug.id}\n                >\n                    <a\n                        href='#'\n                        className='d-flex align-items-center'\n                        onClick={() => this.fireActionAndClose(plug.action)}\n                    >\n                        <span className='d-flex align-items-center overflow--ellipsis'>{plug.icon}</span>\n                        <span>{plug.dropdownText}</span>\n                    </a>\n                </li>\n            );\n        });\n\n        return (\n            <div className='flex-child'>\n                <Dropdown\n                    id='channelHeaderPlugDropdown'\n                    onToggle={this.toggleDropdown}\n                    onSelect={this.onSelect}\n                    open={this.state.dropdownOpen}\n                >\n                    <CustomToggle\n                        dropdownOpen={this.state.dropdownOpen}\n                        bsRole='toggle'\n                    >\n                        <OverlayTrigger\n                            delayShow={Constants.OVERLAY_TIME_DELAY}\n                            placement='bottom'\n                            overlay={this.state.dropdownOpen ? <></> : (\n                                <Tooltip id='removeIcon'>\n                                    <div aria-hidden={true}>\n                                        <FormattedMessage\n                                            id='generic_icons.plugins'\n                                            defaultMessage='Plugins'\n                                        />\n                                    </div>\n                                </Tooltip>\n                            )}\n                        >\n                            <div>\n                                <span\n                                    id='pluginCount'\n                                    className='icon__text'\n                                >\n                                    {plugs.length}\n                                </span>\n                                <PluginChannelHeaderIcon\n                                    id='pluginChannelHeaderIcon'\n                                    className='icon icon__pluginChannelHeader'\n                                    aria-hidden='true'\n                                />\n                            </div>\n                        </OverlayTrigger>\n                    </CustomToggle>\n                    <CustomMenu\n                        bsRole='menu'\n                        open={this.state.dropdownOpen}\n                        onClose={this.onClose}\n                    >\n                        {items}\n                    </CustomMenu>\n                </Dropdown>\n            </div>\n        );\n    }\n\n    render() {\n        const components = this.props.components || [];\n\n        if (components.length === 0) {\n            return null;\n        } else if (components.length === 1) {\n            return this.createButton(components[0]);\n        }\n\n        return this.createDropdown(components);\n    }\n}\n\n/* eslint-enable react/no-multi-comp */\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getTheme} from 'mattermost-redux/selectors/entities/preferences';\n\nimport ChannelHeaderPlug from './channel_header_plug.jsx';\n\nfunction mapStateToProps(state) {\n    return {\n        components: state.plugins.components.ChannelHeaderButton,\n        theme: getTheme(state),\n    };\n}\n\nexport default connect(mapStateToProps)(ChannelHeaderPlug);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {Tooltip, Overlay} from 'react-bootstrap';\nimport {FormattedMessage, injectIntl} from 'react-intl';\nimport classNames from 'classnames';\n\nimport {Permissions} from 'mattermost-redux/constants';\nimport {memoizeResult} from 'mattermost-redux/utils/helpers';\nimport {displayUsername} from 'mattermost-redux/utils/user_utils';\n\nimport 'bootstrap';\n\nimport EditChannelHeaderModal from 'components/edit_channel_header_modal';\nimport Markdown from 'components/markdown';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport PopoverListMembers from 'components/popover_list_members';\nimport SearchBar from 'components/search_bar';\nimport StatusIcon from 'components/status_icon';\nimport FlagIcon from 'components/widgets/icons/flag_icon';\nimport MentionsIcon from 'components/widgets/icons/mentions_icon';\nimport PinIcon from 'components/widgets/icons/pin_icon';\nimport SearchIcon from 'components/widgets/icons/search_icon';\nimport ArchiveIcon from 'components/widgets/icons/archive_icon';\nimport ChannelPermissionGate from 'components/permissions_gates/channel_permission_gate';\nimport QuickSwitchModal from 'components/quick_switch_modal';\nimport {ChannelHeaderDropdown} from 'components/channel_header_dropdown';\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\nimport GuestBadge from 'components/widgets/badges/guest_badge';\nimport BotBadge from 'components/widgets/badges/bot_badge';\nimport Popover from 'components/widgets/popover';\nimport {\n    Constants,\n    ModalIdentifiers,\n    NotificationLevels,\n    RHSStates,\n} from 'utils/constants';\nimport {intlShape} from 'utils/react_intl';\nimport * as Utils from 'utils/utils';\n\nimport ChannelHeaderPlug from 'plugins/channel_header_plug';\n\nimport HeaderIconWrapper from './components/header_icon_wrapper';\n\nconst headerMarkdownOptions = {singleline: true, mentionHighlight: false, atMentions: true};\nconst popoverMarkdownOptions = {singleline: false, mentionHighlight: false, atMentions: true};\n\nconst SEARCH_BAR_MINIMUM_WINDOW_SIZE = 1140;\n\nclass ChannelHeader extends React.PureComponent {\n    static propTypes = {\n        teamId: PropTypes.string.isRequired,\n        currentUser: PropTypes.object.isRequired,\n        channel: PropTypes.object,\n        channelMember: PropTypes.object,\n        dmUser: PropTypes.object,\n        gmMembers: PropTypes.array,\n        isFavorite: PropTypes.bool,\n        isReadOnly: PropTypes.bool,\n        isMuted: PropTypes.bool,\n        hasGuests: PropTypes.bool,\n        rhsState: PropTypes.oneOf(\n            Object.values(RHSStates),\n        ),\n        rhsOpen: PropTypes.bool,\n        isQuickSwitcherOpen: PropTypes.bool,\n        intl: intlShape.isRequired,\n        hasMoreThanOneTeam: PropTypes.bool,\n        actions: PropTypes.shape({\n            favoriteChannel: PropTypes.func.isRequired,\n            unfavoriteChannel: PropTypes.func.isRequired,\n            showFlaggedPosts: PropTypes.func.isRequired,\n            showPinnedPosts: PropTypes.func.isRequired,\n            showMentions: PropTypes.func.isRequired,\n            openRHSSearch: PropTypes.func.isRequired,\n            closeRightHandSide: PropTypes.func.isRequired,\n            getCustomEmojisInText: PropTypes.func.isRequired,\n            updateChannelNotifyProps: PropTypes.func.isRequired,\n            goToLastViewedChannel: PropTypes.func.isRequired,\n            openModal: PropTypes.func.isRequired,\n            closeModal: PropTypes.func.isRequired,\n        }).isRequired,\n        teammateNameDisplaySetting: PropTypes.string.isRequired,\n        currentRelativeTeamUrl: PropTypes.string.isRequired,\n        newSideBarPreference: PropTypes.bool,\n        announcementBarCount: PropTypes.number,\n    };\n\n    constructor(props) {\n        super(props);\n        this.toggleFavoriteRef = React.createRef();\n        this.headerDescriptionRef = React.createRef();\n        this.headerPopoverTextMeasurerRef = React.createRef();\n\n        this.state = {showSearchBar: ChannelHeader.getShowSearchBar(props), popoverOverlayWidth: 0, showChannelHeaderPopover: false, leftOffset: 0, topOffset: 0};\n\n        this.getHeaderMarkdownOptions = memoizeResult((channelNamesMap) => (\n            {...headerMarkdownOptions, channelNamesMap}\n        ));\n        this.getPopoverMarkdownOptions = memoizeResult((channelNamesMap) => (\n            {...popoverMarkdownOptions, channelNamesMap}\n        ));\n    }\n\n    componentDidMount() {\n        this.props.actions.getCustomEmojisInText(this.props.channel ? this.props.channel.header : '');\n        document.addEventListener('keydown', this.handleShortcut);\n        document.addEventListener('keydown', this.handleQuickSwitchKeyPress);\n        window.addEventListener('resize', this.handleResize);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleShortcut);\n        document.removeEventListener('keydown', this.handleQuickSwitchKeyPress);\n        window.removeEventListener('resize', this.handleResize);\n    }\n\n    componentDidUpdate(prevProps) {\n        const header = this.props.channel ? this.props.channel.header : '';\n        const prevHeader = prevProps.channel ? prevProps.channel.header : '';\n        if (header !== prevHeader) {\n            this.props.actions.getCustomEmojisInText(header);\n        }\n    }\n\n    static getDerivedStateFromProps(nextProps) {\n        return {showSearchBar: ChannelHeader.getShowSearchBar(nextProps)};\n    }\n\n    static getShowSearchBar(props) {\n        return (Utils.windowWidth() > SEARCH_BAR_MINIMUM_WINDOW_SIZE) || props.rhsOpen;\n    }\n\n    handleResize = () => {\n        this.setState({showSearchBar: ChannelHeader.getShowSearchBar(this.props)});\n    };\n\n    handleClose = () => {\n        this.props.actions.goToLastViewedChannel();\n    };\n\n    toggleFavorite = (e) => {\n        e.stopPropagation();\n        if (this.props.isFavorite) {\n            this.props.actions.unfavoriteChannel(this.props.channel.id);\n        } else {\n            this.props.actions.favoriteChannel(this.props.channel.id);\n        }\n    };\n\n    unmute = () => {\n        const {actions, channel, channelMember, currentUser} = this.props;\n\n        if (!channelMember || !currentUser || !channel) {\n            return;\n        }\n\n        const options = {mark_unread: NotificationLevels.ALL};\n        actions.updateChannelNotifyProps(currentUser.id, channel.id, options);\n    };\n\n    mute = () => {\n        const {actions, channel, channelMember, currentUser} = this.props;\n\n        if (!channelMember || !currentUser || !channel) {\n            return;\n        }\n\n        const options = {mark_unread: NotificationLevels.MENTION};\n        actions.updateChannelNotifyProps(currentUser.id, channel.id, options);\n    };\n\n    searchMentions = (e) => {\n        e.preventDefault();\n        if (this.props.rhsState === RHSStates.MENTION) {\n            this.props.actions.closeRightHandSide();\n        } else {\n            this.props.actions.showMentions();\n        }\n    };\n\n    showPinnedPosts = (e) => {\n        e.preventDefault();\n        if (this.props.rhsState === RHSStates.PIN) {\n            this.props.actions.closeRightHandSide();\n        } else {\n            this.props.actions.showPinnedPosts();\n        }\n    };\n\n    getFlagged = (e) => {\n        e.preventDefault();\n        if (this.props.rhsState === RHSStates.FLAG) {\n            this.props.actions.closeRightHandSide();\n        } else {\n            this.props.actions.showFlaggedPosts();\n        }\n    };\n\n    searchButtonClick = (e) => {\n        e.preventDefault();\n\n        this.props.actions.openRHSSearch();\n    };\n\n    handleShortcut = (e) => {\n        if (Utils.cmdOrCtrlPressed(e) && e.shiftKey) {\n            if (Utils.isKeyPressed(e, Constants.KeyCodes.M)) {\n                e.preventDefault();\n                this.props.actions.closeModal(ModalIdentifiers.QUICK_SWITCH);\n                this.searchMentions(e);\n            }\n            if (Utils.isKeyPressed(e, Constants.KeyCodes.L)) {\n                // just close the modal if it's open, but let someone else handle the shortcut\n                this.props.actions.closeModal(ModalIdentifiers.QUICK_SWITCH);\n            }\n        }\n    };\n\n    handleQuickSwitchKeyPress = (e) => {\n        if (Utils.cmdOrCtrlPressed(e) && !e.shiftKey && Utils.isKeyPressed(e, Constants.KeyCodes.K)) {\n            if (!e.altKey) {\n                e.preventDefault();\n                this.toggleQuickSwitchModal();\n            }\n        }\n    }\n\n    toggleQuickSwitchModal = () => {\n        const {isQuickSwitcherOpen} = this.props;\n        if (isQuickSwitcherOpen) {\n            this.props.actions.closeModal(ModalIdentifiers.QUICK_SWITCH);\n        } else {\n            this.props.actions.openModal({\n                modalId: ModalIdentifiers.QUICK_SWITCH,\n                dialogType: QuickSwitchModal,\n            });\n        }\n    }\n\n    removeTooltipLink = () => {\n        // Bootstrap adds the attr dynamically, removing it to prevent a11y readout\n        this.toggleFavoriteRef.current.removeAttribute('aria-describedby');\n    }\n\n    showEditChannelHeaderModal = () => {\n        if (this.refs.headerOverlay) {\n            this.refs.headerOverlay.hide();\n        }\n\n        const {actions, channel} = this.props;\n        const modalData = {\n            modalId: ModalIdentifiers.EDIT_CHANNEL_HEADER,\n            dialogType: EditChannelHeaderModal,\n            dialogProps: {channel},\n        };\n\n        actions.openModal(modalData);\n    }\n\n    showChannelHeaderPopover = (headerText) => {\n        const headerDescriptionRect = this.headerDescriptionRef.current.getBoundingClientRect();\n        const headerPopoverTextMeasurerRect = this.headerPopoverTextMeasurerRef.current.getBoundingClientRect();\n        const announcementBarSize = 32;\n        if (headerPopoverTextMeasurerRect.width > headerDescriptionRect.width || headerText.match(/\\n{2,}/g)) {\n            this.setState({showChannelHeaderPopover: true, leftOffset: this.headerDescriptionRef.current.offsetLeft});\n        }\n\n        this.setState({topOffset: (announcementBarSize * this.props.announcementBarCount)});\n    }\n\n    setPopoverOverlayWidth = () => {\n        const headerDescriptionRect = this.headerDescriptionRef.current.getBoundingClientRect();\n        const ellipsisWidthAdjustment = 10;\n        this.setState({popoverOverlayWidth: headerDescriptionRect.width + ellipsisWidthAdjustment});\n    }\n\n    handleFormattedTextClick = (e) => Utils.handleFormattedTextClick(e, this.props.currentRelativeTeamUrl);\n\n    render() {\n        const {\n            teamId,\n            currentUser,\n            gmMembers,\n            channel,\n            channelMember,\n            isMuted: channelMuted,\n            isReadOnly,\n            isFavorite,\n            dmUser,\n            rhsState,\n            hasGuests,\n            teammateNameDisplaySetting,\n            newSideBarPreference,\n        } = this.props;\n        const {formatMessage} = this.props.intl;\n        const ariaLabelChannelHeader = Utils.localizeMessage('accessibility.sections.channelHeader', 'channel header region');\n\n        let hasGuestsText = '';\n        if (hasGuests) {\n            hasGuestsText = (\n                <span className='has-guest-header'>\n                    <FormattedMessage\n                        id='channel_header.channelHasGuests'\n                        defaultMessage='This channel has guests'\n                    />\n                </span>\n            );\n        }\n\n        const channelIsArchived = channel.delete_at !== 0;\n        if (Utils.isEmptyObject(channel) ||\n            Utils.isEmptyObject(channelMember) ||\n            Utils.isEmptyObject(currentUser) ||\n            (!dmUser && channel.type === Constants.DM_CHANNEL)\n        ) {\n            // Use an empty div to make sure the header's height stays constant\n            return (\n                <div className='channel-header'/>\n            );\n        }\n\n        const channelNamesMap = channel.props && channel.props.channel_mentions;\n\n        let channelTitle = channel.display_name;\n        let archivedIcon = null;\n        if (channelIsArchived) {\n            archivedIcon = (<ArchiveIcon className='icon icon__archive icon channel-header-archived-icon svg-text-color'/>);\n        }\n        const isDirect = (channel.type === Constants.DM_CHANNEL);\n        const isGroup = (channel.type === Constants.GM_CHANNEL);\n        const isPrivate = (channel.type === Constants.PRIVATE_CHANNEL);\n\n        if (isDirect) {\n            const teammateId = dmUser.id;\n            if (currentUser.id === teammateId) {\n                channelTitle = (\n                    <FormattedMessage\n                        id='channel_header.directchannel.you'\n                        defaultMessage='{displayname} (you) '\n                        values={{\n                            displayname: displayUsername(dmUser, teammateNameDisplaySetting),\n                        }}\n                    />\n                );\n            } else {\n                channelTitle = displayUsername(dmUser, teammateNameDisplaySetting) + ' ';\n            }\n            channelTitle = (\n                <React.Fragment>\n                    {channelTitle}\n                    <GuestBadge show={Utils.isGuest(dmUser)}/>\n                </React.Fragment>\n            );\n        }\n\n        if (isGroup) {\n            // map the displayname to the gm member users\n            const membersMap = {};\n            for (const user of gmMembers) {\n                if (user.id === currentUser.id) {\n                    continue;\n                }\n                const userDisplayName = displayUsername(user.id, this.props.teammateNameDisplaySetting);\n\n                if (!membersMap[userDisplayName]) {\n                    membersMap[userDisplayName] = []; //Create an array for cases with same display name\n                }\n\n                membersMap[userDisplayName].push(user);\n            }\n\n            const displayNames = channel.display_name.split('');\n\n            channelTitle = displayNames.map((displayName, index) => {\n                if (!membersMap[displayName]) {\n                    return displayName;\n                }\n\n                const user = membersMap[displayName].shift();\n\n                return (\n                    <React.Fragment key={user.id}>\n                        {index > 0 && ', '}\n                        {displayName}\n                        <GuestBadge show={Utils.isGuest(user)}/>\n                    </React.Fragment>\n                );\n            });\n\n            if (hasGuests) {\n                hasGuestsText = (\n                    <span className='has-guest-header'>\n                        <FormattedMessage\n                            id='channel_header.groupMessageHasGuests'\n                            defaultMessage='This group message has guests'\n                        />\n                    </span>\n                );\n            }\n        }\n\n        let popoverListMembers;\n        if (!isDirect) {\n            popoverListMembers = (\n                <PopoverListMembers\n                    channel={channel}\n                />\n            );\n        }\n\n        let dmHeaderIconStatus;\n        let dmHeaderTextStatus;\n        if (isDirect && !dmUser.delete_at && !dmUser.is_bot) {\n            dmHeaderIconStatus = (\n                <StatusIcon\n                    type='avatar'\n                    status={channel.status}\n                />\n            );\n\n            dmHeaderTextStatus = (\n                <span className='header-status__text'>\n                    <FormattedMessage\n                        id={`status_dropdown.set_${channel.status}`}\n                        defaultMessage={Utils.toTitleCase(channel.status)}\n                    />\n                </span>\n            );\n        }\n\n        let headerTextContainer;\n        const headerText = (isDirect && dmUser.is_bot) ? dmUser.bot_description : channel.header;\n        if (headerText) {\n            const popoverContent = (\n                <Popover\n                    id='header-popover'\n                    popoverStyle='info'\n                    popoverSize='lg'\n                    style={{maxWidth: `${this.state.popoverOverlayWidth}px`, transform: `translate(${this.state.leftOffset}px, ${this.state.topOffset}px)`}}\n                    placement='bottom'\n                    className={classNames(['channel-header__popover',\n                        {'chanel-header__popover--lhs_offset': this.props.hasMoreThanOneTeam,\n                            'chanel-header__popover--new_sidebar': newSideBarPreference}])}\n                >\n                    <span\n                        onClick={this.handleFormattedTextClick}\n                    >\n                        <Markdown\n                            message={headerText}\n                            options={this.getPopoverMarkdownOptions(channelNamesMap)}\n                        />\n                    </span>\n                </Popover>\n            );\n\n            headerTextContainer = (\n                <div\n                    id='channelHeaderDescription'\n                    className='channel-header__description'\n                >\n                    {dmHeaderIconStatus}\n                    {dmHeaderTextStatus}\n                    {hasGuestsText}\n                    <div\n                        className='header-popover-text-measurer'\n                        ref={this.headerPopoverTextMeasurerRef}\n                    >\n                        <Markdown\n                            message={headerText.replace(/\\n+/g, ' ')}\n                            options={this.getHeaderMarkdownOptions(channelNamesMap)}\n                        /></div>\n                    <span\n                        className='header-description__text'\n                        onClick={this.handleFormattedTextClick}\n                        onMouseOver={() => this.showChannelHeaderPopover(headerText)}\n                        onMouseOut={() => this.setState({showChannelHeaderPopover: false})}\n                        ref={this.headerDescriptionRef}\n                    >\n\n                        <Overlay\n                            show={this.state.showChannelHeaderPopover}\n                            placement='bottom'\n                            rootClose={true}\n                            target={this.headerDescriptionRef.current}\n                            ref='headerOverlay'\n                            onEnter={this.setPopoverOverlayWidth}\n                            onHide={() => this.setState({showChannelHeaderPopover: false})}\n                        >{popoverContent}</Overlay>\n\n                        <Markdown\n                            message={headerText}\n                            options={this.getHeaderMarkdownOptions(channelNamesMap)}\n                        />\n                    </span>\n                </div>\n            );\n        } else {\n            let editMessage;\n            if (!isReadOnly && !channelIsArchived) {\n                if (isDirect || isGroup) {\n                    if (!isDirect || !dmUser.is_bot) {\n                        editMessage = (\n                            <button\n                                className='style--none'\n                                onClick={this.showEditChannelHeaderModal}\n                            >\n                                <FormattedMessage\n                                    id='channel_header.addChannelHeader'\n                                    defaultMessage='Add a channel description'\n                                />\n                                <FormattedMessage\n                                    id='channel_header.editLink'\n                                    defaultMessage='(Edit)'\n                                >\n                                    {(message) => <span className='button__edit ml-1'>{message}</span>}\n                                </FormattedMessage>\n                            </button>\n                        );\n                    }\n                } else {\n                    editMessage = (\n                        <ChannelPermissionGate\n                            channelId={channel.id}\n                            teamId={teamId}\n                            permissions={[isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES : Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES]}\n                        >\n                            <button\n                                className='style--none'\n                                onClick={this.showEditChannelHeaderModal}\n                            >\n                                <FormattedMessage\n                                    id='channel_header.addChannelHeader'\n                                    defaultMessage='Add a channel description'\n                                />\n                                <FormattedMessage\n                                    id='channel_header.editLink'\n                                    defaultMessage='(Edit)'\n                                >\n                                    {(message) => <span className='button__edit ml-1'>{message}</span>}\n                                </FormattedMessage>\n                            </button>\n                        </ChannelPermissionGate>\n                    );\n                }\n            }\n            headerTextContainer = (\n                <div\n                    id='channelHeaderDescription'\n                    className='channel-header__description light'\n                >\n                    {dmHeaderIconStatus}\n                    {dmHeaderTextStatus}\n                    {hasGuestsText}\n                    {editMessage}\n                </div>\n            );\n        }\n\n        let toggleFavoriteTooltip;\n        let toggleFavorite = null;\n        let ariaLabel = '';\n\n        if (!channelIsArchived) {\n            if (isFavorite) {\n                toggleFavoriteTooltip = (\n                    <Tooltip id='favoriteTooltip'>\n                        <FormattedMessage\n                            id='channelHeader.removeFromFavorites'\n                            defaultMessage='Remove from Favorites'\n                        />\n                    </Tooltip>\n                );\n                ariaLabel = formatMessage({id: 'channelHeader.removeFromFavorites', defaultMessage: 'Remove from Favorites'}).toLowerCase();\n            } else {\n                toggleFavoriteTooltip = (\n                    <Tooltip id='favoriteTooltip'>\n                        <FormattedMessage\n                            id='channelHeader.addToFavorites'\n                            defaultMessage='Add to Favorites'\n                        />\n                    </Tooltip>\n                );\n                ariaLabel = formatMessage({id: 'channelHeader.addToFavorites', defaultMessage: 'Add to Favorites'}).toLowerCase();\n            }\n\n            toggleFavorite = (\n                <OverlayTrigger\n                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                    placement='bottom'\n                    overlay={toggleFavoriteTooltip}\n                    onEntering={this.removeTooltipLink}\n                >\n                    <button\n                        id='toggleFavorite'\n                        ref={this.toggleFavoriteRef}\n                        onClick={this.toggleFavorite}\n                        className={'style--none color--link channel-header__favorites ' + (this.props.isFavorite ? 'active' : 'inactive')}\n                        aria-label={ariaLabel}\n                    >\n                        <i className={'icon fa ' + (this.props.isFavorite ? 'fa-star' : 'fa-star-o')}/>\n                    </button>\n                </OverlayTrigger>\n            );\n        }\n\n        const channelMutedTooltip = (\n            <Tooltip id='channelMutedTooltip'>\n                <FormattedMessage\n                    id='channelHeader.unmute'\n                    defaultMessage='Unmute'\n                />\n            </Tooltip>\n        );\n\n        let muteTrigger;\n        if (channelMuted) {\n            muteTrigger = (\n                <OverlayTrigger\n                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                    placement='bottom'\n                    overlay={channelMutedTooltip}\n                >\n                    <button\n                        id='toggleMute'\n                        onClick={this.unmute}\n                        className={'style--none color--link channel-header__mute inactive'}\n                        aria-label={formatMessage({id: 'generic_icons.muted', defaultMessage: 'Muted Icon'})}\n                    >\n                        <i className={'icon fa fa-bell-slash-o'}/>\n                    </button>\n                </OverlayTrigger>\n            );\n        }\n\n        let pinnedIconClass = 'channel-header__icon';\n        if (rhsState === RHSStates.PIN) {\n            pinnedIconClass += ' active';\n        }\n\n        let mentionsIconClass = 'channel-header__icon';\n        if (rhsState === RHSStates.MENTION) {\n            mentionsIconClass += ' active';\n        }\n\n        let flaggedIconClass = 'channel-header__icon';\n        if (rhsState === RHSStates.FLAG) {\n            flaggedIconClass += ' active';\n        }\n\n        let title = (\n            <React.Fragment>\n                {toggleFavorite}\n                <MenuWrapper>\n                    <div\n                        id='channelHeaderDropdownButton'\n                        className='channel-header__top'\n                    >\n                        <button\n                            className='channel-header__trigger style--none'\n                            aria-label={formatMessage({id: 'channel_header.menuAriaLabel', defaultMessage: 'Channel Menu'}).toLowerCase()}\n                        >\n                            <strong\n                                role='heading'\n                                aria-level='2'\n                                id='channelHeaderTitle'\n                                className='heading'\n                            >\n                                <span>\n                                    {archivedIcon}\n                                    {channelTitle}\n                                </span>\n                            </strong>\n                            <span\n                                id='channelHeaderDropdownIcon'\n                                className='fa fa-angle-down header-dropdown__icon'\n                                aria-label={formatMessage({id: 'generic_icons.dropdown', defaultMessage: 'Dropdown Icon'}).toLowerCase()}\n                            />\n                        </button>\n                    </div>\n                    <ChannelHeaderDropdown/>\n                </MenuWrapper>\n            </React.Fragment>\n        );\n        if (isDirect && dmUser.is_bot) {\n            title = (\n                <div\n                    id='channelHeaderDropdownButton'\n                    className='channel-header__top'\n                >\n                    {toggleFavorite}\n                    <strong\n                        role='heading'\n                        aria-level='2'\n                        id='channelHeaderTitle'\n                        className='heading'\n                    >\n                        <span>\n                            {archivedIcon}\n                            {channelTitle}\n                        </span>\n                    </strong>\n                    <BotBadge className='badge-popoverlist'/>\n                </div>\n            );\n        }\n\n        return (\n            <div\n                id='channel-header'\n                aria-label={ariaLabelChannelHeader}\n                role='banner'\n                tabIndex='-1'\n                data-channelid={`${channel.id}`}\n                className='channel-header alt a11y__region'\n                data-a11y-sort-order='8'\n            >\n                <div className='flex-parent'>\n                    <div className='flex-child'>\n                        <div\n                            id='channelHeaderInfo'\n                            className='channel-header__info'\n                        >\n                            <div\n                                className='channel-header__title dropdown'\n                            >\n                                <div>\n                                    {title}\n                                </div>\n                                {muteTrigger}\n                            </div>\n                            {headerTextContainer}\n                        </div>\n                    </div>\n                    <div className='flex-child'>\n                        {popoverListMembers}\n                    </div>\n                    <ChannelHeaderPlug\n                        channel={channel}\n                        channelMember={channelMember}\n                    />\n                    <HeaderIconWrapper\n                        iconComponent={\n                            <PinIcon\n                                className='icon icon__pin'\n                                aria-hidden='true'\n                            />\n                        }\n                        ariaLabel={true}\n                        buttonClass={'style--none ' + pinnedIconClass}\n                        buttonId={'channelHeaderPinButton'}\n                        onClick={this.showPinnedPosts}\n                        tooltipKey={'pinnedPosts'}\n                    />\n                    {this.state.showSearchBar ? (\n                        <div\n                            id='searchbarContainer'\n                            className='flex-child search-bar__container'\n                        >\n                            <SearchBar\n                                showMentionFlagBtns={false}\n                                isFocus={Utils.isMobile() || (this.props.rhsOpen && Boolean(this.props.rhsState))}\n                            />\n                        </div>\n                    ) : (\n                        <HeaderIconWrapper\n                            iconComponent={\n                                <SearchIcon\n                                    className='icon icon__search icon--stroke'\n                                    aria-hidden='true'\n                                />\n                            }\n                            ariaLabel={true}\n                            buttonId={'channelHeaderSearchButton'}\n                            onClick={this.searchButtonClick}\n                            tooltipKey={'search'}\n                        />\n                    )}\n                    <HeaderIconWrapper\n                        iconComponent={\n                            <MentionsIcon\n                                className='icon icon__mentions'\n                                aria-hidden='true'\n                            />\n                        }\n                        ariaLabel={true}\n                        buttonClass={'style--none ' + mentionsIconClass}\n                        buttonId={'channelHeaderMentionButton'}\n                        onClick={this.searchMentions}\n                        tooltipKey={'recentMentions'}\n                    />\n                    <HeaderIconWrapper\n                        iconComponent={\n                            <FlagIcon className='icon icon__flag'/>\n                        }\n                        ariaLabel={true}\n                        buttonClass={'style--none ' + flaggedIconClass}\n                        buttonId={'channelHeaderFlagButton'}\n                        onClick={this.getFlagged}\n                        tooltipKey={'flaggedPosts'}\n                    />\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default injectIntl(ChannelHeader);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {withRouter} from 'react-router-dom';\nimport {\n    favoriteChannel,\n    unfavoriteChannel,\n    updateChannelNotifyProps,\n} from 'mattermost-redux/actions/channels';\nimport {getCustomEmojisInText} from 'mattermost-redux/actions/emojis';\nimport {General} from 'mattermost-redux/constants';\nimport {\n    getCurrentChannel,\n    getMyCurrentChannelMembership,\n    isCurrentChannelFavorite,\n    isCurrentChannelMuted,\n    isCurrentChannelReadOnly,\n    getCurrentChannelStats,\n} from 'mattermost-redux/selectors/entities/channels';\nimport {getTeammateNameDisplaySetting, getNewSidebarPreference} from 'mattermost-redux/selectors/entities/preferences';\nimport {getCurrentRelativeTeamUrl, getCurrentTeamId, getMyTeams} from 'mattermost-redux/selectors/entities/teams';\nimport {\n    getCurrentUser,\n    getUser,\n    makeGetProfilesInChannel,\n} from 'mattermost-redux/selectors/entities/users';\nimport {getUserIdFromChannelName} from 'mattermost-redux/utils/channel_utils';\n\nimport {goToLastViewedChannel} from 'actions/views/channel';\nimport {openModal, closeModal} from 'actions/views/modals';\nimport {\n    showFlaggedPosts,\n    showPinnedPosts,\n    showMentions,\n    openRHSSearch,\n    closeRightHandSide,\n} from 'actions/views/rhs';\nimport {getIsRhsOpen, getRhsState} from 'selectors/rhs';\nimport {isModalOpen} from 'selectors/views/modals';\nimport {getAnnouncementBarCount} from 'selectors/views/announcement_bar';\nimport {ModalIdentifiers} from 'utils/constants';\n\nimport ChannelHeader from './channel_header';\n\nfunction makeMapStateToProps() {\n    const doGetProfilesInChannel = makeGetProfilesInChannel();\n\n    return function mapStateToProps(state) {\n        const channel = getCurrentChannel(state) || {};\n        const user = getCurrentUser(state);\n        const teams = getMyTeams(state);\n        const hasMoreThanOneTeam = teams.length > 1;\n\n        let dmUser;\n        let gmMembers;\n        if (channel && channel.type === General.DM_CHANNEL) {\n            const dmUserId = getUserIdFromChannelName(user.id, channel.name);\n            dmUser = getUser(state, dmUserId);\n        } else if (channel && channel.type === General.GM_CHANNEL) {\n            gmMembers = doGetProfilesInChannel(state, channel.id, false);\n        }\n        const stats = getCurrentChannelStats(state) || {member_count: 0, guest_count: 0};\n\n        return {\n            teamId: getCurrentTeamId(state),\n            channel,\n            channelMember: getMyCurrentChannelMembership(state),\n            currentUser: user,\n            dmUser,\n            gmMembers,\n            rhsState: getRhsState(state),\n            rhsOpen: getIsRhsOpen(state),\n            isFavorite: isCurrentChannelFavorite(state),\n            isReadOnly: isCurrentChannelReadOnly(state),\n            isMuted: isCurrentChannelMuted(state),\n            isQuickSwitcherOpen: isModalOpen(state, ModalIdentifiers.QUICK_SWITCH),\n            hasGuests: stats.guest_count > 0,\n            hasMoreThanOneTeam,\n            teammateNameDisplaySetting: getTeammateNameDisplaySetting(state),\n            currentRelativeTeamUrl: getCurrentRelativeTeamUrl(state),\n            newSideBarPreference: getNewSidebarPreference(state),\n            announcementBarCount: getAnnouncementBarCount(state)\n        };\n    };\n}\n\nconst mapDispatchToProps = (dispatch) => ({\n    actions: bindActionCreators({\n        favoriteChannel,\n        unfavoriteChannel,\n        showFlaggedPosts,\n        showPinnedPosts,\n        showMentions,\n        openRHSSearch,\n        closeRightHandSide,\n        getCustomEmojisInText,\n        updateChannelNotifyProps,\n        goToLastViewedChannel,\n        openModal,\n        closeModal,\n    }, dispatch),\n});\n\nexport default withRouter(connect(makeMapStateToProps, mapDispatchToProps)(ChannelHeader));\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage, injectIntl} from 'react-intl';\n\nimport {Posts} from 'mattermost-redux/constants';\nimport {sortFileInfos} from 'mattermost-redux/utils/file_utils';\n\nimport * as GlobalActions from 'actions/global_actions.jsx';\nimport Constants, {StoragePrefixes, ModalIdentifiers, Locations, A11yClassNames} from 'utils/constants';\nimport {t} from 'utils/i18n';\nimport {\n    containsAtChannel,\n    postMessageOnKeyPress,\n    shouldFocusMainTextbox,\n    isErrorInvalidSlashCommand,\n    splitMessageBasedOnCaretPosition,\n} from 'utils/post_utils.jsx';\nimport {getTable, getPlainText, formatMarkdownTableMessage, isGitHubCodeBlock} from 'utils/paste';\nimport {intlShape} from 'utils/react_intl';\nimport * as UserAgent from 'utils/user_agent';\nimport * as Utils from 'utils/utils.jsx';\n\nimport ConfirmModal from 'components/confirm_modal';\nimport EditChannelHeaderModal from 'components/edit_channel_header_modal';\nimport EditChannelPurposeModal from 'components/edit_channel_purpose_modal';\nimport EmojiPickerOverlay from 'components/emoji_picker/emoji_picker_overlay.jsx';\nimport FilePreview from 'components/file_preview';\nimport FileUpload from 'components/file_upload';\nimport LocalizedIcon from 'components/localized_icon';\nimport MsgTyping from 'components/msg_typing';\nimport PostDeletedModal from 'components/post_deleted_modal';\nimport ResetStatusModal from 'components/reset_status_modal';\nimport EmojiIcon from 'components/widgets/icons/emoji_icon';\nimport Textbox from 'components/textbox';\nimport TextboxLinks from 'components/textbox/textbox_links';\nimport TutorialTip from 'components/tutorial/tutorial_tip';\n\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message.jsx';\nimport MessageSubmitError from 'components/message_submit_error';\n\nconst KeyCodes = Constants.KeyCodes;\n\n// Temporary fix for IE-11, see MM-13423\nfunction trimRight(str) {\n    if (String.prototype.trimRight) {\n        return str.trimRight();\n    }\n\n    return str.replace(/\\s*$/, '');\n}\n\nclass CreatePost extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         *  ref passed from channelView for EmojiPickerOverlay\n         */\n        getChannelView: PropTypes.func,\n\n        /**\n         *  Data used in notifying user for @all and @channel\n         */\n        currentChannelMembersCount: PropTypes.number,\n\n        /**\n         *  Data used in multiple places of the component\n         */\n        currentChannel: PropTypes.object,\n\n        /**\n         *  Data used in executing commands for channel actions passed down to client4 function\n         */\n        currentTeamId: PropTypes.string,\n\n        /**\n         *  Data used for posting message\n         */\n        currentUserId: PropTypes.string,\n\n        /**\n         * Force message submission on CTRL/CMD + ENTER\n         */\n        codeBlockOnCtrlEnter: PropTypes.bool,\n\n        /**\n         *  Flag used for handling submit\n         */\n        ctrlSend: PropTypes.bool,\n\n        /**\n         *  Flag used for adding a class center to Postbox based on user pref\n         */\n        fullWidthTextBox: PropTypes.bool,\n\n        /**\n         *  Data used for deciding if tutorial tip is to be shown\n         */\n        showTutorialTip: PropTypes.bool.isRequired,\n\n        /**\n         *  Data used populating message state when triggered by shortcuts\n         */\n        messageInHistoryItem: PropTypes.string,\n\n        /**\n         *  Data used for populating message state from previous draft\n         */\n        draft: PropTypes.shape({\n            message: PropTypes.string.isRequired,\n            uploadsInProgress: PropTypes.array.isRequired,\n            fileInfos: PropTypes.array.isRequired,\n        }).isRequired,\n\n        /**\n         *  Data used dispatching handleViewAction\n         */\n        commentCountForPost: PropTypes.number,\n\n        /**\n         *  Data used dispatching handleViewAction ex: edit post\n         */\n        latestReplyablePostId: PropTypes.string,\n        locale: PropTypes.string.isRequired,\n\n        /**\n         *  Data used for calling edit of post\n         */\n        currentUsersLatestPost: PropTypes.object,\n\n        /**\n         *  Set if the channel is read only.\n         */\n        readOnlyChannel: PropTypes.bool,\n\n        /**\n         * Whether or not file upload is allowed.\n         */\n        canUploadFiles: PropTypes.bool.isRequired,\n\n        /**\n         * Whether to show the emoji picker.\n         */\n        enableEmojiPicker: PropTypes.bool.isRequired,\n\n        /**\n         * Whether to show the gif picker.\n         */\n        enableGifPicker: PropTypes.bool.isRequired,\n\n        /**\n         * Whether to check with the user before notifying the whole channel.\n         */\n        enableConfirmNotificationsToChannel: PropTypes.bool.isRequired,\n\n        /**\n         * The maximum length of a post\n         */\n        maxPostSize: PropTypes.number.isRequired,\n        emojiMap: PropTypes.object.isRequired,\n\n        /**\n         * If our connection is bad\n         */\n        badConnection: PropTypes.bool.isRequired,\n\n        /**\n         * Whether to display a confirmation modal to reset status.\n         */\n        userIsOutOfOffice: PropTypes.bool.isRequired,\n        rhsExpanded: PropTypes.bool.isRequired,\n\n        /**\n         * To check if the timezones are enable on the server.\n         */\n        isTimezoneEnabled: PropTypes.bool.isRequired,\n\n        canPost: PropTypes.bool.isRequired,\n\n        /**\n         * To determine if the current user can send special channel mentions\n         */\n        useChannelMentions: PropTypes.bool.isRequired,\n\n        intl: intlShape.isRequired,\n        actions: PropTypes.shape({\n\n            /**\n             *  func called after message submit.\n             */\n            addMessageIntoHistory: PropTypes.func.isRequired,\n\n            /**\n             *  func called for navigation through messages by Up arrow\n             */\n            moveHistoryIndexBack: PropTypes.func.isRequired,\n\n            /**\n             *  func called for navigation through messages by Down arrow\n             */\n            moveHistoryIndexForward: PropTypes.func.isRequired,\n\n            /**\n             *  func called for adding a reaction\n             */\n            addReaction: PropTypes.func.isRequired,\n\n            /**\n             *  func called for posting message\n             */\n            onSubmitPost: PropTypes.func.isRequired,\n\n            /**\n             *  func called for removing a reaction\n             */\n            removeReaction: PropTypes.func.isRequired,\n\n            /**\n             *  func called on load of component to clear drafts\n             */\n            clearDraftUploads: PropTypes.func.isRequired,\n\n            /**\n             * hooks called before a message is sent to the server\n             */\n            runMessageWillBePostedHooks: PropTypes.func.isRequired,\n\n            /**\n             * hooks called before a slash command is sent to the server\n             */\n            runSlashCommandWillBePostedHooks: PropTypes.func.isRequired,\n\n            /**\n             *  func called for setting drafts\n             */\n            setDraft: PropTypes.func.isRequired,\n\n            /**\n             *  func called for editing posts\n             */\n            setEditingPost: PropTypes.func.isRequired,\n\n            /**\n             *  func called for opening the last replayable post in the RHS\n             */\n            selectPostFromRightHandSideSearchByPostId: PropTypes.func.isRequired,\n\n            /**\n             * Function to open a modal\n             */\n            openModal: PropTypes.func.isRequired,\n\n            executeCommand: PropTypes.func.isRequired,\n\n            /**\n             * Function to get the users timezones in the channel\n             */\n            getChannelTimezones: PropTypes.func.isRequired,\n            scrollPostListToBottom: PropTypes.func.isRequired,\n\n            /**\n             * Function to set or unset emoji picker for last message\n             */\n            emitShortcutReactToLastPostFrom: PropTypes.func\n        }).isRequired,\n    }\n\n    static defaultProps = {\n        latestReplyablePostId: '',\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        let updatedState = {currentChannel: props.currentChannel};\n        if (props.currentChannel.id !== state.currentChannel.id) {\n            updatedState = {\n                ...updatedState,\n                message: props.draft.message,\n                submitting: false,\n                serverError: null,\n                showPreview: false,\n            };\n        }\n        return updatedState;\n    }\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            message: this.props.draft.message,\n            caretPosition: this.props.draft.message.length,\n            submitting: false,\n            showPostDeletedModal: false,\n            showEmojiPicker: false,\n            showConfirmModal: false,\n            channelTimezoneCount: 0,\n            showPreview: false,\n            uploadsProgressPercent: {},\n            renderScrollbar: false,\n            currentChannel: props.currentChannel,\n        };\n\n        this.lastBlurAt = 0;\n        this.lastChannelSwitchAt = 0;\n        this.draftsForChannel = {};\n        this.lastOrientation = null;\n    }\n\n    componentDidMount() {\n        this.onOrientationChange();\n        this.props.actions.clearDraftUploads(StoragePrefixes.DRAFT, (key, value) => {\n            if (value) {\n                return {...value, uploadsInProgress: []};\n            }\n            return value;\n        });\n\n        this.focusTextbox();\n        document.addEventListener('paste', this.pasteHandler);\n        document.addEventListener('keydown', this.documentKeyHandler);\n        this.setOrientationListeners();\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (prevProps.currentChannel.id !== this.props.currentChannel.id) {\n            this.lastChannelSwitchAt = Date.now();\n            this.focusTextbox();\n        }\n\n        // Focus on textbox when emoji picker is closed\n        if (prevState.showEmojiPicker && !this.state.showEmojiPicker) {\n            this.focusTextbox();\n        }\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('paste', this.pasteHandler);\n        document.removeEventListener('keydown', this.documentKeyHandler);\n        this.removeOrientationListeners();\n        if (this.saveDraftFrame) {\n            const channelId = this.props.currentChannel.id;\n            this.props.actions.setDraft(StoragePrefixes.DRAFT + channelId, this.draftsForChannel[channelId]);\n            cancelAnimationFrame(this.saveDraftFrame);\n        }\n    }\n\n    updatePreview = (newState) => {\n        this.setState({showPreview: newState});\n    }\n\n    setOrientationListeners = () => {\n        if ((window.screen.orientation) && ('onchange' in window.screen.orientation)) {\n            window.screen.orientation.addEventListener('change', this.onOrientationChange);\n        } else if ('onorientationchange' in window) {\n            window.addEventListener('orientationchange', this.onOrientationChange);\n        }\n    };\n\n    removeOrientationListeners = () => {\n        if ((window.screen.orientation) && ('onchange' in window.screen.orientation)) {\n            window.screen.orientation.removeEventListener('change', this.onOrientationChange);\n        } else if ('onorientationchange' in window) {\n            window.removeEventListener('orientationchange', this.onOrientationChange);\n        }\n    };\n\n    onOrientationChange = () => {\n        if (!UserAgent.isIosWeb()) {\n            return;\n        }\n\n        const LANDSCAPE_ANGLE = 90;\n        let orientation = 'portrait';\n        if (window.orientation) {\n            orientation = Math.abs(window.orientation) === LANDSCAPE_ANGLE ? 'landscape' : 'portrait';\n        }\n\n        if (window.screen.orientation) {\n            orientation = window.screen.orientation.type.split('-')[0];\n        }\n\n        if (this.lastOrientation && orientation !== this.lastOrientation && (document.activeElement || {}).id === 'post_textbox') {\n            this.refs.textbox.getWrappedInstance().blur();\n        }\n\n        this.lastOrientation = orientation;\n    }\n\n    handlePostError = (postError) => {\n        this.setState({postError});\n    }\n\n    toggleEmojiPicker = () => {\n        this.setState({showEmojiPicker: !this.state.showEmojiPicker});\n    }\n\n    hideEmojiPicker = () => {\n        this.handleEmojiClose();\n    }\n\n    doSubmit = async (e) => {\n        const channelId = this.props.currentChannel.id;\n        if (e) {\n            e.preventDefault();\n        }\n\n        if (this.props.draft.uploadsInProgress.length > 0 || this.state.submitting) {\n            return;\n        }\n\n        let message = this.state.message;\n        let ignoreSlash = false;\n        const serverError = this.state.serverError;\n\n        if (serverError && isErrorInvalidSlashCommand(serverError) && serverError.submittedMessage === message) {\n            message = serverError.submittedMessage;\n            ignoreSlash = true;\n        }\n\n        const post = {};\n        post.file_ids = [];\n        post.message = message;\n\n        if (post.message.trim().length === 0 && this.props.draft.fileInfos.length === 0) {\n            return;\n        }\n\n        if (this.state.postError) {\n            this.setState({errorClass: 'animation--highlight'});\n            setTimeout(() => {\n                this.setState({errorClass: null});\n            }, Constants.ANIMATION_TIMEOUT);\n            return;\n        }\n\n        this.props.actions.addMessageIntoHistory(this.state.message);\n\n        this.setState({submitting: true, serverError: null});\n\n        const isReaction = Utils.REACTION_PATTERN.exec(post.message);\n        if (post.message.indexOf('/') === 0 && !ignoreSlash) {\n            this.setState({message: '', postError: null});\n            let args = {};\n            args.channel_id = channelId;\n            args.team_id = this.props.currentTeamId;\n\n            const hookResult = await this.props.actions.runSlashCommandWillBePostedHooks(post.message, args);\n\n            if (hookResult.error) {\n                this.setState({\n                    serverError: {\n                        ...hookResult.error,\n                        submittedMessage: post.message,\n                    },\n                    message: post.message,\n                });\n            } else if (!hookResult.data.message && !hookResult.data.args) {\n                // do nothing with an empty return from a hook\n            } else {\n                post.message = hookResult.data.message;\n                args = hookResult.data.args;\n\n                const {error} = await this.props.actions.executeCommand(post.message, args);\n\n                if (error) {\n                    if (error.sendMessage) {\n                        await this.sendMessage(post);\n                    } else {\n                        this.setState({\n                            serverError: {\n                                ...error,\n                                submittedMessage: post.message,\n                            },\n                            message: post.message,\n                        });\n                    }\n                }\n            }\n        } else if (isReaction && this.props.emojiMap.has(isReaction[2])) {\n            this.sendReaction(isReaction);\n\n            this.setState({message: ''});\n        } else {\n            const {error} = await this.sendMessage(post);\n\n            if (!error) {\n                this.setState({message: ''});\n            }\n        }\n\n        this.setState({\n            submitting: false,\n            postError: null,\n        });\n\n        cancelAnimationFrame(this.saveDraftFrame);\n        this.props.actions.setDraft(StoragePrefixes.DRAFT + channelId, null);\n        this.draftsForChannel[channelId] = null;\n\n        const fasterThanHumanWillClick = 150;\n        const forceFocus = (Date.now() - this.lastBlurAt < fasterThanHumanWillClick);\n\n        this.focusTextbox(forceFocus);\n    }\n\n    handleNotifyAllConfirmation = (e) => {\n        this.hideNotifyAllModal();\n        this.doSubmit(e);\n    }\n\n    hideNotifyAllModal = () => {\n        this.setState({showConfirmModal: false});\n    }\n\n    showNotifyAllModal = () => {\n        this.setState({showConfirmModal: true});\n    }\n\n    getStatusFromSlashCommand = () => {\n        const {message} = this.state;\n        const tokens = message.split(' ');\n\n        if (tokens.length > 0) {\n            return tokens[0].substring(1);\n        }\n        return '';\n    };\n\n    isStatusSlashCommand = (command) => {\n        return command === 'online' || command === 'away' ||\n            command === 'dnd' || command === 'offline';\n    };\n\n    handleSubmit = async (e) => {\n        const {\n            currentChannel: updateChannel,\n            userIsOutOfOffice,\n        } = this.props;\n\n        const currentMembersCount = this.props.currentChannelMembersCount;\n        const notificationsToChannel = this.props.enableConfirmNotificationsToChannel && this.props.useChannelMentions;\n        if (notificationsToChannel &&\n            currentMembersCount > Constants.NOTIFY_ALL_MEMBERS &&\n            containsAtChannel(this.state.message)) {\n            if (this.props.isTimezoneEnabled) {\n                const {data} = await this.props.actions.getChannelTimezones(this.props.currentChannel.id);\n                if (data) {\n                    this.setState({channelTimezoneCount: data.length});\n                } else {\n                    this.setState({channelTimezoneCount: 0});\n                }\n            }\n            this.showNotifyAllModal();\n            return;\n        }\n\n        const status = this.getStatusFromSlashCommand();\n        if (userIsOutOfOffice && this.isStatusSlashCommand(status)) {\n            const resetStatusModalData = {\n                ModalId: ModalIdentifiers.RESET_STATUS,\n                dialogType: ResetStatusModal,\n                dialogProps: {newStatus: status},\n            };\n\n            this.props.actions.openModal(resetStatusModalData);\n\n            this.setState({message: ''});\n            return;\n        }\n\n        if (trimRight(this.state.message) === '/header') {\n            const editChannelHeaderModalData = {\n                modalId: ModalIdentifiers.EDIT_CHANNEL_HEADER,\n                dialogType: EditChannelHeaderModal,\n                dialogProps: {channel: updateChannel},\n            };\n\n            this.props.actions.openModal(editChannelHeaderModalData);\n\n            this.setState({message: ''});\n            return;\n        }\n\n        const isDirectOrGroup = ((updateChannel.type === Constants.DM_CHANNEL) || (updateChannel.type === Constants.GM_CHANNEL));\n        if (!isDirectOrGroup && trimRight(this.state.message) === '/purpose') {\n            const editChannelPurposeModalData = {\n                modalId: ModalIdentifiers.EDIT_CHANNEL_PURPOSE,\n                dialogType: EditChannelPurposeModal,\n                dialogProps: {channel: updateChannel},\n            };\n\n            this.props.actions.openModal(editChannelPurposeModalData);\n\n            this.setState({message: ''});\n            return;\n        }\n\n        if (!isDirectOrGroup && trimRight(this.state.message) === '/rename') {\n            GlobalActions.showChannelNameUpdateModal(updateChannel);\n            this.setState({message: ''});\n            return;\n        }\n\n        await this.doSubmit(e);\n    }\n\n    sendMessage = async (originalPost) => {\n        const {\n            actions,\n            currentChannel,\n            currentUserId,\n            draft,\n        } = this.props;\n\n        let post = originalPost;\n\n        post.channel_id = currentChannel.id;\n\n        const time = Utils.getTimestamp();\n        const userId = currentUserId;\n        post.pending_post_id = `${userId}:${time}`;\n        post.user_id = userId;\n        post.create_at = time;\n        post.parent_id = this.state.parentId;\n        post.metadata = {};\n        post.props = {};\n        if (!this.props.useChannelMentions && containsAtChannel(post.message, {checkAllMentions: true})) {\n            post.props.mentionHighlightDisabled = true;\n        }\n        const hookResult = await actions.runMessageWillBePostedHooks(post);\n\n        if (hookResult.error) {\n            this.setState({\n                serverError: hookResult.error,\n                submitting: false,\n            });\n\n            return hookResult;\n        }\n\n        post = hookResult.data;\n\n        actions.onSubmitPost(post, draft.fileInfos);\n        actions.scrollPostListToBottom();\n\n        this.setState({\n            submitting: false,\n        });\n\n        return {data: true};\n    }\n\n    sendReaction(isReaction) {\n        const channelId = this.props.currentChannel.id;\n        const action = isReaction[1];\n        const emojiName = isReaction[2];\n        const postId = this.props.latestReplyablePostId;\n\n        if (postId && action === '+') {\n            this.props.actions.addReaction(postId, emojiName);\n        } else if (postId && action === '-') {\n            this.props.actions.removeReaction(postId, emojiName);\n        }\n\n        this.props.actions.setDraft(StoragePrefixes.DRAFT + channelId, null);\n        this.draftsForChannel[channelId] = null;\n    }\n\n    focusTextbox = (keepFocus = false) => {\n        if (this.refs.textbox && (keepFocus || !UserAgent.isMobile())) {\n            this.refs.textbox.getWrappedInstance().focus();\n        }\n    }\n\n    postMsgKeyPress = (e) => {\n        const {ctrlSend, codeBlockOnCtrlEnter} = this.props;\n\n        const {allowSending, withClosedCodeBlock, ignoreKeyPress, message} = postMessageOnKeyPress(e, this.state.message, ctrlSend, codeBlockOnCtrlEnter, Date.now(), this.lastChannelSwitchAt, this.state.caretPosition);\n\n        if (ignoreKeyPress) {\n            e.preventDefault();\n            e.stopPropagation();\n            return;\n        }\n\n        if (allowSending) {\n            e.persist();\n            if (this.refs.textbox) {\n                this.refs.textbox.getWrappedInstance().blur();\n            }\n\n            if (withClosedCodeBlock && message) {\n                this.setState({message}, () => this.handleSubmit(e));\n            } else {\n                this.handleSubmit(e);\n            }\n\n            this.updatePreview(false);\n        }\n\n        this.emitTypingEvent();\n    }\n\n    emitTypingEvent = () => {\n        const channelId = this.props.currentChannel.id;\n        GlobalActions.emitLocalUserTypingEvent(channelId, '');\n    }\n\n    handleChange = (e) => {\n        const message = e.target.value;\n        const channelId = this.props.currentChannel.id;\n\n        let serverError = this.state.serverError;\n        if (isErrorInvalidSlashCommand(serverError)) {\n            serverError = null;\n        }\n\n        this.setState({\n            message,\n            serverError,\n        });\n\n        const draft = {\n            ...this.props.draft,\n            message,\n        };\n        cancelAnimationFrame(this.saveDraftFrame);\n        this.saveDraftFrame = requestAnimationFrame(() => {\n            this.props.actions.setDraft(StoragePrefixes.DRAFT + channelId, draft);\n        });\n        this.draftsForChannel[channelId] = draft;\n    }\n\n    pasteHandler = (e) => {\n        if (!e.clipboardData || !e.clipboardData.items || e.target.id !== 'post_textbox') {\n            return;\n        }\n        const table = getTable(e.clipboardData);\n        if (!table) {\n            return;\n        }\n\n        e.preventDefault();\n\n        let message = '';\n        if (isGitHubCodeBlock(table.className)) {\n            message = '```\\n' + getPlainText(e.clipboardData) + '\\n```';\n        } else {\n            message = formatMarkdownTableMessage(table, this.state.message.trim());\n        }\n        this.setState({message});\n    }\n\n    handleFileUploadChange = () => {\n        this.focusTextbox();\n    }\n\n    handleUploadStart = (clientIds, channelId) => {\n        const uploadsInProgress = [\n            ...this.props.draft.uploadsInProgress,\n            ...clientIds,\n        ];\n\n        const draft = {\n            ...this.props.draft,\n            uploadsInProgress,\n        };\n\n        this.props.actions.setDraft(StoragePrefixes.DRAFT + channelId, draft);\n        this.draftsForChannel[channelId] = draft;\n\n        // this is a bit redundant with the code that sets focus when the file input is clicked,\n        // but this also resets the focus after a drag and drop\n        this.focusTextbox();\n    }\n\n    handleUploadProgress = ({clientId, name, percent, type}) => {\n        const uploadsProgressPercent = {...this.state.uploadsProgressPercent, [clientId]: {percent, name, type}};\n        this.setState({uploadsProgressPercent});\n    }\n\n    handleFileUploadComplete = (fileInfos, clientIds, channelId) => {\n        const draft = {...this.draftsForChannel[channelId]};\n\n        // remove each finished file from uploads\n        for (let i = 0; i < clientIds.length; i++) {\n            if (draft.uploadsInProgress) {\n                const index = draft.uploadsInProgress.indexOf(clientIds[i]);\n\n                if (index !== -1) {\n                    draft.uploadsInProgress = draft.uploadsInProgress.filter((item, itemIndex) => index !== itemIndex);\n                }\n            }\n        }\n\n        if (draft.fileInfos) {\n            draft.fileInfos = sortFileInfos(draft.fileInfos.concat(fileInfos), this.props.locale);\n        }\n\n        this.draftsForChannel[channelId] = draft;\n        this.props.actions.setDraft(StoragePrefixes.DRAFT + channelId, draft);\n    }\n\n    handleUploadError = (err, clientId, channelId) => {\n        const draft = {...this.draftsForChannel[channelId]};\n\n        let serverError = err;\n        if (typeof err === 'string') {\n            serverError = new Error(err);\n        }\n\n        if (clientId !== -1 && draft.uploadsInProgress) {\n            const index = draft.uploadsInProgress.indexOf(clientId);\n\n            if (index !== -1) {\n                const uploadsInProgress = draft.uploadsInProgress.filter((item, itemIndex) => index !== itemIndex);\n                const modifiedDraft = {\n                    ...draft,\n                    uploadsInProgress,\n                };\n                this.props.actions.setDraft(StoragePrefixes.DRAFT + channelId, modifiedDraft);\n                this.draftsForChannel[channelId] = modifiedDraft;\n            }\n        }\n\n        this.setState({serverError});\n    }\n\n    removePreview = (id) => {\n        let modifiedDraft = {};\n        const draft = {...this.props.draft};\n        const channelId = this.props.currentChannel.id;\n\n        // Clear previous errors\n        this.setState({serverError: null});\n\n        // id can either be the id of an uploaded file or the client id of an in progress upload\n        let index = draft.fileInfos.findIndex((info) => info.id === id);\n        if (index === -1) {\n            index = draft.uploadsInProgress.indexOf(id);\n\n            if (index !== -1) {\n                const uploadsInProgress = draft.uploadsInProgress.filter((item, itemIndex) => index !== itemIndex);\n\n                modifiedDraft = {\n                    ...draft,\n                    uploadsInProgress,\n                };\n\n                if (this.refs.fileUpload && this.refs.fileUpload.getWrappedInstance()) {\n                    this.refs.fileUpload.getWrappedInstance().cancelUpload(id);\n                }\n            }\n        } else {\n            const fileInfos = draft.fileInfos.filter((item, itemIndex) => index !== itemIndex);\n\n            modifiedDraft = {\n                ...draft,\n                fileInfos,\n            };\n        }\n\n        this.props.actions.setDraft(StoragePrefixes.DRAFT + channelId, modifiedDraft);\n        this.draftsForChannel[channelId] = modifiedDraft;\n\n        this.handleFileUploadChange();\n    }\n\n    focusTextboxIfNecessary = (e) => {\n        // Focus should go to the RHS when it is expanded\n        if (this.props.rhsExpanded) {\n            return;\n        }\n\n        // Bit of a hack to not steal focus from the channel switch modal if it's open\n        // This is a special case as the channel switch modal does not enforce focus like\n        // most modals do\n        if (document.getElementsByClassName('channel-switch-modal').length) {\n            return;\n        }\n\n        if (shouldFocusMainTextbox(e, document.activeElement)) {\n            this.focusTextbox();\n        }\n    }\n\n    documentKeyHandler = (e) => {\n        const ctrlOrMetaKeyPressed = e.ctrlKey || e.metaKey;\n        const shortcutModalKeyCombo = ctrlOrMetaKeyPressed && Utils.isKeyPressed(e, KeyCodes.FORWARD_SLASH);\n        const lastMessageReactionKeyCombo = ctrlOrMetaKeyPressed && e.shiftKey && Utils.isKeyPressed(e, KeyCodes.BACK_SLASH);\n\n        if (shortcutModalKeyCombo) {\n            e.preventDefault();\n\n            GlobalActions.toggleShortcutsModal();\n            return;\n        } else if (lastMessageReactionKeyCombo) {\n            this.reactToLastMessage(e);\n            return;\n        }\n\n        this.focusTextboxIfNecessary(e);\n    }\n\n    getFileCount = () => {\n        const draft = this.props.draft;\n        return draft.fileInfos.length + draft.uploadsInProgress.length;\n    }\n\n    getFileUploadTarget = () => {\n        if (this.refs.textbox) {\n            return this.refs.textbox.getWrappedInstance();\n        }\n\n        return null;\n    }\n\n    getCreatePostControls = () => {\n        return this.refs.createPostControls;\n    }\n\n    fillMessageFromHistory() {\n        const lastMessage = this.props.messageInHistoryItem;\n        if (lastMessage) {\n            this.setState({\n                message: lastMessage,\n            });\n        }\n    }\n\n    handleMouseUpKeyUp = (e) => {\n        const caretPosition = Utils.getCaretPosition(e.target);\n        this.setState({\n            caretPosition,\n        });\n    }\n\n    handleKeyDown = (e) => {\n        const ctrlOrMetaKeyPressed = e.ctrlKey || e.metaKey;\n        const messageIsEmpty = this.state.message.length === 0;\n        const draftMessageIsEmpty = this.props.draft.message.length === 0;\n        const ctrlEnterKeyCombo = (this.props.ctrlSend || this.props.codeBlockOnCtrlEnter) && Utils.isKeyPressed(e, KeyCodes.ENTER) && ctrlOrMetaKeyPressed;\n        const upKeyOnly = !ctrlOrMetaKeyPressed && !e.altKey && !e.shiftKey && Utils.isKeyPressed(e, KeyCodes.UP);\n        const shiftUpKeyCombo = !ctrlOrMetaKeyPressed && !e.altKey && e.shiftKey && Utils.isKeyPressed(e, KeyCodes.UP);\n        const ctrlKeyCombo = ctrlOrMetaKeyPressed && !e.altKey && !e.shiftKey;\n\n        if (ctrlEnterKeyCombo) {\n            this.postMsgKeyPress(e);\n        } else if (upKeyOnly && messageIsEmpty) {\n            this.editLastPost(e);\n        } else if (shiftUpKeyCombo && messageIsEmpty) {\n            this.replyToLastPost(e);\n        } else if (ctrlKeyCombo && draftMessageIsEmpty && Utils.isKeyPressed(e, KeyCodes.UP)) {\n            this.loadPrevMessage(e);\n        } else if (ctrlKeyCombo && draftMessageIsEmpty && Utils.isKeyPressed(e, KeyCodes.DOWN)) {\n            this.loadNextMessage(e);\n        }\n    }\n\n    editLastPost = (e) => {\n        e.preventDefault();\n\n        const lastPost = this.props.currentUsersLatestPost;\n        if (!lastPost) {\n            return;\n        }\n\n        let type;\n        if (lastPost.root_id && lastPost.root_id.length > 0) {\n            type = Utils.localizeMessage('create_post.comment', Posts.MESSAGE_TYPES.COMMENT);\n        } else {\n            type = Utils.localizeMessage('create_post.post', Posts.MESSAGE_TYPES.POST);\n        }\n        if (this.refs.textbox) {\n            this.refs.textbox.getWrappedInstance().blur();\n        }\n        this.props.actions.setEditingPost(lastPost.id, this.props.commentCountForPost, 'post_textbox', type);\n    }\n\n    replyToLastPost = (e) => {\n        e.preventDefault();\n        const latestReplyablePostId = this.props.latestReplyablePostId;\n        const replyBox = document.getElementById('reply_textbox');\n        if (replyBox) {\n            replyBox.focus();\n        }\n        if (latestReplyablePostId) {\n            this.props.actions.selectPostFromRightHandSideSearchByPostId(latestReplyablePostId);\n        }\n    }\n\n    loadPrevMessage = (e) => {\n        e.preventDefault();\n        this.props.actions.moveHistoryIndexBack(Posts.MESSAGE_TYPES.POST).then(() => this.fillMessageFromHistory());\n    }\n\n    loadNextMessage = (e) => {\n        e.preventDefault();\n        this.props.actions.moveHistoryIndexForward(Posts.MESSAGE_TYPES.POST).then(() => this.fillMessageFromHistory());\n    }\n\n    reactToLastMessage = (e) => {\n        e.preventDefault();\n\n        const {rhsExpanded, actions: {emitShortcutReactToLastPostFrom}} = this.props;\n        const noModalsAreOpen = document.getElementsByClassName(A11yClassNames.MODAL).length === 0;\n        const noPopupsDropdownsAreOpen = document.getElementsByClassName(A11yClassNames.POPUP).length === 0;\n\n        // Block keyboard shortcut react to last message when :\n        // - RHS is completely expanded\n        // - Any dropdown/popups are open\n        // - Any modals are open\n        if (!rhsExpanded && noModalsAreOpen && noPopupsDropdownsAreOpen) {\n            emitShortcutReactToLastPostFrom(Locations.CENTER);\n        }\n    }\n\n    handleBlur = () => {\n        this.lastBlurAt = Date.now();\n    }\n\n    showPostDeletedModal = () => {\n        this.setState({\n            showPostDeletedModal: true,\n        });\n    }\n\n    hidePostDeletedModal = () => {\n        this.setState({\n            showPostDeletedModal: false,\n        });\n    }\n\n    handleEmojiClose = () => {\n        this.setState({showEmojiPicker: false});\n    }\n\n    handleEmojiClick = (emoji) => {\n        const emojiAlias = emoji.name || emoji.aliases[0];\n\n        if (!emojiAlias) {\n            //Oops.. There went something wrong\n            return;\n        }\n\n        if (this.state.message === '') {\n            this.setState({message: ':' + emojiAlias + ': '});\n        } else {\n            const {message} = this.state;\n            const {firstPiece, lastPiece} = splitMessageBasedOnCaretPosition(this.state.caretPosition, message);\n\n            // check whether the first piece of the message is empty when cursor is placed at beginning of message and avoid adding an empty string at the beginning of the message\n            const newMessage = firstPiece === '' ? `:${emojiAlias}: ${lastPiece}` : `${firstPiece} :${emojiAlias}: ${lastPiece}`;\n\n            const newCaretPosition = firstPiece === '' ? `:${emojiAlias}: `.length : `${firstPiece} :${emojiAlias}: `.length;\n\n            const textbox = this.refs.textbox.getWrappedInstance().getInputBox();\n\n            this.setState({\n                message: newMessage,\n                caretPosition: newCaretPosition,\n            }, () => {\n                Utils.setCaretPosition(textbox, newCaretPosition);\n            });\n        }\n\n        this.handleEmojiClose();\n    }\n\n    handleGifClick = (gif) => {\n        if (this.state.message === '') {\n            this.setState({message: gif});\n        } else {\n            const newMessage = ((/\\s+$/).test(this.state.message)) ? this.state.message + gif : this.state.message + ' ' + gif;\n            this.setState({message: newMessage});\n        }\n        this.handleEmojiClose();\n    }\n\n    createTutorialTip() {\n        const screens = [];\n\n        screens.push(\n            <div>\n                <h4>\n                    <FormattedMessage\n                        id='create_post.tutorialTip.title'\n                        defaultMessage='Sending Messages'\n                    />\n                </h4>\n                <p>\n                    <FormattedMarkdownMessage\n                        id='create_post.tutorialTip1'\n                        defaultMessage='Type here to write a message and press **Enter** to post it.'\n                    />\n                </p>\n                <p>\n                    <FormattedMarkdownMessage\n                        id='create_post.tutorialTip2'\n                        defaultMessage='Click the **Attachment** button to upload an image or a file.'\n                    />\n                </p>\n            </div>,\n        );\n\n        return (\n            <TutorialTip\n                id='postTextboxTipMessage'\n                placement='top'\n                screens={screens}\n                overlayClass='tip-overlay--chat'\n                diagnosticsTag='tutorial_tip_1_sending_messages'\n            />\n        );\n    }\n\n    shouldEnableSendButton() {\n        return this.state.message.trim().length !== 0 || this.props.draft.fileInfos.length !== 0;\n    }\n\n    handleHeightChange = (height, maxHeight) => {\n        this.setState({renderScrollbar: height > maxHeight});\n    }\n\n    render() {\n        const {\n            currentChannel,\n            currentChannelMembersCount,\n            draft,\n            fullWidthTextBox,\n            showTutorialTip,\n            canPost,\n        } = this.props;\n        const readOnlyChannel = this.props.readOnlyChannel || !canPost;\n        const {formatMessage} = this.props.intl;\n        const members = currentChannelMembersCount - 1;\n        const {renderScrollbar} = this.state;\n        const ariaLabelMessageInput = Utils.localizeMessage('accessibility.sections.centerFooter', 'message input complimentary region');\n\n        const notifyAllTitle = (\n            <FormattedMessage\n                id='notify_all.title.confirm'\n                defaultMessage='Confirm Sending Notifications to Entire Channel'\n            />\n        );\n\n        const notifyAllConfirm = (\n            <FormattedMessage\n                id='notify_all.confirm'\n                defaultMessage='Confirm'\n            />\n        );\n\n        let notifyAllMessage = '';\n        if (this.state.channelTimezoneCount && this.props.isTimezoneEnabled) {\n            notifyAllMessage = (\n                <FormattedMarkdownMessage\n                    id='notify_all.question_timezone'\n                    defaultMessage='By using @all or @channel you are about to send notifications to **{totalMembers} people** in **{timezones, number} {timezones, plural, one {timezone} other {timezones}}**. Are you sure you want to do this?'\n                    values={{\n                        totalMembers: members,\n                        timezones: this.state.channelTimezoneCount,\n                    }}\n                />\n            );\n        } else {\n            notifyAllMessage = (\n                <FormattedMessage\n                    id='notify_all.question'\n                    defaultMessage='By using @all or @channel you are about to send notifications to {totalMembers} people. Are you sure you want to do this?'\n                    values={{\n                        totalMembers: members,\n                    }}\n                />\n            );\n        }\n\n        let serverError = null;\n        if (this.state.serverError) {\n            serverError = (\n                <MessageSubmitError\n                    id='postServerError'\n                    error={this.state.serverError}\n                    submittedMessage={this.state.serverError.submittedMessage}\n                    handleSubmit={this.handleSubmit}\n                />\n            );\n        }\n\n        let postError = null;\n        if (this.state.postError) {\n            const postErrorClass = 'post-error' + (this.state.errorClass ? (' ' + this.state.errorClass) : '');\n            postError = <label className={postErrorClass}>{this.state.postError}</label>;\n        }\n\n        let preview = null;\n        if (!readOnlyChannel && (draft.fileInfos.length > 0 || draft.uploadsInProgress.length > 0)) {\n            preview = (\n                <FilePreview\n                    fileInfos={draft.fileInfos}\n                    onRemove={this.removePreview}\n                    uploadsInProgress={draft.uploadsInProgress}\n                    uploadsProgressPercent={this.state.uploadsProgressPercent}\n                />\n            );\n        }\n\n        let postFooterClassName = 'post-create-footer';\n        if (postError) {\n            postFooterClassName += ' has-error';\n        }\n\n        let tutorialTip = null;\n        if (showTutorialTip) {\n            tutorialTip = this.createTutorialTip();\n        }\n\n        let centerClass = '';\n        if (!fullWidthTextBox) {\n            centerClass = 'center';\n        }\n\n        let sendButtonClass = 'send-button theme';\n        if (!this.shouldEnableSendButton()) {\n            sendButtonClass += ' disabled';\n        }\n\n        let attachmentsDisabled = '';\n        if (!this.props.canUploadFiles) {\n            attachmentsDisabled = ' post-create--attachment-disabled';\n        }\n\n        let fileUpload;\n        if (!readOnlyChannel && !this.state.showPreview) {\n            fileUpload = (\n                <FileUpload\n                    ref='fileUpload'\n                    fileCount={this.getFileCount()}\n                    getTarget={this.getFileUploadTarget}\n                    onFileUploadChange={this.handleFileUploadChange}\n                    onUploadStart={this.handleUploadStart}\n                    onFileUpload={this.handleFileUploadComplete}\n                    onUploadError={this.handleUploadError}\n                    onUploadProgress={this.handleUploadProgress}\n                    postType='post'\n                />\n            );\n        }\n\n        let emojiPicker = null;\n        const emojiButtonAriaLabel = formatMessage({id: 'emoji_picker.emojiPicker', defaultMessage: 'Emoji Picker'}).toLowerCase();\n\n        if (this.props.enableEmojiPicker && !readOnlyChannel && !this.state.showPreview) {\n            emojiPicker = (\n                <div>\n                    <EmojiPickerOverlay\n                        show={this.state.showEmojiPicker}\n                        target={this.getCreatePostControls}\n                        onHide={this.hideEmojiPicker}\n                        onEmojiClose={this.handleEmojiClose}\n                        onEmojiClick={this.handleEmojiClick}\n                        onGifClick={this.handleGifClick}\n                        enableGifPicker={this.props.enableGifPicker}\n                        topOffset={-7}\n                    />\n                    <button\n                        type='button'\n                        aria-label={emojiButtonAriaLabel}\n                        onClick={this.toggleEmojiPicker}\n                        className='style--none emoji-picker__container post-action'\n                    >\n                        <EmojiIcon\n                            id='emojiPickerButton'\n                            className={'icon icon--emoji ' + (this.state.showEmojiPicker ? 'active' : '')}\n                        />\n                    </button>\n                </div>\n            );\n        }\n\n        let createMessage;\n        if (readOnlyChannel) {\n            createMessage = Utils.localizeMessage('create_post.read_only', 'This channel is read-only. Only members with permission can post here.');\n        } else {\n            createMessage = formatMessage(\n                {id: 'create_post.write', defaultMessage: 'Write to {channelDisplayName}'},\n                {channelDisplayName: currentChannel.display_name},\n            );\n        }\n\n        let scrollbarClass = '';\n        if (renderScrollbar) {\n            scrollbarClass = ' scroll';\n        }\n\n        return (\n            <form\n                id='create_post'\n                ref='topDiv'\n                className={centerClass}\n                onSubmit={this.handleSubmit}\n            >\n                <div className={'post-create' + attachmentsDisabled + scrollbarClass}>\n                    <div className='post-create-body'>\n                        <div\n                            role='application'\n                            id='centerChannelFooter'\n                            aria-label={ariaLabelMessageInput}\n                            tabIndex='-1'\n                            className='post-body__cell a11y__region'\n                            data-a11y-sort-order='2'\n                        >\n                            <Textbox\n                                onChange={this.handleChange}\n                                onKeyPress={this.postMsgKeyPress}\n                                onKeyDown={this.handleKeyDown}\n                                onMouseUp={this.handleMouseUpKeyUp}\n                                onKeyUp={this.handleMouseUpKeyUp}\n                                onComposition={this.emitTypingEvent}\n                                onHeightChange={this.handleHeightChange}\n                                handlePostError={this.handlePostError}\n                                value={readOnlyChannel ? '' : this.state.message}\n                                onBlur={this.handleBlur}\n                                emojiEnabled={this.props.enableEmojiPicker}\n                                createMessage={createMessage}\n                                channelId={currentChannel.id}\n                                id='post_textbox'\n                                ref='textbox'\n                                disabled={readOnlyChannel}\n                                characterLimit={this.props.maxPostSize}\n                                preview={this.state.showPreview}\n                                badConnection={this.props.badConnection}\n                                listenForMentionKeyClick={true}\n                                useChannelMentions={this.props.useChannelMentions}\n                            />\n                            <span\n                                ref='createPostControls'\n                                className='post-body__actions'\n                            >\n                                {fileUpload}\n                                {emojiPicker}\n                                <a\n                                    role='button'\n                                    tabIndex='0'\n                                    aria-label={formatMessage({\n                                        id: 'create_post.send_message',\n                                        defaultMessage: 'Send a message',\n                                    })}\n                                    className={sendButtonClass}\n                                    onClick={this.handleSubmit}\n                                >\n                                    <LocalizedIcon\n                                        className='fa fa-paper-plane'\n                                        title={{\n                                            id: t('create_post.icon'),\n                                            defaultMessage: 'Send Post Icon',\n                                        }}\n                                    />\n                                </a>\n                            </span>\n                        </div>\n                        {tutorialTip}\n                    </div>\n                    <div\n                        id='postCreateFooter'\n                        role='form'\n                        className={postFooterClassName}\n                    >\n                        <div className='d-flex justify-content-between'>\n                            <MsgTyping\n                                channelId={currentChannel.id}\n                                postId=''\n                            />\n                            <TextboxLinks\n                                characterLimit={this.props.maxPostSize}\n                                showPreview={this.state.showPreview}\n                                updatePreview={this.updatePreview}\n                                message={readOnlyChannel ? '' : this.state.message}\n                            />\n                        </div>\n                        <div>\n                            {postError}\n                            {preview}\n                            {serverError}\n                        </div>\n                    </div>\n                </div>\n                <PostDeletedModal\n                    show={this.state.showPostDeletedModal}\n                    onHide={this.hidePostDeletedModal}\n                />\n                <ConfirmModal\n                    title={notifyAllTitle}\n                    message={notifyAllMessage}\n                    confirmButtonText={notifyAllConfirm}\n                    show={this.state.showConfirmModal}\n                    onConfirm={this.handleNotifyAllConfirmation}\n                    onCancel={this.hideNotifyAllModal}\n                />\n            </form>\n        );\n    }\n}\n\nexport default injectIntl(CreatePost);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\n\nimport {getCurrentChannel, getCurrentChannelStats} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentUserId, isCurrentUserSystemAdmin, getStatusForUserId} from 'mattermost-redux/selectors/entities/users';\nimport {haveIChannelPermission} from 'mattermost-redux/selectors/entities/roles';\nimport {getChannelTimezones} from 'mattermost-redux/actions/channels';\nimport {get, getInt, getBool} from 'mattermost-redux/selectors/entities/preferences';\nimport {\n    getCurrentUsersLatestPost,\n    getLatestReplyablePostId,\n    getMostRecentPostIdInChannel,\n    getPost,\n    makeGetCommentCountForPost,\n    makeGetMessageInHistoryItem,\n} from 'mattermost-redux/selectors/entities/posts';\nimport {\n    addMessageIntoHistory,\n    moveHistoryIndexBack,\n    moveHistoryIndexForward,\n    removeReaction,\n} from 'mattermost-redux/actions/posts';\nimport {Permissions, Posts, Preferences as PreferencesRedux} from 'mattermost-redux/constants';\n\nimport {connectionErrorCount} from 'selectors/views/system';\n\nimport {addReaction, createPost, setEditingPost, emitShortcutReactToLastPostFrom} from 'actions/post_actions.jsx';\nimport {scrollPostListToBottom} from 'actions/views/channel';\nimport {selectPostFromRightHandSideSearchByPostId} from 'actions/views/rhs';\nimport {executeCommand} from 'actions/command';\nimport {runMessageWillBePostedHooks, runSlashCommandWillBePostedHooks} from 'actions/hooks';\nimport {getPostDraft, getIsRhsExpanded} from 'selectors/rhs';\nimport {getCurrentLocale} from 'selectors/i18n';\nimport {getEmojiMap, getShortcutReactToLastPostEmittedFrom} from 'selectors/emojis';\nimport {setGlobalItem, actionOnGlobalItemsWithPrefix} from 'actions/storage';\nimport {openModal} from 'actions/views/modals';\nimport {Constants, Preferences, StoragePrefixes, TutorialSteps, UserStatuses} from 'utils/constants';\nimport {canUploadFiles} from 'utils/file_utils';\n\nimport CreatePost from './create_post.jsx';\n\nfunction makeMapStateToProps() {\n    const getCommentCountForPost = makeGetCommentCountForPost();\n    const getMessageInHistoryItem = makeGetMessageInHistoryItem(Posts.MESSAGE_TYPES.POST);\n\n    return (state, ownProps) => {\n        const config = getConfig(state);\n        const currentChannel = getCurrentChannel(state) || {};\n        const draft = getPostDraft(state, StoragePrefixes.DRAFT, currentChannel.id);\n        const recentPostIdInChannel = getMostRecentPostIdInChannel(state, currentChannel.id);\n        const post = getPost(state, recentPostIdInChannel);\n        const latestReplyablePostId = getLatestReplyablePostId(state);\n        const currentChannelMembersCount = getCurrentChannelStats(state) ? getCurrentChannelStats(state).member_count : 1;\n        const enableTutorial = config.EnableTutorial === 'true';\n        const tutorialStep = getInt(state, Preferences.TUTORIAL_STEP, getCurrentUserId(state), TutorialSteps.FINISHED);\n        const enableEmojiPicker = config.EnableEmojiPicker === 'true';\n        const enableGifPicker = config.EnableGifPicker === 'true';\n        const enableConfirmNotificationsToChannel = config.EnableConfirmNotificationsToChannel === 'true';\n        const currentUserId = getCurrentUserId(state);\n        const userIsOutOfOffice = getStatusForUserId(state, currentUserId) === UserStatuses.OUT_OF_OFFICE;\n        const badConnection = connectionErrorCount(state) > 1;\n        const isTimezoneEnabled = config.ExperimentalTimezone === 'true';\n        const shortcutReactToLastPostEmittedFrom = getShortcutReactToLastPostEmittedFrom(state);\n        const canPost = haveIChannelPermission(\n            state,\n            {\n                channel: currentChannel.id,\n                team: currentChannel.team_id,\n                permission: Permissions.CREATE_POST,\n            }\n        );\n        const useChannelMentions = haveIChannelPermission(state, {\n            channel: currentChannel.id,\n            team: currentChannel.team_id,\n            permission: Permissions.USE_CHANNEL_MENTIONS,\n        });\n\n        return {\n            currentTeamId: getCurrentTeamId(state),\n            currentChannel,\n            currentChannelMembersCount,\n            currentUserId,\n            codeBlockOnCtrlEnter: getBool(state, PreferencesRedux.CATEGORY_ADVANCED_SETTINGS, 'code_block_ctrl_enter', true),\n            ctrlSend: getBool(state, Preferences.CATEGORY_ADVANCED_SETTINGS, 'send_on_ctrl_enter'),\n            fullWidthTextBox: get(state, Preferences.CATEGORY_DISPLAY_SETTINGS, Preferences.CHANNEL_DISPLAY_MODE, Preferences.CHANNEL_DISPLAY_MODE_DEFAULT) === Preferences.CHANNEL_DISPLAY_MODE_FULL_SCREEN,\n            showTutorialTip: enableTutorial && tutorialStep === TutorialSteps.POST_POPOVER,\n            messageInHistoryItem: getMessageInHistoryItem(state),\n            draft,\n            commentCountForPost: getCommentCountForPost(state, {post}),\n            latestReplyablePostId,\n            locale: getCurrentLocale(state),\n            currentUsersLatestPost: getCurrentUsersLatestPost(state),\n            readOnlyChannel: ownProps.readOnlyChannel || (!isCurrentUserSystemAdmin(state) && config.ExperimentalTownSquareIsReadOnly === 'true' && currentChannel.name === Constants.DEFAULT_CHANNEL),\n            canUploadFiles: canUploadFiles(config),\n            enableEmojiPicker,\n            enableGifPicker,\n            enableConfirmNotificationsToChannel,\n            maxPostSize: parseInt(config.MaxPostSize, 10) || Constants.DEFAULT_CHARACTER_LIMIT,\n            userIsOutOfOffice,\n            rhsExpanded: getIsRhsExpanded(state),\n            emojiMap: getEmojiMap(state),\n            badConnection,\n            isTimezoneEnabled,\n            shortcutReactToLastPostEmittedFrom,\n            canPost,\n            useChannelMentions,\n        };\n    };\n}\n\nfunction onSubmitPost(post, fileInfos) {\n    return (dispatch) => {\n        dispatch(createPost(post, fileInfos));\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            addMessageIntoHistory,\n            onSubmitPost,\n            moveHistoryIndexBack,\n            moveHistoryIndexForward,\n            addReaction,\n            removeReaction,\n            setDraft: setGlobalItem,\n            clearDraftUploads: actionOnGlobalItemsWithPrefix,\n            selectPostFromRightHandSideSearchByPostId,\n            setEditingPost,\n            emitShortcutReactToLastPostFrom,\n            openModal,\n            executeCommand,\n            getChannelTimezones,\n            runMessageWillBePostedHooks,\n            runSlashCommandWillBePostedHooks,\n            scrollPostListToBottom,\n        }, dispatch),\n    };\n}\n\nexport default connect(makeMapStateToProps, mapDispatchToProps)(CreatePost);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class CommentedOnFilesMessage extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * The id of the post that was commented on\n         */\n        parentPostId: PropTypes.string.isRequired,\n\n        /*\n         * An array of file metadata for the parent post\n         */\n        fileInfos: PropTypes.arrayOf(PropTypes.object),\n    }\n\n    render() {\n        if (!this.props.fileInfos || this.props.fileInfos.length === 0) {\n            return null;\n        }\n\n        let plusMore = null;\n        if (this.props.fileInfos.length > 1) {\n            plusMore = (\n                <FormattedMessage\n                    id='post_body.plusMore'\n                    defaultMessage=' plus {count, number} other {count, plural, one {file} other {files}}'\n                    values={{\n                        count: this.props.fileInfos.length - 1,\n                    }}\n                />\n            );\n        }\n\n        return (\n            <span>\n                {this.props.fileInfos[0].name}\n                {plusMore}\n            </span>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {makeGetFilesForPost} from 'mattermost-redux/selectors/entities/files';\n\nimport CommentedOnFilesMessage from './commented_on_files_message.jsx';\n\nfunction makeMapStateToProps() {\n    const selectFileInfosForPost = makeGetFilesForPost();\n\n    return function mapStateToProps(state, ownProps) {\n        let fileInfos;\n        if (ownProps.parentPostId) {\n            fileInfos = selectFileInfosForPost(state, ownProps.parentPostId);\n        }\n\n        return {\n            fileInfos,\n        };\n    };\n}\n\nexport default connect(makeMapStateToProps)(CommentedOnFilesMessage);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\nimport {FormattedMessage} from 'react-intl';\n\nimport * as Utils from 'utils/utils.jsx';\nimport {stripMarkdown} from 'utils/markdown';\n\nimport CommentedOnFilesMessage from 'components/post_view/commented_on_files_message';\n\nexport default class CommentedOn extends PureComponent {\n    static propTypes = {\n        displayName: PropTypes.string,\n        enablePostUsernameOverride: PropTypes.bool,\n        onCommentClick: PropTypes.func.isRequired,\n        post: PropTypes.object.isRequired,\n        actions: PropTypes.shape({\n            showSearchResults: PropTypes.func.isRequired,\n            updateSearchTerms: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    handleOnClick = () => {\n        const {actions} = this.props;\n        const displayName = this.makeUsername();\n        actions.updateSearchTerms(displayName);\n        actions.showSearchResults();\n    }\n\n    makeUsername = () => {\n        const postProps = this.props.post.props;\n        let username = this.props.displayName;\n        if (this.props.enablePostUsernameOverride && postProps && postProps.from_webhook === 'true' && postProps.override_username) {\n            username = postProps.override_username;\n        }\n        return username;\n    }\n\n    makeCommentedOnMessage = () => {\n        const {post} = this.props;\n        let message = '';\n        if (post.message) {\n            message = Utils.replaceHtmlEntities(post.message);\n        } else if (post.file_ids && post.file_ids.length > 0) {\n            message = (\n                <CommentedOnFilesMessage parentPostId={post.id}/>\n            );\n        } else if (post.props && post.props.attachments && post.props.attachments.length > 0) {\n            const attachment = post.props.attachments[0];\n            const webhookMessage = attachment.pretext || attachment.title || attachment.text || attachment.fallback || '';\n            message = Utils.replaceHtmlEntities(webhookMessage);\n        }\n\n        return message;\n    }\n\n    render() {\n        const username = this.makeUsername();\n        const message = this.makeCommentedOnMessage();\n\n        const name = (\n            <a\n                className='theme'\n                onClick={this.handleOnClick}\n            >\n                {username}\n            </a>\n        );\n\n        return (\n            <div\n                data-testid='post-link'\n                className='post__link'\n            >\n                <span>\n                    <FormattedMessage\n                        id='post_body.commentedOn'\n                        defaultMessage=\"Commented on {name}'s message: \"\n                        values={{\n                            name,\n                        }}\n                    />\n                    <a\n                        className='theme'\n                        onClick={this.props.onCommentClick}\n                    >\n                        {stripMarkdown(message)}\n                    </a>\n                </span>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getUser} from 'mattermost-redux/selectors/entities/users';\n\nimport {showSearchResults, updateSearchTerms} from 'actions/views/rhs';\n\nimport {getDisplayNameByUser} from 'utils/utils.jsx';\n\nimport CommentedOn from './commented_on.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    let displayName = '';\n    if (ownProps.post) {\n        const user = getUser(state, ownProps.post.user_id);\n        displayName = getDisplayNameByUser(state, user);\n    }\n\n    const config = getConfig(state);\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\n\n    return {\n        displayName,\n        enablePostUsernameOverride,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            showSearchResults,\n            updateSearchTerms,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CommentedOn);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {Posts} from 'mattermost-redux/constants';\n\nimport * as PostUtils from 'utils/post_utils.jsx';\nimport * as Utils from 'utils/utils.jsx';\nimport DelayedAction from 'utils/delayed_action';\n\nimport CommentedOn from 'components/post_view/commented_on';\nimport FileAttachmentListContainer from 'components/file_attachment_list';\nimport FailedPostOptions from 'components/post_view/failed_post_options';\nimport PostBodyAdditionalContent from 'components/post_view/post_body_additional_content';\nimport PostMessageView from 'components/post_view/post_message_view';\nimport ReactionList from 'components/post_view/reaction_list';\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\n\nconst SENDING_ANIMATION_DELAY = 3000;\n\nexport default class PostBody extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * The post to render the body of\n         */\n        post: PropTypes.object.isRequired,\n\n        /**\n         * The parent post of the thread this post is in\n         */\n        parentPost: PropTypes.object,\n\n        /**\n         * The poster of the parent post, if exists\n         */\n        parentPostUser: PropTypes.object,\n\n        /**\n         * The function called when the comment icon is clicked\n         */\n        handleCommentClick: PropTypes.func.isRequired,\n\n        /**\n         * Set to render post body compactly\n         */\n        compactDisplay: PropTypes.bool,\n\n        /**\n         * Set to highlight comment as a mention\n         */\n        isCommentMention: PropTypes.bool,\n\n        /**\n         * Set to render a preview of the parent post above this reply\n         */\n        isFirstReply: PropTypes.bool,\n\n        /*\n         * Post type components from plugins\n         */\n        pluginPostTypes: PropTypes.object,\n\n        /**\n         * Flag passed down to PostBodyAdditionalContent for determining if post embed is visible\n         */\n        isEmbedVisible: PropTypes.bool,\n\n        /**\n         * Whether or not the post username can be overridden.\n         */\n        enablePostUsernameOverride: PropTypes.bool.isRequired,\n\n        /**\n         * Set not to allow edits on post\n         */\n        isReadOnly: PropTypes.bool,\n    }\n\n    static defaultProps = {\n        isReadOnly: false,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.sendingAction = new DelayedAction(\n            () => {\n                const post = this.props.post;\n                if (post && post.id === post.pending_post_id) {\n                    this.setState({sending: true});\n                }\n            }\n        );\n\n        this.state = {sending: false};\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        if (state.sending && props.post && (props.post.id !== props.post.pending_post_id)) {\n            return {\n                sending: false,\n            };\n        }\n\n        return null;\n    }\n\n    componentDidUpdate() {\n        if (this.state.sending === false) {\n            this.sendingAction.cancel();\n        }\n    }\n\n    componentDidMount() {\n        const post = this.props.post;\n        if (post && post.id === post.pending_post_id) {\n            this.sendingAction.fireAfter(SENDING_ANIMATION_DELAY);\n        }\n    }\n\n    componentWillUnmount() {\n        this.sendingAction.cancel();\n    }\n\n    render() {\n        const post = this.props.post;\n        const parentPost = this.props.parentPost;\n\n        let comment;\n        let postClass = '';\n        const isEphemeral = Utils.isPostEphemeral(post);\n        if (this.props.isFirstReply && parentPost && !isEphemeral) {\n            comment = (\n                <CommentedOn\n                    post={parentPost}\n                    onCommentClick={this.props.handleCommentClick}\n                />\n            );\n        }\n\n        let failedOptions;\n        if (this.props.post.failed) {\n            postClass += ' post--fail';\n            failedOptions = <FailedPostOptions post={this.props.post}/>;\n        }\n\n        if (PostUtils.isEdited(this.props.post)) {\n            postClass += ' post--edited';\n        }\n\n        let fileAttachmentHolder = null;\n        if (((post.file_ids && post.file_ids.length > 0) || (post.filenames && post.filenames.length > 0)) && this.props.post.state !== Posts.POST_DELETED) {\n            fileAttachmentHolder = (\n                <FileAttachmentListContainer\n                    post={post}\n                    compactDisplay={this.props.compactDisplay}\n                />\n            );\n        }\n\n        if (this.state.sending) {\n            postClass += ' post-waiting';\n        }\n\n        const messageWrapper = (\n            <React.Fragment>\n                {failedOptions}\n                {this.state.sending && <LoadingSpinner/>}\n                <PostMessageView\n                    post={this.props.post}\n                    compactDisplay={this.props.compactDisplay}\n                    hasMention={true}\n                />\n            </React.Fragment>\n        );\n\n        const hasPlugin = (post.type && this.props.pluginPostTypes.hasOwnProperty(post.type)) ||\n            (post.props && post.props.type && this.props.pluginPostTypes.hasOwnProperty(post.props.type));\n\n        let messageWithAdditionalContent;\n        if (this.props.post.state === Posts.POST_DELETED || hasPlugin) {\n            messageWithAdditionalContent = messageWrapper;\n        } else {\n            messageWithAdditionalContent = (\n                <PostBodyAdditionalContent\n                    post={this.props.post}\n                    isEmbedVisible={this.props.isEmbedVisible}\n                >\n                    {messageWrapper}\n                </PostBodyAdditionalContent>\n            );\n        }\n\n        let mentionHighlightClass = '';\n        if (this.props.isCommentMention) {\n            mentionHighlightClass = 'mention-comment';\n        }\n\n        let ephemeralPostClass = '';\n        if (isEphemeral) {\n            ephemeralPostClass = 'post--ephemeral';\n        }\n\n        return (\n            <div>\n                {comment}\n                <div\n                    id={`${post.id}_message`}\n                    className={`post__body ${mentionHighlightClass} ${ephemeralPostClass} ${postClass}`}\n                >\n                    {messageWithAdditionalContent}\n                    {fileAttachmentHolder}\n                    <ReactionList\n                        post={post}\n                        isReadOnly={this.props.isReadOnly}\n                    />\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getPost} from 'mattermost-redux/selectors/entities/posts';\nimport {isCurrentChannelReadOnly, getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getUser} from 'mattermost-redux/selectors/entities/users';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport PostBody from './post_body.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    let parentPost;\n    let parentPostUser;\n    if (ownProps.post.root_id) {\n        parentPost = getPost(state, ownProps.post.root_id);\n        parentPostUser = parentPost ? getUser(state, parentPost.user_id) : null;\n    }\n\n    const config = getConfig(state);\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\n\n    const currentChannel = getCurrentChannel(state);\n    const channelIsArchived = currentChannel.delete_at !== 0;\n\n    return {\n        parentPost,\n        parentPostUser,\n        pluginPostTypes: state.plugins.postTypes,\n        enablePostUsernameOverride,\n        isReadOnly: isCurrentChannelReadOnly(state) || channelIsArchived,\n    };\n}\n\nexport default connect(mapStateToProps)(PostBody);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\nimport {Tooltip} from 'react-bootstrap';\n\nimport {Posts} from 'mattermost-redux/constants';\nimport * as ReduxPostUtils from 'mattermost-redux/utils/post_utils';\n\nimport * as PostUtils from 'utils/post_utils.jsx';\nimport * as Utils from 'utils/utils.jsx';\nimport Constants, {Locations} from 'utils/constants';\nimport CommentIcon from 'components/common/comment_icon';\nimport DotMenu from 'components/dot_menu';\nimport OverlayTrigger from 'components/overlay_trigger';\nimport PostFlagIcon from 'components/post_view/post_flag_icon';\nimport PostReaction from 'components/post_view/post_reaction';\nimport PostTime from 'components/post_view/post_time';\nimport InfoSmallIcon from 'components/widgets/icons/info_small_icon';\n\nexport default class PostInfo extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * The post to render the info for\n         */\n        post: PropTypes.object.isRequired,\n\n        /*\n         * The id of the team which belongs the post\n         */\n        teamId: PropTypes.string,\n\n        /*\n         * Function called when the comment icon is clicked\n         */\n        handleCommentClick: PropTypes.func.isRequired,\n\n        /*\n         * Function called when the card icon is clicked\n         */\n        handleCardClick: PropTypes.func.isRequired,\n\n        /*\n         * Funciton called when the post options dropdown is opened\n         */\n        handleDropdownOpened: PropTypes.func.isRequired,\n\n        /*\n         * Set to mark the post as flagged\n         */\n        isFlagged: PropTypes.bool,\n\n        /*\n         * Set to mark the post as open the extra info in the rhs\n         */\n        isCardOpen: PropTypes.bool,\n\n        /*\n         * The number of replies in the same thread as this post\n         */\n        replyCount: PropTypes.number,\n\n        /**\n         * Set to indicate that this is previous post was not a reply to the same thread\n         */\n        isFirstReply: PropTypes.bool,\n\n        /**\n         * Set to render in mobile view\n         */\n        isMobile: PropTypes.bool,\n\n        /**\n         * Set to render in compact view\n         */\n        compactDisplay: PropTypes.bool,\n\n        /**\n         * Set to mark post as being hovered over\n         */\n        hover: PropTypes.bool.isRequired,\n\n        /**\n         * Set to render the post time when not hovering\n         */\n        showTimeWithoutHover: PropTypes.bool.isRequired,\n\n        /**\n         * Whether to show the emoji picker.\n         */\n        enableEmojiPicker: PropTypes.bool.isRequired,\n\n        /**\n         * Set not to allow edits on post\n         */\n        isReadOnly: PropTypes.bool,\n\n        /**\n         * To check if the state of emoji for last message and from where it was emitted\n         */\n        shortcutReactToLastPostEmittedFrom: PropTypes.string,\n\n        /**\n         * To Check if the current post is last in the list\n         */\n        isLastPost: PropTypes.bool,\n\n        actions: PropTypes.shape({\n\n            /**\n             * Function to remove the post\n             */\n            removePost: PropTypes.func.isRequired,\n\n            /**\n             * Function to set or unset emoji picker for last message\n             */\n            emitShortcutReactToLastPostFrom: PropTypes.func\n        }).isRequired,\n\n        shouldShowDotMenu: PropTypes.bool.isRequired,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            showEmojiPicker: false,\n            showOptionsMenuWithoutHover: false\n        };\n\n        this.postHeaderRef = React.createRef();\n    }\n\n    toggleEmojiPicker = () => {\n        const showEmojiPicker = !this.state.showEmojiPicker;\n\n        this.setState({\n            showEmojiPicker,\n            showOptionsMenuWithoutHover: false\n        });\n        this.props.handleDropdownOpened(showEmojiPicker || this.state.showDotMenu);\n    };\n\n    removePost = () => {\n        this.props.actions.removePost(this.props.post);\n    };\n\n    createRemovePostButton = () => {\n        return (\n            <button\n                className='post__remove theme color--link style--none'\n                type='button'\n                onClick={this.removePost}\n            >\n                {''}\n            </button>\n        );\n    };\n\n    handleDotMenuOpened = (open) => {\n        this.setState({showDotMenu: open});\n        this.props.handleDropdownOpened(open || this.state.showEmojiPicker);\n    };\n\n    getDotMenu = () => {\n        return this.refs.dotMenu;\n    };\n\n    buildOptions = (post, isSystemMessage, fromAutoResponder) => {\n        if (!this.props.shouldShowDotMenu) {\n            return null;\n        }\n\n        const {isMobile, isReadOnly} = this.props;\n        const hover = this.props.hover || this.state.showEmojiPicker || this.state.showDotMenu || this.state.showOptionsMenuWithoutHover;\n\n        const showCommentIcon = fromAutoResponder ||\n        (!isSystemMessage && (isMobile || hover || (!post.root_id && Boolean(this.props.replyCount)) || this.props.isFirstReply));\n        const commentIconExtraClass = isMobile ? '' : 'pull-right';\n        let commentIcon;\n        if (showCommentIcon) {\n            commentIcon = (\n                <CommentIcon\n                    handleCommentClick={this.props.handleCommentClick}\n                    commentCount={this.props.replyCount}\n                    postId={post.id}\n                    extraClass={commentIconExtraClass}\n                />\n            );\n        }\n\n        const showReactionIcon = !isSystemMessage && hover && !isReadOnly && this.props.enableEmojiPicker;\n        let postReaction;\n        if (showReactionIcon) {\n            postReaction = (\n                <PostReaction\n                    channelId={post.channel_id}\n                    postId={post.id}\n                    teamId={this.props.teamId}\n                    getDotMenuRef={this.getDotMenu}\n                    showEmojiPicker={this.state.showEmojiPicker}\n                    toggleEmojiPicker={this.toggleEmojiPicker}\n                />\n            );\n        }\n\n        const showDotMenuIcon = isMobile || hover;\n        let dotMenu;\n        if (showDotMenuIcon) {\n            dotMenu = (\n                <DotMenu\n                    post={post}\n                    commentCount={this.props.replyCount}\n                    isFlagged={this.props.isFlagged}\n                    handleCommentClick={this.props.handleCommentClick}\n                    handleDropdownOpened={this.handleDotMenuOpened}\n                    handleAddReactionClick={this.toggleEmojiPicker}\n                    isReadOnly={isReadOnly}\n                    enableEmojiPicker={this.props.enableEmojiPicker}\n                />\n            );\n        }\n\n        return (\n            <div\n                ref='dotMenu'\n                data-testid={`post-menu-${post.id}`}\n                className={'col col__reply'}\n            >\n                {dotMenu}\n                {postReaction}\n                {commentIcon}\n            </div>\n        );\n    };\n\n    handleShortcutReactToLastPost = (isLastPost) => {\n        if (isLastPost) {\n            const {post, isReadOnly, enableEmojiPicker, isMobile,\n                actions: {emitShortcutReactToLastPostFrom}} = this.props;\n\n            // Setting the last message emoji action to empty to clean up the redux state\n            emitShortcutReactToLastPostFrom(Locations.NO_WHERE);\n\n            // Following are the types of posts on which adding reaction is not possible\n            const isDeletedPost = post && post.state === Posts.POST_DELETED;\n            const isEphemeralPost = post && Utils.isPostEphemeral(post);\n            const isSystemMessage = post && PostUtils.isSystemMessage(post);\n            const isAutoRespondersPost = post && PostUtils.fromAutoResponder(post);\n            const isFailedPost = post && post.failed;\n\n            // Checking if post is at scroll view of the user\n            const boundingRectOfPostInfo = this.postHeaderRef.current.getBoundingClientRect();\n            const isPostHeaderVisibleToUser = (boundingRectOfPostInfo.top - 65) > 0 &&\n                boundingRectOfPostInfo.bottom < (window.innerHeight - 85);\n\n            if (isPostHeaderVisibleToUser && !isEphemeralPost && !isSystemMessage && !isAutoRespondersPost &&\n                    !isFailedPost && !isDeletedPost && !isReadOnly && !isMobile && enableEmojiPicker) {\n                this.setState({\n                    showOptionsMenuWithoutHover: true\n                }, () => {\n                    this.toggleEmojiPicker();\n                });\n            }\n        }\n    }\n\n    componentDidUpdate(prevProps) {\n        const {shortcutReactToLastPostEmittedFrom, isLastPost} = this.props;\n\n        const shortcutReactToLastPostEmittedFromCenter = prevProps.shortcutReactToLastPostEmittedFrom !== shortcutReactToLastPostEmittedFrom &&\n        shortcutReactToLastPostEmittedFrom === Locations.CENTER;\n        if (shortcutReactToLastPostEmittedFromCenter) {\n            this.handleShortcutReactToLastPost(isLastPost);\n        }\n    }\n\n    render() {\n        const post = this.props.post;\n\n        const isEphemeral = Utils.isPostEphemeral(post);\n        const isSystemMessage = PostUtils.isSystemMessage(post);\n        const fromAutoResponder = PostUtils.fromAutoResponder(post);\n\n        const showFlagIcon = !isEphemeral && !post.failed && !isSystemMessage && (this.props.hover || this.props.isFlagged);\n        let postFlagIcon;\n        if (showFlagIcon) {\n            postFlagIcon = (\n                <PostFlagIcon\n                    postId={post.id}\n                    isFlagged={this.props.isFlagged}\n                    isEphemeral={isEphemeral}\n                />\n            );\n        }\n\n        let postInfoIcon;\n        if (post.props && post.props.card) {\n            postInfoIcon = (\n                <OverlayTrigger\n                    delayShow={Constants.OVERLAY_TIME_DELAY}\n                    placement='top'\n                    overlay={\n                        <Tooltip>\n                            <FormattedMessage\n                                id='post_info.info.view_additional_info'\n                                defaultMessage='View additional info'\n                            />\n                        </Tooltip>\n                    }\n                >\n                    <button\n                        className={'card-icon__container icon--show style--none ' + (this.props.isCardOpen ? 'active' : '')}\n                        onClick={(e) => {\n                            e.preventDefault();\n                            this.props.handleCardClick(this.props.post);\n                        }}\n                    >\n                        <InfoSmallIcon\n                            className='icon icon__info'\n                            aria-hidden='true'\n                        />\n                    </button>\n                </OverlayTrigger>\n            );\n        }\n\n        let options;\n        if (isEphemeral) {\n            options = (\n                <div className='col col__remove'>\n                    {this.createRemovePostButton()}\n                </div>\n            );\n        } else if (!post.failed) {\n            options = this.buildOptions(post, isSystemMessage, fromAutoResponder);\n        }\n\n        let visibleMessage;\n        if (isEphemeral && !this.props.compactDisplay && post.state !== Posts.POST_DELETED) {\n            visibleMessage = (\n                <span className='post__visibility'>\n                    <FormattedMessage\n                        id='post_info.message.visible'\n                        defaultMessage='(Only visible to you)'\n                    />\n                </span>\n            );\n        }\n\n        let pinnedBadge;\n        if (post.is_pinned) {\n            pinnedBadge = (\n                <span className='post__pinned-badge'>\n                    <FormattedMessage\n                        id='post_info.pinned'\n                        defaultMessage='Pinned'\n                    />\n                </span>\n            );\n        }\n\n        const showPostTime = this.props.hover || this.props.showTimeWithoutHover;\n        let postTime;\n        if (showPostTime) {\n            // timestamp should not be a permalink if the post has been deleted, is ephemeral message, is pending, or is combined activity\n            const isPermalink = !(isEphemeral || Posts.POST_DELETED === post.state || ReduxPostUtils.isPostPendingOrFailed(post) || post.type === Posts.POST_TYPES.COMBINED_USER_ACTIVITY);\n\n            postTime = (\n                <PostTime\n                    isPermalink={isPermalink}\n                    eventTime={post.create_at}\n                    postId={post.id}\n                />\n            );\n        }\n\n        return (\n            <div\n                className='post__header--info'\n                ref={this.postHeaderRef}\n            >\n                <div className='col'>\n                    {postTime}\n                    {pinnedBadge}\n                    {postInfoIcon}\n                    {postFlagIcon}\n                    {visibleMessage}\n                </div>\n                {options}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {removePost} from 'mattermost-redux/actions/posts';\nimport {isCurrentChannelReadOnly} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\nimport {get} from 'mattermost-redux/selectors/entities/preferences';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\n\nimport {emitShortcutReactToLastPostFrom} from 'actions/post_actions.jsx';\nimport {Preferences} from 'utils/constants';\nimport * as PostUtils from 'utils/post_utils.jsx';\nimport {getSelectedPostCard} from 'selectors/rhs.jsx';\nimport {getShortcutReactToLastPostEmittedFrom} from 'selectors/emojis';\n\nimport PostInfo from './post_info.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    const selectedCard = getSelectedPostCard(state);\n    const config = getConfig(state);\n    const channel = state.entities.channels.channels[ownProps.post.channel_id];\n    const channelIsArchived = channel ? channel.delete_at !== 0 : null;\n    const enableEmojiPicker = config.EnableEmojiPicker === 'true' && !channelIsArchived;\n    const teamId = getCurrentTeamId(state);\n    const shortcutReactToLastPostEmittedFrom = getShortcutReactToLastPostEmittedFrom(state);\n\n    return {\n        teamId,\n        isFlagged: get(state, Preferences.CATEGORY_FLAGGED_POST, ownProps.post.id, null) != null,\n        isMobile: state.views.channel.mobileView,\n        isCardOpen: selectedCard && selectedCard.id === ownProps.post.id,\n        enableEmojiPicker,\n        isReadOnly: isCurrentChannelReadOnly(state) || channelIsArchived,\n        shouldShowDotMenu: PostUtils.shouldShowDotMenu(state, ownProps.post, channel),\n        shortcutReactToLastPostEmittedFrom\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            removePost,\n            emitShortcutReactToLastPostFrom,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PostInfo);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport Constants from 'utils/constants';\nimport * as PostUtils from 'utils/post_utils.jsx';\nimport PostInfo from 'components/post_view/post_info';\nimport UserProfile from 'components/user_profile';\nimport BotBadge from 'components/widgets/badges/bot_badge';\nimport Badge from 'components/widgets/badges/badge';\n\nexport default class PostHeader extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * The post to render the header for\n         */\n        post: PropTypes.object.isRequired,\n\n        /*\n         * Function called when the comment icon is clicked\n         */\n        handleCommentClick: PropTypes.func.isRequired,\n\n        /*\n         * Function called when the card icon is clicked\n         */\n        handleCardClick: PropTypes.func.isRequired,\n\n        /*\n         * Function called when the post options dropdown is opened\n         */\n        handleDropdownOpened: PropTypes.func.isRequired,\n\n        /*\n         * Set to render compactly\n         */\n        compactDisplay: PropTypes.bool,\n\n        /*\n         * The number of replies in the same thread as this post\n         */\n        replyCount: PropTypes.number,\n\n        /**\n         * Set to indicate that this is previous post was not a reply to the same thread\n         */\n        isFirstReply: PropTypes.bool,\n\n        /**\n         * Set to mark post as being hovered over\n         */\n        hover: PropTypes.bool.isRequired,\n\n        /*\n         * Set to render the post time when not hovering\n         */\n        showTimeWithoutHover: PropTypes.bool,\n\n        /**\n         * Whether or not the post username can be overridden.\n         */\n        enablePostUsernameOverride: PropTypes.bool.isRequired,\n\n        /**\n         * If the user that made the post is a bot.\n         */\n        isBot: PropTypes.bool.isRequired,\n\n        /**\n         * If the user that made the post is a guest.\n         */\n        isGuest: PropTypes.bool.isRequired,\n\n        /**\n         * To Check if the current post is last in the list\n         */\n        isLastPost: PropTypes.bool,\n\n    }\n\n    render() {\n        const {post} = this.props;\n        const isSystemMessage = PostUtils.isSystemMessage(post);\n        const fromAutoResponder = PostUtils.fromAutoResponder(post);\n        const fromWebhook = post && post.props && post.props.from_webhook === 'true';\n\n        let userProfile = (\n            <UserProfile\n                userId={post.user_id}\n                hasMention={true}\n            />\n        );\n        let indicator;\n        let colon;\n\n        if (fromWebhook && !this.props.isBot) {\n            if (post.props.override_username && this.props.enablePostUsernameOverride) {\n                userProfile = (\n                    <UserProfile\n                        userId={post.user_id}\n                        hideStatus={true}\n                        overwriteName={post.props.override_username}\n                    />\n                );\n            } else {\n                userProfile = (\n                    <UserProfile\n                        userId={post.user_id}\n                        hideStatus={true}\n                    />\n                );\n            }\n\n            indicator = (<BotBadge/>);\n        } else if (fromAutoResponder) {\n            userProfile = (\n                <UserProfile\n                    userId={post.user_id}\n                    hideStatus={true}\n                    hasMention={true}\n                />\n            );\n\n            indicator = (\n                <Badge>\n                    <FormattedMessage\n                        id='post_info.auto_responder'\n                        defaultMessage='AUTOMATIC REPLY'\n                    />\n                </Badge>\n            );\n        } else if (isSystemMessage && this.props.isBot) {\n            userProfile = (\n                <UserProfile\n                    userId={post.user_id}\n                    hideStatus={true}\n                />\n            );\n        } else if (isSystemMessage) {\n            userProfile = (\n                <UserProfile\n                    overwriteName={\n                        <FormattedMessage\n                            id='post_info.system'\n                            defaultMessage='System'\n                        />\n                    }\n                    overwriteImage={Constants.SYSTEM_MESSAGE_PROFILE_IMAGE}\n                    disablePopover={true}\n                />\n            );\n        }\n\n        if (this.props.compactDisplay) {\n            colon = (<strong className='colon'>{':'}</strong>);\n        }\n\n        return (\n            <div className='post__header'>\n                <div className='col col__name'>\n                    {userProfile}\n                    {colon}\n                    {indicator}\n                </div>\n                <div className='col'>\n                    <PostInfo\n                        post={post}\n                        handleCommentClick={this.props.handleCommentClick}\n                        handleCardClick={this.props.handleCardClick}\n                        handleDropdownOpened={this.props.handleDropdownOpened}\n                        compactDisplay={this.props.compactDisplay}\n                        replyCount={this.props.replyCount}\n                        isFirstReply={this.props.isFirstReply}\n                        showTimeWithoutHover={this.props.showTimeWithoutHover}\n                        hover={this.props.hover}\n                        isLastPost={this.props.isLastPost}\n                    />\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getUser} from 'mattermost-redux/selectors/entities/users';\n\nimport {isGuest} from 'utils/utils.jsx';\n\nimport PostHeader from './post_header.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    const config = getConfig(state);\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\n    const user = getUser(state, ownProps.post.user_id);\n    const isBot = Boolean(user && user.is_bot);\n\n    return {\n        enablePostUsernameOverride,\n        isBot,\n        isGuest: Boolean(user && isGuest(user)),\n    };\n}\n\nexport default connect(mapStateToProps)(PostHeader);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {injectIntl} from 'react-intl';\n\nimport {Posts} from 'mattermost-redux/constants';\nimport {isMeMessage as checkIsMeMessage} from 'mattermost-redux/utils/post_utils';\n\nimport * as PostUtils from 'utils/post_utils.jsx';\nimport Constants, {A11yCustomEventTypes} from 'utils/constants';\nimport {intlShape} from 'utils/react_intl';\nimport PostProfilePicture from 'components/post_profile_picture';\nimport PostBody from 'components/post_view/post_body';\nimport PostHeader from 'components/post_view/post_header';\nimport PostContext from 'components/post_view/post_context';\n\nclass Post extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * The post to render\n         */\n        post: PropTypes.object.isRequired,\n\n        /**\n         * The function to create an aria-label\n         */\n        createAriaLabel: PropTypes.func.isRequired,\n\n        /**\n         * The logged in user ID\n         */\n        currentUserId: PropTypes.string.isRequired,\n\n        /**\n         * Set to center the post\n         */\n        center: PropTypes.bool,\n\n        /**\n         * Set to render post compactly\n         */\n        compactDisplay: PropTypes.bool,\n\n        /**\n         * Set to render a preview of the parent post above this reply\n         */\n        isFirstReply: PropTypes.bool,\n\n        /**\n         * Set to highlight the background of the post\n         */\n        shouldHighlight: PropTypes.bool,\n\n        /**\n         * Set to render this post as if it was attached to the previous post\n         */\n        consecutivePostByUser: PropTypes.bool,\n\n        /**\n         * Set if the previous post is a comment\n         */\n        previousPostIsComment: PropTypes.bool,\n\n        /*\n         * Function called when the post options dropdown is opened\n         */\n        togglePostMenu: PropTypes.func,\n\n        /**\n         * Set to render this comment as a mention\n         */\n        isCommentMention: PropTypes.bool,\n\n        /**\n         * The number of replies in the same thread as this post\n         */\n        replyCount: PropTypes.number,\n\n        /**\n         * To Check if the current post is last in the list\n         */\n        isLastPost: PropTypes.bool,\n\n        /**\n         * Whether or not the channel that contains this post is archived\n         */\n        channelIsArchived: PropTypes.bool.isRequired,\n\n        intl: intlShape.isRequired,\n        actions: PropTypes.shape({\n            selectPost: PropTypes.func.isRequired,\n            selectPostCard: PropTypes.func.isRequired,\n            markPostAsUnread: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    static defaultProps = {\n        post: {},\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.postRef = React.createRef();\n\n        this.state = {\n            dropdownOpened: false,\n            hover: false,\n            alt: false,\n            a11yActive: false,\n            currentAriaLabel: '',\n            ariaHidden: true,\n            fadeOutHighlight: false,\n        };\n    }\n\n    componentDidMount() {\n        document.addEventListener('keydown', this.handleAlt);\n        document.addEventListener('keyup', this.handleAlt);\n\n        // Refs can be null when this component is shallowly rendered for testing\n        if (this.postRef.current) {\n            this.postRef.current.addEventListener(A11yCustomEventTypes.ACTIVATE, this.handleA11yActivateEvent);\n            this.postRef.current.addEventListener(A11yCustomEventTypes.DEACTIVATE, this.handleA11yDeactivateEvent);\n        }\n\n        if (this.props.shouldHighlight) {\n            this.highlightTimeout = setTimeout(() => {\n                this.setState({fadeOutHighlight: true});\n            }, Constants.PERMALINK_FADEOUT);\n        }\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleAlt);\n        document.removeEventListener('keyup', this.handleAlt);\n\n        if (this.postRef.current) {\n            this.postRef.current.removeEventListener(A11yCustomEventTypes.ACTIVATE, this.handleA11yActivateEvent);\n            this.postRef.current.removeEventListener(A11yCustomEventTypes.DEACTIVATE, this.handleA11yDeactivateEvent);\n        }\n\n        clearTimeout(this.highlightTimeout);\n    }\n\n    componentDidUpdate() {\n        if (this.state.a11yActive) {\n            this.postRef.current.dispatchEvent(new Event(A11yCustomEventTypes.UPDATE));\n        }\n    }\n\n    handleCommentClick = (e) => {\n        e.preventDefault();\n\n        const post = this.props.post;\n        if (!post) {\n            return;\n        }\n        this.props.actions.selectPost(post);\n    }\n\n    handleCardClick = (post) => {\n        if (!post) {\n            return;\n        }\n        this.props.actions.selectPostCard(post);\n    }\n\n    handlePostClick = (e) => {\n        const post = this.props.post;\n        if (!post) {\n            return;\n        }\n\n        if (this.props.channelIsArchived || post.system_post_ids) {\n            return;\n        }\n\n        if (e.altKey) {\n            this.props.actions.markPostAsUnread(post);\n        }\n    }\n\n    handleDropdownOpened = (opened) => {\n        if (this.props.togglePostMenu) {\n            this.props.togglePostMenu(opened);\n        }\n\n        this.setState({\n            dropdownOpened: opened,\n        });\n    }\n\n    hasSameRoot = (props) => {\n        const post = props.post;\n\n        if (props.isFirstReply) {\n            return false;\n        } else if (!post.root_id && !props.previousPostIsComment && props.consecutivePostByUser) {\n            return true;\n        } else if (post.root_id) {\n            return true;\n        }\n\n        return false;\n    }\n\n    getClassName = (post, isSystemMessage, isMeMessage, fromWebhook, fromAutoResponder, fromBot) => {\n        let className = 'post';\n\n        if (post.failed || post.state === Posts.POST_DELETED) {\n            className += ' post--hide-controls';\n        }\n\n        if (!this.state.fadeOutHighlight && this.props.shouldHighlight) {\n            className += ' post--highlight';\n        }\n\n        let rootUser = '';\n        if (this.hasSameRoot(this.props) && !fromBot) {\n            rootUser = 'same--root';\n        } else {\n            rootUser = 'other--root';\n        }\n\n        let currentUserCss = '';\n        if (this.props.currentUserId === post.user_id && !fromWebhook && !isSystemMessage) {\n            currentUserCss = 'current--user';\n        }\n\n        let sameUserClass = '';\n        if (this.props.consecutivePostByUser) {\n            sameUserClass = 'same--user';\n        }\n\n        let postType = '';\n        if (post.root_id && post.root_id.length > 0) {\n            postType = 'post--comment';\n        } else if (this.props.replyCount > 0) {\n            postType = 'post--root';\n            sameUserClass = '';\n            rootUser = '';\n        }\n\n        if (isSystemMessage || isMeMessage) {\n            className += ' post--system';\n            if (isSystemMessage) {\n                currentUserCss = '';\n                postType = '';\n                rootUser = '';\n            }\n        }\n\n        if (fromAutoResponder) {\n            postType = 'post--comment same--root';\n        }\n\n        if (this.props.compactDisplay) {\n            className += ' post--compact';\n        }\n\n        if (this.state.dropdownOpened || this.state.a11yActive) {\n            className += ' post--hovered';\n        }\n\n        if (post.is_pinned) {\n            className += ' post--pinned';\n        }\n\n        if (this.state.alt && !(this.props.channelIsArchived || post.system_post_ids)) {\n            className += ' cursor--pointer';\n        }\n\n        return className + ' ' + sameUserClass + ' ' + rootUser + ' ' + postType + ' ' + currentUserCss;\n    }\n\n    setHover = () => {\n        this.setState({hover: true});\n    }\n\n    unsetHover = () => {\n        this.setState({hover: false});\n    }\n\n    handleAlt = (e) => {\n        if (this.state.alt !== e.altKey) {\n            this.setState({alt: e.altKey});\n        }\n    }\n\n    handleA11yActivateEvent = () => {\n        this.setState({\n            a11yActive: true,\n            ariaHidden: false,\n        });\n    }\n\n    handleA11yDeactivateEvent = () => {\n        this.setState({\n            a11yActive: false,\n            ariaHidden: true,\n        });\n    }\n\n    handlePostFocus = () => {\n        this.setState({currentAriaLabel: this.props.createAriaLabel(this.props.intl)});\n    }\n\n    render() {\n        const {post} = this.props;\n        if (!post.id) {\n            return null;\n        }\n\n        const isSystemMessage = PostUtils.isSystemMessage(post);\n        const isMeMessage = checkIsMeMessage(post);\n        const fromAutoResponder = PostUtils.fromAutoResponder(post);\n        const fromWebhook = post && post.props && post.props.from_webhook === 'true';\n        const fromBot = post && post.props && post.props.from_bot === 'true';\n\n        let profilePic;\n        const hideProfilePicture = this.hasSameRoot(this.props) && this.props.consecutivePostByUser && (!post.root_id && this.props.replyCount === 0) && !fromBot;\n        if (!hideProfilePicture) {\n            profilePic = (\n                <PostProfilePicture\n                    compactDisplay={this.props.compactDisplay}\n                    post={post}\n                    userId={post.user_id}\n                />\n            );\n\n            if (fromAutoResponder) {\n                profilePic = (\n                    <span className='auto-responder'>\n                        {profilePic}\n                    </span>\n                );\n            }\n        }\n\n        let centerClass = '';\n        if (this.props.center) {\n            centerClass = 'center';\n        }\n\n        return (\n            <PostContext.Provider value={{handlePopupOpened: this.handleDropdownOpened}}>\n                <div\n                    ref={this.postRef}\n                    id={'post_' + post.id}\n                    data-testid='postView'\n                    role='listitem'\n                    className={`a11y__section ${this.getClassName(post, isSystemMessage, isMeMessage, fromWebhook, fromAutoResponder, fromBot)}`}\n                    tabIndex='0'\n                    onFocus={this.handlePostFocus}\n                    onBlur={this.removeFocus}\n                    onMouseOver={this.setHover}\n                    onMouseLeave={this.unsetHover}\n                    onTouchStart={this.setHover}\n                    onClick={this.handlePostClick}\n                    aria-label={this.state.currentAriaLabel}\n                    aria-atomic={true}\n                >\n                    <div\n                        role='application'\n                        data-testid='postContent'\n                        className={'post__content ' + centerClass}\n                        aria-hidden={this.state.ariaHidden}\n                    >\n                        <div className='post__img'>\n                            {profilePic}\n                        </div>\n                        <div>\n                            <PostHeader\n                                post={post}\n                                handleCommentClick={this.handleCommentClick}\n                                handleCardClick={this.handleCardClick}\n                                handleDropdownOpened={this.handleDropdownOpened}\n                                compactDisplay={this.props.compactDisplay}\n                                isFirstReply={this.props.isFirstReply}\n                                replyCount={this.props.replyCount}\n                                showTimeWithoutHover={!hideProfilePicture}\n                                hover={this.state.hover || this.state.a11yActive}\n                                isLastPost={this.props.isLastPost}\n                            />\n                            <PostBody\n                                post={post}\n                                handleCommentClick={this.handleCommentClick}\n                                compactDisplay={this.props.compactDisplay}\n                                isCommentMention={this.props.isCommentMention}\n                                isFirstReply={this.props.isFirstReply}\n                            />\n                        </div>\n                    </div>\n                </div>\n            </PostContext.Provider>\n        );\n    }\n}\n\nexport default injectIntl(Post);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {Posts} from 'mattermost-redux/constants';\nimport {getChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getPost, makeIsPostCommentMention} from 'mattermost-redux/selectors/entities/posts';\nimport {get} from 'mattermost-redux/selectors/entities/preferences';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {isSystemMessage} from 'mattermost-redux/utils/post_utils';\n\nimport {markPostAsUnread} from 'actions/post_actions';\nimport {selectPost, selectPostCard} from 'actions/views/rhs';\n\nimport {isArchivedChannel} from 'utils/channel_utils';\nimport {Preferences} from 'utils/constants';\nimport {makeCreateAriaLabelForPost, makeGetReplyCount} from 'utils/post_utils.jsx';\n\nimport Post from './post.jsx';\n\n// isFirstReply returns true when the given post a comment that isn't part of the same thread as the previous post.\nexport function isFirstReply(post, previousPost) {\n    if (post.root_id) {\n        if (previousPost) {\n            // Returns true as long as the previous post is part of a different thread\n            return post.root_id !== previousPost.id && post.root_id !== previousPost.root_id;\n        }\n\n        // The previous post is not a real post\n        return true;\n    }\n\n    // This post is not a reply\n    return false;\n}\n\nfunction makeMapStateToProps() {\n    const getReplyCount = makeGetReplyCount();\n    const isPostCommentMention = makeIsPostCommentMention();\n    const createAriaLabelForPost = makeCreateAriaLabelForPost();\n\n    return (state, ownProps) => {\n        const post = ownProps.post || getPost(state, ownProps.postId);\n        const channel = getChannel(state, post.channel_id);\n\n        let previousPost = null;\n        if (ownProps.previousPostId) {\n            previousPost = getPost(state, ownProps.previousPostId);\n        }\n\n        let consecutivePostByUser = false;\n        let previousPostIsComment = false;\n\n        if (previousPost) {\n            consecutivePostByUser = post.user_id === previousPost.user_id && // The post is by the same user\n                post.create_at - previousPost.create_at <= Posts.POST_COLLAPSE_TIMEOUT && // And was within a short time period\n                !(post.props && post.props.from_webhook) && !(previousPost.props && previousPost.props.from_webhook) && // And neither is from a webhook\n                !isSystemMessage(post) && !isSystemMessage(previousPost); // And neither is a system message\n\n            previousPostIsComment = Boolean(previousPost.root_id);\n        }\n\n        return {\n            post,\n            createAriaLabel: createAriaLabelForPost(state, post),\n            currentUserId: getCurrentUserId(state),\n            isFirstReply: isFirstReply(post, previousPost),\n            consecutivePostByUser,\n            previousPostIsComment,\n            replyCount: getReplyCount(state, post),\n            isCommentMention: isPostCommentMention(state, post.id),\n            center: get(state, Preferences.CATEGORY_DISPLAY_SETTINGS, Preferences.CHANNEL_DISPLAY_MODE, Preferences.CHANNEL_DISPLAY_MODE_DEFAULT) === Preferences.CHANNEL_DISPLAY_MODE_CENTERED,\n            compactDisplay: get(state, Preferences.CATEGORY_DISPLAY_SETTINGS, Preferences.MESSAGE_DISPLAY, Preferences.MESSAGE_DISPLAY_DEFAULT) === Preferences.MESSAGE_DISPLAY_COMPACT,\n            channelIsArchived: isArchivedChannel(channel),\n        };\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            selectPost,\n            selectPostCard,\n            markPostAsUnread,\n        }, dispatch),\n    };\n}\n\nexport default connect(makeMapStateToProps, mapDispatchToProps)(Post);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {makeGenerateCombinedPost} from 'mattermost-redux/utils/post_list';\n\nimport Post from 'components/post_view/post';\n\nexport function makeMapStateToProps() {\n    const generateCombinedPost = makeGenerateCombinedPost();\n\n    return (state, ownProps) => {\n        return {\n            post: generateCombinedPost(state, ownProps.combinedId),\n            postId: ownProps.combinedId,\n        };\n    };\n}\n\n// Note that this also passes through Post's mapStateToProps\nexport default connect(makeMapStateToProps)(Post);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport './separator.scss';\nimport './notification-separator.scss';\n\nexport default class NotificationSeparator extends React.PureComponent<React.PropsWithChildren<{}>> {\n    public render() {\n        const {children} = this.props;\n        return (\n            <div\n                className='Separator NotificationSeparator'\n                data-testid='NotificationSeparator'\n            >\n                <hr className='separator__hr'/>\n                {children && (\n                    <div className='separator__text'>\n                        {children}\n                    </div>\n                )}\n            </div>\n        );\n    }\n}\n\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport NotificationSeparator from 'components/widgets/separator/notification-separator';\n\nexport default class NewMessageSeparator extends React.PureComponent {\n    static propTypes = {\n        separatorId: PropTypes.string.isRequired,\n    }\n\n    render() {\n        return (\n            <NotificationSeparator id={this.props.separatorId}>\n                <FormattedMessage\n                    id='posts_view.newMsg'\n                    defaultMessage='New Messages'\n                />\n\n            </NotificationSeparator>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedDate, FormattedMessage} from 'react-intl';\nimport PropTypes from 'prop-types';\n\nimport {Permissions} from 'mattermost-redux/constants';\n\nimport {Constants, ModalIdentifiers} from 'utils/constants';\nimport ChannelInviteModal from 'components/channel_invite_modal';\nimport EditChannelHeaderModal from 'components/edit_channel_header_modal';\nimport ProfilePicture from 'components/profile_picture';\nimport ToggleModalButtonRedux from 'components/toggle_modal_button_redux';\nimport ToggleModalButton from 'components/toggle_modal_button.jsx';\nimport UserProfile from 'components/user_profile';\nimport ChannelPermissionGate from 'components/permissions_gates/channel_permission_gate';\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\nimport EditIcon from 'components/widgets/icons/fa_edit_icon';\nimport InvitationModal from 'components/invitation_modal';\nimport AddGroupsToChannelModal from 'components/add_groups_to_channel_modal';\nimport AddGroupsToTeamModal from 'components/add_groups_to_team_modal';\n\nimport {getMonthLong} from 'utils/i18n.jsx';\nimport * as Utils from 'utils/utils.jsx';\n\nexport default class ChannelIntroMessage extends React.PureComponent {\n    static propTypes = {\n        currentUserId: PropTypes.string.isRequired,\n        channel: PropTypes.object.isRequired,\n        fullWidth: PropTypes.bool.isRequired,\n        locale: PropTypes.string.isRequired,\n        channelProfiles: PropTypes.array.isRequired,\n        enableUserCreation: PropTypes.bool,\n        isReadOnly: PropTypes.bool,\n        teamIsGroupConstrained: PropTypes.bool,\n        creatorName: PropTypes.string.isRequired,\n        teammate: PropTypes.object.isRequired,\n        teammateName: PropTypes.string,\n    };\n\n    render() {\n        const {\n            currentUserId,\n            channel,\n            creatorName,\n            fullWidth,\n            locale,\n            enableUserCreation,\n            isReadOnly,\n            channelProfiles,\n            teamIsGroupConstrained,\n            teammate,\n            teammateName,\n        } = this.props;\n\n        let centeredIntro = '';\n        if (!fullWidth) {\n            centeredIntro = 'channel-intro--centered';\n        }\n\n        if (channel.type === Constants.DM_CHANNEL) {\n            return createDMIntroMessage(channel, centeredIntro, teammate, teammateName);\n        } else if (channel.type === Constants.GM_CHANNEL) {\n            return createGMIntroMessage(channel, centeredIntro, channelProfiles, currentUserId);\n        } else if (channel.name === Constants.DEFAULT_CHANNEL) {\n            return createDefaultIntroMessage(channel, centeredIntro, enableUserCreation, isReadOnly, teamIsGroupConstrained);\n        } else if (channel.name === Constants.OFFTOPIC_CHANNEL) {\n            return createOffTopicIntroMessage(channel, centeredIntro);\n        } else if (channel.type === Constants.OPEN_CHANNEL || channel.type === Constants.PRIVATE_CHANNEL) {\n            return createStandardIntroMessage(channel, centeredIntro, locale, creatorName);\n        }\n        return null;\n    }\n}\n\nfunction createGMIntroMessage(channel, centeredIntro, profiles, currentUserId) {\n    const channelIntroId = 'channelIntro';\n\n    if (profiles.length > 0) {\n        const pictures = profiles.\n            filter((profile) => profile.id !== currentUserId).\n            map((profile) => (\n                <ProfilePicture\n                    key={'introprofilepicture' + profile.id}\n                    src={Utils.imageURLForUser(profile.id, profile.last_picture_update)}\n                    size='xl'\n                    userId={profile.id}\n                    username={profile.username}\n                />\n            ));\n\n        return (\n            <div\n                id={channelIntroId}\n                className={'channel-intro ' + centeredIntro}\n            >\n                <div className='post-profile-img__container channel-intro-img'>\n                    {pictures}\n                </div>\n                <p className='channel-intro-text'>\n                    <FormattedMarkdownMessage\n                        id='intro_messages.GM'\n                        defaultMessage='This is the start of your group message history with {names}.\\nMessages and files shared here are not shown to people outside this area.'\n                        values={{\n                            names: channel.display_name,\n                        }}\n                    />\n                </p>\n                {createSetHeaderButton(channel)}\n            </div>\n        );\n    }\n\n    return (\n        <div\n            id={channelIntroId}\n            className={'channel-intro ' + centeredIntro}\n        >\n            <p className='channel-intro-text'>\n                <FormattedMessage\n                    id='intro_messages.group_message'\n                    defaultMessage='This is the start of your group message history with these teammates. Messages and files shared here are not shown to people outside this area.'\n                />\n            </p>\n        </div>\n    );\n}\n\nfunction createDMIntroMessage(channel, centeredIntro, teammate, teammateName) {\n    const channelIntroId = 'channelIntro';\n    if (teammate) {\n        return (\n            <div\n                id={channelIntroId}\n                className={'channel-intro ' + centeredIntro}\n            >\n                <div className='post-profile-img__container channel-intro-img'>\n                    <ProfilePicture\n                        src={Utils.imageURLForUser(teammate.id, teammate.last_picture_update)}\n                        size='xl'\n                        userId={teammate.id}\n                        username={teammate.username}\n                        hasMention={true}\n                    />\n                </div>\n                <div className='channel-intro-profile d-flex'>\n                    <UserProfile\n                        userId={teammate.id}\n                        disablePopover={false}\n                        hasMention={true}\n                    />\n                </div>\n                <p className='channel-intro-text'>\n                    <FormattedMarkdownMessage\n                        id='intro_messages.DM'\n                        defaultMessage='This is the start of your direct message history with {teammate}.\\nDirect messages and files shared here are not shown to people outside this area.'\n                        values={{\n                            teammate: teammateName,\n                        }}\n                    />\n                </p>\n                {teammate.is_bot ? null : createSetHeaderButton(channel)}\n            </div>\n        );\n    }\n\n    return (\n        <div\n            id={channelIntroId}\n            className={'channel-intro ' + centeredIntro}\n        >\n            <p className='channel-intro-text'>\n                <FormattedMessage\n                    id='intro_messages.teammate'\n                    defaultMessage='This is the start of your direct message history with this teammate. Direct messages and files shared here are not shown to people outside this area.'\n                />\n            </p>\n        </div>\n    );\n}\n\nfunction createOffTopicIntroMessage(channel, centeredIntro) {\n    const isPrivate = channel.type === Constants.PRIVATE_CHANNEL;\n    const children = createSetHeaderButton(channel);\n    let setHeaderButton = null;\n    if (children) {\n        setHeaderButton = (\n            <ChannelPermissionGate\n                teamId={channel.team_id}\n                channelId={channel.id}\n                permissions={[isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES : Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES]}\n            >\n                {children}\n            </ChannelPermissionGate>\n        );\n    }\n\n    const channelInviteButton = createInviteChannelButton(channel);\n\n    return (\n        <div\n            id='channelIntro'\n            className={'channel-intro ' + centeredIntro}\n        >\n            <h2 className='channel-intro__title'>\n                <FormattedMessage\n                    id='intro_messages.beginning'\n                    defaultMessage='Beginning of {name}'\n                    values={{\n                        name: channel.display_name,\n                    }}\n                />\n            </h2>\n            <p className='channel-intro__content'>\n                <FormattedMessage\n                    id='intro_messages.offTopic'\n                    defaultMessage='This is the start of {display_name}, a channel for non-work-related conversations.'\n                    values={{\n                        display_name: channel.display_name,\n                    }}\n                />\n            </p>\n            {channelInviteButton}\n            {setHeaderButton}\n        </div>\n    );\n}\n\nexport function createDefaultIntroMessage(channel, centeredIntro, enableUserCreation, isReadOnly, teamIsGroupConstrained) {\n    let teamInviteLink = null;\n\n    if (!isReadOnly && enableUserCreation) {\n        teamInviteLink = (\n            <TeamPermissionGate\n                teamId={channel.team_id}\n                permissions={[Permissions.INVITE_USER]}\n            >\n                <TeamPermissionGate\n                    teamId={channel.team_id}\n                    permissions={[Permissions.ADD_USER_TO_TEAM]}\n                >\n                    {!teamIsGroupConstrained &&\n                    <FormattedMessage\n                        id='intro_messages.inviteOthers'\n                        defaultMessage='Invite others to this team'\n                    >\n                        {(message) => (\n                            <ToggleModalButtonRedux\n                                accessibilityLabel={message}\n                                id='introTextInvite'\n                                className='intro-links color--link cursor--pointer'\n                                modalId={ModalIdentifiers.INVITATION}\n                                dialogType={InvitationModal}\n                            >\n                                <FormattedMessage\n                                    id='generic_icons.add'\n                                    defaultMessage='Add Icon'\n                                >\n                                    {(title) => (\n                                        <i\n                                            className='fa fa-user-plus'\n                                            title={title}\n                                        />\n                                    )}\n                                </FormattedMessage>\n                                {message}\n                            </ToggleModalButtonRedux>\n                        )}\n                    </FormattedMessage>\n                    }\n                    {teamIsGroupConstrained &&\n                    <ToggleModalButton\n                        className='intro-links color--link'\n                        dialogType={AddGroupsToTeamModal}\n                        dialogProps={{channel}}\n                    >\n                        <FormattedMessage\n                            id='generic_icons.add'\n                            defaultMessage='Add Icon'\n                        >\n                            {(title) => (\n                                <i\n                                    className='fa fa-user-plus'\n                                    title={title}\n                                />\n                            )}\n                        </FormattedMessage>\n                        <FormattedMessage\n                            id='intro_messages.addGroupsToTeam'\n                            defaultMessage='Add other groups to this team'\n                        />\n                    </ToggleModalButton>\n                    }\n                </TeamPermissionGate>\n            </TeamPermissionGate>\n        );\n    }\n\n    const isPrivate = channel.type === Constants.PRIVATE_CHANNEL;\n\n    let setHeaderButton = null;\n    if (!isReadOnly) {\n        const children = createSetHeaderButton(channel);\n        if (children) {\n            setHeaderButton = (\n                <ChannelPermissionGate\n                    teamId={channel.team_id}\n                    channelId={channel.id}\n                    permissions={[isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES : Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES]}\n                >\n                    {children}\n                </ChannelPermissionGate>\n            );\n        }\n    }\n\n    return (\n        <div\n            id='channelIntro'\n            className={'channel-intro ' + centeredIntro}\n        >\n            <h2 className='channel-intro__title'>\n                <FormattedMessage\n                    id='intro_messages.beginning'\n                    defaultMessage='Beginning of {name}'\n                    values={{\n                        name: channel.display_name,\n                    }}\n                />\n            </h2>\n            <p className='channel-intro__content'>\n                {!isReadOnly &&\n                    <FormattedMarkdownMessage\n                        id='intro_messages.default'\n                        defaultMessage='**Welcome to {display_name}!**\\n \\nPost messages here that you want everyone to see. Everyone automatically becomes a permanent member of this channel when they join the team.'\n                        values={{\n                            display_name: channel.display_name,\n                        }}\n                    />\n                }\n                {isReadOnly &&\n                    <FormattedMarkdownMessage\n                        id='intro_messages.readonly.default'\n                        defaultMessage='**Welcome to {display_name}!**\\n \\nMessages can only be posted by system admins. Everyone automatically becomes a permanent member of this channel when they join the team.'\n                        values={{\n                            display_name: channel.display_name,\n                        }}\n                    />\n                }\n            </p>\n            {teamInviteLink}\n            {setHeaderButton}\n            <br/>\n        </div>\n    );\n}\n\nfunction createStandardIntroMessage(channel, centeredIntro, locale, creatorName) {\n    var uiName = channel.display_name;\n    var memberMessage;\n    const channelIsArchived = channel.delete_at !== 0;\n\n    if (channelIsArchived) {\n        memberMessage = '';\n    } else if (channel.type === Constants.PRIVATE_CHANNEL) {\n        memberMessage = (\n            <FormattedMessage\n                id='intro_messages.onlyInvited'\n                defaultMessage=' Only invited members can see this private channel.'\n            />\n        );\n    } else {\n        memberMessage = (\n            <FormattedMessage\n                id='intro_messages.anyMember'\n                defaultMessage=' Any member can join and read this channel.'\n            />\n        );\n    }\n\n    const date = (\n        <FormattedDate\n            value={channel.create_at}\n            month={getMonthLong(locale)}\n            day='2-digit'\n            year='numeric'\n        />\n    );\n\n    var createMessage;\n    if (creatorName === '') {\n        if (channel.type === Constants.PRIVATE_CHANNEL) {\n            createMessage = (\n                <FormattedMessage\n                    id='intro_messages.noCreatorPrivate'\n                    defaultMessage='This is the start of the {name} private channel, created on {date}.'\n                    values={{name: (uiName), date}}\n                />\n            );\n        } else if (channel.type === Constants.OPEN_CHANNEL) {\n            createMessage = (\n                <FormattedMessage\n                    id='intro_messages.noCreator'\n                    defaultMessage='This is the start of the {name} channel, created on {date}.'\n                    values={{name: (uiName), date}}\n                />\n            );\n        }\n    } else if (channel.type === Constants.PRIVATE_CHANNEL) {\n        createMessage = (\n            <span>\n                <FormattedMessage\n                    id='intro_messages.creatorPrivate'\n                    defaultMessage='This is the start of the {name} private channel, created by {creator} on {date}.'\n                    values={{\n                        name: (uiName),\n                        creator: (creatorName),\n                        date,\n                    }}\n                />\n            </span>\n        );\n    } else if (channel.type === Constants.OPEN_CHANNEL) {\n        createMessage = (\n            <span>\n                <FormattedMessage\n                    id='intro_messages.creator'\n                    defaultMessage='This is the start of the {name} channel, created by {creator} on {date}.'\n                    values={{\n                        name: (uiName),\n                        creator: (creatorName),\n                        date,\n                    }}\n                />\n            </span>\n        );\n    }\n\n    var purposeMessage = '';\n    if (channel.purpose && channel.purpose !== '') {\n        if (channel.type === Constants.PRIVATE_CHANNEL) {\n            purposeMessage = (\n                <span>\n                    <FormattedMessage\n                        id='intro_messages.purposePrivate'\n                        defaultMessage=\" This private channel's purpose is: {purpose}\"\n                        values={{purpose: channel.purpose}}\n                    />\n                </span>\n            );\n        } else if (channel.type === Constants.OPEN_CHANNEL) {\n            purposeMessage = (\n                <span>\n                    <FormattedMessage\n                        id='intro_messages.purpose'\n                        defaultMessage=\" This channel's purpose is: {purpose}\"\n                        values={{purpose: channel.purpose}}\n                    />\n                </span>\n            );\n        }\n    }\n\n    const isPrivate = channel.type === Constants.PRIVATE_CHANNEL;\n    let setHeaderButton = null;\n    const children = createSetHeaderButton(channel);\n    if (children) {\n        setHeaderButton = (\n            <ChannelPermissionGate\n                teamId={channel.team_id}\n                channelId={channel.id}\n                permissions={[isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES : Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES]}\n            >\n                {children}\n            </ChannelPermissionGate>\n        );\n    }\n\n    const channelInviteButton = createInviteChannelButton(channel);\n\n    return (\n        <div\n            id='channelIntro'\n            className={'channel-intro ' + centeredIntro}\n        >\n            <h2 className='channel-intro__title'>\n                <FormattedMessage\n                    id='intro_messages.beginning'\n                    defaultMessage='Beginning of {name}'\n                    values={{\n                        name: (uiName),\n                    }}\n                />\n            </h2>\n            <p className='channel-intro__content'>\n                {createMessage}\n                {memberMessage}\n                {purposeMessage}\n                <br/>\n            </p>\n            {channelInviteButton}\n            {setHeaderButton}\n        </div>\n    );\n}\n\nfunction createInviteChannelButton(channel) {\n    const modal = channel.group_constrained ? AddGroupsToChannelModal : ChannelInviteModal;\n    const channelIsArchived = channel.delete_at !== 0;\n    if (channelIsArchived) {\n        return null;\n    }\n    const isPrivate = channel.type === Constants.PRIVATE_CHANNEL;\n    return (\n        <ChannelPermissionGate\n            channelId={channel.id}\n            teamId={channel.team_id}\n            permissions={[isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_MEMBERS : Permissions.MANAGE_PUBLIC_CHANNEL_MEMBERS]}\n        >\n            <ToggleModalButton\n                className='intro-links color--link'\n                dialogType={modal}\n                dialogProps={{channel}}\n            >\n                <FormattedMessage\n                    id='generic_icons.add'\n                    defaultMessage='Add Icon'\n                >\n                    {(title) => (\n                        <i\n                            className='fa fa-user-plus'\n                            title={title}\n                        />\n                    )}\n                </FormattedMessage>\n                {isPrivate && channel.group_constrained &&\n                    <FormattedMessage\n                        id='intro_messages.addGroups'\n                        defaultMessage='Add groups to this private channel'\n                    />}\n                {isPrivate && !channel.group_constrained &&\n                    <FormattedMessage\n                        id='intro_messages.invitePrivate'\n                        defaultMessage='Invite others to this private channel'\n                    />}\n                {!isPrivate &&\n                    <FormattedMessage\n                        id='intro_messages.invite'\n                        defaultMessage='Invite others to this channel'\n                    />}\n            </ToggleModalButton>\n        </ChannelPermissionGate>\n    );\n}\n\nfunction createSetHeaderButton(channel) {\n    const channelIsArchived = channel.delete_at !== 0;\n    if (channelIsArchived) {\n        return null;\n    }\n\n    return (\n        <FormattedMessage\n            id='intro_messages.setHeader'\n            defaultMessage='Set a Header'\n        >\n            {(message) => (\n                <ToggleModalButtonRedux\n                    modalId={ModalIdentifiers.EDIT_CHANNEL_HEADER}\n                    accessibilityLabel={message}\n                    className={'intro-links color--link'}\n                    dialogType={EditChannelHeaderModal}\n                    dialogProps={{channel}}\n                >\n                    <EditIcon/>\n                    {message}\n                </ToggleModalButtonRedux>\n            )}\n        </FormattedMessage>\n    );\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {isCurrentChannelReadOnly, getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {getProfilesInCurrentChannel, getCurrentUserId, getUser} from 'mattermost-redux/selectors/entities/users';\nimport {get} from 'mattermost-redux/selectors/entities/preferences';\n\nimport {Preferences} from 'utils/constants';\nimport {getDirectTeammate, getDisplayNameByUser} from 'utils/utils.jsx';\nimport {getCurrentLocale} from 'selectors/i18n';\n\nimport ChannelIntroMessage from './channel_intro_message.jsx';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n    const enableUserCreation = config.EnableUserCreation === 'true';\n    const isReadOnly = isCurrentChannelReadOnly(state);\n    const team = getCurrentTeam(state);\n    const channel = getCurrentChannel(state);\n    const teammate = getDirectTeammate(state, channel.id);\n    const creator = getUser(state, channel.creator_id);\n\n    return {\n        currentUserId: getCurrentUserId(state),\n        channel,\n        locale: getCurrentLocale(state),\n        channelProfiles: getProfilesInCurrentChannel(state),\n        enableUserCreation,\n        isReadOnly,\n        fullWidth: get(state, Preferences.CATEGORY_DISPLAY_SETTINGS, Preferences.CHANNEL_DISPLAY_MODE, Preferences.CHANNEL_DISPLAY_MODE_DEFAULT) === Preferences.CHANNEL_DISPLAY_MODE_FULL_SCREEN,\n        teamIsGroupConstrained: Boolean(team.group_constrained),\n        creatorName: getDisplayNameByUser(state, creator),\n        teammate,\n        teammateName: getDisplayNameByUser(state, teammate),\n    };\n}\n\nexport default connect(mapStateToProps)(ChannelIntroMessage);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport * as PostListUtils from 'mattermost-redux/utils/post_list';\n\nimport CombinedUserActivityPost from 'components/post_view/combined_user_activity_post';\nimport Post from 'components/post_view/post';\nimport DateSeparator from 'components/post_view/date_separator';\nimport NewMessageSeparator from 'components/post_view/new_message_separator/new_message_separator';\nimport ChannelIntroMessage from 'components/post_view/channel_intro_message/';\nimport {isIdNotPost} from 'utils/post_utils';\nimport {PostListRowListIds, Locations} from 'utils/constants';\n\nexport default class PostListRow extends React.PureComponent {\n    static propTypes = {\n        listId: PropTypes.string.isRequired,\n        previousListId: PropTypes.string,\n        fullWidth: PropTypes.bool,\n        shouldHighlight: PropTypes.bool,\n        loadOlderPosts: PropTypes.func,\n        loadNewerPosts: PropTypes.func,\n        togglePostMenu: PropTypes.func,\n\n        /**\n         * To Check if the current post is last in the list\n         */\n        isLastPost: PropTypes.bool,\n\n        /**\n         * To check if the state of emoji for last message and from where it was emitted\n         */\n        shortcutReactToLastPostEmittedFrom: PropTypes.string,\n\n        actions: PropTypes.shape({\n\n            /**\n             * Function to set or unset emoji picker for last message\n             */\n            emitShortcutReactToLastPostFrom: PropTypes.func\n        }),\n    }\n\n    blockShortcutReactToLastPostForNonMessages(listId) {\n        const {actions: {emitShortcutReactToLastPostFrom}} = this.props;\n\n        if (isIdNotPost(listId)) {\n            // This is a good escape hatch as any of the above conditions don't return <Post/> component, Emoji picker is only at Post component\n            emitShortcutReactToLastPostFrom(Locations.NO_WHERE);\n        }\n    }\n\n    componentDidUpdate(prevProps) {\n        const {listId, isLastPost, shortcutReactToLastPostEmittedFrom} = this.props;\n\n        const shortcutReactToLastPostEmittedFromCenter = prevProps.shortcutReactToLastPostEmittedFrom !== shortcutReactToLastPostEmittedFrom &&\n            shortcutReactToLastPostEmittedFrom === Locations.CENTER;\n\n        // If last post is not a message then we block the shortcut to react to last message, early on\n        if (isLastPost && shortcutReactToLastPostEmittedFromCenter) {\n            this.blockShortcutReactToLastPostForNonMessages(listId);\n        }\n    }\n\n    render() {\n        const {listId, previousListId} = this.props;\n\n        if (PostListUtils.isDateLine(listId)) {\n            const date = PostListUtils.getDateForDateLine(listId);\n\n            return (\n                <DateSeparator\n                    key={date}\n                    date={date}\n                />\n            );\n        }\n\n        if (PostListUtils.isStartOfNewMessages(listId)) {\n            return (\n                <NewMessageSeparator separatorId={listId}/>\n            );\n        }\n\n        if (listId === PostListRowListIds.CHANNEL_INTRO_MESSAGE) {\n            return (\n                <ChannelIntroMessage/>\n            );\n        }\n\n        if (listId === PostListRowListIds.LOAD_OLDER_MESSAGES_TRIGGER || listId === PostListRowListIds.LOAD_NEWER_MESSAGES_TRIGGER) {\n            return (\n                <button\n                    className='more-messages-text theme style--none color--link'\n                    onClick={listId === PostListRowListIds.LOAD_OLDER_MESSAGES_TRIGGER ? this.props.loadOlderPosts : this.props.loadNewerPosts}\n                >\n                    <FormattedMessage\n                        id='posts_view.loadMore'\n                        defaultMessage='Load More Messages'\n                    />\n                </button>\n            );\n        }\n\n        if (listId === PostListRowListIds.OLDER_MESSAGES_LOADER || listId === PostListRowListIds.NEWER_MESSAGES_LOADER) {\n            return (\n                <div\n                    className='loading-screen'\n                >\n                    <div className='loading__content'>\n                        <div className='round round-1'/>\n                        <div className='round round-2'/>\n                        <div className='round round-3'/>\n                    </div>\n                </div>\n            );\n        }\n\n        const postProps = {\n            previousPostId: previousListId,\n            shouldHighlight: this.props.shouldHighlight,\n            togglePostMenu: this.props.togglePostMenu,\n            isLastPost: this.props.isLastPost\n        };\n\n        if (PostListUtils.isCombinedUserActivityPost(listId)) {\n            return (\n                <CombinedUserActivityPost\n                    combinedId={listId}\n                    {...postProps}\n                />\n            );\n        }\n\n        return (\n            <Post\n                postId={listId}\n                {...postProps}\n            />\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {getShortcutReactToLastPostEmittedFrom} from 'selectors/emojis';\nimport {emitShortcutReactToLastPostFrom} from 'actions/post_actions.jsx';\n\nimport PostListRow from './post_list_row.jsx';\n\nfunction mapStateToProps(state, ownProps) {\n    const shortcutReactToLastPostEmittedFrom = getShortcutReactToLastPostEmittedFrom(state);\n\n    return {\n        post: ownProps.post,\n        channel: ownProps.channel,\n        shortcutReactToLastPostEmittedFrom\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            emitShortcutReactToLastPostFrom,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PostListRow);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nexport default class ScrollToBottomIcon extends React.PureComponent {\n    render() {\n        return (\n            <span {...this.props}>\n                <FormattedMessage\n                    id='generic_icons.arrow.down'\n                    defaultMessage='Down Arrow Icon'\n                >\n                    {(ariaLabel) => (\n                        <svg\n                            x='0px'\n                            y='0px'\n                            viewBox='-239 239 21 23'\n                            style={style}\n                            role='img'\n                            aria-label={ariaLabel}\n                        >\n                            <path d='M-239,241.4l2.4-2.4l8.1,8.2l8.1-8.2l2.4,2.4l-10.5,10.6L-239,241.4z M-228.5,257.2l8.1-8.2l2.4,2.4l-10.5,10.6l-10.5-10.6 l2.4-2.4L-228.5,257.2z'/>\n                        </svg>\n                    )}\n                </FormattedMessage>\n            </span>\n        );\n    }\n}\n\nconst style = {\n    enableBackground: 'new -239 239 21 23',\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport ScrollToBottomIcon from 'components/widgets/icons/scroll_to_bottom_icon';\n\nexport default class ScrollToBottomArrows extends React.PureComponent {\n    static propTypes = {\n        isScrolling: PropTypes.bool.isRequired,\n        atBottom: PropTypes.bool,\n        onClick: PropTypes.func.isRequired,\n    };\n\n    render() {\n        // only show on mobile\n        if ($(window).width() > 768) {\n            return null;\n        }\n\n        let className = 'post-list__arrows';\n        if (this.props.isScrolling && this.props.atBottom === false) {\n            className += ' scrolling';\n        }\n\n        return (\n            <div\n                className={className}\n                onClick={this.props.onClick}\n            >\n                <ScrollToBottomIcon/>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {FormattedMessage} from 'react-intl';\nimport {OverlayTrigger, Tooltip} from 'react-bootstrap';\n\nimport UnreadBelowIcon from 'components/widgets/icons/unread_below_icon';\nimport CloseIcon from 'components/widgets/icons/close_icon';\nimport Constants from 'utils/constants';\n\nimport './toast.scss';\n\nexport default class Toast extends React.PureComponent {\n    static propTypes = {\n        onClick: PropTypes.func,\n        onClickMessage: PropTypes.string,\n        onDismiss: PropTypes.func,\n        children: PropTypes.element,\n        show: PropTypes.bool.isRequired,\n        showActions: PropTypes.bool, //used for showing jump actions\n        width: PropTypes.number,\n        extraClasses: PropTypes.string,\n    }\n\n    componentDidMount() {\n        this.mounted = true;\n    }\n\n    componentWillUnmount() {\n        this.mounted = false;\n    }\n\n    handleDismiss = () => {\n        if (typeof this.props.onDismiss == 'function') {\n            this.props.onDismiss();\n        }\n    }\n\n    render() {\n        let toastClass = 'toast';\n        const {show, extraClasses, showActions, width} = this.props;\n        if (extraClasses) {\n            toastClass += ` ${extraClasses}`;\n        }\n\n        if (show) {\n            toastClass += ' toast__visible';\n        }\n\n        let toastActionClass = 'toast__message';\n        if (showActions) {\n            toastActionClass += ' toast__pointer';\n        }\n\n        const jumpSection = () => {\n            return (\n                <div\n                    className='toast__jump'\n                >\n                    <UnreadBelowIcon/>\n                    {width > Constants.MOBILE_SCREEN_WIDTH && this.props.onClickMessage}\n                </div>\n            );\n        };\n\n        let closeTooltip = (<div/>);\n        if (showActions && show) {\n            closeTooltip = (\n                <Tooltip id='toast-close__tooltip'>\n                    <FormattedMessage\n                        id='general_button.close'\n                        defaultMessage='Close'\n                    />\n                    <div className='tooltip__shortcut--txt'>\n                        <FormattedMessage\n                            id='general_button.esc'\n                            defaultMessage='esc'\n                        />\n                    </div>\n                </Tooltip>\n            );\n        }\n\n        return (\n            <div className={toastClass}>\n                <div\n                    className={toastActionClass}\n                    onClick={showActions ? this.props.onClick : null}\n                >\n                    {showActions && jumpSection()}\n                    {this.props.children}\n                </div>\n                <div\n                    className='toast__dismiss'\n                    onClick={this.handleDismiss}\n                    data-testid={extraClasses ? `dismissToast-${extraClasses}` : 'dismissToast'}\n                >\n                    <OverlayTrigger\n                        delayShow={Constants.OVERLAY_TIME_DELAY}\n                        placement='bottom'\n                        overlay={closeTooltip}\n                    >\n                        <CloseIcon\n                            className='close-btn'\n                            id='dismissToast'\n                        />\n                    </OverlayTrigger>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {FormattedMessage, FormattedDate, injectIntl} from 'react-intl';\n\nimport Toast from 'components/toast/toast';\nimport {isIdNotPost, getNewMessageIndex} from 'utils/post_utils.jsx';\nimport * as Utils from 'utils/utils.jsx';\nimport Constants from 'utils/constants';\nimport {browserHistory} from 'utils/browser_history';\nimport LocalDateTime from 'components/local_date_time';\n\nconst TOAST_TEXT_COLLAPSE_WIDTH = 500;\n\nclass ToastWrapper extends React.PureComponent {\n    static propTypes = {\n        unreadCountInChannel: PropTypes.number,\n        newRecentMessagesCount: PropTypes.number,\n        channelMarkedAsUnread: PropTypes.bool,\n        atLatestPost: PropTypes.bool,\n        postListIds: PropTypes.array,\n        latestPostTimeStamp: PropTypes.number,\n        atBottom: PropTypes.bool,\n        lastViewedBottom: PropTypes.number,\n        width: PropTypes.number,\n        lastViewedAt: PropTypes.number,\n        focusedPostId: PropTypes.string,\n        initScrollOffsetFromBottom: PropTypes.number,\n        updateNewMessagesAtInChannel: PropTypes.func,\n        scrollToNewMessage: PropTypes.func,\n        scrollToLatestMessages: PropTypes.func,\n        updateLastViewedBottomAt: PropTypes.func,\n\n        /*\n         * Object from react-router\n         */\n        match: PropTypes.shape({\n            params: PropTypes.shape({\n                team: PropTypes.string,\n            }).isRequired,\n        }).isRequired,\n\n        actions: PropTypes.shape({\n\n            /**\n             * Action creator to update toast status\n             */\n            updateToastStatus: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    static defaultProps = {\n        focusedPostId: '',\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            unreadCountInChannel: props.unreadCountInChannel,\n        };\n    }\n\n    static countNewMessages = (postListIds) => {\n        const mark = getNewMessageIndex(postListIds);\n        if (mark <= 0) {\n            return 0;\n        }\n        const newMessages = postListIds.slice(0, mark);\n        return newMessages.filter((id) => !isIdNotPost(id)).length;\n    }\n\n    static getDerivedStateFromProps(props, prevState) {\n        let {showUnreadToast, showNewMessagesToast, showMessageHistoryToast} = prevState;\n        let unreadCount;\n\n        if (props.atLatestPost) {\n            unreadCount = ToastWrapper.countNewMessages(props.postListIds);\n        } else if (props.channelMarkedAsUnread) {\n            unreadCount = prevState.unreadCountInChannel;\n        } else {\n            unreadCount = prevState.unreadCountInChannel + props.newRecentMessagesCount;\n        }\n\n        // show unread toast on mount when channel is not at bottom and unread count greater than 0\n        if (typeof showUnreadToast === 'undefined' && props.atBottom !== null) {\n            showUnreadToast = unreadCount > 0 && !props.atBottom;\n        }\n\n        if (typeof showMessageHistoryToast === 'undefined' && props.focusedPostId !== '' && props.atBottom !== null) {\n            showMessageHistoryToast = props.initScrollOffsetFromBottom > 1000 || !props.atLatestPost;\n        }\n\n        // show unread toast when a channel is marked as unread\n        if (props.channelMarkedAsUnread && !props.atBottom && !prevState.channelMarkedAsUnread && !prevState.showUnreadToast) {\n            showUnreadToast = true;\n        }\n\n        // show unread toast when a channel is remarked as unread using the change in lastViewedAt\n        // lastViewedAt changes only if a channel is remarked as unread in channelMarkedAsUnread state\n        if (props.channelMarkedAsUnread && props.lastViewedAt !== prevState.lastViewedAt && !props.atBottom) {\n            showUnreadToast = true;\n        }\n\n        if (!showUnreadToast && unreadCount > 0 && !props.atBottom && (props.lastViewedBottom < props.latestPostTimeStamp)) {\n            showNewMessagesToast = true;\n        }\n\n        if (!unreadCount) {\n            showNewMessagesToast = false;\n            showUnreadToast = false;\n        }\n\n        return {\n            unreadCount,\n            showUnreadToast,\n            showNewMessagesToast,\n            lastViewedAt: props.lastViewedAt,\n            channelMarkedAsUnread: props.channelMarkedAsUnread,\n            showMessageHistoryToast,\n        };\n    }\n\n    componentDidMount() {\n        this.mounted = true;\n        const {showUnreadToast, showNewMessagesToast, showMessageHistoryToast} = this.state;\n        const toastPresent = Boolean(showUnreadToast || showNewMessagesToast || showMessageHistoryToast);\n        document.addEventListener('keydown', this.handleShortcut);\n        this.props.actions.updateToastStatus(toastPresent);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        const {showUnreadToast, showNewMessagesToast, showMessageHistoryToast} = this.state;\n        const {\n            atBottom,\n            atLatestPost,\n            postListIds,\n            lastViewedBottom,\n            updateNewMessagesAtInChannel,\n            actions\n        } = this.props;\n\n        if (!prevProps.atBottom && atBottom && atLatestPost) {\n            this.hideNewMessagesToast(false);\n            this.hideUnreadToast();\n            this.hideArchiveToast();\n        }\n\n        const prevPostsCount = prevProps.postListIds.length;\n        const presentPostsCount = postListIds.length;\n        const postsAddedAtBottom = presentPostsCount !== prevPostsCount && postListIds[0] !== prevProps.postListIds[0];\n        const notBottomWithLatestPosts = !atBottom && atLatestPost && presentPostsCount > 0;\n\n        //Marking existing messages as read based on last time user reached to the bottom\n        //This moves the new message indicator to the latest posts and keeping in sync with the toast count\n        if (postsAddedAtBottom && notBottomWithLatestPosts && !showUnreadToast) {\n            updateNewMessagesAtInChannel(lastViewedBottom);\n        }\n\n        const toastStateChanged = prevState.showUnreadToast !== showUnreadToast ||\n                                  prevState.showNewMessagesToast !== showNewMessagesToast ||\n                                  prevState.showMessageHistoryToast !== showMessageHistoryToast;\n\n        if (toastStateChanged) {\n            const toastPresent = Boolean(showUnreadToast || showNewMessagesToast || showMessageHistoryToast);\n            actions.updateToastStatus(toastPresent);\n        }\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleShortcut);\n    }\n\n    handleShortcut = (e) => {\n        if (Utils.isKeyPressed(e, Constants.KeyCodes.ESCAPE)) {\n            if (this.state.showUnreadToast) {\n                this.hideUnreadToast();\n            } else if (this.state.showNewMessagesToast) {\n                this.hideNewMessagesToast();\n            } else {\n                this.hideArchiveToast();\n            }\n        }\n    };\n\n    hideUnreadToast = () => {\n        if (this.state.showUnreadToast) {\n            this.setState({\n                showUnreadToast: false,\n            });\n        }\n    }\n\n    hideArchiveToast = () => {\n        if (this.state.showMessageHistoryToast) {\n            this.setState({\n                showMessageHistoryToast: false,\n            });\n        }\n    }\n\n    hideNewMessagesToast = (updateLastViewedBottomAt = true) => {\n        if (this.state.showNewMessagesToast) {\n            this.setState({\n                showNewMessagesToast: false,\n            });\n            if (updateLastViewedBottomAt) {\n                this.props.updateLastViewedBottomAt();\n            }\n        }\n    }\n\n    newMessagesToastText = (count, since) => {\n        if (this.props.width > TOAST_TEXT_COLLAPSE_WIDTH && typeof since !== 'undefined') {\n            return (\n                <FormattedMessage\n                    id='postlist.toast.newMessagesSince'\n                    defaultMessage={'{count, number} new {count, plural, one {message} other {messages}} since {date} at {time}'}\n                    values={{\n                        count,\n                        date: (\n                            <FormattedDate\n                                value={since}\n                                weekday='short'\n                                day='2-digit'\n                                month='short'\n                            />\n                        ),\n                        time: (\n                            <LocalDateTime\n                                eventTime={since}\n                            />\n                        )\n                    }}\n                />\n            );\n        }\n        return (\n            <FormattedMessage\n                id='postlist.toast.newMessages'\n                defaultMessage={'{count, number} new {count, plural, one {message} other {messages}}'}\n                values={{count}}\n            />\n        );\n    }\n\n    archiveToastText = () => {\n        return (\n            <FormattedMessage\n                id='postlist.toast.history'\n                defaultMessage='Viewing message history'\n            />\n        );\n    }\n\n    changeUrlToRemountChannelView = () => {\n        const {match} = this.props;\n\n        // Inorder of mount the channel view we are redirecting to /team url to load the channel again\n        // Todo: Can be changed to dispatch if we put focussedPostId in redux state.\n        browserHistory.replace(`/${match.params.team}`);\n    }\n\n    scrollToNewMessage = () => {\n        const {focusedPostId, atLatestPost, scrollToNewMessage, updateLastViewedBottomAt} = this.props;\n\n        // if latest set of posts are not loaded in the view then we cannot scroll to the message\n        // We will be chaging the url to remount the channel view so we can remove the focussedPostId react state\n        // if we don't remove the focussedPostId state then scroll tries to correct to that instead of new message line\n        if (focusedPostId && !atLatestPost) {\n            this.changeUrlToRemountChannelView();\n            return;\n        }\n\n        scrollToNewMessage();\n        updateLastViewedBottomAt();\n        this.hideNewMessagesToast();\n    }\n\n    scrollToLatestMessages = () => {\n        const {focusedPostId, atLatestPost, scrollToLatestMessages} = this.props;\n\n        if (focusedPostId) {\n            if (!atLatestPost) {\n                this.changeUrlToRemountChannelView();\n                return;\n            }\n            this.hideArchiveToast();\n        }\n\n        scrollToLatestMessages();\n        this.hideUnreadToast();\n    }\n\n    render() {\n        const {atLatestPost, atBottom, width, lastViewedAt} = this.props;\n        const {showUnreadToast, showNewMessagesToast, showMessageHistoryToast, unreadCount} = this.state;\n\n        let unreadToastProps = {\n            show: false,\n            width,\n        };\n\n        const archiveToastProps = {\n            show: Boolean(showMessageHistoryToast),\n            width,\n            onDismiss: this.hideArchiveToast,\n            onClick: this.scrollToLatestMessages,\n            onClickMessage: Utils.localizeMessage('postlist.toast.scrollToBottom', 'Jump to recents'),\n            showActions: true,\n            extraClasses: 'toast__history',\n        };\n\n        if (showUnreadToast && unreadCount > 0) {\n            unreadToastProps = {\n                ...unreadToastProps,\n                onDismiss: this.hideUnreadToast,\n                onClick: this.scrollToLatestMessages,\n                onClickMessage: Utils.localizeMessage('postlist.toast.scrollToBottom', 'Jump to recents'),\n                show: true,\n                showActions: !atLatestPost || (atLatestPost && !atBottom),\n            };\n        } else if (showNewMessagesToast) {\n            unreadToastProps = {\n                ...unreadToastProps,\n                onDismiss: this.hideNewMessagesToast,\n                onClick: this.scrollToNewMessage,\n                onClickMessage: Utils.localizeMessage('postlist.toast.scrollToLatest', 'Jump to new messages'),\n                show: true,\n                showActions: !atLatestPost || (atLatestPost && !atBottom),\n            };\n        }\n\n        return (\n            <React.Fragment>\n                <Toast {...unreadToastProps}>\n                    {this.newMessagesToastText(unreadCount, lastViewedAt)}\n                </Toast>\n                <Toast {...archiveToastProps}>\n                    {this.archiveToastText()}\n                </Toast>\n            </React.Fragment>\n        );\n    }\n}\n\nexport default injectIntl(ToastWrapper);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {createSelector} from 'reselect';\nimport {withRouter} from 'react-router-dom';\nimport {Posts} from 'mattermost-redux/constants';\nimport {getAllPosts, getPostIdsInChannel} from 'mattermost-redux/selectors/entities/posts';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {makePreparePostIdsForPostList} from 'mattermost-redux/utils/post_list';\nimport {countCurrentChannelUnreadMessages, isManuallyUnread} from 'mattermost-redux/selectors/entities/channels';\n\nimport {updateToastStatus} from 'actions/views/channel';\n\nimport ToastWrapper from './toast_wrapper.jsx';\n\nexport function makeCountUnreadsBelow() {\n    return createSelector(\n        getAllPosts,\n        getCurrentUserId,\n        (state, postIds) => postIds,\n        (state, postIds, lastViewedBottom) => lastViewedBottom,\n        (allPosts, currentUserId, postIds, lastViewedBottom) => {\n            if (!postIds) {\n                return 0;\n            }\n\n            // Count the number of new posts made by other users that haven't been deleted\n            return postIds.map((id) => allPosts[id]).filter((post) => {\n                return post &&\n                    post.user_id !== currentUserId &&\n                    post.state !== Posts.POST_DELETED &&\n                    post.create_at > lastViewedBottom;\n            }).length;\n        }\n    );\n}\n\n/* This connected component is written mainly for maintaining the unread count to be passed to the toast\n   Unread count logic:\n   * If channel is at the latest set of posts:\n      Unread count is the Number of posts below new message line\n   * if channel is not at the latest set of posts:\n      1. UnreadCount + any recent messages in the latest chunk.\n      2. If channel was marked as unread.\n        * Unread count of channel alone.\n*/\n\nfunction makeMapStateToProps() {\n    const countUnreadsBelow = makeCountUnreadsBelow();\n    const preparePostIdsForPostList = makePreparePostIdsForPostList();\n    return function mapStateToProps(state, ownProps) {\n        let newRecentMessagesCount = 0;\n        const channelMarkedAsUnread = isManuallyUnread(state, ownProps.channelId);\n        const lastViewedAt = state.views.channel.lastChannelViewTime[ownProps.channelId];\n        if (!ownProps.atLatestPost) {\n            let postIds = getPostIdsInChannel(state, ownProps.channelId);\n            if (postIds) {\n                postIds = preparePostIdsForPostList(state, {postIds, lastViewedAt, channelId: ownProps.channelId});\n            }\n            newRecentMessagesCount = countUnreadsBelow(state, postIds, lastViewedAt);\n        }\n\n        return {\n            lastViewedAt,\n            newRecentMessagesCount,\n            unreadCountInChannel: countCurrentChannelUnreadMessages(state),\n            channelMarkedAsUnread,\n        };\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            updateToastStatus,\n        }, dispatch),\n    };\n}\n\nexport default withRouter(connect(makeMapStateToProps, mapDispatchToProps)(ToastWrapper));\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport AutoSizer from 'react-virtualized-auto-sizer';\nimport {DynamicSizeList} from 'react-window';\nimport {injectIntl} from 'react-intl';\n\nimport {isDateLine, isStartOfNewMessages} from 'mattermost-redux/utils/post_list';\n\nimport EventEmitter from 'mattermost-redux/utils/event_emitter';\n\nimport Constants, {PostListRowListIds, EventTypes, PostRequestTypes} from 'utils/constants';\nimport DelayedAction from 'utils/delayed_action';\nimport {getPreviousPostId, getLatestPostId, getNewMessageIndex} from 'utils/post_utils.jsx';\nimport {intlShape} from 'utils/react_intl';\nimport * as Utils from 'utils/utils.jsx';\n\nimport FloatingTimestamp from 'components/post_view/floating_timestamp';\nimport PostListRow from 'components/post_view/post_list_row';\nimport ScrollToBottomArrows from 'components/post_view/scroll_to_bottom_arrows';\nimport ToastWrapper from 'components/toast_wrapper';\n\nconst OVERSCAN_COUNT_BACKWARD = window.OVERSCAN_COUNT_BACKWARD || 80; // Exposing the value for PM to test will be removed soon\nconst OVERSCAN_COUNT_FORWARD = window.OVERSCAN_COUNT_FORWARD || 80; // Exposing the value for PM to test will be removed soon\nconst HEIGHT_TRIGGER_FOR_MORE_POSTS = window.HEIGHT_TRIGGER_FOR_MORE_POSTS || 1000; // Exposing the value for PM to test will be removed soon\nconst BUFFER_TO_BE_CONSIDERED_BOTTOM = 10;\n\nconst MAXIMUM_POSTS_FOR_SLICING = {\n    channel: 50,\n    permalink: 100,\n};\n\nconst postListStyle = {\n    padding: '14px 0px 7px',\n};\n\nconst virtListStyles = {\n    position: 'absolute',\n    bottom: '0',\n    maxHeight: '100%',\n};\n\nconst OFFSET_TO_SHOW_TOAST = -50;\n\nclass PostList extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         * Array of Ids in the channel including date separators, new message indicator, more messages loader,\n         * manual load messages trigger and postId in the order of newest to oldest for populating virtual list rows\n         */\n        postListIds: PropTypes.array.isRequired,\n\n        /**\n         * Set to focus this post\n         */\n        focusedPostId: PropTypes.string,\n\n        /**\n         * The current channel id\n         */\n        channelId: PropTypes.string.isRequired,\n\n        /**\n         * Used for disabling auto retry of posts and enabling manual link for loading posts\n         */\n        autoRetryEnable: PropTypes.bool,\n\n        /**\n         * used for populating header, scroll correction and disabling triggering loadOlderPosts\n         */\n        atOldestPost: PropTypes.bool,\n\n        /**\n         * used for disabling triggering loadNewerPosts\n         */\n        atLatestPost: PropTypes.bool,\n\n        intl: intlShape.isRequired,\n\n        latestPostTimeStamp: PropTypes.number,\n\n        latestAriaLabelFunc: PropTypes.func,\n\n        lastViewedAt: PropTypes.string,\n\n        actions: PropTypes.shape({\n\n            /**\n             * Function to get older posts in the channel\n             */\n            loadOlderPosts: PropTypes.func.isRequired,\n\n            /**\n             * Function to get newer posts in the channel\n             */\n            loadNewerPosts: PropTypes.func.isRequired,\n\n            /**\n             * Function used for autoLoad of posts incase screen is not filled with posts\n             */\n            canLoadMorePosts: PropTypes.func.isRequired,\n\n            /**\n             * Function to check and set if app is in mobile view\n             */\n            checkAndSetMobileView: PropTypes.func.isRequired,\n\n            /**\n             * Function to change the post selected for postList\n             */\n            changeUnreadChunkTimeStamp: PropTypes.func.isRequired,\n\n            updateNewMessagesAtInChannel: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        const channelIntroMessage = PostListRowListIds.CHANNEL_INTRO_MESSAGE;\n        const isMobile = Utils.isMobile();\n        this.state = {\n            isScrolling: false,\n            isMobile,\n\n            /* Intentionally setting null so that toast can determine when the first time this state is defined */\n            atBottom: null,\n            lastViewedBottom: Date.now(),\n            postListIds: [channelIntroMessage],\n            topPostId: '',\n            postMenuOpened: false,\n            dynamicListStyle: {\n                willChange: 'transform',\n            },\n            initScrollCompleted: false,\n            initScrollOffsetFromBottom: 0,\n        };\n\n        this.listRef = React.createRef();\n        this.postListRef = React.createRef();\n        if (isMobile) {\n            this.scrollStopAction = new DelayedAction(this.handleScrollStop);\n        }\n\n        this.initRangeToRender = this.props.focusedPostId ? [0, MAXIMUM_POSTS_FOR_SLICING.permalink] : [0, MAXIMUM_POSTS_FOR_SLICING.channel];\n\n        let postIndex = 0;\n        if (props.focusedPostId) {\n            postIndex = this.props.postListIds.findIndex((postId) => postId === this.props.focusedPostId);\n        } else {\n            postIndex = this.getNewMessagesSeparatorIndex(props.postListIds);\n        }\n\n        const maxPostsForSlicing = props.focusedPostId ? MAXIMUM_POSTS_FOR_SLICING.permalink : MAXIMUM_POSTS_FOR_SLICING.channel;\n        this.initRangeToRender = [\n            Math.max(postIndex - 30, 0),\n            Math.max(postIndex + 30, Math.min(props.postListIds.length - 1, maxPostsForSlicing)),\n        ];\n    }\n\n    componentDidMount() {\n        this.mounted = true;\n        this.props.actions.checkAndSetMobileView();\n\n        window.addEventListener('resize', this.handleWindowResize);\n        EventEmitter.addListener(EventTypes.POST_LIST_SCROLL_TO_BOTTOM, this.scrollToLatestMessages);\n    }\n\n    getSnapshotBeforeUpdate(prevProps) {\n        if (this.postListRef && this.postListRef.current) {\n            const postsAddedAtTop = this.props.postListIds && this.props.postListIds.length !== prevProps.postListIds.length && this.props.postListIds[0] === prevProps.postListIds[0];\n            const channelHeaderAdded = this.props.atOldestPost !== prevProps.atOldestPost;\n            if ((postsAddedAtTop || channelHeaderAdded) && this.state.atBottom === false) {\n                const postListNode = this.postListRef.current;\n                const previousScrollTop = postListNode.parentElement.scrollTop;\n                const previousScrollHeight = postListNode.scrollHeight;\n\n                return {\n                    previousScrollTop,\n                    previousScrollHeight,\n                };\n            }\n        }\n        return null;\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (!this.postListRef.current) {\n            return;\n        }\n        const prevPostsCount = prevProps.postListIds.length;\n        const presentPostsCount = this.props.postListIds.length;\n\n        if (snapshot) {\n            const postlistScrollHeight = this.postListRef.current.scrollHeight;\n            const postsAddedAtTop = presentPostsCount !== prevPostsCount && this.props.postListIds[0] === prevProps.postListIds[0];\n            const channelHeaderAdded = this.props.atOldestPost !== prevProps.atOldestPost;\n            if ((postsAddedAtTop || channelHeaderAdded) && !this.state.atBottom && snapshot) {\n                const scrollValue = snapshot.previousScrollTop + (postlistScrollHeight - snapshot.previousScrollHeight);\n                if (scrollValue !== 0 && (scrollValue - snapshot.previousScrollTop) !== 0) {\n                    //true as third param so chrome can use animationFrame when correcting scroll\n                    this.listRef.current.scrollTo(scrollValue, scrollValue - snapshot.previousScrollTop, true);\n                }\n            }\n        }\n    }\n\n    componentWillUnmount() {\n        this.mounted = false;\n        window.removeEventListener('resize', this.handleWindowResize);\n        EventEmitter.removeListener(EventTypes.POST_LIST_SCROLL_TO_BOTTOM, this.scrollToLatestMessages);\n    }\n\n    static getDerivedStateFromProps(props) {\n        const postListIds = props.postListIds;\n        let newPostListIds;\n\n        if (props.atOldestPost) {\n            newPostListIds = [...postListIds, PostListRowListIds.CHANNEL_INTRO_MESSAGE];\n        } else if (props.autoRetryEnable) {\n            newPostListIds = [...postListIds, PostListRowListIds.OLDER_MESSAGES_LOADER];\n        } else {\n            newPostListIds = [...postListIds, PostListRowListIds.LOAD_OLDER_MESSAGES_TRIGGER];\n        }\n\n        if (!props.atLatestPost) {\n            if (props.autoRetryEnable) {\n                newPostListIds = [PostListRowListIds.NEWER_MESSAGES_LOADER, ...newPostListIds];\n            } else {\n                newPostListIds = [PostListRowListIds.LOAD_NEWER_MESSAGES_TRIGGER, ...newPostListIds];\n            }\n        }\n\n        return {\n            postListIds: newPostListIds,\n        };\n    }\n\n    getNewMessagesSeparatorIndex = (postListIds) => {\n        return postListIds.findIndex(\n            (item) => item.indexOf(PostListRowListIds.START_OF_NEW_MESSAGES) === 0\n        );\n    }\n\n    handleWindowResize = () => {\n        this.props.actions.checkAndSetMobileView();\n        const isMobile = Utils.isMobile();\n        if (isMobile !== this.state.isMobile) {\n            const dynamicListStyle = this.state.dynamicListStyle;\n            if (this.state.postMenuOpened) {\n                if (!isMobile && dynamicListStyle.willChange === 'unset') {\n                    dynamicListStyle.willChange = 'transform';\n                } else if (isMobile && dynamicListStyle.willChange === 'transform') {\n                    dynamicListStyle.willChange = 'unset';\n                }\n            }\n\n            this.setState({\n                isMobile,\n                dynamicListStyle,\n            });\n            this.scrollStopAction = new DelayedAction(this.handleScrollStop);\n        }\n    }\n\n    togglePostMenu = (opened) => {\n        const dynamicListStyle = this.state.dynamicListStyle;\n        if (this.state.isMobile) {\n            dynamicListStyle.willChange = opened ? 'unset' : 'transform';\n        }\n\n        this.setState({\n            postMenuOpened: opened,\n            dynamicListStyle,\n        });\n    };\n\n    renderRow = ({data, itemId, style}) => {\n        const index = data.indexOf(itemId);\n        let className = '';\n        const basePaddingClass = 'post-row__padding';\n        const previousItemId = (index !== -1 && index < data.length - 1) ? data[index + 1] : '';\n        const nextItemId = (index > 0 && index < data.length) ? data[index - 1] : '';\n\n        if (isDateLine(nextItemId) || isStartOfNewMessages(nextItemId)) {\n            className += basePaddingClass + ' bottom';\n        }\n\n        if (isDateLine(previousItemId) || isStartOfNewMessages(previousItemId)) {\n            if (className.includes(basePaddingClass)) {\n                className += ' top';\n            } else {\n                className += basePaddingClass + ' top';\n            }\n        }\n\n        // Since the first in the list is the latest message\n        const isLastPost = itemId === this.state.postListIds[0];\n\n        return (\n            <div\n                style={style}\n                className={className}\n            >\n                <PostListRow\n                    listId={itemId}\n                    previousListId={getPreviousPostId(data, index)}\n                    shouldHighlight={itemId === this.props.focusedPostId}\n                    loadOlderPosts={this.props.actions.loadOlderPosts}\n                    loadNewerPosts={this.props.actions.loadNewerPosts}\n                    togglePostMenu={this.togglePostMenu}\n                    isLastPost={isLastPost}\n                />\n            </div>\n        );\n    };\n\n    itemKey = (index) => {\n        const {postListIds} = this.state;\n        return postListIds[index] ? postListIds[index] : index;\n    }\n\n    scrollToFailed = (index) => {\n        if (index === 0) {\n            this.props.actions.changeUnreadChunkTimeStamp('');\n        } else {\n            this.props.actions.changeUnreadChunkTimeStamp(this.props.lastViewedAt);\n        }\n    }\n\n    onScroll = ({scrollDirection, scrollOffset, scrollUpdateWasRequested, clientHeight, scrollHeight}) => {\n        if (scrollHeight <= 0) {\n            return;\n        }\n\n        const didUserScrollBackwards = scrollDirection === 'backward' && !scrollUpdateWasRequested;\n        const didUserScrollForwards = scrollDirection === 'forward' && !scrollUpdateWasRequested;\n        const isOffsetWithInRange = scrollOffset < HEIGHT_TRIGGER_FOR_MORE_POSTS;\n        const offsetFromBottom = (scrollHeight - clientHeight) - scrollOffset < HEIGHT_TRIGGER_FOR_MORE_POSTS;\n\n        if (didUserScrollBackwards && isOffsetWithInRange && !this.props.atOldestPost) {\n            this.props.actions.loadOlderPosts();\n        } else if (didUserScrollForwards && offsetFromBottom && !this.props.atLatestPost) {\n            this.props.actions.loadNewerPosts();\n        }\n\n        if (this.state.isMobile) {\n            if (!this.state.isScrolling) {\n                this.setState({\n                    isScrolling: true,\n                });\n            }\n\n            if (this.scrollStopAction) {\n                this.scrollStopAction.fireAfter(Constants.SCROLL_DELAY);\n            }\n        }\n\n        this.checkBottom(scrollOffset, scrollHeight, clientHeight);\n\n        if (scrollUpdateWasRequested) { //if scroll change is programatically requested i.e by calling scrollTo\n            //This is a private method on virtlist\n            const postsRenderedRange = this.listRef.current._getRangeToRender(); //eslint-disable-line no-underscore-dangle\n\n            // postsRenderedRange[3] is the visibleStopIndex which is post at the bottom of the screen\n            if (postsRenderedRange[3] <= 1 && !this.props.atLatestPost) {\n                this.props.actions.canLoadMorePosts(PostRequestTypes.AFTER_ID);\n            }\n\n            if (!this.state.atBottom && scrollHeight) {\n                const initScrollOffsetFromBottom = scrollHeight - clientHeight - scrollOffset;\n                this.setState({\n                    initScrollOffsetFromBottom,\n                });\n            }\n        }\n    }\n\n    checkBottom = (scrollOffset, scrollHeight, clientHeight) => {\n        this.updateAtBottom(this.isAtBottom(scrollOffset, scrollHeight, clientHeight));\n    }\n\n    isAtBottom = (scrollOffset, scrollHeight, clientHeight) => {\n        // Calculate how far the post list is from being scrolled to the bottom\n        const offsetFromBottom = scrollHeight - clientHeight - scrollOffset;\n\n        return offsetFromBottom <= BUFFER_TO_BE_CONSIDERED_BOTTOM && scrollHeight > 0;\n    }\n\n    updateAtBottom = (atBottom) => {\n        if (atBottom !== this.state.atBottom) {\n            // Update lastViewedBottom when the list reaches or leaves the bottom\n            let lastViewedBottom = Date.now();\n            if (this.props.latestPostTimeStamp > lastViewedBottom) {\n                lastViewedBottom = this.props.latestPostTimeStamp;\n            }\n\n            // if we hit the bottom, we haven't just landed on the unread channel\n            this.setState({\n                atBottom,\n                lastViewedBottom,\n            });\n        }\n    }\n\n    updateLastViewedBottomAt = (lastViewedBottom = Date.now()) => {\n        this.setState({\n            lastViewedBottom,\n        });\n    }\n\n    handleScrollStop = () => {\n        if (this.mounted) {\n            this.setState({\n                isScrolling: false,\n            });\n        }\n    }\n\n    updateFloatingTimestamp = (visibleTopItem) => {\n        if (!this.state.isMobile) {\n            return;\n        }\n\n        if (!this.props.postListIds) {\n            return;\n        }\n\n        this.setState({\n            topPostId: getLatestPostId(this.props.postListIds.slice(visibleTopItem)),\n        });\n    }\n\n    onItemsRendered = ({visibleStartIndex}) => {\n        this.updateFloatingTimestamp(visibleStartIndex);\n    }\n\n    initScrollToIndex = () => {\n        if (this.props.focusedPostId) {\n            const index = this.state.postListIds.findIndex(\n                (item) => item === this.props.focusedPostId\n            );\n            return {\n                index,\n                position: 'center',\n            };\n        }\n\n        const newMessagesSeparatorIndex = getNewMessageIndex(this.state.postListIds);\n\n        if (newMessagesSeparatorIndex > 0) {\n            // if there is a dateLine above START_OF_NEW_MESSAGES then scroll to date line\n            if (isDateLine(this.state.postListIds[newMessagesSeparatorIndex + 1])) {\n                return {\n                    index: newMessagesSeparatorIndex + 1,\n                    position: 'start',\n                    offset: OFFSET_TO_SHOW_TOAST,\n                };\n            }\n            return {\n                index: newMessagesSeparatorIndex,\n                position: 'start',\n                offset: OFFSET_TO_SHOW_TOAST,\n            };\n        }\n\n        return {\n            index: 0,\n            position: 'end',\n        };\n    }\n\n    scrollToLatestMessages = () => {\n        if (this.props.atLatestPost) {\n            this.scrollToBottom();\n        } else {\n            this.updateNewMessagesAtInChannel();\n            this.props.actions.changeUnreadChunkTimeStamp('');\n        }\n    }\n\n    scrollToBottom = () => {\n        this.listRef.current.scrollToItem(0, 'end');\n    }\n\n    scrollToNewMessage = () => {\n        this.listRef.current.scrollToItem(getNewMessageIndex(this.state.postListIds), 'start', OFFSET_TO_SHOW_TOAST);\n    }\n\n    updateNewMessagesAtInChannel = (lastViewedAt = Date.now()) => {\n        this.props.actions.updateNewMessagesAtInChannel(this.props.channelId, lastViewedAt);\n    }\n\n    renderToasts = (width) => {\n        return (\n            <ToastWrapper\n                atLatestPost={this.props.atLatestPost}\n                postListIds={this.state.postListIds}\n                atBottom={this.state.atBottom}\n                width={width}\n                lastViewedBottom={this.state.lastViewedBottom}\n                latestPostTimeStamp={this.props.latestPostTimeStamp}\n                scrollToNewMessage={this.scrollToNewMessage}\n                scrollToLatestMessages={this.scrollToLatestMessages}\n                updateNewMessagesAtInChannel={this.updateNewMessagesAtInChannel}\n                updateLastViewedBottomAt={this.updateLastViewedBottomAt}\n                channelId={this.props.channelId}\n                focusedPostId={this.props.focusedPostId}\n                initScrollOffsetFromBottom={this.state.initScrollOffsetFromBottom}\n            />\n        );\n    }\n\n    render() {\n        const channelId = this.props.channelId;\n        let ariaLabel;\n        if (this.props.latestAriaLabelFunc && this.props.postListIds.indexOf(PostListRowListIds.START_OF_NEW_MESSAGES) >= 0) {\n            ariaLabel = this.props.latestAriaLabelFunc(this.props.intl);\n        }\n        const {dynamicListStyle} = this.state;\n\n        return (\n            <div\n                role='list'\n                className='a11y__region'\n                data-a11y-sort-order='1'\n                data-a11y-focus-child={true}\n                data-a11y-order-reversed={true}\n                data-a11y-loop-navigation={false}\n                aria-label={Utils.localizeMessage('accessibility.sections.centerContent', 'message list main region')}\n            >\n                {this.state.isMobile && (\n                    <React.Fragment>\n                        <FloatingTimestamp\n                            isScrolling={this.state.isScrolling}\n                            isMobile={true}\n                            postId={this.state.topPostId}\n                        />\n                        <ScrollToBottomArrows\n                            isScrolling={this.state.isScrolling}\n                            atBottom={this.state.atBottom}\n                            onClick={this.scrollToBottom}\n                        />\n                    </React.Fragment>\n                )}\n                <div\n                    role='presentation'\n                    className='post-list-holder-by-time'\n                    key={'postlist-' + channelId}\n                >\n                    <div\n                        role='presentation'\n                        className='post-list__table'\n                    >\n                        <div\n                            id='postListContent'\n                            className='post-list__content'\n                        >\n                            <span\n                                className='sr-only'\n                                aria-live='polite'\n                            >\n                                {ariaLabel}\n                            </span>\n                            <AutoSizer>\n                                {({height, width}) => (\n                                    <React.Fragment>\n                                        <div>{this.renderToasts(width)}</div>\n                                        <DynamicSizeList\n                                            ref={this.listRef}\n                                            height={height}\n                                            width={width}\n                                            className='post-list__dynamic'\n                                            itemCount={this.state.postListIds.length}\n                                            itemData={this.state.postListIds}\n                                            itemKey={this.itemKey}\n                                            overscanCountForward={OVERSCAN_COUNT_FORWARD}\n                                            overscanCountBackward={OVERSCAN_COUNT_BACKWARD}\n                                            onScroll={this.onScroll}\n                                            initScrollToIndex={this.initScrollToIndex}\n                                            canLoadMorePosts={this.props.actions.canLoadMorePosts}\n                                            skipResizeClass='col__reply'\n                                            innerRef={this.postListRef}\n                                            style={{...virtListStyles, ...dynamicListStyle}}\n                                            innerListStyle={postListStyle}\n                                            initRangeToRender={this.initRangeToRender}\n                                            loaderId={PostListRowListIds.OLDER_MESSAGES_LOADER}\n                                            correctScrollToBottom={this.props.atLatestPost}\n                                            onItemsRendered={this.onItemsRendered}\n                                            scrollToFailed={this.scrollToFailed}\n                                        >\n                                            {this.renderRow}\n                                        </DynamicSizeList>\n                                    </React.Fragment>\n                                )}\n                            </AutoSizer>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default injectIntl(PostList);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport LoadingScreen from 'components/loading_screen';\nimport {PostRequestTypes} from 'utils/constants';\n\nimport {getOldestPostId, getLatestPostId} from 'utils/post_utils.jsx';\n\nimport VirtPostList from 'components/post_view/post_list_virtualized/post_list_virtualized';\n\nconst MAX_NUMBER_OF_AUTO_RETRIES = 3;\nexport const MAX_EXTRA_PAGES_LOADED = 10;\n\nexport default class PostList extends React.PureComponent {\n    static propTypes = {\n\n        /**\n         *  Array of formatted post ids in the channel\n         *  This will be different from postListIds because of grouping and filtering of posts\n         *  This array should be used for making Before and After API calls\n         */\n        formattedPostIds: PropTypes.array,\n\n        /**\n         *  Array of post ids in the channel, ordered from newest to oldest\n         */\n        postListIds: PropTypes.array,\n\n        /**\n         * The channel the posts are in\n         */\n        channelId: PropTypes.string,\n\n        /*\n         * To get posts for perma view\n         */\n        focusedPostId: PropTypes.string,\n\n        /*\n         * Used for determining if we are not at the recent most chunk in channel\n         */\n        atLatestPost: PropTypes.bool,\n\n        /*\n         * Used for determining if we are at the channels oldest post\n         */\n        atOldestPost: PropTypes.bool,\n\n        /*\n         * Used for loading posts using unread API\n         */\n        isFirstLoad: PropTypes.bool,\n\n        /*\n         * Used for syncing posts and is also passed down to virt list for newMessages indicator\n         */\n        latestPostTimeStamp: PropTypes.number,\n\n        latestAriaLabelFunc: PropTypes.func,\n\n        /**\n         * Lastest post id of the current post list, this doesnt include timestamps etc, just actual posts\n         */\n        latestPostId: PropTypes.string,\n\n        /*\n         * Used for passing down to virt list so it can change the chunk of posts selected\n         */\n        changeUnreadChunkTimeStamp: PropTypes.func.isRequired,\n\n        prevChannelId: PropTypes.string.isRequired,\n        actions: PropTypes.shape({\n\n            /*\n             * Used for getting permalink view posts\n             */\n            loadPostsAround: PropTypes.func.isRequired,\n\n            /*\n             * Used for geting unreads posts\n             */\n            loadUnreads: PropTypes.func.isRequired,\n\n            /*\n             * Used for getting posts using BEFORE_ID and AFTER_ID\n             */\n            loadPosts: PropTypes.func.isRequired,\n\n            /*\n             * Used to set mobile view on resize\n             */\n            checkAndSetMobileView: PropTypes.func.isRequired,\n\n            /*\n             * Used to loading posts since a timestamp to sync the posts\n             */\n            syncPostsInChannel: PropTypes.func.isRequired,\n\n            /*\n             * Used to loading posts if it not first visit, permalink or there exists any postListIds\n             * This happens when previous channel visit has a chunk which is not the latest set of posts\n             */\n            loadLatestPosts: PropTypes.func.isRequired,\n\n            markChannelAsViewed: PropTypes.func.isRequired,\n\n            markChannelAsRead: PropTypes.func.isRequired,\n            updateNewMessagesAtInChannel: PropTypes.func.isRequired,\n\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            loadingNewerPosts: false,\n            loadingOlderPosts: false,\n            autoRetryEnable: true,\n        };\n\n        this.autoRetriesCount = 0;\n        this.loadingMorePosts = null;\n        this.actionsForPostList = {\n            loadOlderPosts: this.getPostsBefore,\n            loadNewerPosts: this.getPostsAfter,\n            checkAndSetMobileView: props.actions.checkAndSetMobileView,\n            canLoadMorePosts: this.canLoadMorePosts,\n            changeUnreadChunkTimeStamp: props.changeUnreadChunkTimeStamp,\n            updateNewMessagesAtInChannel: this.props.actions.updateNewMessagesAtInChannel,\n        };\n    }\n\n    componentDidMount() {\n        this.mounted = true;\n        if (this.props.channelId) {\n            this.postsOnLoad(this.props.channelId);\n        }\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.channelId !== prevProps.channelId) {\n            this.postsOnLoad(this.props.channelId);\n        }\n    }\n\n    componentWillUnmount() {\n        this.mounted = false;\n    }\n\n    postsOnLoad = async (channelId) => {\n        if (this.props.focusedPostId) {\n            await this.props.actions.loadPostsAround(channelId, this.props.focusedPostId);\n        } else if (this.props.isFirstLoad) {\n            await this.props.actions.loadUnreads(channelId);\n        } else if (this.props.latestPostTimeStamp) {\n            await this.props.actions.syncPostsInChannel(channelId, this.props.latestPostTimeStamp, false);\n        } else {\n            await this.props.actions.loadLatestPosts(channelId);\n        }\n\n        if (!this.props.focusedPostId) {\n            this.markChannelAsReadAndViewed();\n        }\n        if (this.mounted) {\n            this.setState({\n                loadingOlderPosts: false,\n                loadingNewerPosts: false,\n            });\n        }\n    }\n\n    callLoadPosts = async (channelId, postId, type) => {\n        const {error} = await this.props.actions.loadPosts({\n            channelId,\n            postId,\n            type,\n        });\n\n        if (type === PostRequestTypes.BEFORE_ID) {\n            this.setState({loadingOlderPosts: false});\n        } else {\n            this.setState({loadingNewerPosts: false});\n        }\n\n        if (error) {\n            if (this.autoRetriesCount < MAX_NUMBER_OF_AUTO_RETRIES) {\n                this.autoRetriesCount++;\n                await this.callLoadPosts(channelId, postId, type);\n            } else if (this.mounted) {\n                this.setState({autoRetryEnable: false});\n            }\n        } else {\n            if (this.mounted) {\n                this.setState({autoRetryEnable: true});\n            }\n\n            if (!this.state.autoRetryEnable) {\n                this.autoRetriesCount = 0;\n            }\n        }\n\n        return {error};\n    }\n\n    markChannelAsReadAndViewed = () => {\n        const currentChannelId = this.props.channelId;\n        const prevChannelId = this.props.prevChannelId;\n\n        // Mark previous and next channel as read\n        // Posts are marked as read from here to not cause a race when loading posts\n        // marking channel as read and viewed after calling for posts in channel\n        this.props.actions.markChannelAsViewed(currentChannelId, prevChannelId);\n        this.props.actions.markChannelAsRead(currentChannelId, prevChannelId);\n    }\n\n    getOldestVisiblePostId = () => {\n        return getOldestPostId(this.props.postListIds);\n    }\n\n    getLatestVisiblePostId = () => {\n        return getLatestPostId(this.props.postListIds);\n    }\n\n    canLoadMorePosts = async (type = PostRequestTypes.BEFORE_ID) => {\n        if (!this.props.postListIds) {\n            return;\n        }\n\n        if (this.state.loadingOlderPosts || this.state.loadingNewerPosts) {\n            return;\n        }\n\n        if (this.extraPagesLoaded > MAX_EXTRA_PAGES_LOADED) {\n            // Prevent this from loading a lot of pages in a channel with only hidden messages\n            // Enable load more messages manual link\n            if (this.state.autoRetryEnable) {\n                this.setState({autoRetryEnable: false});\n            }\n            return;\n        }\n\n        if (!this.props.atOldestPost && type === PostRequestTypes.BEFORE_ID) {\n            const oldestPostId = this.getOldestVisiblePostId();\n            await this.getPostsBefore(oldestPostId);\n        } else if (!this.props.atLatestPost) {\n            // if all olderPosts are loaded load new ones\n            const latestPostId = this.getLatestVisiblePostId();\n            await this.getPostsAfter(latestPostId);\n        }\n\n        this.extraPagesLoaded += 1;\n    }\n\n    getPostsBefore = async () => {\n        if (this.state.loadingOlderPosts) {\n            return;\n        }\n        const oldestPostId = this.getOldestVisiblePostId();\n        this.setState({loadingOlderPosts: true});\n        await this.callLoadPosts(this.props.channelId, oldestPostId, PostRequestTypes.BEFORE_ID);\n    }\n\n    getPostsAfter = async () => {\n        if (this.state.loadingNewerPosts) {\n            return;\n        }\n        const latestPostId = this.getLatestVisiblePostId();\n        this.setState({loadingNewerPosts: true});\n        await this.callLoadPosts(this.props.channelId, latestPostId, PostRequestTypes.AFTER_ID);\n    }\n\n    render() {\n        if (!this.props.postListIds) {\n            return (\n                <LoadingScreen\n                    position='absolute'\n                    key='loading'\n                />\n            );\n        }\n\n        return (\n            <div\n                ref='postlist'\n                className='post-list-holder-by-time'\n                key={'postlist-' + this.props.channelId}\n            >\n                <div className='post-list__table'>\n                    <div\n                        id='virtualizedPostListContent'\n                        ref='postListContent'\n                        className='post-list__content'\n                    >\n                        <VirtPostList\n                            loadingNewerPosts={this.state.loadingNewerPosts}\n                            loadingOlderPosts={this.state.loadingOlderPosts}\n                            atOldestPost={this.props.atOldestPost}\n                            atLatestPost={this.props.atLatestPost}\n                            focusedPostId={this.props.focusedPostId}\n                            channelId={this.props.channelId}\n                            autoRetryEnable={this.state.autoRetryEnable}\n                            actions={this.actionsForPostList}\n                            postListIds={this.props.formattedPostIds}\n                            latestPostTimeStamp={this.props.latestPostTimeStamp}\n                            latestAriaLabelFunc={this.props.latestAriaLabelFunc}\n                            latestPostId={this.props.latestPostId}\n                        />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {withRouter} from 'react-router-dom';\nimport {getRecentPostsChunkInChannel, makeGetPostsChunkAroundPost, getUnreadPostsChunk, getPost} from 'mattermost-redux/selectors/entities/posts';\nimport {memoizeResult} from 'mattermost-redux/utils/helpers';\nimport {markChannelAsRead, markChannelAsViewed} from 'mattermost-redux/actions/channels';\nimport {makePreparePostIdsForPostList} from 'mattermost-redux/utils/post_list';\n\nimport {updateNewMessagesAtInChannel} from 'actions/global_actions.jsx';\nimport {getLatestPostId, makeCreateAriaLabelForPost} from 'utils/post_utils.jsx';\nimport {\n    checkAndSetMobileView,\n    loadPosts,\n    loadUnreads,\n    loadPostsAround,\n    syncPostsInChannel,\n    loadLatestPosts,\n} from 'actions/views/channel';\n\nimport PostList from './post_list.jsx';\n\nconst isFirstLoad = (state, channelId) => !state.entities.posts.postsInChannel[channelId];\nconst memoizedGetLatestPostId = memoizeResult((postIds) => getLatestPostId(postIds));\n\n// This function is added as a fail safe for the channel sync issue we have.\n// When the user switches to a team for the first time we show the channel of previous team and then settle for the right channel after that\n// This causes the scroll correction etc an issue because post_list is not mounted for new channel instead it is updated\n\nfunction makeMapStateToProps() {\n    const getPostsChunkAroundPost = makeGetPostsChunkAroundPost();\n    const preparePostIdsForPostList = makePreparePostIdsForPostList();\n    const createAriaLabelForPost = makeCreateAriaLabelForPost();\n\n    return function mapStateToProps(state, ownProps) {\n        let latestPostTimeStamp = 0;\n        let postIds;\n        let chunk;\n        let atLatestPost = false;\n        let atOldestPost = false;\n        let formattedPostIds;\n        let latestAriaLabelFunc;\n        const lastViewedAt = state.views.channel.lastChannelViewTime[ownProps.channelId];\n\n        if (ownProps.focusedPostId && ownProps.unreadChunkTimeStamp !== '') {\n            chunk = getPostsChunkAroundPost(state, ownProps.focusedPostId, ownProps.channelId);\n        } else if (ownProps.unreadChunkTimeStamp) {\n            chunk = getUnreadPostsChunk(state, ownProps.channelId, ownProps.unreadChunkTimeStamp);\n        } else {\n            chunk = getRecentPostsChunkInChannel(state, ownProps.channelId);\n        }\n\n        if (chunk) {\n            postIds = chunk.order;\n            atLatestPost = chunk.recent;\n            atOldestPost = chunk.oldest;\n        }\n\n        if (postIds) {\n            formattedPostIds = preparePostIdsForPostList(state, {postIds, lastViewedAt, indicateNewMessages: true, channelId: ownProps.channelId});\n            if (postIds.length) {\n                const latestPostId = memoizedGetLatestPostId(postIds);\n                const latestPost = getPost(state, latestPostId);\n                latestPostTimeStamp = latestPost.create_at;\n                latestAriaLabelFunc = createAriaLabelForPost(state, latestPost);\n            }\n        }\n\n        return {\n            lastViewedAt,\n            isFirstLoad: isFirstLoad(state, ownProps.channelId),\n            formattedPostIds,\n            atLatestPost,\n            atOldestPost,\n            latestPostTimeStamp,\n            postListIds: postIds,\n            latestAriaLabelFunc,\n        };\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            loadUnreads,\n            loadPosts,\n            loadLatestPosts,\n            loadPostsAround,\n            checkAndSetMobileView,\n            syncPostsInChannel,\n            markChannelAsViewed,\n            markChannelAsRead,\n            updateNewMessagesAtInChannel,\n        }, dispatch),\n    };\n}\n\nexport default withRouter(connect(makeMapStateToProps, mapDispatchToProps)(PostList));\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport LoadingScreen from 'components/loading_screen';\n\nimport PostList from './post_list';\n\nexport default class PostView extends React.PureComponent {\n    static propTypes = {\n        lastViewedAt: PropTypes.number,\n        channelLoading: PropTypes.bool,\n        channelId: PropTypes.string,\n        focusedPostId: PropTypes.string,\n        prevChannelId: PropTypes.string.isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            unreadChunkTimeStamp: props.lastViewedAt,\n            loaderForChangeOfPostsChunk: false,\n            channelLoading: props.channelLoading,\n        };\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        if (state.unreadChunkTimeStamp === null && props.lastViewedAt) {\n            return {\n                unreadChunkTimeStamp: props.lastViewedAt,\n            };\n        }\n        if (props.channelLoading !== state.channelLoading) {\n            return {\n                unreadChunkTimeStamp: props.lastViewedAt,\n                channelLoading: props.channelLoading,\n            };\n        }\n\n        return null;\n    }\n\n    changeUnreadChunkTimeStamp = (unreadChunkTimeStamp) => {\n        this.setState({\n            unreadChunkTimeStamp,\n            loaderForChangeOfPostsChunk: true,\n        }, () => {\n            window.requestAnimationFrame(() => {\n                this.setState({\n                    loaderForChangeOfPostsChunk: false,\n                });\n            });\n        });\n    }\n\n    render() {\n        if (this.props.channelLoading || this.state.loaderForChangeOfPostsChunk) {\n            return (\n                <div id='post-list'>\n                    <LoadingScreen\n                        position='absolute'\n                        key='loading'\n                    />\n                </div>\n            );\n        }\n\n        return (\n            <div\n                id='post-list'\n                role='main'\n            >\n                <PostList\n                    unreadChunkTimeStamp={this.state.unreadChunkTimeStamp}\n                    channelId={this.props.channelId}\n                    changeUnreadChunkTimeStamp={this.changeUnreadChunkTimeStamp}\n                    focusedPostId={this.props.focusedPostId}\n                    prevChannelId={this.props.prevChannelId}\n                />\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {withRouter} from 'react-router-dom';\nimport {getChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getUser} from 'mattermost-redux/selectors/entities/users';\nimport {getTeamByName, getTeamMemberships} from 'mattermost-redux/selectors/entities/teams';\n\nimport {Constants} from 'utils/constants';\n\nimport PostView from './post_view.jsx';\n\nexport const isChannelLoading = (params, channel, team, teammate, teamMemberships) => {\n    if (params.postid) {\n        return false;\n    }\n\n    if (channel && team) {\n        if (channel.type !== Constants.DM_CHANNEL && channel.name !== params.identifier) {\n            return true;\n        } else if (channel.type === Constants.DM_CHANNEL && teammate && params.identifier !== `@${teammate.username}`) {\n            return true;\n        }\n\n        const teamId = team.id;\n        if ((channel.team_id && channel.team_id !== teamId) || (teamMemberships && !teamMemberships[teamId])) {\n            return true;\n        }\n\n        return false;\n    }\n\n    return true;\n};\n\nfunction makeMapStateToProps() {\n    return function mapStateToProps(state, ownProps) {\n        const team = getTeamByName(state, ownProps.match.params.team);\n        let teammate;\n\n        const channel = getChannel(state, ownProps.channelId);\n        let lastViewedAt = state.views.channel.lastChannelViewTime[ownProps.channelId];\n        if (channel) {\n            if (channel.type === Constants.DM_CHANNEL && channel.teammate_id) {\n                teammate = getUser(state, channel.teammate_id);\n            }\n            lastViewedAt = channel.last_post_at ? lastViewedAt : channel.last_post_at;\n        }\n\n        const teamMemberships = getTeamMemberships(state);\n        const channelLoading = isChannelLoading(ownProps.match.params, channel, team, teammate, teamMemberships);\n        return {\n            lastViewedAt,\n            channelLoading,\n            channel,\n        };\n    };\n}\n\nexport default withRouter(connect(makeMapStateToProps)(PostView));\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport {trackEvent} from 'actions/diagnostics_actions.jsx';\nimport {Constants, Preferences, ModalIdentifiers} from 'utils/constants.jsx';\nimport {useSafeUrl} from 'utils/url';\nimport AppIcons from 'images/appIcons.png';\nimport ModalToggleButtonRedux from 'components/toggle_modal_button_redux';\nimport InvitationModal from 'components/invitation_modal';\n\nconst NUM_SCREENS = 3;\n\nexport default class TutorialIntroScreens extends React.Component {\n    static propTypes = {\n        currentUserId: PropTypes.string.isRequired,\n        step: PropTypes.number,\n        townSquareDisplayName: PropTypes.string.isRequired,\n        appDownloadLink: PropTypes.string,\n        isLicensed: PropTypes.bool.isRequired,\n        restrictTeamInvite: PropTypes.bool.isRequired,\n        supportEmail: PropTypes.string.isRequired,\n        actions: PropTypes.shape({\n            savePreferences: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {currentScreen: 0};\n    }\n\n    handleNext = () => {\n        switch (this.state.currentScreen) {\n        case 0:\n            trackEvent('tutorial', 'tutorial_screen_1_welcome_to_mattermost_next');\n            break;\n        case 1:\n            trackEvent('tutorial', 'tutorial_screen_2_how_mattermost_works_next');\n            break;\n        case 2:\n            trackEvent('tutorial', 'tutorial_screen_3_youre_all_set_next');\n            break;\n        }\n\n        if (this.state.currentScreen < 2) {\n            this.setState({currentScreen: this.state.currentScreen + 1});\n            return;\n        }\n\n        const {currentUserId} = this.props;\n        const preferences = [{\n            user_id: currentUserId,\n            category: Preferences.TUTORIAL_STEP,\n            name: currentUserId,\n            value: (this.props.step + 1).toString(),\n        }];\n\n        this.props.actions.savePreferences(currentUserId, preferences);\n    }\n\n    skipTutorial = (e) => {\n        e.preventDefault();\n\n        switch (this.state.currentScreen) {\n        case 0:\n            trackEvent('tutorial', 'tutorial_screen_1_welcome_to_mattermost_skip');\n            break;\n        case 1:\n            trackEvent('tutorial', 'tutorial_screen_2_how_mattermost_works_skip');\n            break;\n        case 2:\n            trackEvent('tutorial', 'tutorial_screen_3_youre_all_set_skip');\n            break;\n        }\n\n        const {currentUserId} = this.props;\n        const preferences = [{\n            user_id: currentUserId,\n            category: Preferences.TUTORIAL_STEP,\n            name: currentUserId,\n            value: Constants.TutorialSteps.FINISHED.toString(),\n        }];\n\n        this.props.actions.savePreferences(currentUserId, preferences);\n    }\n    createScreen = () => {\n        switch (this.state.currentScreen) {\n        case 0:\n            return this.createScreenOne();\n        case 1:\n            return this.createScreenTwo();\n        case 2:\n            return this.createScreenThree();\n        }\n        return null;\n    }\n\n    createScreenOne() {\n        const circles = this.createCircles();\n\n        return (\n            <div id='tutorialIntroOne'>\n                <h3>\n                    <FormattedMessage\n                        id='tutorial_intro.screenOne.title1'\n                        defaultMessage='Welcome to:'\n                    />\n                </h3>\n                <h1>\n                    <FormattedMessage\n                        id='tutorial_intro.screenOne.title2'\n                        defaultMessage='Mattermost'\n                    />\n                </h1>\n                <p>\n                    <FormattedMessage\n                        id='tutorial_intro.screenOne.body1'\n                        defaultMessage='Your team communication all in one place, instantly searchable and available anywhere.'\n                    />\n                </p>\n                <p>\n                    <FormattedMessage\n                        id='tutorial_intro.screenOne.body2'\n                        defaultMessage='Keep your team connected to help them achieve what matters most.'\n                    />\n                </p>\n                {circles}\n            </div>\n        );\n    }\n\n    createScreenTwo() {\n        const circles = this.createCircles();\n\n        let appDownloadLink = null;\n        let appDownloadImage = null;\n        if (this.props.appDownloadLink) {\n            const link = useSafeUrl(this.props.appDownloadLink);\n\n            // not using a FormattedHTMLMessage here since appDownloadLink is configurable and could be used\n            // to inject HTML if we're not careful\n            appDownloadLink = (\n                <FormattedMessage\n                    id='tutorial_intro.mobileApps'\n                    defaultMessage='Install the apps for {link} for easy access and notifications on the go.'\n                    values={{\n                        link: (\n                            <a\n                                id='appDownloadLink'\n                                href={link}\n                                target='_blank'\n                                rel='noopener noreferrer'\n                            >\n                                <FormattedMessage\n                                    id='tutorial_intro.mobileAppsLinkText'\n                                    defaultMessage='PC, Mac, iOS and Android'\n                                />\n                            </a>\n                        ),\n                    }}\n                />\n            );\n\n            appDownloadImage = (\n                <a\n                    id='appDownloadImage'\n                    href={link}\n                    target='_blank'\n                    rel='noopener noreferrer'\n                >\n                    <img\n                        alt={'tutorial icons'}\n                        className='tutorial__app-icons'\n                        src={AppIcons}\n                    />\n                </a>\n            );\n        }\n\n        return (\n            <div id='tutorialIntroTwo'>\n                <h3>\n                    <FormattedMessage\n                        id='tutorial_intro.screenTwo.title'\n                        defaultMessage='How Mattermost Works:'\n                    />\n                </h3>\n                <p>\n                    <FormattedMessage\n                        id='tutorial_intro.screenTwo.body1'\n                        defaultMessage='Communication happens in public discussion channels, private channels and direct messages.'\n                    />\n                </p>\n                <p>\n                    <FormattedMessage\n                        id='tutorial_intro.screenTwo.body2'\n                        defaultMessage='Everything is archived and searchable from any web-enabled desktop, laptop or phone.'\n                    />\n                </p>\n                {appDownloadLink}\n                {appDownloadImage}\n                {circles}\n            </div>\n        );\n    }\n\n    createScreenThree() {\n        let inviteModalLink;\n        let inviteText;\n\n        if (!this.props.isLicensed || !this.props.restrictTeamInvite) {\n            inviteModalLink = (\n                <ModalToggleButtonRedux\n                    id='tutorialIntroInvite'\n                    className='intro-links color--link style--none'\n                    modalId={ModalIdentifiers.INVITATION}\n                    dialogType={InvitationModal}\n                >\n                    <FormattedMessage\n                        id='tutorial_intro.invite'\n                        defaultMessage='Invite Teammates'\n                    />\n                </ModalToggleButtonRedux>\n            );\n\n            inviteText = (\n                <p>\n                    {inviteModalLink}\n                    <FormattedMessage\n                        id='tutorial_intro.whenReady'\n                        defaultMessage={' when you\\'re ready.'}\n                    />\n                </p>\n            );\n        }\n\n        const circles = this.createCircles();\n\n        let supportInfo = null;\n        if (this.props.supportEmail) {\n            supportInfo = (\n                <p id='supportInfo'>\n                    <FormattedMessage\n                        id='tutorial_intro.support'\n                        defaultMessage='Need anything, just email us at '\n                    />\n                    <a\n                        href={'mailto:' + this.props.supportEmail}\n                        target='_blank'\n                        rel='noopener noreferrer'\n                    >\n                        {this.props.supportEmail}\n                    </a>\n                    {'.'}\n                </p>\n            );\n        }\n\n        return (\n            <div id='tutorialIntroThree'>\n                <h3>\n                    <FormattedMessage\n                        id='tutorial_intro.allSet'\n                        defaultMessage={'You\\'re all set'}\n                    />\n                </h3>\n                {inviteText}\n                {supportInfo}\n                <FormattedMessage\n                    id='tutorial_intro.end'\n                    defaultMessage='Click \"Next\" to enter {channel}. This is the first channel teammates see when they sign up. Use it for posting updates everyone needs to know.'\n                    values={{\n                        channel: this.props.townSquareDisplayName,\n                    }}\n                />\n                {circles}\n            </div>\n        );\n    }\n\n    handleCircleClick = (e, screen) => {\n        e.preventDefault();\n        this.setState({currentScreen: screen});\n    }\n\n    createCircles = () => {\n        const circles = [];\n        for (let i = 0; i < NUM_SCREENS; i++) {\n            let className = 'circle';\n            if (i === this.state.currentScreen) {\n                className += ' active';\n            }\n\n            circles.push(\n                <a\n                    id={'tutorialIntroCircle' + i}\n                    href='#'\n                    key={'circle' + i}\n                    className={className}\n                    data-screen={i}\n                    onClick={(e) => this.handleCircleClick(e, i)}\n                />\n            );\n        }\n\n        return (\n            <div className='tutorial__circles'>\n                {circles}\n            </div>\n        );\n    }\n\n    render() {\n        const screen = this.createScreen();\n\n        return (\n            <div className='tutorial-steps__container'>\n                <div\n                    id='tutorialIntroContent'\n                    className='tutorial__content'\n                >\n                    <div className='tutorial__steps'>\n                        {screen}\n                        <div className='tutorial__footer'>\n                            <button\n                                id='tutorialNextButton'\n                                className='btn btn-primary'\n                                onClick={this.handleNext}\n                            >\n                                <FormattedMessage\n                                    id='tutorial_intro.next'\n                                    defaultMessage='Next'\n                                />\n                            </button>\n                            <a\n                                id='tutorialSkipLink'\n                                className='tutorial-skip'\n                                href='#'\n                                onClick={this.skipTutorial}\n                            >\n                                <FormattedMessage\n                                    id='tutorial_intro.skip'\n                                    defaultMessage='Skip Tutorial'\n                                />\n                            </a>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getInt} from 'mattermost-redux/selectors/entities/preferences';\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\n\nimport {Preferences} from 'utils/constants';\n\nimport TutorialIntroScreens from './tutorial_intro_screens.jsx';\n\nfunction mapStateToProps(state) {\n    const currentUserId = getCurrentUserId(state);\n    return {\n        currentUserId,\n        step: getInt(state, Preferences.TUTORIAL_STEP, currentUserId, 0),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {actions: bindActionCreators({\n        savePreferences,\n    }, dispatch)};\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TutorialIntroScreens);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport $ from 'jquery';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport TutorialIntroScreens from './tutorial_intro_screens';\n\nexport default class TutorialView extends React.Component {\n    componentDidMount() {\n        if (this.props.isRoot) {\n            $('body').addClass('app__body');\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.props.isRoot) {\n            $('body').removeClass('app__body');\n        }\n    }\n\n    render() {\n        return (\n            <div\n                id='app-content'\n                className='app__content'\n            >\n                <TutorialIntroScreens\n                    townSquareDisplayName={this.props.townSquareDisplayName}\n                    appDownloadLink={this.props.appDownloadLink}\n                    isLicensed={this.props.isLicensed}\n                    restrictTeamInvite={this.props.restrictTeamInvite}\n                    supportEmail={this.props.supportEmail}\n                />\n            </div>\n        );\n    }\n}\n\nTutorialView.propTypes = {\n    isRoot: PropTypes.bool,\n    townSquareDisplayName: PropTypes.string.isRequired,\n    appDownloadLink: PropTypes.string,\n    isLicensed: PropTypes.bool.isRequired,\n    restrictTeamInvite: PropTypes.bool.isRequired,\n    supportEmail: PropTypes.string.isRequired,\n};\n\nTutorialView.defaultProps = {\n    isRoot: true,\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\nimport {connect} from 'react-redux';\n\nimport {Permissions} from 'mattermost-redux/constants';\nimport {getChannelsNameMapInCurrentTeam} from 'mattermost-redux/selectors/entities/channels';\nimport {getLicense, getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\n\nimport Constants from 'utils/constants';\n\nimport TutorialView from './tutorial_view.jsx';\n\nfunction mapStateToProps(state) {\n    const license = getLicense(state);\n    const config = getConfig(state);\n\n    const team = getCurrentTeam(state);\n\n    const teamChannels = getChannelsNameMapInCurrentTeam(state);\n    const townSquare = teamChannels[Constants.DEFAULT_CHANNEL];\n    const townSquareDisplayName = townSquare ? townSquare.display_name : Constants.DEFAULT_CHANNEL_UI_NAME;\n\n    const appDownloadLink = config.AppDownloadLink;\n    const isLicensed = license.IsLicensed === 'true';\n    const restrictTeamInvite = !haveITeamPermission(state, {team: team.id, permission: Permissions.INVITE_USER});\n    const supportEmail = config.SupportEmail;\n\n    return {\n        townSquareDisplayName,\n        appDownloadLink,\n        isLicensed,\n        restrictTeamInvite,\n        supportEmail,\n    };\n}\n\nexport default connect(mapStateToProps)(TutorialView);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {FormattedMessage} from 'react-intl';\n\nimport deferComponentRender from 'components/deferComponentRender';\nimport ChannelHeader from 'components/channel_header';\nimport CreatePost from 'components/create_post';\nimport FileUploadOverlay from 'components/file_upload_overlay';\nimport PostView from 'components/post_view';\nimport TutorialView from 'components/tutorial';\nimport {clearMarks, mark, measure, trackEvent} from 'actions/diagnostics_actions.jsx';\nimport FormattedMarkdownMessage from 'components/formatted_markdown_message';\n\nexport default class ChannelView extends React.PureComponent {\n    static propTypes = {\n        channelId: PropTypes.string.isRequired,\n        deactivatedChannel: PropTypes.bool.isRequired,\n        match: PropTypes.shape({\n            url: PropTypes.string.isRequired,\n            params: PropTypes.shape({\n                postid: PropTypes.string,\n            }).isRequired,\n        }).isRequired,\n        showTutorial: PropTypes.bool.isRequired,\n        channelIsArchived: PropTypes.bool.isRequired,\n        viewArchivedChannels: PropTypes.bool.isRequired,\n        actions: PropTypes.shape({\n            goToLastViewedChannel: PropTypes.func.isRequired,\n        }),\n    };\n\n    static createDeferredPostView = () => {\n        return deferComponentRender(\n            PostView,\n            <div\n                id='post-list'\n                className='a11y__region'\n                data-a11y-sort-order='1'\n                data-a11y-focus-child={true}\n                data-a11y-order-reversed={true}\n            />\n        );\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        let updatedState = {};\n        const focusedPostId = props.match.params.postid;\n\n        if (props.match.url !== state.url && props.channelId !== state.channelId) {\n            updatedState = {deferredPostView: ChannelView.createDeferredPostView(), url: props.match.url, focusedPostId};\n        }\n\n        if (props.channelId !== state.channelId) {\n            updatedState = {...updatedState, channelId: props.channelId, prevChannelId: state.channelId, focusedPostId};\n        }\n\n        if (focusedPostId && focusedPostId !== state.focusedPostId) {\n            updatedState = {...updatedState, focusedPostId};\n        }\n\n        if (Object.keys(updatedState).length) {\n            return updatedState;\n        }\n\n        return null;\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            url: props.match.url,\n            channelId: props.channelId,\n            prevChannelId: '',\n            deferredPostView: ChannelView.createDeferredPostView(),\n        };\n    }\n\n    getChannelView = () => {\n        return this.refs.channelView;\n    }\n\n    onClickCloseChannel = () => {\n        this.props.actions.goToLastViewedChannel();\n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.channelId !== this.props.channelId || prevProps.channelIsArchived !== this.props.channelIsArchived) {\n            mark('ChannelView#componentDidUpdate');\n\n            const [dur1] = measure('SidebarChannelLink#click', 'ChannelView#componentDidUpdate');\n            const [dur2] = measure('TeamLink#click', 'ChannelView#componentDidUpdate');\n\n            clearMarks([\n                'SidebarChannelLink#click',\n                'ChannelView#componentDidUpdate',\n                'TeamLink#click',\n            ]);\n\n            if (dur1 !== -1) {\n                trackEvent('performance', 'channel_switch', {duration: Math.round(dur1)});\n            }\n            if (dur2 !== -1) {\n                trackEvent('performance', 'team_switch', {duration: Math.round(dur2)});\n            }\n            if (this.props.channelIsArchived && !this.props.viewArchivedChannels) {\n                this.props.actions.goToLastViewedChannel();\n            }\n        }\n    }\n\n    render() {\n        const {channelIsArchived} = this.props;\n        if (this.props.showTutorial) {\n            return (\n                <TutorialView\n                    isRoot={false}\n                />\n            );\n        }\n\n        let createPost;\n        if (this.props.deactivatedChannel) {\n            createPost = (\n                <div\n                    className='post-create-message'\n                >\n                    <FormattedMessage\n                        id='create_post.deactivated'\n                        defaultMessage='You are viewing an archived channel with a deactivated user.'\n                    />\n                </div>\n            );\n        } else {\n            createPost = (\n                <div\n                    className='post-create__container'\n                    id='post-create'\n                >\n                    {!channelIsArchived &&\n                        <CreatePost\n                            getChannelView={this.getChannelView}\n                        />\n                    }\n                    {channelIsArchived &&\n                        <div\n                            id='channelArchivedMessage'\n                            className='channel-archived__message'\n                        >\n                            <FormattedMarkdownMessage\n                                id='archivedChannelMessage'\n                                defaultMessage='You are viewing an **archived channel**. New messages cannot be posted.'\n                            />\n                            <button\n                                className='btn btn-primary channel-archived__close-btn'\n                                onClick={this.onClickCloseChannel}\n                            >\n                                <FormattedMessage\n                                    id='center_panel.archived.closeChannel'\n                                    defaultMessage='Close Channel'\n                                />\n                            </button>\n                        </div>\n                    }\n                </div>\n            );\n        }\n\n        const DeferredPostView = this.state.deferredPostView;\n\n        return (\n            <div\n                ref='channelView'\n                id='app-content'\n                className='app__content'\n            >\n                <FileUploadOverlay overlayType='center'/>\n                <ChannelHeader\n                    channelId={this.props.channelId}\n                />\n                <DeferredPostView\n                    channelId={this.props.channelId}\n                    prevChannelId={this.state.prevChannelId}\n                    focusedPostId={this.state.focusedPostId}\n                />\n                {createPost}\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport hoistStatics from 'hoist-non-react-statics';\nimport React from 'react';\n\n/**\n * Allows two animation frames to complete to allow other components to update\n * and re-render before mounting and rendering an expensive `WrappedComponent`.\n * If provided, `PreRenderComponent` will be rendered instead of null when not\n * rendering the `Wrapped Component`.\n *\n * Based on this Twitter built component\n * https://gist.github.com/paularmstrong/cc2ead7e2a0dec37d8b2096fc8d85759#file-defercomponentrender-js\n */\nexport default function deferComponentRender(WrappedComponent, PreRenderComponent = null) {\n    class DeferredRenderWrapper extends React.Component {\n        constructor(props, context) {\n            super(props, context);\n\n            this.state = {\n                shouldRender: false,\n            };\n        }\n\n        componentDidMount() {\n            window.requestAnimationFrame(() => {\n                window.requestAnimationFrame(() => this.setState({shouldRender: true}));\n            });\n        }\n\n        render() {\n            return this.state.shouldRender ? <WrappedComponent {...this.props}/> : PreRenderComponent;\n        }\n    }\n\n    return hoistStatics(DeferredRenderWrapper, WrappedComponent);\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {createSelector} from 'reselect';\nimport {getInt} from 'mattermost-redux/selectors/entities/preferences';\nimport {getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {withRouter} from 'react-router-dom';\n\nimport {getDirectTeammate} from 'utils/utils.jsx';\nimport {TutorialSteps, Preferences} from 'utils/constants';\n\nimport {goToLastViewedChannel} from 'actions/views/channel';\n\nimport ChannelView from './channel_view.jsx';\n\n// Temporary selector until getDirectTeammate is converted to be redux-friendly\nconst getDeactivatedChannel = createSelector(\n    (state, channelId) => {\n        return getDirectTeammate(state, channelId);\n    },\n    (teammate) => {\n        return Boolean(teammate && teammate.delete_at);\n    }\n);\n\nfunction mapStateToProps(state) {\n    const channel = getCurrentChannel(state);\n\n    const config = getConfig(state);\n    const enableTutorial = config.EnableTutorial === 'true';\n    const tutorialStep = getInt(state, Preferences.TUTORIAL_STEP, getCurrentUserId(state), TutorialSteps.FINISHED);\n    const viewArchivedChannels = config.ExperimentalViewArchivedChannels === 'true';\n\n    return {\n        channelId: channel ? channel.id : '',\n        deactivatedChannel: channel ? getDeactivatedChannel(state, channel.id) : false,\n        showTutorial: enableTutorial && tutorialStep <= TutorialSteps.INTRO_SCREENS,\n        channelIsArchived: channel ? channel.delete_at !== 0 : false,\n        viewArchivedChannels,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            goToLastViewedChannel,\n        }, dispatch),\n    };\n}\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(ChannelView));\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport ChannelView from 'components/channel_view/index';\nimport {browserHistory} from 'utils/browser_history';\nimport Constants from 'utils/constants.jsx';\n\nexport default class ChannelIdentifierRouter extends React.PureComponent {\n    static propTypes = {\n\n        /*\n         * Object from react-router\n         */\n        match: PropTypes.shape({\n            params: PropTypes.shape({\n                identifier: PropTypes.string.isRequired,\n                team: PropTypes.string.isRequired,\n                postid: PropTypes.string,\n            }).isRequired,\n            url: PropTypes.string.isRequired,\n        }).isRequired,\n\n        actions: PropTypes.shape({\n            onChannelByIdentifierEnter: PropTypes.func.isRequired,\n        }).isRequired,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            prevProps: props,\n        };\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.match.params.team !== prevProps.match.params.team ||\n            this.props.match.params.identifier !== prevProps.match.params.identifier) {\n            clearTimeout(this.replaceUrlTimeout);\n            this.props.actions.onChannelByIdentifierEnter(this.props);\n            this.replaceUrlIfPermalink();\n        }\n    }\n    componentDidMount() {\n        this.props.actions.onChannelByIdentifierEnter(this.props);\n        this.replaceUrlIfPermalink();\n    }\n\n    componentWillUnmount() {\n        clearTimeout(this.replaceUrlTimeout);\n    }\n\n    replaceUrlIfPermalink = () => {\n        if (this.props.match.params.postid) {\n            this.replaceUrlTimeout = setTimeout(() => {\n                const channelUrl = this.props.match.url.split('/').slice(0, -1).join('/');\n                browserHistory.replace(channelUrl);\n            }, Constants.PERMALINK_FADEOUT);\n        }\n    }\n\n    render() {\n        return <ChannelView/>;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport {withRouter} from 'react-router-dom';\n\nimport {onChannelByIdentifierEnter} from './actions';\n\nimport ChannelIdentifierRouter from './channel_identifier_router.jsx';\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            onChannelByIdentifierEnter\n        }, dispatch),\n    };\n}\n\nexport default withRouter(connect(null, mapDispatchToProps)(ChannelIdentifierRouter));\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Route, Switch, Redirect} from 'react-router-dom';\nimport classNames from 'classnames';\n\nimport PermalinkView from 'components/permalink_view';\nimport ChannelHeaderMobile from 'components/channel_header_mobile';\nimport ChannelIdentifierRouter from 'components/channel_layout/channel_identifier_router';\n\ntype Props = {\n    match: {\n        url: string;\n    };\n    location: {\n        pathname: string;\n    };\n    lastChannelPath: string;\n    lhsOpen: boolean;\n    rhsOpen: boolean;\n    rhsMenuOpen: boolean;\n};\n\ntype State = {\n    returnTo: string;\n    lastReturnTo: string;\n};\n\nexport default class CenterChannel extends React.PureComponent<Props, State> {\n    constructor(props: Props) {\n        super(props);\n        this.state = {\n            returnTo: '',\n            lastReturnTo: '',\n        };\n    }\n    static getDerivedStateFromProps(nextProps: Props, prevState: State) {\n        if (prevState.lastReturnTo !== nextProps.location.pathname && nextProps.location.pathname.includes('/pl/')) {\n            return {\n                lastReturnTo: nextProps.location.pathname,\n                returnTo: prevState.lastReturnTo\n            };\n        }\n        return {lastReturnTo: nextProps.location.pathname\n        };\n    }\n\n    render() {\n        const {lastChannelPath} = this.props;\n        const url = this.props.match.url;\n        return (\n            <div\n                key='inner-wrap'\n                className={classNames('inner-wrap', 'channel__wrap', {\n                    'move--right': this.props.lhsOpen,\n                    'move--left': this.props.rhsOpen,\n                    'move--left-small': this.props.rhsMenuOpen,\n                })}\n            >\n                <div className='row header'>\n                    <div id='navbar_wrapper'>\n                        <ChannelHeaderMobile/>\n                    </div>\n                </div>\n                <div className='row main'>\n                    <Switch>\n                        <Route\n                            path={`${url}/pl/:postid`}\n                            render={(props) => (\n                                <PermalinkView\n                                    {...props}\n                                    returnTo={this.state.returnTo}\n                                />\n                            )}\n                        />\n                        <Route\n                            path={['/:team/:path(channels|messages)/:identifier/:postid', '/:team/:path(channels|messages)/:identifier']}\n                            component={ChannelIdentifierRouter}\n                        />\n                        <Redirect to={lastChannelPath}/>\n                    </Switch>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getTeamByName} from 'mattermost-redux/selectors/entities/teams';\nimport {getRedirectChannelNameForTeam} from 'mattermost-redux/selectors/entities/channels';\n\nimport {getIsRhsOpen, getIsRhsMenuOpen} from 'selectors/rhs';\nimport {getIsLhsOpen} from 'selectors/lhs';\nimport {getLastViewedChannelNameByTeamName} from 'selectors/local_storage';\n\nimport {GlobalState} from 'types/store';\n\nimport CenterChannel from './center_channel';\n\ntype Props = {\n    match: {\n        url: string;\n        params: {\n            team: string;\n        };\n    };\n};\n\nconst mapStateToProps = (state: GlobalState, ownProps: Props) => {\n    let channelName = getLastViewedChannelNameByTeamName(state, ownProps.match.params.team);\n    if (!channelName) {\n        const team = getTeamByName(state, ownProps.match.params.team);\n        channelName = getRedirectChannelNameForTeam(state, team!.id);\n    }\n    const lastChannelPath = `${ownProps.match.url}/channels/${channelName}`;\n    return {\n        lastChannelPath,\n        lhsOpen: getIsLhsOpen(state),\n        rhsOpen: getIsRhsOpen(state),\n        rhsMenuOpen: getIsRhsMenuOpen(state),\n    };\n};\n\nexport default connect(mapStateToProps)(CenterChannel);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {injectIntl, IntlShape} from 'react-intl';\n\nimport {Channel} from 'mattermost-redux/types/channels';\nimport {Team} from 'mattermost-redux/types/teams';\n\nimport * as UserAgent from 'utils/user_agent';\nimport {Constants} from 'utils/constants';\n\nimport favicon16x16 from 'images/favicon/favicon-16x16.png';\nimport favicon32x32 from 'images/favicon/favicon-32x32.png';\nimport favicon96x96 from 'images/favicon/favicon-96x96.png';\nimport redDotFavicon16x16 from 'images/favicon/favicon-reddot-16x16.png';\nimport redDotFavicon32x32 from 'images/favicon/favicon-reddot-32x32.png';\nimport redDotFavicon96x96 from 'images/favicon/favicon-reddot-96x96.png';\n\ntype Props = {\n    intl: IntlShape;\n    unreads: {\n        messageCount: number;\n        mentionCount: number;\n    };\n    siteName?: string;\n    currentChannel: Channel;\n    currentTeam: Team;\n    currentTeammate: Channel | null;\n};\n\nclass FaviconTitleHandler extends React.PureComponent<Props> {\n    badgesActive: boolean;\n    lastBadgesActive: boolean;\n\n    constructor(props: Props) {\n        super(props);\n\n        this.badgesActive = false;\n        this.lastBadgesActive = false;\n    }\n\n    componentDidUpdate(prevProps: Props) {\n        this.updateTitle();\n        this.setBadgesActiveAndFavicon(prevProps.unreads.mentionCount > 0);\n    }\n\n    setBadgesActiveAndFavicon(lastBadgesActive: boolean) {\n        if (!(UserAgent.isFirefox() || UserAgent.isChrome())) {\n            return;\n        }\n\n        const link = document.querySelector('link[rel=\"icon\"]');\n\n        if (!link) {\n            return;\n        }\n\n        this.badgesActive = this.props.unreads.mentionCount > 0;\n\n        // update the favicon to show if there are any notifications\n        if (lastBadgesActive !== this.badgesActive) {\n            this.updateFavicon(this.badgesActive);\n        }\n    }\n\n    updateTitle = () => {\n        const {\n            siteName,\n            currentChannel,\n            currentTeam,\n            currentTeammate,\n            unreads,\n        } = this.props;\n        const {formatMessage} = this.props.intl;\n\n        const currentSiteName = siteName || '';\n\n        if (currentChannel && currentTeam && currentChannel.id) {\n            let currentChannelName = currentChannel.display_name;\n            if (currentChannel.type === Constants.DM_CHANNEL) {\n                if (currentTeammate != null) {\n                    currentChannelName = currentTeammate.display_name;\n                }\n            }\n\n            const mentionTitle = unreads.mentionCount > 0 ? '(' + unreads.mentionCount + ') ' : '';\n            const unreadTitle = unreads.messageCount > 0 ? '* ' : '';\n            document.title = mentionTitle + unreadTitle + currentChannelName + ' - ' + currentTeam.display_name + ' ' + currentSiteName;\n        } else {\n            document.title = formatMessage({id: 'sidebar.team_select', defaultMessage: '{siteName} - Join a team'}, {siteName: currentSiteName || 'Mattermost'});\n        }\n    }\n\n    updateFavicon = (active: boolean) => {\n        const link16x16 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"16x16\"]');\n        const link32x32 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"32x32\"]');\n        const link96x96 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"96x96\"]');\n\n        if (active) {\n            link16x16!.href = typeof redDotFavicon16x16 === 'string' ? redDotFavicon16x16 : '';\n            link32x32!.href = typeof redDotFavicon32x32 === 'string' ? redDotFavicon32x32 : '';\n            link96x96!.href = typeof redDotFavicon96x96 === 'string' ? redDotFavicon96x96 : '';\n        } else {\n            link16x16!.href = typeof favicon16x16 === 'string' ? favicon16x16 : '';\n            link32x32!.href = typeof favicon32x32 === 'string' ? favicon32x32 : '';\n            link96x96!.href = typeof favicon96x96 === 'string' ? favicon96x96 : '';\n        }\n    }\n\n    render() {\n        return null;\n    }\n}\n\nexport default injectIntl(FaviconTitleHandler);\n","\n// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch} from 'redux';\n\nimport {getCurrentChannel, getUnreads} from 'mattermost-redux/selectors/entities/channels';\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\nimport {GlobalState} from 'mattermost-redux/types/store';\nimport {GenericAction} from 'mattermost-redux/types/actions';\n\nimport FaviconTitleHandler from './favicon_title_handler';\n\nfunction mapStateToProps(state: GlobalState) {\n    const config = getConfig(state);\n    const currentChannel = getCurrentChannel(state);\n    const currentTeammate = (currentChannel && currentChannel.teammate_id) ? currentChannel : null;\n    const currentTeam = getCurrentTeam(state);\n\n    return {\n        currentChannel,\n        currentTeam,\n        currentTeammate,\n        siteName: config.SiteName,\n        unreads: getUnreads(state),\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<GenericAction>) {\n    return {\n        actions: bindActionCreators({\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FaviconTitleHandler);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {Route} from 'react-router-dom';\n\nimport AnnouncementBarController from 'components/announcement_bar';\n\nimport Pluggable from 'plugins/pluggable';\nimport SystemNotice from 'components/system_notice';\nimport EditPostModal from 'components/edit_post_modal';\n\nimport GetPublicLinkModal from 'components/get_public_link_modal';\nimport LeavePrivateChannelModal from 'components/leave_private_channel_modal';\nimport ResetStatusModal from 'components/reset_status_modal';\nimport ShortcutsModal from 'components/shortcuts_modal.jsx';\nimport SidebarRight from 'components/sidebar_right';\nimport SidebarRightMenu from 'components/sidebar_right_menu';\nimport ImportThemeModal from 'components/user_settings/import_theme_modal.jsx';\nimport ModalController from 'components/modal_controller';\nimport LegacyTeamSidebar from 'components/legacy_team_sidebar';\nimport LegacySidebar from 'components/legacy_sidebar';\nimport Sidebar from 'components/sidebar';\nimport * as Utils from 'utils/utils';\nimport * as UserAgent from 'utils/user_agent';\nimport CenterChannel from 'components/channel_layout/center_channel';\nimport LoadingScreen from 'components/loading_screen';\nimport FaviconTitleHandler from 'components/favicon_title_handler';\n\nexport default class ChannelController extends React.Component {\n    static propTypes = {\n        pathName: PropTypes.string.isRequired,\n        teamType: PropTypes.string.isRequired,\n        fetchingChannels: PropTypes.bool.isRequired,\n        useLegacyLHS: PropTypes.bool.isRequired,\n    };\n\n    shouldComponentUpdate(nextProps) {\n        return this.props.teamType !== nextProps.teamType || this.props.pathName !== nextProps.pathName || this.props.fetchingChannels !== nextProps.fetchingChannels || this.props.useLegacyLHS !== nextProps.useLegacyLHS;\n    }\n\n    componentDidMount() {\n        const platform = window.navigator.platform;\n\n        document.body.classList.add('app__body', 'channel-view');\n\n        // IE Detection\n        if (UserAgent.isInternetExplorer() || UserAgent.isEdge()) {\n            document.body.classList.add('browser--ie');\n        }\n\n        // OS Detection\n        if (platform === 'Win32' || platform === 'Win64') {\n            document.body.classList.add('os--windows');\n        } else if (platform === 'MacIntel' || platform === 'MacPPC') {\n            document.body.classList.add('os--mac');\n        }\n    }\n\n    componentWillUnmount() {\n        document.body.classList.remove('app__body', 'channel-view');\n    }\n\n    render() {\n        const PreferredTeamSidebar = LegacyTeamSidebar; // TODO: Replace with switch when we rewrite team sidebar\n        const PreferredSidebar = this.props.useLegacyLHS ? LegacySidebar : Sidebar;\n\n        return (\n            <div\n                id='channel_view'\n                className='channel-view'\n            >\n                <AnnouncementBarController/>\n                <SystemNotice/>\n                <FaviconTitleHandler/>\n\n                <div className='container-fluid'>\n                    <SidebarRight/>\n                    <SidebarRightMenu teamType={this.props.teamType}/>\n                    <Route component={PreferredTeamSidebar}/>\n                    <Route component={PreferredSidebar}/>\n                    {!this.props.fetchingChannels && <Route component={CenterChannel}/>}\n                    {this.props.fetchingChannels && <LoadingScreen/>}\n                    <Pluggable pluggableName='Root'/>\n                    <GetPublicLinkModal/>\n                    <ImportThemeModal/>\n                    <EditPostModal/>\n                    <ResetStatusModal/>\n                    <LeavePrivateChannelModal/>\n                    <ShortcutsModal isMac={Utils.isMac()}/>\n                    <ModalController/>\n                </div>\n            </div>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Route, Switch} from 'react-router-dom';\nimport iNoBounce from 'inobounce';\n\nimport {Channel, ChannelMembership} from 'mattermost-redux/types/channels';\nimport {Team, TeamMembership} from 'mattermost-redux/types/teams';\n\nimport {startPeriodicStatusUpdates, stopPeriodicStatusUpdates} from 'actions/status_actions.jsx';\nimport {startPeriodicSync, stopPeriodicSync, reconnect} from 'actions/websocket_actions.jsx';\nimport * as GlobalActions from 'actions/global_actions.jsx';\n\nimport Constants from 'utils/constants';\nimport * as UserAgent from 'utils/user_agent';\nimport * as Utils from 'utils/utils.jsx';\n\nimport {makeAsyncComponent} from 'components/async_load';\nconst LazyBackstageController = React.lazy(() => import('components/backstage'));\nimport ChannelController from 'components/channel_layout/channel_controller';\n\nconst BackstageController = makeAsyncComponent(LazyBackstageController);\n\nlet wakeUpInterval: number;\nlet lastTime = Date.now();\nconst WAKEUP_CHECK_INTERVAL = 30000; // 30 seconds\nconst WAKEUP_THRESHOLD = 60000; // 60 seconds\nconst UNREAD_CHECK_TIME_MILLISECONDS = 10000;\n\ndeclare global {\n    interface Window {\n        isActive: boolean;\n    }\n}\n\ntype Props = {\n    currentUser?: {\n        id: string;\n    };\n    currentChannelId?: string;\n    currentTeamId?: string;\n    useLegacyLHS: boolean;\n    actions: {\n        fetchMyChannelsAndMembers: (teamId: string) => Promise<{data: {channels: Channel[]; members: ChannelMembership[]}}>;\n        getMyTeamUnreads: () => Promise<{}>;\n        viewChannel: (channelId: string, prevChannelId?: string | undefined) => Promise<{data: boolean}>;\n        markChannelAsReadOnFocus: (channelId: string) => Promise<{}>;\n        getTeamByName: (teamName: string) => Promise<{data: Team}>;\n        addUserToTeam: (teamId: string, userId?: string) => Promise<{data: TeamMembership; error?: any}>;\n        selectTeam: (team: Team) => Promise<{data: boolean}>;\n        setPreviousTeamId: (teamId: string) => Promise<{data: boolean}>;\n        loadStatusesForChannelAndSidebar: () => Promise<{}>;\n        loadProfilesForDirect: () => Promise<{}>;\n    };\n    mfaRequired: boolean;\n    match: {\n        params: {\n            team: string;\n        };\n    };\n    history: {\n        push(path: string): void;\n    };\n    teamsList: Team[];\n    theme: any;\n}\n\ntype State = {\n    team: Team | null;\n    finishedFetchingChannels: boolean;\n    prevTeam: string;\n    teamsList: Team[];\n}\n\nexport default class NeedsTeam extends React.Component<Props, State> {\n    public blurTime: number;\n    constructor(props: Props) {\n        super(props);\n        this.blurTime = new Date().getTime();\n\n        if (this.props.mfaRequired) {\n            this.props.history.push('/mfa/setup');\n            return;\n        }\n\n        clearInterval(wakeUpInterval);\n\n        wakeUpInterval = window.setInterval(() => {\n            const currentTime = (new Date()).getTime();\n            if (currentTime > (lastTime + WAKEUP_THRESHOLD)) { // ignore small delays\n                console.log('computer woke up - fetching latest'); //eslint-disable-line no-console\n                reconnect(false);\n            }\n            lastTime = currentTime;\n        }, WAKEUP_CHECK_INTERVAL);\n\n        const team = this.updateCurrentTeam(this.props);\n\n        this.state = {\n            team,\n            finishedFetchingChannels: false,\n            prevTeam: this.props.match.params.team,\n            teamsList: this.props.teamsList\n        };\n\n        if (!team) {\n            this.joinTeam(this.props);\n        }\n    }\n\n    static getDerivedStateFromProps(nextProps: Props, state: State) {\n        if (state.prevTeam !== nextProps.match.params.team) {\n            const team = nextProps.teamsList ?\n                nextProps.teamsList.find((teamObj: Team) =>\n                    teamObj.name === nextProps.match.params.team) : null;\n            return {\n                prevTeam: nextProps.match.params.team,\n                team: (team || null)\n            };\n        }\n        return {prevTeam: nextProps.match.params.team};\n    }\n\n    public componentDidMount() {\n        startPeriodicStatusUpdates();\n        startPeriodicSync();\n\n        // Set up tracking for whether the window is active\n        window.isActive = true;\n        Utils.applyTheme(this.props.theme);\n\n        if (UserAgent.isIosSafari()) {\n            // Use iNoBounce to prevent scrolling past the boundaries of the page\n            iNoBounce.enable();\n        }\n\n        window.addEventListener('focus', this.handleFocus);\n        window.addEventListener('blur', this.handleBlur);\n        window.addEventListener('keydown', this.onShortcutKeyDown);\n    }\n\n    componentDidUpdate(prevProps: Props) {\n        const {theme} = this.props;\n        if (!Utils.areObjectsEqual(prevProps.theme, theme)) {\n            Utils.applyTheme(theme);\n        }\n        if (this.props.match.params.team !== prevProps.match.params.team) {\n            if (this.state.team) {\n                this.initTeam(this.state.team);\n            }\n            if (!this.state.team) {\n                this.joinTeam(this.props);\n            }\n        }\n    }\n\n    componentWillUnmount() {\n        window.isActive = false;\n        stopPeriodicStatusUpdates();\n        stopPeriodicSync();\n        if (UserAgent.isIosSafari()) {\n            iNoBounce.disable();\n        }\n\n        clearInterval(wakeUpInterval);\n        window.removeEventListener('focus', this.handleFocus);\n        window.removeEventListener('blur', this.handleBlur);\n        window.removeEventListener('keydown', this.onShortcutKeyDown);\n    }\n\n    handleBlur = () => {\n        window.isActive = false;\n        this.blurTime = new Date().getTime();\n        if (this.props.currentUser) {\n            this.props.actions.viewChannel('');\n        }\n    }\n\n    handleFocus = () => {\n        if (this.props.currentChannelId) {\n            this.props.actions.markChannelAsReadOnFocus(this.props.currentChannelId);\n            window.isActive = true;\n        }\n        if (Date.now() - this.blurTime > UNREAD_CHECK_TIME_MILLISECONDS && this.props.currentTeamId) {\n            this.props.actions.fetchMyChannelsAndMembers(this.props.currentTeamId);\n            this.props.actions.loadProfilesForDirect();\n        }\n    }\n\n    joinTeam = async (props: Props) => {\n        const {data: team} = await this.props.actions.getTeamByName(props.match.params.team);\n        if (team) {\n            const {error} = await props.actions.addUserToTeam(team.id, props.currentUser && props.currentUser.id);\n            if (error) {\n                props.history.push('/error?type=team_not_found');\n            } else {\n                this.setState({team});\n                this.initTeam(team);\n            }\n        } else {\n            props.history.push('/error?type=team_not_found');\n        }\n    }\n\n    initTeam = (team: Team) => {\n        // If current team is set, then this is not first load\n        // The first load action pulls team unreads\n        this.props.actions.getMyTeamUnreads();\n        this.props.actions.selectTeam(team);\n        this.props.actions.setPreviousTeamId(team.id);\n        GlobalActions.emitCloseRightHandSide();\n\n        if (Utils.isGuest(this.props.currentUser)) {\n            this.setState({finishedFetchingChannels: false});\n        }\n        this.props.actions.fetchMyChannelsAndMembers(team.id).then(\n            () => {\n                this.setState({\n                    finishedFetchingChannels: true,\n                });\n            }\n        );\n\n        this.props.actions.loadStatusesForChannelAndSidebar();\n        this.props.actions.loadProfilesForDirect();\n\n        return team;\n    }\n\n    updateCurrentTeam = (props: Props) => {\n        // First check to make sure you're in the current team\n        // for the current url.\n        const team = props.teamsList ? props.teamsList.find((teamObj) => teamObj.name === props.match.params.team) : null;\n        if (team) {\n            this.initTeam(team);\n            return team;\n        }\n        return null;\n    }\n\n    onShortcutKeyDown = (e: KeyboardEvent) => {\n        if (e.shiftKey && Utils.cmdOrCtrlPressed(e) && Utils.isKeyPressed(e, Constants.KeyCodes.L)) {\n            const sidebar = document.getElementById('sidebar-right');\n            if (sidebar) {\n                if (sidebar.className.match('sidebar--right sidebar--right--expanded move--left')) {\n                    const replyTextbox = document.getElementById('reply_textbox');\n                    if (replyTextbox) {\n                        replyTextbox.focus();\n                    }\n                } else {\n                    const postTextbox = document.getElementById('post_textbox');\n                    if (postTextbox) {\n                        postTextbox.focus();\n                    }\n                }\n            }\n        }\n    }\n\n    render() {\n        if (this.state.team === null) {\n            return <div/>;\n        }\n        const teamType = this.state.team ? this.state.team.type : '';\n\n        return (\n            <Switch>\n                <Route\n                    path={'/:team/integrations'}\n                    component={BackstageController}\n                />\n                <Route\n                    path={'/:team/emoji'}\n                    component={BackstageController}\n                />\n                <Route\n                    render={(renderProps) => (\n                        <ChannelController\n                            pathName={renderProps.location.pathname}\n                            teamType={teamType}\n                            fetchingChannels={!this.state.finishedFetchingChannels}\n                            useLegacyLHS={this.props.useLegacyLHS}\n                        />\n                    )}\n                />\n            </Switch>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators, Dispatch, ActionCreatorsMapObject} from 'redux';\nimport {withRouter} from 'react-router-dom';\n\nimport {loadProfilesForDirect} from 'mattermost-redux/actions/users';\nimport {fetchMyChannelsAndMembers, viewChannel} from 'mattermost-redux/actions/channels';\nimport {getMyTeamUnreads, getTeamByName, selectTeam} from 'mattermost-redux/actions/teams';\nimport {getTheme, getNewSidebarPreference} from 'mattermost-redux/selectors/entities/preferences';\nimport {getLicense, getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\nimport {getCurrentTeamId, getMyTeams} from 'mattermost-redux/selectors/entities/teams';\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/channels';\nimport {GlobalState} from 'mattermost-redux/types/store';\nimport {Action} from 'mattermost-redux/types/actions';\n\nimport {setPreviousTeamId} from 'actions/local_storage';\nimport {loadStatusesForChannelAndSidebar} from 'actions/status_actions';\nimport {addUserToTeam} from 'actions/team_actions';\nimport {markChannelAsReadOnFocus} from 'actions/views/channel';\nimport {checkIfMFARequired} from 'utils/route';\n\nimport NeedsTeam from './needs_team';\n\ntype OwnProps = {\n    match: {\n        url: string;\n    };\n}\n\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\n    const license = getLicense(state);\n    const config = getConfig(state);\n    const currentUser = getCurrentUser(state);\n\n    return {\n        theme: getTheme(state),\n        mfaRequired: checkIfMFARequired(currentUser, license, config, ownProps.match.url),\n        currentUser,\n        currentTeamId: getCurrentTeamId(state),\n        teamsList: getMyTeams(state),\n        currentChannelId: getCurrentChannelId(state),\n        useLegacyLHS: !getNewSidebarPreference(state),\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch) {\n    return {\n        actions: bindActionCreators<ActionCreatorsMapObject<Action>, any>({\n            fetchMyChannelsAndMembers,\n            getMyTeamUnreads,\n            viewChannel,\n            markChannelAsReadOnFocus,\n            getTeamByName,\n            addUserToTeam,\n            setPreviousTeamId,\n            selectTeam,\n            loadStatusesForChannelAndSidebar,\n            loadProfilesForDirect,\n        }, dispatch),\n    };\n}\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(NeedsTeam));\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\nimport {getTeam} from 'mattermost-redux/selectors/entities/teams';\n\nimport {ErrorPageTypes} from 'utils/constants';\nimport {browserHistory} from 'utils/browser_history';\n\nimport LocalStorageStore from 'stores/local_storage_store';\n\nexport const redirect = (url) => {\n    return (dispatch, getState) => {\n        const sanitizedUrl = url.replace('/_redirect/', '');\n\n        const state = getState();\n        const teamId = LocalStorageStore.getPreviousTeamId(getCurrentUserId(state));\n        const team = getTeam(state, teamId);\n\n        if (!team) {\n            browserHistory.replace(`/error?type=${ErrorPageTypes.TEAM_NOT_FOUND}`);\n            return;\n        }\n\n        browserHistory.push(`/${team.name}/${sanitizedUrl}`);\n    };\n};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nexport default class PermalinkRedirector extends React.PureComponent {\n    static propTypes = {\n        params: PropTypes.object,\n        url: PropTypes.string,\n        actions: PropTypes.shape({\n            redirect: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    componentDidMount() {\n        this.props.actions.redirect(this.props.url, this.props.params);\n    }\n\n    render() {\n        return null;\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {redirect} from './actions';\nimport PermalinkRedirector from './permalink_redirector';\n\nconst mapStateToProps = (state, ownProps) => {\n    return {\n        params: ownProps.match.params,\n        url: ownProps.match.url,\n    };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        actions: bindActionCreators({\n            redirect,\n        }, dispatch),\n    };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PermalinkRedirector);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\nimport {\n    IntegrationTypes,\n} from 'mattermost-redux/action_types';\n\nimport {openModal} from 'actions/views/modals';\n\nimport {ModalIdentifiers} from 'utils/constants';\n\nimport InteractiveDialog from 'components/interactive_dialog';\nimport store from '../stores/redux_store';\n\nexport function openInteractiveDialog(dialog) {\n    store.dispatch({type: IntegrationTypes.RECEIVED_DIALOG, data: dialog});\n\n    store.dispatch(openModal({modalId: ModalIdentifiers.INTERACTIVE_DIALOG, dialogType: InteractiveDialog}));\n}\n\n// This code is problematic for a couple of different reasons:\n// * it monitors the store to modify the store: this is perhaps better handled by a saga\n// * it makes importing this file impure by triggering a side-effect which may not be obvious\n// * it's not really located in the \"right place\": dialogs are applicable to non-plugins too\n// * it's nigh impossible to test as written\n//\n// It's worth fixing all of this, but I think this requires some refactoring.\nlet previousTriggerId = '';\nstore.subscribe(() => {\n    const state = store.getState();\n    const currentTriggerId = state.entities.integrations.dialogTriggerId;\n\n    if (currentTriggerId === previousTriggerId) {\n        return;\n    }\n\n    previousTriggerId = currentTriggerId;\n\n    const dialog = state.entities.integrations.dialog || {};\n    if (dialog.trigger_id !== currentTriggerId) {\n        return;\n    }\n\n    store.dispatch(openModal({modalId: ModalIdentifiers.INTERACTIVE_DIALOG, dialogType: InteractiveDialog}));\n});\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport messageHtmlToComponent from 'utils/message_html_to_component';\nimport {formatText} from 'utils/text_formatting';\nimport {browserHistory} from 'utils/browser_history';\n\n// The following import has intentional side effects. Do not remove without research.\nimport {openInteractiveDialog} from './interactive_dialog';\n\n// Common libraries exposed on window for plugins to use as Webpack externals.\nwindow.React = require('react');\nwindow.ReactDOM = require('react-dom');\nwindow.Redux = require('redux');\nwindow.ReactRedux = require('react-redux');\nwindow.ReactBootstrap = require('react-bootstrap');\nwindow.PostUtils = {formatText, messageHtmlToComponent};\nwindow.PropTypes = require('prop-types');\nwindow.PDFJS = require('pdfjs-dist');\nwindow.openInteractiveDialog = openInteractiveDialog;\nwindow.WebappUtils = {browserHistory};\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport React from 'react';\nimport {Modal} from 'react-bootstrap';\nimport {FormattedMessage} from 'react-intl';\n\ntype Props = {\n    currentUserId: string;\n    onHide: () => void;\n    channelName?: string;\n    remover?: string;\n}\n\ntype State = {\n    show: boolean;\n}\n\nexport default class RemovedFromChannelModal extends React.PureComponent<Props, State> {\n    constructor(props: Props) {\n        super(props);\n\n        this.state = {show: true};\n    }\n\n    onHide = () => {\n        this.setState({show: false});\n    }\n\n    render() {\n        let channelName: JSX.Element | string;\n        let remover: JSX.Element | string;\n\n        channelName = (\n            <FormattedMessage\n                id='removed_channel.channelName'\n                defaultMessage='the channel'\n            />\n        );\n        if (this.props.channelName) {\n            channelName = this.props.channelName;\n        }\n\n        remover = (\n            <FormattedMessage\n                id='removed_channel.someone'\n                defaultMessage='Someone'\n            />\n        );\n        if (this.props.remover) {\n            remover = this.props.remover;\n        }\n\n        if (this.props.currentUserId === '') {\n            return null;\n        }\n\n        return (\n            <Modal\n                dialogClassName='a11y__modal'\n                show={this.state.show}\n                onHide={this.onHide}\n                onExited={this.props.onHide}\n                role='dialog'\n                aria-labelledby='removeFromChannelModalLabel'\n            >\n                <Modal.Header closeButton={true}>\n                    <Modal.Title\n                        componentClass='h1'\n                        id='removeFromChannelModalLabel'\n                    >\n                        <FormattedMessage\n                            id='removed_channel.from'\n                            defaultMessage='Removed from '\n                        />\n                        <span className='name'>\n                            {channelName}\n                        </span>\n                    </Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <p>\n                        <FormattedMessage\n                            id='removed_channel.remover'\n                            defaultMessage='{remover} removed you from {channel}'\n                            values={{\n                                remover,\n                                channel: (channelName),\n                            }}\n                        />\n                    </p>\n                </Modal.Body>\n                <Modal.Footer>\n                    <button\n                        type='button'\n                        className='btn btn-primary'\n                        onClick={this.onHide}\n                        id='removedChannelBtn'\n                    >\n                        <FormattedMessage\n                            id='removed_channel.okay'\n                            defaultMessage='Okay'\n                        />\n                    </button>\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\n\nimport {getCurrentUserId, getUser} from 'mattermost-redux/selectors/entities/users';\n\nimport {GlobalState} from 'types/store';\n\nimport RemovedFromChannelModal from './removed_from_channel_modal';\n\ntype Props = {\n    removerId: string;\n}\n\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\n    const remover = getUser(state, ownProps.removerId);\n    return {\n        currentUserId: getCurrentUserId(state),\n        remover: remover && remover.username,\n    };\n}\n\nexport default connect(mapStateToProps)(RemovedFromChannelModal);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {IntlProvider as BaseIntlProvider} from 'react-intl';\n\nimport {Client4} from 'mattermost-redux/client';\nimport {setLocalizeFunction} from 'mattermost-redux/utils/i18n_utils';\n\nimport * as I18n from 'i18n/i18n';\n\nimport {localizeMessage} from 'utils/utils';\n\nexport default class IntlProvider extends React.PureComponent {\n    static propTypes = {\n        children: PropTypes.element.isRequired,\n        locale: PropTypes.string.isRequired,\n        translations: PropTypes.object,\n        actions: PropTypes.shape({\n            loadTranslations: PropTypes.func.isRequired,\n        }).isRequired,\n    };\n\n    componentDidMount() {\n        // Initialize browser's i18n data\n        I18n.doAddLocaleData();\n\n        // Pass localization function back to mattermost-redux\n        setLocalizeFunction(localizeMessage);\n\n        this.handleLocaleChange(this.props.locale);\n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.locale !== this.props.locale) {\n            this.handleLocaleChange(this.props.locale);\n        }\n    }\n\n    handleLocaleChange = (locale) => {\n        Client4.setAcceptLanguage(locale);\n\n        this.loadTranslationsIfNecessary(locale);\n    }\n\n    loadTranslationsIfNecessary = (locale) => {\n        if (this.props.translations) {\n            // Already loaded\n            return;\n        }\n        const localeInfo = I18n.getLanguageInfo(locale);\n\n        if (!localeInfo) {\n            return;\n        }\n\n        this.props.actions.loadTranslations(locale, localeInfo.url);\n    }\n\n    render() {\n        if (!this.props.translations) {\n            return null;\n        }\n\n        return (\n            <BaseIntlProvider\n                key={this.props.locale}\n                locale={this.props.locale}\n                messages={this.props.translations}\n                textComponent='span'\n            >\n                {this.props.children}\n            </BaseIntlProvider>\n        );\n    }\n}\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport {loadTranslations} from 'actions/views/root';\n\nimport {getCurrentLocale, getTranslations} from 'selectors/i18n';\n\nimport IntlProvider from './intl_provider';\n\nfunction mapStateToProps(state) {\n    const locale = getCurrentLocale(state);\n\n    return {\n        locale,\n        translations: getTranslations(state, locale),\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            loadTranslations,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(IntlProvider);\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\n// See LICENSE.txt for license information.\n\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\n\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\nimport {shouldShowTermsOfService} from 'mattermost-redux/selectors/entities/users';\n\nimport {loadMeAndConfig} from 'actions/views/root';\n\nimport Root from './root.jsx';\n\nfunction mapStateToProps(state) {\n    const config = getConfig(state);\n    const showTermsOfService = shouldShowTermsOfService(state);\n\n    return {\n        diagnosticsEnabled: config.DiagnosticsEnabled === 'true',\n        noAccounts: config.NoAccounts === 'true',\n        diagnosticId: config.DiagnosticId,\n        showTermsOfService,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        actions: bindActionCreators({\n            loadMeAndConfig,\n        }, dispatch),\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Root);\n"],"sourceRoot":""}